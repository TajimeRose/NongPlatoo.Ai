var q0=t=>{throw TypeError(t)};var sN=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var Wh=(t,e,n)=>e.has(t)||q0("Cannot "+n);var X=(t,e,n)=>(Wh(t,e,"read from private field"),n?n.call(t):e.get(t)),Fe=(t,e,n)=>e.has(t)?q0("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,n),Se=(t,e,n,r)=>(Wh(t,e,"write to private field"),r?r.call(t,n):e.set(t,n),n),Wt=(t,e,n)=>(Wh(t,e,"access private method"),n);var ll=(t,e,n,r)=>({set _(o){Se(t,e,o,n)},get _(){return X(t,e,r)}});var _K=sN((OK,nN)=>{function uN(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const o in r)if(o!=="default"&&!(o in t)){const i=Object.getOwnPropertyDescriptor(r,o);i&&Object.defineProperty(t,o,i.get?i:{enumerable:!0,get:()=>r[o]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(o){if(o.ep)return;o.ep=!0;const i=n(o);fetch(o.href,i)}})();function Yb(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Qb={exports:{}},Of={},Jb={exports:{}},Ae={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Pc=Symbol.for("react.element"),cN=Symbol.for("react.portal"),lN=Symbol.for("react.fragment"),dN=Symbol.for("react.strict_mode"),fN=Symbol.for("react.profiler"),hN=Symbol.for("react.provider"),pN=Symbol.for("react.context"),mN=Symbol.for("react.forward_ref"),vN=Symbol.for("react.suspense"),gN=Symbol.for("react.memo"),yN=Symbol.for("react.lazy"),X0=Symbol.iterator;function xN(t){return t===null||typeof t!="object"?null:(t=X0&&t[X0]||t["@@iterator"],typeof t=="function"?t:null)}var Zb={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},e2=Object.assign,t2={};function tu(t,e,n){this.props=t,this.context=e,this.refs=t2,this.updater=n||Zb}tu.prototype.isReactComponent={};tu.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};tu.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function n2(){}n2.prototype=tu.prototype;function og(t,e,n){this.props=t,this.context=e,this.refs=t2,this.updater=n||Zb}var ig=og.prototype=new n2;ig.constructor=og;e2(ig,tu.prototype);ig.isPureReactComponent=!0;var Y0=Array.isArray,r2=Object.prototype.hasOwnProperty,ag={current:null},o2={key:!0,ref:!0,__self:!0,__source:!0};function i2(t,e,n){var r,o={},i=null,a=null;if(e!=null)for(r in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(i=""+e.key),e)r2.call(e,r)&&!o2.hasOwnProperty(r)&&(o[r]=e[r]);var s=arguments.length-2;if(s===1)o.children=n;else if(1<s){for(var u=Array(s),c=0;c<s;c++)u[c]=arguments[c+2];o.children=u}if(t&&t.defaultProps)for(r in s=t.defaultProps,s)o[r]===void 0&&(o[r]=s[r]);return{$$typeof:Pc,type:t,key:i,ref:a,props:o,_owner:ag.current}}function wN(t,e){return{$$typeof:Pc,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function sg(t){return typeof t=="object"&&t!==null&&t.$$typeof===Pc}function bN(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Q0=/\/+/g;function $h(t,e){return typeof t=="object"&&t!==null&&t.key!=null?bN(""+t.key):e.toString(36)}function ed(t,e,n,r,o){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(i){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case Pc:case cN:a=!0}}if(a)return a=t,o=o(a),t=r===""?"."+$h(a,0):r,Y0(o)?(n="",t!=null&&(n=t.replace(Q0,"$&/")+"/"),ed(o,e,n,"",function(c){return c})):o!=null&&(sg(o)&&(o=wN(o,n+(!o.key||a&&a.key===o.key?"":(""+o.key).replace(Q0,"$&/")+"/")+t)),e.push(o)),1;if(a=0,r=r===""?".":r+":",Y0(t))for(var s=0;s<t.length;s++){i=t[s];var u=r+$h(i,s);a+=ed(i,e,n,u,o)}else if(u=xN(t),typeof u=="function")for(t=u.call(t),s=0;!(i=t.next()).done;)i=i.value,u=r+$h(i,s++),a+=ed(i,e,n,u,o);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function dl(t,e,n){if(t==null)return t;var r=[],o=0;return ed(t,r,"","",function(i){return e.call(n,i,o++)}),r}function EN(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var on={current:null},td={transition:null},CN={ReactCurrentDispatcher:on,ReactCurrentBatchConfig:td,ReactCurrentOwner:ag};function a2(){throw Error("act(...) is not supported in production builds of React.")}Ae.Children={map:dl,forEach:function(t,e,n){dl(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return dl(t,function(){e++}),e},toArray:function(t){return dl(t,function(e){return e})||[]},only:function(t){if(!sg(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Ae.Component=tu;Ae.Fragment=lN;Ae.Profiler=fN;Ae.PureComponent=og;Ae.StrictMode=dN;Ae.Suspense=vN;Ae.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=CN;Ae.act=a2;Ae.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=e2({},t.props),o=t.key,i=t.ref,a=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,a=ag.current),e.key!==void 0&&(o=""+e.key),t.type&&t.type.defaultProps)var s=t.type.defaultProps;for(u in e)r2.call(e,u)&&!o2.hasOwnProperty(u)&&(r[u]=e[u]===void 0&&s!==void 0?s[u]:e[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){s=Array(u);for(var c=0;c<u;c++)s[c]=arguments[c+2];r.children=s}return{$$typeof:Pc,type:t.type,key:o,ref:i,props:r,_owner:a}};Ae.createContext=function(t){return t={$$typeof:pN,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:hN,_context:t},t.Consumer=t};Ae.createElement=i2;Ae.createFactory=function(t){var e=i2.bind(null,t);return e.type=t,e};Ae.createRef=function(){return{current:null}};Ae.forwardRef=function(t){return{$$typeof:mN,render:t}};Ae.isValidElement=sg;Ae.lazy=function(t){return{$$typeof:yN,_payload:{_status:-1,_result:t},_init:EN}};Ae.memo=function(t,e){return{$$typeof:gN,type:t,compare:e===void 0?null:e}};Ae.startTransition=function(t){var e=td.transition;td.transition={};try{t()}finally{td.transition=e}};Ae.unstable_act=a2;Ae.useCallback=function(t,e){return on.current.useCallback(t,e)};Ae.useContext=function(t){return on.current.useContext(t)};Ae.useDebugValue=function(){};Ae.useDeferredValue=function(t){return on.current.useDeferredValue(t)};Ae.useEffect=function(t,e){return on.current.useEffect(t,e)};Ae.useId=function(){return on.current.useId()};Ae.useImperativeHandle=function(t,e,n){return on.current.useImperativeHandle(t,e,n)};Ae.useInsertionEffect=function(t,e){return on.current.useInsertionEffect(t,e)};Ae.useLayoutEffect=function(t,e){return on.current.useLayoutEffect(t,e)};Ae.useMemo=function(t,e){return on.current.useMemo(t,e)};Ae.useReducer=function(t,e,n){return on.current.useReducer(t,e,n)};Ae.useRef=function(t){return on.current.useRef(t)};Ae.useState=function(t){return on.current.useState(t)};Ae.useSyncExternalStore=function(t,e,n){return on.current.useSyncExternalStore(t,e,n)};Ae.useTransition=function(){return on.current.useTransition()};Ae.version="18.3.1";Jb.exports=Ae;var C=Jb.exports;const te=Yb(C),ug=uN({__proto__:null,default:te},[C]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _N=C,SN=Symbol.for("react.element"),kN=Symbol.for("react.fragment"),IN=Object.prototype.hasOwnProperty,RN=_N.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,TN={key:!0,ref:!0,__self:!0,__source:!0};function s2(t,e,n){var r,o={},i=null,a=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(a=e.ref);for(r in e)IN.call(e,r)&&!TN.hasOwnProperty(r)&&(o[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)o[r]===void 0&&(o[r]=e[r]);return{$$typeof:SN,type:t,key:i,ref:a,props:o,_owner:RN.current}}Of.Fragment=kN;Of.jsx=s2;Of.jsxs=s2;Qb.exports=Of;var b=Qb.exports,u2={exports:{}},On={},c2={exports:{}},l2={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(M,P){var B=M.length;M.push(P);e:for(;0<B;){var G=B-1>>>1,q=M[G];if(0<o(q,P))M[G]=P,M[B]=q,B=G;else break e}}function n(M){return M.length===0?null:M[0]}function r(M){if(M.length===0)return null;var P=M[0],B=M.pop();if(B!==P){M[0]=B;e:for(var G=0,q=M.length,J=q>>>1;G<J;){var H=2*(G+1)-1,Q=M[H],ne=H+1,Z=M[ne];if(0>o(Q,B))ne<q&&0>o(Z,Q)?(M[G]=Z,M[ne]=B,G=ne):(M[G]=Q,M[H]=B,G=H);else if(ne<q&&0>o(Z,B))M[G]=Z,M[ne]=B,G=ne;else break e}}return P}function o(M,P){var B=M.sortIndex-P.sortIndex;return B!==0?B:M.id-P.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var a=Date,s=a.now();t.unstable_now=function(){return a.now()-s}}var u=[],c=[],l=1,d=null,f=3,h=!1,m=!1,p=!1,g=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function x(M){for(var P=n(c);P!==null;){if(P.callback===null)r(c);else if(P.startTime<=M)r(c),P.sortIndex=P.expirationTime,e(u,P);else break;P=n(c)}}function w(M){if(p=!1,x(M),!m)if(n(u)!==null)m=!0,U(E);else{var P=n(c);P!==null&&$(w,P.startTime-M)}}function E(M,P){m=!1,p&&(p=!1,v(k),k=-1),h=!0;var B=f;try{for(x(P),d=n(u);d!==null&&(!(d.expirationTime>P)||M&&!D());){var G=d.callback;if(typeof G=="function"){d.callback=null,f=d.priorityLevel;var q=G(d.expirationTime<=P);P=t.unstable_now(),typeof q=="function"?d.callback=q:d===n(u)&&r(u),x(P)}else r(u);d=n(u)}if(d!==null)var J=!0;else{var H=n(c);H!==null&&$(w,H.startTime-P),J=!1}return J}finally{d=null,f=B,h=!1}}var _=!1,S=null,k=-1,I=5,R=-1;function D(){return!(t.unstable_now()-R<I)}function A(){if(S!==null){var M=t.unstable_now();R=M;var P=!0;try{P=S(!0,M)}finally{P?j():(_=!1,S=null)}}else _=!1}var j;if(typeof y=="function")j=function(){y(A)};else if(typeof MessageChannel<"u"){var F=new MessageChannel,W=F.port2;F.port1.onmessage=A,j=function(){W.postMessage(null)}}else j=function(){g(A,0)};function U(M){S=M,_||(_=!0,j())}function $(M,P){k=g(function(){M(t.unstable_now())},P)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(M){M.callback=null},t.unstable_continueExecution=function(){m||h||(m=!0,U(E))},t.unstable_forceFrameRate=function(M){0>M||125<M?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<M?Math.floor(1e3/M):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return n(u)},t.unstable_next=function(M){switch(f){case 1:case 2:case 3:var P=3;break;default:P=f}var B=f;f=P;try{return M()}finally{f=B}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(M,P){switch(M){case 1:case 2:case 3:case 4:case 5:break;default:M=3}var B=f;f=M;try{return P()}finally{f=B}},t.unstable_scheduleCallback=function(M,P,B){var G=t.unstable_now();switch(typeof B=="object"&&B!==null?(B=B.delay,B=typeof B=="number"&&0<B?G+B:G):B=G,M){case 1:var q=-1;break;case 2:q=250;break;case 5:q=1073741823;break;case 4:q=1e4;break;default:q=5e3}return q=B+q,M={id:l++,callback:P,priorityLevel:M,startTime:B,expirationTime:q,sortIndex:-1},B>G?(M.sortIndex=B,e(c,M),n(u)===null&&M===n(c)&&(p?(v(k),k=-1):p=!0,$(w,B-G))):(M.sortIndex=q,e(u,M),m||h||(m=!0,U(E))),M},t.unstable_shouldYield=D,t.unstable_wrapCallback=function(M){var P=f;return function(){var B=f;f=P;try{return M.apply(this,arguments)}finally{f=B}}}})(l2);c2.exports=l2;var NN=c2.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var AN=C,Mn=NN;function ee(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var d2=new Set,qu={};function xa(t,e){Ms(t,e),Ms(t+"Capture",e)}function Ms(t,e){for(qu[t]=e,t=0;t<e.length;t++)d2.add(e[t])}var vo=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),fm=Object.prototype.hasOwnProperty,PN=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,J0={},Z0={};function DN(t){return fm.call(Z0,t)?!0:fm.call(J0,t)?!1:PN.test(t)?Z0[t]=!0:(J0[t]=!0,!1)}function MN(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function ON(t,e,n,r){if(e===null||typeof e>"u"||MN(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function an(t,e,n,r,o,i,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=o,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=a}var Bt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Bt[t]=new an(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Bt[e]=new an(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Bt[t]=new an(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Bt[t]=new an(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Bt[t]=new an(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Bt[t]=new an(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Bt[t]=new an(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Bt[t]=new an(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Bt[t]=new an(t,5,!1,t.toLowerCase(),null,!1,!1)});var cg=/[\-:]([a-z])/g;function lg(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(cg,lg);Bt[e]=new an(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(cg,lg);Bt[e]=new an(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(cg,lg);Bt[e]=new an(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Bt[t]=new an(t,1,!1,t.toLowerCase(),null,!1,!1)});Bt.xlinkHref=new an("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Bt[t]=new an(t,1,!1,t.toLowerCase(),null,!0,!0)});function dg(t,e,n,r){var o=Bt.hasOwnProperty(e)?Bt[e]:null;(o!==null?o.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(ON(e,n,o,r)&&(n=null),r||o===null?DN(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):o.mustUseProperty?t[o.propertyName]=n===null?o.type===3?!1:"":n:(e=o.attributeName,r=o.attributeNamespace,n===null?t.removeAttribute(e):(o=o.type,n=o===3||o===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var _o=AN.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,fl=Symbol.for("react.element"),Ga=Symbol.for("react.portal"),Ka=Symbol.for("react.fragment"),fg=Symbol.for("react.strict_mode"),hm=Symbol.for("react.profiler"),f2=Symbol.for("react.provider"),h2=Symbol.for("react.context"),hg=Symbol.for("react.forward_ref"),pm=Symbol.for("react.suspense"),mm=Symbol.for("react.suspense_list"),pg=Symbol.for("react.memo"),Ho=Symbol.for("react.lazy"),p2=Symbol.for("react.offscreen"),e1=Symbol.iterator;function fu(t){return t===null||typeof t!="object"?null:(t=e1&&t[e1]||t["@@iterator"],typeof t=="function"?t:null)}var ot=Object.assign,zh;function ku(t){if(zh===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);zh=e&&e[1]||""}return`
`+zh+t}var Vh=!1;function Hh(t,e){if(!t||Vh)return"";Vh=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var r=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){r=c}t.call(e.prototype)}else{try{throw Error()}catch(c){r=c}t()}}catch(c){if(c&&r&&typeof c.stack=="string"){for(var o=c.stack.split(`
`),i=r.stack.split(`
`),a=o.length-1,s=i.length-1;1<=a&&0<=s&&o[a]!==i[s];)s--;for(;1<=a&&0<=s;a--,s--)if(o[a]!==i[s]){if(a!==1||s!==1)do if(a--,s--,0>s||o[a]!==i[s]){var u=`
`+o[a].replace(" at new "," at ");return t.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",t.displayName)),u}while(1<=a&&0<=s);break}}}finally{Vh=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?ku(t):""}function FN(t){switch(t.tag){case 5:return ku(t.type);case 16:return ku("Lazy");case 13:return ku("Suspense");case 19:return ku("SuspenseList");case 0:case 2:case 15:return t=Hh(t.type,!1),t;case 11:return t=Hh(t.type.render,!1),t;case 1:return t=Hh(t.type,!0),t;default:return""}}function vm(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Ka:return"Fragment";case Ga:return"Portal";case hm:return"Profiler";case fg:return"StrictMode";case pm:return"Suspense";case mm:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case h2:return(t.displayName||"Context")+".Consumer";case f2:return(t._context.displayName||"Context")+".Provider";case hg:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case pg:return e=t.displayName||null,e!==null?e:vm(t.type)||"Memo";case Ho:e=t._payload,t=t._init;try{return vm(t(e))}catch{}}return null}function LN(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return vm(e);case 8:return e===fg?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Ci(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function m2(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function BN(t){var e=m2(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var o=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return o.call(this)},set:function(a){r=""+a,i.call(this,a)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(a){r=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function hl(t){t._valueTracker||(t._valueTracker=BN(t))}function v2(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=m2(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Ed(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function gm(t,e){var n=e.checked;return ot({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function t1(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Ci(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function g2(t,e){e=e.checked,e!=null&&dg(t,"checked",e,!1)}function ym(t,e){g2(t,e);var n=Ci(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?xm(t,e.type,n):e.hasOwnProperty("defaultValue")&&xm(t,e.type,Ci(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function n1(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function xm(t,e,n){(e!=="number"||Ed(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Iu=Array.isArray;function is(t,e,n,r){if(t=t.options,e){e={};for(var o=0;o<n.length;o++)e["$"+n[o]]=!0;for(n=0;n<t.length;n++)o=e.hasOwnProperty("$"+t[n].value),t[n].selected!==o&&(t[n].selected=o),o&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Ci(n),e=null,o=0;o<t.length;o++){if(t[o].value===n){t[o].selected=!0,r&&(t[o].defaultSelected=!0);return}e!==null||t[o].disabled||(e=t[o])}e!==null&&(e.selected=!0)}}function wm(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(ee(91));return ot({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function r1(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(ee(92));if(Iu(n)){if(1<n.length)throw Error(ee(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Ci(n)}}function y2(t,e){var n=Ci(e.value),r=Ci(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function o1(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function x2(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function bm(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?x2(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var pl,w2=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,o){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,o)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(pl=pl||document.createElement("div"),pl.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=pl.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Xu(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Du={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},jN=["Webkit","ms","Moz","O"];Object.keys(Du).forEach(function(t){jN.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Du[e]=Du[t]})});function b2(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Du.hasOwnProperty(t)&&Du[t]?(""+e).trim():e+"px"}function E2(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,o=b2(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,o):t[n]=o}}var UN=ot({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Em(t,e){if(e){if(UN[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(ee(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(ee(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(ee(61))}if(e.style!=null&&typeof e.style!="object")throw Error(ee(62))}}function Cm(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var _m=null;function mg(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Sm=null,as=null,ss=null;function i1(t){if(t=Oc(t)){if(typeof Sm!="function")throw Error(ee(280));var e=t.stateNode;e&&(e=Uf(e),Sm(t.stateNode,t.type,e))}}function C2(t){as?ss?ss.push(t):ss=[t]:as=t}function _2(){if(as){var t=as,e=ss;if(ss=as=null,i1(t),e)for(t=0;t<e.length;t++)i1(e[t])}}function S2(t,e){return t(e)}function k2(){}var Gh=!1;function I2(t,e,n){if(Gh)return t(e,n);Gh=!0;try{return S2(t,e,n)}finally{Gh=!1,(as!==null||ss!==null)&&(k2(),_2())}}function Yu(t,e){var n=t.stateNode;if(n===null)return null;var r=Uf(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(ee(231,e,typeof n));return n}var km=!1;if(vo)try{var hu={};Object.defineProperty(hu,"passive",{get:function(){km=!0}}),window.addEventListener("test",hu,hu),window.removeEventListener("test",hu,hu)}catch{km=!1}function WN(t,e,n,r,o,i,a,s,u){var c=Array.prototype.slice.call(arguments,3);try{e.apply(n,c)}catch(l){this.onError(l)}}var Mu=!1,Cd=null,_d=!1,Im=null,$N={onError:function(t){Mu=!0,Cd=t}};function zN(t,e,n,r,o,i,a,s,u){Mu=!1,Cd=null,WN.apply($N,arguments)}function VN(t,e,n,r,o,i,a,s,u){if(zN.apply(this,arguments),Mu){if(Mu){var c=Cd;Mu=!1,Cd=null}else throw Error(ee(198));_d||(_d=!0,Im=c)}}function wa(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function R2(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function a1(t){if(wa(t)!==t)throw Error(ee(188))}function HN(t){var e=t.alternate;if(!e){if(e=wa(t),e===null)throw Error(ee(188));return e!==t?null:t}for(var n=t,r=e;;){var o=n.return;if(o===null)break;var i=o.alternate;if(i===null){if(r=o.return,r!==null){n=r;continue}break}if(o.child===i.child){for(i=o.child;i;){if(i===n)return a1(o),t;if(i===r)return a1(o),e;i=i.sibling}throw Error(ee(188))}if(n.return!==r.return)n=o,r=i;else{for(var a=!1,s=o.child;s;){if(s===n){a=!0,n=o,r=i;break}if(s===r){a=!0,r=o,n=i;break}s=s.sibling}if(!a){for(s=i.child;s;){if(s===n){a=!0,n=i,r=o;break}if(s===r){a=!0,r=i,n=o;break}s=s.sibling}if(!a)throw Error(ee(189))}}if(n.alternate!==r)throw Error(ee(190))}if(n.tag!==3)throw Error(ee(188));return n.stateNode.current===n?t:e}function T2(t){return t=HN(t),t!==null?N2(t):null}function N2(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=N2(t);if(e!==null)return e;t=t.sibling}return null}var A2=Mn.unstable_scheduleCallback,s1=Mn.unstable_cancelCallback,GN=Mn.unstable_shouldYield,KN=Mn.unstable_requestPaint,dt=Mn.unstable_now,qN=Mn.unstable_getCurrentPriorityLevel,vg=Mn.unstable_ImmediatePriority,P2=Mn.unstable_UserBlockingPriority,Sd=Mn.unstable_NormalPriority,XN=Mn.unstable_LowPriority,D2=Mn.unstable_IdlePriority,Ff=null,Br=null;function YN(t){if(Br&&typeof Br.onCommitFiberRoot=="function")try{Br.onCommitFiberRoot(Ff,t,void 0,(t.current.flags&128)===128)}catch{}}var pr=Math.clz32?Math.clz32:ZN,QN=Math.log,JN=Math.LN2;function ZN(t){return t>>>=0,t===0?32:31-(QN(t)/JN|0)|0}var ml=64,vl=4194304;function Ru(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function kd(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,o=t.suspendedLanes,i=t.pingedLanes,a=n&268435455;if(a!==0){var s=a&~o;s!==0?r=Ru(s):(i&=a,i!==0&&(r=Ru(i)))}else a=n&~o,a!==0?r=Ru(a):i!==0&&(r=Ru(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&o)&&(o=r&-r,i=e&-e,o>=i||o===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-pr(e),o=1<<n,r|=t[n],e&=~o;return r}function eA(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function tA(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,o=t.expirationTimes,i=t.pendingLanes;0<i;){var a=31-pr(i),s=1<<a,u=o[a];u===-1?(!(s&n)||s&r)&&(o[a]=eA(s,e)):u<=e&&(t.expiredLanes|=s),i&=~s}}function Rm(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function M2(){var t=ml;return ml<<=1,!(ml&4194240)&&(ml=64),t}function Kh(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Dc(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-pr(e),t[e]=n}function nA(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var o=31-pr(n),i=1<<o;e[o]=0,r[o]=-1,t[o]=-1,n&=~i}}function gg(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-pr(n),o=1<<r;o&e|t[r]&e&&(t[r]|=e),n&=~o}}var $e=0;function O2(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var F2,yg,L2,B2,j2,Tm=!1,gl=[],ci=null,li=null,di=null,Qu=new Map,Ju=new Map,Ko=[],rA="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function u1(t,e){switch(t){case"focusin":case"focusout":ci=null;break;case"dragenter":case"dragleave":li=null;break;case"mouseover":case"mouseout":di=null;break;case"pointerover":case"pointerout":Qu.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ju.delete(e.pointerId)}}function pu(t,e,n,r,o,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[o]},e!==null&&(e=Oc(e),e!==null&&yg(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,o!==null&&e.indexOf(o)===-1&&e.push(o),t)}function oA(t,e,n,r,o){switch(e){case"focusin":return ci=pu(ci,t,e,n,r,o),!0;case"dragenter":return li=pu(li,t,e,n,r,o),!0;case"mouseover":return di=pu(di,t,e,n,r,o),!0;case"pointerover":var i=o.pointerId;return Qu.set(i,pu(Qu.get(i)||null,t,e,n,r,o)),!0;case"gotpointercapture":return i=o.pointerId,Ju.set(i,pu(Ju.get(i)||null,t,e,n,r,o)),!0}return!1}function U2(t){var e=Xi(t.target);if(e!==null){var n=wa(e);if(n!==null){if(e=n.tag,e===13){if(e=R2(n),e!==null){t.blockedOn=e,j2(t.priority,function(){L2(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function nd(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Nm(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);_m=r,n.target.dispatchEvent(r),_m=null}else return e=Oc(n),e!==null&&yg(e),t.blockedOn=n,!1;e.shift()}return!0}function c1(t,e,n){nd(t)&&n.delete(e)}function iA(){Tm=!1,ci!==null&&nd(ci)&&(ci=null),li!==null&&nd(li)&&(li=null),di!==null&&nd(di)&&(di=null),Qu.forEach(c1),Ju.forEach(c1)}function mu(t,e){t.blockedOn===e&&(t.blockedOn=null,Tm||(Tm=!0,Mn.unstable_scheduleCallback(Mn.unstable_NormalPriority,iA)))}function Zu(t){function e(o){return mu(o,t)}if(0<gl.length){mu(gl[0],t);for(var n=1;n<gl.length;n++){var r=gl[n];r.blockedOn===t&&(r.blockedOn=null)}}for(ci!==null&&mu(ci,t),li!==null&&mu(li,t),di!==null&&mu(di,t),Qu.forEach(e),Ju.forEach(e),n=0;n<Ko.length;n++)r=Ko[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Ko.length&&(n=Ko[0],n.blockedOn===null);)U2(n),n.blockedOn===null&&Ko.shift()}var us=_o.ReactCurrentBatchConfig,Id=!0;function aA(t,e,n,r){var o=$e,i=us.transition;us.transition=null;try{$e=1,xg(t,e,n,r)}finally{$e=o,us.transition=i}}function sA(t,e,n,r){var o=$e,i=us.transition;us.transition=null;try{$e=4,xg(t,e,n,r)}finally{$e=o,us.transition=i}}function xg(t,e,n,r){if(Id){var o=Nm(t,e,n,r);if(o===null)rp(t,e,r,Rd,n),u1(t,r);else if(oA(o,t,e,n,r))r.stopPropagation();else if(u1(t,r),e&4&&-1<rA.indexOf(t)){for(;o!==null;){var i=Oc(o);if(i!==null&&F2(i),i=Nm(t,e,n,r),i===null&&rp(t,e,r,Rd,n),i===o)break;o=i}o!==null&&r.stopPropagation()}else rp(t,e,r,null,n)}}var Rd=null;function Nm(t,e,n,r){if(Rd=null,t=mg(r),t=Xi(t),t!==null)if(e=wa(t),e===null)t=null;else if(n=e.tag,n===13){if(t=R2(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Rd=t,null}function W2(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(qN()){case vg:return 1;case P2:return 4;case Sd:case XN:return 16;case D2:return 536870912;default:return 16}default:return 16}}var oi=null,wg=null,rd=null;function $2(){if(rd)return rd;var t,e=wg,n=e.length,r,o="value"in oi?oi.value:oi.textContent,i=o.length;for(t=0;t<n&&e[t]===o[t];t++);var a=n-t;for(r=1;r<=a&&e[n-r]===o[i-r];r++);return rd=o.slice(t,1<r?1-r:void 0)}function od(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function yl(){return!0}function l1(){return!1}function Fn(t){function e(n,r,o,i,a){this._reactName=n,this._targetInst=o,this.type=r,this.nativeEvent=i,this.target=a,this.currentTarget=null;for(var s in t)t.hasOwnProperty(s)&&(n=t[s],this[s]=n?n(i):i[s]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?yl:l1,this.isPropagationStopped=l1,this}return ot(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=yl)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=yl)},persist:function(){},isPersistent:yl}),e}var nu={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},bg=Fn(nu),Mc=ot({},nu,{view:0,detail:0}),uA=Fn(Mc),qh,Xh,vu,Lf=ot({},Mc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Eg,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==vu&&(vu&&t.type==="mousemove"?(qh=t.screenX-vu.screenX,Xh=t.screenY-vu.screenY):Xh=qh=0,vu=t),qh)},movementY:function(t){return"movementY"in t?t.movementY:Xh}}),d1=Fn(Lf),cA=ot({},Lf,{dataTransfer:0}),lA=Fn(cA),dA=ot({},Mc,{relatedTarget:0}),Yh=Fn(dA),fA=ot({},nu,{animationName:0,elapsedTime:0,pseudoElement:0}),hA=Fn(fA),pA=ot({},nu,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),mA=Fn(pA),vA=ot({},nu,{data:0}),f1=Fn(vA),gA={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},yA={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},xA={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function wA(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=xA[t])?!!e[t]:!1}function Eg(){return wA}var bA=ot({},Mc,{key:function(t){if(t.key){var e=gA[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=od(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?yA[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Eg,charCode:function(t){return t.type==="keypress"?od(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?od(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),EA=Fn(bA),CA=ot({},Lf,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),h1=Fn(CA),_A=ot({},Mc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Eg}),SA=Fn(_A),kA=ot({},nu,{propertyName:0,elapsedTime:0,pseudoElement:0}),IA=Fn(kA),RA=ot({},Lf,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),TA=Fn(RA),NA=[9,13,27,32],Cg=vo&&"CompositionEvent"in window,Ou=null;vo&&"documentMode"in document&&(Ou=document.documentMode);var AA=vo&&"TextEvent"in window&&!Ou,z2=vo&&(!Cg||Ou&&8<Ou&&11>=Ou),p1=" ",m1=!1;function V2(t,e){switch(t){case"keyup":return NA.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function H2(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var qa=!1;function PA(t,e){switch(t){case"compositionend":return H2(e);case"keypress":return e.which!==32?null:(m1=!0,p1);case"textInput":return t=e.data,t===p1&&m1?null:t;default:return null}}function DA(t,e){if(qa)return t==="compositionend"||!Cg&&V2(t,e)?(t=$2(),rd=wg=oi=null,qa=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return z2&&e.locale!=="ko"?null:e.data;default:return null}}var MA={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function v1(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!MA[t.type]:e==="textarea"}function G2(t,e,n,r){C2(r),e=Td(e,"onChange"),0<e.length&&(n=new bg("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Fu=null,ec=null;function OA(t){rE(t,0)}function Bf(t){var e=Qa(t);if(v2(e))return t}function FA(t,e){if(t==="change")return e}var K2=!1;if(vo){var Qh;if(vo){var Jh="oninput"in document;if(!Jh){var g1=document.createElement("div");g1.setAttribute("oninput","return;"),Jh=typeof g1.oninput=="function"}Qh=Jh}else Qh=!1;K2=Qh&&(!document.documentMode||9<document.documentMode)}function y1(){Fu&&(Fu.detachEvent("onpropertychange",q2),ec=Fu=null)}function q2(t){if(t.propertyName==="value"&&Bf(ec)){var e=[];G2(e,ec,t,mg(t)),I2(OA,e)}}function LA(t,e,n){t==="focusin"?(y1(),Fu=e,ec=n,Fu.attachEvent("onpropertychange",q2)):t==="focusout"&&y1()}function BA(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Bf(ec)}function jA(t,e){if(t==="click")return Bf(e)}function UA(t,e){if(t==="input"||t==="change")return Bf(e)}function WA(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var gr=typeof Object.is=="function"?Object.is:WA;function tc(t,e){if(gr(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var o=n[r];if(!fm.call(e,o)||!gr(t[o],e[o]))return!1}return!0}function x1(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function w1(t,e){var n=x1(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=x1(n)}}function X2(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?X2(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Y2(){for(var t=window,e=Ed();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Ed(t.document)}return e}function _g(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function $A(t){var e=Y2(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&X2(n.ownerDocument.documentElement,n)){if(r!==null&&_g(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var o=n.textContent.length,i=Math.min(r.start,o);r=r.end===void 0?i:Math.min(r.end,o),!t.extend&&i>r&&(o=r,r=i,i=o),o=w1(n,i);var a=w1(n,r);o&&a&&(t.rangeCount!==1||t.anchorNode!==o.node||t.anchorOffset!==o.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(o.node,o.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var zA=vo&&"documentMode"in document&&11>=document.documentMode,Xa=null,Am=null,Lu=null,Pm=!1;function b1(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Pm||Xa==null||Xa!==Ed(r)||(r=Xa,"selectionStart"in r&&_g(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Lu&&tc(Lu,r)||(Lu=r,r=Td(Am,"onSelect"),0<r.length&&(e=new bg("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Xa)))}function xl(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Ya={animationend:xl("Animation","AnimationEnd"),animationiteration:xl("Animation","AnimationIteration"),animationstart:xl("Animation","AnimationStart"),transitionend:xl("Transition","TransitionEnd")},Zh={},Q2={};vo&&(Q2=document.createElement("div").style,"AnimationEvent"in window||(delete Ya.animationend.animation,delete Ya.animationiteration.animation,delete Ya.animationstart.animation),"TransitionEvent"in window||delete Ya.transitionend.transition);function jf(t){if(Zh[t])return Zh[t];if(!Ya[t])return t;var e=Ya[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in Q2)return Zh[t]=e[n];return t}var J2=jf("animationend"),Z2=jf("animationiteration"),eE=jf("animationstart"),tE=jf("transitionend"),nE=new Map,E1="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ti(t,e){nE.set(t,e),xa(e,[t])}for(var ep=0;ep<E1.length;ep++){var tp=E1[ep],VA=tp.toLowerCase(),HA=tp[0].toUpperCase()+tp.slice(1);Ti(VA,"on"+HA)}Ti(J2,"onAnimationEnd");Ti(Z2,"onAnimationIteration");Ti(eE,"onAnimationStart");Ti("dblclick","onDoubleClick");Ti("focusin","onFocus");Ti("focusout","onBlur");Ti(tE,"onTransitionEnd");Ms("onMouseEnter",["mouseout","mouseover"]);Ms("onMouseLeave",["mouseout","mouseover"]);Ms("onPointerEnter",["pointerout","pointerover"]);Ms("onPointerLeave",["pointerout","pointerover"]);xa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));xa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));xa("onBeforeInput",["compositionend","keypress","textInput","paste"]);xa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));xa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));xa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Tu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),GA=new Set("cancel close invalid load scroll toggle".split(" ").concat(Tu));function C1(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,VN(r,e,void 0,t),t.currentTarget=null}function rE(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],o=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var a=r.length-1;0<=a;a--){var s=r[a],u=s.instance,c=s.currentTarget;if(s=s.listener,u!==i&&o.isPropagationStopped())break e;C1(o,s,c),i=u}else for(a=0;a<r.length;a++){if(s=r[a],u=s.instance,c=s.currentTarget,s=s.listener,u!==i&&o.isPropagationStopped())break e;C1(o,s,c),i=u}}}if(_d)throw t=Im,_d=!1,Im=null,t}function qe(t,e){var n=e[Lm];n===void 0&&(n=e[Lm]=new Set);var r=t+"__bubble";n.has(r)||(oE(e,t,2,!1),n.add(r))}function np(t,e,n){var r=0;e&&(r|=4),oE(n,t,r,e)}var wl="_reactListening"+Math.random().toString(36).slice(2);function nc(t){if(!t[wl]){t[wl]=!0,d2.forEach(function(n){n!=="selectionchange"&&(GA.has(n)||np(n,!1,t),np(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[wl]||(e[wl]=!0,np("selectionchange",!1,e))}}function oE(t,e,n,r){switch(W2(e)){case 1:var o=aA;break;case 4:o=sA;break;default:o=xg}n=o.bind(null,e,n,t),o=void 0,!km||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(o=!0),r?o!==void 0?t.addEventListener(e,n,{capture:!0,passive:o}):t.addEventListener(e,n,!0):o!==void 0?t.addEventListener(e,n,{passive:o}):t.addEventListener(e,n,!1)}function rp(t,e,n,r,o){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var a=r.tag;if(a===3||a===4){var s=r.stateNode.containerInfo;if(s===o||s.nodeType===8&&s.parentNode===o)break;if(a===4)for(a=r.return;a!==null;){var u=a.tag;if((u===3||u===4)&&(u=a.stateNode.containerInfo,u===o||u.nodeType===8&&u.parentNode===o))return;a=a.return}for(;s!==null;){if(a=Xi(s),a===null)return;if(u=a.tag,u===5||u===6){r=i=a;continue e}s=s.parentNode}}r=r.return}I2(function(){var c=i,l=mg(n),d=[];e:{var f=nE.get(t);if(f!==void 0){var h=bg,m=t;switch(t){case"keypress":if(od(n)===0)break e;case"keydown":case"keyup":h=EA;break;case"focusin":m="focus",h=Yh;break;case"focusout":m="blur",h=Yh;break;case"beforeblur":case"afterblur":h=Yh;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=d1;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=lA;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=SA;break;case J2:case Z2:case eE:h=hA;break;case tE:h=IA;break;case"scroll":h=uA;break;case"wheel":h=TA;break;case"copy":case"cut":case"paste":h=mA;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=h1}var p=(e&4)!==0,g=!p&&t==="scroll",v=p?f!==null?f+"Capture":null:f;p=[];for(var y=c,x;y!==null;){x=y;var w=x.stateNode;if(x.tag===5&&w!==null&&(x=w,v!==null&&(w=Yu(y,v),w!=null&&p.push(rc(y,w,x)))),g)break;y=y.return}0<p.length&&(f=new h(f,m,null,n,l),d.push({event:f,listeners:p}))}}if(!(e&7)){e:{if(f=t==="mouseover"||t==="pointerover",h=t==="mouseout"||t==="pointerout",f&&n!==_m&&(m=n.relatedTarget||n.fromElement)&&(Xi(m)||m[go]))break e;if((h||f)&&(f=l.window===l?l:(f=l.ownerDocument)?f.defaultView||f.parentWindow:window,h?(m=n.relatedTarget||n.toElement,h=c,m=m?Xi(m):null,m!==null&&(g=wa(m),m!==g||m.tag!==5&&m.tag!==6)&&(m=null)):(h=null,m=c),h!==m)){if(p=d1,w="onMouseLeave",v="onMouseEnter",y="mouse",(t==="pointerout"||t==="pointerover")&&(p=h1,w="onPointerLeave",v="onPointerEnter",y="pointer"),g=h==null?f:Qa(h),x=m==null?f:Qa(m),f=new p(w,y+"leave",h,n,l),f.target=g,f.relatedTarget=x,w=null,Xi(l)===c&&(p=new p(v,y+"enter",m,n,l),p.target=x,p.relatedTarget=g,w=p),g=w,h&&m)t:{for(p=h,v=m,y=0,x=p;x;x=Ma(x))y++;for(x=0,w=v;w;w=Ma(w))x++;for(;0<y-x;)p=Ma(p),y--;for(;0<x-y;)v=Ma(v),x--;for(;y--;){if(p===v||v!==null&&p===v.alternate)break t;p=Ma(p),v=Ma(v)}p=null}else p=null;h!==null&&_1(d,f,h,p,!1),m!==null&&g!==null&&_1(d,g,m,p,!0)}}e:{if(f=c?Qa(c):window,h=f.nodeName&&f.nodeName.toLowerCase(),h==="select"||h==="input"&&f.type==="file")var E=FA;else if(v1(f))if(K2)E=UA;else{E=BA;var _=LA}else(h=f.nodeName)&&h.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(E=jA);if(E&&(E=E(t,c))){G2(d,E,n,l);break e}_&&_(t,f,c),t==="focusout"&&(_=f._wrapperState)&&_.controlled&&f.type==="number"&&xm(f,"number",f.value)}switch(_=c?Qa(c):window,t){case"focusin":(v1(_)||_.contentEditable==="true")&&(Xa=_,Am=c,Lu=null);break;case"focusout":Lu=Am=Xa=null;break;case"mousedown":Pm=!0;break;case"contextmenu":case"mouseup":case"dragend":Pm=!1,b1(d,n,l);break;case"selectionchange":if(zA)break;case"keydown":case"keyup":b1(d,n,l)}var S;if(Cg)e:{switch(t){case"compositionstart":var k="onCompositionStart";break e;case"compositionend":k="onCompositionEnd";break e;case"compositionupdate":k="onCompositionUpdate";break e}k=void 0}else qa?V2(t,n)&&(k="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(k="onCompositionStart");k&&(z2&&n.locale!=="ko"&&(qa||k!=="onCompositionStart"?k==="onCompositionEnd"&&qa&&(S=$2()):(oi=l,wg="value"in oi?oi.value:oi.textContent,qa=!0)),_=Td(c,k),0<_.length&&(k=new f1(k,t,null,n,l),d.push({event:k,listeners:_}),S?k.data=S:(S=H2(n),S!==null&&(k.data=S)))),(S=AA?PA(t,n):DA(t,n))&&(c=Td(c,"onBeforeInput"),0<c.length&&(l=new f1("onBeforeInput","beforeinput",null,n,l),d.push({event:l,listeners:c}),l.data=S))}rE(d,e)})}function rc(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Td(t,e){for(var n=e+"Capture",r=[];t!==null;){var o=t,i=o.stateNode;o.tag===5&&i!==null&&(o=i,i=Yu(t,n),i!=null&&r.unshift(rc(t,i,o)),i=Yu(t,e),i!=null&&r.push(rc(t,i,o))),t=t.return}return r}function Ma(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function _1(t,e,n,r,o){for(var i=e._reactName,a=[];n!==null&&n!==r;){var s=n,u=s.alternate,c=s.stateNode;if(u!==null&&u===r)break;s.tag===5&&c!==null&&(s=c,o?(u=Yu(n,i),u!=null&&a.unshift(rc(n,u,s))):o||(u=Yu(n,i),u!=null&&a.push(rc(n,u,s)))),n=n.return}a.length!==0&&t.push({event:e,listeners:a})}var KA=/\r\n?/g,qA=/\u0000|\uFFFD/g;function S1(t){return(typeof t=="string"?t:""+t).replace(KA,`
`).replace(qA,"")}function bl(t,e,n){if(e=S1(e),S1(t)!==e&&n)throw Error(ee(425))}function Nd(){}var Dm=null,Mm=null;function Om(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Fm=typeof setTimeout=="function"?setTimeout:void 0,XA=typeof clearTimeout=="function"?clearTimeout:void 0,k1=typeof Promise=="function"?Promise:void 0,YA=typeof queueMicrotask=="function"?queueMicrotask:typeof k1<"u"?function(t){return k1.resolve(null).then(t).catch(QA)}:Fm;function QA(t){setTimeout(function(){throw t})}function op(t,e){var n=e,r=0;do{var o=n.nextSibling;if(t.removeChild(n),o&&o.nodeType===8)if(n=o.data,n==="/$"){if(r===0){t.removeChild(o),Zu(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=o}while(n);Zu(e)}function fi(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function I1(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var ru=Math.random().toString(36).slice(2),Pr="__reactFiber$"+ru,oc="__reactProps$"+ru,go="__reactContainer$"+ru,Lm="__reactEvents$"+ru,JA="__reactListeners$"+ru,ZA="__reactHandles$"+ru;function Xi(t){var e=t[Pr];if(e)return e;for(var n=t.parentNode;n;){if(e=n[go]||n[Pr]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=I1(t);t!==null;){if(n=t[Pr])return n;t=I1(t)}return e}t=n,n=t.parentNode}return null}function Oc(t){return t=t[Pr]||t[go],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Qa(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(ee(33))}function Uf(t){return t[oc]||null}var Bm=[],Ja=-1;function Ni(t){return{current:t}}function Ye(t){0>Ja||(t.current=Bm[Ja],Bm[Ja]=null,Ja--)}function He(t,e){Ja++,Bm[Ja]=t.current,t.current=e}var _i={},Qt=Ni(_i),pn=Ni(!1),ca=_i;function Os(t,e){var n=t.type.contextTypes;if(!n)return _i;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var o={},i;for(i in n)o[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=o),o}function mn(t){return t=t.childContextTypes,t!=null}function Ad(){Ye(pn),Ye(Qt)}function R1(t,e,n){if(Qt.current!==_i)throw Error(ee(168));He(Qt,e),He(pn,n)}function iE(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var o in r)if(!(o in e))throw Error(ee(108,LN(t)||"Unknown",o));return ot({},n,r)}function Pd(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||_i,ca=Qt.current,He(Qt,t),He(pn,pn.current),!0}function T1(t,e,n){var r=t.stateNode;if(!r)throw Error(ee(169));n?(t=iE(t,e,ca),r.__reactInternalMemoizedMergedChildContext=t,Ye(pn),Ye(Qt),He(Qt,t)):Ye(pn),He(pn,n)}var io=null,Wf=!1,ip=!1;function aE(t){io===null?io=[t]:io.push(t)}function eP(t){Wf=!0,aE(t)}function Ai(){if(!ip&&io!==null){ip=!0;var t=0,e=$e;try{var n=io;for($e=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}io=null,Wf=!1}catch(o){throw io!==null&&(io=io.slice(t+1)),A2(vg,Ai),o}finally{$e=e,ip=!1}}return null}var Za=[],es=0,Dd=null,Md=0,jn=[],Un=0,la=null,co=1,lo="";function Wi(t,e){Za[es++]=Md,Za[es++]=Dd,Dd=t,Md=e}function sE(t,e,n){jn[Un++]=co,jn[Un++]=lo,jn[Un++]=la,la=t;var r=co;t=lo;var o=32-pr(r)-1;r&=~(1<<o),n+=1;var i=32-pr(e)+o;if(30<i){var a=o-o%5;i=(r&(1<<a)-1).toString(32),r>>=a,o-=a,co=1<<32-pr(e)+o|n<<o|r,lo=i+t}else co=1<<i|n<<o|r,lo=t}function Sg(t){t.return!==null&&(Wi(t,1),sE(t,1,0))}function kg(t){for(;t===Dd;)Dd=Za[--es],Za[es]=null,Md=Za[--es],Za[es]=null;for(;t===la;)la=jn[--Un],jn[Un]=null,lo=jn[--Un],jn[Un]=null,co=jn[--Un],jn[Un]=null}var An=null,kn=null,Ze=!1,cr=null;function uE(t,e){var n=zn(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function N1(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,An=t,kn=fi(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,An=t,kn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=la!==null?{id:co,overflow:lo}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=zn(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,An=t,kn=null,!0):!1;default:return!1}}function jm(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Um(t){if(Ze){var e=kn;if(e){var n=e;if(!N1(t,e)){if(jm(t))throw Error(ee(418));e=fi(n.nextSibling);var r=An;e&&N1(t,e)?uE(r,n):(t.flags=t.flags&-4097|2,Ze=!1,An=t)}}else{if(jm(t))throw Error(ee(418));t.flags=t.flags&-4097|2,Ze=!1,An=t}}}function A1(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;An=t}function El(t){if(t!==An)return!1;if(!Ze)return A1(t),Ze=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Om(t.type,t.memoizedProps)),e&&(e=kn)){if(jm(t))throw cE(),Error(ee(418));for(;e;)uE(t,e),e=fi(e.nextSibling)}if(A1(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(ee(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){kn=fi(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}kn=null}}else kn=An?fi(t.stateNode.nextSibling):null;return!0}function cE(){for(var t=kn;t;)t=fi(t.nextSibling)}function Fs(){kn=An=null,Ze=!1}function Ig(t){cr===null?cr=[t]:cr.push(t)}var tP=_o.ReactCurrentBatchConfig;function gu(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(ee(309));var r=n.stateNode}if(!r)throw Error(ee(147,t));var o=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(a){var s=o.refs;a===null?delete s[i]:s[i]=a},e._stringRef=i,e)}if(typeof t!="string")throw Error(ee(284));if(!n._owner)throw Error(ee(290,t))}return t}function Cl(t,e){throw t=Object.prototype.toString.call(e),Error(ee(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function P1(t){var e=t._init;return e(t._payload)}function lE(t){function e(v,y){if(t){var x=v.deletions;x===null?(v.deletions=[y],v.flags|=16):x.push(y)}}function n(v,y){if(!t)return null;for(;y!==null;)e(v,y),y=y.sibling;return null}function r(v,y){for(v=new Map;y!==null;)y.key!==null?v.set(y.key,y):v.set(y.index,y),y=y.sibling;return v}function o(v,y){return v=vi(v,y),v.index=0,v.sibling=null,v}function i(v,y,x){return v.index=x,t?(x=v.alternate,x!==null?(x=x.index,x<y?(v.flags|=2,y):x):(v.flags|=2,y)):(v.flags|=1048576,y)}function a(v){return t&&v.alternate===null&&(v.flags|=2),v}function s(v,y,x,w){return y===null||y.tag!==6?(y=fp(x,v.mode,w),y.return=v,y):(y=o(y,x),y.return=v,y)}function u(v,y,x,w){var E=x.type;return E===Ka?l(v,y,x.props.children,w,x.key):y!==null&&(y.elementType===E||typeof E=="object"&&E!==null&&E.$$typeof===Ho&&P1(E)===y.type)?(w=o(y,x.props),w.ref=gu(v,y,x),w.return=v,w):(w=dd(x.type,x.key,x.props,null,v.mode,w),w.ref=gu(v,y,x),w.return=v,w)}function c(v,y,x,w){return y===null||y.tag!==4||y.stateNode.containerInfo!==x.containerInfo||y.stateNode.implementation!==x.implementation?(y=hp(x,v.mode,w),y.return=v,y):(y=o(y,x.children||[]),y.return=v,y)}function l(v,y,x,w,E){return y===null||y.tag!==7?(y=sa(x,v.mode,w,E),y.return=v,y):(y=o(y,x),y.return=v,y)}function d(v,y,x){if(typeof y=="string"&&y!==""||typeof y=="number")return y=fp(""+y,v.mode,x),y.return=v,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case fl:return x=dd(y.type,y.key,y.props,null,v.mode,x),x.ref=gu(v,null,y),x.return=v,x;case Ga:return y=hp(y,v.mode,x),y.return=v,y;case Ho:var w=y._init;return d(v,w(y._payload),x)}if(Iu(y)||fu(y))return y=sa(y,v.mode,x,null),y.return=v,y;Cl(v,y)}return null}function f(v,y,x,w){var E=y!==null?y.key:null;if(typeof x=="string"&&x!==""||typeof x=="number")return E!==null?null:s(v,y,""+x,w);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case fl:return x.key===E?u(v,y,x,w):null;case Ga:return x.key===E?c(v,y,x,w):null;case Ho:return E=x._init,f(v,y,E(x._payload),w)}if(Iu(x)||fu(x))return E!==null?null:l(v,y,x,w,null);Cl(v,x)}return null}function h(v,y,x,w,E){if(typeof w=="string"&&w!==""||typeof w=="number")return v=v.get(x)||null,s(y,v,""+w,E);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case fl:return v=v.get(w.key===null?x:w.key)||null,u(y,v,w,E);case Ga:return v=v.get(w.key===null?x:w.key)||null,c(y,v,w,E);case Ho:var _=w._init;return h(v,y,x,_(w._payload),E)}if(Iu(w)||fu(w))return v=v.get(x)||null,l(y,v,w,E,null);Cl(y,w)}return null}function m(v,y,x,w){for(var E=null,_=null,S=y,k=y=0,I=null;S!==null&&k<x.length;k++){S.index>k?(I=S,S=null):I=S.sibling;var R=f(v,S,x[k],w);if(R===null){S===null&&(S=I);break}t&&S&&R.alternate===null&&e(v,S),y=i(R,y,k),_===null?E=R:_.sibling=R,_=R,S=I}if(k===x.length)return n(v,S),Ze&&Wi(v,k),E;if(S===null){for(;k<x.length;k++)S=d(v,x[k],w),S!==null&&(y=i(S,y,k),_===null?E=S:_.sibling=S,_=S);return Ze&&Wi(v,k),E}for(S=r(v,S);k<x.length;k++)I=h(S,v,k,x[k],w),I!==null&&(t&&I.alternate!==null&&S.delete(I.key===null?k:I.key),y=i(I,y,k),_===null?E=I:_.sibling=I,_=I);return t&&S.forEach(function(D){return e(v,D)}),Ze&&Wi(v,k),E}function p(v,y,x,w){var E=fu(x);if(typeof E!="function")throw Error(ee(150));if(x=E.call(x),x==null)throw Error(ee(151));for(var _=E=null,S=y,k=y=0,I=null,R=x.next();S!==null&&!R.done;k++,R=x.next()){S.index>k?(I=S,S=null):I=S.sibling;var D=f(v,S,R.value,w);if(D===null){S===null&&(S=I);break}t&&S&&D.alternate===null&&e(v,S),y=i(D,y,k),_===null?E=D:_.sibling=D,_=D,S=I}if(R.done)return n(v,S),Ze&&Wi(v,k),E;if(S===null){for(;!R.done;k++,R=x.next())R=d(v,R.value,w),R!==null&&(y=i(R,y,k),_===null?E=R:_.sibling=R,_=R);return Ze&&Wi(v,k),E}for(S=r(v,S);!R.done;k++,R=x.next())R=h(S,v,k,R.value,w),R!==null&&(t&&R.alternate!==null&&S.delete(R.key===null?k:R.key),y=i(R,y,k),_===null?E=R:_.sibling=R,_=R);return t&&S.forEach(function(A){return e(v,A)}),Ze&&Wi(v,k),E}function g(v,y,x,w){if(typeof x=="object"&&x!==null&&x.type===Ka&&x.key===null&&(x=x.props.children),typeof x=="object"&&x!==null){switch(x.$$typeof){case fl:e:{for(var E=x.key,_=y;_!==null;){if(_.key===E){if(E=x.type,E===Ka){if(_.tag===7){n(v,_.sibling),y=o(_,x.props.children),y.return=v,v=y;break e}}else if(_.elementType===E||typeof E=="object"&&E!==null&&E.$$typeof===Ho&&P1(E)===_.type){n(v,_.sibling),y=o(_,x.props),y.ref=gu(v,_,x),y.return=v,v=y;break e}n(v,_);break}else e(v,_);_=_.sibling}x.type===Ka?(y=sa(x.props.children,v.mode,w,x.key),y.return=v,v=y):(w=dd(x.type,x.key,x.props,null,v.mode,w),w.ref=gu(v,y,x),w.return=v,v=w)}return a(v);case Ga:e:{for(_=x.key;y!==null;){if(y.key===_)if(y.tag===4&&y.stateNode.containerInfo===x.containerInfo&&y.stateNode.implementation===x.implementation){n(v,y.sibling),y=o(y,x.children||[]),y.return=v,v=y;break e}else{n(v,y);break}else e(v,y);y=y.sibling}y=hp(x,v.mode,w),y.return=v,v=y}return a(v);case Ho:return _=x._init,g(v,y,_(x._payload),w)}if(Iu(x))return m(v,y,x,w);if(fu(x))return p(v,y,x,w);Cl(v,x)}return typeof x=="string"&&x!==""||typeof x=="number"?(x=""+x,y!==null&&y.tag===6?(n(v,y.sibling),y=o(y,x),y.return=v,v=y):(n(v,y),y=fp(x,v.mode,w),y.return=v,v=y),a(v)):n(v,y)}return g}var Ls=lE(!0),dE=lE(!1),Od=Ni(null),Fd=null,ts=null,Rg=null;function Tg(){Rg=ts=Fd=null}function Ng(t){var e=Od.current;Ye(Od),t._currentValue=e}function Wm(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function cs(t,e){Fd=t,Rg=ts=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(hn=!0),t.firstContext=null)}function Kn(t){var e=t._currentValue;if(Rg!==t)if(t={context:t,memoizedValue:e,next:null},ts===null){if(Fd===null)throw Error(ee(308));ts=t,Fd.dependencies={lanes:0,firstContext:t}}else ts=ts.next=t;return e}var Yi=null;function Ag(t){Yi===null?Yi=[t]:Yi.push(t)}function fE(t,e,n,r){var o=e.interleaved;return o===null?(n.next=n,Ag(e)):(n.next=o.next,o.next=n),e.interleaved=n,yo(t,r)}function yo(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Go=!1;function Pg(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function hE(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function po(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function hi(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Oe&2){var o=r.pending;return o===null?e.next=e:(e.next=o.next,o.next=e),r.pending=e,yo(t,n)}return o=r.interleaved,o===null?(e.next=e,Ag(r)):(e.next=o.next,o.next=e),r.interleaved=e,yo(t,n)}function id(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,gg(t,n)}}function D1(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var o=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?o=i=a:i=i.next=a,n=n.next}while(n!==null);i===null?o=i=e:i=i.next=e}else o=i=e;n={baseState:r.baseState,firstBaseUpdate:o,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Ld(t,e,n,r){var o=t.updateQueue;Go=!1;var i=o.firstBaseUpdate,a=o.lastBaseUpdate,s=o.shared.pending;if(s!==null){o.shared.pending=null;var u=s,c=u.next;u.next=null,a===null?i=c:a.next=c,a=u;var l=t.alternate;l!==null&&(l=l.updateQueue,s=l.lastBaseUpdate,s!==a&&(s===null?l.firstBaseUpdate=c:s.next=c,l.lastBaseUpdate=u))}if(i!==null){var d=o.baseState;a=0,l=c=u=null,s=i;do{var f=s.lane,h=s.eventTime;if((r&f)===f){l!==null&&(l=l.next={eventTime:h,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var m=t,p=s;switch(f=e,h=n,p.tag){case 1:if(m=p.payload,typeof m=="function"){d=m.call(h,d,f);break e}d=m;break e;case 3:m.flags=m.flags&-65537|128;case 0:if(m=p.payload,f=typeof m=="function"?m.call(h,d,f):m,f==null)break e;d=ot({},d,f);break e;case 2:Go=!0}}s.callback!==null&&s.lane!==0&&(t.flags|=64,f=o.effects,f===null?o.effects=[s]:f.push(s))}else h={eventTime:h,lane:f,tag:s.tag,payload:s.payload,callback:s.callback,next:null},l===null?(c=l=h,u=d):l=l.next=h,a|=f;if(s=s.next,s===null){if(s=o.shared.pending,s===null)break;f=s,s=f.next,f.next=null,o.lastBaseUpdate=f,o.shared.pending=null}}while(!0);if(l===null&&(u=d),o.baseState=u,o.firstBaseUpdate=c,o.lastBaseUpdate=l,e=o.shared.interleaved,e!==null){o=e;do a|=o.lane,o=o.next;while(o!==e)}else i===null&&(o.shared.lanes=0);fa|=a,t.lanes=a,t.memoizedState=d}}function M1(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],o=r.callback;if(o!==null){if(r.callback=null,r=n,typeof o!="function")throw Error(ee(191,o));o.call(r)}}}var Fc={},jr=Ni(Fc),ic=Ni(Fc),ac=Ni(Fc);function Qi(t){if(t===Fc)throw Error(ee(174));return t}function Dg(t,e){switch(He(ac,e),He(ic,t),He(jr,Fc),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:bm(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=bm(e,t)}Ye(jr),He(jr,e)}function Bs(){Ye(jr),Ye(ic),Ye(ac)}function pE(t){Qi(ac.current);var e=Qi(jr.current),n=bm(e,t.type);e!==n&&(He(ic,t),He(jr,n))}function Mg(t){ic.current===t&&(Ye(jr),Ye(ic))}var et=Ni(0);function Bd(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var ap=[];function Og(){for(var t=0;t<ap.length;t++)ap[t]._workInProgressVersionPrimary=null;ap.length=0}var ad=_o.ReactCurrentDispatcher,sp=_o.ReactCurrentBatchConfig,da=0,rt=null,yt=null,Rt=null,jd=!1,Bu=!1,sc=0,nP=0;function $t(){throw Error(ee(321))}function Fg(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!gr(t[n],e[n]))return!1;return!0}function Lg(t,e,n,r,o,i){if(da=i,rt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,ad.current=t===null||t.memoizedState===null?aP:sP,t=n(r,o),Bu){i=0;do{if(Bu=!1,sc=0,25<=i)throw Error(ee(301));i+=1,Rt=yt=null,e.updateQueue=null,ad.current=uP,t=n(r,o)}while(Bu)}if(ad.current=Ud,e=yt!==null&&yt.next!==null,da=0,Rt=yt=rt=null,jd=!1,e)throw Error(ee(300));return t}function Bg(){var t=sc!==0;return sc=0,t}function kr(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Rt===null?rt.memoizedState=Rt=t:Rt=Rt.next=t,Rt}function qn(){if(yt===null){var t=rt.alternate;t=t!==null?t.memoizedState:null}else t=yt.next;var e=Rt===null?rt.memoizedState:Rt.next;if(e!==null)Rt=e,yt=t;else{if(t===null)throw Error(ee(310));yt=t,t={memoizedState:yt.memoizedState,baseState:yt.baseState,baseQueue:yt.baseQueue,queue:yt.queue,next:null},Rt===null?rt.memoizedState=Rt=t:Rt=Rt.next=t}return Rt}function uc(t,e){return typeof e=="function"?e(t):e}function up(t){var e=qn(),n=e.queue;if(n===null)throw Error(ee(311));n.lastRenderedReducer=t;var r=yt,o=r.baseQueue,i=n.pending;if(i!==null){if(o!==null){var a=o.next;o.next=i.next,i.next=a}r.baseQueue=o=i,n.pending=null}if(o!==null){i=o.next,r=r.baseState;var s=a=null,u=null,c=i;do{var l=c.lane;if((da&l)===l)u!==null&&(u=u.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:t(r,c.action);else{var d={lane:l,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};u===null?(s=u=d,a=r):u=u.next=d,rt.lanes|=l,fa|=l}c=c.next}while(c!==null&&c!==i);u===null?a=r:u.next=s,gr(r,e.memoizedState)||(hn=!0),e.memoizedState=r,e.baseState=a,e.baseQueue=u,n.lastRenderedState=r}if(t=n.interleaved,t!==null){o=t;do i=o.lane,rt.lanes|=i,fa|=i,o=o.next;while(o!==t)}else o===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function cp(t){var e=qn(),n=e.queue;if(n===null)throw Error(ee(311));n.lastRenderedReducer=t;var r=n.dispatch,o=n.pending,i=e.memoizedState;if(o!==null){n.pending=null;var a=o=o.next;do i=t(i,a.action),a=a.next;while(a!==o);gr(i,e.memoizedState)||(hn=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function mE(){}function vE(t,e){var n=rt,r=qn(),o=e(),i=!gr(r.memoizedState,o);if(i&&(r.memoizedState=o,hn=!0),r=r.queue,jg(xE.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||Rt!==null&&Rt.memoizedState.tag&1){if(n.flags|=2048,cc(9,yE.bind(null,n,r,o,e),void 0,null),Tt===null)throw Error(ee(349));da&30||gE(n,e,o)}return o}function gE(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=rt.updateQueue,e===null?(e={lastEffect:null,stores:null},rt.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function yE(t,e,n,r){e.value=n,e.getSnapshot=r,wE(e)&&bE(t)}function xE(t,e,n){return n(function(){wE(e)&&bE(t)})}function wE(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!gr(t,n)}catch{return!0}}function bE(t){var e=yo(t,1);e!==null&&mr(e,t,1,-1)}function O1(t){var e=kr();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:uc,lastRenderedState:t},e.queue=t,t=t.dispatch=iP.bind(null,rt,t),[e.memoizedState,t]}function cc(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=rt.updateQueue,e===null?(e={lastEffect:null,stores:null},rt.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function EE(){return qn().memoizedState}function sd(t,e,n,r){var o=kr();rt.flags|=t,o.memoizedState=cc(1|e,n,void 0,r===void 0?null:r)}function $f(t,e,n,r){var o=qn();r=r===void 0?null:r;var i=void 0;if(yt!==null){var a=yt.memoizedState;if(i=a.destroy,r!==null&&Fg(r,a.deps)){o.memoizedState=cc(e,n,i,r);return}}rt.flags|=t,o.memoizedState=cc(1|e,n,i,r)}function F1(t,e){return sd(8390656,8,t,e)}function jg(t,e){return $f(2048,8,t,e)}function CE(t,e){return $f(4,2,t,e)}function _E(t,e){return $f(4,4,t,e)}function SE(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function kE(t,e,n){return n=n!=null?n.concat([t]):null,$f(4,4,SE.bind(null,e,t),n)}function Ug(){}function IE(t,e){var n=qn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Fg(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function RE(t,e){var n=qn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Fg(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function TE(t,e,n){return da&21?(gr(n,e)||(n=M2(),rt.lanes|=n,fa|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,hn=!0),t.memoizedState=n)}function rP(t,e){var n=$e;$e=n!==0&&4>n?n:4,t(!0);var r=sp.transition;sp.transition={};try{t(!1),e()}finally{$e=n,sp.transition=r}}function NE(){return qn().memoizedState}function oP(t,e,n){var r=mi(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},AE(t))PE(e,n);else if(n=fE(t,e,n,r),n!==null){var o=nn();mr(n,t,r,o),DE(n,e,r)}}function iP(t,e,n){var r=mi(t),o={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(AE(t))PE(e,o);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var a=e.lastRenderedState,s=i(a,n);if(o.hasEagerState=!0,o.eagerState=s,gr(s,a)){var u=e.interleaved;u===null?(o.next=o,Ag(e)):(o.next=u.next,u.next=o),e.interleaved=o;return}}catch{}finally{}n=fE(t,e,o,r),n!==null&&(o=nn(),mr(n,t,r,o),DE(n,e,r))}}function AE(t){var e=t.alternate;return t===rt||e!==null&&e===rt}function PE(t,e){Bu=jd=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function DE(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,gg(t,n)}}var Ud={readContext:Kn,useCallback:$t,useContext:$t,useEffect:$t,useImperativeHandle:$t,useInsertionEffect:$t,useLayoutEffect:$t,useMemo:$t,useReducer:$t,useRef:$t,useState:$t,useDebugValue:$t,useDeferredValue:$t,useTransition:$t,useMutableSource:$t,useSyncExternalStore:$t,useId:$t,unstable_isNewReconciler:!1},aP={readContext:Kn,useCallback:function(t,e){return kr().memoizedState=[t,e===void 0?null:e],t},useContext:Kn,useEffect:F1,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,sd(4194308,4,SE.bind(null,e,t),n)},useLayoutEffect:function(t,e){return sd(4194308,4,t,e)},useInsertionEffect:function(t,e){return sd(4,2,t,e)},useMemo:function(t,e){var n=kr();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=kr();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=oP.bind(null,rt,t),[r.memoizedState,t]},useRef:function(t){var e=kr();return t={current:t},e.memoizedState=t},useState:O1,useDebugValue:Ug,useDeferredValue:function(t){return kr().memoizedState=t},useTransition:function(){var t=O1(!1),e=t[0];return t=rP.bind(null,t[1]),kr().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=rt,o=kr();if(Ze){if(n===void 0)throw Error(ee(407));n=n()}else{if(n=e(),Tt===null)throw Error(ee(349));da&30||gE(r,e,n)}o.memoizedState=n;var i={value:n,getSnapshot:e};return o.queue=i,F1(xE.bind(null,r,i,t),[t]),r.flags|=2048,cc(9,yE.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=kr(),e=Tt.identifierPrefix;if(Ze){var n=lo,r=co;n=(r&~(1<<32-pr(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=sc++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=nP++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},sP={readContext:Kn,useCallback:IE,useContext:Kn,useEffect:jg,useImperativeHandle:kE,useInsertionEffect:CE,useLayoutEffect:_E,useMemo:RE,useReducer:up,useRef:EE,useState:function(){return up(uc)},useDebugValue:Ug,useDeferredValue:function(t){var e=qn();return TE(e,yt.memoizedState,t)},useTransition:function(){var t=up(uc)[0],e=qn().memoizedState;return[t,e]},useMutableSource:mE,useSyncExternalStore:vE,useId:NE,unstable_isNewReconciler:!1},uP={readContext:Kn,useCallback:IE,useContext:Kn,useEffect:jg,useImperativeHandle:kE,useInsertionEffect:CE,useLayoutEffect:_E,useMemo:RE,useReducer:cp,useRef:EE,useState:function(){return cp(uc)},useDebugValue:Ug,useDeferredValue:function(t){var e=qn();return yt===null?e.memoizedState=t:TE(e,yt.memoizedState,t)},useTransition:function(){var t=cp(uc)[0],e=qn().memoizedState;return[t,e]},useMutableSource:mE,useSyncExternalStore:vE,useId:NE,unstable_isNewReconciler:!1};function or(t,e){if(t&&t.defaultProps){e=ot({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function $m(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:ot({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var zf={isMounted:function(t){return(t=t._reactInternals)?wa(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=nn(),o=mi(t),i=po(r,o);i.payload=e,n!=null&&(i.callback=n),e=hi(t,i,o),e!==null&&(mr(e,t,o,r),id(e,t,o))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=nn(),o=mi(t),i=po(r,o);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=hi(t,i,o),e!==null&&(mr(e,t,o,r),id(e,t,o))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=nn(),r=mi(t),o=po(n,r);o.tag=2,e!=null&&(o.callback=e),e=hi(t,o,r),e!==null&&(mr(e,t,r,n),id(e,t,r))}};function L1(t,e,n,r,o,i,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,a):e.prototype&&e.prototype.isPureReactComponent?!tc(n,r)||!tc(o,i):!0}function ME(t,e,n){var r=!1,o=_i,i=e.contextType;return typeof i=="object"&&i!==null?i=Kn(i):(o=mn(e)?ca:Qt.current,r=e.contextTypes,i=(r=r!=null)?Os(t,o):_i),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=zf,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=o,t.__reactInternalMemoizedMaskedChildContext=i),e}function B1(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&zf.enqueueReplaceState(e,e.state,null)}function zm(t,e,n,r){var o=t.stateNode;o.props=n,o.state=t.memoizedState,o.refs={},Pg(t);var i=e.contextType;typeof i=="object"&&i!==null?o.context=Kn(i):(i=mn(e)?ca:Qt.current,o.context=Os(t,i)),o.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&($m(t,e,i,n),o.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof o.getSnapshotBeforeUpdate=="function"||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(e=o.state,typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount(),e!==o.state&&zf.enqueueReplaceState(o,o.state,null),Ld(t,n,o,r),o.state=t.memoizedState),typeof o.componentDidMount=="function"&&(t.flags|=4194308)}function js(t,e){try{var n="",r=e;do n+=FN(r),r=r.return;while(r);var o=n}catch(i){o=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:o,digest:null}}function lp(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Vm(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var cP=typeof WeakMap=="function"?WeakMap:Map;function OE(t,e,n){n=po(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){$d||($d=!0,ev=r),Vm(t,e)},n}function FE(t,e,n){n=po(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var o=e.value;n.payload=function(){return r(o)},n.callback=function(){Vm(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){Vm(t,e),typeof r!="function"&&(pi===null?pi=new Set([this]):pi.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),n}function j1(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new cP;var o=new Set;r.set(e,o)}else o=r.get(e),o===void 0&&(o=new Set,r.set(e,o));o.has(n)||(o.add(n),t=CP.bind(null,t,e,n),e.then(t,t))}function U1(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function W1(t,e,n,r,o){return t.mode&1?(t.flags|=65536,t.lanes=o,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=po(-1,1),e.tag=2,hi(n,e,1))),n.lanes|=1),t)}var lP=_o.ReactCurrentOwner,hn=!1;function en(t,e,n,r){e.child=t===null?dE(e,null,n,r):Ls(e,t.child,n,r)}function $1(t,e,n,r,o){n=n.render;var i=e.ref;return cs(e,o),r=Lg(t,e,n,r,i,o),n=Bg(),t!==null&&!hn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~o,xo(t,e,o)):(Ze&&n&&Sg(e),e.flags|=1,en(t,e,r,o),e.child)}function z1(t,e,n,r,o){if(t===null){var i=n.type;return typeof i=="function"&&!qg(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,LE(t,e,i,r,o)):(t=dd(n.type,null,r,e,e.mode,o),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&o)){var a=i.memoizedProps;if(n=n.compare,n=n!==null?n:tc,n(a,r)&&t.ref===e.ref)return xo(t,e,o)}return e.flags|=1,t=vi(i,r),t.ref=e.ref,t.return=e,e.child=t}function LE(t,e,n,r,o){if(t!==null){var i=t.memoizedProps;if(tc(i,r)&&t.ref===e.ref)if(hn=!1,e.pendingProps=r=i,(t.lanes&o)!==0)t.flags&131072&&(hn=!0);else return e.lanes=t.lanes,xo(t,e,o)}return Hm(t,e,n,r,o)}function BE(t,e,n){var r=e.pendingProps,o=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},He(rs,En),En|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,He(rs,En),En|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,He(rs,En),En|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,He(rs,En),En|=r;return en(t,e,o,n),e.child}function jE(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Hm(t,e,n,r,o){var i=mn(n)?ca:Qt.current;return i=Os(e,i),cs(e,o),n=Lg(t,e,n,r,i,o),r=Bg(),t!==null&&!hn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~o,xo(t,e,o)):(Ze&&r&&Sg(e),e.flags|=1,en(t,e,n,o),e.child)}function V1(t,e,n,r,o){if(mn(n)){var i=!0;Pd(e)}else i=!1;if(cs(e,o),e.stateNode===null)ud(t,e),ME(e,n,r),zm(e,n,r,o),r=!0;else if(t===null){var a=e.stateNode,s=e.memoizedProps;a.props=s;var u=a.context,c=n.contextType;typeof c=="object"&&c!==null?c=Kn(c):(c=mn(n)?ca:Qt.current,c=Os(e,c));var l=n.getDerivedStateFromProps,d=typeof l=="function"||typeof a.getSnapshotBeforeUpdate=="function";d||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(s!==r||u!==c)&&B1(e,a,r,c),Go=!1;var f=e.memoizedState;a.state=f,Ld(e,r,a,o),u=e.memoizedState,s!==r||f!==u||pn.current||Go?(typeof l=="function"&&($m(e,n,l,r),u=e.memoizedState),(s=Go||L1(e,n,s,r,f,u,c))?(d||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=u),a.props=r,a.state=u,a.context=c,r=s):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{a=e.stateNode,hE(t,e),s=e.memoizedProps,c=e.type===e.elementType?s:or(e.type,s),a.props=c,d=e.pendingProps,f=a.context,u=n.contextType,typeof u=="object"&&u!==null?u=Kn(u):(u=mn(n)?ca:Qt.current,u=Os(e,u));var h=n.getDerivedStateFromProps;(l=typeof h=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(s!==d||f!==u)&&B1(e,a,r,u),Go=!1,f=e.memoizedState,a.state=f,Ld(e,r,a,o);var m=e.memoizedState;s!==d||f!==m||pn.current||Go?(typeof h=="function"&&($m(e,n,h,r),m=e.memoizedState),(c=Go||L1(e,n,c,r,f,m,u)||!1)?(l||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(r,m,u),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(r,m,u)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||s===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||s===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=m),a.props=r,a.state=m,a.context=u,r=c):(typeof a.componentDidUpdate!="function"||s===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||s===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),r=!1)}return Gm(t,e,n,r,i,o)}function Gm(t,e,n,r,o,i){jE(t,e);var a=(e.flags&128)!==0;if(!r&&!a)return o&&T1(e,n,!1),xo(t,e,i);r=e.stateNode,lP.current=e;var s=a&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&a?(e.child=Ls(e,t.child,null,i),e.child=Ls(e,null,s,i)):en(t,e,s,i),e.memoizedState=r.state,o&&T1(e,n,!0),e.child}function UE(t){var e=t.stateNode;e.pendingContext?R1(t,e.pendingContext,e.pendingContext!==e.context):e.context&&R1(t,e.context,!1),Dg(t,e.containerInfo)}function H1(t,e,n,r,o){return Fs(),Ig(o),e.flags|=256,en(t,e,n,r),e.child}var Km={dehydrated:null,treeContext:null,retryLane:0};function qm(t){return{baseLanes:t,cachePool:null,transitions:null}}function WE(t,e,n){var r=e.pendingProps,o=et.current,i=!1,a=(e.flags&128)!==0,s;if((s=a)||(s=t!==null&&t.memoizedState===null?!1:(o&2)!==0),s?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(o|=1),He(et,o&1),t===null)return Um(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=r.children,t=r.fallback,i?(r=e.mode,i=e.child,a={mode:"hidden",children:a},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=a):i=Gf(a,r,0,null),t=sa(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=qm(n),e.memoizedState=Km,t):Wg(e,a));if(o=t.memoizedState,o!==null&&(s=o.dehydrated,s!==null))return dP(t,e,a,r,s,o,n);if(i){i=r.fallback,a=e.mode,o=t.child,s=o.sibling;var u={mode:"hidden",children:r.children};return!(a&1)&&e.child!==o?(r=e.child,r.childLanes=0,r.pendingProps=u,e.deletions=null):(r=vi(o,u),r.subtreeFlags=o.subtreeFlags&14680064),s!==null?i=vi(s,i):(i=sa(i,a,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,a=t.child.memoizedState,a=a===null?qm(n):{baseLanes:a.baseLanes|n,cachePool:null,transitions:a.transitions},i.memoizedState=a,i.childLanes=t.childLanes&~n,e.memoizedState=Km,r}return i=t.child,t=i.sibling,r=vi(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Wg(t,e){return e=Gf({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function _l(t,e,n,r){return r!==null&&Ig(r),Ls(e,t.child,null,n),t=Wg(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function dP(t,e,n,r,o,i,a){if(n)return e.flags&256?(e.flags&=-257,r=lp(Error(ee(422))),_l(t,e,a,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,o=e.mode,r=Gf({mode:"visible",children:r.children},o,0,null),i=sa(i,o,a,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&Ls(e,t.child,null,a),e.child.memoizedState=qm(a),e.memoizedState=Km,i);if(!(e.mode&1))return _l(t,e,a,null);if(o.data==="$!"){if(r=o.nextSibling&&o.nextSibling.dataset,r)var s=r.dgst;return r=s,i=Error(ee(419)),r=lp(i,r,void 0),_l(t,e,a,r)}if(s=(a&t.childLanes)!==0,hn||s){if(r=Tt,r!==null){switch(a&-a){case 4:o=2;break;case 16:o=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:o=32;break;case 536870912:o=268435456;break;default:o=0}o=o&(r.suspendedLanes|a)?0:o,o!==0&&o!==i.retryLane&&(i.retryLane=o,yo(t,o),mr(r,t,o,-1))}return Kg(),r=lp(Error(ee(421))),_l(t,e,a,r)}return o.data==="$?"?(e.flags|=128,e.child=t.child,e=_P.bind(null,t),o._reactRetry=e,null):(t=i.treeContext,kn=fi(o.nextSibling),An=e,Ze=!0,cr=null,t!==null&&(jn[Un++]=co,jn[Un++]=lo,jn[Un++]=la,co=t.id,lo=t.overflow,la=e),e=Wg(e,r.children),e.flags|=4096,e)}function G1(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Wm(t.return,e,n)}function dp(t,e,n,r,o){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:o}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=o)}function $E(t,e,n){var r=e.pendingProps,o=r.revealOrder,i=r.tail;if(en(t,e,r.children,n),r=et.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&G1(t,n,e);else if(t.tag===19)G1(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(He(et,r),!(e.mode&1))e.memoizedState=null;else switch(o){case"forwards":for(n=e.child,o=null;n!==null;)t=n.alternate,t!==null&&Bd(t)===null&&(o=n),n=n.sibling;n=o,n===null?(o=e.child,e.child=null):(o=n.sibling,n.sibling=null),dp(e,!1,o,n,i);break;case"backwards":for(n=null,o=e.child,e.child=null;o!==null;){if(t=o.alternate,t!==null&&Bd(t)===null){e.child=o;break}t=o.sibling,o.sibling=n,n=o,o=t}dp(e,!0,n,null,i);break;case"together":dp(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function ud(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function xo(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),fa|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(ee(153));if(e.child!==null){for(t=e.child,n=vi(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=vi(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function fP(t,e,n){switch(e.tag){case 3:UE(e),Fs();break;case 5:pE(e);break;case 1:mn(e.type)&&Pd(e);break;case 4:Dg(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,o=e.memoizedProps.value;He(Od,r._currentValue),r._currentValue=o;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(He(et,et.current&1),e.flags|=128,null):n&e.child.childLanes?WE(t,e,n):(He(et,et.current&1),t=xo(t,e,n),t!==null?t.sibling:null);He(et,et.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return $E(t,e,n);e.flags|=128}if(o=e.memoizedState,o!==null&&(o.rendering=null,o.tail=null,o.lastEffect=null),He(et,et.current),r)break;return null;case 22:case 23:return e.lanes=0,BE(t,e,n)}return xo(t,e,n)}var zE,Xm,VE,HE;zE=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Xm=function(){};VE=function(t,e,n,r){var o=t.memoizedProps;if(o!==r){t=e.stateNode,Qi(jr.current);var i=null;switch(n){case"input":o=gm(t,o),r=gm(t,r),i=[];break;case"select":o=ot({},o,{value:void 0}),r=ot({},r,{value:void 0}),i=[];break;case"textarea":o=wm(t,o),r=wm(t,r),i=[];break;default:typeof o.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Nd)}Em(n,r);var a;n=null;for(c in o)if(!r.hasOwnProperty(c)&&o.hasOwnProperty(c)&&o[c]!=null)if(c==="style"){var s=o[c];for(a in s)s.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(qu.hasOwnProperty(c)?i||(i=[]):(i=i||[]).push(c,null));for(c in r){var u=r[c];if(s=o!=null?o[c]:void 0,r.hasOwnProperty(c)&&u!==s&&(u!=null||s!=null))if(c==="style")if(s){for(a in s)!s.hasOwnProperty(a)||u&&u.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in u)u.hasOwnProperty(a)&&s[a]!==u[a]&&(n||(n={}),n[a]=u[a])}else n||(i||(i=[]),i.push(c,n)),n=u;else c==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,s=s?s.__html:void 0,u!=null&&s!==u&&(i=i||[]).push(c,u)):c==="children"?typeof u!="string"&&typeof u!="number"||(i=i||[]).push(c,""+u):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(qu.hasOwnProperty(c)?(u!=null&&c==="onScroll"&&qe("scroll",t),i||s===u||(i=[])):(i=i||[]).push(c,u))}n&&(i=i||[]).push("style",n);var c=i;(e.updateQueue=c)&&(e.flags|=4)}};HE=function(t,e,n,r){n!==r&&(e.flags|=4)};function yu(t,e){if(!Ze)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function zt(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var o=t.child;o!==null;)n|=o.lanes|o.childLanes,r|=o.subtreeFlags&14680064,r|=o.flags&14680064,o.return=t,o=o.sibling;else for(o=t.child;o!==null;)n|=o.lanes|o.childLanes,r|=o.subtreeFlags,r|=o.flags,o.return=t,o=o.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function hP(t,e,n){var r=e.pendingProps;switch(kg(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return zt(e),null;case 1:return mn(e.type)&&Ad(),zt(e),null;case 3:return r=e.stateNode,Bs(),Ye(pn),Ye(Qt),Og(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(El(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,cr!==null&&(rv(cr),cr=null))),Xm(t,e),zt(e),null;case 5:Mg(e);var o=Qi(ac.current);if(n=e.type,t!==null&&e.stateNode!=null)VE(t,e,n,r,o),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(ee(166));return zt(e),null}if(t=Qi(jr.current),El(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[Pr]=e,r[oc]=i,t=(e.mode&1)!==0,n){case"dialog":qe("cancel",r),qe("close",r);break;case"iframe":case"object":case"embed":qe("load",r);break;case"video":case"audio":for(o=0;o<Tu.length;o++)qe(Tu[o],r);break;case"source":qe("error",r);break;case"img":case"image":case"link":qe("error",r),qe("load",r);break;case"details":qe("toggle",r);break;case"input":t1(r,i),qe("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},qe("invalid",r);break;case"textarea":r1(r,i),qe("invalid",r)}Em(n,i),o=null;for(var a in i)if(i.hasOwnProperty(a)){var s=i[a];a==="children"?typeof s=="string"?r.textContent!==s&&(i.suppressHydrationWarning!==!0&&bl(r.textContent,s,t),o=["children",s]):typeof s=="number"&&r.textContent!==""+s&&(i.suppressHydrationWarning!==!0&&bl(r.textContent,s,t),o=["children",""+s]):qu.hasOwnProperty(a)&&s!=null&&a==="onScroll"&&qe("scroll",r)}switch(n){case"input":hl(r),n1(r,i,!0);break;case"textarea":hl(r),o1(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=Nd)}r=o,e.updateQueue=r,r!==null&&(e.flags|=4)}else{a=o.nodeType===9?o:o.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=x2(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=a.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=a.createElement(n,{is:r.is}):(t=a.createElement(n),n==="select"&&(a=t,r.multiple?a.multiple=!0:r.size&&(a.size=r.size))):t=a.createElementNS(t,n),t[Pr]=e,t[oc]=r,zE(t,e,!1,!1),e.stateNode=t;e:{switch(a=Cm(n,r),n){case"dialog":qe("cancel",t),qe("close",t),o=r;break;case"iframe":case"object":case"embed":qe("load",t),o=r;break;case"video":case"audio":for(o=0;o<Tu.length;o++)qe(Tu[o],t);o=r;break;case"source":qe("error",t),o=r;break;case"img":case"image":case"link":qe("error",t),qe("load",t),o=r;break;case"details":qe("toggle",t),o=r;break;case"input":t1(t,r),o=gm(t,r),qe("invalid",t);break;case"option":o=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},o=ot({},r,{value:void 0}),qe("invalid",t);break;case"textarea":r1(t,r),o=wm(t,r),qe("invalid",t);break;default:o=r}Em(n,o),s=o;for(i in s)if(s.hasOwnProperty(i)){var u=s[i];i==="style"?E2(t,u):i==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&w2(t,u)):i==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&Xu(t,u):typeof u=="number"&&Xu(t,""+u):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(qu.hasOwnProperty(i)?u!=null&&i==="onScroll"&&qe("scroll",t):u!=null&&dg(t,i,u,a))}switch(n){case"input":hl(t),n1(t,r,!1);break;case"textarea":hl(t),o1(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Ci(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?is(t,!!r.multiple,i,!1):r.defaultValue!=null&&is(t,!!r.multiple,r.defaultValue,!0);break;default:typeof o.onClick=="function"&&(t.onclick=Nd)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return zt(e),null;case 6:if(t&&e.stateNode!=null)HE(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(ee(166));if(n=Qi(ac.current),Qi(jr.current),El(e)){if(r=e.stateNode,n=e.memoizedProps,r[Pr]=e,(i=r.nodeValue!==n)&&(t=An,t!==null))switch(t.tag){case 3:bl(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&bl(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Pr]=e,e.stateNode=r}return zt(e),null;case 13:if(Ye(et),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Ze&&kn!==null&&e.mode&1&&!(e.flags&128))cE(),Fs(),e.flags|=98560,i=!1;else if(i=El(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(ee(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(ee(317));i[Pr]=e}else Fs(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;zt(e),i=!1}else cr!==null&&(rv(cr),cr=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||et.current&1?xt===0&&(xt=3):Kg())),e.updateQueue!==null&&(e.flags|=4),zt(e),null);case 4:return Bs(),Xm(t,e),t===null&&nc(e.stateNode.containerInfo),zt(e),null;case 10:return Ng(e.type._context),zt(e),null;case 17:return mn(e.type)&&Ad(),zt(e),null;case 19:if(Ye(et),i=e.memoizedState,i===null)return zt(e),null;if(r=(e.flags&128)!==0,a=i.rendering,a===null)if(r)yu(i,!1);else{if(xt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(a=Bd(t),a!==null){for(e.flags|=128,yu(i,!1),r=a.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,a=i.alternate,a===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=a.childLanes,i.lanes=a.lanes,i.child=a.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=a.memoizedProps,i.memoizedState=a.memoizedState,i.updateQueue=a.updateQueue,i.type=a.type,t=a.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return He(et,et.current&1|2),e.child}t=t.sibling}i.tail!==null&&dt()>Us&&(e.flags|=128,r=!0,yu(i,!1),e.lanes=4194304)}else{if(!r)if(t=Bd(a),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),yu(i,!0),i.tail===null&&i.tailMode==="hidden"&&!a.alternate&&!Ze)return zt(e),null}else 2*dt()-i.renderingStartTime>Us&&n!==1073741824&&(e.flags|=128,r=!0,yu(i,!1),e.lanes=4194304);i.isBackwards?(a.sibling=e.child,e.child=a):(n=i.last,n!==null?n.sibling=a:e.child=a,i.last=a)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=dt(),e.sibling=null,n=et.current,He(et,r?n&1|2:n&1),e):(zt(e),null);case 22:case 23:return Gg(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?En&1073741824&&(zt(e),e.subtreeFlags&6&&(e.flags|=8192)):zt(e),null;case 24:return null;case 25:return null}throw Error(ee(156,e.tag))}function pP(t,e){switch(kg(e),e.tag){case 1:return mn(e.type)&&Ad(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Bs(),Ye(pn),Ye(Qt),Og(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Mg(e),null;case 13:if(Ye(et),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(ee(340));Fs()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Ye(et),null;case 4:return Bs(),null;case 10:return Ng(e.type._context),null;case 22:case 23:return Gg(),null;case 24:return null;default:return null}}var Sl=!1,Gt=!1,mP=typeof WeakSet=="function"?WeakSet:Set,ae=null;function ns(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){ut(t,e,r)}else n.current=null}function Ym(t,e,n){try{n()}catch(r){ut(t,e,r)}}var K1=!1;function vP(t,e){if(Dm=Id,t=Y2(),_g(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var o=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var a=0,s=-1,u=-1,c=0,l=0,d=t,f=null;t:for(;;){for(var h;d!==n||o!==0&&d.nodeType!==3||(s=a+o),d!==i||r!==0&&d.nodeType!==3||(u=a+r),d.nodeType===3&&(a+=d.nodeValue.length),(h=d.firstChild)!==null;)f=d,d=h;for(;;){if(d===t)break t;if(f===n&&++c===o&&(s=a),f===i&&++l===r&&(u=a),(h=d.nextSibling)!==null)break;d=f,f=d.parentNode}d=h}n=s===-1||u===-1?null:{start:s,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(Mm={focusedElem:t,selectionRange:n},Id=!1,ae=e;ae!==null;)if(e=ae,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,ae=t;else for(;ae!==null;){e=ae;try{var m=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(m!==null){var p=m.memoizedProps,g=m.memoizedState,v=e.stateNode,y=v.getSnapshotBeforeUpdate(e.elementType===e.type?p:or(e.type,p),g);v.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var x=e.stateNode.containerInfo;x.nodeType===1?x.textContent="":x.nodeType===9&&x.documentElement&&x.removeChild(x.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ee(163))}}catch(w){ut(e,e.return,w)}if(t=e.sibling,t!==null){t.return=e.return,ae=t;break}ae=e.return}return m=K1,K1=!1,m}function ju(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var o=r=r.next;do{if((o.tag&t)===t){var i=o.destroy;o.destroy=void 0,i!==void 0&&Ym(e,n,i)}o=o.next}while(o!==r)}}function Vf(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Qm(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function GE(t){var e=t.alternate;e!==null&&(t.alternate=null,GE(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Pr],delete e[oc],delete e[Lm],delete e[JA],delete e[ZA])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function KE(t){return t.tag===5||t.tag===3||t.tag===4}function q1(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||KE(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Jm(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Nd));else if(r!==4&&(t=t.child,t!==null))for(Jm(t,e,n),t=t.sibling;t!==null;)Jm(t,e,n),t=t.sibling}function Zm(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Zm(t,e,n),t=t.sibling;t!==null;)Zm(t,e,n),t=t.sibling}var Dt=null,ur=!1;function Lo(t,e,n){for(n=n.child;n!==null;)qE(t,e,n),n=n.sibling}function qE(t,e,n){if(Br&&typeof Br.onCommitFiberUnmount=="function")try{Br.onCommitFiberUnmount(Ff,n)}catch{}switch(n.tag){case 5:Gt||ns(n,e);case 6:var r=Dt,o=ur;Dt=null,Lo(t,e,n),Dt=r,ur=o,Dt!==null&&(ur?(t=Dt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Dt.removeChild(n.stateNode));break;case 18:Dt!==null&&(ur?(t=Dt,n=n.stateNode,t.nodeType===8?op(t.parentNode,n):t.nodeType===1&&op(t,n),Zu(t)):op(Dt,n.stateNode));break;case 4:r=Dt,o=ur,Dt=n.stateNode.containerInfo,ur=!0,Lo(t,e,n),Dt=r,ur=o;break;case 0:case 11:case 14:case 15:if(!Gt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){o=r=r.next;do{var i=o,a=i.destroy;i=i.tag,a!==void 0&&(i&2||i&4)&&Ym(n,e,a),o=o.next}while(o!==r)}Lo(t,e,n);break;case 1:if(!Gt&&(ns(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(s){ut(n,e,s)}Lo(t,e,n);break;case 21:Lo(t,e,n);break;case 22:n.mode&1?(Gt=(r=Gt)||n.memoizedState!==null,Lo(t,e,n),Gt=r):Lo(t,e,n);break;default:Lo(t,e,n)}}function X1(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new mP),e.forEach(function(r){var o=SP.bind(null,t,r);n.has(r)||(n.add(r),r.then(o,o))})}}function nr(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var o=n[r];try{var i=t,a=e,s=a;e:for(;s!==null;){switch(s.tag){case 5:Dt=s.stateNode,ur=!1;break e;case 3:Dt=s.stateNode.containerInfo,ur=!0;break e;case 4:Dt=s.stateNode.containerInfo,ur=!0;break e}s=s.return}if(Dt===null)throw Error(ee(160));qE(i,a,o),Dt=null,ur=!1;var u=o.alternate;u!==null&&(u.return=null),o.return=null}catch(c){ut(o,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)XE(e,t),e=e.sibling}function XE(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(nr(e,t),_r(t),r&4){try{ju(3,t,t.return),Vf(3,t)}catch(p){ut(t,t.return,p)}try{ju(5,t,t.return)}catch(p){ut(t,t.return,p)}}break;case 1:nr(e,t),_r(t),r&512&&n!==null&&ns(n,n.return);break;case 5:if(nr(e,t),_r(t),r&512&&n!==null&&ns(n,n.return),t.flags&32){var o=t.stateNode;try{Xu(o,"")}catch(p){ut(t,t.return,p)}}if(r&4&&(o=t.stateNode,o!=null)){var i=t.memoizedProps,a=n!==null?n.memoizedProps:i,s=t.type,u=t.updateQueue;if(t.updateQueue=null,u!==null)try{s==="input"&&i.type==="radio"&&i.name!=null&&g2(o,i),Cm(s,a);var c=Cm(s,i);for(a=0;a<u.length;a+=2){var l=u[a],d=u[a+1];l==="style"?E2(o,d):l==="dangerouslySetInnerHTML"?w2(o,d):l==="children"?Xu(o,d):dg(o,l,d,c)}switch(s){case"input":ym(o,i);break;case"textarea":y2(o,i);break;case"select":var f=o._wrapperState.wasMultiple;o._wrapperState.wasMultiple=!!i.multiple;var h=i.value;h!=null?is(o,!!i.multiple,h,!1):f!==!!i.multiple&&(i.defaultValue!=null?is(o,!!i.multiple,i.defaultValue,!0):is(o,!!i.multiple,i.multiple?[]:"",!1))}o[oc]=i}catch(p){ut(t,t.return,p)}}break;case 6:if(nr(e,t),_r(t),r&4){if(t.stateNode===null)throw Error(ee(162));o=t.stateNode,i=t.memoizedProps;try{o.nodeValue=i}catch(p){ut(t,t.return,p)}}break;case 3:if(nr(e,t),_r(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Zu(e.containerInfo)}catch(p){ut(t,t.return,p)}break;case 4:nr(e,t),_r(t);break;case 13:nr(e,t),_r(t),o=t.child,o.flags&8192&&(i=o.memoizedState!==null,o.stateNode.isHidden=i,!i||o.alternate!==null&&o.alternate.memoizedState!==null||(Vg=dt())),r&4&&X1(t);break;case 22:if(l=n!==null&&n.memoizedState!==null,t.mode&1?(Gt=(c=Gt)||l,nr(e,t),Gt=c):nr(e,t),_r(t),r&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!l&&t.mode&1)for(ae=t,l=t.child;l!==null;){for(d=ae=l;ae!==null;){switch(f=ae,h=f.child,f.tag){case 0:case 11:case 14:case 15:ju(4,f,f.return);break;case 1:ns(f,f.return);var m=f.stateNode;if(typeof m.componentWillUnmount=="function"){r=f,n=f.return;try{e=r,m.props=e.memoizedProps,m.state=e.memoizedState,m.componentWillUnmount()}catch(p){ut(r,n,p)}}break;case 5:ns(f,f.return);break;case 22:if(f.memoizedState!==null){Q1(d);continue}}h!==null?(h.return=f,ae=h):Q1(d)}l=l.sibling}e:for(l=null,d=t;;){if(d.tag===5){if(l===null){l=d;try{o=d.stateNode,c?(i=o.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(s=d.stateNode,u=d.memoizedProps.style,a=u!=null&&u.hasOwnProperty("display")?u.display:null,s.style.display=b2("display",a))}catch(p){ut(t,t.return,p)}}}else if(d.tag===6){if(l===null)try{d.stateNode.nodeValue=c?"":d.memoizedProps}catch(p){ut(t,t.return,p)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===t)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===t)break e;for(;d.sibling===null;){if(d.return===null||d.return===t)break e;l===d&&(l=null),d=d.return}l===d&&(l=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:nr(e,t),_r(t),r&4&&X1(t);break;case 21:break;default:nr(e,t),_r(t)}}function _r(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(KE(n)){var r=n;break e}n=n.return}throw Error(ee(160))}switch(r.tag){case 5:var o=r.stateNode;r.flags&32&&(Xu(o,""),r.flags&=-33);var i=q1(t);Zm(t,i,o);break;case 3:case 4:var a=r.stateNode.containerInfo,s=q1(t);Jm(t,s,a);break;default:throw Error(ee(161))}}catch(u){ut(t,t.return,u)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function gP(t,e,n){ae=t,YE(t)}function YE(t,e,n){for(var r=(t.mode&1)!==0;ae!==null;){var o=ae,i=o.child;if(o.tag===22&&r){var a=o.memoizedState!==null||Sl;if(!a){var s=o.alternate,u=s!==null&&s.memoizedState!==null||Gt;s=Sl;var c=Gt;if(Sl=a,(Gt=u)&&!c)for(ae=o;ae!==null;)a=ae,u=a.child,a.tag===22&&a.memoizedState!==null?J1(o):u!==null?(u.return=a,ae=u):J1(o);for(;i!==null;)ae=i,YE(i),i=i.sibling;ae=o,Sl=s,Gt=c}Y1(t)}else o.subtreeFlags&8772&&i!==null?(i.return=o,ae=i):Y1(t)}}function Y1(t){for(;ae!==null;){var e=ae;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Gt||Vf(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Gt)if(n===null)r.componentDidMount();else{var o=e.elementType===e.type?n.memoizedProps:or(e.type,n.memoizedProps);r.componentDidUpdate(o,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&M1(e,i,r);break;case 3:var a=e.updateQueue;if(a!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}M1(e,a,n)}break;case 5:var s=e.stateNode;if(n===null&&e.flags&4){n=s;var u=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var l=c.memoizedState;if(l!==null){var d=l.dehydrated;d!==null&&Zu(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ee(163))}Gt||e.flags&512&&Qm(e)}catch(f){ut(e,e.return,f)}}if(e===t){ae=null;break}if(n=e.sibling,n!==null){n.return=e.return,ae=n;break}ae=e.return}}function Q1(t){for(;ae!==null;){var e=ae;if(e===t){ae=null;break}var n=e.sibling;if(n!==null){n.return=e.return,ae=n;break}ae=e.return}}function J1(t){for(;ae!==null;){var e=ae;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Vf(4,e)}catch(u){ut(e,n,u)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var o=e.return;try{r.componentDidMount()}catch(u){ut(e,o,u)}}var i=e.return;try{Qm(e)}catch(u){ut(e,i,u)}break;case 5:var a=e.return;try{Qm(e)}catch(u){ut(e,a,u)}}}catch(u){ut(e,e.return,u)}if(e===t){ae=null;break}var s=e.sibling;if(s!==null){s.return=e.return,ae=s;break}ae=e.return}}var yP=Math.ceil,Wd=_o.ReactCurrentDispatcher,$g=_o.ReactCurrentOwner,Hn=_o.ReactCurrentBatchConfig,Oe=0,Tt=null,pt=null,Lt=0,En=0,rs=Ni(0),xt=0,lc=null,fa=0,Hf=0,zg=0,Uu=null,cn=null,Vg=0,Us=1/0,oo=null,$d=!1,ev=null,pi=null,kl=!1,ii=null,zd=0,Wu=0,tv=null,cd=-1,ld=0;function nn(){return Oe&6?dt():cd!==-1?cd:cd=dt()}function mi(t){return t.mode&1?Oe&2&&Lt!==0?Lt&-Lt:tP.transition!==null?(ld===0&&(ld=M2()),ld):(t=$e,t!==0||(t=window.event,t=t===void 0?16:W2(t.type)),t):1}function mr(t,e,n,r){if(50<Wu)throw Wu=0,tv=null,Error(ee(185));Dc(t,n,r),(!(Oe&2)||t!==Tt)&&(t===Tt&&(!(Oe&2)&&(Hf|=n),xt===4&&qo(t,Lt)),vn(t,r),n===1&&Oe===0&&!(e.mode&1)&&(Us=dt()+500,Wf&&Ai()))}function vn(t,e){var n=t.callbackNode;tA(t,e);var r=kd(t,t===Tt?Lt:0);if(r===0)n!==null&&s1(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&s1(n),e===1)t.tag===0?eP(Z1.bind(null,t)):aE(Z1.bind(null,t)),YA(function(){!(Oe&6)&&Ai()}),n=null;else{switch(O2(r)){case 1:n=vg;break;case 4:n=P2;break;case 16:n=Sd;break;case 536870912:n=D2;break;default:n=Sd}n=oC(n,QE.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function QE(t,e){if(cd=-1,ld=0,Oe&6)throw Error(ee(327));var n=t.callbackNode;if(ls()&&t.callbackNode!==n)return null;var r=kd(t,t===Tt?Lt:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Vd(t,r);else{e=r;var o=Oe;Oe|=2;var i=ZE();(Tt!==t||Lt!==e)&&(oo=null,Us=dt()+500,aa(t,e));do try{bP();break}catch(s){JE(t,s)}while(!0);Tg(),Wd.current=i,Oe=o,pt!==null?e=0:(Tt=null,Lt=0,e=xt)}if(e!==0){if(e===2&&(o=Rm(t),o!==0&&(r=o,e=nv(t,o))),e===1)throw n=lc,aa(t,0),qo(t,r),vn(t,dt()),n;if(e===6)qo(t,r);else{if(o=t.current.alternate,!(r&30)&&!xP(o)&&(e=Vd(t,r),e===2&&(i=Rm(t),i!==0&&(r=i,e=nv(t,i))),e===1))throw n=lc,aa(t,0),qo(t,r),vn(t,dt()),n;switch(t.finishedWork=o,t.finishedLanes=r,e){case 0:case 1:throw Error(ee(345));case 2:$i(t,cn,oo);break;case 3:if(qo(t,r),(r&130023424)===r&&(e=Vg+500-dt(),10<e)){if(kd(t,0)!==0)break;if(o=t.suspendedLanes,(o&r)!==r){nn(),t.pingedLanes|=t.suspendedLanes&o;break}t.timeoutHandle=Fm($i.bind(null,t,cn,oo),e);break}$i(t,cn,oo);break;case 4:if(qo(t,r),(r&4194240)===r)break;for(e=t.eventTimes,o=-1;0<r;){var a=31-pr(r);i=1<<a,a=e[a],a>o&&(o=a),r&=~i}if(r=o,r=dt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*yP(r/1960))-r,10<r){t.timeoutHandle=Fm($i.bind(null,t,cn,oo),r);break}$i(t,cn,oo);break;case 5:$i(t,cn,oo);break;default:throw Error(ee(329))}}}return vn(t,dt()),t.callbackNode===n?QE.bind(null,t):null}function nv(t,e){var n=Uu;return t.current.memoizedState.isDehydrated&&(aa(t,e).flags|=256),t=Vd(t,e),t!==2&&(e=cn,cn=n,e!==null&&rv(e)),t}function rv(t){cn===null?cn=t:cn.push.apply(cn,t)}function xP(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var o=n[r],i=o.getSnapshot;o=o.value;try{if(!gr(i(),o))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function qo(t,e){for(e&=~zg,e&=~Hf,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-pr(e),r=1<<n;t[n]=-1,e&=~r}}function Z1(t){if(Oe&6)throw Error(ee(327));ls();var e=kd(t,0);if(!(e&1))return vn(t,dt()),null;var n=Vd(t,e);if(t.tag!==0&&n===2){var r=Rm(t);r!==0&&(e=r,n=nv(t,r))}if(n===1)throw n=lc,aa(t,0),qo(t,e),vn(t,dt()),n;if(n===6)throw Error(ee(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,$i(t,cn,oo),vn(t,dt()),null}function Hg(t,e){var n=Oe;Oe|=1;try{return t(e)}finally{Oe=n,Oe===0&&(Us=dt()+500,Wf&&Ai())}}function ha(t){ii!==null&&ii.tag===0&&!(Oe&6)&&ls();var e=Oe;Oe|=1;var n=Hn.transition,r=$e;try{if(Hn.transition=null,$e=1,t)return t()}finally{$e=r,Hn.transition=n,Oe=e,!(Oe&6)&&Ai()}}function Gg(){En=rs.current,Ye(rs)}function aa(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,XA(n)),pt!==null)for(n=pt.return;n!==null;){var r=n;switch(kg(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Ad();break;case 3:Bs(),Ye(pn),Ye(Qt),Og();break;case 5:Mg(r);break;case 4:Bs();break;case 13:Ye(et);break;case 19:Ye(et);break;case 10:Ng(r.type._context);break;case 22:case 23:Gg()}n=n.return}if(Tt=t,pt=t=vi(t.current,null),Lt=En=e,xt=0,lc=null,zg=Hf=fa=0,cn=Uu=null,Yi!==null){for(e=0;e<Yi.length;e++)if(n=Yi[e],r=n.interleaved,r!==null){n.interleaved=null;var o=r.next,i=n.pending;if(i!==null){var a=i.next;i.next=o,r.next=a}n.pending=r}Yi=null}return t}function JE(t,e){do{var n=pt;try{if(Tg(),ad.current=Ud,jd){for(var r=rt.memoizedState;r!==null;){var o=r.queue;o!==null&&(o.pending=null),r=r.next}jd=!1}if(da=0,Rt=yt=rt=null,Bu=!1,sc=0,$g.current=null,n===null||n.return===null){xt=1,lc=e,pt=null;break}e:{var i=t,a=n.return,s=n,u=e;if(e=Lt,s.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var c=u,l=s,d=l.tag;if(!(l.mode&1)&&(d===0||d===11||d===15)){var f=l.alternate;f?(l.updateQueue=f.updateQueue,l.memoizedState=f.memoizedState,l.lanes=f.lanes):(l.updateQueue=null,l.memoizedState=null)}var h=U1(a);if(h!==null){h.flags&=-257,W1(h,a,s,i,e),h.mode&1&&j1(i,c,e),e=h,u=c;var m=e.updateQueue;if(m===null){var p=new Set;p.add(u),e.updateQueue=p}else m.add(u);break e}else{if(!(e&1)){j1(i,c,e),Kg();break e}u=Error(ee(426))}}else if(Ze&&s.mode&1){var g=U1(a);if(g!==null){!(g.flags&65536)&&(g.flags|=256),W1(g,a,s,i,e),Ig(js(u,s));break e}}i=u=js(u,s),xt!==4&&(xt=2),Uu===null?Uu=[i]:Uu.push(i),i=a;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var v=OE(i,u,e);D1(i,v);break e;case 1:s=u;var y=i.type,x=i.stateNode;if(!(i.flags&128)&&(typeof y.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(pi===null||!pi.has(x)))){i.flags|=65536,e&=-e,i.lanes|=e;var w=FE(i,s,e);D1(i,w);break e}}i=i.return}while(i!==null)}tC(n)}catch(E){e=E,pt===n&&n!==null&&(pt=n=n.return);continue}break}while(!0)}function ZE(){var t=Wd.current;return Wd.current=Ud,t===null?Ud:t}function Kg(){(xt===0||xt===3||xt===2)&&(xt=4),Tt===null||!(fa&268435455)&&!(Hf&268435455)||qo(Tt,Lt)}function Vd(t,e){var n=Oe;Oe|=2;var r=ZE();(Tt!==t||Lt!==e)&&(oo=null,aa(t,e));do try{wP();break}catch(o){JE(t,o)}while(!0);if(Tg(),Oe=n,Wd.current=r,pt!==null)throw Error(ee(261));return Tt=null,Lt=0,xt}function wP(){for(;pt!==null;)eC(pt)}function bP(){for(;pt!==null&&!GN();)eC(pt)}function eC(t){var e=rC(t.alternate,t,En);t.memoizedProps=t.pendingProps,e===null?tC(t):pt=e,$g.current=null}function tC(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=pP(n,e),n!==null){n.flags&=32767,pt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{xt=6,pt=null;return}}else if(n=hP(n,e,En),n!==null){pt=n;return}if(e=e.sibling,e!==null){pt=e;return}pt=e=t}while(e!==null);xt===0&&(xt=5)}function $i(t,e,n){var r=$e,o=Hn.transition;try{Hn.transition=null,$e=1,EP(t,e,n,r)}finally{Hn.transition=o,$e=r}return null}function EP(t,e,n,r){do ls();while(ii!==null);if(Oe&6)throw Error(ee(327));n=t.finishedWork;var o=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(ee(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(nA(t,i),t===Tt&&(pt=Tt=null,Lt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||kl||(kl=!0,oC(Sd,function(){return ls(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=Hn.transition,Hn.transition=null;var a=$e;$e=1;var s=Oe;Oe|=4,$g.current=null,vP(t,n),XE(n,t),$A(Mm),Id=!!Dm,Mm=Dm=null,t.current=n,gP(n),KN(),Oe=s,$e=a,Hn.transition=i}else t.current=n;if(kl&&(kl=!1,ii=t,zd=o),i=t.pendingLanes,i===0&&(pi=null),YN(n.stateNode),vn(t,dt()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)o=e[n],r(o.value,{componentStack:o.stack,digest:o.digest});if($d)throw $d=!1,t=ev,ev=null,t;return zd&1&&t.tag!==0&&ls(),i=t.pendingLanes,i&1?t===tv?Wu++:(Wu=0,tv=t):Wu=0,Ai(),null}function ls(){if(ii!==null){var t=O2(zd),e=Hn.transition,n=$e;try{if(Hn.transition=null,$e=16>t?16:t,ii===null)var r=!1;else{if(t=ii,ii=null,zd=0,Oe&6)throw Error(ee(331));var o=Oe;for(Oe|=4,ae=t.current;ae!==null;){var i=ae,a=i.child;if(ae.flags&16){var s=i.deletions;if(s!==null){for(var u=0;u<s.length;u++){var c=s[u];for(ae=c;ae!==null;){var l=ae;switch(l.tag){case 0:case 11:case 15:ju(8,l,i)}var d=l.child;if(d!==null)d.return=l,ae=d;else for(;ae!==null;){l=ae;var f=l.sibling,h=l.return;if(GE(l),l===c){ae=null;break}if(f!==null){f.return=h,ae=f;break}ae=h}}}var m=i.alternate;if(m!==null){var p=m.child;if(p!==null){m.child=null;do{var g=p.sibling;p.sibling=null,p=g}while(p!==null)}}ae=i}}if(i.subtreeFlags&2064&&a!==null)a.return=i,ae=a;else e:for(;ae!==null;){if(i=ae,i.flags&2048)switch(i.tag){case 0:case 11:case 15:ju(9,i,i.return)}var v=i.sibling;if(v!==null){v.return=i.return,ae=v;break e}ae=i.return}}var y=t.current;for(ae=y;ae!==null;){a=ae;var x=a.child;if(a.subtreeFlags&2064&&x!==null)x.return=a,ae=x;else e:for(a=y;ae!==null;){if(s=ae,s.flags&2048)try{switch(s.tag){case 0:case 11:case 15:Vf(9,s)}}catch(E){ut(s,s.return,E)}if(s===a){ae=null;break e}var w=s.sibling;if(w!==null){w.return=s.return,ae=w;break e}ae=s.return}}if(Oe=o,Ai(),Br&&typeof Br.onPostCommitFiberRoot=="function")try{Br.onPostCommitFiberRoot(Ff,t)}catch{}r=!0}return r}finally{$e=n,Hn.transition=e}}return!1}function ex(t,e,n){e=js(n,e),e=OE(t,e,1),t=hi(t,e,1),e=nn(),t!==null&&(Dc(t,1,e),vn(t,e))}function ut(t,e,n){if(t.tag===3)ex(t,t,n);else for(;e!==null;){if(e.tag===3){ex(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(pi===null||!pi.has(r))){t=js(n,t),t=FE(e,t,1),e=hi(e,t,1),t=nn(),e!==null&&(Dc(e,1,t),vn(e,t));break}}e=e.return}}function CP(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=nn(),t.pingedLanes|=t.suspendedLanes&n,Tt===t&&(Lt&n)===n&&(xt===4||xt===3&&(Lt&130023424)===Lt&&500>dt()-Vg?aa(t,0):zg|=n),vn(t,e)}function nC(t,e){e===0&&(t.mode&1?(e=vl,vl<<=1,!(vl&130023424)&&(vl=4194304)):e=1);var n=nn();t=yo(t,e),t!==null&&(Dc(t,e,n),vn(t,n))}function _P(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),nC(t,n)}function SP(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,o=t.memoizedState;o!==null&&(n=o.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(ee(314))}r!==null&&r.delete(e),nC(t,n)}var rC;rC=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||pn.current)hn=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return hn=!1,fP(t,e,n);hn=!!(t.flags&131072)}else hn=!1,Ze&&e.flags&1048576&&sE(e,Md,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;ud(t,e),t=e.pendingProps;var o=Os(e,Qt.current);cs(e,n),o=Lg(null,e,r,t,o,n);var i=Bg();return e.flags|=1,typeof o=="object"&&o!==null&&typeof o.render=="function"&&o.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,mn(r)?(i=!0,Pd(e)):i=!1,e.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,Pg(e),o.updater=zf,e.stateNode=o,o._reactInternals=e,zm(e,r,t,n),e=Gm(null,e,r,!0,i,n)):(e.tag=0,Ze&&i&&Sg(e),en(null,e,o,n),e=e.child),e;case 16:r=e.elementType;e:{switch(ud(t,e),t=e.pendingProps,o=r._init,r=o(r._payload),e.type=r,o=e.tag=IP(r),t=or(r,t),o){case 0:e=Hm(null,e,r,t,n);break e;case 1:e=V1(null,e,r,t,n);break e;case 11:e=$1(null,e,r,t,n);break e;case 14:e=z1(null,e,r,or(r.type,t),n);break e}throw Error(ee(306,r,""))}return e;case 0:return r=e.type,o=e.pendingProps,o=e.elementType===r?o:or(r,o),Hm(t,e,r,o,n);case 1:return r=e.type,o=e.pendingProps,o=e.elementType===r?o:or(r,o),V1(t,e,r,o,n);case 3:e:{if(UE(e),t===null)throw Error(ee(387));r=e.pendingProps,i=e.memoizedState,o=i.element,hE(t,e),Ld(e,r,null,n);var a=e.memoizedState;if(r=a.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){o=js(Error(ee(423)),e),e=H1(t,e,r,n,o);break e}else if(r!==o){o=js(Error(ee(424)),e),e=H1(t,e,r,n,o);break e}else for(kn=fi(e.stateNode.containerInfo.firstChild),An=e,Ze=!0,cr=null,n=dE(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Fs(),r===o){e=xo(t,e,n);break e}en(t,e,r,n)}e=e.child}return e;case 5:return pE(e),t===null&&Um(e),r=e.type,o=e.pendingProps,i=t!==null?t.memoizedProps:null,a=o.children,Om(r,o)?a=null:i!==null&&Om(r,i)&&(e.flags|=32),jE(t,e),en(t,e,a,n),e.child;case 6:return t===null&&Um(e),null;case 13:return WE(t,e,n);case 4:return Dg(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Ls(e,null,r,n):en(t,e,r,n),e.child;case 11:return r=e.type,o=e.pendingProps,o=e.elementType===r?o:or(r,o),$1(t,e,r,o,n);case 7:return en(t,e,e.pendingProps,n),e.child;case 8:return en(t,e,e.pendingProps.children,n),e.child;case 12:return en(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,o=e.pendingProps,i=e.memoizedProps,a=o.value,He(Od,r._currentValue),r._currentValue=a,i!==null)if(gr(i.value,a)){if(i.children===o.children&&!pn.current){e=xo(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var s=i.dependencies;if(s!==null){a=i.child;for(var u=s.firstContext;u!==null;){if(u.context===r){if(i.tag===1){u=po(-1,n&-n),u.tag=2;var c=i.updateQueue;if(c!==null){c=c.shared;var l=c.pending;l===null?u.next=u:(u.next=l.next,l.next=u),c.pending=u}}i.lanes|=n,u=i.alternate,u!==null&&(u.lanes|=n),Wm(i.return,n,e),s.lanes|=n;break}u=u.next}}else if(i.tag===10)a=i.type===e.type?null:i.child;else if(i.tag===18){if(a=i.return,a===null)throw Error(ee(341));a.lanes|=n,s=a.alternate,s!==null&&(s.lanes|=n),Wm(a,n,e),a=i.sibling}else a=i.child;if(a!==null)a.return=i;else for(a=i;a!==null;){if(a===e){a=null;break}if(i=a.sibling,i!==null){i.return=a.return,a=i;break}a=a.return}i=a}en(t,e,o.children,n),e=e.child}return e;case 9:return o=e.type,r=e.pendingProps.children,cs(e,n),o=Kn(o),r=r(o),e.flags|=1,en(t,e,r,n),e.child;case 14:return r=e.type,o=or(r,e.pendingProps),o=or(r.type,o),z1(t,e,r,o,n);case 15:return LE(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,o=e.pendingProps,o=e.elementType===r?o:or(r,o),ud(t,e),e.tag=1,mn(r)?(t=!0,Pd(e)):t=!1,cs(e,n),ME(e,r,o),zm(e,r,o,n),Gm(null,e,r,!0,t,n);case 19:return $E(t,e,n);case 22:return BE(t,e,n)}throw Error(ee(156,e.tag))};function oC(t,e){return A2(t,e)}function kP(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function zn(t,e,n,r){return new kP(t,e,n,r)}function qg(t){return t=t.prototype,!(!t||!t.isReactComponent)}function IP(t){if(typeof t=="function")return qg(t)?1:0;if(t!=null){if(t=t.$$typeof,t===hg)return 11;if(t===pg)return 14}return 2}function vi(t,e){var n=t.alternate;return n===null?(n=zn(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function dd(t,e,n,r,o,i){var a=2;if(r=t,typeof t=="function")qg(t)&&(a=1);else if(typeof t=="string")a=5;else e:switch(t){case Ka:return sa(n.children,o,i,e);case fg:a=8,o|=8;break;case hm:return t=zn(12,n,e,o|2),t.elementType=hm,t.lanes=i,t;case pm:return t=zn(13,n,e,o),t.elementType=pm,t.lanes=i,t;case mm:return t=zn(19,n,e,o),t.elementType=mm,t.lanes=i,t;case p2:return Gf(n,o,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case f2:a=10;break e;case h2:a=9;break e;case hg:a=11;break e;case pg:a=14;break e;case Ho:a=16,r=null;break e}throw Error(ee(130,t==null?t:typeof t,""))}return e=zn(a,n,e,o),e.elementType=t,e.type=r,e.lanes=i,e}function sa(t,e,n,r){return t=zn(7,t,r,e),t.lanes=n,t}function Gf(t,e,n,r){return t=zn(22,t,r,e),t.elementType=p2,t.lanes=n,t.stateNode={isHidden:!1},t}function fp(t,e,n){return t=zn(6,t,null,e),t.lanes=n,t}function hp(t,e,n){return e=zn(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function RP(t,e,n,r,o){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Kh(0),this.expirationTimes=Kh(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Kh(0),this.identifierPrefix=r,this.onRecoverableError=o,this.mutableSourceEagerHydrationData=null}function Xg(t,e,n,r,o,i,a,s,u){return t=new RP(t,e,n,s,u),e===1?(e=1,i===!0&&(e|=8)):e=0,i=zn(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Pg(i),t}function TP(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ga,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function iC(t){if(!t)return _i;t=t._reactInternals;e:{if(wa(t)!==t||t.tag!==1)throw Error(ee(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(mn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(ee(171))}if(t.tag===1){var n=t.type;if(mn(n))return iE(t,n,e)}return e}function aC(t,e,n,r,o,i,a,s,u){return t=Xg(n,r,!0,t,o,i,a,s,u),t.context=iC(null),n=t.current,r=nn(),o=mi(n),i=po(r,o),i.callback=e??null,hi(n,i,o),t.current.lanes=o,Dc(t,o,r),vn(t,r),t}function Kf(t,e,n,r){var o=e.current,i=nn(),a=mi(o);return n=iC(n),e.context===null?e.context=n:e.pendingContext=n,e=po(i,a),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=hi(o,e,a),t!==null&&(mr(t,o,a,i),id(t,o,a)),a}function Hd(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function tx(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Yg(t,e){tx(t,e),(t=t.alternate)&&tx(t,e)}function NP(){return null}var sC=typeof reportError=="function"?reportError:function(t){console.error(t)};function Qg(t){this._internalRoot=t}qf.prototype.render=Qg.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(ee(409));Kf(t,e,null,null)};qf.prototype.unmount=Qg.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;ha(function(){Kf(null,t,null,null)}),e[go]=null}};function qf(t){this._internalRoot=t}qf.prototype.unstable_scheduleHydration=function(t){if(t){var e=B2();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Ko.length&&e!==0&&e<Ko[n].priority;n++);Ko.splice(n,0,t),n===0&&U2(t)}};function Jg(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Xf(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function nx(){}function AP(t,e,n,r,o){if(o){if(typeof r=="function"){var i=r;r=function(){var c=Hd(a);i.call(c)}}var a=aC(e,r,t,0,null,!1,!1,"",nx);return t._reactRootContainer=a,t[go]=a.current,nc(t.nodeType===8?t.parentNode:t),ha(),a}for(;o=t.lastChild;)t.removeChild(o);if(typeof r=="function"){var s=r;r=function(){var c=Hd(u);s.call(c)}}var u=Xg(t,0,!1,null,null,!1,!1,"",nx);return t._reactRootContainer=u,t[go]=u.current,nc(t.nodeType===8?t.parentNode:t),ha(function(){Kf(e,u,n,r)}),u}function Yf(t,e,n,r,o){var i=n._reactRootContainer;if(i){var a=i;if(typeof o=="function"){var s=o;o=function(){var u=Hd(a);s.call(u)}}Kf(e,a,t,o)}else a=AP(n,e,t,o,r);return Hd(a)}F2=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Ru(e.pendingLanes);n!==0&&(gg(e,n|1),vn(e,dt()),!(Oe&6)&&(Us=dt()+500,Ai()))}break;case 13:ha(function(){var r=yo(t,1);if(r!==null){var o=nn();mr(r,t,1,o)}}),Yg(t,1)}};yg=function(t){if(t.tag===13){var e=yo(t,134217728);if(e!==null){var n=nn();mr(e,t,134217728,n)}Yg(t,134217728)}};L2=function(t){if(t.tag===13){var e=mi(t),n=yo(t,e);if(n!==null){var r=nn();mr(n,t,e,r)}Yg(t,e)}};B2=function(){return $e};j2=function(t,e){var n=$e;try{return $e=t,e()}finally{$e=n}};Sm=function(t,e,n){switch(e){case"input":if(ym(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var o=Uf(r);if(!o)throw Error(ee(90));v2(r),ym(r,o)}}}break;case"textarea":y2(t,n);break;case"select":e=n.value,e!=null&&is(t,!!n.multiple,e,!1)}};S2=Hg;k2=ha;var PP={usingClientEntryPoint:!1,Events:[Oc,Qa,Uf,C2,_2,Hg]},xu={findFiberByHostInstance:Xi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},DP={bundleType:xu.bundleType,version:xu.version,rendererPackageName:xu.rendererPackageName,rendererConfig:xu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:_o.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=T2(t),t===null?null:t.stateNode},findFiberByHostInstance:xu.findFiberByHostInstance||NP,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Il=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Il.isDisabled&&Il.supportsFiber)try{Ff=Il.inject(DP),Br=Il}catch{}}On.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=PP;On.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Jg(e))throw Error(ee(200));return TP(t,e,null,n)};On.createRoot=function(t,e){if(!Jg(t))throw Error(ee(299));var n=!1,r="",o=sC;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(o=e.onRecoverableError)),e=Xg(t,1,!1,null,null,n,!1,r,o),t[go]=e.current,nc(t.nodeType===8?t.parentNode:t),new Qg(e)};On.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(ee(188)):(t=Object.keys(t).join(","),Error(ee(268,t)));return t=T2(e),t=t===null?null:t.stateNode,t};On.flushSync=function(t){return ha(t)};On.hydrate=function(t,e,n){if(!Xf(e))throw Error(ee(200));return Yf(null,t,e,!0,n)};On.hydrateRoot=function(t,e,n){if(!Jg(t))throw Error(ee(405));var r=n!=null&&n.hydratedSources||null,o=!1,i="",a=sC;if(n!=null&&(n.unstable_strictMode===!0&&(o=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(a=n.onRecoverableError)),e=aC(e,null,t,1,n??null,o,!1,i,a),t[go]=e.current,nc(t),r)for(t=0;t<r.length;t++)n=r[t],o=n._getVersion,o=o(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,o]:e.mutableSourceEagerHydrationData.push(n,o);return new qf(e)};On.render=function(t,e,n){if(!Xf(e))throw Error(ee(200));return Yf(null,t,e,!1,n)};On.unmountComponentAtNode=function(t){if(!Xf(t))throw Error(ee(40));return t._reactRootContainer?(ha(function(){Yf(null,null,t,!1,function(){t._reactRootContainer=null,t[go]=null})}),!0):!1};On.unstable_batchedUpdates=Hg;On.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Xf(n))throw Error(ee(200));if(t==null||t._reactInternals===void 0)throw Error(ee(38));return Yf(t,e,n,!1,r)};On.version="18.3.1-next-f1338f8080-20240426";function uC(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(uC)}catch(t){console.error(t)}}uC(),u2.exports=On;var Lc=u2.exports;const cC=Yb(Lc);var lC,rx=Lc;lC=rx.createRoot,rx.hydrateRoot;const MP=1,OP=1e6;let pp=0;function FP(){return pp=(pp+1)%Number.MAX_SAFE_INTEGER,pp.toString()}const mp=new Map,ox=t=>{if(mp.has(t))return;const e=setTimeout(()=>{mp.delete(t),$u({type:"REMOVE_TOAST",toastId:t})},OP);mp.set(t,e)},LP=(t,e)=>{switch(e.type){case"ADD_TOAST":return{...t,toasts:[e.toast,...t.toasts].slice(0,MP)};case"UPDATE_TOAST":return{...t,toasts:t.toasts.map(n=>n.id===e.toast.id?{...n,...e.toast}:n)};case"DISMISS_TOAST":{const{toastId:n}=e;return n?ox(n):t.toasts.forEach(r=>{ox(r.id)}),{...t,toasts:t.toasts.map(r=>r.id===n||n===void 0?{...r,open:!1}:r)}}case"REMOVE_TOAST":return e.toastId===void 0?{...t,toasts:[]}:{...t,toasts:t.toasts.filter(n=>n.id!==e.toastId)}}},fd=[];let hd={toasts:[]};function $u(t){hd=LP(hd,t),fd.forEach(e=>{e(hd)})}function BP({...t}){const e=FP(),n=o=>$u({type:"UPDATE_TOAST",toast:{...o,id:e}}),r=()=>$u({type:"DISMISS_TOAST",toastId:e});return $u({type:"ADD_TOAST",toast:{...t,id:e,open:!0,onOpenChange:o=>{o||r()}}}),{id:e,dismiss:r,update:n}}function Zg(){const[t,e]=C.useState(hd);return C.useEffect(()=>(fd.push(e),()=>{const n=fd.indexOf(e);n>-1&&fd.splice(n,1)}),[t]),{...t,toast:BP,dismiss:n=>$u({type:"DISMISS_TOAST",toastId:n})}}function me(t,e,{checkForDefaultPrevented:n=!0}={}){return function(o){if(t==null||t(o),n===!1||!o.defaultPrevented)return e==null?void 0:e(o)}}function ix(t,e){if(typeof t=="function")return t(e);t!=null&&(t.current=e)}function Qf(...t){return e=>{let n=!1;const r=t.map(o=>{const i=ix(o,e);return!n&&typeof i=="function"&&(n=!0),i});if(n)return()=>{for(let o=0;o<r.length;o++){const i=r[o];typeof i=="function"?i():ix(t[o],null)}}}}function At(...t){return C.useCallback(Qf(...t),t)}function So(t,e=[]){let n=[];function r(i,a){const s=C.createContext(a),u=n.length;n=[...n,a];const c=d=>{var v;const{scope:f,children:h,...m}=d,p=((v=f==null?void 0:f[t])==null?void 0:v[u])||s,g=C.useMemo(()=>m,Object.values(m));return b.jsx(p.Provider,{value:g,children:h})};c.displayName=i+"Provider";function l(d,f){var p;const h=((p=f==null?void 0:f[t])==null?void 0:p[u])||s,m=C.useContext(h);if(m)return m;if(a!==void 0)return a;throw new Error(`\`${d}\` must be used within \`${i}\``)}return[c,l]}const o=()=>{const i=n.map(a=>C.createContext(a));return function(s){const u=(s==null?void 0:s[t])||i;return C.useMemo(()=>({[`__scope${t}`]:{...s,[t]:u}}),[s,u])}};return o.scopeName=t,[r,jP(o,...e)]}function jP(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const r=t.map(o=>({useScope:o(),scopeName:o.scopeName}));return function(i){const a=r.reduce((s,{useScope:u,scopeName:c})=>{const d=u(i)[`__scope${c}`];return{...s,...d}},{});return C.useMemo(()=>({[`__scope${e.scopeName}`]:a}),[a])}};return n.scopeName=e.scopeName,n}function dc(t){const e=WP(t),n=C.forwardRef((r,o)=>{const{children:i,...a}=r,s=C.Children.toArray(i),u=s.find(zP);if(u){const c=u.props.children,l=s.map(d=>d===u?C.Children.count(c)>1?C.Children.only(null):C.isValidElement(c)?c.props.children:null:d);return b.jsx(e,{...a,ref:o,children:C.isValidElement(c)?C.cloneElement(c,void 0,l):null})}return b.jsx(e,{...a,ref:o,children:i})});return n.displayName=`${t}.Slot`,n}var UP=dc("Slot");function WP(t){const e=C.forwardRef((n,r)=>{const{children:o,...i}=n;if(C.isValidElement(o)){const a=HP(o),s=VP(i,o.props);return o.type!==C.Fragment&&(s.ref=r?Qf(r,a):a),C.cloneElement(o,s)}return C.Children.count(o)>1?C.Children.only(null):null});return e.displayName=`${t}.SlotClone`,e}var dC=Symbol("radix.slottable");function $P(t){const e=({children:n})=>b.jsx(b.Fragment,{children:n});return e.displayName=`${t}.Slottable`,e.__radixId=dC,e}function zP(t){return C.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===dC}function VP(t,e){const n={...e};for(const r in e){const o=t[r],i=e[r];/^on[A-Z]/.test(r)?o&&i?n[r]=(...s)=>{const u=i(...s);return o(...s),u}:o&&(n[r]=o):r==="style"?n[r]={...o,...i}:r==="className"&&(n[r]=[o,i].filter(Boolean).join(" "))}return{...t,...n}}function HP(t){var r,o;let e=(r=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(o=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:o.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}function ey(t){const e=t+"CollectionProvider",[n,r]=So(e),[o,i]=n(e,{collectionRef:{current:null},itemMap:new Map}),a=p=>{const{scope:g,children:v}=p,y=te.useRef(null),x=te.useRef(new Map).current;return b.jsx(o,{scope:g,itemMap:x,collectionRef:y,children:v})};a.displayName=e;const s=t+"CollectionSlot",u=dc(s),c=te.forwardRef((p,g)=>{const{scope:v,children:y}=p,x=i(s,v),w=At(g,x.collectionRef);return b.jsx(u,{ref:w,children:y})});c.displayName=s;const l=t+"CollectionItemSlot",d="data-radix-collection-item",f=dc(l),h=te.forwardRef((p,g)=>{const{scope:v,children:y,...x}=p,w=te.useRef(null),E=At(g,w),_=i(l,v);return te.useEffect(()=>(_.itemMap.set(w,{ref:w,...x}),()=>void _.itemMap.delete(w))),b.jsx(f,{[d]:"",ref:E,children:y})});h.displayName=l;function m(p){const g=i(t+"CollectionConsumer",p);return te.useCallback(()=>{const y=g.collectionRef.current;if(!y)return[];const x=Array.from(y.querySelectorAll(`[${d}]`));return Array.from(g.itemMap.values()).sort((_,S)=>x.indexOf(_.ref.current)-x.indexOf(S.ref.current))},[g.collectionRef,g.itemMap])}return[{Provider:a,Slot:c,ItemSlot:h},m,r]}var GP=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],je=GP.reduce((t,e)=>{const n=dc(`Primitive.${e}`),r=C.forwardRef((o,i)=>{const{asChild:a,...s}=o,u=a?n:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),b.jsx(u,{...s,ref:i})});return r.displayName=`Primitive.${e}`,{...t,[e]:r}},{});function ty(t,e){t&&Lc.flushSync(()=>t.dispatchEvent(e))}function yn(t){const e=C.useRef(t);return C.useEffect(()=>{e.current=t}),C.useMemo(()=>(...n)=>{var r;return(r=e.current)==null?void 0:r.call(e,...n)},[])}function KP(t,e=globalThis==null?void 0:globalThis.document){const n=yn(t);C.useEffect(()=>{const r=o=>{o.key==="Escape"&&n(o)};return e.addEventListener("keydown",r,{capture:!0}),()=>e.removeEventListener("keydown",r,{capture:!0})},[n,e])}var qP="DismissableLayer",ov="dismissableLayer.update",XP="dismissableLayer.pointerDownOutside",YP="dismissableLayer.focusOutside",ax,fC=C.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Jf=C.forwardRef((t,e)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:r,onPointerDownOutside:o,onFocusOutside:i,onInteractOutside:a,onDismiss:s,...u}=t,c=C.useContext(fC),[l,d]=C.useState(null),f=(l==null?void 0:l.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,h]=C.useState({}),m=At(e,S=>d(S)),p=Array.from(c.layers),[g]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),v=p.indexOf(g),y=l?p.indexOf(l):-1,x=c.layersWithOutsidePointerEventsDisabled.size>0,w=y>=v,E=JP(S=>{const k=S.target,I=[...c.branches].some(R=>R.contains(k));!w||I||(o==null||o(S),a==null||a(S),S.defaultPrevented||s==null||s())},f),_=ZP(S=>{const k=S.target;[...c.branches].some(R=>R.contains(k))||(i==null||i(S),a==null||a(S),S.defaultPrevented||s==null||s())},f);return KP(S=>{y===c.layers.size-1&&(r==null||r(S),!S.defaultPrevented&&s&&(S.preventDefault(),s()))},f),C.useEffect(()=>{if(l)return n&&(c.layersWithOutsidePointerEventsDisabled.size===0&&(ax=f.body.style.pointerEvents,f.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(l)),c.layers.add(l),sx(),()=>{n&&c.layersWithOutsidePointerEventsDisabled.size===1&&(f.body.style.pointerEvents=ax)}},[l,f,n,c]),C.useEffect(()=>()=>{l&&(c.layers.delete(l),c.layersWithOutsidePointerEventsDisabled.delete(l),sx())},[l,c]),C.useEffect(()=>{const S=()=>h({});return document.addEventListener(ov,S),()=>document.removeEventListener(ov,S)},[]),b.jsx(je.div,{...u,ref:m,style:{pointerEvents:x?w?"auto":"none":void 0,...t.style},onFocusCapture:me(t.onFocusCapture,_.onFocusCapture),onBlurCapture:me(t.onBlurCapture,_.onBlurCapture),onPointerDownCapture:me(t.onPointerDownCapture,E.onPointerDownCapture)})});Jf.displayName=qP;var QP="DismissableLayerBranch",hC=C.forwardRef((t,e)=>{const n=C.useContext(fC),r=C.useRef(null),o=At(e,r);return C.useEffect(()=>{const i=r.current;if(i)return n.branches.add(i),()=>{n.branches.delete(i)}},[n.branches]),b.jsx(je.div,{...t,ref:o})});hC.displayName=QP;function JP(t,e=globalThis==null?void 0:globalThis.document){const n=yn(t),r=C.useRef(!1),o=C.useRef(()=>{});return C.useEffect(()=>{const i=s=>{if(s.target&&!r.current){let u=function(){pC(XP,n,c,{discrete:!0})};const c={originalEvent:s};s.pointerType==="touch"?(e.removeEventListener("click",o.current),o.current=u,e.addEventListener("click",o.current,{once:!0})):u()}else e.removeEventListener("click",o.current);r.current=!1},a=window.setTimeout(()=>{e.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(a),e.removeEventListener("pointerdown",i),e.removeEventListener("click",o.current)}},[e,n]),{onPointerDownCapture:()=>r.current=!0}}function ZP(t,e=globalThis==null?void 0:globalThis.document){const n=yn(t),r=C.useRef(!1);return C.useEffect(()=>{const o=i=>{i.target&&!r.current&&pC(YP,n,{originalEvent:i},{discrete:!1})};return e.addEventListener("focusin",o),()=>e.removeEventListener("focusin",o)},[e,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function sx(){const t=new CustomEvent(ov);document.dispatchEvent(t)}function pC(t,e,n,{discrete:r}){const o=n.originalEvent.target,i=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:n});e&&o.addEventListener(t,e,{once:!0}),r?ty(o,i):o.dispatchEvent(i)}var eD=Jf,tD=hC,Xn=globalThis!=null&&globalThis.document?C.useLayoutEffect:()=>{},nD="Portal",ny=C.forwardRef((t,e)=>{var s;const{container:n,...r}=t,[o,i]=C.useState(!1);Xn(()=>i(!0),[]);const a=n||o&&((s=globalThis==null?void 0:globalThis.document)==null?void 0:s.body);return a?cC.createPortal(b.jsx(je.div,{...r,ref:e}),a):null});ny.displayName=nD;function rD(t,e){return C.useReducer((n,r)=>e[n][r]??n,t)}var Pi=t=>{const{present:e,children:n}=t,r=oD(e),o=typeof n=="function"?n({present:r.isPresent}):C.Children.only(n),i=At(r.ref,iD(o));return typeof n=="function"||r.isPresent?C.cloneElement(o,{ref:i}):null};Pi.displayName="Presence";function oD(t){const[e,n]=C.useState(),r=C.useRef(null),o=C.useRef(t),i=C.useRef("none"),a=t?"mounted":"unmounted",[s,u]=rD(a,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return C.useEffect(()=>{const c=Rl(r.current);i.current=s==="mounted"?c:"none"},[s]),Xn(()=>{const c=r.current,l=o.current;if(l!==t){const f=i.current,h=Rl(c);t?u("MOUNT"):h==="none"||(c==null?void 0:c.display)==="none"?u("UNMOUNT"):u(l&&f!==h?"ANIMATION_OUT":"UNMOUNT"),o.current=t}},[t,u]),Xn(()=>{if(e){let c;const l=e.ownerDocument.defaultView??window,d=h=>{const p=Rl(r.current).includes(h.animationName);if(h.target===e&&p&&(u("ANIMATION_END"),!o.current)){const g=e.style.animationFillMode;e.style.animationFillMode="forwards",c=l.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=g)})}},f=h=>{h.target===e&&(i.current=Rl(r.current))};return e.addEventListener("animationstart",f),e.addEventListener("animationcancel",d),e.addEventListener("animationend",d),()=>{l.clearTimeout(c),e.removeEventListener("animationstart",f),e.removeEventListener("animationcancel",d),e.removeEventListener("animationend",d)}}else u("ANIMATION_END")},[e,u]),{isPresent:["mounted","unmountSuspended"].includes(s),ref:C.useCallback(c=>{r.current=c?getComputedStyle(c):null,n(c)},[])}}function Rl(t){return(t==null?void 0:t.animationName)||"none"}function iD(t){var r,o;let e=(r=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(o=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:o.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}var aD=ug[" useInsertionEffect ".trim().toString()]||Xn;function Zf({prop:t,defaultProp:e,onChange:n=()=>{},caller:r}){const[o,i,a]=sD({defaultProp:e,onChange:n}),s=t!==void 0,u=s?t:o;{const l=C.useRef(t!==void 0);C.useEffect(()=>{const d=l.current;d!==s&&console.warn(`${r} is changing from ${d?"controlled":"uncontrolled"} to ${s?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),l.current=s},[s,r])}const c=C.useCallback(l=>{var d;if(s){const f=uD(l)?l(t):l;f!==t&&((d=a.current)==null||d.call(a,f))}else i(l)},[s,t,i,a]);return[u,c]}function sD({defaultProp:t,onChange:e}){const[n,r]=C.useState(t),o=C.useRef(n),i=C.useRef(e);return aD(()=>{i.current=e},[e]),C.useEffect(()=>{var a;o.current!==n&&((a=i.current)==null||a.call(i,n),o.current=n)},[n,o]),[n,r,i]}function uD(t){return typeof t=="function"}var cD=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),lD="VisuallyHidden",eh=C.forwardRef((t,e)=>b.jsx(je.span,{...t,ref:e,style:{...cD,...t.style}}));eh.displayName=lD;var dD=eh,ry="ToastProvider",[oy,fD,hD]=ey("Toast"),[mC,kK]=So("Toast",[hD]),[pD,th]=mC(ry),vC=t=>{const{__scopeToast:e,label:n="Notification",duration:r=5e3,swipeDirection:o="right",swipeThreshold:i=50,children:a}=t,[s,u]=C.useState(null),[c,l]=C.useState(0),d=C.useRef(!1),f=C.useRef(!1);return n.trim()||console.error(`Invalid prop \`label\` supplied to \`${ry}\`. Expected non-empty \`string\`.`),b.jsx(oy.Provider,{scope:e,children:b.jsx(pD,{scope:e,label:n,duration:r,swipeDirection:o,swipeThreshold:i,toastCount:c,viewport:s,onViewportChange:u,onToastAdd:C.useCallback(()=>l(h=>h+1),[]),onToastRemove:C.useCallback(()=>l(h=>h-1),[]),isFocusedToastEscapeKeyDownRef:d,isClosePausedRef:f,children:a})})};vC.displayName=ry;var gC="ToastViewport",mD=["F8"],iv="toast.viewportPause",av="toast.viewportResume",yC=C.forwardRef((t,e)=>{const{__scopeToast:n,hotkey:r=mD,label:o="Notifications ({hotkey})",...i}=t,a=th(gC,n),s=fD(n),u=C.useRef(null),c=C.useRef(null),l=C.useRef(null),d=C.useRef(null),f=At(e,d,a.onViewportChange),h=r.join("+").replace(/Key/g,"").replace(/Digit/g,""),m=a.toastCount>0;C.useEffect(()=>{const g=v=>{var x;r.length!==0&&r.every(w=>v[w]||v.code===w)&&((x=d.current)==null||x.focus())};return document.addEventListener("keydown",g),()=>document.removeEventListener("keydown",g)},[r]),C.useEffect(()=>{const g=u.current,v=d.current;if(m&&g&&v){const y=()=>{if(!a.isClosePausedRef.current){const _=new CustomEvent(iv);v.dispatchEvent(_),a.isClosePausedRef.current=!0}},x=()=>{if(a.isClosePausedRef.current){const _=new CustomEvent(av);v.dispatchEvent(_),a.isClosePausedRef.current=!1}},w=_=>{!g.contains(_.relatedTarget)&&x()},E=()=>{g.contains(document.activeElement)||x()};return g.addEventListener("focusin",y),g.addEventListener("focusout",w),g.addEventListener("pointermove",y),g.addEventListener("pointerleave",E),window.addEventListener("blur",y),window.addEventListener("focus",x),()=>{g.removeEventListener("focusin",y),g.removeEventListener("focusout",w),g.removeEventListener("pointermove",y),g.removeEventListener("pointerleave",E),window.removeEventListener("blur",y),window.removeEventListener("focus",x)}}},[m,a.isClosePausedRef]);const p=C.useCallback(({tabbingDirection:g})=>{const y=s().map(x=>{const w=x.ref.current,E=[w,...RD(w)];return g==="forwards"?E:E.reverse()});return(g==="forwards"?y.reverse():y).flat()},[s]);return C.useEffect(()=>{const g=d.current;if(g){const v=y=>{var E,_,S;const x=y.altKey||y.ctrlKey||y.metaKey;if(y.key==="Tab"&&!x){const k=document.activeElement,I=y.shiftKey;if(y.target===g&&I){(E=c.current)==null||E.focus();return}const A=p({tabbingDirection:I?"backwards":"forwards"}),j=A.findIndex(F=>F===k);vp(A.slice(j+1))?y.preventDefault():I?(_=c.current)==null||_.focus():(S=l.current)==null||S.focus()}};return g.addEventListener("keydown",v),()=>g.removeEventListener("keydown",v)}},[s,p]),b.jsxs(tD,{ref:u,role:"region","aria-label":o.replace("{hotkey}",h),tabIndex:-1,style:{pointerEvents:m?void 0:"none"},children:[m&&b.jsx(sv,{ref:c,onFocusFromOutsideViewport:()=>{const g=p({tabbingDirection:"forwards"});vp(g)}}),b.jsx(oy.Slot,{scope:n,children:b.jsx(je.ol,{tabIndex:-1,...i,ref:f})}),m&&b.jsx(sv,{ref:l,onFocusFromOutsideViewport:()=>{const g=p({tabbingDirection:"backwards"});vp(g)}})]})});yC.displayName=gC;var xC="ToastFocusProxy",sv=C.forwardRef((t,e)=>{const{__scopeToast:n,onFocusFromOutsideViewport:r,...o}=t,i=th(xC,n);return b.jsx(eh,{"aria-hidden":!0,tabIndex:0,...o,ref:e,style:{position:"fixed"},onFocus:a=>{var c;const s=a.relatedTarget;!((c=i.viewport)!=null&&c.contains(s))&&r()}})});sv.displayName=xC;var Bc="Toast",vD="toast.swipeStart",gD="toast.swipeMove",yD="toast.swipeCancel",xD="toast.swipeEnd",wC=C.forwardRef((t,e)=>{const{forceMount:n,open:r,defaultOpen:o,onOpenChange:i,...a}=t,[s,u]=Zf({prop:r,defaultProp:o??!0,onChange:i,caller:Bc});return b.jsx(Pi,{present:n||s,children:b.jsx(ED,{open:s,...a,ref:e,onClose:()=>u(!1),onPause:yn(t.onPause),onResume:yn(t.onResume),onSwipeStart:me(t.onSwipeStart,c=>{c.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:me(t.onSwipeMove,c=>{const{x:l,y:d}=c.detail.delta;c.currentTarget.setAttribute("data-swipe","move"),c.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${l}px`),c.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${d}px`)}),onSwipeCancel:me(t.onSwipeCancel,c=>{c.currentTarget.setAttribute("data-swipe","cancel"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),c.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),c.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:me(t.onSwipeEnd,c=>{const{x:l,y:d}=c.detail.delta;c.currentTarget.setAttribute("data-swipe","end"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),c.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${l}px`),c.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${d}px`),u(!1)})})})});wC.displayName=Bc;var[wD,bD]=mC(Bc,{onClose(){}}),ED=C.forwardRef((t,e)=>{const{__scopeToast:n,type:r="foreground",duration:o,open:i,onClose:a,onEscapeKeyDown:s,onPause:u,onResume:c,onSwipeStart:l,onSwipeMove:d,onSwipeCancel:f,onSwipeEnd:h,...m}=t,p=th(Bc,n),[g,v]=C.useState(null),y=At(e,F=>v(F)),x=C.useRef(null),w=C.useRef(null),E=o||p.duration,_=C.useRef(0),S=C.useRef(E),k=C.useRef(0),{onToastAdd:I,onToastRemove:R}=p,D=yn(()=>{var W;(g==null?void 0:g.contains(document.activeElement))&&((W=p.viewport)==null||W.focus()),a()}),A=C.useCallback(F=>{!F||F===1/0||(window.clearTimeout(k.current),_.current=new Date().getTime(),k.current=window.setTimeout(D,F))},[D]);C.useEffect(()=>{const F=p.viewport;if(F){const W=()=>{A(S.current),c==null||c()},U=()=>{const $=new Date().getTime()-_.current;S.current=S.current-$,window.clearTimeout(k.current),u==null||u()};return F.addEventListener(iv,U),F.addEventListener(av,W),()=>{F.removeEventListener(iv,U),F.removeEventListener(av,W)}}},[p.viewport,E,u,c,A]),C.useEffect(()=>{i&&!p.isClosePausedRef.current&&A(E)},[i,E,p.isClosePausedRef,A]),C.useEffect(()=>(I(),()=>R()),[I,R]);const j=C.useMemo(()=>g?IC(g):null,[g]);return p.viewport?b.jsxs(b.Fragment,{children:[j&&b.jsx(CD,{__scopeToast:n,role:"status","aria-live":r==="foreground"?"assertive":"polite","aria-atomic":!0,children:j}),b.jsx(wD,{scope:n,onClose:D,children:Lc.createPortal(b.jsx(oy.ItemSlot,{scope:n,children:b.jsx(eD,{asChild:!0,onEscapeKeyDown:me(s,()=>{p.isFocusedToastEscapeKeyDownRef.current||D(),p.isFocusedToastEscapeKeyDownRef.current=!1}),children:b.jsx(je.li,{role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":i?"open":"closed","data-swipe-direction":p.swipeDirection,...m,ref:y,style:{userSelect:"none",touchAction:"none",...t.style},onKeyDown:me(t.onKeyDown,F=>{F.key==="Escape"&&(s==null||s(F.nativeEvent),F.nativeEvent.defaultPrevented||(p.isFocusedToastEscapeKeyDownRef.current=!0,D()))}),onPointerDown:me(t.onPointerDown,F=>{F.button===0&&(x.current={x:F.clientX,y:F.clientY})}),onPointerMove:me(t.onPointerMove,F=>{if(!x.current)return;const W=F.clientX-x.current.x,U=F.clientY-x.current.y,$=!!w.current,M=["left","right"].includes(p.swipeDirection),P=["left","up"].includes(p.swipeDirection)?Math.min:Math.max,B=M?P(0,W):0,G=M?0:P(0,U),q=F.pointerType==="touch"?10:2,J={x:B,y:G},H={originalEvent:F,delta:J};$?(w.current=J,Tl(gD,d,H,{discrete:!1})):ux(J,p.swipeDirection,q)?(w.current=J,Tl(vD,l,H,{discrete:!1}),F.target.setPointerCapture(F.pointerId)):(Math.abs(W)>q||Math.abs(U)>q)&&(x.current=null)}),onPointerUp:me(t.onPointerUp,F=>{const W=w.current,U=F.target;if(U.hasPointerCapture(F.pointerId)&&U.releasePointerCapture(F.pointerId),w.current=null,x.current=null,W){const $=F.currentTarget,M={originalEvent:F,delta:W};ux(W,p.swipeDirection,p.swipeThreshold)?Tl(xD,h,M,{discrete:!0}):Tl(yD,f,M,{discrete:!0}),$.addEventListener("click",P=>P.preventDefault(),{once:!0})}})})})}),p.viewport)})]}):null}),CD=t=>{const{__scopeToast:e,children:n,...r}=t,o=th(Bc,e),[i,a]=C.useState(!1),[s,u]=C.useState(!1);return kD(()=>a(!0)),C.useEffect(()=>{const c=window.setTimeout(()=>u(!0),1e3);return()=>window.clearTimeout(c)},[]),s?null:b.jsx(ny,{asChild:!0,children:b.jsx(eh,{...r,children:i&&b.jsxs(b.Fragment,{children:[o.label," ",n]})})})},_D="ToastTitle",bC=C.forwardRef((t,e)=>{const{__scopeToast:n,...r}=t;return b.jsx(je.div,{...r,ref:e})});bC.displayName=_D;var SD="ToastDescription",EC=C.forwardRef((t,e)=>{const{__scopeToast:n,...r}=t;return b.jsx(je.div,{...r,ref:e})});EC.displayName=SD;var CC="ToastAction",_C=C.forwardRef((t,e)=>{const{altText:n,...r}=t;return n.trim()?b.jsx(kC,{altText:n,asChild:!0,children:b.jsx(iy,{...r,ref:e})}):(console.error(`Invalid prop \`altText\` supplied to \`${CC}\`. Expected non-empty \`string\`.`),null)});_C.displayName=CC;var SC="ToastClose",iy=C.forwardRef((t,e)=>{const{__scopeToast:n,...r}=t,o=bD(SC,n);return b.jsx(kC,{asChild:!0,children:b.jsx(je.button,{type:"button",...r,ref:e,onClick:me(t.onClick,o.onClose)})})});iy.displayName=SC;var kC=C.forwardRef((t,e)=>{const{__scopeToast:n,altText:r,...o}=t;return b.jsx(je.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":r||void 0,...o,ref:e})});function IC(t){const e=[];return Array.from(t.childNodes).forEach(r=>{if(r.nodeType===r.TEXT_NODE&&r.textContent&&e.push(r.textContent),ID(r)){const o=r.ariaHidden||r.hidden||r.style.display==="none",i=r.dataset.radixToastAnnounceExclude==="";if(!o)if(i){const a=r.dataset.radixToastAnnounceAlt;a&&e.push(a)}else e.push(...IC(r))}}),e}function Tl(t,e,n,{discrete:r}){const o=n.originalEvent.currentTarget,i=new CustomEvent(t,{bubbles:!0,cancelable:!0,detail:n});e&&o.addEventListener(t,e,{once:!0}),r?ty(o,i):o.dispatchEvent(i)}var ux=(t,e,n=0)=>{const r=Math.abs(t.x),o=Math.abs(t.y),i=r>o;return e==="left"||e==="right"?i&&r>n:!i&&o>n};function kD(t=()=>{}){const e=yn(t);Xn(()=>{let n=0,r=0;return n=window.requestAnimationFrame(()=>r=window.requestAnimationFrame(e)),()=>{window.cancelAnimationFrame(n),window.cancelAnimationFrame(r)}},[e])}function ID(t){return t.nodeType===t.ELEMENT_NODE}function RD(t){const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const o=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||o?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)e.push(n.currentNode);return e}function vp(t){const e=document.activeElement;return t.some(n=>n===e?!0:(n.focus(),document.activeElement!==e))}var TD=vC,RC=yC,TC=wC,NC=bC,AC=EC,PC=_C,DC=iy;function MC(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var o=t.length;for(e=0;e<o;e++)t[e]&&(n=MC(t[e]))&&(r&&(r+=" "),r+=n)}else for(n in t)t[n]&&(r&&(r+=" "),r+=n);return r}function OC(){for(var t,e,n=0,r="",o=arguments.length;n<o;n++)(t=arguments[n])&&(e=MC(t))&&(r&&(r+=" "),r+=e);return r}const cx=t=>typeof t=="boolean"?`${t}`:t===0?"0":t,lx=OC,nh=(t,e)=>n=>{var r;if((e==null?void 0:e.variants)==null)return lx(t,n==null?void 0:n.class,n==null?void 0:n.className);const{variants:o,defaultVariants:i}=e,a=Object.keys(o).map(c=>{const l=n==null?void 0:n[c],d=i==null?void 0:i[c];if(l===null)return null;const f=cx(l)||cx(d);return o[c][f]}),s=n&&Object.entries(n).reduce((c,l)=>{let[d,f]=l;return f===void 0||(c[d]=f),c},{}),u=e==null||(r=e.compoundVariants)===null||r===void 0?void 0:r.reduce((c,l)=>{let{class:d,className:f,...h}=l;return Object.entries(h).every(m=>{let[p,g]=m;return Array.isArray(g)?g.includes({...i,...s}[p]):{...i,...s}[p]===g})?[...c,d,f]:c},[]);return lx(t,a,u,n==null?void 0:n.class,n==null?void 0:n.className)};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ND=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),FC=(...t)=>t.filter((e,n,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===n).join(" ").trim();/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var AD={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PD=C.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:o="",children:i,iconNode:a,...s},u)=>C.createElement("svg",{ref:u,...AD,width:e,height:e,stroke:t,strokeWidth:r?Number(n)*24/Number(e):n,className:FC("lucide",o),...s},[...a.map(([c,l])=>C.createElement(c,l)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Te=(t,e)=>{const n=C.forwardRef(({className:r,...o},i)=>C.createElement(PD,{ref:i,iconNode:e,className:FC(`lucide-${ND(t)}`,r),...o}));return n.displayName=`${t}`,n};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DD=Te("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dx=Te("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MD=Te("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OD=Te("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FD=Te("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LD=Te("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fx=Te("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BD=Te("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jD=Te("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gd=Te("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UD=Te("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WD=Te("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $D=Te("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zD=Te("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hx=Te("KeyRound",[["path",{d:"M2.586 17.414A2 2 0 0 0 2 18.828V21a1 1 0 0 0 1 1h3a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h1a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h.172a2 2 0 0 0 1.414-.586l.814-.814a6.5 6.5 0 1 0-4-4z",key:"1s6t7t"}],["circle",{cx:"16.5",cy:"7.5",r:".5",fill:"currentColor",key:"w0ekpg"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const px=Te("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mx=Te("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vx=Te("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gx=Te("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yx=Te("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ws=Te("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VD=Te("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kd=Te("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HD=Te("Mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GD=Te("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KD=Te("Radio",[["path",{d:"M4.9 19.1C1 15.2 1 8.8 4.9 4.9",key:"1vaf9d"}],["path",{d:"M7.8 16.2c-2.3-2.3-2.3-6.1 0-8.5",key:"u1ii0m"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M16.2 7.8c2.3 2.3 2.3 6.1 0 8.5",key:"1j5fej"}],["path",{d:"M19.1 4.9C23 8.8 23 15.1 19.1 19",key:"10b0cb"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xx=Te("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qD=Te("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wx=Te("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $s=Te("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bx=Te("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LC=Te("Star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XD=Te("ThumbsDown",[["path",{d:"M17 14V2",key:"8ymqnk"}],["path",{d:"M9 18.12 10 14H4.17a2 2 0 0 1-1.92-2.56l2.33-8A2 2 0 0 1 6.5 2H20a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.76a2 2 0 0 0-1.79 1.11L12 22a3.13 3.13 0 0 1-3-3.88Z",key:"m61m77"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YD=Te("ThumbsUp",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2a3.13 3.13 0 0 1 3 3.88Z",key:"emmmcr"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QD=Te("UserRound",[["circle",{cx:"12",cy:"8",r:"5",key:"1hypcn"}],["path",{d:"M20 21a8 8 0 0 0-16 0",key:"rfgkzh"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BC=Te("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JD=Te("VolumeX",[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15",key:"1ewh16"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15",key:"5ykzw1"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rh=Te("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),ay="-",ZD=t=>{const e=tM(t),{conflictingClassGroups:n,conflictingClassGroupModifiers:r}=t;return{getClassGroupId:a=>{const s=a.split(ay);return s[0]===""&&s.length!==1&&s.shift(),jC(s,e)||eM(a)},getConflictingClassGroupIds:(a,s)=>{const u=n[a]||[];return s&&r[a]?[...u,...r[a]]:u}}},jC=(t,e)=>{var a;if(t.length===0)return e.classGroupId;const n=t[0],r=e.nextPart.get(n),o=r?jC(t.slice(1),r):void 0;if(o)return o;if(e.validators.length===0)return;const i=t.join(ay);return(a=e.validators.find(({validator:s})=>s(i)))==null?void 0:a.classGroupId},Ex=/^\[(.+)\]$/,eM=t=>{if(Ex.test(t)){const e=Ex.exec(t)[1],n=e==null?void 0:e.substring(0,e.indexOf(":"));if(n)return"arbitrary.."+n}},tM=t=>{const{theme:e,prefix:n}=t,r={nextPart:new Map,validators:[]};return rM(Object.entries(t.classGroups),n).forEach(([i,a])=>{uv(a,r,i,e)}),r},uv=(t,e,n,r)=>{t.forEach(o=>{if(typeof o=="string"){const i=o===""?e:Cx(e,o);i.classGroupId=n;return}if(typeof o=="function"){if(nM(o)){uv(o(r),e,n,r);return}e.validators.push({validator:o,classGroupId:n});return}Object.entries(o).forEach(([i,a])=>{uv(a,Cx(e,i),n,r)})})},Cx=(t,e)=>{let n=t;return e.split(ay).forEach(r=>{n.nextPart.has(r)||n.nextPart.set(r,{nextPart:new Map,validators:[]}),n=n.nextPart.get(r)}),n},nM=t=>t.isThemeGetter,rM=(t,e)=>e?t.map(([n,r])=>{const o=r.map(i=>typeof i=="string"?e+i:typeof i=="object"?Object.fromEntries(Object.entries(i).map(([a,s])=>[e+a,s])):i);return[n,o]}):t,oM=t=>{if(t<1)return{get:()=>{},set:()=>{}};let e=0,n=new Map,r=new Map;const o=(i,a)=>{n.set(i,a),e++,e>t&&(e=0,r=n,n=new Map)};return{get(i){let a=n.get(i);if(a!==void 0)return a;if((a=r.get(i))!==void 0)return o(i,a),a},set(i,a){n.has(i)?n.set(i,a):o(i,a)}}},UC="!",iM=t=>{const{separator:e,experimentalParseClassName:n}=t,r=e.length===1,o=e[0],i=e.length,a=s=>{const u=[];let c=0,l=0,d;for(let g=0;g<s.length;g++){let v=s[g];if(c===0){if(v===o&&(r||s.slice(g,g+i)===e)){u.push(s.slice(l,g)),l=g+i;continue}if(v==="/"){d=g;continue}}v==="["?c++:v==="]"&&c--}const f=u.length===0?s:s.substring(l),h=f.startsWith(UC),m=h?f.substring(1):f,p=d&&d>l?d-l:void 0;return{modifiers:u,hasImportantModifier:h,baseClassName:m,maybePostfixModifierPosition:p}};return n?s=>n({className:s,parseClassName:a}):a},aM=t=>{if(t.length<=1)return t;const e=[];let n=[];return t.forEach(r=>{r[0]==="["?(e.push(...n.sort(),r),n=[]):n.push(r)}),e.push(...n.sort()),e},sM=t=>({cache:oM(t.cacheSize),parseClassName:iM(t),...ZD(t)}),uM=/\s+/,cM=(t,e)=>{const{parseClassName:n,getClassGroupId:r,getConflictingClassGroupIds:o}=e,i=[],a=t.trim().split(uM);let s="";for(let u=a.length-1;u>=0;u-=1){const c=a[u],{modifiers:l,hasImportantModifier:d,baseClassName:f,maybePostfixModifierPosition:h}=n(c);let m=!!h,p=r(m?f.substring(0,h):f);if(!p){if(!m){s=c+(s.length>0?" "+s:s);continue}if(p=r(f),!p){s=c+(s.length>0?" "+s:s);continue}m=!1}const g=aM(l).join(":"),v=d?g+UC:g,y=v+p;if(i.includes(y))continue;i.push(y);const x=o(p,m);for(let w=0;w<x.length;++w){const E=x[w];i.push(v+E)}s=c+(s.length>0?" "+s:s)}return s};function lM(){let t=0,e,n,r="";for(;t<arguments.length;)(e=arguments[t++])&&(n=WC(e))&&(r&&(r+=" "),r+=n);return r}const WC=t=>{if(typeof t=="string")return t;let e,n="";for(let r=0;r<t.length;r++)t[r]&&(e=WC(t[r]))&&(n&&(n+=" "),n+=e);return n};function dM(t,...e){let n,r,o,i=a;function a(u){const c=e.reduce((l,d)=>d(l),t());return n=sM(c),r=n.cache.get,o=n.cache.set,i=s,s(u)}function s(u){const c=r(u);if(c)return c;const l=cM(u,n);return o(u,l),l}return function(){return i(lM.apply(null,arguments))}}const Ke=t=>{const e=n=>n[t]||[];return e.isThemeGetter=!0,e},$C=/^\[(?:([a-z-]+):)?(.+)\]$/i,fM=/^\d+\/\d+$/,hM=new Set(["px","full","screen"]),pM=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,mM=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,vM=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,gM=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,yM=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,eo=t=>ds(t)||hM.has(t)||fM.test(t),Bo=t=>ou(t,"length",kM),ds=t=>!!t&&!Number.isNaN(Number(t)),gp=t=>ou(t,"number",ds),wu=t=>!!t&&Number.isInteger(Number(t)),xM=t=>t.endsWith("%")&&ds(t.slice(0,-1)),ke=t=>$C.test(t),jo=t=>pM.test(t),wM=new Set(["length","size","percentage"]),bM=t=>ou(t,wM,zC),EM=t=>ou(t,"position",zC),CM=new Set(["image","url"]),_M=t=>ou(t,CM,RM),SM=t=>ou(t,"",IM),bu=()=>!0,ou=(t,e,n)=>{const r=$C.exec(t);return r?r[1]?typeof e=="string"?r[1]===e:e.has(r[1]):n(r[2]):!1},kM=t=>mM.test(t)&&!vM.test(t),zC=()=>!1,IM=t=>gM.test(t),RM=t=>yM.test(t),TM=()=>{const t=Ke("colors"),e=Ke("spacing"),n=Ke("blur"),r=Ke("brightness"),o=Ke("borderColor"),i=Ke("borderRadius"),a=Ke("borderSpacing"),s=Ke("borderWidth"),u=Ke("contrast"),c=Ke("grayscale"),l=Ke("hueRotate"),d=Ke("invert"),f=Ke("gap"),h=Ke("gradientColorStops"),m=Ke("gradientColorStopPositions"),p=Ke("inset"),g=Ke("margin"),v=Ke("opacity"),y=Ke("padding"),x=Ke("saturate"),w=Ke("scale"),E=Ke("sepia"),_=Ke("skew"),S=Ke("space"),k=Ke("translate"),I=()=>["auto","contain","none"],R=()=>["auto","hidden","clip","visible","scroll"],D=()=>["auto",ke,e],A=()=>[ke,e],j=()=>["",eo,Bo],F=()=>["auto",ds,ke],W=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],U=()=>["solid","dashed","dotted","double","none"],$=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],M=()=>["start","end","center","between","around","evenly","stretch"],P=()=>["","0",ke],B=()=>["auto","avoid","all","avoid-page","page","left","right","column"],G=()=>[ds,ke];return{cacheSize:500,separator:":",theme:{colors:[bu],spacing:[eo,Bo],blur:["none","",jo,ke],brightness:G(),borderColor:[t],borderRadius:["none","","full",jo,ke],borderSpacing:A(),borderWidth:j(),contrast:G(),grayscale:P(),hueRotate:G(),invert:P(),gap:A(),gradientColorStops:[t],gradientColorStopPositions:[xM,Bo],inset:D(),margin:D(),opacity:G(),padding:A(),saturate:G(),scale:G(),sepia:P(),skew:G(),space:A(),translate:A()},classGroups:{aspect:[{aspect:["auto","square","video",ke]}],container:["container"],columns:[{columns:[jo]}],"break-after":[{"break-after":B()}],"break-before":[{"break-before":B()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...W(),ke]}],overflow:[{overflow:R()}],"overflow-x":[{"overflow-x":R()}],"overflow-y":[{"overflow-y":R()}],overscroll:[{overscroll:I()}],"overscroll-x":[{"overscroll-x":I()}],"overscroll-y":[{"overscroll-y":I()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[p]}],"inset-x":[{"inset-x":[p]}],"inset-y":[{"inset-y":[p]}],start:[{start:[p]}],end:[{end:[p]}],top:[{top:[p]}],right:[{right:[p]}],bottom:[{bottom:[p]}],left:[{left:[p]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",wu,ke]}],basis:[{basis:D()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",ke]}],grow:[{grow:P()}],shrink:[{shrink:P()}],order:[{order:["first","last","none",wu,ke]}],"grid-cols":[{"grid-cols":[bu]}],"col-start-end":[{col:["auto",{span:["full",wu,ke]},ke]}],"col-start":[{"col-start":F()}],"col-end":[{"col-end":F()}],"grid-rows":[{"grid-rows":[bu]}],"row-start-end":[{row:["auto",{span:[wu,ke]},ke]}],"row-start":[{"row-start":F()}],"row-end":[{"row-end":F()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",ke]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",ke]}],gap:[{gap:[f]}],"gap-x":[{"gap-x":[f]}],"gap-y":[{"gap-y":[f]}],"justify-content":[{justify:["normal",...M()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...M(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...M(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[y]}],px:[{px:[y]}],py:[{py:[y]}],ps:[{ps:[y]}],pe:[{pe:[y]}],pt:[{pt:[y]}],pr:[{pr:[y]}],pb:[{pb:[y]}],pl:[{pl:[y]}],m:[{m:[g]}],mx:[{mx:[g]}],my:[{my:[g]}],ms:[{ms:[g]}],me:[{me:[g]}],mt:[{mt:[g]}],mr:[{mr:[g]}],mb:[{mb:[g]}],ml:[{ml:[g]}],"space-x":[{"space-x":[S]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[S]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",ke,e]}],"min-w":[{"min-w":[ke,e,"min","max","fit"]}],"max-w":[{"max-w":[ke,e,"none","full","min","max","fit","prose",{screen:[jo]},jo]}],h:[{h:[ke,e,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[ke,e,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[ke,e,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[ke,e,"auto","min","max","fit"]}],"font-size":[{text:["base",jo,Bo]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",gp]}],"font-family":[{font:[bu]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",ke]}],"line-clamp":[{"line-clamp":["none",ds,gp]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",eo,ke]}],"list-image":[{"list-image":["none",ke]}],"list-style-type":[{list:["none","disc","decimal",ke]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[t]}],"placeholder-opacity":[{"placeholder-opacity":[v]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[t]}],"text-opacity":[{"text-opacity":[v]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...U(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",eo,Bo]}],"underline-offset":[{"underline-offset":["auto",eo,ke]}],"text-decoration-color":[{decoration:[t]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:A()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",ke]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",ke]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[v]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...W(),EM]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",bM]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},_M]}],"bg-color":[{bg:[t]}],"gradient-from-pos":[{from:[m]}],"gradient-via-pos":[{via:[m]}],"gradient-to-pos":[{to:[m]}],"gradient-from":[{from:[h]}],"gradient-via":[{via:[h]}],"gradient-to":[{to:[h]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[s]}],"border-w-x":[{"border-x":[s]}],"border-w-y":[{"border-y":[s]}],"border-w-s":[{"border-s":[s]}],"border-w-e":[{"border-e":[s]}],"border-w-t":[{"border-t":[s]}],"border-w-r":[{"border-r":[s]}],"border-w-b":[{"border-b":[s]}],"border-w-l":[{"border-l":[s]}],"border-opacity":[{"border-opacity":[v]}],"border-style":[{border:[...U(),"hidden"]}],"divide-x":[{"divide-x":[s]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[s]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[v]}],"divide-style":[{divide:U()}],"border-color":[{border:[o]}],"border-color-x":[{"border-x":[o]}],"border-color-y":[{"border-y":[o]}],"border-color-s":[{"border-s":[o]}],"border-color-e":[{"border-e":[o]}],"border-color-t":[{"border-t":[o]}],"border-color-r":[{"border-r":[o]}],"border-color-b":[{"border-b":[o]}],"border-color-l":[{"border-l":[o]}],"divide-color":[{divide:[o]}],"outline-style":[{outline:["",...U()]}],"outline-offset":[{"outline-offset":[eo,ke]}],"outline-w":[{outline:[eo,Bo]}],"outline-color":[{outline:[t]}],"ring-w":[{ring:j()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[t]}],"ring-opacity":[{"ring-opacity":[v]}],"ring-offset-w":[{"ring-offset":[eo,Bo]}],"ring-offset-color":[{"ring-offset":[t]}],shadow:[{shadow:["","inner","none",jo,SM]}],"shadow-color":[{shadow:[bu]}],opacity:[{opacity:[v]}],"mix-blend":[{"mix-blend":[...$(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":$()}],filter:[{filter:["","none"]}],blur:[{blur:[n]}],brightness:[{brightness:[r]}],contrast:[{contrast:[u]}],"drop-shadow":[{"drop-shadow":["","none",jo,ke]}],grayscale:[{grayscale:[c]}],"hue-rotate":[{"hue-rotate":[l]}],invert:[{invert:[d]}],saturate:[{saturate:[x]}],sepia:[{sepia:[E]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[n]}],"backdrop-brightness":[{"backdrop-brightness":[r]}],"backdrop-contrast":[{"backdrop-contrast":[u]}],"backdrop-grayscale":[{"backdrop-grayscale":[c]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[l]}],"backdrop-invert":[{"backdrop-invert":[d]}],"backdrop-opacity":[{"backdrop-opacity":[v]}],"backdrop-saturate":[{"backdrop-saturate":[x]}],"backdrop-sepia":[{"backdrop-sepia":[E]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[a]}],"border-spacing-x":[{"border-spacing-x":[a]}],"border-spacing-y":[{"border-spacing-y":[a]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",ke]}],duration:[{duration:G()}],ease:[{ease:["linear","in","out","in-out",ke]}],delay:[{delay:G()}],animate:[{animate:["none","spin","ping","pulse","bounce",ke]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[w]}],"scale-x":[{"scale-x":[w]}],"scale-y":[{"scale-y":[w]}],rotate:[{rotate:[wu,ke]}],"translate-x":[{"translate-x":[k]}],"translate-y":[{"translate-y":[k]}],"skew-x":[{"skew-x":[_]}],"skew-y":[{"skew-y":[_]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",ke]}],accent:[{accent:["auto",t]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",ke]}],"caret-color":[{caret:[t]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":A()}],"scroll-mx":[{"scroll-mx":A()}],"scroll-my":[{"scroll-my":A()}],"scroll-ms":[{"scroll-ms":A()}],"scroll-me":[{"scroll-me":A()}],"scroll-mt":[{"scroll-mt":A()}],"scroll-mr":[{"scroll-mr":A()}],"scroll-mb":[{"scroll-mb":A()}],"scroll-ml":[{"scroll-ml":A()}],"scroll-p":[{"scroll-p":A()}],"scroll-px":[{"scroll-px":A()}],"scroll-py":[{"scroll-py":A()}],"scroll-ps":[{"scroll-ps":A()}],"scroll-pe":[{"scroll-pe":A()}],"scroll-pt":[{"scroll-pt":A()}],"scroll-pr":[{"scroll-pr":A()}],"scroll-pb":[{"scroll-pb":A()}],"scroll-pl":[{"scroll-pl":A()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",ke]}],fill:[{fill:[t,"none"]}],"stroke-w":[{stroke:[eo,Bo,gp]}],stroke:[{stroke:[t,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},NM=dM(TM);function we(...t){return NM(OC(t))}const AM=TD,VC=C.forwardRef(({className:t,...e},n)=>b.jsx(RC,{ref:n,className:we("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",t),...e}));VC.displayName=RC.displayName;const PM=nh("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),HC=C.forwardRef(({className:t,variant:e,...n},r)=>b.jsx(TC,{ref:r,className:we(PM({variant:e}),t),...n}));HC.displayName=TC.displayName;const DM=C.forwardRef(({className:t,...e},n)=>b.jsx(PC,{ref:n,className:we("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors group-[.destructive]:border-muted/40 hover:bg-secondary group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 group-[.destructive]:focus:ring-destructive disabled:pointer-events-none disabled:opacity-50",t),...e}));DM.displayName=PC.displayName;const GC=C.forwardRef(({className:t,...e},n)=>b.jsx(DC,{ref:n,className:we("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity group-hover:opacity-100 group-[.destructive]:text-red-300 hover:text-foreground group-[.destructive]:hover:text-red-50 focus:opacity-100 focus:outline-none focus:ring-2 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",t),"toast-close":"",...e,children:b.jsx(rh,{className:"h-4 w-4"})}));GC.displayName=DC.displayName;const KC=C.forwardRef(({className:t,...e},n)=>b.jsx(NC,{ref:n,className:we("text-sm font-semibold",t),...e}));KC.displayName=NC.displayName;const qC=C.forwardRef(({className:t,...e},n)=>b.jsx(AC,{ref:n,className:we("text-sm opacity-90",t),...e}));qC.displayName=AC.displayName;function MM(){const{toasts:t}=Zg();return b.jsxs(AM,{children:[t.map(function({id:e,title:n,description:r,action:o,...i}){return b.jsxs(HC,{...i,children:[b.jsxs("div",{className:"grid gap-1",children:[n&&b.jsx(KC,{children:n}),r&&b.jsx(qC,{children:r})]}),o,b.jsx(GC,{})]},e)}),b.jsx(VC,{})]})}var _x=["light","dark"],OM="(prefers-color-scheme: dark)",FM=C.createContext(void 0),LM={setTheme:t=>{},themes:[]},BM=()=>{var t;return(t=C.useContext(FM))!=null?t:LM};C.memo(({forcedTheme:t,storageKey:e,attribute:n,enableSystem:r,enableColorScheme:o,defaultTheme:i,value:a,attrs:s,nonce:u})=>{let c=i==="system",l=n==="class"?`var d=document.documentElement,c=d.classList;${`c.remove(${s.map(m=>`'${m}'`).join(",")})`};`:`var d=document.documentElement,n='${n}',s='setAttribute';`,d=o?_x.includes(i)&&i?`if(e==='light'||e==='dark'||!e)d.style.colorScheme=e||'${i}'`:"if(e==='light'||e==='dark')d.style.colorScheme=e":"",f=(m,p=!1,g=!0)=>{let v=a?a[m]:m,y=p?m+"|| ''":`'${v}'`,x="";return o&&g&&!p&&_x.includes(m)&&(x+=`d.style.colorScheme = '${m}';`),n==="class"?p||v?x+=`c.add(${y})`:x+="null":v&&(x+=`d[s](n,${y})`),x},h=t?`!function(){${l}${f(t)}}()`:r?`!function(){try{${l}var e=localStorage.getItem('${e}');if('system'===e||(!e&&${c})){var t='${OM}',m=window.matchMedia(t);if(m.media!==t||m.matches){${f("dark")}}else{${f("light")}}}else if(e){${a?`var x=${JSON.stringify(a)};`:""}${f(a?"x[e]":"e",!0)}}${c?"":"else{"+f(i,!1,!1)+"}"}${d}}catch(e){}}()`:`!function(){try{${l}var e=localStorage.getItem('${e}');if(e){${a?`var x=${JSON.stringify(a)};`:""}${f(a?"x[e]":"e",!0)}}else{${f(i,!1,!1)};}${d}}catch(t){}}();`;return C.createElement("script",{nonce:u,dangerouslySetInnerHTML:{__html:h}})});var jM=t=>{switch(t){case"success":return $M;case"info":return VM;case"warning":return zM;case"error":return HM;default:return null}},UM=Array(12).fill(0),WM=({visible:t,className:e})=>te.createElement("div",{className:["sonner-loading-wrapper",e].filter(Boolean).join(" "),"data-visible":t},te.createElement("div",{className:"sonner-spinner"},UM.map((n,r)=>te.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${r}`})))),$M=te.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},te.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),zM=te.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},te.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),VM=te.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},te.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),HM=te.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},te.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),GM=te.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},te.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),te.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),KM=()=>{let[t,e]=te.useState(document.hidden);return te.useEffect(()=>{let n=()=>{e(document.hidden)};return document.addEventListener("visibilitychange",n),()=>window.removeEventListener("visibilitychange",n)},[]),t},cv=1,qM=class{constructor(){this.subscribe=e=>(this.subscribers.push(e),()=>{let n=this.subscribers.indexOf(e);this.subscribers.splice(n,1)}),this.publish=e=>{this.subscribers.forEach(n=>n(e))},this.addToast=e=>{this.publish(e),this.toasts=[...this.toasts,e]},this.create=e=>{var n;let{message:r,...o}=e,i=typeof(e==null?void 0:e.id)=="number"||((n=e.id)==null?void 0:n.length)>0?e.id:cv++,a=this.toasts.find(u=>u.id===i),s=e.dismissible===void 0?!0:e.dismissible;return this.dismissedToasts.has(i)&&this.dismissedToasts.delete(i),a?this.toasts=this.toasts.map(u=>u.id===i?(this.publish({...u,...e,id:i,title:r}),{...u,...e,id:i,dismissible:s,title:r}):u):this.addToast({title:r,...o,dismissible:s,id:i}),i},this.dismiss=e=>(this.dismissedToasts.add(e),e||this.toasts.forEach(n=>{this.subscribers.forEach(r=>r({id:n.id,dismiss:!0}))}),this.subscribers.forEach(n=>n({id:e,dismiss:!0})),e),this.message=(e,n)=>this.create({...n,message:e}),this.error=(e,n)=>this.create({...n,message:e,type:"error"}),this.success=(e,n)=>this.create({...n,type:"success",message:e}),this.info=(e,n)=>this.create({...n,type:"info",message:e}),this.warning=(e,n)=>this.create({...n,type:"warning",message:e}),this.loading=(e,n)=>this.create({...n,type:"loading",message:e}),this.promise=(e,n)=>{if(!n)return;let r;n.loading!==void 0&&(r=this.create({...n,promise:e,type:"loading",message:n.loading,description:typeof n.description!="function"?n.description:void 0}));let o=e instanceof Promise?e:e(),i=r!==void 0,a,s=o.then(async c=>{if(a=["resolve",c],te.isValidElement(c))i=!1,this.create({id:r,type:"default",message:c});else if(YM(c)&&!c.ok){i=!1;let l=typeof n.error=="function"?await n.error(`HTTP error! status: ${c.status}`):n.error,d=typeof n.description=="function"?await n.description(`HTTP error! status: ${c.status}`):n.description;this.create({id:r,type:"error",message:l,description:d})}else if(n.success!==void 0){i=!1;let l=typeof n.success=="function"?await n.success(c):n.success,d=typeof n.description=="function"?await n.description(c):n.description;this.create({id:r,type:"success",message:l,description:d})}}).catch(async c=>{if(a=["reject",c],n.error!==void 0){i=!1;let l=typeof n.error=="function"?await n.error(c):n.error,d=typeof n.description=="function"?await n.description(c):n.description;this.create({id:r,type:"error",message:l,description:d})}}).finally(()=>{var c;i&&(this.dismiss(r),r=void 0),(c=n.finally)==null||c.call(n)}),u=()=>new Promise((c,l)=>s.then(()=>a[0]==="reject"?l(a[1]):c(a[1])).catch(l));return typeof r!="string"&&typeof r!="number"?{unwrap:u}:Object.assign(r,{unwrap:u})},this.custom=(e,n)=>{let r=(n==null?void 0:n.id)||cv++;return this.create({jsx:e(r),id:r,...n}),r},this.getActiveToasts=()=>this.toasts.filter(e=>!this.dismissedToasts.has(e.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}},un=new qM,XM=(t,e)=>{let n=(e==null?void 0:e.id)||cv++;return un.addToast({title:t,...e,id:n}),n},YM=t=>t&&typeof t=="object"&&"ok"in t&&typeof t.ok=="boolean"&&"status"in t&&typeof t.status=="number",QM=XM,JM=()=>un.toasts,ZM=()=>un.getActiveToasts();Object.assign(QM,{success:un.success,info:un.info,warning:un.warning,error:un.error,custom:un.custom,message:un.message,promise:un.promise,dismiss:un.dismiss,loading:un.loading},{getHistory:JM,getToasts:ZM});function e3(t,{insertAt:e}={}){if(typeof document>"u")return;let n=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",e==="top"&&n.firstChild?n.insertBefore(r,n.firstChild):n.appendChild(r),r.styleSheet?r.styleSheet.cssText=t:r.appendChild(document.createTextNode(t))}e3(`:where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999;transition:transform .4s ease}:where([data-sonner-toaster][data-lifted="true"]){transform:translateY(-10px)}@media (hover: none) and (pointer: coarse){:where([data-sonner-toaster][data-lifted="true"]){transform:none}}:where([data-sonner-toaster][data-x-position="right"]){right:var(--offset-right)}:where([data-sonner-toaster][data-x-position="left"]){left:var(--offset-left)}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:var(--offset-top)}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:var(--offset-bottom)}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast] [data-close-button]{background:var(--gray1)}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:-50%;right:-50%;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y, 0px)) translate(var(--swipe-amount-x, 0px));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-bg-hover: hsl(0, 0%, 12%);--normal-border: hsl(0, 0%, 20%);--normal-border-hover: hsl(0, 0%, 25%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}
`);function Nl(t){return t.label!==void 0}var t3=3,n3="32px",r3="16px",Sx=4e3,o3=356,i3=14,a3=20,s3=200;function rr(...t){return t.filter(Boolean).join(" ")}function u3(t){let[e,n]=t.split("-"),r=[];return e&&r.push(e),n&&r.push(n),r}var c3=t=>{var e,n,r,o,i,a,s,u,c,l,d;let{invert:f,toast:h,unstyled:m,interacting:p,setHeights:g,visibleToasts:v,heights:y,index:x,toasts:w,expanded:E,removeToast:_,defaultRichColors:S,closeButton:k,style:I,cancelButtonStyle:R,actionButtonStyle:D,className:A="",descriptionClassName:j="",duration:F,position:W,gap:U,loadingIcon:$,expandByDefault:M,classNames:P,icons:B,closeButtonAriaLabel:G="Close toast",pauseWhenPageIsHidden:q}=t,[J,H]=te.useState(null),[Q,ne]=te.useState(null),[Z,se]=te.useState(!1),[re,xe]=te.useState(!1),[pe,be]=te.useState(!1),[ve,Pe]=te.useState(!1),[Ue,Le]=te.useState(!1),[St,ht]=te.useState(0),[ct,Qn]=te.useState(0),kt=te.useRef(h.duration||F||Sx),Qe=te.useRef(null),lt=te.useRef(null),jt=x===0,Jn=x+1<=v,Ut=h.type,bn=h.dismissible!==!1,Ln=h.className||"",du=h.descriptionClassName||"",Aa=te.useMemo(()=>y.findIndex(_e=>_e.toastId===h.id)||0,[y,h.id]),jh=te.useMemo(()=>{var _e;return(_e=h.closeButton)!=null?_e:k},[h.closeButton,k]),cl=te.useMemo(()=>h.duration||F||Sx,[h.duration,F]),Bi=te.useRef(0),Cr=te.useRef(0),Pa=te.useRef(0),Da=te.useRef(null),[rN,oN]=W.split("-"),G0=te.useMemo(()=>y.reduce((_e,ze,Je)=>Je>=Aa?_e:_e+ze.height,0),[y,Aa]),K0=KM(),iN=h.invert||f,Uh=Ut==="loading";Cr.current=te.useMemo(()=>Aa*U+G0,[Aa,G0]),te.useEffect(()=>{kt.current=cl},[cl]),te.useEffect(()=>{se(!0)},[]),te.useEffect(()=>{let _e=lt.current;if(_e){let ze=_e.getBoundingClientRect().height;return Qn(ze),g(Je=>[{toastId:h.id,height:ze,position:h.position},...Je]),()=>g(Je=>Je.filter(Zn=>Zn.toastId!==h.id))}},[g,h.id]),te.useLayoutEffect(()=>{if(!Z)return;let _e=lt.current,ze=_e.style.height;_e.style.height="auto";let Je=_e.getBoundingClientRect().height;_e.style.height=ze,Qn(Je),g(Zn=>Zn.find(er=>er.toastId===h.id)?Zn.map(er=>er.toastId===h.id?{...er,height:Je}:er):[{toastId:h.id,height:Je,position:h.position},...Zn])},[Z,h.title,h.description,g,h.id]);let Mo=te.useCallback(()=>{xe(!0),ht(Cr.current),g(_e=>_e.filter(ze=>ze.toastId!==h.id)),setTimeout(()=>{_(h)},s3)},[h,_,g,Cr]);te.useEffect(()=>{if(h.promise&&Ut==="loading"||h.duration===1/0||h.type==="loading")return;let _e;return E||p||q&&K0?(()=>{if(Pa.current<Bi.current){let ze=new Date().getTime()-Bi.current;kt.current=kt.current-ze}Pa.current=new Date().getTime()})():kt.current!==1/0&&(Bi.current=new Date().getTime(),_e=setTimeout(()=>{var ze;(ze=h.onAutoClose)==null||ze.call(h,h),Mo()},kt.current)),()=>clearTimeout(_e)},[E,p,h,Ut,q,K0,Mo]),te.useEffect(()=>{h.delete&&Mo()},[Mo,h.delete]);function aN(){var _e,ze,Je;return B!=null&&B.loading?te.createElement("div",{className:rr(P==null?void 0:P.loader,(_e=h==null?void 0:h.classNames)==null?void 0:_e.loader,"sonner-loader"),"data-visible":Ut==="loading"},B.loading):$?te.createElement("div",{className:rr(P==null?void 0:P.loader,(ze=h==null?void 0:h.classNames)==null?void 0:ze.loader,"sonner-loader"),"data-visible":Ut==="loading"},$):te.createElement(WM,{className:rr(P==null?void 0:P.loader,(Je=h==null?void 0:h.classNames)==null?void 0:Je.loader),visible:Ut==="loading"})}return te.createElement("li",{tabIndex:0,ref:lt,className:rr(A,Ln,P==null?void 0:P.toast,(e=h==null?void 0:h.classNames)==null?void 0:e.toast,P==null?void 0:P.default,P==null?void 0:P[Ut],(n=h==null?void 0:h.classNames)==null?void 0:n[Ut]),"data-sonner-toast":"","data-rich-colors":(r=h.richColors)!=null?r:S,"data-styled":!(h.jsx||h.unstyled||m),"data-mounted":Z,"data-promise":!!h.promise,"data-swiped":Ue,"data-removed":re,"data-visible":Jn,"data-y-position":rN,"data-x-position":oN,"data-index":x,"data-front":jt,"data-swiping":pe,"data-dismissible":bn,"data-type":Ut,"data-invert":iN,"data-swipe-out":ve,"data-swipe-direction":Q,"data-expanded":!!(E||M&&Z),style:{"--index":x,"--toasts-before":x,"--z-index":w.length-x,"--offset":`${re?St:Cr.current}px`,"--initial-height":M?"auto":`${ct}px`,...I,...h.style},onDragEnd:()=>{be(!1),H(null),Da.current=null},onPointerDown:_e=>{Uh||!bn||(Qe.current=new Date,ht(Cr.current),_e.target.setPointerCapture(_e.pointerId),_e.target.tagName!=="BUTTON"&&(be(!0),Da.current={x:_e.clientX,y:_e.clientY}))},onPointerUp:()=>{var _e,ze,Je,Zn;if(ve||!bn)return;Da.current=null;let er=Number(((_e=lt.current)==null?void 0:_e.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),Oo=Number(((ze=lt.current)==null?void 0:ze.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),ji=new Date().getTime()-((Je=Qe.current)==null?void 0:Je.getTime()),tr=J==="x"?er:Oo,Fo=Math.abs(tr)/ji;if(Math.abs(tr)>=a3||Fo>.11){ht(Cr.current),(Zn=h.onDismiss)==null||Zn.call(h,h),ne(J==="x"?er>0?"right":"left":Oo>0?"down":"up"),Mo(),Pe(!0),Le(!1);return}be(!1),H(null)},onPointerMove:_e=>{var ze,Je,Zn,er;if(!Da.current||!bn||((ze=window.getSelection())==null?void 0:ze.toString().length)>0)return;let Oo=_e.clientY-Da.current.y,ji=_e.clientX-Da.current.x,tr=(Je=t.swipeDirections)!=null?Je:u3(W);!J&&(Math.abs(ji)>1||Math.abs(Oo)>1)&&H(Math.abs(ji)>Math.abs(Oo)?"x":"y");let Fo={x:0,y:0};J==="y"?(tr.includes("top")||tr.includes("bottom"))&&(tr.includes("top")&&Oo<0||tr.includes("bottom")&&Oo>0)&&(Fo.y=Oo):J==="x"&&(tr.includes("left")||tr.includes("right"))&&(tr.includes("left")&&ji<0||tr.includes("right")&&ji>0)&&(Fo.x=ji),(Math.abs(Fo.x)>0||Math.abs(Fo.y)>0)&&Le(!0),(Zn=lt.current)==null||Zn.style.setProperty("--swipe-amount-x",`${Fo.x}px`),(er=lt.current)==null||er.style.setProperty("--swipe-amount-y",`${Fo.y}px`)}},jh&&!h.jsx?te.createElement("button",{"aria-label":G,"data-disabled":Uh,"data-close-button":!0,onClick:Uh||!bn?()=>{}:()=>{var _e;Mo(),(_e=h.onDismiss)==null||_e.call(h,h)},className:rr(P==null?void 0:P.closeButton,(o=h==null?void 0:h.classNames)==null?void 0:o.closeButton)},(i=B==null?void 0:B.close)!=null?i:GM):null,h.jsx||C.isValidElement(h.title)?h.jsx?h.jsx:typeof h.title=="function"?h.title():h.title:te.createElement(te.Fragment,null,Ut||h.icon||h.promise?te.createElement("div",{"data-icon":"",className:rr(P==null?void 0:P.icon,(a=h==null?void 0:h.classNames)==null?void 0:a.icon)},h.promise||h.type==="loading"&&!h.icon?h.icon||aN():null,h.type!=="loading"?h.icon||(B==null?void 0:B[Ut])||jM(Ut):null):null,te.createElement("div",{"data-content":"",className:rr(P==null?void 0:P.content,(s=h==null?void 0:h.classNames)==null?void 0:s.content)},te.createElement("div",{"data-title":"",className:rr(P==null?void 0:P.title,(u=h==null?void 0:h.classNames)==null?void 0:u.title)},typeof h.title=="function"?h.title():h.title),h.description?te.createElement("div",{"data-description":"",className:rr(j,du,P==null?void 0:P.description,(c=h==null?void 0:h.classNames)==null?void 0:c.description)},typeof h.description=="function"?h.description():h.description):null),C.isValidElement(h.cancel)?h.cancel:h.cancel&&Nl(h.cancel)?te.createElement("button",{"data-button":!0,"data-cancel":!0,style:h.cancelButtonStyle||R,onClick:_e=>{var ze,Je;Nl(h.cancel)&&bn&&((Je=(ze=h.cancel).onClick)==null||Je.call(ze,_e),Mo())},className:rr(P==null?void 0:P.cancelButton,(l=h==null?void 0:h.classNames)==null?void 0:l.cancelButton)},h.cancel.label):null,C.isValidElement(h.action)?h.action:h.action&&Nl(h.action)?te.createElement("button",{"data-button":!0,"data-action":!0,style:h.actionButtonStyle||D,onClick:_e=>{var ze,Je;Nl(h.action)&&((Je=(ze=h.action).onClick)==null||Je.call(ze,_e),!_e.defaultPrevented&&Mo())},className:rr(P==null?void 0:P.actionButton,(d=h==null?void 0:h.classNames)==null?void 0:d.actionButton)},h.action.label):null))};function kx(){if(typeof window>"u"||typeof document>"u")return"ltr";let t=document.documentElement.getAttribute("dir");return t==="auto"||!t?window.getComputedStyle(document.documentElement).direction:t}function l3(t,e){let n={};return[t,e].forEach((r,o)=>{let i=o===1,a=i?"--mobile-offset":"--offset",s=i?r3:n3;function u(c){["top","right","bottom","left"].forEach(l=>{n[`${a}-${l}`]=typeof c=="number"?`${c}px`:c})}typeof r=="number"||typeof r=="string"?u(r):typeof r=="object"?["top","right","bottom","left"].forEach(c=>{r[c]===void 0?n[`${a}-${c}`]=s:n[`${a}-${c}`]=typeof r[c]=="number"?`${r[c]}px`:r[c]}):u(s)}),n}var d3=C.forwardRef(function(t,e){let{invert:n,position:r="bottom-right",hotkey:o=["altKey","KeyT"],expand:i,closeButton:a,className:s,offset:u,mobileOffset:c,theme:l="light",richColors:d,duration:f,style:h,visibleToasts:m=t3,toastOptions:p,dir:g=kx(),gap:v=i3,loadingIcon:y,icons:x,containerAriaLabel:w="Notifications",pauseWhenPageIsHidden:E}=t,[_,S]=te.useState([]),k=te.useMemo(()=>Array.from(new Set([r].concat(_.filter(q=>q.position).map(q=>q.position)))),[_,r]),[I,R]=te.useState([]),[D,A]=te.useState(!1),[j,F]=te.useState(!1),[W,U]=te.useState(l!=="system"?l:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),$=te.useRef(null),M=o.join("+").replace(/Key/g,"").replace(/Digit/g,""),P=te.useRef(null),B=te.useRef(!1),G=te.useCallback(q=>{S(J=>{var H;return(H=J.find(Q=>Q.id===q.id))!=null&&H.delete||un.dismiss(q.id),J.filter(({id:Q})=>Q!==q.id)})},[]);return te.useEffect(()=>un.subscribe(q=>{if(q.dismiss){S(J=>J.map(H=>H.id===q.id?{...H,delete:!0}:H));return}setTimeout(()=>{cC.flushSync(()=>{S(J=>{let H=J.findIndex(Q=>Q.id===q.id);return H!==-1?[...J.slice(0,H),{...J[H],...q},...J.slice(H+1)]:[q,...J]})})})}),[]),te.useEffect(()=>{if(l!=="system"){U(l);return}if(l==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?U("dark"):U("light")),typeof window>"u")return;let q=window.matchMedia("(prefers-color-scheme: dark)");try{q.addEventListener("change",({matches:J})=>{U(J?"dark":"light")})}catch{q.addListener(({matches:H})=>{try{U(H?"dark":"light")}catch(Q){console.error(Q)}})}},[l]),te.useEffect(()=>{_.length<=1&&A(!1)},[_]),te.useEffect(()=>{let q=J=>{var H,Q;o.every(ne=>J[ne]||J.code===ne)&&(A(!0),(H=$.current)==null||H.focus()),J.code==="Escape"&&(document.activeElement===$.current||(Q=$.current)!=null&&Q.contains(document.activeElement))&&A(!1)};return document.addEventListener("keydown",q),()=>document.removeEventListener("keydown",q)},[o]),te.useEffect(()=>{if($.current)return()=>{P.current&&(P.current.focus({preventScroll:!0}),P.current=null,B.current=!1)}},[$.current]),te.createElement("section",{ref:e,"aria-label":`${w} ${M}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},k.map((q,J)=>{var H;let[Q,ne]=q.split("-");return _.length?te.createElement("ol",{key:q,dir:g==="auto"?kx():g,tabIndex:-1,ref:$,className:s,"data-sonner-toaster":!0,"data-theme":W,"data-y-position":Q,"data-lifted":D&&_.length>1&&!i,"data-x-position":ne,style:{"--front-toast-height":`${((H=I[0])==null?void 0:H.height)||0}px`,"--width":`${o3}px`,"--gap":`${v}px`,...h,...l3(u,c)},onBlur:Z=>{B.current&&!Z.currentTarget.contains(Z.relatedTarget)&&(B.current=!1,P.current&&(P.current.focus({preventScroll:!0}),P.current=null))},onFocus:Z=>{Z.target instanceof HTMLElement&&Z.target.dataset.dismissible==="false"||B.current||(B.current=!0,P.current=Z.relatedTarget)},onMouseEnter:()=>A(!0),onMouseMove:()=>A(!0),onMouseLeave:()=>{j||A(!1)},onDragEnd:()=>A(!1),onPointerDown:Z=>{Z.target instanceof HTMLElement&&Z.target.dataset.dismissible==="false"||F(!0)},onPointerUp:()=>F(!1)},_.filter(Z=>!Z.position&&J===0||Z.position===q).map((Z,se)=>{var re,xe;return te.createElement(c3,{key:Z.id,icons:x,index:se,toast:Z,defaultRichColors:d,duration:(re=p==null?void 0:p.duration)!=null?re:f,className:p==null?void 0:p.className,descriptionClassName:p==null?void 0:p.descriptionClassName,invert:n,visibleToasts:m,closeButton:(xe=p==null?void 0:p.closeButton)!=null?xe:a,interacting:j,position:q,style:p==null?void 0:p.style,unstyled:p==null?void 0:p.unstyled,classNames:p==null?void 0:p.classNames,cancelButtonStyle:p==null?void 0:p.cancelButtonStyle,actionButtonStyle:p==null?void 0:p.actionButtonStyle,removeToast:G,toasts:_.filter(pe=>pe.position==Z.position),heights:I.filter(pe=>pe.position==Z.position),setHeights:R,expandByDefault:i,gap:v,loadingIcon:y,expanded:D,pauseWhenPageIsHidden:E,swipeDirections:t.swipeDirections})})):null}))});const f3=({...t})=>{const{theme:e="system"}=BM();return b.jsx(d3,{theme:e,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...t})};var h3=ug[" useId ".trim().toString()]||(()=>{}),p3=0;function qd(t){const[e,n]=C.useState(h3());return Xn(()=>{t||n(r=>r??String(p3++))},[t]),t||(e?`radix-${e}`:"")}const m3=["top","right","bottom","left"],Si=Math.min,_n=Math.max,Xd=Math.round,Al=Math.floor,Ur=t=>({x:t,y:t}),v3={left:"right",right:"left",bottom:"top",top:"bottom"},g3={start:"end",end:"start"};function lv(t,e,n){return _n(t,Si(e,n))}function wo(t,e){return typeof t=="function"?t(e):t}function bo(t){return t.split("-")[0]}function iu(t){return t.split("-")[1]}function sy(t){return t==="x"?"y":"x"}function uy(t){return t==="y"?"height":"width"}const y3=new Set(["top","bottom"]);function Fr(t){return y3.has(bo(t))?"y":"x"}function cy(t){return sy(Fr(t))}function x3(t,e,n){n===void 0&&(n=!1);const r=iu(t),o=cy(t),i=uy(o);let a=o==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return e.reference[i]>e.floating[i]&&(a=Yd(a)),[a,Yd(a)]}function w3(t){const e=Yd(t);return[dv(t),e,dv(e)]}function dv(t){return t.replace(/start|end/g,e=>g3[e])}const Ix=["left","right"],Rx=["right","left"],b3=["top","bottom"],E3=["bottom","top"];function C3(t,e,n){switch(t){case"top":case"bottom":return n?e?Rx:Ix:e?Ix:Rx;case"left":case"right":return e?b3:E3;default:return[]}}function _3(t,e,n,r){const o=iu(t);let i=C3(bo(t),n==="start",r);return o&&(i=i.map(a=>a+"-"+o),e&&(i=i.concat(i.map(dv)))),i}function Yd(t){return t.replace(/left|right|bottom|top/g,e=>v3[e])}function S3(t){return{top:0,right:0,bottom:0,left:0,...t}}function XC(t){return typeof t!="number"?S3(t):{top:t,right:t,bottom:t,left:t}}function Qd(t){const{x:e,y:n,width:r,height:o}=t;return{width:r,height:o,top:n,left:e,right:e+r,bottom:n+o,x:e,y:n}}function Tx(t,e,n){let{reference:r,floating:o}=t;const i=Fr(e),a=cy(e),s=uy(a),u=bo(e),c=i==="y",l=r.x+r.width/2-o.width/2,d=r.y+r.height/2-o.height/2,f=r[s]/2-o[s]/2;let h;switch(u){case"top":h={x:l,y:r.y-o.height};break;case"bottom":h={x:l,y:r.y+r.height};break;case"right":h={x:r.x+r.width,y:d};break;case"left":h={x:r.x-o.width,y:d};break;default:h={x:r.x,y:r.y}}switch(iu(e)){case"start":h[a]-=f*(n&&c?-1:1);break;case"end":h[a]+=f*(n&&c?-1:1);break}return h}const k3=async(t,e,n)=>{const{placement:r="bottom",strategy:o="absolute",middleware:i=[],platform:a}=n,s=i.filter(Boolean),u=await(a.isRTL==null?void 0:a.isRTL(e));let c=await a.getElementRects({reference:t,floating:e,strategy:o}),{x:l,y:d}=Tx(c,r,u),f=r,h={},m=0;for(let p=0;p<s.length;p++){const{name:g,fn:v}=s[p],{x:y,y:x,data:w,reset:E}=await v({x:l,y:d,initialPlacement:r,placement:f,strategy:o,middlewareData:h,rects:c,platform:a,elements:{reference:t,floating:e}});l=y??l,d=x??d,h={...h,[g]:{...h[g],...w}},E&&m<=50&&(m++,typeof E=="object"&&(E.placement&&(f=E.placement),E.rects&&(c=E.rects===!0?await a.getElementRects({reference:t,floating:e,strategy:o}):E.rects),{x:l,y:d}=Tx(c,f,u)),p=-1)}return{x:l,y:d,placement:f,strategy:o,middlewareData:h}};async function fc(t,e){var n;e===void 0&&(e={});const{x:r,y:o,platform:i,rects:a,elements:s,strategy:u}=t,{boundary:c="clippingAncestors",rootBoundary:l="viewport",elementContext:d="floating",altBoundary:f=!1,padding:h=0}=wo(e,t),m=XC(h),g=s[f?d==="floating"?"reference":"floating":d],v=Qd(await i.getClippingRect({element:(n=await(i.isElement==null?void 0:i.isElement(g)))==null||n?g:g.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(s.floating)),boundary:c,rootBoundary:l,strategy:u})),y=d==="floating"?{x:r,y:o,width:a.floating.width,height:a.floating.height}:a.reference,x=await(i.getOffsetParent==null?void 0:i.getOffsetParent(s.floating)),w=await(i.isElement==null?void 0:i.isElement(x))?await(i.getScale==null?void 0:i.getScale(x))||{x:1,y:1}:{x:1,y:1},E=Qd(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:s,rect:y,offsetParent:x,strategy:u}):y);return{top:(v.top-E.top+m.top)/w.y,bottom:(E.bottom-v.bottom+m.bottom)/w.y,left:(v.left-E.left+m.left)/w.x,right:(E.right-v.right+m.right)/w.x}}const I3=t=>({name:"arrow",options:t,async fn(e){const{x:n,y:r,placement:o,rects:i,platform:a,elements:s,middlewareData:u}=e,{element:c,padding:l=0}=wo(t,e)||{};if(c==null)return{};const d=XC(l),f={x:n,y:r},h=cy(o),m=uy(h),p=await a.getDimensions(c),g=h==="y",v=g?"top":"left",y=g?"bottom":"right",x=g?"clientHeight":"clientWidth",w=i.reference[m]+i.reference[h]-f[h]-i.floating[m],E=f[h]-i.reference[h],_=await(a.getOffsetParent==null?void 0:a.getOffsetParent(c));let S=_?_[x]:0;(!S||!await(a.isElement==null?void 0:a.isElement(_)))&&(S=s.floating[x]||i.floating[m]);const k=w/2-E/2,I=S/2-p[m]/2-1,R=Si(d[v],I),D=Si(d[y],I),A=R,j=S-p[m]-D,F=S/2-p[m]/2+k,W=lv(A,F,j),U=!u.arrow&&iu(o)!=null&&F!==W&&i.reference[m]/2-(F<A?R:D)-p[m]/2<0,$=U?F<A?F-A:F-j:0;return{[h]:f[h]+$,data:{[h]:W,centerOffset:F-W-$,...U&&{alignmentOffset:$}},reset:U}}}),R3=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var n,r;const{placement:o,middlewareData:i,rects:a,initialPlacement:s,platform:u,elements:c}=e,{mainAxis:l=!0,crossAxis:d=!0,fallbackPlacements:f,fallbackStrategy:h="bestFit",fallbackAxisSideDirection:m="none",flipAlignment:p=!0,...g}=wo(t,e);if((n=i.arrow)!=null&&n.alignmentOffset)return{};const v=bo(o),y=Fr(s),x=bo(s)===s,w=await(u.isRTL==null?void 0:u.isRTL(c.floating)),E=f||(x||!p?[Yd(s)]:w3(s)),_=m!=="none";!f&&_&&E.push(..._3(s,p,m,w));const S=[s,...E],k=await fc(e,g),I=[];let R=((r=i.flip)==null?void 0:r.overflows)||[];if(l&&I.push(k[v]),d){const F=x3(o,a,w);I.push(k[F[0]],k[F[1]])}if(R=[...R,{placement:o,overflows:I}],!I.every(F=>F<=0)){var D,A;const F=(((D=i.flip)==null?void 0:D.index)||0)+1,W=S[F];if(W&&(!(d==="alignment"?y!==Fr(W):!1)||R.every(M=>M.overflows[0]>0&&Fr(M.placement)===y)))return{data:{index:F,overflows:R},reset:{placement:W}};let U=(A=R.filter($=>$.overflows[0]<=0).sort(($,M)=>$.overflows[1]-M.overflows[1])[0])==null?void 0:A.placement;if(!U)switch(h){case"bestFit":{var j;const $=(j=R.filter(M=>{if(_){const P=Fr(M.placement);return P===y||P==="y"}return!0}).map(M=>[M.placement,M.overflows.filter(P=>P>0).reduce((P,B)=>P+B,0)]).sort((M,P)=>M[1]-P[1])[0])==null?void 0:j[0];$&&(U=$);break}case"initialPlacement":U=s;break}if(o!==U)return{reset:{placement:U}}}return{}}}};function Nx(t,e){return{top:t.top-e.height,right:t.right-e.width,bottom:t.bottom-e.height,left:t.left-e.width}}function Ax(t){return m3.some(e=>t[e]>=0)}const T3=function(t){return t===void 0&&(t={}),{name:"hide",options:t,async fn(e){const{rects:n}=e,{strategy:r="referenceHidden",...o}=wo(t,e);switch(r){case"referenceHidden":{const i=await fc(e,{...o,elementContext:"reference"}),a=Nx(i,n.reference);return{data:{referenceHiddenOffsets:a,referenceHidden:Ax(a)}}}case"escaped":{const i=await fc(e,{...o,altBoundary:!0}),a=Nx(i,n.floating);return{data:{escapedOffsets:a,escaped:Ax(a)}}}default:return{}}}}},YC=new Set(["left","top"]);async function N3(t,e){const{placement:n,platform:r,elements:o}=t,i=await(r.isRTL==null?void 0:r.isRTL(o.floating)),a=bo(n),s=iu(n),u=Fr(n)==="y",c=YC.has(a)?-1:1,l=i&&u?-1:1,d=wo(e,t);let{mainAxis:f,crossAxis:h,alignmentAxis:m}=typeof d=="number"?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:d.mainAxis||0,crossAxis:d.crossAxis||0,alignmentAxis:d.alignmentAxis};return s&&typeof m=="number"&&(h=s==="end"?m*-1:m),u?{x:h*l,y:f*c}:{x:f*c,y:h*l}}const A3=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){var n,r;const{x:o,y:i,placement:a,middlewareData:s}=e,u=await N3(e,t);return a===((n=s.offset)==null?void 0:n.placement)&&(r=s.arrow)!=null&&r.alignmentOffset?{}:{x:o+u.x,y:i+u.y,data:{...u,placement:a}}}}},P3=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:n,y:r,placement:o}=e,{mainAxis:i=!0,crossAxis:a=!1,limiter:s={fn:g=>{let{x:v,y}=g;return{x:v,y}}},...u}=wo(t,e),c={x:n,y:r},l=await fc(e,u),d=Fr(bo(o)),f=sy(d);let h=c[f],m=c[d];if(i){const g=f==="y"?"top":"left",v=f==="y"?"bottom":"right",y=h+l[g],x=h-l[v];h=lv(y,h,x)}if(a){const g=d==="y"?"top":"left",v=d==="y"?"bottom":"right",y=m+l[g],x=m-l[v];m=lv(y,m,x)}const p=s.fn({...e,[f]:h,[d]:m});return{...p,data:{x:p.x-n,y:p.y-r,enabled:{[f]:i,[d]:a}}}}}},D3=function(t){return t===void 0&&(t={}),{options:t,fn(e){const{x:n,y:r,placement:o,rects:i,middlewareData:a}=e,{offset:s=0,mainAxis:u=!0,crossAxis:c=!0}=wo(t,e),l={x:n,y:r},d=Fr(o),f=sy(d);let h=l[f],m=l[d];const p=wo(s,e),g=typeof p=="number"?{mainAxis:p,crossAxis:0}:{mainAxis:0,crossAxis:0,...p};if(u){const x=f==="y"?"height":"width",w=i.reference[f]-i.floating[x]+g.mainAxis,E=i.reference[f]+i.reference[x]-g.mainAxis;h<w?h=w:h>E&&(h=E)}if(c){var v,y;const x=f==="y"?"width":"height",w=YC.has(bo(o)),E=i.reference[d]-i.floating[x]+(w&&((v=a.offset)==null?void 0:v[d])||0)+(w?0:g.crossAxis),_=i.reference[d]+i.reference[x]+(w?0:((y=a.offset)==null?void 0:y[d])||0)-(w?g.crossAxis:0);m<E?m=E:m>_&&(m=_)}return{[f]:h,[d]:m}}}},M3=function(t){return t===void 0&&(t={}),{name:"size",options:t,async fn(e){var n,r;const{placement:o,rects:i,platform:a,elements:s}=e,{apply:u=()=>{},...c}=wo(t,e),l=await fc(e,c),d=bo(o),f=iu(o),h=Fr(o)==="y",{width:m,height:p}=i.floating;let g,v;d==="top"||d==="bottom"?(g=d,v=f===(await(a.isRTL==null?void 0:a.isRTL(s.floating))?"start":"end")?"left":"right"):(v=d,g=f==="end"?"top":"bottom");const y=p-l.top-l.bottom,x=m-l.left-l.right,w=Si(p-l[g],y),E=Si(m-l[v],x),_=!e.middlewareData.shift;let S=w,k=E;if((n=e.middlewareData.shift)!=null&&n.enabled.x&&(k=x),(r=e.middlewareData.shift)!=null&&r.enabled.y&&(S=y),_&&!f){const R=_n(l.left,0),D=_n(l.right,0),A=_n(l.top,0),j=_n(l.bottom,0);h?k=m-2*(R!==0||D!==0?R+D:_n(l.left,l.right)):S=p-2*(A!==0||j!==0?A+j:_n(l.top,l.bottom))}await u({...e,availableWidth:k,availableHeight:S});const I=await a.getDimensions(s.floating);return m!==I.width||p!==I.height?{reset:{rects:!0}}:{}}}};function oh(){return typeof window<"u"}function au(t){return QC(t)?(t.nodeName||"").toLowerCase():"#document"}function Pn(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function qr(t){var e;return(e=(QC(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function QC(t){return oh()?t instanceof Node||t instanceof Pn(t).Node:!1}function yr(t){return oh()?t instanceof Element||t instanceof Pn(t).Element:!1}function Gr(t){return oh()?t instanceof HTMLElement||t instanceof Pn(t).HTMLElement:!1}function Px(t){return!oh()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof Pn(t).ShadowRoot}const O3=new Set(["inline","contents"]);function jc(t){const{overflow:e,overflowX:n,overflowY:r,display:o}=xr(t);return/auto|scroll|overlay|hidden|clip/.test(e+r+n)&&!O3.has(o)}const F3=new Set(["table","td","th"]);function L3(t){return F3.has(au(t))}const B3=[":popover-open",":modal"];function ih(t){return B3.some(e=>{try{return t.matches(e)}catch{return!1}})}const j3=["transform","translate","scale","rotate","perspective"],U3=["transform","translate","scale","rotate","perspective","filter"],W3=["paint","layout","strict","content"];function ly(t){const e=dy(),n=yr(t)?xr(t):t;return j3.some(r=>n[r]?n[r]!=="none":!1)||(n.containerType?n.containerType!=="normal":!1)||!e&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!e&&(n.filter?n.filter!=="none":!1)||U3.some(r=>(n.willChange||"").includes(r))||W3.some(r=>(n.contain||"").includes(r))}function $3(t){let e=ki(t);for(;Gr(e)&&!zs(e);){if(ly(e))return e;if(ih(e))return null;e=ki(e)}return null}function dy(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const z3=new Set(["html","body","#document"]);function zs(t){return z3.has(au(t))}function xr(t){return Pn(t).getComputedStyle(t)}function ah(t){return yr(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function ki(t){if(au(t)==="html")return t;const e=t.assignedSlot||t.parentNode||Px(t)&&t.host||qr(t);return Px(e)?e.host:e}function JC(t){const e=ki(t);return zs(e)?t.ownerDocument?t.ownerDocument.body:t.body:Gr(e)&&jc(e)?e:JC(e)}function hc(t,e,n){var r;e===void 0&&(e=[]),n===void 0&&(n=!0);const o=JC(t),i=o===((r=t.ownerDocument)==null?void 0:r.body),a=Pn(o);if(i){const s=fv(a);return e.concat(a,a.visualViewport||[],jc(o)?o:[],s&&n?hc(s):[])}return e.concat(o,hc(o,[],n))}function fv(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function ZC(t){const e=xr(t);let n=parseFloat(e.width)||0,r=parseFloat(e.height)||0;const o=Gr(t),i=o?t.offsetWidth:n,a=o?t.offsetHeight:r,s=Xd(n)!==i||Xd(r)!==a;return s&&(n=i,r=a),{width:n,height:r,$:s}}function fy(t){return yr(t)?t:t.contextElement}function fs(t){const e=fy(t);if(!Gr(e))return Ur(1);const n=e.getBoundingClientRect(),{width:r,height:o,$:i}=ZC(e);let a=(i?Xd(n.width):n.width)/r,s=(i?Xd(n.height):n.height)/o;return(!a||!Number.isFinite(a))&&(a=1),(!s||!Number.isFinite(s))&&(s=1),{x:a,y:s}}const V3=Ur(0);function e_(t){const e=Pn(t);return!dy()||!e.visualViewport?V3:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function H3(t,e,n){return e===void 0&&(e=!1),!n||e&&n!==Pn(t)?!1:e}function pa(t,e,n,r){e===void 0&&(e=!1),n===void 0&&(n=!1);const o=t.getBoundingClientRect(),i=fy(t);let a=Ur(1);e&&(r?yr(r)&&(a=fs(r)):a=fs(t));const s=H3(i,n,r)?e_(i):Ur(0);let u=(o.left+s.x)/a.x,c=(o.top+s.y)/a.y,l=o.width/a.x,d=o.height/a.y;if(i){const f=Pn(i),h=r&&yr(r)?Pn(r):r;let m=f,p=fv(m);for(;p&&r&&h!==m;){const g=fs(p),v=p.getBoundingClientRect(),y=xr(p),x=v.left+(p.clientLeft+parseFloat(y.paddingLeft))*g.x,w=v.top+(p.clientTop+parseFloat(y.paddingTop))*g.y;u*=g.x,c*=g.y,l*=g.x,d*=g.y,u+=x,c+=w,m=Pn(p),p=fv(m)}}return Qd({width:l,height:d,x:u,y:c})}function hy(t,e){const n=ah(t).scrollLeft;return e?e.left+n:pa(qr(t)).left+n}function t_(t,e,n){n===void 0&&(n=!1);const r=t.getBoundingClientRect(),o=r.left+e.scrollLeft-(n?0:hy(t,r)),i=r.top+e.scrollTop;return{x:o,y:i}}function G3(t){let{elements:e,rect:n,offsetParent:r,strategy:o}=t;const i=o==="fixed",a=qr(r),s=e?ih(e.floating):!1;if(r===a||s&&i)return n;let u={scrollLeft:0,scrollTop:0},c=Ur(1);const l=Ur(0),d=Gr(r);if((d||!d&&!i)&&((au(r)!=="body"||jc(a))&&(u=ah(r)),Gr(r))){const h=pa(r);c=fs(r),l.x=h.x+r.clientLeft,l.y=h.y+r.clientTop}const f=a&&!d&&!i?t_(a,u,!0):Ur(0);return{width:n.width*c.x,height:n.height*c.y,x:n.x*c.x-u.scrollLeft*c.x+l.x+f.x,y:n.y*c.y-u.scrollTop*c.y+l.y+f.y}}function K3(t){return Array.from(t.getClientRects())}function q3(t){const e=qr(t),n=ah(t),r=t.ownerDocument.body,o=_n(e.scrollWidth,e.clientWidth,r.scrollWidth,r.clientWidth),i=_n(e.scrollHeight,e.clientHeight,r.scrollHeight,r.clientHeight);let a=-n.scrollLeft+hy(t);const s=-n.scrollTop;return xr(r).direction==="rtl"&&(a+=_n(e.clientWidth,r.clientWidth)-o),{width:o,height:i,x:a,y:s}}function X3(t,e){const n=Pn(t),r=qr(t),o=n.visualViewport;let i=r.clientWidth,a=r.clientHeight,s=0,u=0;if(o){i=o.width,a=o.height;const c=dy();(!c||c&&e==="fixed")&&(s=o.offsetLeft,u=o.offsetTop)}return{width:i,height:a,x:s,y:u}}const Y3=new Set(["absolute","fixed"]);function Q3(t,e){const n=pa(t,!0,e==="fixed"),r=n.top+t.clientTop,o=n.left+t.clientLeft,i=Gr(t)?fs(t):Ur(1),a=t.clientWidth*i.x,s=t.clientHeight*i.y,u=o*i.x,c=r*i.y;return{width:a,height:s,x:u,y:c}}function Dx(t,e,n){let r;if(e==="viewport")r=X3(t,n);else if(e==="document")r=q3(qr(t));else if(yr(e))r=Q3(e,n);else{const o=e_(t);r={x:e.x-o.x,y:e.y-o.y,width:e.width,height:e.height}}return Qd(r)}function n_(t,e){const n=ki(t);return n===e||!yr(n)||zs(n)?!1:xr(n).position==="fixed"||n_(n,e)}function J3(t,e){const n=e.get(t);if(n)return n;let r=hc(t,[],!1).filter(s=>yr(s)&&au(s)!=="body"),o=null;const i=xr(t).position==="fixed";let a=i?ki(t):t;for(;yr(a)&&!zs(a);){const s=xr(a),u=ly(a);!u&&s.position==="fixed"&&(o=null),(i?!u&&!o:!u&&s.position==="static"&&!!o&&Y3.has(o.position)||jc(a)&&!u&&n_(t,a))?r=r.filter(l=>l!==a):o=s,a=ki(a)}return e.set(t,r),r}function Z3(t){let{element:e,boundary:n,rootBoundary:r,strategy:o}=t;const a=[...n==="clippingAncestors"?ih(e)?[]:J3(e,this._c):[].concat(n),r],s=a[0],u=a.reduce((c,l)=>{const d=Dx(e,l,o);return c.top=_n(d.top,c.top),c.right=Si(d.right,c.right),c.bottom=Si(d.bottom,c.bottom),c.left=_n(d.left,c.left),c},Dx(e,s,o));return{width:u.right-u.left,height:u.bottom-u.top,x:u.left,y:u.top}}function eO(t){const{width:e,height:n}=ZC(t);return{width:e,height:n}}function tO(t,e,n){const r=Gr(e),o=qr(e),i=n==="fixed",a=pa(t,!0,i,e);let s={scrollLeft:0,scrollTop:0};const u=Ur(0);function c(){u.x=hy(o)}if(r||!r&&!i)if((au(e)!=="body"||jc(o))&&(s=ah(e)),r){const h=pa(e,!0,i,e);u.x=h.x+e.clientLeft,u.y=h.y+e.clientTop}else o&&c();i&&!r&&o&&c();const l=o&&!r&&!i?t_(o,s):Ur(0),d=a.left+s.scrollLeft-u.x-l.x,f=a.top+s.scrollTop-u.y-l.y;return{x:d,y:f,width:a.width,height:a.height}}function yp(t){return xr(t).position==="static"}function Mx(t,e){if(!Gr(t)||xr(t).position==="fixed")return null;if(e)return e(t);let n=t.offsetParent;return qr(t)===n&&(n=n.ownerDocument.body),n}function r_(t,e){const n=Pn(t);if(ih(t))return n;if(!Gr(t)){let o=ki(t);for(;o&&!zs(o);){if(yr(o)&&!yp(o))return o;o=ki(o)}return n}let r=Mx(t,e);for(;r&&L3(r)&&yp(r);)r=Mx(r,e);return r&&zs(r)&&yp(r)&&!ly(r)?n:r||$3(t)||n}const nO=async function(t){const e=this.getOffsetParent||r_,n=this.getDimensions,r=await n(t.floating);return{reference:tO(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function rO(t){return xr(t).direction==="rtl"}const oO={convertOffsetParentRelativeRectToViewportRelativeRect:G3,getDocumentElement:qr,getClippingRect:Z3,getOffsetParent:r_,getElementRects:nO,getClientRects:K3,getDimensions:eO,getScale:fs,isElement:yr,isRTL:rO};function o_(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height}function iO(t,e){let n=null,r;const o=qr(t);function i(){var s;clearTimeout(r),(s=n)==null||s.disconnect(),n=null}function a(s,u){s===void 0&&(s=!1),u===void 0&&(u=1),i();const c=t.getBoundingClientRect(),{left:l,top:d,width:f,height:h}=c;if(s||e(),!f||!h)return;const m=Al(d),p=Al(o.clientWidth-(l+f)),g=Al(o.clientHeight-(d+h)),v=Al(l),x={rootMargin:-m+"px "+-p+"px "+-g+"px "+-v+"px",threshold:_n(0,Si(1,u))||1};let w=!0;function E(_){const S=_[0].intersectionRatio;if(S!==u){if(!w)return a();S?a(!1,S):r=setTimeout(()=>{a(!1,1e-7)},1e3)}S===1&&!o_(c,t.getBoundingClientRect())&&a(),w=!1}try{n=new IntersectionObserver(E,{...x,root:o.ownerDocument})}catch{n=new IntersectionObserver(E,x)}n.observe(t)}return a(!0),i}function aO(t,e,n,r){r===void 0&&(r={});const{ancestorScroll:o=!0,ancestorResize:i=!0,elementResize:a=typeof ResizeObserver=="function",layoutShift:s=typeof IntersectionObserver=="function",animationFrame:u=!1}=r,c=fy(t),l=o||i?[...c?hc(c):[],...hc(e)]:[];l.forEach(v=>{o&&v.addEventListener("scroll",n,{passive:!0}),i&&v.addEventListener("resize",n)});const d=c&&s?iO(c,n):null;let f=-1,h=null;a&&(h=new ResizeObserver(v=>{let[y]=v;y&&y.target===c&&h&&(h.unobserve(e),cancelAnimationFrame(f),f=requestAnimationFrame(()=>{var x;(x=h)==null||x.observe(e)})),n()}),c&&!u&&h.observe(c),h.observe(e));let m,p=u?pa(t):null;u&&g();function g(){const v=pa(t);p&&!o_(p,v)&&n(),p=v,m=requestAnimationFrame(g)}return n(),()=>{var v;l.forEach(y=>{o&&y.removeEventListener("scroll",n),i&&y.removeEventListener("resize",n)}),d==null||d(),(v=h)==null||v.disconnect(),h=null,u&&cancelAnimationFrame(m)}}const sO=A3,uO=P3,cO=R3,lO=M3,dO=T3,Ox=I3,fO=D3,hO=(t,e,n)=>{const r=new Map,o={platform:oO,...n},i={...o.platform,_c:r};return k3(t,e,{...o,platform:i})};var pO=typeof document<"u",mO=function(){},pd=pO?C.useLayoutEffect:mO;function Jd(t,e){if(t===e)return!0;if(typeof t!=typeof e)return!1;if(typeof t=="function"&&t.toString()===e.toString())return!0;let n,r,o;if(t&&e&&typeof t=="object"){if(Array.isArray(t)){if(n=t.length,n!==e.length)return!1;for(r=n;r--!==0;)if(!Jd(t[r],e[r]))return!1;return!0}if(o=Object.keys(t),n=o.length,n!==Object.keys(e).length)return!1;for(r=n;r--!==0;)if(!{}.hasOwnProperty.call(e,o[r]))return!1;for(r=n;r--!==0;){const i=o[r];if(!(i==="_owner"&&t.$$typeof)&&!Jd(t[i],e[i]))return!1}return!0}return t!==t&&e!==e}function i_(t){return typeof window>"u"?1:(t.ownerDocument.defaultView||window).devicePixelRatio||1}function Fx(t,e){const n=i_(t);return Math.round(e*n)/n}function xp(t){const e=C.useRef(t);return pd(()=>{e.current=t}),e}function vO(t){t===void 0&&(t={});const{placement:e="bottom",strategy:n="absolute",middleware:r=[],platform:o,elements:{reference:i,floating:a}={},transform:s=!0,whileElementsMounted:u,open:c}=t,[l,d]=C.useState({x:0,y:0,strategy:n,placement:e,middlewareData:{},isPositioned:!1}),[f,h]=C.useState(r);Jd(f,r)||h(r);const[m,p]=C.useState(null),[g,v]=C.useState(null),y=C.useCallback(M=>{M!==_.current&&(_.current=M,p(M))},[]),x=C.useCallback(M=>{M!==S.current&&(S.current=M,v(M))},[]),w=i||m,E=a||g,_=C.useRef(null),S=C.useRef(null),k=C.useRef(l),I=u!=null,R=xp(u),D=xp(o),A=xp(c),j=C.useCallback(()=>{if(!_.current||!S.current)return;const M={placement:e,strategy:n,middleware:f};D.current&&(M.platform=D.current),hO(_.current,S.current,M).then(P=>{const B={...P,isPositioned:A.current!==!1};F.current&&!Jd(k.current,B)&&(k.current=B,Lc.flushSync(()=>{d(B)}))})},[f,e,n,D,A]);pd(()=>{c===!1&&k.current.isPositioned&&(k.current.isPositioned=!1,d(M=>({...M,isPositioned:!1})))},[c]);const F=C.useRef(!1);pd(()=>(F.current=!0,()=>{F.current=!1}),[]),pd(()=>{if(w&&(_.current=w),E&&(S.current=E),w&&E){if(R.current)return R.current(w,E,j);j()}},[w,E,j,R,I]);const W=C.useMemo(()=>({reference:_,floating:S,setReference:y,setFloating:x}),[y,x]),U=C.useMemo(()=>({reference:w,floating:E}),[w,E]),$=C.useMemo(()=>{const M={position:n,left:0,top:0};if(!U.floating)return M;const P=Fx(U.floating,l.x),B=Fx(U.floating,l.y);return s?{...M,transform:"translate("+P+"px, "+B+"px)",...i_(U.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:P,top:B}},[n,s,U.floating,l.x,l.y]);return C.useMemo(()=>({...l,update:j,refs:W,elements:U,floatingStyles:$}),[l,j,W,U,$])}const gO=t=>{function e(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:t,fn(n){const{element:r,padding:o}=typeof t=="function"?t(n):t;return r&&e(r)?r.current!=null?Ox({element:r.current,padding:o}).fn(n):{}:r?Ox({element:r,padding:o}).fn(n):{}}}},yO=(t,e)=>({...sO(t),options:[t,e]}),xO=(t,e)=>({...uO(t),options:[t,e]}),wO=(t,e)=>({...fO(t),options:[t,e]}),bO=(t,e)=>({...cO(t),options:[t,e]}),EO=(t,e)=>({...lO(t),options:[t,e]}),CO=(t,e)=>({...dO(t),options:[t,e]}),_O=(t,e)=>({...gO(t),options:[t,e]});var SO="Arrow",a_=C.forwardRef((t,e)=>{const{children:n,width:r=10,height:o=5,...i}=t;return b.jsx(je.svg,{...i,ref:e,width:r,height:o,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:t.asChild?n:b.jsx("polygon",{points:"0,0 30,0 15,10"})})});a_.displayName=SO;var kO=a_;function IO(t){const[e,n]=C.useState(void 0);return Xn(()=>{if(t){n({width:t.offsetWidth,height:t.offsetHeight});const r=new ResizeObserver(o=>{if(!Array.isArray(o)||!o.length)return;const i=o[0];let a,s;if("borderBoxSize"in i){const u=i.borderBoxSize,c=Array.isArray(u)?u[0]:u;a=c.inlineSize,s=c.blockSize}else a=t.offsetWidth,s=t.offsetHeight;n({width:a,height:s})});return r.observe(t,{box:"border-box"}),()=>r.unobserve(t)}else n(void 0)},[t]),e}var py="Popper",[s_,sh]=So(py),[RO,u_]=s_(py),c_=t=>{const{__scopePopper:e,children:n}=t,[r,o]=C.useState(null);return b.jsx(RO,{scope:e,anchor:r,onAnchorChange:o,children:n})};c_.displayName=py;var l_="PopperAnchor",d_=C.forwardRef((t,e)=>{const{__scopePopper:n,virtualRef:r,...o}=t,i=u_(l_,n),a=C.useRef(null),s=At(e,a);return C.useEffect(()=>{i.onAnchorChange((r==null?void 0:r.current)||a.current)}),r?null:b.jsx(je.div,{...o,ref:s})});d_.displayName=l_;var my="PopperContent",[TO,NO]=s_(my),f_=C.forwardRef((t,e)=>{var Z,se,re,xe,pe,be;const{__scopePopper:n,side:r="bottom",sideOffset:o=0,align:i="center",alignOffset:a=0,arrowPadding:s=0,avoidCollisions:u=!0,collisionBoundary:c=[],collisionPadding:l=0,sticky:d="partial",hideWhenDetached:f=!1,updatePositionStrategy:h="optimized",onPlaced:m,...p}=t,g=u_(my,n),[v,y]=C.useState(null),x=At(e,ve=>y(ve)),[w,E]=C.useState(null),_=IO(w),S=(_==null?void 0:_.width)??0,k=(_==null?void 0:_.height)??0,I=r+(i!=="center"?"-"+i:""),R=typeof l=="number"?l:{top:0,right:0,bottom:0,left:0,...l},D=Array.isArray(c)?c:[c],A=D.length>0,j={padding:R,boundary:D.filter(PO),altBoundary:A},{refs:F,floatingStyles:W,placement:U,isPositioned:$,middlewareData:M}=vO({strategy:"fixed",placement:I,whileElementsMounted:(...ve)=>aO(...ve,{animationFrame:h==="always"}),elements:{reference:g.anchor},middleware:[yO({mainAxis:o+k,alignmentAxis:a}),u&&xO({mainAxis:!0,crossAxis:!1,limiter:d==="partial"?wO():void 0,...j}),u&&bO({...j}),EO({...j,apply:({elements:ve,rects:Pe,availableWidth:Ue,availableHeight:Le})=>{const{width:St,height:ht}=Pe.reference,ct=ve.floating.style;ct.setProperty("--radix-popper-available-width",`${Ue}px`),ct.setProperty("--radix-popper-available-height",`${Le}px`),ct.setProperty("--radix-popper-anchor-width",`${St}px`),ct.setProperty("--radix-popper-anchor-height",`${ht}px`)}}),w&&_O({element:w,padding:s}),DO({arrowWidth:S,arrowHeight:k}),f&&CO({strategy:"referenceHidden",...j})]}),[P,B]=m_(U),G=yn(m);Xn(()=>{$&&(G==null||G())},[$,G]);const q=(Z=M.arrow)==null?void 0:Z.x,J=(se=M.arrow)==null?void 0:se.y,H=((re=M.arrow)==null?void 0:re.centerOffset)!==0,[Q,ne]=C.useState();return Xn(()=>{v&&ne(window.getComputedStyle(v).zIndex)},[v]),b.jsx("div",{ref:F.setFloating,"data-radix-popper-content-wrapper":"",style:{...W,transform:$?W.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:Q,"--radix-popper-transform-origin":[(xe=M.transformOrigin)==null?void 0:xe.x,(pe=M.transformOrigin)==null?void 0:pe.y].join(" "),...((be=M.hide)==null?void 0:be.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:t.dir,children:b.jsx(TO,{scope:n,placedSide:P,onArrowChange:E,arrowX:q,arrowY:J,shouldHideArrow:H,children:b.jsx(je.div,{"data-side":P,"data-align":B,...p,ref:x,style:{...p.style,animation:$?void 0:"none"}})})})});f_.displayName=my;var h_="PopperArrow",AO={top:"bottom",right:"left",bottom:"top",left:"right"},p_=C.forwardRef(function(e,n){const{__scopePopper:r,...o}=e,i=NO(h_,r),a=AO[i.placedSide];return b.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[a]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:b.jsx(kO,{...o,ref:n,style:{...o.style,display:"block"}})})});p_.displayName=h_;function PO(t){return t!==null}var DO=t=>({name:"transformOrigin",options:t,fn(e){var g,v,y;const{placement:n,rects:r,middlewareData:o}=e,a=((g=o.arrow)==null?void 0:g.centerOffset)!==0,s=a?0:t.arrowWidth,u=a?0:t.arrowHeight,[c,l]=m_(n),d={start:"0%",center:"50%",end:"100%"}[l],f=(((v=o.arrow)==null?void 0:v.x)??0)+s/2,h=(((y=o.arrow)==null?void 0:y.y)??0)+u/2;let m="",p="";return c==="bottom"?(m=a?d:`${f}px`,p=`${-u}px`):c==="top"?(m=a?d:`${f}px`,p=`${r.floating.height+u}px`):c==="right"?(m=`${-u}px`,p=a?d:`${h}px`):c==="left"&&(m=`${r.floating.width+u}px`,p=a?d:`${h}px`),{data:{x:m,y:p}}}});function m_(t){const[e,n="center"]=t.split("-");return[e,n]}var MO=c_,v_=d_,g_=f_,y_=p_,[uh,RK]=So("Tooltip",[sh]),vy=sh(),x_="TooltipProvider",OO=700,Lx="tooltip.open",[FO,w_]=uh(x_),b_=t=>{const{__scopeTooltip:e,delayDuration:n=OO,skipDelayDuration:r=300,disableHoverableContent:o=!1,children:i}=t,a=C.useRef(!0),s=C.useRef(!1),u=C.useRef(0);return C.useEffect(()=>{const c=u.current;return()=>window.clearTimeout(c)},[]),b.jsx(FO,{scope:e,isOpenDelayedRef:a,delayDuration:n,onOpen:C.useCallback(()=>{window.clearTimeout(u.current),a.current=!1},[]),onClose:C.useCallback(()=>{window.clearTimeout(u.current),u.current=window.setTimeout(()=>a.current=!0,r)},[r]),isPointerInTransitRef:s,onPointerInTransitChange:C.useCallback(c=>{s.current=c},[]),disableHoverableContent:o,children:i})};b_.displayName=x_;var E_="Tooltip",[TK,ch]=uh(E_),hv="TooltipTrigger",LO=C.forwardRef((t,e)=>{const{__scopeTooltip:n,...r}=t,o=ch(hv,n),i=w_(hv,n),a=vy(n),s=C.useRef(null),u=At(e,s,o.onTriggerChange),c=C.useRef(!1),l=C.useRef(!1),d=C.useCallback(()=>c.current=!1,[]);return C.useEffect(()=>()=>document.removeEventListener("pointerup",d),[d]),b.jsx(v_,{asChild:!0,...a,children:b.jsx(je.button,{"aria-describedby":o.open?o.contentId:void 0,"data-state":o.stateAttribute,...r,ref:u,onPointerMove:me(t.onPointerMove,f=>{f.pointerType!=="touch"&&!l.current&&!i.isPointerInTransitRef.current&&(o.onTriggerEnter(),l.current=!0)}),onPointerLeave:me(t.onPointerLeave,()=>{o.onTriggerLeave(),l.current=!1}),onPointerDown:me(t.onPointerDown,()=>{o.open&&o.onClose(),c.current=!0,document.addEventListener("pointerup",d,{once:!0})}),onFocus:me(t.onFocus,()=>{c.current||o.onOpen()}),onBlur:me(t.onBlur,o.onClose),onClick:me(t.onClick,o.onClose)})})});LO.displayName=hv;var BO="TooltipPortal",[NK,jO]=uh(BO,{forceMount:void 0}),Vs="TooltipContent",C_=C.forwardRef((t,e)=>{const n=jO(Vs,t.__scopeTooltip),{forceMount:r=n.forceMount,side:o="top",...i}=t,a=ch(Vs,t.__scopeTooltip);return b.jsx(Pi,{present:r||a.open,children:a.disableHoverableContent?b.jsx(__,{side:o,...i,ref:e}):b.jsx(UO,{side:o,...i,ref:e})})}),UO=C.forwardRef((t,e)=>{const n=ch(Vs,t.__scopeTooltip),r=w_(Vs,t.__scopeTooltip),o=C.useRef(null),i=At(e,o),[a,s]=C.useState(null),{trigger:u,onClose:c}=n,l=o.current,{onPointerInTransitChange:d}=r,f=C.useCallback(()=>{s(null),d(!1)},[d]),h=C.useCallback((m,p)=>{const g=m.currentTarget,v={x:m.clientX,y:m.clientY},y=HO(v,g.getBoundingClientRect()),x=GO(v,y),w=KO(p.getBoundingClientRect()),E=XO([...x,...w]);s(E),d(!0)},[d]);return C.useEffect(()=>()=>f(),[f]),C.useEffect(()=>{if(u&&l){const m=g=>h(g,l),p=g=>h(g,u);return u.addEventListener("pointerleave",m),l.addEventListener("pointerleave",p),()=>{u.removeEventListener("pointerleave",m),l.removeEventListener("pointerleave",p)}}},[u,l,h,f]),C.useEffect(()=>{if(a){const m=p=>{const g=p.target,v={x:p.clientX,y:p.clientY},y=(u==null?void 0:u.contains(g))||(l==null?void 0:l.contains(g)),x=!qO(v,a);y?f():x&&(f(),c())};return document.addEventListener("pointermove",m),()=>document.removeEventListener("pointermove",m)}},[u,l,a,c,f]),b.jsx(__,{...t,ref:i})}),[WO,$O]=uh(E_,{isInside:!1}),zO=$P("TooltipContent"),__=C.forwardRef((t,e)=>{const{__scopeTooltip:n,children:r,"aria-label":o,onEscapeKeyDown:i,onPointerDownOutside:a,...s}=t,u=ch(Vs,n),c=vy(n),{onClose:l}=u;return C.useEffect(()=>(document.addEventListener(Lx,l),()=>document.removeEventListener(Lx,l)),[l]),C.useEffect(()=>{if(u.trigger){const d=f=>{const h=f.target;h!=null&&h.contains(u.trigger)&&l()};return window.addEventListener("scroll",d,{capture:!0}),()=>window.removeEventListener("scroll",d,{capture:!0})}},[u.trigger,l]),b.jsx(Jf,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:i,onPointerDownOutside:a,onFocusOutside:d=>d.preventDefault(),onDismiss:l,children:b.jsxs(g_,{"data-state":u.stateAttribute,...c,...s,ref:e,style:{...s.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[b.jsx(zO,{children:r}),b.jsx(WO,{scope:n,isInside:!0,children:b.jsx(dD,{id:u.contentId,role:"tooltip",children:o||r})})]})})});C_.displayName=Vs;var S_="TooltipArrow",VO=C.forwardRef((t,e)=>{const{__scopeTooltip:n,...r}=t,o=vy(n);return $O(S_,n).isInside?null:b.jsx(y_,{...o,...r,ref:e})});VO.displayName=S_;function HO(t,e){const n=Math.abs(e.top-t.y),r=Math.abs(e.bottom-t.y),o=Math.abs(e.right-t.x),i=Math.abs(e.left-t.x);switch(Math.min(n,r,o,i)){case i:return"left";case o:return"right";case n:return"top";case r:return"bottom";default:throw new Error("unreachable")}}function GO(t,e,n=5){const r=[];switch(e){case"top":r.push({x:t.x-n,y:t.y+n},{x:t.x+n,y:t.y+n});break;case"bottom":r.push({x:t.x-n,y:t.y-n},{x:t.x+n,y:t.y-n});break;case"left":r.push({x:t.x+n,y:t.y-n},{x:t.x+n,y:t.y+n});break;case"right":r.push({x:t.x-n,y:t.y-n},{x:t.x-n,y:t.y+n});break}return r}function KO(t){const{top:e,right:n,bottom:r,left:o}=t;return[{x:o,y:e},{x:n,y:e},{x:n,y:r},{x:o,y:r}]}function qO(t,e){const{x:n,y:r}=t;let o=!1;for(let i=0,a=e.length-1;i<e.length;a=i++){const s=e[i],u=e[a],c=s.x,l=s.y,d=u.x,f=u.y;l>r!=f>r&&n<(d-c)*(r-l)/(f-l)+c&&(o=!o)}return o}function XO(t){const e=t.slice();return e.sort((n,r)=>n.x<r.x?-1:n.x>r.x?1:n.y<r.y?-1:n.y>r.y?1:0),YO(e)}function YO(t){if(t.length<=1)return t.slice();const e=[];for(let r=0;r<t.length;r++){const o=t[r];for(;e.length>=2;){const i=e[e.length-1],a=e[e.length-2];if((i.x-a.x)*(o.y-a.y)>=(i.y-a.y)*(o.x-a.x))e.pop();else break}e.push(o)}e.pop();const n=[];for(let r=t.length-1;r>=0;r--){const o=t[r];for(;n.length>=2;){const i=n[n.length-1],a=n[n.length-2];if((i.x-a.x)*(o.y-a.y)>=(i.y-a.y)*(o.x-a.x))n.pop();else break}n.push(o)}return n.pop(),e.length===1&&n.length===1&&e[0].x===n[0].x&&e[0].y===n[0].y?e:e.concat(n)}var QO=b_,k_=C_;const JO=QO,ZO=C.forwardRef(({className:t,sideOffset:e=4,...n},r)=>b.jsx(k_,{ref:r,sideOffset:e,className:we("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...n}));ZO.displayName=k_.displayName;var lh=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(t){return this.listeners.add(t),this.onSubscribe(),()=>{this.listeners.delete(t),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},dh=typeof window>"u"||"Deno"in globalThis;function ir(){}function e4(t,e){return typeof t=="function"?t(e):t}function t4(t){return typeof t=="number"&&t>=0&&t!==1/0}function n4(t,e){return Math.max(t+(e||0)-Date.now(),0)}function pv(t,e){return typeof t=="function"?t(e):t}function r4(t,e){return typeof t=="function"?t(e):t}function Bx(t,e){const{type:n="all",exact:r,fetchStatus:o,predicate:i,queryKey:a,stale:s}=t;if(a){if(r){if(e.queryHash!==gy(a,e.options))return!1}else if(!mc(e.queryKey,a))return!1}if(n!=="all"){const u=e.isActive();if(n==="active"&&!u||n==="inactive"&&u)return!1}return!(typeof s=="boolean"&&e.isStale()!==s||o&&o!==e.state.fetchStatus||i&&!i(e))}function jx(t,e){const{exact:n,status:r,predicate:o,mutationKey:i}=t;if(i){if(!e.options.mutationKey)return!1;if(n){if(pc(e.options.mutationKey)!==pc(i))return!1}else if(!mc(e.options.mutationKey,i))return!1}return!(r&&e.state.status!==r||o&&!o(e))}function gy(t,e){return((e==null?void 0:e.queryKeyHashFn)||pc)(t)}function pc(t){return JSON.stringify(t,(e,n)=>mv(n)?Object.keys(n).sort().reduce((r,o)=>(r[o]=n[o],r),{}):n)}function mc(t,e){return t===e?!0:typeof t!=typeof e?!1:t&&e&&typeof t=="object"&&typeof e=="object"?Object.keys(e).every(n=>mc(t[n],e[n])):!1}function I_(t,e){if(t===e)return t;const n=Ux(t)&&Ux(e);if(n||mv(t)&&mv(e)){const r=n?t:Object.keys(t),o=r.length,i=n?e:Object.keys(e),a=i.length,s=n?[]:{},u=new Set(r);let c=0;for(let l=0;l<a;l++){const d=n?l:i[l];(!n&&u.has(d)||n)&&t[d]===void 0&&e[d]===void 0?(s[d]=void 0,c++):(s[d]=I_(t[d],e[d]),s[d]===t[d]&&t[d]!==void 0&&c++)}return o===a&&c===o?t:s}return e}function Ux(t){return Array.isArray(t)&&t.length===Object.keys(t).length}function mv(t){if(!Wx(t))return!1;const e=t.constructor;if(e===void 0)return!0;const n=e.prototype;return!(!Wx(n)||!n.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(t)!==Object.prototype)}function Wx(t){return Object.prototype.toString.call(t)==="[object Object]"}function o4(t){return new Promise(e=>{setTimeout(e,t)})}function i4(t,e,n){return typeof n.structuralSharing=="function"?n.structuralSharing(t,e):n.structuralSharing!==!1?I_(t,e):e}function a4(t,e,n=0){const r=[...t,e];return n&&r.length>n?r.slice(1):r}function s4(t,e,n=0){const r=[e,...t];return n&&r.length>n?r.slice(0,-1):r}var yy=Symbol();function R_(t,e){return!t.queryFn&&(e!=null&&e.initialPromise)?()=>e.initialPromise:!t.queryFn||t.queryFn===yy?()=>Promise.reject(new Error(`Missing queryFn: '${t.queryHash}'`)):t.queryFn}var ea,Zo,ks,$b,u4=($b=class extends lh{constructor(){super();Fe(this,ea);Fe(this,Zo);Fe(this,ks);Se(this,ks,e=>{if(!dh&&window.addEventListener){const n=()=>e();return window.addEventListener("visibilitychange",n,!1),()=>{window.removeEventListener("visibilitychange",n)}}})}onSubscribe(){X(this,Zo)||this.setEventListener(X(this,ks))}onUnsubscribe(){var e;this.hasListeners()||((e=X(this,Zo))==null||e.call(this),Se(this,Zo,void 0))}setEventListener(e){var n;Se(this,ks,e),(n=X(this,Zo))==null||n.call(this),Se(this,Zo,e(r=>{typeof r=="boolean"?this.setFocused(r):this.onFocus()}))}setFocused(e){X(this,ea)!==e&&(Se(this,ea,e),this.onFocus())}onFocus(){const e=this.isFocused();this.listeners.forEach(n=>{n(e)})}isFocused(){var e;return typeof X(this,ea)=="boolean"?X(this,ea):((e=globalThis.document)==null?void 0:e.visibilityState)!=="hidden"}},ea=new WeakMap,Zo=new WeakMap,ks=new WeakMap,$b),T_=new u4,Is,ei,Rs,zb,c4=(zb=class extends lh{constructor(){super();Fe(this,Is,!0);Fe(this,ei);Fe(this,Rs);Se(this,Rs,e=>{if(!dh&&window.addEventListener){const n=()=>e(!0),r=()=>e(!1);return window.addEventListener("online",n,!1),window.addEventListener("offline",r,!1),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",r)}}})}onSubscribe(){X(this,ei)||this.setEventListener(X(this,Rs))}onUnsubscribe(){var e;this.hasListeners()||((e=X(this,ei))==null||e.call(this),Se(this,ei,void 0))}setEventListener(e){var n;Se(this,Rs,e),(n=X(this,ei))==null||n.call(this),Se(this,ei,e(this.setOnline.bind(this)))}setOnline(e){X(this,Is)!==e&&(Se(this,Is,e),this.listeners.forEach(r=>{r(e)}))}isOnline(){return X(this,Is)}},Is=new WeakMap,ei=new WeakMap,Rs=new WeakMap,zb),Zd=new c4;function l4(){let t,e;const n=new Promise((o,i)=>{t=o,e=i});n.status="pending",n.catch(()=>{});function r(o){Object.assign(n,o),delete n.resolve,delete n.reject}return n.resolve=o=>{r({status:"fulfilled",value:o}),t(o)},n.reject=o=>{r({status:"rejected",reason:o}),e(o)},n}function d4(t){return Math.min(1e3*2**t,3e4)}function N_(t){return(t??"online")==="online"?Zd.isOnline():!0}var A_=class extends Error{constructor(t){super("CancelledError"),this.revert=t==null?void 0:t.revert,this.silent=t==null?void 0:t.silent}};function wp(t){return t instanceof A_}function P_(t){let e=!1,n=0,r=!1,o;const i=l4(),a=p=>{var g;r||(f(new A_(p)),(g=t.abort)==null||g.call(t))},s=()=>{e=!0},u=()=>{e=!1},c=()=>T_.isFocused()&&(t.networkMode==="always"||Zd.isOnline())&&t.canRun(),l=()=>N_(t.networkMode)&&t.canRun(),d=p=>{var g;r||(r=!0,(g=t.onSuccess)==null||g.call(t,p),o==null||o(),i.resolve(p))},f=p=>{var g;r||(r=!0,(g=t.onError)==null||g.call(t,p),o==null||o(),i.reject(p))},h=()=>new Promise(p=>{var g;o=v=>{(r||c())&&p(v)},(g=t.onPause)==null||g.call(t)}).then(()=>{var p;o=void 0,r||(p=t.onContinue)==null||p.call(t)}),m=()=>{if(r)return;let p;const g=n===0?t.initialPromise:void 0;try{p=g??t.fn()}catch(v){p=Promise.reject(v)}Promise.resolve(p).then(d).catch(v=>{var _;if(r)return;const y=t.retry??(dh?0:3),x=t.retryDelay??d4,w=typeof x=="function"?x(n,v):x,E=y===!0||typeof y=="number"&&n<y||typeof y=="function"&&y(n,v);if(e||!E){f(v);return}n++,(_=t.onFail)==null||_.call(t,n,v),o4(w).then(()=>c()?void 0:h()).then(()=>{e?f(v):m()})})};return{promise:i,cancel:a,continue:()=>(o==null||o(),i),cancelRetry:s,continueRetry:u,canStart:l,start:()=>(l()?m():h().then(m),i)}}var f4=t=>setTimeout(t,0);function h4(){let t=[],e=0,n=s=>{s()},r=s=>{s()},o=f4;const i=s=>{e?t.push(s):o(()=>{n(s)})},a=()=>{const s=t;t=[],s.length&&o(()=>{r(()=>{s.forEach(u=>{n(u)})})})};return{batch:s=>{let u;e++;try{u=s()}finally{e--,e||a()}return u},batchCalls:s=>(...u)=>{i(()=>{s(...u)})},schedule:i,setNotifyFunction:s=>{n=s},setBatchNotifyFunction:s=>{r=s},setScheduler:s=>{o=s}}}var tn=h4(),ta,Vb,D_=(Vb=class{constructor(){Fe(this,ta)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),t4(this.gcTime)&&Se(this,ta,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(t){this.gcTime=Math.max(this.gcTime||0,t??(dh?1/0:5*60*1e3))}clearGcTimeout(){X(this,ta)&&(clearTimeout(X(this,ta)),Se(this,ta,void 0))}},ta=new WeakMap,Vb),Ts,na,Bn,ra,Vt,Nc,oa,ar,no,Hb,p4=(Hb=class extends D_{constructor(e){super();Fe(this,ar);Fe(this,Ts);Fe(this,na);Fe(this,Bn);Fe(this,ra);Fe(this,Vt);Fe(this,Nc);Fe(this,oa);Se(this,oa,!1),Se(this,Nc,e.defaultOptions),this.setOptions(e.options),this.observers=[],Se(this,ra,e.client),Se(this,Bn,X(this,ra).getQueryCache()),this.queryKey=e.queryKey,this.queryHash=e.queryHash,Se(this,Ts,v4(this.options)),this.state=e.state??X(this,Ts),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var e;return(e=X(this,Vt))==null?void 0:e.promise}setOptions(e){this.options={...X(this,Nc),...e},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&X(this,Bn).remove(this)}setData(e,n){const r=i4(this.state.data,e,this.options);return Wt(this,ar,no).call(this,{data:r,type:"success",dataUpdatedAt:n==null?void 0:n.updatedAt,manual:n==null?void 0:n.manual}),r}setState(e,n){Wt(this,ar,no).call(this,{type:"setState",state:e,setStateOptions:n})}cancel(e){var r,o;const n=(r=X(this,Vt))==null?void 0:r.promise;return(o=X(this,Vt))==null||o.cancel(e),n?n.then(ir).catch(ir):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(X(this,Ts))}isActive(){return this.observers.some(e=>r4(e.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===yy||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(e=>pv(e.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(e=>e.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(e=0){return this.state.data===void 0?!0:e==="static"?!1:this.state.isInvalidated?!0:!n4(this.state.dataUpdatedAt,e)}onFocus(){var n;const e=this.observers.find(r=>r.shouldFetchOnWindowFocus());e==null||e.refetch({cancelRefetch:!1}),(n=X(this,Vt))==null||n.continue()}onOnline(){var n;const e=this.observers.find(r=>r.shouldFetchOnReconnect());e==null||e.refetch({cancelRefetch:!1}),(n=X(this,Vt))==null||n.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),X(this,Bn).notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter(n=>n!==e),this.observers.length||(X(this,Vt)&&(X(this,oa)?X(this,Vt).cancel({revert:!0}):X(this,Vt).cancelRetry()),this.scheduleGc()),X(this,Bn).notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||Wt(this,ar,no).call(this,{type:"invalidate"})}fetch(e,n){var c,l,d;if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&(n!=null&&n.cancelRefetch))this.cancel({silent:!0});else if(X(this,Vt))return X(this,Vt).continueRetry(),X(this,Vt).promise}if(e&&this.setOptions(e),!this.options.queryFn){const f=this.observers.find(h=>h.options.queryFn);f&&this.setOptions(f.options)}const r=new AbortController,o=f=>{Object.defineProperty(f,"signal",{enumerable:!0,get:()=>(Se(this,oa,!0),r.signal)})},i=()=>{const f=R_(this.options,n),m=(()=>{const p={client:X(this,ra),queryKey:this.queryKey,meta:this.meta};return o(p),p})();return Se(this,oa,!1),this.options.persister?this.options.persister(f,m,this):f(m)},s=(()=>{const f={fetchOptions:n,options:this.options,queryKey:this.queryKey,client:X(this,ra),state:this.state,fetchFn:i};return o(f),f})();(c=this.options.behavior)==null||c.onFetch(s,this),Se(this,na,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((l=s.fetchOptions)==null?void 0:l.meta))&&Wt(this,ar,no).call(this,{type:"fetch",meta:(d=s.fetchOptions)==null?void 0:d.meta});const u=f=>{var h,m,p,g;wp(f)&&f.silent||Wt(this,ar,no).call(this,{type:"error",error:f}),wp(f)||((m=(h=X(this,Bn).config).onError)==null||m.call(h,f,this),(g=(p=X(this,Bn).config).onSettled)==null||g.call(p,this.state.data,f,this)),this.scheduleGc()};return Se(this,Vt,P_({initialPromise:n==null?void 0:n.initialPromise,fn:s.fetchFn,abort:r.abort.bind(r),onSuccess:f=>{var h,m,p,g;if(f===void 0){u(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(f)}catch(v){u(v);return}(m=(h=X(this,Bn).config).onSuccess)==null||m.call(h,f,this),(g=(p=X(this,Bn).config).onSettled)==null||g.call(p,f,this.state.error,this),this.scheduleGc()},onError:u,onFail:(f,h)=>{Wt(this,ar,no).call(this,{type:"failed",failureCount:f,error:h})},onPause:()=>{Wt(this,ar,no).call(this,{type:"pause"})},onContinue:()=>{Wt(this,ar,no).call(this,{type:"continue"})},retry:s.options.retry,retryDelay:s.options.retryDelay,networkMode:s.options.networkMode,canRun:()=>!0})),X(this,Vt).start()}},Ts=new WeakMap,na=new WeakMap,Bn=new WeakMap,ra=new WeakMap,Vt=new WeakMap,Nc=new WeakMap,oa=new WeakMap,ar=new WeakSet,no=function(e){const n=r=>{switch(e.type){case"failed":return{...r,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...r,fetchStatus:"paused"};case"continue":return{...r,fetchStatus:"fetching"};case"fetch":return{...r,...m4(r.data,this.options),fetchMeta:e.meta??null};case"success":return Se(this,na,void 0),{...r,data:e.data,dataUpdateCount:r.dataUpdateCount+1,dataUpdatedAt:e.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const o=e.error;return wp(o)&&o.revert&&X(this,na)?{...X(this,na),fetchStatus:"idle"}:{...r,error:o,errorUpdateCount:r.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:r.fetchFailureCount+1,fetchFailureReason:o,fetchStatus:"idle",status:"error"};case"invalidate":return{...r,isInvalidated:!0};case"setState":return{...r,...e.state}}};this.state=n(this.state),tn.batch(()=>{this.observers.forEach(r=>{r.onQueryUpdate()}),X(this,Bn).notify({query:this,type:"updated",action:e})})},Hb);function m4(t,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:N_(e.networkMode)?"fetching":"paused",...t===void 0&&{error:null,status:"pending"}}}function v4(t){const e=typeof t.initialData=="function"?t.initialData():t.initialData,n=e!==void 0,r=n?typeof t.initialDataUpdatedAt=="function"?t.initialDataUpdatedAt():t.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:n?r??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}var Rr,Gb,g4=(Gb=class extends lh{constructor(e={}){super();Fe(this,Rr);this.config=e,Se(this,Rr,new Map)}build(e,n,r){const o=n.queryKey,i=n.queryHash??gy(o,n);let a=this.get(i);return a||(a=new p4({client:e,queryKey:o,queryHash:i,options:e.defaultQueryOptions(n),state:r,defaultOptions:e.getQueryDefaults(o)}),this.add(a)),a}add(e){X(this,Rr).has(e.queryHash)||(X(this,Rr).set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){const n=X(this,Rr).get(e.queryHash);n&&(e.destroy(),n===e&&X(this,Rr).delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){tn.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}get(e){return X(this,Rr).get(e)}getAll(){return[...X(this,Rr).values()]}find(e){const n={exact:!0,...e};return this.getAll().find(r=>Bx(n,r))}findAll(e={}){const n=this.getAll();return Object.keys(e).length>0?n.filter(r=>Bx(e,r)):n}notify(e){tn.batch(()=>{this.listeners.forEach(n=>{n(e)})})}onFocus(){tn.batch(()=>{this.getAll().forEach(e=>{e.onFocus()})})}onOnline(){tn.batch(()=>{this.getAll().forEach(e=>{e.onOnline()})})}},Rr=new WeakMap,Gb),Tr,Zt,ia,Nr,zo,Kb,y4=(Kb=class extends D_{constructor(e){super();Fe(this,Nr);Fe(this,Tr);Fe(this,Zt);Fe(this,ia);this.mutationId=e.mutationId,Se(this,Zt,e.mutationCache),Se(this,Tr,[]),this.state=e.state||x4(),this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){X(this,Tr).includes(e)||(X(this,Tr).push(e),this.clearGcTimeout(),X(this,Zt).notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){Se(this,Tr,X(this,Tr).filter(n=>n!==e)),this.scheduleGc(),X(this,Zt).notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){X(this,Tr).length||(this.state.status==="pending"?this.scheduleGc():X(this,Zt).remove(this))}continue(){var e;return((e=X(this,ia))==null?void 0:e.continue())??this.execute(this.state.variables)}async execute(e){var i,a,s,u,c,l,d,f,h,m,p,g,v,y,x,w,E,_,S,k;const n=()=>{Wt(this,Nr,zo).call(this,{type:"continue"})};Se(this,ia,P_({fn:()=>this.options.mutationFn?this.options.mutationFn(e):Promise.reject(new Error("No mutationFn found")),onFail:(I,R)=>{Wt(this,Nr,zo).call(this,{type:"failed",failureCount:I,error:R})},onPause:()=>{Wt(this,Nr,zo).call(this,{type:"pause"})},onContinue:n,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>X(this,Zt).canRun(this)}));const r=this.state.status==="pending",o=!X(this,ia).canStart();try{if(r)n();else{Wt(this,Nr,zo).call(this,{type:"pending",variables:e,isPaused:o}),await((a=(i=X(this,Zt).config).onMutate)==null?void 0:a.call(i,e,this));const R=await((u=(s=this.options).onMutate)==null?void 0:u.call(s,e));R!==this.state.context&&Wt(this,Nr,zo).call(this,{type:"pending",context:R,variables:e,isPaused:o})}const I=await X(this,ia).start();return await((l=(c=X(this,Zt).config).onSuccess)==null?void 0:l.call(c,I,e,this.state.context,this)),await((f=(d=this.options).onSuccess)==null?void 0:f.call(d,I,e,this.state.context)),await((m=(h=X(this,Zt).config).onSettled)==null?void 0:m.call(h,I,null,this.state.variables,this.state.context,this)),await((g=(p=this.options).onSettled)==null?void 0:g.call(p,I,null,e,this.state.context)),Wt(this,Nr,zo).call(this,{type:"success",data:I}),I}catch(I){try{throw await((y=(v=X(this,Zt).config).onError)==null?void 0:y.call(v,I,e,this.state.context,this)),await((w=(x=this.options).onError)==null?void 0:w.call(x,I,e,this.state.context)),await((_=(E=X(this,Zt).config).onSettled)==null?void 0:_.call(E,void 0,I,this.state.variables,this.state.context,this)),await((k=(S=this.options).onSettled)==null?void 0:k.call(S,void 0,I,e,this.state.context)),I}finally{Wt(this,Nr,zo).call(this,{type:"error",error:I})}}finally{X(this,Zt).runNext(this)}}},Tr=new WeakMap,Zt=new WeakMap,ia=new WeakMap,Nr=new WeakSet,zo=function(e){const n=r=>{switch(e.type){case"failed":return{...r,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...r,isPaused:!0};case"continue":return{...r,isPaused:!1};case"pending":return{...r,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...r,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...r,data:void 0,error:e.error,failureCount:r.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}};this.state=n(this.state),tn.batch(()=>{X(this,Tr).forEach(r=>{r.onMutationUpdate(e)}),X(this,Zt).notify({mutation:this,type:"updated",action:e})})},Kb);function x4(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var so,sr,Ac,qb,w4=(qb=class extends lh{constructor(e={}){super();Fe(this,so);Fe(this,sr);Fe(this,Ac);this.config=e,Se(this,so,new Set),Se(this,sr,new Map),Se(this,Ac,0)}build(e,n,r){const o=new y4({mutationCache:this,mutationId:++ll(this,Ac)._,options:e.defaultMutationOptions(n),state:r});return this.add(o),o}add(e){X(this,so).add(e);const n=Pl(e);if(typeof n=="string"){const r=X(this,sr).get(n);r?r.push(e):X(this,sr).set(n,[e])}this.notify({type:"added",mutation:e})}remove(e){if(X(this,so).delete(e)){const n=Pl(e);if(typeof n=="string"){const r=X(this,sr).get(n);if(r)if(r.length>1){const o=r.indexOf(e);o!==-1&&r.splice(o,1)}else r[0]===e&&X(this,sr).delete(n)}}this.notify({type:"removed",mutation:e})}canRun(e){const n=Pl(e);if(typeof n=="string"){const r=X(this,sr).get(n),o=r==null?void 0:r.find(i=>i.state.status==="pending");return!o||o===e}else return!0}runNext(e){var r;const n=Pl(e);if(typeof n=="string"){const o=(r=X(this,sr).get(n))==null?void 0:r.find(i=>i!==e&&i.state.isPaused);return(o==null?void 0:o.continue())??Promise.resolve()}else return Promise.resolve()}clear(){tn.batch(()=>{X(this,so).forEach(e=>{this.notify({type:"removed",mutation:e})}),X(this,so).clear(),X(this,sr).clear()})}getAll(){return Array.from(X(this,so))}find(e){const n={exact:!0,...e};return this.getAll().find(r=>jx(n,r))}findAll(e={}){return this.getAll().filter(n=>jx(e,n))}notify(e){tn.batch(()=>{this.listeners.forEach(n=>{n(e)})})}resumePausedMutations(){const e=this.getAll().filter(n=>n.state.isPaused);return tn.batch(()=>Promise.all(e.map(n=>n.continue().catch(ir))))}},so=new WeakMap,sr=new WeakMap,Ac=new WeakMap,qb);function Pl(t){var e;return(e=t.options.scope)==null?void 0:e.id}function $x(t){return{onFetch:(e,n)=>{var l,d,f,h,m;const r=e.options,o=(f=(d=(l=e.fetchOptions)==null?void 0:l.meta)==null?void 0:d.fetchMore)==null?void 0:f.direction,i=((h=e.state.data)==null?void 0:h.pages)||[],a=((m=e.state.data)==null?void 0:m.pageParams)||[];let s={pages:[],pageParams:[]},u=0;const c=async()=>{let p=!1;const g=x=>{Object.defineProperty(x,"signal",{enumerable:!0,get:()=>(e.signal.aborted?p=!0:e.signal.addEventListener("abort",()=>{p=!0}),e.signal)})},v=R_(e.options,e.fetchOptions),y=async(x,w,E)=>{if(p)return Promise.reject();if(w==null&&x.pages.length)return Promise.resolve(x);const S=(()=>{const D={client:e.client,queryKey:e.queryKey,pageParam:w,direction:E?"backward":"forward",meta:e.options.meta};return g(D),D})(),k=await v(S),{maxPages:I}=e.options,R=E?s4:a4;return{pages:R(x.pages,k,I),pageParams:R(x.pageParams,w,I)}};if(o&&i.length){const x=o==="backward",w=x?b4:zx,E={pages:i,pageParams:a},_=w(r,E);s=await y(E,_,x)}else{const x=t??i.length;do{const w=u===0?a[0]??r.initialPageParam:zx(r,s);if(u>0&&w==null)break;s=await y(s,w),u++}while(u<x)}return s};e.options.persister?e.fetchFn=()=>{var p,g;return(g=(p=e.options).persister)==null?void 0:g.call(p,c,{client:e.client,queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},n)}:e.fetchFn=c}}}function zx(t,{pages:e,pageParams:n}){const r=e.length-1;return e.length>0?t.getNextPageParam(e[r],e,n[r],n):void 0}function b4(t,{pages:e,pageParams:n}){var r;return e.length>0?(r=t.getPreviousPageParam)==null?void 0:r.call(t,e[0],e,n[0],n):void 0}var st,ti,ni,Ns,As,ri,Ps,Ds,Xb,E4=(Xb=class{constructor(t={}){Fe(this,st);Fe(this,ti);Fe(this,ni);Fe(this,Ns);Fe(this,As);Fe(this,ri);Fe(this,Ps);Fe(this,Ds);Se(this,st,t.queryCache||new g4),Se(this,ti,t.mutationCache||new w4),Se(this,ni,t.defaultOptions||{}),Se(this,Ns,new Map),Se(this,As,new Map),Se(this,ri,0)}mount(){ll(this,ri)._++,X(this,ri)===1&&(Se(this,Ps,T_.subscribe(async t=>{t&&(await this.resumePausedMutations(),X(this,st).onFocus())})),Se(this,Ds,Zd.subscribe(async t=>{t&&(await this.resumePausedMutations(),X(this,st).onOnline())})))}unmount(){var t,e;ll(this,ri)._--,X(this,ri)===0&&((t=X(this,Ps))==null||t.call(this),Se(this,Ps,void 0),(e=X(this,Ds))==null||e.call(this),Se(this,Ds,void 0))}isFetching(t){return X(this,st).findAll({...t,fetchStatus:"fetching"}).length}isMutating(t){return X(this,ti).findAll({...t,status:"pending"}).length}getQueryData(t){var n;const e=this.defaultQueryOptions({queryKey:t});return(n=X(this,st).get(e.queryHash))==null?void 0:n.state.data}ensureQueryData(t){const e=this.defaultQueryOptions(t),n=X(this,st).build(this,e),r=n.state.data;return r===void 0?this.fetchQuery(t):(t.revalidateIfStale&&n.isStaleByTime(pv(e.staleTime,n))&&this.prefetchQuery(e),Promise.resolve(r))}getQueriesData(t){return X(this,st).findAll(t).map(({queryKey:e,state:n})=>{const r=n.data;return[e,r]})}setQueryData(t,e,n){const r=this.defaultQueryOptions({queryKey:t}),o=X(this,st).get(r.queryHash),i=o==null?void 0:o.state.data,a=e4(e,i);if(a!==void 0)return X(this,st).build(this,r).setData(a,{...n,manual:!0})}setQueriesData(t,e,n){return tn.batch(()=>X(this,st).findAll(t).map(({queryKey:r})=>[r,this.setQueryData(r,e,n)]))}getQueryState(t){var n;const e=this.defaultQueryOptions({queryKey:t});return(n=X(this,st).get(e.queryHash))==null?void 0:n.state}removeQueries(t){const e=X(this,st);tn.batch(()=>{e.findAll(t).forEach(n=>{e.remove(n)})})}resetQueries(t,e){const n=X(this,st);return tn.batch(()=>(n.findAll(t).forEach(r=>{r.reset()}),this.refetchQueries({type:"active",...t},e)))}cancelQueries(t,e={}){const n={revert:!0,...e},r=tn.batch(()=>X(this,st).findAll(t).map(o=>o.cancel(n)));return Promise.all(r).then(ir).catch(ir)}invalidateQueries(t,e={}){return tn.batch(()=>(X(this,st).findAll(t).forEach(n=>{n.invalidate()}),(t==null?void 0:t.refetchType)==="none"?Promise.resolve():this.refetchQueries({...t,type:(t==null?void 0:t.refetchType)??(t==null?void 0:t.type)??"active"},e)))}refetchQueries(t,e={}){const n={...e,cancelRefetch:e.cancelRefetch??!0},r=tn.batch(()=>X(this,st).findAll(t).filter(o=>!o.isDisabled()&&!o.isStatic()).map(o=>{let i=o.fetch(void 0,n);return n.throwOnError||(i=i.catch(ir)),o.state.fetchStatus==="paused"?Promise.resolve():i}));return Promise.all(r).then(ir)}fetchQuery(t){const e=this.defaultQueryOptions(t);e.retry===void 0&&(e.retry=!1);const n=X(this,st).build(this,e);return n.isStaleByTime(pv(e.staleTime,n))?n.fetch(e):Promise.resolve(n.state.data)}prefetchQuery(t){return this.fetchQuery(t).then(ir).catch(ir)}fetchInfiniteQuery(t){return t.behavior=$x(t.pages),this.fetchQuery(t)}prefetchInfiniteQuery(t){return this.fetchInfiniteQuery(t).then(ir).catch(ir)}ensureInfiniteQueryData(t){return t.behavior=$x(t.pages),this.ensureQueryData(t)}resumePausedMutations(){return Zd.isOnline()?X(this,ti).resumePausedMutations():Promise.resolve()}getQueryCache(){return X(this,st)}getMutationCache(){return X(this,ti)}getDefaultOptions(){return X(this,ni)}setDefaultOptions(t){Se(this,ni,t)}setQueryDefaults(t,e){X(this,Ns).set(pc(t),{queryKey:t,defaultOptions:e})}getQueryDefaults(t){const e=[...X(this,Ns).values()],n={};return e.forEach(r=>{mc(t,r.queryKey)&&Object.assign(n,r.defaultOptions)}),n}setMutationDefaults(t,e){X(this,As).set(pc(t),{mutationKey:t,defaultOptions:e})}getMutationDefaults(t){const e=[...X(this,As).values()],n={};return e.forEach(r=>{mc(t,r.mutationKey)&&Object.assign(n,r.defaultOptions)}),n}defaultQueryOptions(t){if(t._defaulted)return t;const e={...X(this,ni).queries,...this.getQueryDefaults(t.queryKey),...t,_defaulted:!0};return e.queryHash||(e.queryHash=gy(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.queryFn===yy&&(e.enabled=!1),e}defaultMutationOptions(t){return t!=null&&t._defaulted?t:{...X(this,ni).mutations,...(t==null?void 0:t.mutationKey)&&this.getMutationDefaults(t.mutationKey),...t,_defaulted:!0}}clear(){X(this,st).clear(),X(this,ti).clear()}},st=new WeakMap,ti=new WeakMap,ni=new WeakMap,Ns=new WeakMap,As=new WeakMap,ri=new WeakMap,Ps=new WeakMap,Ds=new WeakMap,Xb),C4=C.createContext(void 0),_4=({client:t,children:e})=>(C.useEffect(()=>(t.mount(),()=>{t.unmount()}),[t]),b.jsx(C4.Provider,{value:t,children:e}));/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function vc(){return vc=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},vc.apply(this,arguments)}var ai;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(ai||(ai={}));const Vx="popstate";function S4(t){t===void 0&&(t={});function e(r,o){let{pathname:i,search:a,hash:s}=r.location;return vv("",{pathname:i,search:a,hash:s},o.state&&o.state.usr||null,o.state&&o.state.key||"default")}function n(r,o){return typeof o=="string"?o:ef(o)}return I4(e,n,null,t)}function vt(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function M_(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function k4(){return Math.random().toString(36).substr(2,8)}function Hx(t,e){return{usr:t.state,key:t.key,idx:e}}function vv(t,e,n,r){return n===void 0&&(n=null),vc({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?su(e):e,{state:n,key:e&&e.key||r||k4()})}function ef(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function su(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function I4(t,e,n,r){r===void 0&&(r={});let{window:o=document.defaultView,v5Compat:i=!1}=r,a=o.history,s=ai.Pop,u=null,c=l();c==null&&(c=0,a.replaceState(vc({},a.state,{idx:c}),""));function l(){return(a.state||{idx:null}).idx}function d(){s=ai.Pop;let g=l(),v=g==null?null:g-c;c=g,u&&u({action:s,location:p.location,delta:v})}function f(g,v){s=ai.Push;let y=vv(p.location,g,v);c=l()+1;let x=Hx(y,c),w=p.createHref(y);try{a.pushState(x,"",w)}catch(E){if(E instanceof DOMException&&E.name==="DataCloneError")throw E;o.location.assign(w)}i&&u&&u({action:s,location:p.location,delta:1})}function h(g,v){s=ai.Replace;let y=vv(p.location,g,v);c=l();let x=Hx(y,c),w=p.createHref(y);a.replaceState(x,"",w),i&&u&&u({action:s,location:p.location,delta:0})}function m(g){let v=o.location.origin!=="null"?o.location.origin:o.location.href,y=typeof g=="string"?g:ef(g);return y=y.replace(/ $/,"%20"),vt(v,"No window.location.(origin|href) available to create URL for href: "+y),new URL(y,v)}let p={get action(){return s},get location(){return t(o,a)},listen(g){if(u)throw new Error("A history only accepts one active listener");return o.addEventListener(Vx,d),u=g,()=>{o.removeEventListener(Vx,d),u=null}},createHref(g){return e(o,g)},createURL:m,encodeLocation(g){let v=m(g);return{pathname:v.pathname,search:v.search,hash:v.hash}},push:f,replace:h,go(g){return a.go(g)}};return p}var Gx;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(Gx||(Gx={}));function R4(t,e,n){return n===void 0&&(n="/"),T4(t,e,n,!1)}function T4(t,e,n,r){let o=typeof e=="string"?su(e):e,i=xy(o.pathname||"/",n);if(i==null)return null;let a=O_(t);N4(a);let s=null;for(let u=0;s==null&&u<a.length;++u){let c=W4(i);s=j4(a[u],c,r)}return s}function O_(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let o=(i,a,s)=>{let u={relativePath:s===void 0?i.path||"":s,caseSensitive:i.caseSensitive===!0,childrenIndex:a,route:i};u.relativePath.startsWith("/")&&(vt(u.relativePath.startsWith(r),'Absolute route path "'+u.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),u.relativePath=u.relativePath.slice(r.length));let c=gi([r,u.relativePath]),l=n.concat(u);i.children&&i.children.length>0&&(vt(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+c+'".')),O_(i.children,e,l,c)),!(i.path==null&&!i.index)&&e.push({path:c,score:L4(c,i.index),routesMeta:l})};return t.forEach((i,a)=>{var s;if(i.path===""||!((s=i.path)!=null&&s.includes("?")))o(i,a);else for(let u of F_(i.path))o(i,a,u)}),e}function F_(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,o=n.endsWith("?"),i=n.replace(/\?$/,"");if(r.length===0)return o?[i,""]:[i];let a=F_(r.join("/")),s=[];return s.push(...a.map(u=>u===""?i:[i,u].join("/"))),o&&s.push(...a),s.map(u=>t.startsWith("/")&&u===""?"/":u)}function N4(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:B4(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const A4=/^:[\w-]+$/,P4=3,D4=2,M4=1,O4=10,F4=-2,Kx=t=>t==="*";function L4(t,e){let n=t.split("/"),r=n.length;return n.some(Kx)&&(r+=F4),e&&(r+=D4),n.filter(o=>!Kx(o)).reduce((o,i)=>o+(A4.test(i)?P4:i===""?M4:O4),r)}function B4(t,e){return t.length===e.length&&t.slice(0,-1).every((r,o)=>r===e[o])?t[t.length-1]-e[e.length-1]:0}function j4(t,e,n){let{routesMeta:r}=t,o={},i="/",a=[];for(let s=0;s<r.length;++s){let u=r[s],c=s===r.length-1,l=i==="/"?e:e.slice(i.length)||"/",d=qx({path:u.relativePath,caseSensitive:u.caseSensitive,end:c},l),f=u.route;if(!d&&c&&n&&!r[r.length-1].route.index&&(d=qx({path:u.relativePath,caseSensitive:u.caseSensitive,end:!1},l)),!d)return null;Object.assign(o,d.params),a.push({params:o,pathname:gi([i,d.pathname]),pathnameBase:H4(gi([i,d.pathnameBase])),route:f}),d.pathnameBase!=="/"&&(i=gi([i,d.pathnameBase]))}return a}function qx(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=U4(t.path,t.caseSensitive,t.end),o=e.match(n);if(!o)return null;let i=o[0],a=i.replace(/(.)\/+$/,"$1"),s=o.slice(1);return{params:r.reduce((c,l,d)=>{let{paramName:f,isOptional:h}=l;if(f==="*"){let p=s[d]||"";a=i.slice(0,i.length-p.length).replace(/(.)\/+$/,"$1")}const m=s[d];return h&&!m?c[f]=void 0:c[f]=(m||"").replace(/%2F/g,"/"),c},{}),pathname:i,pathnameBase:a,pattern:t}}function U4(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),M_(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],o="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(a,s,u)=>(r.push({paramName:s,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),o+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?o+="\\/*$":t!==""&&t!=="/"&&(o+="(?:(?=\\/|$))"),[new RegExp(o,e?void 0:"i"),r]}function W4(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return M_(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function xy(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function $4(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:o=""}=typeof t=="string"?su(t):t;return{pathname:n?n.startsWith("/")?n:z4(n,e):e,search:G4(r),hash:K4(o)}}function z4(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(o=>{o===".."?n.length>1&&n.pop():o!=="."&&n.push(o)}),n.length>1?n.join("/"):"/"}function bp(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function V4(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function L_(t,e){let n=V4(t);return e?n.map((r,o)=>o===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function B_(t,e,n,r){r===void 0&&(r=!1);let o;typeof t=="string"?o=su(t):(o=vc({},t),vt(!o.pathname||!o.pathname.includes("?"),bp("?","pathname","search",o)),vt(!o.pathname||!o.pathname.includes("#"),bp("#","pathname","hash",o)),vt(!o.search||!o.search.includes("#"),bp("#","search","hash",o)));let i=t===""||o.pathname==="",a=i?"/":o.pathname,s;if(a==null)s=n;else{let d=e.length-1;if(!r&&a.startsWith("..")){let f=a.split("/");for(;f[0]==="..";)f.shift(),d-=1;o.pathname=f.join("/")}s=d>=0?e[d]:"/"}let u=$4(o,s),c=a&&a!=="/"&&a.endsWith("/"),l=(i||a===".")&&n.endsWith("/");return!u.pathname.endsWith("/")&&(c||l)&&(u.pathname+="/"),u}const gi=t=>t.join("/").replace(/\/\/+/g,"/"),H4=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),G4=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,K4=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function q4(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const j_=["post","put","patch","delete"];new Set(j_);const X4=["get",...j_];new Set(X4);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function gc(){return gc=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},gc.apply(this,arguments)}const wy=C.createContext(null),Y4=C.createContext(null),ba=C.createContext(null),fh=C.createContext(null),Di=C.createContext({outlet:null,matches:[],isDataRoute:!1}),U_=C.createContext(null);function Q4(t,e){let{relative:n}=e===void 0?{}:e;Uc()||vt(!1);let{basename:r,navigator:o}=C.useContext(ba),{hash:i,pathname:a,search:s}=$_(t,{relative:n}),u=a;return r!=="/"&&(u=a==="/"?r:gi([r,a])),o.createHref({pathname:u,search:s,hash:i})}function Uc(){return C.useContext(fh)!=null}function Ea(){return Uc()||vt(!1),C.useContext(fh).location}function W_(t){C.useContext(ba).static||C.useLayoutEffect(t)}function Wc(){let{isDataRoute:t}=C.useContext(Di);return t?dF():J4()}function J4(){Uc()||vt(!1);let t=C.useContext(wy),{basename:e,future:n,navigator:r}=C.useContext(ba),{matches:o}=C.useContext(Di),{pathname:i}=Ea(),a=JSON.stringify(L_(o,n.v7_relativeSplatPath)),s=C.useRef(!1);return W_(()=>{s.current=!0}),C.useCallback(function(c,l){if(l===void 0&&(l={}),!s.current)return;if(typeof c=="number"){r.go(c);return}let d=B_(c,JSON.parse(a),i,l.relative==="path");t==null&&e!=="/"&&(d.pathname=d.pathname==="/"?e:gi([e,d.pathname])),(l.replace?r.replace:r.push)(d,l.state,l)},[e,r,a,i,t])}function Z4(){let{matches:t}=C.useContext(Di),e=t[t.length-1];return e?e.params:{}}function $_(t,e){let{relative:n}=e===void 0?{}:e,{future:r}=C.useContext(ba),{matches:o}=C.useContext(Di),{pathname:i}=Ea(),a=JSON.stringify(L_(o,r.v7_relativeSplatPath));return C.useMemo(()=>B_(t,JSON.parse(a),i,n==="path"),[t,a,i,n])}function eF(t,e){return tF(t,e)}function tF(t,e,n,r){Uc()||vt(!1);let{navigator:o}=C.useContext(ba),{matches:i}=C.useContext(Di),a=i[i.length-1],s=a?a.params:{};a&&a.pathname;let u=a?a.pathnameBase:"/";a&&a.route;let c=Ea(),l;if(e){var d;let g=typeof e=="string"?su(e):e;u==="/"||(d=g.pathname)!=null&&d.startsWith(u)||vt(!1),l=g}else l=c;let f=l.pathname||"/",h=f;if(u!=="/"){let g=u.replace(/^\//,"").split("/");h="/"+f.replace(/^\//,"").split("/").slice(g.length).join("/")}let m=R4(t,{pathname:h}),p=aF(m&&m.map(g=>Object.assign({},g,{params:Object.assign({},s,g.params),pathname:gi([u,o.encodeLocation?o.encodeLocation(g.pathname).pathname:g.pathname]),pathnameBase:g.pathnameBase==="/"?u:gi([u,o.encodeLocation?o.encodeLocation(g.pathnameBase).pathname:g.pathnameBase])})),i,n,r);return e&&p?C.createElement(fh.Provider,{value:{location:gc({pathname:"/",search:"",hash:"",state:null,key:"default"},l),navigationType:ai.Pop}},p):p}function nF(){let t=lF(),e=q4(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,o={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return C.createElement(C.Fragment,null,C.createElement("h2",null,"Unexpected Application Error!"),C.createElement("h3",{style:{fontStyle:"italic"}},e),n?C.createElement("pre",{style:o},n):null,null)}const rF=C.createElement(nF,null);class oF extends C.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?C.createElement(Di.Provider,{value:this.props.routeContext},C.createElement(U_.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function iF(t){let{routeContext:e,match:n,children:r}=t,o=C.useContext(wy);return o&&o.static&&o.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(o.staticContext._deepestRenderedBoundaryId=n.route.id),C.createElement(Di.Provider,{value:e},r)}function aF(t,e,n,r){var o;if(e===void 0&&(e=[]),n===void 0&&(n=null),r===void 0&&(r=null),t==null){var i;if(!n)return null;if(n.errors)t=n.matches;else if((i=r)!=null&&i.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let a=t,s=(o=n)==null?void 0:o.errors;if(s!=null){let l=a.findIndex(d=>d.route.id&&(s==null?void 0:s[d.route.id])!==void 0);l>=0||vt(!1),a=a.slice(0,Math.min(a.length,l+1))}let u=!1,c=-1;if(n&&r&&r.v7_partialHydration)for(let l=0;l<a.length;l++){let d=a[l];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(c=l),d.route.id){let{loaderData:f,errors:h}=n,m=d.route.loader&&f[d.route.id]===void 0&&(!h||h[d.route.id]===void 0);if(d.route.lazy||m){u=!0,c>=0?a=a.slice(0,c+1):a=[a[0]];break}}}return a.reduceRight((l,d,f)=>{let h,m=!1,p=null,g=null;n&&(h=s&&d.route.id?s[d.route.id]:void 0,p=d.route.errorElement||rF,u&&(c<0&&f===0?(m=!0,g=null):c===f&&(m=!0,g=d.route.hydrateFallbackElement||null)));let v=e.concat(a.slice(0,f+1)),y=()=>{let x;return h?x=p:m?x=g:d.route.Component?x=C.createElement(d.route.Component,null):d.route.element?x=d.route.element:x=l,C.createElement(iF,{match:d,routeContext:{outlet:l,matches:v,isDataRoute:n!=null},children:x})};return n&&(d.route.ErrorBoundary||d.route.errorElement||f===0)?C.createElement(oF,{location:n.location,revalidation:n.revalidation,component:p,error:h,children:y(),routeContext:{outlet:null,matches:v,isDataRoute:!0}}):y()},null)}var z_=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(z_||{}),tf=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(tf||{});function sF(t){let e=C.useContext(wy);return e||vt(!1),e}function uF(t){let e=C.useContext(Y4);return e||vt(!1),e}function cF(t){let e=C.useContext(Di);return e||vt(!1),e}function V_(t){let e=cF(),n=e.matches[e.matches.length-1];return n.route.id||vt(!1),n.route.id}function lF(){var t;let e=C.useContext(U_),n=uF(tf.UseRouteError),r=V_(tf.UseRouteError);return e!==void 0?e:(t=n.errors)==null?void 0:t[r]}function dF(){let{router:t}=sF(z_.UseNavigateStable),e=V_(tf.UseNavigateStable),n=C.useRef(!1);return W_(()=>{n.current=!0}),C.useCallback(function(o,i){i===void 0&&(i={}),n.current&&(typeof o=="number"?t.navigate(o):t.navigate(o,gc({fromRouteId:e},i)))},[t,e])}function fF(t,e){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function zi(t){vt(!1)}function hF(t){let{basename:e="/",children:n=null,location:r,navigationType:o=ai.Pop,navigator:i,static:a=!1,future:s}=t;Uc()&&vt(!1);let u=e.replace(/^\/*/,"/"),c=C.useMemo(()=>({basename:u,navigator:i,static:a,future:gc({v7_relativeSplatPath:!1},s)}),[u,s,i,a]);typeof r=="string"&&(r=su(r));let{pathname:l="/",search:d="",hash:f="",state:h=null,key:m="default"}=r,p=C.useMemo(()=>{let g=xy(l,u);return g==null?null:{location:{pathname:g,search:d,hash:f,state:h,key:m},navigationType:o}},[u,l,d,f,h,m,o]);return p==null?null:C.createElement(ba.Provider,{value:c},C.createElement(fh.Provider,{children:n,value:p}))}function pF(t){let{children:e,location:n}=t;return eF(gv(e),n)}new Promise(()=>{});function gv(t,e){e===void 0&&(e=[]);let n=[];return C.Children.forEach(t,(r,o)=>{if(!C.isValidElement(r))return;let i=[...e,o];if(r.type===C.Fragment){n.push.apply(n,gv(r.props.children,i));return}r.type!==zi&&vt(!1),!r.props.index||!r.props.children||vt(!1);let a={id:r.props.id||i.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(a.children=gv(r.props.children,i)),n.push(a)}),n}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function yv(){return yv=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},yv.apply(this,arguments)}function mF(t,e){if(t==null)return{};var n={},r=Object.keys(t),o,i;for(i=0;i<r.length;i++)o=r[i],!(e.indexOf(o)>=0)&&(n[o]=t[o]);return n}function vF(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function gF(t,e){return t.button===0&&(!e||e==="_self")&&!vF(t)}function xv(t){return t===void 0&&(t=""),new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,n)=>{let r=t[n];return e.concat(Array.isArray(r)?r.map(o=>[n,o]):[[n,r]])},[]))}function yF(t,e){let n=xv(t);return e&&e.forEach((r,o)=>{n.has(o)||e.getAll(o).forEach(i=>{n.append(o,i)})}),n}const xF=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],wF="6";try{window.__reactRouterVersion=wF}catch{}const bF="startTransition",Xx=ug[bF];function EF(t){let{basename:e,children:n,future:r,window:o}=t,i=C.useRef();i.current==null&&(i.current=S4({window:o,v5Compat:!0}));let a=i.current,[s,u]=C.useState({action:a.action,location:a.location}),{v7_startTransition:c}=r||{},l=C.useCallback(d=>{c&&Xx?Xx(()=>u(d)):u(d)},[u,c]);return C.useLayoutEffect(()=>a.listen(l),[a,l]),C.useEffect(()=>fF(r),[r]),C.createElement(hF,{basename:e,children:n,location:s.location,navigationType:s.action,navigator:a,future:r})}const CF=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",_F=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,dn=C.forwardRef(function(e,n){let{onClick:r,relative:o,reloadDocument:i,replace:a,state:s,target:u,to:c,preventScrollReset:l,viewTransition:d}=e,f=mF(e,xF),{basename:h}=C.useContext(ba),m,p=!1;if(typeof c=="string"&&_F.test(c)&&(m=c,CF))try{let x=new URL(window.location.href),w=c.startsWith("//")?new URL(x.protocol+c):new URL(c),E=xy(w.pathname,h);w.origin===x.origin&&E!=null?c=E+w.search+w.hash:p=!0}catch{}let g=Q4(c,{relative:o}),v=SF(c,{replace:a,state:s,target:u,preventScrollReset:l,relative:o,viewTransition:d});function y(x){r&&r(x),x.defaultPrevented||v(x)}return C.createElement("a",yv({},f,{href:m||g,onClick:p||i?r:y,ref:n,target:u}))});var Yx;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(Yx||(Yx={}));var Qx;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(Qx||(Qx={}));function SF(t,e){let{target:n,replace:r,state:o,preventScrollReset:i,relative:a,viewTransition:s}=e===void 0?{}:e,u=Wc(),c=Ea(),l=$_(t,{relative:a});return C.useCallback(d=>{if(gF(d,n)){d.preventDefault();let f=r!==void 0?r:ef(c)===ef(l);u(t,{replace:f,state:o,preventScrollReset:i,relative:a,viewTransition:s})}},[c,u,l,r,o,n,t,i,a,s])}function by(t){let e=C.useRef(xv(t)),n=C.useRef(!1),r=Ea(),o=C.useMemo(()=>yF(r.search,n.current?null:e.current),[r.search]),i=Wc(),a=C.useCallback((s,u)=>{const c=xv(typeof s=="function"?s(o):s);n.current=!0,i("?"+c,u)},[i,o]);return[o,a]}const kF=nh("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-lg text-sm font-medium ring-offset-background transition-all duration-300 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90 shadow-soft hover:shadow-card",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80 shadow-soft",ghost:"hover:bg-accent/10 hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline",hero:"bg-gradient-river text-primary-foreground font-semibold shadow-elevated hover:shadow-card hover:-translate-y-0.5 active:translate-y-0",heroOutline:"border-2 border-primary-foreground/80 text-primary-foreground bg-primary-foreground/10 backdrop-blur-sm hover:bg-primary-foreground/20 font-semibold",accent:"bg-accent text-accent-foreground hover:bg-accent/90 shadow-soft",sky:"bg-secondary text-secondary-foreground hover:bg-secondary/80 shadow-soft hover:shadow-card"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-12 rounded-xl px-8 text-base",xl:"h-14 rounded-xl px-10 text-lg",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),De=C.forwardRef(({className:t,variant:e,size:n,asChild:r=!1,...o},i)=>{const a=r?UP:"button";return b.jsx(a,{className:we(kF({variant:e,size:n,className:t})),ref:i,...o})});De.displayName="Button";var IF=C.createContext(void 0);function Ey(t){const e=C.useContext(IF);return t||e||"ltr"}var Ep=0;function RF(){C.useEffect(()=>{const t=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",t[0]??Jx()),document.body.insertAdjacentElement("beforeend",t[1]??Jx()),Ep++,()=>{Ep===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),Ep--}},[])}function Jx(){const t=document.createElement("span");return t.setAttribute("data-radix-focus-guard",""),t.tabIndex=0,t.style.outline="none",t.style.opacity="0",t.style.position="fixed",t.style.pointerEvents="none",t}var Cp="focusScope.autoFocusOnMount",_p="focusScope.autoFocusOnUnmount",Zx={bubbles:!1,cancelable:!0},TF="FocusScope",H_=C.forwardRef((t,e)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:o,onUnmountAutoFocus:i,...a}=t,[s,u]=C.useState(null),c=yn(o),l=yn(i),d=C.useRef(null),f=At(e,p=>u(p)),h=C.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;C.useEffect(()=>{if(r){let p=function(x){if(h.paused||!s)return;const w=x.target;s.contains(w)?d.current=w:Vo(d.current,{select:!0})},g=function(x){if(h.paused||!s)return;const w=x.relatedTarget;w!==null&&(s.contains(w)||Vo(d.current,{select:!0}))},v=function(x){if(document.activeElement===document.body)for(const E of x)E.removedNodes.length>0&&Vo(s)};document.addEventListener("focusin",p),document.addEventListener("focusout",g);const y=new MutationObserver(v);return s&&y.observe(s,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",p),document.removeEventListener("focusout",g),y.disconnect()}}},[r,s,h.paused]),C.useEffect(()=>{if(s){tw.add(h);const p=document.activeElement;if(!s.contains(p)){const v=new CustomEvent(Cp,Zx);s.addEventListener(Cp,c),s.dispatchEvent(v),v.defaultPrevented||(NF(OF(G_(s)),{select:!0}),document.activeElement===p&&Vo(s))}return()=>{s.removeEventListener(Cp,c),setTimeout(()=>{const v=new CustomEvent(_p,Zx);s.addEventListener(_p,l),s.dispatchEvent(v),v.defaultPrevented||Vo(p??document.body,{select:!0}),s.removeEventListener(_p,l),tw.remove(h)},0)}}},[s,c,l,h]);const m=C.useCallback(p=>{if(!n&&!r||h.paused)return;const g=p.key==="Tab"&&!p.altKey&&!p.ctrlKey&&!p.metaKey,v=document.activeElement;if(g&&v){const y=p.currentTarget,[x,w]=AF(y);x&&w?!p.shiftKey&&v===w?(p.preventDefault(),n&&Vo(x,{select:!0})):p.shiftKey&&v===x&&(p.preventDefault(),n&&Vo(w,{select:!0})):v===y&&p.preventDefault()}},[n,r,h.paused]);return b.jsx(je.div,{tabIndex:-1,...a,ref:f,onKeyDown:m})});H_.displayName=TF;function NF(t,{select:e=!1}={}){const n=document.activeElement;for(const r of t)if(Vo(r,{select:e}),document.activeElement!==n)return}function AF(t){const e=G_(t),n=ew(e,t),r=ew(e.reverse(),t);return[n,r]}function G_(t){const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const o=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||o?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)e.push(n.currentNode);return e}function ew(t,e){for(const n of t)if(!PF(n,{upTo:e}))return n}function PF(t,{upTo:e}){if(getComputedStyle(t).visibility==="hidden")return!0;for(;t;){if(e!==void 0&&t===e)return!1;if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1}function DF(t){return t instanceof HTMLInputElement&&"select"in t}function Vo(t,{select:e=!1}={}){if(t&&t.focus){const n=document.activeElement;t.focus({preventScroll:!0}),t!==n&&DF(t)&&e&&t.select()}}var tw=MF();function MF(){let t=[];return{add(e){const n=t[0];e!==n&&(n==null||n.pause()),t=nw(t,e),t.unshift(e)},remove(e){var n;t=nw(t,e),(n=t[0])==null||n.resume()}}}function nw(t,e){const n=[...t],r=n.indexOf(e);return r!==-1&&n.splice(r,1),n}function OF(t){return t.filter(e=>e.tagName!=="A")}var Sp="rovingFocusGroup.onEntryFocus",FF={bubbles:!1,cancelable:!0},$c="RovingFocusGroup",[wv,K_,LF]=ey($c),[BF,hh]=So($c,[LF]),[jF,UF]=BF($c),q_=C.forwardRef((t,e)=>b.jsx(wv.Provider,{scope:t.__scopeRovingFocusGroup,children:b.jsx(wv.Slot,{scope:t.__scopeRovingFocusGroup,children:b.jsx(WF,{...t,ref:e})})}));q_.displayName=$c;var WF=C.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:n,orientation:r,loop:o=!1,dir:i,currentTabStopId:a,defaultCurrentTabStopId:s,onCurrentTabStopIdChange:u,onEntryFocus:c,preventScrollOnEntryFocus:l=!1,...d}=t,f=C.useRef(null),h=At(e,f),m=Ey(i),[p,g]=Zf({prop:a,defaultProp:s??null,onChange:u,caller:$c}),[v,y]=C.useState(!1),x=yn(c),w=K_(n),E=C.useRef(!1),[_,S]=C.useState(0);return C.useEffect(()=>{const k=f.current;if(k)return k.addEventListener(Sp,x),()=>k.removeEventListener(Sp,x)},[x]),b.jsx(jF,{scope:n,orientation:r,dir:m,loop:o,currentTabStopId:p,onItemFocus:C.useCallback(k=>g(k),[g]),onItemShiftTab:C.useCallback(()=>y(!0),[]),onFocusableItemAdd:C.useCallback(()=>S(k=>k+1),[]),onFocusableItemRemove:C.useCallback(()=>S(k=>k-1),[]),children:b.jsx(je.div,{tabIndex:v||_===0?-1:0,"data-orientation":r,...d,ref:h,style:{outline:"none",...t.style},onMouseDown:me(t.onMouseDown,()=>{E.current=!0}),onFocus:me(t.onFocus,k=>{const I=!E.current;if(k.target===k.currentTarget&&I&&!v){const R=new CustomEvent(Sp,FF);if(k.currentTarget.dispatchEvent(R),!R.defaultPrevented){const D=w().filter(U=>U.focusable),A=D.find(U=>U.active),j=D.find(U=>U.id===p),W=[A,j,...D].filter(Boolean).map(U=>U.ref.current);Q_(W,l)}}E.current=!1}),onBlur:me(t.onBlur,()=>y(!1))})})}),X_="RovingFocusGroupItem",Y_=C.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:n,focusable:r=!0,active:o=!1,tabStopId:i,children:a,...s}=t,u=qd(),c=i||u,l=UF(X_,n),d=l.currentTabStopId===c,f=K_(n),{onFocusableItemAdd:h,onFocusableItemRemove:m,currentTabStopId:p}=l;return C.useEffect(()=>{if(r)return h(),()=>m()},[r,h,m]),b.jsx(wv.ItemSlot,{scope:n,id:c,focusable:r,active:o,children:b.jsx(je.span,{tabIndex:d?0:-1,"data-orientation":l.orientation,...s,ref:e,onMouseDown:me(t.onMouseDown,g=>{r?l.onItemFocus(c):g.preventDefault()}),onFocus:me(t.onFocus,()=>l.onItemFocus(c)),onKeyDown:me(t.onKeyDown,g=>{if(g.key==="Tab"&&g.shiftKey){l.onItemShiftTab();return}if(g.target!==g.currentTarget)return;const v=VF(g,l.orientation,l.dir);if(v!==void 0){if(g.metaKey||g.ctrlKey||g.altKey||g.shiftKey)return;g.preventDefault();let x=f().filter(w=>w.focusable).map(w=>w.ref.current);if(v==="last")x.reverse();else if(v==="prev"||v==="next"){v==="prev"&&x.reverse();const w=x.indexOf(g.currentTarget);x=l.loop?HF(x,w+1):x.slice(w+1)}setTimeout(()=>Q_(x))}}),children:typeof a=="function"?a({isCurrentTabStop:d,hasTabStop:p!=null}):a})})});Y_.displayName=X_;var $F={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function zF(t,e){return e!=="rtl"?t:t==="ArrowLeft"?"ArrowRight":t==="ArrowRight"?"ArrowLeft":t}function VF(t,e,n){const r=zF(t.key,n);if(!(e==="vertical"&&["ArrowLeft","ArrowRight"].includes(r))&&!(e==="horizontal"&&["ArrowUp","ArrowDown"].includes(r)))return $F[r]}function Q_(t,e=!1){const n=document.activeElement;for(const r of t)if(r===n||(r.focus({preventScroll:e}),document.activeElement!==n))return}function HF(t,e){return t.map((n,r)=>t[(e+r)%t.length])}var J_=q_,Z_=Y_,GF=function(t){if(typeof document>"u")return null;var e=Array.isArray(t)?t[0]:t;return e.ownerDocument.body},Oa=new WeakMap,Dl=new WeakMap,Ml={},kp=0,eS=function(t){return t&&(t.host||eS(t.parentNode))},KF=function(t,e){return e.map(function(n){if(t.contains(n))return n;var r=eS(n);return r&&t.contains(r)?r:(console.error("aria-hidden",n,"in not contained inside",t,". Doing nothing"),null)}).filter(function(n){return!!n})},qF=function(t,e,n,r){var o=KF(e,Array.isArray(t)?t:[t]);Ml[n]||(Ml[n]=new WeakMap);var i=Ml[n],a=[],s=new Set,u=new Set(o),c=function(d){!d||s.has(d)||(s.add(d),c(d.parentNode))};o.forEach(c);var l=function(d){!d||u.has(d)||Array.prototype.forEach.call(d.children,function(f){if(s.has(f))l(f);else try{var h=f.getAttribute(r),m=h!==null&&h!=="false",p=(Oa.get(f)||0)+1,g=(i.get(f)||0)+1;Oa.set(f,p),i.set(f,g),a.push(f),p===1&&m&&Dl.set(f,!0),g===1&&f.setAttribute(n,"true"),m||f.setAttribute(r,"true")}catch(v){console.error("aria-hidden: cannot operate on ",f,v)}})};return l(e),s.clear(),kp++,function(){a.forEach(function(d){var f=Oa.get(d)-1,h=i.get(d)-1;Oa.set(d,f),i.set(d,h),f||(Dl.has(d)||d.removeAttribute(r),Dl.delete(d)),h||d.removeAttribute(n)}),kp--,kp||(Oa=new WeakMap,Oa=new WeakMap,Dl=new WeakMap,Ml={})}},XF=function(t,e,n){n===void 0&&(n="data-aria-hidden");var r=Array.from(Array.isArray(t)?t:[t]),o=GF(t);return o?(r.push.apply(r,Array.from(o.querySelectorAll("[aria-live]"))),qF(r,o,n,"aria-hidden")):function(){return null}},Dr=function(){return Dr=Object.assign||function(e){for(var n,r=1,o=arguments.length;r<o;r++){n=arguments[r];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Dr.apply(this,arguments)};function zc(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n}function YF(t,e,n){if(n||arguments.length===2)for(var r=0,o=e.length,i;r<o;r++)(i||!(r in e))&&(i||(i=Array.prototype.slice.call(e,0,r)),i[r]=e[r]);return t.concat(i||Array.prototype.slice.call(e))}var md="right-scroll-bar-position",vd="width-before-scroll-bar",QF="with-scroll-bars-hidden",JF="--removed-body-scroll-bar-size";function Ip(t,e){return typeof t=="function"?t(e):t&&(t.current=e),t}function ZF(t,e){var n=C.useState(function(){return{value:t,callback:e,facade:{get current(){return n.value},set current(r){var o=n.value;o!==r&&(n.value=r,n.callback(r,o))}}}})[0];return n.callback=e,n.facade}var eL=typeof window<"u"?C.useLayoutEffect:C.useEffect,rw=new WeakMap;function tL(t,e){var n=ZF(null,function(r){return t.forEach(function(o){return Ip(o,r)})});return eL(function(){var r=rw.get(n);if(r){var o=new Set(r),i=new Set(t),a=n.current;o.forEach(function(s){i.has(s)||Ip(s,null)}),i.forEach(function(s){o.has(s)||Ip(s,a)})}rw.set(n,t)},[t]),n}function nL(t){return t}function rL(t,e){e===void 0&&(e=nL);var n=[],r=!1,o={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:t},useMedium:function(i){var a=e(i,r);return n.push(a),function(){n=n.filter(function(s){return s!==a})}},assignSyncMedium:function(i){for(r=!0;n.length;){var a=n;n=[],a.forEach(i)}n={push:function(s){return i(s)},filter:function(){return n}}},assignMedium:function(i){r=!0;var a=[];if(n.length){var s=n;n=[],s.forEach(i),a=n}var u=function(){var l=a;a=[],l.forEach(i)},c=function(){return Promise.resolve().then(u)};c(),n={push:function(l){a.push(l),c()},filter:function(l){return a=a.filter(l),n}}}};return o}function oL(t){t===void 0&&(t={});var e=rL(null);return e.options=Dr({async:!0,ssr:!1},t),e}var tS=function(t){var e=t.sideCar,n=zc(t,["sideCar"]);if(!e)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=e.read();if(!r)throw new Error("Sidecar medium not found");return C.createElement(r,Dr({},n))};tS.isSideCarExport=!0;function iL(t,e){return t.useMedium(e),tS}var nS=oL(),Rp=function(){},ph=C.forwardRef(function(t,e){var n=C.useRef(null),r=C.useState({onScrollCapture:Rp,onWheelCapture:Rp,onTouchMoveCapture:Rp}),o=r[0],i=r[1],a=t.forwardProps,s=t.children,u=t.className,c=t.removeScrollBar,l=t.enabled,d=t.shards,f=t.sideCar,h=t.noRelative,m=t.noIsolation,p=t.inert,g=t.allowPinchZoom,v=t.as,y=v===void 0?"div":v,x=t.gapMode,w=zc(t,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),E=f,_=tL([n,e]),S=Dr(Dr({},w),o);return C.createElement(C.Fragment,null,l&&C.createElement(E,{sideCar:nS,removeScrollBar:c,shards:d,noRelative:h,noIsolation:m,inert:p,setCallbacks:i,allowPinchZoom:!!g,lockRef:n,gapMode:x}),a?C.cloneElement(C.Children.only(s),Dr(Dr({},S),{ref:_})):C.createElement(y,Dr({},S,{className:u,ref:_}),s))});ph.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};ph.classNames={fullWidth:vd,zeroRight:md};var aL=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function sL(){if(!document)return null;var t=document.createElement("style");t.type="text/css";var e=aL();return e&&t.setAttribute("nonce",e),t}function uL(t,e){t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e))}function cL(t){var e=document.head||document.getElementsByTagName("head")[0];e.appendChild(t)}var lL=function(){var t=0,e=null;return{add:function(n){t==0&&(e=sL())&&(uL(e,n),cL(e)),t++},remove:function(){t--,!t&&e&&(e.parentNode&&e.parentNode.removeChild(e),e=null)}}},dL=function(){var t=lL();return function(e,n){C.useEffect(function(){return t.add(e),function(){t.remove()}},[e&&n])}},rS=function(){var t=dL(),e=function(n){var r=n.styles,o=n.dynamic;return t(r,o),null};return e},fL={left:0,top:0,right:0,gap:0},Tp=function(t){return parseInt(t||"",10)||0},hL=function(t){var e=window.getComputedStyle(document.body),n=e[t==="padding"?"paddingLeft":"marginLeft"],r=e[t==="padding"?"paddingTop":"marginTop"],o=e[t==="padding"?"paddingRight":"marginRight"];return[Tp(n),Tp(r),Tp(o)]},pL=function(t){if(t===void 0&&(t="margin"),typeof window>"u")return fL;var e=hL(t),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:e[0],top:e[1],right:e[2],gap:Math.max(0,r-n+e[2]-e[0])}},mL=rS(),hs="data-scroll-locked",vL=function(t,e,n,r){var o=t.left,i=t.top,a=t.right,s=t.gap;return n===void 0&&(n="margin"),`
  .`.concat(QF,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(s,"px ").concat(r,`;
  }
  body[`).concat(hs,`] {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([e&&"position: relative ".concat(r,";"),n==="margin"&&`
    padding-left: `.concat(o,`px;
    padding-top: `).concat(i,`px;
    padding-right: `).concat(a,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(s,"px ").concat(r,`;
    `),n==="padding"&&"padding-right: ".concat(s,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(md,` {
    right: `).concat(s,"px ").concat(r,`;
  }
  
  .`).concat(vd,` {
    margin-right: `).concat(s,"px ").concat(r,`;
  }
  
  .`).concat(md," .").concat(md,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat(vd," .").concat(vd,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body[`).concat(hs,`] {
    `).concat(JF,": ").concat(s,`px;
  }
`)},ow=function(){var t=parseInt(document.body.getAttribute(hs)||"0",10);return isFinite(t)?t:0},gL=function(){C.useEffect(function(){return document.body.setAttribute(hs,(ow()+1).toString()),function(){var t=ow()-1;t<=0?document.body.removeAttribute(hs):document.body.setAttribute(hs,t.toString())}},[])},yL=function(t){var e=t.noRelative,n=t.noImportant,r=t.gapMode,o=r===void 0?"margin":r;gL();var i=C.useMemo(function(){return pL(o)},[o]);return C.createElement(mL,{styles:vL(i,!e,o,n?"":"!important")})},bv=!1;if(typeof window<"u")try{var Ol=Object.defineProperty({},"passive",{get:function(){return bv=!0,!0}});window.addEventListener("test",Ol,Ol),window.removeEventListener("test",Ol,Ol)}catch{bv=!1}var Fa=bv?{passive:!1}:!1,xL=function(t){return t.tagName==="TEXTAREA"},oS=function(t,e){if(!(t instanceof Element))return!1;var n=window.getComputedStyle(t);return n[e]!=="hidden"&&!(n.overflowY===n.overflowX&&!xL(t)&&n[e]==="visible")},wL=function(t){return oS(t,"overflowY")},bL=function(t){return oS(t,"overflowX")},iw=function(t,e){var n=e.ownerDocument,r=e;do{typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&(r=r.host);var o=iS(t,r);if(o){var i=aS(t,r),a=i[1],s=i[2];if(a>s)return!0}r=r.parentNode}while(r&&r!==n.body);return!1},EL=function(t){var e=t.scrollTop,n=t.scrollHeight,r=t.clientHeight;return[e,n,r]},CL=function(t){var e=t.scrollLeft,n=t.scrollWidth,r=t.clientWidth;return[e,n,r]},iS=function(t,e){return t==="v"?wL(e):bL(e)},aS=function(t,e){return t==="v"?EL(e):CL(e)},_L=function(t,e){return t==="h"&&e==="rtl"?-1:1},SL=function(t,e,n,r,o){var i=_L(t,window.getComputedStyle(e).direction),a=i*r,s=n.target,u=e.contains(s),c=!1,l=a>0,d=0,f=0;do{if(!s)break;var h=aS(t,s),m=h[0],p=h[1],g=h[2],v=p-g-i*m;(m||v)&&iS(t,s)&&(d+=v,f+=m);var y=s.parentNode;s=y&&y.nodeType===Node.DOCUMENT_FRAGMENT_NODE?y.host:y}while(!u&&s!==document.body||u&&(e.contains(s)||e===s));return(l&&(Math.abs(d)<1||!o)||!l&&(Math.abs(f)<1||!o))&&(c=!0),c},Fl=function(t){return"changedTouches"in t?[t.changedTouches[0].clientX,t.changedTouches[0].clientY]:[0,0]},aw=function(t){return[t.deltaX,t.deltaY]},sw=function(t){return t&&"current"in t?t.current:t},kL=function(t,e){return t[0]===e[0]&&t[1]===e[1]},IL=function(t){return`
  .block-interactivity-`.concat(t,` {pointer-events: none;}
  .allow-interactivity-`).concat(t,` {pointer-events: all;}
`)},RL=0,La=[];function TL(t){var e=C.useRef([]),n=C.useRef([0,0]),r=C.useRef(),o=C.useState(RL++)[0],i=C.useState(rS)[0],a=C.useRef(t);C.useEffect(function(){a.current=t},[t]),C.useEffect(function(){if(t.inert){document.body.classList.add("block-interactivity-".concat(o));var p=YF([t.lockRef.current],(t.shards||[]).map(sw),!0).filter(Boolean);return p.forEach(function(g){return g.classList.add("allow-interactivity-".concat(o))}),function(){document.body.classList.remove("block-interactivity-".concat(o)),p.forEach(function(g){return g.classList.remove("allow-interactivity-".concat(o))})}}},[t.inert,t.lockRef.current,t.shards]);var s=C.useCallback(function(p,g){if("touches"in p&&p.touches.length===2||p.type==="wheel"&&p.ctrlKey)return!a.current.allowPinchZoom;var v=Fl(p),y=n.current,x="deltaX"in p?p.deltaX:y[0]-v[0],w="deltaY"in p?p.deltaY:y[1]-v[1],E,_=p.target,S=Math.abs(x)>Math.abs(w)?"h":"v";if("touches"in p&&S==="h"&&_.type==="range")return!1;var k=iw(S,_);if(!k)return!0;if(k?E=S:(E=S==="v"?"h":"v",k=iw(S,_)),!k)return!1;if(!r.current&&"changedTouches"in p&&(x||w)&&(r.current=E),!E)return!0;var I=r.current||E;return SL(I,g,p,I==="h"?x:w,!0)},[]),u=C.useCallback(function(p){var g=p;if(!(!La.length||La[La.length-1]!==i)){var v="deltaY"in g?aw(g):Fl(g),y=e.current.filter(function(E){return E.name===g.type&&(E.target===g.target||g.target===E.shadowParent)&&kL(E.delta,v)})[0];if(y&&y.should){g.cancelable&&g.preventDefault();return}if(!y){var x=(a.current.shards||[]).map(sw).filter(Boolean).filter(function(E){return E.contains(g.target)}),w=x.length>0?s(g,x[0]):!a.current.noIsolation;w&&g.cancelable&&g.preventDefault()}}},[]),c=C.useCallback(function(p,g,v,y){var x={name:p,delta:g,target:v,should:y,shadowParent:NL(v)};e.current.push(x),setTimeout(function(){e.current=e.current.filter(function(w){return w!==x})},1)},[]),l=C.useCallback(function(p){n.current=Fl(p),r.current=void 0},[]),d=C.useCallback(function(p){c(p.type,aw(p),p.target,s(p,t.lockRef.current))},[]),f=C.useCallback(function(p){c(p.type,Fl(p),p.target,s(p,t.lockRef.current))},[]);C.useEffect(function(){return La.push(i),t.setCallbacks({onScrollCapture:d,onWheelCapture:d,onTouchMoveCapture:f}),document.addEventListener("wheel",u,Fa),document.addEventListener("touchmove",u,Fa),document.addEventListener("touchstart",l,Fa),function(){La=La.filter(function(p){return p!==i}),document.removeEventListener("wheel",u,Fa),document.removeEventListener("touchmove",u,Fa),document.removeEventListener("touchstart",l,Fa)}},[]);var h=t.removeScrollBar,m=t.inert;return C.createElement(C.Fragment,null,m?C.createElement(i,{styles:IL(o)}):null,h?C.createElement(yL,{noRelative:t.noRelative,gapMode:t.gapMode}):null)}function NL(t){for(var e=null;t!==null;)t instanceof ShadowRoot&&(e=t.host,t=t.host),t=t.parentNode;return e}const AL=iL(nS,TL);var sS=C.forwardRef(function(t,e){return C.createElement(ph,Dr({},t,{ref:e,sideCar:AL}))});sS.classNames=ph.classNames;var Ev=["Enter"," "],PL=["ArrowDown","PageUp","Home"],uS=["ArrowUp","PageDown","End"],DL=[...PL,...uS],ML={ltr:[...Ev,"ArrowRight"],rtl:[...Ev,"ArrowLeft"]},OL={ltr:["ArrowLeft"],rtl:["ArrowRight"]},Vc="Menu",[yc,FL,LL]=ey(Vc),[Ca,cS]=So(Vc,[LL,sh,hh]),mh=sh(),lS=hh(),[BL,_a]=Ca(Vc),[jL,Hc]=Ca(Vc),dS=t=>{const{__scopeMenu:e,open:n=!1,children:r,dir:o,onOpenChange:i,modal:a=!0}=t,s=mh(e),[u,c]=C.useState(null),l=C.useRef(!1),d=yn(i),f=Ey(o);return C.useEffect(()=>{const h=()=>{l.current=!0,document.addEventListener("pointerdown",m,{capture:!0,once:!0}),document.addEventListener("pointermove",m,{capture:!0,once:!0})},m=()=>l.current=!1;return document.addEventListener("keydown",h,{capture:!0}),()=>{document.removeEventListener("keydown",h,{capture:!0}),document.removeEventListener("pointerdown",m,{capture:!0}),document.removeEventListener("pointermove",m,{capture:!0})}},[]),b.jsx(MO,{...s,children:b.jsx(BL,{scope:e,open:n,onOpenChange:d,content:u,onContentChange:c,children:b.jsx(jL,{scope:e,onClose:C.useCallback(()=>d(!1),[d]),isUsingKeyboardRef:l,dir:f,modal:a,children:r})})})};dS.displayName=Vc;var UL="MenuAnchor",Cy=C.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t,o=mh(n);return b.jsx(v_,{...o,...r,ref:e})});Cy.displayName=UL;var _y="MenuPortal",[WL,fS]=Ca(_y,{forceMount:void 0}),hS=t=>{const{__scopeMenu:e,forceMount:n,children:r,container:o}=t,i=_a(_y,e);return b.jsx(WL,{scope:e,forceMount:n,children:b.jsx(Pi,{present:n||i.open,children:b.jsx(ny,{asChild:!0,container:o,children:r})})})};hS.displayName=_y;var Gn="MenuContent",[$L,Sy]=Ca(Gn),pS=C.forwardRef((t,e)=>{const n=fS(Gn,t.__scopeMenu),{forceMount:r=n.forceMount,...o}=t,i=_a(Gn,t.__scopeMenu),a=Hc(Gn,t.__scopeMenu);return b.jsx(yc.Provider,{scope:t.__scopeMenu,children:b.jsx(Pi,{present:r||i.open,children:b.jsx(yc.Slot,{scope:t.__scopeMenu,children:a.modal?b.jsx(zL,{...o,ref:e}):b.jsx(VL,{...o,ref:e})})})})}),zL=C.forwardRef((t,e)=>{const n=_a(Gn,t.__scopeMenu),r=C.useRef(null),o=At(e,r);return C.useEffect(()=>{const i=r.current;if(i)return XF(i)},[]),b.jsx(ky,{...t,ref:o,trapFocus:n.open,disableOutsidePointerEvents:n.open,disableOutsideScroll:!0,onFocusOutside:me(t.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>n.onOpenChange(!1)})}),VL=C.forwardRef((t,e)=>{const n=_a(Gn,t.__scopeMenu);return b.jsx(ky,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>n.onOpenChange(!1)})}),HL=dc("MenuContent.ScrollLock"),ky=C.forwardRef((t,e)=>{const{__scopeMenu:n,loop:r=!1,trapFocus:o,onOpenAutoFocus:i,onCloseAutoFocus:a,disableOutsidePointerEvents:s,onEntryFocus:u,onEscapeKeyDown:c,onPointerDownOutside:l,onFocusOutside:d,onInteractOutside:f,onDismiss:h,disableOutsideScroll:m,...p}=t,g=_a(Gn,n),v=Hc(Gn,n),y=mh(n),x=lS(n),w=FL(n),[E,_]=C.useState(null),S=C.useRef(null),k=At(e,S,g.onContentChange),I=C.useRef(0),R=C.useRef(""),D=C.useRef(0),A=C.useRef(null),j=C.useRef("right"),F=C.useRef(0),W=m?sS:C.Fragment,U=m?{as:HL,allowPinchZoom:!0}:void 0,$=P=>{var Z,se;const B=R.current+P,G=w().filter(re=>!re.disabled),q=document.activeElement,J=(Z=G.find(re=>re.ref.current===q))==null?void 0:Z.textValue,H=G.map(re=>re.textValue),Q=rB(H,B,J),ne=(se=G.find(re=>re.textValue===Q))==null?void 0:se.ref.current;(function re(xe){R.current=xe,window.clearTimeout(I.current),xe!==""&&(I.current=window.setTimeout(()=>re(""),1e3))})(B),ne&&setTimeout(()=>ne.focus())};C.useEffect(()=>()=>window.clearTimeout(I.current),[]),RF();const M=C.useCallback(P=>{var G,q;return j.current===((G=A.current)==null?void 0:G.side)&&iB(P,(q=A.current)==null?void 0:q.area)},[]);return b.jsx($L,{scope:n,searchRef:R,onItemEnter:C.useCallback(P=>{M(P)&&P.preventDefault()},[M]),onItemLeave:C.useCallback(P=>{var B;M(P)||((B=S.current)==null||B.focus(),_(null))},[M]),onTriggerLeave:C.useCallback(P=>{M(P)&&P.preventDefault()},[M]),pointerGraceTimerRef:D,onPointerGraceIntentChange:C.useCallback(P=>{A.current=P},[]),children:b.jsx(W,{...U,children:b.jsx(H_,{asChild:!0,trapped:o,onMountAutoFocus:me(i,P=>{var B;P.preventDefault(),(B=S.current)==null||B.focus({preventScroll:!0})}),onUnmountAutoFocus:a,children:b.jsx(Jf,{asChild:!0,disableOutsidePointerEvents:s,onEscapeKeyDown:c,onPointerDownOutside:l,onFocusOutside:d,onInteractOutside:f,onDismiss:h,children:b.jsx(J_,{asChild:!0,...x,dir:v.dir,orientation:"vertical",loop:r,currentTabStopId:E,onCurrentTabStopIdChange:_,onEntryFocus:me(u,P=>{v.isUsingKeyboardRef.current||P.preventDefault()}),preventScrollOnEntryFocus:!0,children:b.jsx(g_,{role:"menu","aria-orientation":"vertical","data-state":NS(g.open),"data-radix-menu-content":"",dir:v.dir,...y,...p,ref:k,style:{outline:"none",...p.style},onKeyDown:me(p.onKeyDown,P=>{const G=P.target.closest("[data-radix-menu-content]")===P.currentTarget,q=P.ctrlKey||P.altKey||P.metaKey,J=P.key.length===1;G&&(P.key==="Tab"&&P.preventDefault(),!q&&J&&$(P.key));const H=S.current;if(P.target!==H||!DL.includes(P.key))return;P.preventDefault();const ne=w().filter(Z=>!Z.disabled).map(Z=>Z.ref.current);uS.includes(P.key)&&ne.reverse(),tB(ne)}),onBlur:me(t.onBlur,P=>{P.currentTarget.contains(P.target)||(window.clearTimeout(I.current),R.current="")}),onPointerMove:me(t.onPointerMove,xc(P=>{const B=P.target,G=F.current!==P.clientX;if(P.currentTarget.contains(B)&&G){const q=P.clientX>F.current?"right":"left";j.current=q,F.current=P.clientX}}))})})})})})})});pS.displayName=Gn;var GL="MenuGroup",Iy=C.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t;return b.jsx(je.div,{role:"group",...r,ref:e})});Iy.displayName=GL;var KL="MenuLabel",mS=C.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t;return b.jsx(je.div,{...r,ref:e})});mS.displayName=KL;var nf="MenuItem",uw="menu.itemSelect",vh=C.forwardRef((t,e)=>{const{disabled:n=!1,onSelect:r,...o}=t,i=C.useRef(null),a=Hc(nf,t.__scopeMenu),s=Sy(nf,t.__scopeMenu),u=At(e,i),c=C.useRef(!1),l=()=>{const d=i.current;if(!n&&d){const f=new CustomEvent(uw,{bubbles:!0,cancelable:!0});d.addEventListener(uw,h=>r==null?void 0:r(h),{once:!0}),ty(d,f),f.defaultPrevented?c.current=!1:a.onClose()}};return b.jsx(vS,{...o,ref:u,disabled:n,onClick:me(t.onClick,l),onPointerDown:d=>{var f;(f=t.onPointerDown)==null||f.call(t,d),c.current=!0},onPointerUp:me(t.onPointerUp,d=>{var f;c.current||(f=d.currentTarget)==null||f.click()}),onKeyDown:me(t.onKeyDown,d=>{const f=s.searchRef.current!=="";n||f&&d.key===" "||Ev.includes(d.key)&&(d.currentTarget.click(),d.preventDefault())})})});vh.displayName=nf;var vS=C.forwardRef((t,e)=>{const{__scopeMenu:n,disabled:r=!1,textValue:o,...i}=t,a=Sy(nf,n),s=lS(n),u=C.useRef(null),c=At(e,u),[l,d]=C.useState(!1),[f,h]=C.useState("");return C.useEffect(()=>{const m=u.current;m&&h((m.textContent??"").trim())},[i.children]),b.jsx(yc.ItemSlot,{scope:n,disabled:r,textValue:o??f,children:b.jsx(Z_,{asChild:!0,...s,focusable:!r,children:b.jsx(je.div,{role:"menuitem","data-highlighted":l?"":void 0,"aria-disabled":r||void 0,"data-disabled":r?"":void 0,...i,ref:c,onPointerMove:me(t.onPointerMove,xc(m=>{r?a.onItemLeave(m):(a.onItemEnter(m),m.defaultPrevented||m.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:me(t.onPointerLeave,xc(m=>a.onItemLeave(m))),onFocus:me(t.onFocus,()=>d(!0)),onBlur:me(t.onBlur,()=>d(!1))})})})}),qL="MenuCheckboxItem",gS=C.forwardRef((t,e)=>{const{checked:n=!1,onCheckedChange:r,...o}=t;return b.jsx(ES,{scope:t.__scopeMenu,checked:n,children:b.jsx(vh,{role:"menuitemcheckbox","aria-checked":rf(n)?"mixed":n,...o,ref:e,"data-state":Ty(n),onSelect:me(o.onSelect,()=>r==null?void 0:r(rf(n)?!0:!n),{checkForDefaultPrevented:!1})})})});gS.displayName=qL;var yS="MenuRadioGroup",[XL,YL]=Ca(yS,{value:void 0,onValueChange:()=>{}}),xS=C.forwardRef((t,e)=>{const{value:n,onValueChange:r,...o}=t,i=yn(r);return b.jsx(XL,{scope:t.__scopeMenu,value:n,onValueChange:i,children:b.jsx(Iy,{...o,ref:e})})});xS.displayName=yS;var wS="MenuRadioItem",bS=C.forwardRef((t,e)=>{const{value:n,...r}=t,o=YL(wS,t.__scopeMenu),i=n===o.value;return b.jsx(ES,{scope:t.__scopeMenu,checked:i,children:b.jsx(vh,{role:"menuitemradio","aria-checked":i,...r,ref:e,"data-state":Ty(i),onSelect:me(r.onSelect,()=>{var a;return(a=o.onValueChange)==null?void 0:a.call(o,n)},{checkForDefaultPrevented:!1})})})});bS.displayName=wS;var Ry="MenuItemIndicator",[ES,QL]=Ca(Ry,{checked:!1}),CS=C.forwardRef((t,e)=>{const{__scopeMenu:n,forceMount:r,...o}=t,i=QL(Ry,n);return b.jsx(Pi,{present:r||rf(i.checked)||i.checked===!0,children:b.jsx(je.span,{...o,ref:e,"data-state":Ty(i.checked)})})});CS.displayName=Ry;var JL="MenuSeparator",_S=C.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t;return b.jsx(je.div,{role:"separator","aria-orientation":"horizontal",...r,ref:e})});_S.displayName=JL;var ZL="MenuArrow",SS=C.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t,o=mh(n);return b.jsx(y_,{...o,...r,ref:e})});SS.displayName=ZL;var eB="MenuSub",[AK,kS]=Ca(eB),Nu="MenuSubTrigger",IS=C.forwardRef((t,e)=>{const n=_a(Nu,t.__scopeMenu),r=Hc(Nu,t.__scopeMenu),o=kS(Nu,t.__scopeMenu),i=Sy(Nu,t.__scopeMenu),a=C.useRef(null),{pointerGraceTimerRef:s,onPointerGraceIntentChange:u}=i,c={__scopeMenu:t.__scopeMenu},l=C.useCallback(()=>{a.current&&window.clearTimeout(a.current),a.current=null},[]);return C.useEffect(()=>l,[l]),C.useEffect(()=>{const d=s.current;return()=>{window.clearTimeout(d),u(null)}},[s,u]),b.jsx(Cy,{asChild:!0,...c,children:b.jsx(vS,{id:o.triggerId,"aria-haspopup":"menu","aria-expanded":n.open,"aria-controls":o.contentId,"data-state":NS(n.open),...t,ref:Qf(e,o.onTriggerChange),onClick:d=>{var f;(f=t.onClick)==null||f.call(t,d),!(t.disabled||d.defaultPrevented)&&(d.currentTarget.focus(),n.open||n.onOpenChange(!0))},onPointerMove:me(t.onPointerMove,xc(d=>{i.onItemEnter(d),!d.defaultPrevented&&!t.disabled&&!n.open&&!a.current&&(i.onPointerGraceIntentChange(null),a.current=window.setTimeout(()=>{n.onOpenChange(!0),l()},100))})),onPointerLeave:me(t.onPointerLeave,xc(d=>{var h,m;l();const f=(h=n.content)==null?void 0:h.getBoundingClientRect();if(f){const p=(m=n.content)==null?void 0:m.dataset.side,g=p==="right",v=g?-5:5,y=f[g?"left":"right"],x=f[g?"right":"left"];i.onPointerGraceIntentChange({area:[{x:d.clientX+v,y:d.clientY},{x:y,y:f.top},{x,y:f.top},{x,y:f.bottom},{x:y,y:f.bottom}],side:p}),window.clearTimeout(s.current),s.current=window.setTimeout(()=>i.onPointerGraceIntentChange(null),300)}else{if(i.onTriggerLeave(d),d.defaultPrevented)return;i.onPointerGraceIntentChange(null)}})),onKeyDown:me(t.onKeyDown,d=>{var h;const f=i.searchRef.current!=="";t.disabled||f&&d.key===" "||ML[r.dir].includes(d.key)&&(n.onOpenChange(!0),(h=n.content)==null||h.focus(),d.preventDefault())})})})});IS.displayName=Nu;var RS="MenuSubContent",TS=C.forwardRef((t,e)=>{const n=fS(Gn,t.__scopeMenu),{forceMount:r=n.forceMount,...o}=t,i=_a(Gn,t.__scopeMenu),a=Hc(Gn,t.__scopeMenu),s=kS(RS,t.__scopeMenu),u=C.useRef(null),c=At(e,u);return b.jsx(yc.Provider,{scope:t.__scopeMenu,children:b.jsx(Pi,{present:r||i.open,children:b.jsx(yc.Slot,{scope:t.__scopeMenu,children:b.jsx(ky,{id:s.contentId,"aria-labelledby":s.triggerId,...o,ref:c,align:"start",side:a.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:l=>{var d;a.isUsingKeyboardRef.current&&((d=u.current)==null||d.focus()),l.preventDefault()},onCloseAutoFocus:l=>l.preventDefault(),onFocusOutside:me(t.onFocusOutside,l=>{l.target!==s.trigger&&i.onOpenChange(!1)}),onEscapeKeyDown:me(t.onEscapeKeyDown,l=>{a.onClose(),l.preventDefault()}),onKeyDown:me(t.onKeyDown,l=>{var h;const d=l.currentTarget.contains(l.target),f=OL[a.dir].includes(l.key);d&&f&&(i.onOpenChange(!1),(h=s.trigger)==null||h.focus(),l.preventDefault())})})})})})});TS.displayName=RS;function NS(t){return t?"open":"closed"}function rf(t){return t==="indeterminate"}function Ty(t){return rf(t)?"indeterminate":t?"checked":"unchecked"}function tB(t){const e=document.activeElement;for(const n of t)if(n===e||(n.focus(),document.activeElement!==e))return}function nB(t,e){return t.map((n,r)=>t[(e+r)%t.length])}function rB(t,e,n){const o=e.length>1&&Array.from(e).every(c=>c===e[0])?e[0]:e,i=n?t.indexOf(n):-1;let a=nB(t,Math.max(i,0));o.length===1&&(a=a.filter(c=>c!==n));const u=a.find(c=>c.toLowerCase().startsWith(o.toLowerCase()));return u!==n?u:void 0}function oB(t,e){const{x:n,y:r}=t;let o=!1;for(let i=0,a=e.length-1;i<e.length;a=i++){const s=e[i],u=e[a],c=s.x,l=s.y,d=u.x,f=u.y;l>r!=f>r&&n<(d-c)*(r-l)/(f-l)+c&&(o=!o)}return o}function iB(t,e){if(!e)return!1;const n={x:t.clientX,y:t.clientY};return oB(n,e)}function xc(t){return e=>e.pointerType==="mouse"?t(e):void 0}var aB=dS,sB=Cy,uB=hS,cB=pS,lB=Iy,dB=mS,fB=vh,hB=gS,pB=xS,mB=bS,vB=CS,gB=_S,yB=SS,xB=IS,wB=TS,gh="DropdownMenu",[bB,PK]=So(gh,[cS]),sn=cS(),[EB,AS]=bB(gh),PS=t=>{const{__scopeDropdownMenu:e,children:n,dir:r,open:o,defaultOpen:i,onOpenChange:a,modal:s=!0}=t,u=sn(e),c=C.useRef(null),[l,d]=Zf({prop:o,defaultProp:i??!1,onChange:a,caller:gh});return b.jsx(EB,{scope:e,triggerId:qd(),triggerRef:c,contentId:qd(),open:l,onOpenChange:d,onOpenToggle:C.useCallback(()=>d(f=>!f),[d]),modal:s,children:b.jsx(aB,{...u,open:l,onOpenChange:d,dir:r,modal:s,children:n})})};PS.displayName=gh;var DS="DropdownMenuTrigger",MS=C.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,disabled:r=!1,...o}=t,i=AS(DS,n),a=sn(n);return b.jsx(sB,{asChild:!0,...a,children:b.jsx(je.button,{type:"button",id:i.triggerId,"aria-haspopup":"menu","aria-expanded":i.open,"aria-controls":i.open?i.contentId:void 0,"data-state":i.open?"open":"closed","data-disabled":r?"":void 0,disabled:r,...o,ref:Qf(e,i.triggerRef),onPointerDown:me(t.onPointerDown,s=>{!r&&s.button===0&&s.ctrlKey===!1&&(i.onOpenToggle(),i.open||s.preventDefault())}),onKeyDown:me(t.onKeyDown,s=>{r||(["Enter"," "].includes(s.key)&&i.onOpenToggle(),s.key==="ArrowDown"&&i.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(s.key)&&s.preventDefault())})})})});MS.displayName=DS;var CB="DropdownMenuPortal",OS=t=>{const{__scopeDropdownMenu:e,...n}=t,r=sn(e);return b.jsx(uB,{...r,...n})};OS.displayName=CB;var FS="DropdownMenuContent",LS=C.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,o=AS(FS,n),i=sn(n),a=C.useRef(!1);return b.jsx(cB,{id:o.contentId,"aria-labelledby":o.triggerId,...i,...r,ref:e,onCloseAutoFocus:me(t.onCloseAutoFocus,s=>{var u;a.current||(u=o.triggerRef.current)==null||u.focus(),a.current=!1,s.preventDefault()}),onInteractOutside:me(t.onInteractOutside,s=>{const u=s.detail.originalEvent,c=u.button===0&&u.ctrlKey===!0,l=u.button===2||c;(!o.modal||l)&&(a.current=!0)}),style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});LS.displayName=FS;var _B="DropdownMenuGroup",SB=C.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,o=sn(n);return b.jsx(lB,{...o,...r,ref:e})});SB.displayName=_B;var kB="DropdownMenuLabel",BS=C.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,o=sn(n);return b.jsx(dB,{...o,...r,ref:e})});BS.displayName=kB;var IB="DropdownMenuItem",jS=C.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,o=sn(n);return b.jsx(fB,{...o,...r,ref:e})});jS.displayName=IB;var RB="DropdownMenuCheckboxItem",US=C.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,o=sn(n);return b.jsx(hB,{...o,...r,ref:e})});US.displayName=RB;var TB="DropdownMenuRadioGroup",NB=C.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,o=sn(n);return b.jsx(pB,{...o,...r,ref:e})});NB.displayName=TB;var AB="DropdownMenuRadioItem",WS=C.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,o=sn(n);return b.jsx(mB,{...o,...r,ref:e})});WS.displayName=AB;var PB="DropdownMenuItemIndicator",$S=C.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,o=sn(n);return b.jsx(vB,{...o,...r,ref:e})});$S.displayName=PB;var DB="DropdownMenuSeparator",zS=C.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,o=sn(n);return b.jsx(gB,{...o,...r,ref:e})});zS.displayName=DB;var MB="DropdownMenuArrow",OB=C.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,o=sn(n);return b.jsx(yB,{...o,...r,ref:e})});OB.displayName=MB;var FB="DropdownMenuSubTrigger",VS=C.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,o=sn(n);return b.jsx(xB,{...o,...r,ref:e})});VS.displayName=FB;var LB="DropdownMenuSubContent",HS=C.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,o=sn(n);return b.jsx(wB,{...o,...r,ref:e,style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});HS.displayName=LB;var BB=PS,jB=MS,UB=OS,GS=LS,KS=BS,qS=jS,XS=US,YS=WS,QS=$S,JS=zS,ZS=VS,ek=HS;const WB=BB,$B=jB,zB=C.forwardRef(({className:t,inset:e,children:n,...r},o)=>b.jsxs(ZS,{ref:o,className:we("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[state=open]:bg-accent focus:bg-accent",e&&"pl-8",t),...r,children:[n,b.jsx(FD,{className:"ml-auto h-4 w-4"})]}));zB.displayName=ZS.displayName;const VB=C.forwardRef(({className:t,...e},n)=>b.jsx(ek,{ref:n,className:we("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...e}));VB.displayName=ek.displayName;const tk=C.forwardRef(({className:t,sideOffset:e=4,...n},r)=>b.jsx(UB,{children:b.jsx(GS,{ref:r,sideOffset:e,className:we("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...n})}));tk.displayName=GS.displayName;const Cv=C.forwardRef(({className:t,inset:e,...n},r)=>b.jsx(qS,{ref:r,className:we("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",e&&"pl-8",t),...n}));Cv.displayName=qS.displayName;const HB=C.forwardRef(({className:t,children:e,checked:n,...r},o)=>b.jsxs(XS,{ref:o,className:we("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",t),checked:n,...r,children:[b.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:b.jsx(QS,{children:b.jsx(MD,{className:"h-4 w-4"})})}),e]}));HB.displayName=XS.displayName;const GB=C.forwardRef(({className:t,children:e,...n},r)=>b.jsxs(YS,{ref:r,className:we("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",t),...n,children:[b.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:b.jsx(QS,{children:b.jsx(jD,{className:"h-2 w-2 fill-current"})})}),e]}));GB.displayName=YS.displayName;const nk=C.forwardRef(({className:t,inset:e,...n},r)=>b.jsx(KS,{ref:r,className:we("px-2 py-1.5 text-sm font-semibold",e&&"pl-8",t),...n}));nk.displayName=KS.displayName;const rk=C.forwardRef(({className:t,...e},n)=>b.jsx(JS,{ref:n,className:we("-mx-1 my-1 h-px bg-muted",t),...e}));rk.displayName=JS.displayName;var ok={exports:{}},ik={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Hs=C;function KB(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var qB=typeof Object.is=="function"?Object.is:KB,XB=Hs.useState,YB=Hs.useEffect,QB=Hs.useLayoutEffect,JB=Hs.useDebugValue;function ZB(t,e){var n=e(),r=XB({inst:{value:n,getSnapshot:e}}),o=r[0].inst,i=r[1];return QB(function(){o.value=n,o.getSnapshot=e,Np(o)&&i({inst:o})},[t,n,e]),YB(function(){return Np(o)&&i({inst:o}),t(function(){Np(o)&&i({inst:o})})},[t]),JB(n),n}function Np(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!qB(t,n)}catch{return!0}}function ej(t,e){return e()}var tj=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?ej:ZB;ik.useSyncExternalStore=Hs.useSyncExternalStore!==void 0?Hs.useSyncExternalStore:tj;ok.exports=ik;var nj=ok.exports;function rj(){return nj.useSyncExternalStore(oj,()=>!0,()=>!1)}function oj(){return()=>{}}var Ny="Avatar",[ij,DK]=So(Ny),[aj,ak]=ij(Ny),sk=C.forwardRef((t,e)=>{const{__scopeAvatar:n,...r}=t,[o,i]=C.useState("idle");return b.jsx(aj,{scope:n,imageLoadingStatus:o,onImageLoadingStatusChange:i,children:b.jsx(je.span,{...r,ref:e})})});sk.displayName=Ny;var uk="AvatarImage",ck=C.forwardRef((t,e)=>{const{__scopeAvatar:n,src:r,onLoadingStatusChange:o=()=>{},...i}=t,a=ak(uk,n),s=sj(r,i),u=yn(c=>{o(c),a.onImageLoadingStatusChange(c)});return Xn(()=>{s!=="idle"&&u(s)},[s,u]),s==="loaded"?b.jsx(je.img,{...i,ref:e,src:r}):null});ck.displayName=uk;var lk="AvatarFallback",dk=C.forwardRef((t,e)=>{const{__scopeAvatar:n,delayMs:r,...o}=t,i=ak(lk,n),[a,s]=C.useState(r===void 0);return C.useEffect(()=>{if(r!==void 0){const u=window.setTimeout(()=>s(!0),r);return()=>window.clearTimeout(u)}},[r]),a&&i.imageLoadingStatus!=="loaded"?b.jsx(je.span,{...o,ref:e}):null});dk.displayName=lk;function cw(t,e){return t?e?(t.src!==e&&(t.src=e),t.complete&&t.naturalWidth>0?"loaded":"loading"):"error":"idle"}function sj(t,{referrerPolicy:e,crossOrigin:n}){const r=rj(),o=C.useRef(null),i=r?(o.current||(o.current=new window.Image),o.current):null,[a,s]=C.useState(()=>cw(i,t));return Xn(()=>{s(cw(i,t))},[i,t]),Xn(()=>{const u=d=>()=>{s(d)};if(!i)return;const c=u("loaded"),l=u("error");return i.addEventListener("load",c),i.addEventListener("error",l),e&&(i.referrerPolicy=e),typeof n=="string"&&(i.crossOrigin=n),()=>{i.removeEventListener("load",c),i.removeEventListener("error",l)}},[i,n,e]),a}var fk=sk,hk=ck,pk=dk;const mk=C.forwardRef(({className:t,...e},n)=>b.jsx(fk,{ref:n,className:we("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",t),...e}));mk.displayName=fk.displayName;const uj=C.forwardRef(({className:t,...e},n)=>b.jsx(hk,{ref:n,className:we("aspect-square h-full w-full",t),...e}));uj.displayName=hk.displayName;const vk=C.forwardRef(({className:t,...e},n)=>b.jsx(pk,{ref:n,className:we("flex h-full w-full items-center justify-center rounded-full bg-muted",t),...e}));vk.displayName=pk.displayName;const cj=()=>{};var lw={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gk=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let o=t.charCodeAt(r);o<128?e[n++]=o:o<2048?(e[n++]=o>>6|192,e[n++]=o&63|128):(o&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(o=65536+((o&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=o>>18|240,e[n++]=o>>12&63|128,e[n++]=o>>6&63|128,e[n++]=o&63|128):(e[n++]=o>>12|224,e[n++]=o>>6&63|128,e[n++]=o&63|128)}return e},lj=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const o=t[n++];if(o<128)e[r++]=String.fromCharCode(o);else if(o>191&&o<224){const i=t[n++];e[r++]=String.fromCharCode((o&31)<<6|i&63)}else if(o>239&&o<365){const i=t[n++],a=t[n++],s=t[n++],u=((o&7)<<18|(i&63)<<12|(a&63)<<6|s&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{const i=t[n++],a=t[n++];e[r++]=String.fromCharCode((o&15)<<12|(i&63)<<6|a&63)}}return e.join("")},yk={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let o=0;o<t.length;o+=3){const i=t[o],a=o+1<t.length,s=a?t[o+1]:0,u=o+2<t.length,c=u?t[o+2]:0,l=i>>2,d=(i&3)<<4|s>>4;let f=(s&15)<<2|c>>6,h=c&63;u||(h=64,a||(f=64)),r.push(n[l],n[d],n[f],n[h])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(gk(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):lj(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let o=0;o<t.length;){const i=n[t.charAt(o++)],s=o<t.length?n[t.charAt(o)]:0;++o;const c=o<t.length?n[t.charAt(o)]:64;++o;const d=o<t.length?n[t.charAt(o)]:64;if(++o,i==null||s==null||c==null||d==null)throw new dj;const f=i<<2|s>>4;if(r.push(f),c!==64){const h=s<<4&240|c>>2;if(r.push(h),d!==64){const m=c<<6&192|d;r.push(m)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class dj extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const fj=function(t){const e=gk(t);return yk.encodeByteArray(e,!0)},xk=function(t){return fj(t).replace(/\./g,"")},wk=function(t){try{return yk.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hj(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pj=()=>hj().__FIREBASE_DEFAULTS__,mj=()=>{if(typeof process>"u"||typeof lw>"u")return;const t=lw.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},vj=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&wk(t[1]);return e&&JSON.parse(e)},Ay=()=>{try{return cj()||pj()||mj()||vj()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},gj=t=>{var e,n;return(n=(e=Ay())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},bk=()=>{var t;return(t=Ay())===null||t===void 0?void 0:t.config},Ek=t=>{var e;return(e=Ay())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yj{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yh(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function xj(t){return(await fetch(t,{credentials:"include"})).ok}const zu={};function wj(){const t={prod:[],emulator:[]};for(const e of Object.keys(zu))zu[e]?t.emulator.push(e):t.prod.push(e);return t}function bj(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let dw=!1;function Ej(t,e){if(typeof window>"u"||typeof document>"u"||!yh(window.location.host)||zu[t]===e||zu[t]||dw)return;zu[t]=e;function n(f){return`__firebase__banner__${f}`}const r="__firebase__banner",i=wj().prod.length>0;function a(){const f=document.getElementById(r);f&&f.remove()}function s(f){f.style.display="flex",f.style.background="#7faaf0",f.style.position="fixed",f.style.bottom="5px",f.style.left="5px",f.style.padding=".5em",f.style.borderRadius="5px",f.style.alignItems="center"}function u(f,h){f.setAttribute("width","24"),f.setAttribute("id",h),f.setAttribute("height","24"),f.setAttribute("viewBox","0 0 24 24"),f.setAttribute("fill","none"),f.style.marginLeft="-6px"}function c(){const f=document.createElement("span");return f.style.cursor="pointer",f.style.marginLeft="16px",f.style.fontSize="24px",f.innerHTML=" &times;",f.onclick=()=>{dw=!0,a()},f}function l(f,h){f.setAttribute("id",h),f.innerText="Learn more",f.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",f.setAttribute("target","__blank"),f.style.paddingLeft="5px",f.style.textDecoration="underline"}function d(){const f=bj(r),h=n("text"),m=document.getElementById(h)||document.createElement("span"),p=n("learnmore"),g=document.getElementById(p)||document.createElement("a"),v=n("preprendIcon"),y=document.getElementById(v)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(f.created){const x=f.element;s(x),l(g,p);const w=c();u(y,v),x.append(y,m,g,w),document.body.appendChild(x)}i?(m.innerText="Preview backend disconnected.",y.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(y.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,m.innerText="Preview backend running in this workspace."),m.setAttribute("id",h)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",d):d()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Cj(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(rn())}function _j(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Sj(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function kj(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Ij(){const t=rn();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function Rj(){try{return typeof indexedDB=="object"}catch{return!1}}function Tj(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",o=self.indexedDB.open(r);o.onsuccess=()=>{o.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},o.onupgradeneeded=()=>{n=!1},o.onerror=()=>{var i;e(((i=o.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nj="FirebaseError";class ko extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=Nj,Object.setPrototypeOf(this,ko.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Gc.prototype.create)}}class Gc{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},o=`${this.service}/${e}`,i=this.errors[e],a=i?Aj(i,r):"Error",s=`${this.serviceName}: ${a} (${o}).`;return new ko(o,s,r)}}function Aj(t,e){return t.replace(Pj,(n,r)=>{const o=e[r];return o!=null?String(o):`<${r}?>`})}const Pj=/\{\$([^}]+)}/g;function Dj(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Gs(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const o of n){if(!r.includes(o))return!1;const i=t[o],a=e[o];if(fw(i)&&fw(a)){if(!Gs(i,a))return!1}else if(i!==a)return!1}for(const o of r)if(!n.includes(o))return!1;return!0}function fw(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kc(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(o=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(o))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Au(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[o,i]=r.split("=");e[decodeURIComponent(o)]=decodeURIComponent(i)}}),e}function Pu(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function Mj(t,e){const n=new Oj(t,e);return n.subscribe.bind(n)}class Oj{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let o;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");Fj(e,["next","error","complete"])?o=e:o={next:e,error:n,complete:r},o.next===void 0&&(o.next=Ap),o.error===void 0&&(o.error=Ap),o.complete===void 0&&(o.complete=Ap);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?o.error(this.finalError):o.complete()}catch{}}),this.observers.push(o),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Fj(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function Ap(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xr(t){return t&&t._delegate?t._delegate:t}class Ks{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vi="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lj{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new yj;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const o=this.getOrInitializeService({instanceIdentifier:n});o&&r.resolve(o)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),o=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(o)return null;throw i}else{if(o)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(jj(e))try{this.getOrInitializeService({instanceIdentifier:Vi})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:o});r.resolve(i)}catch{}}}}clearInstance(e=Vi){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Vi){return this.instances.has(e)}getOptions(e=Vi){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const o=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,a]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(i);r===s&&a.resolve(o)}return o}onInit(e,n){var r;const o=this.normalizeInstanceIdentifier(n),i=(r=this.onInitCallbacks.get(o))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(o,i);const a=this.instances.get(o);return a&&e(a,o),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const o of r)try{o(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:Bj(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Vi){return this.component?this.component.multipleInstances?e:Vi:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Bj(t){return t===Vi?void 0:t}function jj(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uj{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new Lj(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ve;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Ve||(Ve={}));const Wj={debug:Ve.DEBUG,verbose:Ve.VERBOSE,info:Ve.INFO,warn:Ve.WARN,error:Ve.ERROR,silent:Ve.SILENT},$j=Ve.INFO,zj={[Ve.DEBUG]:"log",[Ve.VERBOSE]:"log",[Ve.INFO]:"info",[Ve.WARN]:"warn",[Ve.ERROR]:"error"},Vj=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),o=zj[e];if(o)console[o](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Ck{constructor(e){this.name=e,this._logLevel=$j,this._logHandler=Vj,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ve))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Wj[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ve.DEBUG,...e),this._logHandler(this,Ve.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ve.VERBOSE,...e),this._logHandler(this,Ve.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ve.INFO,...e),this._logHandler(this,Ve.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ve.WARN,...e),this._logHandler(this,Ve.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ve.ERROR,...e),this._logHandler(this,Ve.ERROR,...e)}}const Hj=(t,e)=>e.some(n=>t instanceof n);let hw,pw;function Gj(){return hw||(hw=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Kj(){return pw||(pw=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const _k=new WeakMap,_v=new WeakMap,Sk=new WeakMap,Pp=new WeakMap,Py=new WeakMap;function qj(t){const e=new Promise((n,r)=>{const o=()=>{t.removeEventListener("success",i),t.removeEventListener("error",a)},i=()=>{n(yi(t.result)),o()},a=()=>{r(t.error),o()};t.addEventListener("success",i),t.addEventListener("error",a)});return e.then(n=>{n instanceof IDBCursor&&_k.set(n,t)}).catch(()=>{}),Py.set(e,t),e}function Xj(t){if(_v.has(t))return;const e=new Promise((n,r)=>{const o=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",a),t.removeEventListener("abort",a)},i=()=>{n(),o()},a=()=>{r(t.error||new DOMException("AbortError","AbortError")),o()};t.addEventListener("complete",i),t.addEventListener("error",a),t.addEventListener("abort",a)});_v.set(t,e)}let Sv={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return _v.get(t);if(e==="objectStoreNames")return t.objectStoreNames||Sk.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return yi(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function Yj(t){Sv=t(Sv)}function Qj(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(Dp(this),e,...n);return Sk.set(r,e.sort?e.sort():[e]),yi(r)}:Kj().includes(t)?function(...e){return t.apply(Dp(this),e),yi(_k.get(this))}:function(...e){return yi(t.apply(Dp(this),e))}}function Jj(t){return typeof t=="function"?Qj(t):(t instanceof IDBTransaction&&Xj(t),Hj(t,Gj())?new Proxy(t,Sv):t)}function yi(t){if(t instanceof IDBRequest)return qj(t);if(Pp.has(t))return Pp.get(t);const e=Jj(t);return e!==t&&(Pp.set(t,e),Py.set(e,t)),e}const Dp=t=>Py.get(t);function Zj(t,e,{blocked:n,upgrade:r,blocking:o,terminated:i}={}){const a=indexedDB.open(t,e),s=yi(a);return r&&a.addEventListener("upgradeneeded",u=>{r(yi(a.result),u.oldVersion,u.newVersion,yi(a.transaction),u)}),n&&a.addEventListener("blocked",u=>n(u.oldVersion,u.newVersion,u)),s.then(u=>{i&&u.addEventListener("close",()=>i()),o&&u.addEventListener("versionchange",c=>o(c.oldVersion,c.newVersion,c))}).catch(()=>{}),s}const e5=["get","getKey","getAll","getAllKeys","count"],t5=["put","add","delete","clear"],Mp=new Map;function mw(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Mp.get(e))return Mp.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,o=t5.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(o||e5.includes(n)))return;const i=async function(a,...s){const u=this.transaction(a,o?"readwrite":"readonly");let c=u.store;return r&&(c=c.index(s.shift())),(await Promise.all([c[n](...s),o&&u.done]))[0]};return Mp.set(e,i),i}Yj(t=>({...t,get:(e,n,r)=>mw(e,n)||t.get(e,n,r),has:(e,n)=>!!mw(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n5{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(r5(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function r5(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const kv="@firebase/app",vw="0.13.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Eo=new Ck("@firebase/app"),o5="@firebase/app-compat",i5="@firebase/analytics-compat",a5="@firebase/analytics",s5="@firebase/app-check-compat",u5="@firebase/app-check",c5="@firebase/auth",l5="@firebase/auth-compat",d5="@firebase/database",f5="@firebase/data-connect",h5="@firebase/database-compat",p5="@firebase/functions",m5="@firebase/functions-compat",v5="@firebase/installations",g5="@firebase/installations-compat",y5="@firebase/messaging",x5="@firebase/messaging-compat",w5="@firebase/performance",b5="@firebase/performance-compat",E5="@firebase/remote-config",C5="@firebase/remote-config-compat",_5="@firebase/storage",S5="@firebase/storage-compat",k5="@firebase/firestore",I5="@firebase/ai",R5="@firebase/firestore-compat",T5="firebase",N5="11.10.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Iv="[DEFAULT]",A5={[kv]:"fire-core",[o5]:"fire-core-compat",[a5]:"fire-analytics",[i5]:"fire-analytics-compat",[u5]:"fire-app-check",[s5]:"fire-app-check-compat",[c5]:"fire-auth",[l5]:"fire-auth-compat",[d5]:"fire-rtdb",[f5]:"fire-data-connect",[h5]:"fire-rtdb-compat",[p5]:"fire-fn",[m5]:"fire-fn-compat",[v5]:"fire-iid",[g5]:"fire-iid-compat",[y5]:"fire-fcm",[x5]:"fire-fcm-compat",[w5]:"fire-perf",[b5]:"fire-perf-compat",[E5]:"fire-rc",[C5]:"fire-rc-compat",[_5]:"fire-gcs",[S5]:"fire-gcs-compat",[k5]:"fire-fst",[R5]:"fire-fst-compat",[I5]:"fire-vertex","fire-js":"fire-js",[T5]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const of=new Map,P5=new Map,Rv=new Map;function gw(t,e){try{t.container.addComponent(e)}catch(n){Eo.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function wc(t){const e=t.name;if(Rv.has(e))return Eo.debug(`There were multiple attempts to register component ${e}.`),!1;Rv.set(e,t);for(const n of of.values())gw(n,t);for(const n of P5.values())gw(n,t);return!0}function kk(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function dr(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D5={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},xi=new Gc("app","Firebase",D5);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M5{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Ks("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw xi.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qc=N5;function Ik(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:Iv,automaticDataCollectionEnabled:!0},e),o=r.name;if(typeof o!="string"||!o)throw xi.create("bad-app-name",{appName:String(o)});if(n||(n=bk()),!n)throw xi.create("no-options");const i=of.get(o);if(i){if(Gs(n,i.options)&&Gs(r,i.config))return i;throw xi.create("duplicate-app",{appName:o})}const a=new Uj(o);for(const u of Rv.values())a.addComponent(u);const s=new M5(n,r,a);return of.set(o,s),s}function O5(t=Iv){const e=of.get(t);if(!e&&t===Iv&&bk())return Ik();if(!e)throw xi.create("no-app",{appName:t});return e}function ps(t,e,n){var r;let o=(r=A5[t])!==null&&r!==void 0?r:t;n&&(o+=`-${n}`);const i=o.match(/\s|\//),a=e.match(/\s|\//);if(i||a){const s=[`Unable to register library "${o}" with version "${e}":`];i&&s.push(`library name "${o}" contains illegal characters (whitespace or "/")`),i&&a&&s.push("and"),a&&s.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Eo.warn(s.join(" "));return}wc(new Ks(`${o}-version`,()=>({library:o,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F5="firebase-heartbeat-database",L5=1,bc="firebase-heartbeat-store";let Op=null;function Rk(){return Op||(Op=Zj(F5,L5,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(bc)}catch(n){console.warn(n)}}}}).catch(t=>{throw xi.create("idb-open",{originalErrorMessage:t.message})})),Op}async function B5(t){try{const n=(await Rk()).transaction(bc),r=await n.objectStore(bc).get(Tk(t));return await n.done,r}catch(e){if(e instanceof ko)Eo.warn(e.message);else{const n=xi.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Eo.warn(n.message)}}}async function yw(t,e){try{const r=(await Rk()).transaction(bc,"readwrite");await r.objectStore(bc).put(e,Tk(t)),await r.done}catch(n){if(n instanceof ko)Eo.warn(n.message);else{const r=xi.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Eo.warn(r.message)}}}function Tk(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j5=1024,U5=30;class W5{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new z5(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const o=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=xw();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(a=>a.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:o}),this._heartbeatsCache.heartbeats.length>U5){const a=V5(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(a,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){Eo.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=xw(),{heartbeatsToSend:r,unsentEntries:o}=$5(this._heartbeatsCache.heartbeats),i=xk(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,o.length>0?(this._heartbeatsCache.heartbeats=o,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return Eo.warn(n),""}}}function xw(){return new Date().toISOString().substring(0,10)}function $5(t,e=j5){const n=[];let r=t.slice();for(const o of t){const i=n.find(a=>a.agent===o.agent);if(i){if(i.dates.push(o.date),ww(n)>e){i.dates.pop();break}}else if(n.push({agent:o.agent,dates:[o.date]}),ww(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class z5{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Rj()?Tj().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await B5(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const o=await this.read();return yw(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:o.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const o=await this.read();return yw(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:o.lastSentHeartbeatDate,heartbeats:[...o.heartbeats,...e.heartbeats]})}else return}}function ww(t){return xk(JSON.stringify({version:2,heartbeats:t})).length}function V5(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function H5(t){wc(new Ks("platform-logger",e=>new n5(e),"PRIVATE")),wc(new Ks("heartbeat",e=>new W5(e),"PRIVATE")),ps(kv,vw,t),ps(kv,vw,"esm2017"),ps("fire-js","")}H5("");function Nk(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const G5=Nk,Ak=new Gc("auth","Firebase",Nk());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const af=new Ck("@firebase/auth");function K5(t,...e){af.logLevel<=Ve.WARN&&af.warn(`Auth (${qc}): ${t}`,...e)}function gd(t,...e){af.logLevel<=Ve.ERROR&&af.error(`Auth (${qc}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wr(t,...e){throw Dy(t,...e)}function Wr(t,...e){return Dy(t,...e)}function Pk(t,e,n){const r=Object.assign(Object.assign({},G5()),{[e]:n});return new Gc("auth","Firebase",r).create(e,{appName:t.name})}function mo(t){return Pk(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Dy(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return Ak.create(t,...e)}function ge(t,e,...n){if(!t)throw Dy(e,...n)}function fo(t){const e="INTERNAL ASSERTION FAILED: "+t;throw gd(e),new Error(e)}function Co(t,e){t||fo(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tv(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function q5(){return bw()==="http:"||bw()==="https:"}function bw(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function X5(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(q5()||Sj()||"connection"in navigator)?navigator.onLine:!0}function Y5(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xc{constructor(e,n){this.shortDelay=e,this.longDelay=n,Co(n>e,"Short delay should be less than long delay!"),this.isMobile=Cj()||kj()}get(){return X5()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function My(t,e){Co(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dk{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;fo("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;fo("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;fo("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q5={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J5=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],Z5=new Xc(3e4,6e4);function Mi(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function Io(t,e,n,r,o={}){return Mk(t,o,async()=>{let i={},a={};r&&(e==="GET"?a=r:i={body:JSON.stringify(r)});const s=Kc(Object.assign({key:t.config.apiKey},a)).slice(1),u=await t._getAdditionalHeaders();u["Content-Type"]="application/json",t.languageCode&&(u["X-Firebase-Locale"]=t.languageCode);const c=Object.assign({method:e,headers:u},i);return _j()||(c.referrerPolicy="no-referrer"),t.emulatorConfig&&yh(t.emulatorConfig.host)&&(c.credentials="include"),Dk.fetch()(await Ok(t,t.config.apiHost,n,s),c)})}async function Mk(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},Q5),e);try{const o=new t6(t),i=await Promise.race([n(),o.promise]);o.clearNetworkTimeout();const a=await i.json();if("needConfirmation"in a)throw Ll(t,"account-exists-with-different-credential",a);if(i.ok&&!("errorMessage"in a))return a;{const s=i.ok?a.errorMessage:a.error.message,[u,c]=s.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw Ll(t,"credential-already-in-use",a);if(u==="EMAIL_EXISTS")throw Ll(t,"email-already-in-use",a);if(u==="USER_DISABLED")throw Ll(t,"user-disabled",a);const l=r[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw Pk(t,l,c);wr(t,l)}}catch(o){if(o instanceof ko)throw o;wr(t,"network-request-failed",{message:String(o)})}}async function Yc(t,e,n,r,o={}){const i=await Io(t,e,n,r,o);return"mfaPendingCredential"in i&&wr(t,"multi-factor-auth-required",{_serverResponse:i}),i}async function Ok(t,e,n,r){const o=`${e}${n}?${r}`,i=t,a=i.config.emulator?My(t.config,o):`${t.config.apiScheme}://${o}`;return J5.includes(n)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(a).toString():a}function e6(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class t6{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(Wr(this.auth,"network-request-failed")),Z5.get())})}}function Ll(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const o=Wr(t,e,r);return o.customData._tokenResponse=n,o}function Ew(t){return t!==void 0&&t.enterprise!==void 0}class n6{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return e6(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function r6(t,e){return Io(t,"GET","/v2/recaptchaConfig",Mi(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function o6(t,e){return Io(t,"POST","/v1/accounts:delete",e)}async function sf(t,e){return Io(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vu(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function i6(t,e=!1){const n=Xr(t),r=await n.getIdToken(e),o=Oy(r);ge(o&&o.exp&&o.auth_time&&o.iat,n.auth,"internal-error");const i=typeof o.firebase=="object"?o.firebase:void 0,a=i==null?void 0:i.sign_in_provider;return{claims:o,token:r,authTime:Vu(Fp(o.auth_time)),issuedAtTime:Vu(Fp(o.iat)),expirationTime:Vu(Fp(o.exp)),signInProvider:a||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function Fp(t){return Number(t)*1e3}function Oy(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return gd("JWT malformed, contained fewer than 3 sections"),null;try{const o=wk(n);return o?JSON.parse(o):(gd("Failed to decode base64 JWT payload"),null)}catch(o){return gd("Caught error parsing JWT payload as JSON",o==null?void 0:o.toString()),null}}function Cw(t){const e=Oy(t);return ge(e,"internal-error"),ge(typeof e.exp<"u","internal-error"),ge(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qs(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof ko&&a6(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function a6({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s6{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const o=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,o)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nv{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Vu(this.lastLoginAt),this.creationTime=Vu(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uf(t){var e;const n=t.auth,r=await t.getIdToken(),o=await qs(t,sf(n,{idToken:r}));ge(o==null?void 0:o.users.length,n,"internal-error");const i=o.users[0];t._notifyReloadListener(i);const a=!((e=i.providerUserInfo)===null||e===void 0)&&e.length?Fk(i.providerUserInfo):[],s=c6(t.providerData,a),u=t.isAnonymous,c=!(t.email&&i.passwordHash)&&!(s!=null&&s.length),l=u?c:!1,d={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new Nv(i.createdAt,i.lastLoginAt),isAnonymous:l};Object.assign(t,d)}async function u6(t){const e=Xr(t);await uf(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function c6(t,e){return[...t.filter(r=>!e.some(o=>o.providerId===r.providerId)),...e]}function Fk(t){return t.map(e=>{var{providerId:n}=e,r=zc(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function l6(t,e){const n=await Mk(t,{},async()=>{const r=Kc({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:o,apiKey:i}=t.config,a=await Ok(t,o,"/v1/token",`key=${i}`),s=await t._getAdditionalHeaders();s["Content-Type"]="application/x-www-form-urlencoded";const u={method:"POST",headers:s,body:r};return t.emulatorConfig&&yh(t.emulatorConfig.host)&&(u.credentials="include"),Dk.fetch()(a,u)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function d6(t,e){return Io(t,"POST","/v2/accounts:revokeToken",Mi(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ms{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ge(e.idToken,"internal-error"),ge(typeof e.idToken<"u","internal-error"),ge(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Cw(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){ge(e.length!==0,"internal-error");const n=Cw(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(ge(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:o,expiresIn:i}=await l6(e,n);this.updateTokensAndExpiration(r,o,Number(i))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:o,expirationTime:i}=n,a=new ms;return r&&(ge(typeof r=="string","internal-error",{appName:e}),a.refreshToken=r),o&&(ge(typeof o=="string","internal-error",{appName:e}),a.accessToken=o),i&&(ge(typeof i=="number","internal-error",{appName:e}),a.expirationTime=i),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new ms,this.toJSON())}_performRefresh(){return fo("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uo(t,e){ge(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class fr{constructor(e){var{uid:n,auth:r,stsTokenManager:o}=e,i=zc(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new s6(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=o,this.accessToken=o.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new Nv(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const n=await qs(this,this.stsTokenManager.getToken(this.auth,e));return ge(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return i6(this,e)}reload(){return u6(this)}_assign(e){this!==e&&(ge(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new fr(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){ge(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await uf(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(dr(this.auth.app))return Promise.reject(mo(this.auth));const e=await this.getIdToken();return await qs(this,o6(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,o,i,a,s,u,c,l;const d=(r=n.displayName)!==null&&r!==void 0?r:void 0,f=(o=n.email)!==null&&o!==void 0?o:void 0,h=(i=n.phoneNumber)!==null&&i!==void 0?i:void 0,m=(a=n.photoURL)!==null&&a!==void 0?a:void 0,p=(s=n.tenantId)!==null&&s!==void 0?s:void 0,g=(u=n._redirectEventId)!==null&&u!==void 0?u:void 0,v=(c=n.createdAt)!==null&&c!==void 0?c:void 0,y=(l=n.lastLoginAt)!==null&&l!==void 0?l:void 0,{uid:x,emailVerified:w,isAnonymous:E,providerData:_,stsTokenManager:S}=n;ge(x&&S,e,"internal-error");const k=ms.fromJSON(this.name,S);ge(typeof x=="string",e,"internal-error"),Uo(d,e.name),Uo(f,e.name),ge(typeof w=="boolean",e,"internal-error"),ge(typeof E=="boolean",e,"internal-error"),Uo(h,e.name),Uo(m,e.name),Uo(p,e.name),Uo(g,e.name),Uo(v,e.name),Uo(y,e.name);const I=new fr({uid:x,auth:e,email:f,emailVerified:w,displayName:d,isAnonymous:E,photoURL:m,phoneNumber:h,tenantId:p,stsTokenManager:k,createdAt:v,lastLoginAt:y});return _&&Array.isArray(_)&&(I.providerData=_.map(R=>Object.assign({},R))),g&&(I._redirectEventId=g),I}static async _fromIdTokenResponse(e,n,r=!1){const o=new ms;o.updateFromServerResponse(n);const i=new fr({uid:n.localId,auth:e,stsTokenManager:o,isAnonymous:r});return await uf(i),i}static async _fromGetAccountInfoResponse(e,n,r){const o=n.users[0];ge(o.localId!==void 0,"internal-error");const i=o.providerUserInfo!==void 0?Fk(o.providerUserInfo):[],a=!(o.email&&o.passwordHash)&&!(i!=null&&i.length),s=new ms;s.updateFromIdToken(r);const u=new fr({uid:o.localId,auth:e,stsTokenManager:s,isAnonymous:a}),c={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:i,metadata:new Nv(o.createdAt,o.lastLoginAt),isAnonymous:!(o.email&&o.passwordHash)&&!(i!=null&&i.length)};return Object.assign(u,c),u}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _w=new Map;function ho(t){Co(t instanceof Function,"Expected a class definition");let e=_w.get(t);return e?(Co(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,_w.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lk{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}Lk.type="NONE";const Sw=Lk;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yd(t,e,n){return`firebase:${t}:${e}:${n}`}class vs{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:o,name:i}=this.auth;this.fullUserKey=yd(this.userKey,o.apiKey,i),this.fullPersistenceKey=yd("persistence",o.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await sf(this.auth,{idToken:e}).catch(()=>{});return n?fr._fromGetAccountInfoResponse(this.auth,n,e):null}return fr._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new vs(ho(Sw),e,r);const o=(await Promise.all(n.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let i=o[0]||ho(Sw);const a=yd(r,e.config.apiKey,e.name);let s=null;for(const c of n)try{const l=await c._get(a);if(l){let d;if(typeof l=="string"){const f=await sf(e,{idToken:l}).catch(()=>{});if(!f)break;d=await fr._fromGetAccountInfoResponse(e,f,l)}else d=fr._fromJSON(e,l);c!==i&&(s=d),i=c;break}}catch{}const u=o.filter(c=>c._shouldAllowMigration);return!i._shouldAllowMigration||!u.length?new vs(i,e,r):(i=u[0],s&&await i._set(a,s.toJSON()),await Promise.all(n.map(async c=>{if(c!==i)try{await c._remove(a)}catch{}})),new vs(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kw(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Wk(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Bk(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(zk(e))return"Blackberry";if(Vk(e))return"Webos";if(jk(e))return"Safari";if((e.includes("chrome/")||Uk(e))&&!e.includes("edge/"))return"Chrome";if($k(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function Bk(t=rn()){return/firefox\//i.test(t)}function jk(t=rn()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Uk(t=rn()){return/crios\//i.test(t)}function Wk(t=rn()){return/iemobile/i.test(t)}function $k(t=rn()){return/android/i.test(t)}function zk(t=rn()){return/blackberry/i.test(t)}function Vk(t=rn()){return/webos/i.test(t)}function Fy(t=rn()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function f6(t=rn()){var e;return Fy(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function h6(){return Ij()&&document.documentMode===10}function Hk(t=rn()){return Fy(t)||$k(t)||Vk(t)||zk(t)||/windows phone/i.test(t)||Wk(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gk(t,e=[]){let n;switch(t){case"Browser":n=kw(rn());break;case"Worker":n=`${kw(rn())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${qc}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p6{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=i=>new Promise((a,s)=>{try{const u=e(i);a(u)}catch(u){s(u)}});r.onAbort=n,this.queue.push(r);const o=this.queue.length-1;return()=>{this.queue[o]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const o of n)try{o()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function m6(t,e={}){return Io(t,"GET","/v2/passwordPolicy",Mi(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v6=6;class g6{constructor(e){var n,r,o,i;const a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=a.minPasswordLength)!==null&&n!==void 0?n:v6,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(o=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&o!==void 0?o:"",this.forceUpgradeOnSignin=(i=e.forceUpgradeOnSignin)!==null&&i!==void 0?i:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,o,i,a,s;const u={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,u),this.validatePasswordCharacterOptions(e,u),u.isValid&&(u.isValid=(n=u.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),u.isValid&&(u.isValid=(r=u.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),u.isValid&&(u.isValid=(o=u.containsLowercaseLetter)!==null&&o!==void 0?o:!0),u.isValid&&(u.isValid=(i=u.containsUppercaseLetter)!==null&&i!==void 0?i:!0),u.isValid&&(u.isValid=(a=u.containsNumericCharacter)!==null&&a!==void 0?a:!0),u.isValid&&(u.isValid=(s=u.containsNonAlphanumericCharacter)!==null&&s!==void 0?s:!0),u}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,o=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),o&&(n.meetsMaxPasswordLength=e.length<=o)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let o=0;o<e.length;o++)r=e.charAt(o),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,o,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=o)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y6{constructor(e,n,r,o){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=o,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Iw(this),this.idTokenSubscription=new Iw(this),this.beforeStateQueue=new p6(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Ak,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=o.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=ho(n)),this._initializationPromise=this.queue(async()=>{var r,o,i;if(!this._deleted&&(this.persistenceManager=await vs.create(this,e),(r=this._resolvePersistenceManagerAvailable)===null||r===void 0||r.call(this),!this._deleted)){if(!((o=this._popupRedirectResolver)===null||o===void 0)&&o._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await sf(this,{idToken:e}),r=await fr._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var n;if(dr(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(s=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(s,s))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let o=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,s=o==null?void 0:o._redirectEventId,u=await this.tryRedirectSignIn(e);(!a||a===s)&&(u!=null&&u.user)&&(o=u.user,i=!0)}if(!o)return this.directlySetCurrentUser(null);if(!o._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(o)}catch(a){o=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return o?this.reloadAndSetCurrentUserOrClear(o):this.directlySetCurrentUser(null)}return ge(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===o._redirectEventId?this.directlySetCurrentUser(o):this.reloadAndSetCurrentUserOrClear(o)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await uf(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=Y5()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(dr(this.app))return Promise.reject(mo(this));const n=e?Xr(e):null;return n&&ge(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&ge(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return dr(this.app)?Promise.reject(mo(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return dr(this.app)?Promise.reject(mo(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(ho(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await m6(this),n=new g6(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Gc("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await d6(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&ho(e)||this._popupRedirectResolver;ge(n,this,"argument-error"),this.redirectPersistenceManager=await vs.create(this,[ho(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,o){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n);let a=!1;const s=this._isInitialized?Promise.resolve():this._initializationPromise;if(ge(s,this,"internal-error"),s.then(()=>{a||i(this.currentUser)}),typeof n=="function"){const u=e.addObserver(n,r,o);return()=>{a=!0,u()}}else{const u=e.addObserver(n);return()=>{a=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ge(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Gk(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const o=await this._getAppCheckToken();return o&&(n["X-Firebase-AppCheck"]=o),n}async _getAppCheckToken(){var e;if(dr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&K5(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function Sa(t){return Xr(t)}class Iw{constructor(e){this.auth=e,this.observer=null,this.addObserver=Mj(n=>this.observer=n)}get next(){return ge(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let xh={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function x6(t){xh=t}function Kk(t){return xh.loadJS(t)}function w6(){return xh.recaptchaEnterpriseScript}function b6(){return xh.gapiScript}function E6(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class C6{constructor(){this.enterprise=new _6}ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class _6{ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}const S6="recaptcha-enterprise",qk="NO_RECAPTCHA";class k6{constructor(e){this.type=S6,this.auth=Sa(e)}async verify(e="verify",n=!1){async function r(i){if(!n){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(a,s)=>{r6(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(u=>{if(u.recaptchaKey===void 0)s(new Error("recaptcha Enterprise site key undefined"));else{const c=new n6(u);return i.tenantId==null?i._agentRecaptchaConfig=c:i._tenantRecaptchaConfigs[i.tenantId]=c,a(c.siteKey)}}).catch(u=>{s(u)})})}function o(i,a,s){const u=window.grecaptcha;Ew(u)?u.enterprise.ready(()=>{u.enterprise.execute(i,{action:e}).then(c=>{a(c)}).catch(()=>{a(qk)})}):s(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new C6().execute("siteKey",{action:"verify"}):new Promise((i,a)=>{r(this.auth).then(s=>{if(!n&&Ew(window.grecaptcha))o(s,i,a);else{if(typeof window>"u"){a(new Error("RecaptchaVerifier is only supported in browser"));return}let u=w6();u.length!==0&&(u+=s),Kk(u).then(()=>{o(s,i,a)}).catch(c=>{a(c)})}}).catch(s=>{a(s)})})}}async function Rw(t,e,n,r=!1,o=!1){const i=new k6(t);let a;if(o)a=qk;else try{a=await i.verify(n)}catch{a=await i.verify(n,!0)}const s=Object.assign({},e);if(n==="mfaSmsEnrollment"||n==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in s){const u=s.phoneEnrollmentInfo.phoneNumber,c=s.phoneEnrollmentInfo.recaptchaToken;Object.assign(s,{phoneEnrollmentInfo:{phoneNumber:u,recaptchaToken:c,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in s){const u=s.phoneSignInInfo.recaptchaToken;Object.assign(s,{phoneSignInInfo:{recaptchaToken:u,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return s}return r?Object.assign(s,{captchaResp:a}):Object.assign(s,{captchaResponse:a}),Object.assign(s,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(s,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),s}async function Av(t,e,n,r,o){var i;if(!((i=t._getRecaptchaConfig())===null||i===void 0)&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const a=await Rw(t,e,n,n==="getOobCode");return r(t,a)}else return r(t,e).catch(async a=>{if(a.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const s=await Rw(t,e,n,n==="getOobCode");return r(t,s)}else return Promise.reject(a)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I6(t,e){const n=kk(t,"auth");if(n.isInitialized()){const o=n.getImmediate(),i=n.getOptions();if(Gs(i,e??{}))return o;wr(o,"already-initialized")}return n.initialize({options:e})}function R6(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(ho);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function T6(t,e,n){const r=Sa(t);ge(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const o=!1,i=Xk(e),{host:a,port:s}=N6(e),u=s===null?"":`:${s}`,c={url:`${i}//${a}${u}/`},l=Object.freeze({host:a,port:s,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:o})});if(!r._canInitEmulator){ge(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),ge(Gs(c,r.config.emulator)&&Gs(l,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=c,r.emulatorConfig=l,r.settings.appVerificationDisabledForTesting=!0,yh(a)?(xj(`${i}//${a}${u}`),Ej("Auth",!0)):A6()}function Xk(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function N6(t){const e=Xk(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",o=/^(\[[^\]]+\])(:|$)/.exec(r);if(o){const i=o[1];return{host:i,port:Tw(r.substr(i.length+1))}}else{const[i,a]=r.split(":");return{host:i,port:Tw(a)}}}function Tw(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function A6(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ly{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return fo("not implemented")}_getIdTokenResponse(e){return fo("not implemented")}_linkToIdToken(e,n){return fo("not implemented")}_getReauthenticationResolver(e){return fo("not implemented")}}async function P6(t,e){return Io(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function D6(t,e){return Yc(t,"POST","/v1/accounts:signInWithPassword",Mi(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function M6(t,e){return Yc(t,"POST","/v1/accounts:signInWithEmailLink",Mi(t,e))}async function O6(t,e){return Yc(t,"POST","/v1/accounts:signInWithEmailLink",Mi(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ec extends Ly{constructor(e,n,r,o=null){super("password",r),this._email=e,this._password=n,this._tenantId=o}static _fromEmailAndPassword(e,n){return new Ec(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new Ec(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Av(e,n,"signInWithPassword",D6);case"emailLink":return M6(e,{email:this._email,oobCode:this._password});default:wr(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Av(e,r,"signUpPassword",P6);case"emailLink":return O6(e,{idToken:n,email:this._email,oobCode:this._password});default:wr(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gs(t,e){return Yc(t,"POST","/v1/accounts:signInWithIdp",Mi(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F6="http://localhost";class ma extends Ly{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new ma(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):wr("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:o}=n,i=zc(n,["providerId","signInMethod"]);if(!r||!o)return null;const a=new ma(r,o);return a.idToken=i.idToken||void 0,a.accessToken=i.accessToken||void 0,a.secret=i.secret,a.nonce=i.nonce,a.pendingToken=i.pendingToken||null,a}_getIdTokenResponse(e){const n=this.buildRequest();return gs(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,gs(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,gs(e,n)}buildRequest(){const e={requestUri:F6,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Kc(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function L6(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function B6(t){const e=Au(Pu(t)).link,n=e?Au(Pu(e)).deep_link_id:null,r=Au(Pu(t)).deep_link_id;return(r?Au(Pu(r)).link:null)||r||n||e||t}class By{constructor(e){var n,r,o,i,a,s;const u=Au(Pu(e)),c=(n=u.apiKey)!==null&&n!==void 0?n:null,l=(r=u.oobCode)!==null&&r!==void 0?r:null,d=L6((o=u.mode)!==null&&o!==void 0?o:null);ge(c&&l&&d,"argument-error"),this.apiKey=c,this.operation=d,this.code=l,this.continueUrl=(i=u.continueUrl)!==null&&i!==void 0?i:null,this.languageCode=(a=u.lang)!==null&&a!==void 0?a:null,this.tenantId=(s=u.tenantId)!==null&&s!==void 0?s:null}static parseLink(e){const n=B6(e);try{return new By(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uu{constructor(){this.providerId=uu.PROVIDER_ID}static credential(e,n){return Ec._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=By.parseLink(n);return ge(r,"argument-error"),Ec._fromEmailAndCode(e,r.code,r.tenantId)}}uu.PROVIDER_ID="password";uu.EMAIL_PASSWORD_SIGN_IN_METHOD="password";uu.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yk{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qc extends Yk{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xo extends Qc{constructor(){super("facebook.com")}static credential(e){return ma._fromParams({providerId:Xo.PROVIDER_ID,signInMethod:Xo.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Xo.credentialFromTaggedObject(e)}static credentialFromError(e){return Xo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Xo.credential(e.oauthAccessToken)}catch{return null}}}Xo.FACEBOOK_SIGN_IN_METHOD="facebook.com";Xo.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yo extends Qc{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return ma._fromParams({providerId:Yo.PROVIDER_ID,signInMethod:Yo.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Yo.credentialFromTaggedObject(e)}static credentialFromError(e){return Yo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return Yo.credential(n,r)}catch{return null}}}Yo.GOOGLE_SIGN_IN_METHOD="google.com";Yo.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qo extends Qc{constructor(){super("github.com")}static credential(e){return ma._fromParams({providerId:Qo.PROVIDER_ID,signInMethod:Qo.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Qo.credentialFromTaggedObject(e)}static credentialFromError(e){return Qo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Qo.credential(e.oauthAccessToken)}catch{return null}}}Qo.GITHUB_SIGN_IN_METHOD="github.com";Qo.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jo extends Qc{constructor(){super("twitter.com")}static credential(e,n){return ma._fromParams({providerId:Jo.PROVIDER_ID,signInMethod:Jo.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Jo.credentialFromTaggedObject(e)}static credentialFromError(e){return Jo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return Jo.credential(n,r)}catch{return null}}}Jo.TWITTER_SIGN_IN_METHOD="twitter.com";Jo.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function j6(t,e){return Yc(t,"POST","/v1/accounts:signUp",Mi(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class va{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,o=!1){const i=await fr._fromIdTokenResponse(e,r,o),a=Nw(r);return new va({user:i,providerId:a,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const o=Nw(r);return new va({user:e,providerId:o,_tokenResponse:r,operationType:n})}}function Nw(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cf extends ko{constructor(e,n,r,o){var i;super(n.code,n.message),this.operationType=r,this.user=o,Object.setPrototypeOf(this,cf.prototype),this.customData={appName:e.name,tenantId:(i=e.tenantId)!==null&&i!==void 0?i:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,o){return new cf(e,n,r,o)}}function Qk(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?cf._fromErrorAndOperation(t,i,e,r):i})}async function U6(t,e,n=!1){const r=await qs(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return va._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function W6(t,e,n=!1){const{auth:r}=t;if(dr(r.app))return Promise.reject(mo(r));const o="reauthenticate";try{const i=await qs(t,Qk(r,o,e,t),n);ge(i.idToken,r,"internal-error");const a=Oy(i.idToken);ge(a,r,"internal-error");const{sub:s}=a;return ge(t.uid===s,r,"user-mismatch"),va._forOperation(t,o,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&wr(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Jk(t,e,n=!1){if(dr(t.app))return Promise.reject(mo(t));const r="signIn",o=await Qk(t,r,e),i=await va._fromIdTokenResponse(t,r,o);return n||await t._updateCurrentUser(i.user),i}async function $6(t,e){return Jk(Sa(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Zk(t){const e=Sa(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function z6(t,e,n){if(dr(t.app))return Promise.reject(mo(t));const r=Sa(t),a=await Av(r,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",j6).catch(u=>{throw u.code==="auth/password-does-not-meet-requirements"&&Zk(t),u}),s=await va._fromIdTokenResponse(r,"signIn",a);return await r._updateCurrentUser(s.user),s}function V6(t,e,n){return dr(t.app)?Promise.reject(mo(t)):$6(Xr(t),uu.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&Zk(t),r})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function H6(t,e){return Io(t,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function G6(t,{displayName:e,photoURL:n}){if(e===void 0&&n===void 0)return;const r=Xr(t),i={idToken:await r.getIdToken(),displayName:e,photoUrl:n,returnSecureToken:!0},a=await qs(r,H6(r.auth,i));r.displayName=a.displayName||null,r.photoURL=a.photoUrl||null;const s=r.providerData.find(({providerId:u})=>u==="password");s&&(s.displayName=r.displayName,s.photoURL=r.photoURL),await r._updateTokensIfNecessary(a)}function K6(t,e,n,r){return Xr(t).onIdTokenChanged(e,n,r)}function q6(t,e,n){return Xr(t).beforeAuthStateChanged(e,n)}function X6(t,e,n,r){return Xr(t).onAuthStateChanged(e,n,r)}function Y6(t){return Xr(t).signOut()}const lf="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eI{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(lf,"1"),this.storage.removeItem(lf),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q6=1e3,J6=10;class tI extends eI{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Hk(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),o=this.localCache[n];r!==o&&e(n,o,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((a,s,u)=>{this.notifyListeners(a,u)});return}const r=e.key;n?this.detachListener():this.stopPolling();const o=()=>{const a=this.storage.getItem(r);!n&&this.localCache[r]===a||this.notifyListeners(r,a)},i=this.storage.getItem(r);h6()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(o,J6):o()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const o of Array.from(r))o(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},Q6)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}tI.type="LOCAL";const Z6=tI;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nI extends eI{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}nI.type="SESSION";const rI=nI;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e8(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wh{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(o=>o.isListeningto(e));if(n)return n;const r=new wh(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:o,data:i}=n.data,a=this.handlersMap[o];if(!(a!=null&&a.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:o});const s=Array.from(a).map(async c=>c(n.origin,i)),u=await e8(s);n.ports[0].postMessage({status:"done",eventId:r,eventType:o,response:u})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}wh.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jy(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t8{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const o=typeof MessageChannel<"u"?new MessageChannel:null;if(!o)throw new Error("connection_unavailable");let i,a;return new Promise((s,u)=>{const c=jy("",20);o.port1.start();const l=setTimeout(()=>{u(new Error("unsupported_event"))},r);a={messageChannel:o,onMessage(d){const f=d;if(f.data.eventId===c)switch(f.data.status){case"ack":clearTimeout(l),i=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),s(f.data.response);break;default:clearTimeout(l),clearTimeout(i),u(new Error("invalid_response"));break}}},this.handlers.add(a),o.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:c,data:n},[o.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $r(){return window}function n8(t){$r().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oI(){return typeof $r().WorkerGlobalScope<"u"&&typeof $r().importScripts=="function"}async function r8(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function o8(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function i8(){return oI()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iI="firebaseLocalStorageDb",a8=1,df="firebaseLocalStorage",aI="fbase_key";class Jc{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function bh(t,e){return t.transaction([df],e?"readwrite":"readonly").objectStore(df)}function s8(){const t=indexedDB.deleteDatabase(iI);return new Jc(t).toPromise()}function Pv(){const t=indexedDB.open(iI,a8);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(df,{keyPath:aI})}catch(o){n(o)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(df)?e(r):(r.close(),await s8(),e(await Pv()))})})}async function Aw(t,e,n){const r=bh(t,!0).put({[aI]:e,value:n});return new Jc(r).toPromise()}async function u8(t,e){const n=bh(t,!1).get(e),r=await new Jc(n).toPromise();return r===void 0?null:r.value}function Pw(t,e){const n=bh(t,!0).delete(e);return new Jc(n).toPromise()}const c8=800,l8=3;class sI{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Pv(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>l8)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return oI()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=wh._getInstance(i8()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await r8(),!this.activeServiceWorker)return;this.sender=new t8(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((n=r[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||o8()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Pv();return await Aw(e,lf,"1"),await Pw(e,lf),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>Aw(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>u8(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>Pw(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(o=>{const i=bh(o,!1).getAll();return new Jc(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:o,value:i}of e)r.add(o),JSON.stringify(this.localCache[o])!==JSON.stringify(i)&&(this.notifyListeners(o,i),n.push(o));for(const o of Object.keys(this.localCache))this.localCache[o]&&!r.has(o)&&(this.notifyListeners(o,null),n.push(o));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const o of Array.from(r))o(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),c8)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}sI.type="LOCAL";const d8=sI;new Xc(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function f8(t,e){return e?ho(e):(ge(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uy extends Ly{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return gs(e,this._buildIdpRequest())}_linkToIdToken(e,n){return gs(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return gs(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function h8(t){return Jk(t.auth,new Uy(t),t.bypassAuthState)}function p8(t){const{auth:e,user:n}=t;return ge(n,e,"internal-error"),W6(n,new Uy(t),t.bypassAuthState)}async function m8(t){const{auth:e,user:n}=t;return ge(n,e,"internal-error"),U6(n,new Uy(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uI{constructor(e,n,r,o,i=!1){this.auth=e,this.resolver=r,this.user=o,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:o,tenantId:i,error:a,type:s}=e;if(a){this.reject(a);return}const u={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:o||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(s)(u))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return h8;case"linkViaPopup":case"linkViaRedirect":return m8;case"reauthViaPopup":case"reauthViaRedirect":return p8;default:wr(this.auth,"internal-error")}}resolve(e){Co(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Co(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v8=new Xc(2e3,1e4);class os extends uI{constructor(e,n,r,o,i){super(e,n,o,i),this.provider=r,this.authWindow=null,this.pollId=null,os.currentPopupAction&&os.currentPopupAction.cancel(),os.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ge(e,this.auth,"internal-error"),e}async onExecution(){Co(this.filter.length===1,"Popup operations only handle one event");const e=jy();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Wr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Wr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,os.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Wr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,v8.get())};e()}}os.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g8="pendingRedirect",xd=new Map;class y8 extends uI{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=xd.get(this.auth._key());if(!e){try{const r=await x8(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}xd.set(this.auth._key(),e)}return this.bypassAuthState||xd.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function x8(t,e){const n=E8(e),r=b8(t);if(!await r._isAvailable())return!1;const o=await r._get(n)==="true";return await r._remove(n),o}function w8(t,e){xd.set(t._key(),e)}function b8(t){return ho(t._redirectPersistence)}function E8(t){return yd(g8,t.config.apiKey,t.name)}async function C8(t,e,n=!1){if(dr(t.app))return Promise.reject(mo(t));const r=Sa(t),o=f8(r,e),a=await new y8(r,o,n).execute();return a&&!n&&(delete a.user._redirectEventId,await r._persistUserIfCurrent(a.user),await r._setRedirectUser(null,e)),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _8=10*60*1e3;class S8{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!k8(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!cI(e)){const o=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(Wr(this.auth,o))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=_8&&this.cachedEventUids.clear(),this.cachedEventUids.has(Dw(e))}saveEventToCache(e){this.cachedEventUids.add(Dw(e)),this.lastProcessedEventTime=Date.now()}}function Dw(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function cI({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function k8(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return cI(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function I8(t,e={}){return Io(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R8=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,T8=/^https?/;async function N8(t){if(t.config.emulator)return;const{authorizedDomains:e}=await I8(t);for(const n of e)try{if(A8(n))return}catch{}wr(t,"unauthorized-domain")}function A8(t){const e=Tv(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const a=new URL(t);return a.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&a.hostname===r}if(!T8.test(n))return!1;if(R8.test(t))return r===t;const o=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+o+"|"+o+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P8=new Xc(3e4,6e4);function Mw(){const t=$r().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function D8(t){return new Promise((e,n)=>{var r,o,i;function a(){Mw(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Mw(),n(Wr(t,"network-request-failed"))},timeout:P8.get()})}if(!((o=(r=$r().gapi)===null||r===void 0?void 0:r.iframes)===null||o===void 0)&&o.Iframe)e(gapi.iframes.getContext());else if(!((i=$r().gapi)===null||i===void 0)&&i.load)a();else{const s=E6("iframefcb");return $r()[s]=()=>{gapi.load?a():n(Wr(t,"network-request-failed"))},Kk(`${b6()}?onload=${s}`).catch(u=>n(u))}}).catch(e=>{throw wd=null,e})}let wd=null;function M8(t){return wd=wd||D8(t),wd}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O8=new Xc(5e3,15e3),F8="__/auth/iframe",L8="emulator/auth/iframe",B8={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},j8=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function U8(t){const e=t.config;ge(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?My(e,L8):`https://${t.config.authDomain}/${F8}`,r={apiKey:e.apiKey,appName:t.name,v:qc},o=j8.get(t.config.apiHost);o&&(r.eid=o);const i=t._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${Kc(r).slice(1)}`}async function W8(t){const e=await M8(t),n=$r().gapi;return ge(n,t,"internal-error"),e.open({where:document.body,url:U8(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:B8,dontclear:!0},r=>new Promise(async(o,i)=>{await r.restyle({setHideOnLeave:!1});const a=Wr(t,"network-request-failed"),s=$r().setTimeout(()=>{i(a)},O8.get());function u(){$r().clearTimeout(s),o(r)}r.ping(u).then(u,()=>{i(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $8={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},z8=500,V8=600,H8="_blank",G8="http://localhost";class Ow{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function K8(t,e,n,r=z8,o=V8){const i=Math.max((window.screen.availHeight-o)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString();let s="";const u=Object.assign(Object.assign({},$8),{width:r.toString(),height:o.toString(),top:i,left:a}),c=rn().toLowerCase();n&&(s=Uk(c)?H8:n),Bk(c)&&(e=e||G8,u.scrollbars="yes");const l=Object.entries(u).reduce((f,[h,m])=>`${f}${h}=${m},`,"");if(f6(c)&&s!=="_self")return q8(e||"",s),new Ow(null);const d=window.open(e||"",s,l);ge(d,t,"popup-blocked");try{d.focus()}catch{}return new Ow(d)}function q8(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X8="__/auth/handler",Y8="emulator/auth/handler",Q8=encodeURIComponent("fac");async function Fw(t,e,n,r,o,i){ge(t.config.authDomain,t,"auth-domain-config-required"),ge(t.config.apiKey,t,"invalid-api-key");const a={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:qc,eventId:o};if(e instanceof Yk){e.setDefaultLanguage(t.languageCode),a.providerId=e.providerId||"",Dj(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[l,d]of Object.entries({}))a[l]=d}if(e instanceof Qc){const l=e.getScopes().filter(d=>d!=="");l.length>0&&(a.scopes=l.join(","))}t.tenantId&&(a.tid=t.tenantId);const s=a;for(const l of Object.keys(s))s[l]===void 0&&delete s[l];const u=await t._getAppCheckToken(),c=u?`#${Q8}=${encodeURIComponent(u)}`:"";return`${J8(t)}?${Kc(s).slice(1)}${c}`}function J8({config:t}){return t.emulator?My(t,Y8):`https://${t.authDomain}/${X8}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lp="webStorageSupport";class Z8{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=rI,this._completeRedirectFn=C8,this._overrideRedirectResult=w8}async _openPopup(e,n,r,o){var i;Co((i=this.eventManagers[e._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const a=await Fw(e,n,r,Tv(),o);return K8(e,a,jy())}async _openRedirect(e,n,r,o){await this._originValidation(e);const i=await Fw(e,n,r,Tv(),o);return n8(i),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:o,promise:i}=this.eventManagers[n];return o?Promise.resolve(o):(Co(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await W8(e),r=new S8(e);return n.register("authEvent",o=>(ge(o==null?void 0:o.authEvent,e,"invalid-auth-event"),{status:r.onEvent(o.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Lp,{type:Lp},o=>{var i;const a=(i=o==null?void 0:o[0])===null||i===void 0?void 0:i[Lp];a!==void 0&&n(!!a),wr(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=N8(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return Hk()||jk()||Fy()}}const eU=Z8;var Lw="@firebase/auth",Bw="1.10.8";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tU{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){ge(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nU(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function rU(t){wc(new Ks("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),o=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:a,authDomain:s}=r.options;ge(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});const u={apiKey:a,authDomain:s,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Gk(t)},c=new y6(r,o,i,u);return R6(c,n),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),wc(new Ks("auth-internal",e=>{const n=Sa(e.getProvider("auth").getImmediate());return(r=>new tU(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),ps(Lw,Bw,nU(t)),ps(Lw,Bw,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oU=5*60,iU=Ek("authIdTokenMaxAge")||oU;let jw=null;const aU=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>iU)return;const o=n==null?void 0:n.token;jw!==o&&(jw=o,await fetch(t,{method:o?"POST":"DELETE",headers:o?{Authorization:`Bearer ${o}`}:{}}))};function sU(t=O5()){const e=kk(t,"auth");if(e.isInitialized())return e.getImmediate();const n=I6(t,{popupRedirectResolver:eU,persistence:[d8,Z6,rI]}),r=Ek("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const a=aU(i.toString());q6(n,a,()=>a(n.currentUser)),K6(n,s=>a(s))}}const o=gj("auth");return o&&T6(n,`http://${o}`),n}function uU(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}x6({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=o=>{const i=Wr("internal-error");i.customData=o,n(i)},r.type="text/javascript",r.charset="UTF-8",uU().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});rU("Browser");var cU="firebase",lU="11.10.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ps(cU,lU,"app");const dU={apiKey:"",authDomain:"",projectId:"",storageBucket:"",messagingSenderId:"",appId:""},fU=Ik(dU),Bl=sU(fU),lI=C.createContext(void 0),Uw=t=>{if(t instanceof ko){const e=t.code;if(e==="auth/invalid-credential"||e==="auth/invalid-email"||e==="auth/user-not-found")return"";if(e==="auth/email-already-in-use")return"";if(e==="auth/weak-password")return" 6 ";if(e==="auth/too-many-requests")return" "}return" "},hU=({children:t})=>{const[e,n]=C.useState(null),[r,o]=C.useState(!0),[i,a]=C.useState(!1),[s,u]=C.useState(null);C.useEffect(()=>X6(Bl,p=>{n(p),o(!1)}),[]);const c=async(m,p)=>{a(!0),u(null);try{await V6(Bl,m,p)}catch(g){throw u(Uw(g)),g}finally{a(!1)}},l=async({email:m,password:p,displayName:g})=>{a(!0),u(null);try{const v=await z6(Bl,m,p);g&&await G6(v.user,{displayName:g})}catch(v){throw u(Uw(v)),v}finally{a(!1)}},d=async()=>{u(null),await Y6(Bl)},f=()=>u(null),h=C.useMemo(()=>({user:e,initializing:r,authLoading:i,authError:s,signIn:c,signUp:l,signOutUser:d,resetAuthError:f}),[e,r,i,s]);return b.jsx(lI.Provider,{value:h,children:t})},dI=()=>{const t=C.useContext(lI);if(!t)throw new Error("useAuth must be used within an AuthProvider");return t},pU="/assets/%E0%B8%99%E0%B9%89%E0%B8%AD%E0%B8%87%E0%B8%9B%E0%B8%A5%E0%B8%B2%E0%B8%97%E0%B8%B9-elIqDDwR.png",Xs=()=>{var m;const[t,e]=C.useState(!1),[n,r]=C.useState(!1),o=Ea(),i=Wc(),{toast:a}=Zg(),{user:s,initializing:u,signOutUser:c}=dI();C.useEffect(()=>{const p=()=>{e(window.scrollY>20)};return window.addEventListener("scroll",p),()=>window.removeEventListener("scroll",p)},[]);const l=[{to:"/",label:"",labelEn:"Home",icon:zD},{to:"/places",label:"",labelEn:"Places",icon:Ws},{to:"/chat",label:" NongPlatoo",labelEn:"Chat",icon:Kd}],d=o.pathname==="/",f=`?redirect=${encodeURIComponent(o.pathname)}`,h=async()=>{try{await c(),a({title:"",description:""}),o.pathname==="/auth"&&i("/")}catch{a({variant:"destructive",title:"",description:""})}};return b.jsxs("nav",{className:we("fixed top-0 left-0 right-0 z-50 transition-all duration-300",t||!d?"bg-card/95 backdrop-blur-md shadow-soft":"bg-transparent"),children:[b.jsx("div",{className:"container mx-auto px-4",children:b.jsxs("div",{className:"flex items-center justify-between h-16",children:[b.jsxs(dn,{to:"/",className:"flex items-center gap-2",children:[b.jsx("img",{src:pU,alt:"NongPlatoo Logo",className:"w-10 h-10 rounded-xl object-cover"}),b.jsx("span",{className:we("font-display font-semibold text-lg hidden sm:block transition-colors",t||!d?"text-foreground":"text-primary-foreground"),children:"NongPlatoo.Ai"})]}),b.jsxs("div",{className:"hidden md:flex items-center gap-1",children:[l.map(p=>b.jsx(dn,{to:p.to,children:b.jsxs(De,{variant:"ghost",className:we("gap-2 transition-colors",o.pathname===p.to?t||!d?"bg-primary/10 text-primary":"bg-primary-foreground/20 text-primary-foreground":t||!d?"text-foreground hover:text-primary hover:bg-primary/5":"text-primary-foreground/80 hover:text-primary-foreground hover:bg-primary-foreground/10"),children:[b.jsx(p.icon,{className:"w-4 h-4"}),b.jsx("span",{className:"font-thai",children:p.label})]})},p.to)),!u&&(s?b.jsxs(WB,{children:[b.jsx($B,{asChild:!0,children:b.jsxs(De,{variant:"outline",className:"ml-2 pl-2 pr-3 gap-3 border-primary/30 text-foreground hover:text-primary hover:border-primary/60",children:[b.jsx(mk,{className:"h-8 w-8 bg-primary/15 text-primary",children:b.jsx(vk,{children:(s.displayName||s.email||"NP").slice(0,2).toUpperCase()})}),b.jsxs("div",{className:"text-left leading-tight hidden lg:block",children:[b.jsx("p",{className:"text-xs text-muted-foreground",children:""}),b.jsx("p",{className:"font-medium",children:s.displayName||((m=s.email)==null?void 0:m.split("@")[0])||""})]})]})}),b.jsxs(tk,{align:"end",className:"w-48",children:[b.jsx(nk,{children:""}),b.jsxs(Cv,{onClick:()=>i(`/auth${f}`),className:"cursor-pointer",children:[b.jsx(BC,{className:"w-4 h-4 mr-2"}),""]}),b.jsx(rk,{}),b.jsxs(Cv,{onClick:h,className:"cursor-pointer text-destructive",children:[b.jsx(gx,{className:"w-4 h-4 mr-2"}),""]})]})]}):b.jsx(dn,{to:`/auth${f}`,children:b.jsxs(De,{className:"ml-2 gap-2 bg-gradient-river text-primary-foreground shadow-soft hover:opacity-90",children:[b.jsx(vx,{className:"w-4 h-4"}),b.jsx("span",{className:"font-thai",children:""})]})}))]}),b.jsx(De,{variant:"ghost",size:"icon",className:we("md:hidden",t||!d?"text-foreground":"text-primary-foreground"),onClick:()=>r(!n),children:n?b.jsx(rh,{}):b.jsx(VD,{})})]})}),n&&b.jsx("div",{className:"md:hidden bg-card/95 backdrop-blur-md border-t border-border animate-fade-in",children:b.jsxs("div",{className:"container mx-auto px-4 py-4 space-y-2",children:[l.map(p=>b.jsx(dn,{to:p.to,onClick:()=>r(!1),children:b.jsxs(De,{variant:"ghost",className:we("w-full justify-start gap-3",o.pathname===p.to?"bg-primary/10 text-primary":"text-foreground"),children:[b.jsx(p.icon,{className:"w-5 h-5"}),b.jsx("span",{className:"font-thai",children:p.label}),b.jsxs("span",{className:"text-muted-foreground text-sm",children:["(",p.labelEn,")"]})]})},p.to)),!u&&b.jsx("div",{className:"pt-2 flex gap-2",children:s?b.jsxs(De,{variant:"outline",className:"w-full justify-center gap-2",onClick:()=>{h(),r(!1)},children:[b.jsx(gx,{className:"w-4 h-4"}),""]}):b.jsx(dn,{to:`/auth${f}`,className:"w-full",onClick:()=>r(!1),children:b.jsxs(De,{className:"w-full justify-center gap-2 bg-gradient-river text-primary-foreground",children:[b.jsx(vx,{className:"w-4 h-4"}),""]})})})]})})]})},mU=({title:t,titleTh:e,description:n,image:r,category:o,className:i})=>b.jsx(dn,{to:`/places?category=${o}`,className:we("group block card-hover",i),children:b.jsxs("div",{className:"relative overflow-hidden rounded-2xl bg-card shadow-card",children:[b.jsx("div",{className:"aspect-square overflow-hidden",children:b.jsx("img",{src:r,alt:t,className:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-110"})}),b.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-foreground/80 via-foreground/20 to-transparent"}),b.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-5",children:[b.jsx("h3",{className:"font-display text-xl font-semibold text-primary-foreground mb-1",children:e}),b.jsx("p",{className:"text-primary-foreground/80 text-sm mb-2",children:t}),b.jsx("p",{className:"text-primary-foreground/60 text-xs line-clamp-2",children:n})]}),b.jsx("div",{className:"absolute inset-0 bg-primary/20 opacity-0 group-hover:opacity-100 transition-opacity duration-300"})]})}),vU="/assets/%E0%B8%9B%E0%B8%81%E0%B9%80%E0%B8%A7%E0%B9%87%E0%B8%9A-C5HZZB4x.jpg",gU="/assets/%E0%B8%81%E0%B8%A3%E0%B8%A3%E0%B8%A1%E0%B8%AA%E0%B9%88%E0%B8%87%E0%B9%80%E0%B8%AA%E0%B8%A3%E0%B8%B4%E0%B8%A1%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%9B%E0%B8%81%E0%B8%84%E0%B8%A3%E0%B8%AD%E0%B8%87%E0%B8%97%E0%B9%89%E0%B8%AD%E0%B8%87%E0%B8%96%E0%B8%B7%E0%B9%88%E0%B8%99-wrB8VJhP.png",yU="/assets/%E0%B8%81%E0%B8%A3%E0%B8%B0%E0%B8%97%E0%B8%A3%E0%B8%A7%E0%B8%87%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%97%E0%B9%88%E0%B8%AD%E0%B8%87%E0%B9%80%E0%B8%97%E0%B8%B5%E0%B9%88%E0%B8%A2%E0%B8%A7%E0%B9%81%E0%B8%A5%E0%B8%B0%E0%B8%81%E0%B8%B5%E0%B8%AC%E0%B8%B2-H0zXdO5R.png",xU="/assets/%E0%B8%9B%E0%B8%A3%E0%B8%B0%E0%B8%8A%E0%B8%B2%E0%B8%AA%E0%B8%B1%E0%B8%A1%E0%B8%9E%E0%B8%B1%E0%B8%99%E0%B8%98%E0%B9%8C%E0%B8%88%E0%B8%B1%E0%B8%87%E0%B8%AB%E0%B8%A7%E0%B8%B1%E0%B8%94%E0%B8%AA%E0%B8%A1%E0%B8%B8%E0%B8%97%E0%B8%A3%E0%B8%AA%E0%B8%87%E0%B8%84%E0%B8%A3%E0%B8%B2%E0%B8%A1-CMknLaoe.png",wU="/assets/%E0%B8%AA%E0%B8%B3%E0%B8%99%E0%B8%B1%E0%B8%81%E0%B8%87%E0%B8%B2%E0%B8%99%E0%B8%AA%E0%B8%96%E0%B8%B4%E0%B8%95%E0%B8%B4%E0%B9%81%E0%B8%AB%E0%B9%88%E0%B8%87%E0%B8%8A%E0%B8%B2%E0%B8%95%E0%B8%B4%20%E0%B8%88%E0%B8%B1%E0%B8%87%E0%B8%AB%E0%B8%A7%E0%B8%B1%E0%B8%94%E0%B8%AA%E0%B8%A1%E0%B8%B8%E0%B8%97%E0%B8%A3%E0%B8%AA%E0%B8%87%E0%B8%84%E0%B8%A3%E0%B8%B2%E0%B8%A1-BbpBZhgn.jpg",bU="/assets/%E0%B8%AD%E0%B8%87%E0%B8%84%E0%B9%8C%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%9A%E0%B8%A3%E0%B8%B4%E0%B8%AB%E0%B8%B2%E0%B8%99%E0%B8%AA%E0%B9%88%E0%B8%A7%E0%B8%99%E0%B8%88%E0%B8%B1%E0%B8%87%E0%B8%AB%E0%B8%A7%E0%B8%B1%E0%B8%94-DZbxWvxP.png",EU=()=>{const t=[{id:"tourism",name:"MOTS",label:"",image:yU},{id:"pr",name:"PR Samut",label:`
`,image:xU},{id:"pao",name:"PAO",label:`
`,image:bU},{id:"local",name:"DLA",label:`
`,image:gU},{id:"nso",name:"NSO",label:`
`,image:wU}];return b.jsx("section",{className:"py-16 bg-muted/30 border-b border-border/50",children:b.jsxs("div",{className:"container mx-auto px-4",children:[b.jsxs("div",{className:"text-center mb-10",children:[b.jsx("p",{className:"text-sm font-medium text-muted-foreground mb-2",children:"Logos"}),b.jsx("h3",{className:"text-2xl font-bold text-foreground",children:""})]}),b.jsx("div",{className:"flex flex-wrap justify-center gap-6 md:gap-8",children:t.map(e=>b.jsxs("div",{className:"w-48 h-48 bg-card rounded-2xl flex flex-col items-center justify-center p-6 shadow-sm hover:shadow-lg transition-all duration-300 group border border-border/50",children:[b.jsx("div",{className:"w-24 h-24 flex items-center justify-center mb-4 group-hover:scale-110 transition-transform duration-300",children:b.jsx("img",{src:e.image,alt:e.label,className:"w-full h-full object-contain"})}),b.jsx("p",{className:"text-sm text-center text-muted-foreground font-medium leading-tight min-h-[2.5rem] flex items-center justify-center whitespace-pre-line",children:e.label})]},e.id))})]})})},CU=()=>{const t=[{title:"Floating Markets",titleTh:"",description:" ",image:"https://paimayang.com/wp-content/uploads/2020/02/82_20190826014648_1-840x560.jpg",category:"market"},{title:"Temples & Culture",titleTh:"",description:" ",image:"https://t1.blockdit.com/photos/2023/03/64053c674d188033c3a4bb5a_800x0xcover_Xv4jzo41.jpg",category:"temple"},{title:"Homestays & Gardens",titleTh:"",description:" ",image:"https://www.saitiew.com/upload/2024/11/3zkr3nr94bba.jpg",category:"homestay"}];return b.jsxs("div",{className:"min-h-screen bg-background",children:[b.jsx(Xs,{}),b.jsxs("section",{className:"relative min-h-screen flex items-center justify-center overflow-hidden",children:[b.jsxs("div",{className:"absolute inset-0",children:[b.jsx("img",{src:vU,alt:"Amphawa Floating Market",className:"w-full h-full object-cover"}),b.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-primary/40 via-primary/50 to-primary/70"})]}),b.jsxs("div",{className:"relative z-10 container mx-auto px-4 text-center",children:[b.jsxs("div",{className:"max-w-3xl mx-auto animate-fade-in",children:[b.jsxs("h1",{className:"font-display text-4xl md:text-6xl lg:text-6xl font-bold text-primary-foreground mb-4 leading-tight",children:[b.jsx("span",{className:"block mb-3",children:""}),b.jsx("span",{className:"block text-golden",children:""}),b.jsx("span",{className:"block text-golden",children:""})]}),b.jsx("p",{className:"text-xl md:text-2xl text-primary-foreground/90 mb-4 font-display"}),b.jsx("p",{className:"text-lg text-primary-foreground/80 mb-8 max-w-xl mx-auto",children:'Nong Pla Too" Intelligent Travel Publicity with AI'}),b.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[b.jsx(dn,{to:"/places",children:b.jsxs(De,{variant:"hero",size:"xl",className:"w-full sm:w-auto",children:[b.jsx(Ws,{className:"w-5 h-5"}),"",b.jsx(dx,{className:"w-5 h-5"})]})}),b.jsx(dn,{to:"/chat",children:b.jsxs(De,{variant:"heroOutline",size:"xl",className:"w-full sm:w-auto",children:[b.jsx(Kd,{className:"w-5 h-5"}),"Chat with NongPlatoo"]})})]})]}),b.jsx("div",{className:"absolute bottom-8 left-1/2 -translate-x-1/2 animate-float",children:b.jsx("div",{className:"w-6 h-10 rounded-full border-2 border-primary-foreground/50 flex justify-center pt-2",children:b.jsx("div",{className:"w-1.5 h-3 bg-primary-foreground/70 rounded-full animate-pulse"})})})]})]}),b.jsx(EU,{}),b.jsx("section",{className:"py-20 bg-gradient-sky",children:b.jsxs("div",{className:"container mx-auto px-4",children:[b.jsxs("div",{className:"text-center mb-12 animate-slide-up",children:[b.jsx("h2",{className:"font-display text-3xl md:text-4xl font-bold text-foreground mb-3",children:""}),b.jsx("p",{className:"text-lg text-muted-foreground",children:"Featured Categories  Discover what awaits you"})]}),b.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 max-w-5xl mx-auto",children:t.map((e,n)=>b.jsx(mU,{...e,className:`animate-slide-up animation-delay-${(n+1)*100}`},e.category))})]})}),b.jsx("section",{className:"py-20 bg-card",children:b.jsx("div",{className:"container mx-auto px-4",children:b.jsx("div",{className:"max-w-4xl mx-auto bg-gradient-river rounded-3xl p-8 md:p-12 shadow-elevated",children:b.jsxs("div",{className:"text-center",children:[b.jsx("div",{className:"w-16 h-16 bg-primary-foreground/20 rounded-2xl flex items-center justify-center mx-auto mb-6",children:b.jsx(Kd,{className:"w-8 h-8 text-primary-foreground"})}),b.jsx("h2",{className:"font-display text-2xl md:text-3xl font-bold text-primary-foreground mb-4",children:" NongPlatoo.Ai"}),b.jsx("p",{className:"text-primary-foreground/80 text-lg mb-8 max-w-xl mx-auto",children:" - "}),b.jsx(dn,{to:"/chat",children:b.jsxs(De,{variant:"heroOutline",size:"lg",className:"bg-primary-foreground text-primary hover:bg-primary-foreground/90",children:["Start Chatting",b.jsx(dx,{className:"w-5 h-5"})]})})]})})})}),b.jsx("footer",{className:"py-8 bg-muted border-t border-border",children:b.jsx("div",{className:"container mx-auto px-4 text-center",children:b.jsx("p",{className:"text-muted-foreground text-sm",children:" 2025   ."})})})]})},_U=nh("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function Ys({className:t,variant:e,...n}){return b.jsx("div",{className:we(_U({variant:e}),t),...n})}const fI=C.forwardRef(({className:t,...e},n)=>b.jsx("div",{ref:n,className:we("rounded-lg border bg-card text-card-foreground shadow-sm",t),...e}));fI.displayName="Card";const hI=C.forwardRef(({className:t,...e},n)=>b.jsx("div",{ref:n,className:we("flex flex-col space-y-1.5 p-6",t),...e}));hI.displayName="CardHeader";const pI=C.forwardRef(({className:t,...e},n)=>b.jsx("h3",{ref:n,className:we("text-2xl font-semibold leading-none tracking-tight",t),...e}));pI.displayName="CardTitle";const SU=C.forwardRef(({className:t,...e},n)=>b.jsx("p",{ref:n,className:we("text-sm text-muted-foreground",t),...e}));SU.displayName="CardDescription";const mI=C.forwardRef(({className:t,...e},n)=>b.jsx("div",{ref:n,className:we("p-6 pt-0",t),...e}));mI.displayName="CardContent";const kU=C.forwardRef(({className:t,...e},n)=>b.jsx("div",{ref:n,className:we("flex items-center p-6 pt-0",t),...e}));kU.displayName="CardFooter";const ao=C.forwardRef(({className:t,type:e,...n},r)=>b.jsx("input",{type:e,className:we("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:r,...n}));ao.displayName="Input";var IU="Label",vI=C.forwardRef((t,e)=>b.jsx(je.label,{...t,ref:e,onMouseDown:n=>{var o;n.target.closest("button, input, select, textarea")||((o=t.onMouseDown)==null||o.call(t,n),!n.defaultPrevented&&n.detail>1&&n.preventDefault())}}));vI.displayName=IU;var gI=vI;const RU=nh("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),Hi=C.forwardRef(({className:t,...e},n)=>b.jsx(gI,{ref:n,className:we(RU(),t),...e}));Hi.displayName=gI.displayName;var Eh="Tabs",[TU,MK]=So(Eh,[hh]),yI=hh(),[NU,Wy]=TU(Eh),xI=C.forwardRef((t,e)=>{const{__scopeTabs:n,value:r,onValueChange:o,defaultValue:i,orientation:a="horizontal",dir:s,activationMode:u="automatic",...c}=t,l=Ey(s),[d,f]=Zf({prop:r,onChange:o,defaultProp:i??"",caller:Eh});return b.jsx(NU,{scope:n,baseId:qd(),value:d,onValueChange:f,orientation:a,dir:l,activationMode:u,children:b.jsx(je.div,{dir:l,"data-orientation":a,...c,ref:e})})});xI.displayName=Eh;var wI="TabsList",bI=C.forwardRef((t,e)=>{const{__scopeTabs:n,loop:r=!0,...o}=t,i=Wy(wI,n),a=yI(n);return b.jsx(J_,{asChild:!0,...a,orientation:i.orientation,dir:i.dir,loop:r,children:b.jsx(je.div,{role:"tablist","aria-orientation":i.orientation,...o,ref:e})})});bI.displayName=wI;var EI="TabsTrigger",CI=C.forwardRef((t,e)=>{const{__scopeTabs:n,value:r,disabled:o=!1,...i}=t,a=Wy(EI,n),s=yI(n),u=kI(a.baseId,r),c=II(a.baseId,r),l=r===a.value;return b.jsx(Z_,{asChild:!0,...s,focusable:!o,active:l,children:b.jsx(je.button,{type:"button",role:"tab","aria-selected":l,"aria-controls":c,"data-state":l?"active":"inactive","data-disabled":o?"":void 0,disabled:o,id:u,...i,ref:e,onMouseDown:me(t.onMouseDown,d=>{!o&&d.button===0&&d.ctrlKey===!1?a.onValueChange(r):d.preventDefault()}),onKeyDown:me(t.onKeyDown,d=>{[" ","Enter"].includes(d.key)&&a.onValueChange(r)}),onFocus:me(t.onFocus,()=>{const d=a.activationMode!=="manual";!l&&!o&&d&&a.onValueChange(r)})})})});CI.displayName=EI;var _I="TabsContent",SI=C.forwardRef((t,e)=>{const{__scopeTabs:n,value:r,forceMount:o,children:i,...a}=t,s=Wy(_I,n),u=kI(s.baseId,r),c=II(s.baseId,r),l=r===s.value,d=C.useRef(l);return C.useEffect(()=>{const f=requestAnimationFrame(()=>d.current=!1);return()=>cancelAnimationFrame(f)},[]),b.jsx(Pi,{present:o||l,children:({present:f})=>b.jsx(je.div,{"data-state":l?"active":"inactive","data-orientation":s.orientation,role:"tabpanel","aria-labelledby":u,hidden:!f,id:c,tabIndex:0,...a,ref:e,style:{...t.style,animationDuration:d.current?"0s":void 0},children:f&&i})})});SI.displayName=_I;function kI(t,e){return`${t}-trigger-${e}`}function II(t,e){return`${t}-content-${e}`}var AU=xI,RI=bI,TI=CI,NI=SI;const PU=AU,AI=C.forwardRef(({className:t,...e},n)=>b.jsx(RI,{ref:n,className:we("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",t),...e}));AI.displayName=RI.displayName;const Dv=C.forwardRef(({className:t,...e},n)=>b.jsx(TI,{ref:n,className:we("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",t),...e}));Dv.displayName=TI.displayName;const Mv=C.forwardRef(({className:t,...e},n)=>b.jsx(NI,{ref:n,className:we("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...e}));Mv.displayName=NI.displayName;const DU=()=>{const{toast:t}=Zg(),e=Wc(),[n]=by(),r=C.useMemo(()=>n.get("redirect")||"/",[n]),{user:o,initializing:i,authLoading:a,authError:s,signIn:u,signUp:c,resetAuthError:l}=dI(),[d,f]=C.useState("login"),[h,m]=C.useState(null),[p,g]=C.useState({email:"",password:"",confirmPassword:"",displayName:""});C.useEffect(()=>{o&&!i&&e(r,{replace:!0})},[o,i,e,r]);const v=async x=>{if(x.preventDefault(),m(null),l(),!p.email||!p.password){m("");return}if(d==="register"&&p.password!==p.confirmPassword){m("");return}try{d==="login"?(await u(p.email,p.password),t({title:"",description:" "})):(await c({email:p.email,password:p.password,displayName:p.displayName.trim()||void 0}),t({title:"",description:" NongPlatoo.Ai "})),e(r,{replace:!0})}catch{}},y=[{title:" Firebase Auth",description:"  MFA ",icon:wx},{title:" ",description:"",icon:mx},{title:"",description:" ",icon:$s}];return b.jsxs("div",{className:"min-h-screen bg-gradient-sky relative overflow-hidden",children:[b.jsxs("div",{className:"absolute inset-0 pointer-events-none",children:[b.jsx("div",{className:"absolute -top-20 -left-20 w-72 h-72 bg-primary/20 rounded-full blur-3xl"}),b.jsx("div",{className:"absolute -bottom-20 -right-12 w-80 h-80 bg-secondary/20 rounded-full blur-3xl"}),b.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-white/40 via-white/30 to-white/10 dark:from-background"})]}),b.jsx(Xs,{}),b.jsx("div",{className:"container relative mx-auto px-4 pt-28 pb-16",children:b.jsxs("div",{className:"grid lg:grid-cols-2 gap-10 items-start",children:[b.jsxs("div",{className:"space-y-6",children:[b.jsx(Ys,{className:"bg-primary/15 text-primary border border-primary/20",children:""}),b.jsxs("div",{className:"space-y-4",children:[b.jsxs("p",{className:"text-sm uppercase tracking-[0.3em] text-primary font-semibold flex items-center gap-2",children:[b.jsx($s,{className:"w-4 h-4"})," Firebase Login"]}),b.jsx("h1",{className:"text-3xl sm:text-4xl font-bold leading-tight",children:" NongPlatoo.Ai"}),b.jsx("p",{className:"text-muted-foreground text-lg leading-relaxed",children:"  Firebase "})]}),b.jsx("div",{className:"grid sm:grid-cols-2 gap-4",children:y.map(x=>b.jsxs("div",{className:"glass p-4 rounded-2xl border border-border/80 shadow-soft flex gap-3",children:[b.jsx("div",{className:"h-10 w-10 rounded-xl bg-primary/10 text-primary flex items-center justify-center",children:b.jsx(x.icon,{className:"w-5 h-5"})}),b.jsxs("div",{className:"space-y-1",children:[b.jsx("h3",{className:"font-semibold",children:x.title}),b.jsx("p",{className:"text-sm text-muted-foreground",children:x.description})]})]},x.title))}),b.jsxs("div",{className:"flex items-center gap-3 text-sm text-muted-foreground",children:[b.jsx(BD,{className:"w-4 h-4 text-accent"}),""]})]}),b.jsxs(fI,{className:"glass shadow-elevated border border-primary/10 relative overflow-hidden",children:[b.jsx("div",{className:"absolute inset-x-0 top-0 h-1 bg-gradient-to-r from-primary via-secondary to-accent"}),b.jsx(hI,{className:"pb-4",children:b.jsxs(pI,{className:"flex items-center gap-3",children:[b.jsx("div",{className:"h-12 w-12 rounded-2xl bg-primary/10 text-primary flex items-center justify-center",children:b.jsx(mx,{className:"w-6 h-6"})}),b.jsxs("div",{children:[b.jsx("p",{className:"text-sm text-muted-foreground",children:""}),b.jsx("span",{className:"text-xl font-semibold",children:"NongPlatoo Account"})]})]})}),b.jsxs(mI,{className:"space-y-6",children:[b.jsxs(PU,{value:d,onValueChange:x=>f(x),children:[b.jsxs(AI,{className:"grid grid-cols-2 w-full",children:[b.jsx(Dv,{value:"login",children:""}),b.jsx(Dv,{value:"register",children:""})]}),b.jsx(Mv,{value:"login",className:"mt-6",children:b.jsxs("form",{className:"space-y-5",onSubmit:v,children:[b.jsxs("div",{className:"space-y-2",children:[b.jsxs(Hi,{htmlFor:"email",className:"flex items-center gap-2",children:[b.jsx(yx,{className:"w-4 h-4"})," "]}),b.jsx(ao,{id:"email",type:"email",placeholder:"you@example.com",value:p.email,onChange:x=>g({...p,email:x.target.value}),required:!0})]}),b.jsxs("div",{className:"space-y-2",children:[b.jsxs(Hi,{htmlFor:"password",className:"flex items-center gap-2",children:[b.jsx(hx,{className:"w-4 h-4"})," "]}),b.jsx(ao,{id:"password",type:"password",placeholder:"********",value:p.password,onChange:x=>g({...p,password:x.target.value}),required:!0})]}),(h||s)&&b.jsx("div",{className:"text-destructive bg-destructive/10 border border-destructive/30 rounded-lg px-3 py-2 text-sm",children:h||s}),b.jsx(De,{type:"submit",className:"w-full h-11 bg-gradient-river text-primary-foreground",disabled:a,children:a?b.jsxs(b.Fragment,{children:[b.jsx(px,{className:"w-4 h-4 mr-2 animate-spin"}),"..."]}):""})]})}),b.jsx(Mv,{value:"register",className:"mt-6",children:b.jsxs("form",{className:"space-y-5",onSubmit:v,children:[b.jsxs("div",{className:"space-y-2",children:[b.jsxs(Hi,{htmlFor:"displayName",className:"flex items-center gap-2",children:[b.jsx(QD,{className:"w-4 h-4"})," "]}),b.jsx(ao,{id:"displayName",placeholder:"",value:p.displayName,onChange:x=>g({...p,displayName:x.target.value})})]}),b.jsxs("div",{className:"space-y-2",children:[b.jsxs(Hi,{htmlFor:"register-email",className:"flex items-center gap-2",children:[b.jsx(yx,{className:"w-4 h-4"})," "]}),b.jsx(ao,{id:"register-email",type:"email",placeholder:"you@example.com",value:p.email,onChange:x=>g({...p,email:x.target.value}),required:!0})]}),b.jsxs("div",{className:"grid sm:grid-cols-2 gap-4",children:[b.jsxs("div",{className:"space-y-2",children:[b.jsxs(Hi,{htmlFor:"register-password",className:"flex items-center gap-2",children:[b.jsx(hx,{className:"w-4 h-4"})," "]}),b.jsx(ao,{id:"register-password",type:"password",placeholder:" 6 ",value:p.password,onChange:x=>g({...p,password:x.target.value}),required:!0})]}),b.jsxs("div",{className:"space-y-2",children:[b.jsxs(Hi,{htmlFor:"confirm-password",className:"flex items-center gap-2",children:[b.jsx(wx,{className:"w-4 h-4"})," "]}),b.jsx(ao,{id:"confirm-password",type:"password",placeholder:"",value:p.confirmPassword,onChange:x=>g({...p,confirmPassword:x.target.value}),required:!0})]})]}),(h||s)&&b.jsx("div",{className:"text-destructive bg-destructive/10 border border-destructive/30 rounded-lg px-3 py-2 text-sm",children:h||s}),b.jsx(De,{type:"submit",className:"w-full h-11 bg-gradient-river text-primary-foreground",disabled:a,children:a?b.jsxs(b.Fragment,{children:[b.jsx(px,{className:"w-4 h-4 mr-2 animate-spin"}),"..."]}):""})]})})]}),b.jsxs("div",{className:"text-sm text-muted-foreground text-center",children:[""," ",b.jsx(dn,{to:"/",className:"text-primary hover:underline",children:""})," ",""," ",b.jsx(dn,{to:"/",className:"text-primary hover:underline",children:""})]})]})]})]})})]})},PI="place_views",DI=()=>{try{const t=localStorage.getItem(PI);return t?JSON.parse(t):{}}catch(t){return console.error("Error reading views from localStorage:",t),{}}},MI=t=>DI()[t]||0,MU=t=>{try{const e=DI(),r=(e[t]||0)+1;return e[t]=r,localStorage.setItem(PI,JSON.stringify(e)),r}catch(e){return console.error("Error incrementing views:",e),MI(t)}},OU=t=>t>=1e6?`${(t/1e6).toFixed(1)}M`:t>=1e3?`${(t/1e3).toFixed(1)}K`:t.toString(),FU=({id:t,name:e,nameTh:n,location:r,image:o,rating:i,tags:a,isOpen:s=!0,className:u})=>{const[c,l]=C.useState(0);C.useEffect(()=>{l(MI(t))},[t]);const d=()=>{const f=MU(t);l(f)};return b.jsx(dn,{to:`/places/${t}`,onClick:d,className:we("group block card-hover",u),children:b.jsxs("div",{className:"bg-card rounded-2xl overflow-hidden shadow-card",children:[b.jsxs("div",{className:"relative aspect-[4/3] overflow-hidden",children:[b.jsx("img",{src:o,alt:n,className:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-105"}),b.jsx("div",{className:"absolute top-3 left-3",children:b.jsxs(Ys,{variant:s?"default":"secondary",className:we("flex items-center gap-1",s?"bg-accent text-accent-foreground":"bg-muted text-muted-foreground"),children:[b.jsx(Gd,{className:"w-3 h-3"}),s?"":""]})}),b.jsxs("div",{className:"absolute top-3 right-3 flex flex-col gap-2",children:[b.jsxs("div",{className:"flex items-center gap-1 bg-card/90 backdrop-blur-sm px-2 py-1 rounded-full",children:[b.jsx(LC,{className:"w-3.5 h-3.5 fill-golden text-golden"}),b.jsx("span",{className:"text-sm font-medium text-foreground",children:i.toFixed(1)})]}),b.jsxs("div",{className:"flex items-center gap-1 bg-card/90 backdrop-blur-sm px-2 py-1 rounded-full",children:[b.jsx(WD,{className:"w-3.5 h-3.5 text-primary"}),b.jsx("span",{className:"text-xs font-medium text-foreground",children:OU(c)})]})]})]}),b.jsxs("div",{className:"p-4",children:[b.jsx("h3",{className:"font-display text-lg font-semibold text-foreground mb-1 line-clamp-1 group-hover:text-primary transition-colors",children:n}),b.jsx("p",{className:"text-muted-foreground text-sm mb-2",children:e}),b.jsxs("div",{className:"flex items-center gap-1 text-muted-foreground text-sm mb-3",children:[b.jsx(Ws,{className:"w-4 h-4 text-secondary"}),b.jsx("span",{className:"line-clamp-1",children:r})]}),b.jsx("div",{className:"flex flex-wrap gap-1.5",children:a.slice(0,3).map(f=>b.jsx(Ys,{variant:"outline",className:"text-xs border-border text-muted-foreground",children:f},f))})]})]})})},$y=[{id:"1",name:"Amphawa Floating Market",nameTh:"",description:"The famous floating market where you can enjoy fresh seafood and local snacks from boats along the canal. Best visited in the evening for the magical firefly boat tours.",descriptionTh:" .",location:"Amphawa, Samut Songkhram",district:"amphawa",category:"market",image:"https://lh3.googleusercontent.com/gps-cs-s/AG0ilSyXKuL_MwFh65YglyMBCuKbkad-RoGiGp9rq5fYmkKy_4e4YreVx2orjwR6cQhL2X23HGOqPIgaT1Ong0nNe8Lp60Re9i7611FP1j1qwwrLrAfFyIl7mTeE_8JvEj5uPazBLy1gJ364Ng9W=s1024",rating:4.7,tags:[""],openTime:"09:00",closeTime:"18:00",isOpen:!0,googleMapsUrl:"https://maps.google.com/?q=Amphawa+Floating+Market",address:"Amphawa Sub-district, Amphawa District, Samut Songkhram 75110",addressTh:"   75110"},{id:"2",name:"Wat Bang Kung",nameTh:"",description:"An ancient temple enshrined within the roots of a massive banyan tree. Also known as the Church in the Tree, it's a mystical and serene place.",descriptionTh:".",location:"Bang Khonthi, Samut Songkhram",district:"bang-khonthi",category:"temple",image:"https://lh3.googleusercontent.com/gps-cs-s/AG0ilSwtz9nw17SvBPqD_5v1gma9tYikz-_VoHO_7j3O1DsCvFHvTL4hXAToAc9p9Pj8zkDpu0_UYHZHmQGHnXd6B889HilNRr2gE0zhAbNPXAxNujRgWcx9vZ1bt3a08XGofo66_xqvhg=s1024",rating:4.8,tags:["","",""],openTime:"09:00",closeTime:"18:00",isOpen:!0,googleMapsUrl:"https://maps.google.com/?q=Wat+Bang+Kung",address:"Bang Kung Sub-district, Bang Khonthi District, Samut Songkhram 75120",addressTh:"   75120"},{id:"3",name:"Maeklong Railway Market",nameTh:"",description:"Witness the incredible sight of vendors quickly clearing their stalls as the train passes through this unique market built on the railway tracks.",descriptionTh:".",location:"Mueang, Samut Songkhram",district:"mueang",category:"market",image:"https://umbrella-perfect.com/wp-content/uploads/2021/02/%E0%B8%9B%E0%B8%A3%E0%B8%B0%E0%B8%A7%E0%B8%B1%E0%B8%95%E0%B8%B4%E0%B8%84%E0%B8%A7%E0%B8%B2%E0%B8%A1%E0%B9%80%E0%B8%9B%E0%B9%87%E0%B8%99%E0%B8%A1%E0%B8%B2%E0%B8%82%E0%B8%AD%E0%B8%87%E0%B8%95%E0%B8%A5%E0%B8%B2%E0%B8%94%E0%B8%A3%E0%B9%88%E0%B8%A1%E0%B8%AB%E0%B8%B8%E0%B8%9A.jpg",rating:4.6,tags:["","",""],openTime:"06:00",closeTime:"18:00",isOpen:!0,googleMapsUrl:"https://maps.google.com/?q=Maeklong+Railway+Market",address:"Mae Klong Sub-district, Mueang District, Samut Songkhram 75000",addressTh:"   75000"},{id:"4",name:"Baan Rak Amphawa",nameTh:"",description:"A charming riverside homestay offering authentic Thai hospitality. Wake up to the gentle sounds of the river and enjoy homemade breakfast.",descriptionTh:" ",location:"Amphawa, Samut Songkhram",district:"amphawa",category:"homestay",image:"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQBEDoWOCGL2pGknXKGIDciMMpSheTRGgATjw&s",rating:4.9,tags:["","",""],openTime:"00:00",closeTime:"23:59",isOpen:!0,googleMapsUrl:"https://maps.google.com/?q=Baan+Rak+Amphawa",address:"Amphawa Sub-district, Amphawa District, Samut Songkhram 75110",addressTh:"   75110"},{id:"5",name:"Caf Kantary",nameTh:" ",description:"A beautiful riverside caf with stunning views of the Mae Klong river. Perfect for enjoying coffee while watching traditional boats pass by.",descriptionTh:" ",location:"Amphawa, Samut Songkhram",district:"amphawa",category:"cafe",image:"https://chillpainai.com/src/wewakeup/scoop/images/91e3f6e28fb58b74b0e8820ec1d513c588488830.jpg",rating:4.5,tags:["","",""],openTime:"08:00",closeTime:"20:00",isOpen:!0,googleMapsUrl:"https://maps.google.com/?q=Cafe+Kantary+Amphawa",address:"Amphawa Sub-district, Amphawa District, Samut Songkhram 75110",addressTh:"   75110"},{id:"6",name:"Don Hoi Lot",nameTh:"",description:"A unique sandbar formation home to the razor clam. Visit during low tide to walk on the exposed sandbar and see these fascinating creatures.",descriptionTh:" ",location:"Bang Tabun, Samut Songkhram",district:"bang-khonthi",category:"photo-spot",image:"https://cms.dmpcdn.com/travel/2020/06/16/76365890-afa1-11ea-b79d-0ddf2d8ccf90_original.jpg",rating:4.3,tags:["","",""],openTime:"06:00",closeTime:"18:00",isOpen:!0,googleMapsUrl:"https://maps.google.com/?q=Don+Hoi+Lot",address:"Bang Tabun Sub-district, Bang Khonthi District, Samut Songkhram 75120",addressTh:"   75120"}],OI=t=>$y.find(e=>e.id===t),LU=(t,e,n)=>$y.filter(r=>{if(t&&r.district!==t||e&&r.category!==e)return!1;if(n){const o=n.toLowerCase();return r.name.toLowerCase().includes(o)||r.nameTh.includes(n)||r.tags.some(i=>i.includes(n))}return!0}),BU=(t={})=>{const[e,n]=by(),[r,o]=C.useState(""),[i,a]=C.useState(t.initialDistrict||e.get("district")||""),[s,u]=C.useState(t.initialCategory||e.get("category")||""),c=(m,p)=>{const g=new URLSearchParams;m&&g.set("district",m),p&&g.set("category",p),n(g)},l=m=>{const p=i===m?"":m;a(p),c(p,s)},d=m=>{const p=s===m?"":m;u(p),c(i,p)},f=()=>{a(""),u(""),o(""),n(new URLSearchParams)},h=C.useMemo(()=>!!(i||s||r),[i,s,r]);return{search:r,selectedDistrict:i,selectedCategory:s,setSearch:o,handleDistrictChange:l,handleCategoryChange:d,clearFilters:f,hasActiveFilters:h}},jU=[{value:"amphawa",label:"",labelEn:"Amphawa"},{value:"mueang",label:"",labelEn:"Mueang"},{value:"bang-khonthi",label:"",labelEn:"Bang Khonthi"}],UU=[{value:"market",label:"",labelEn:"Market"},{value:"temple",label:"",labelEn:"Temple"},{value:"cafe",label:"",labelEn:"Caf"},{value:"homestay",label:"",labelEn:"Homestay"},{value:"photo-spot",label:"",labelEn:"Photo Spot"}],jl={position:"fixed top-20 left-4 z-50 pointer-events-none",text:{main:"DEV",sub:"In Progress"},icon:""},WU=()=>{const[t,e]=C.useState(!1),{search:n,selectedDistrict:r,selectedCategory:o,setSearch:i,handleDistrictChange:a,handleCategoryChange:s,clearFilters:u,hasActiveFilters:c}=BU(),l=C.useMemo(()=>LU(r||void 0,o||void 0,n||void 0),[r,o,n]);return b.jsxs("div",{className:"min-h-screen bg-background",children:[b.jsx(Xs,{}),b.jsx("div",{className:jl.position,children:b.jsxs("div",{className:"bg-amber-400 dark:bg-amber-600 text-amber-900 dark:text-amber-50 px-4 py-2 rounded-lg shadow-lg border-2 border-amber-500 dark:border-amber-400 rotate-12 font-bold text-sm flex items-center gap-2",children:[b.jsx("span",{className:"text-lg",children:jl.icon}),b.jsxs("div",{children:[b.jsx("div",{children:jl.text.main}),b.jsx("div",{className:"text-xs",children:jl.text.sub})]})]})}),b.jsx("header",{className:"pt-24 pb-8 bg-gradient-sky",children:b.jsxs("div",{className:"container mx-auto px-4",children:[b.jsx("h1",{className:"font-display text-3xl md:text-4xl font-bold text-foreground mb-2",children:""}),b.jsxs("p",{className:"text-muted-foreground text-lg",children:["Explore Places  ",$y.length," destinations to discover"]})]})}),b.jsx("div",{className:"sticky top-16 z-40 bg-card/95 backdrop-blur-md border-b border-border py-4",children:b.jsxs("div",{className:"container mx-auto px-4",children:[b.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[b.jsxs("div",{className:"relative flex-1",children:[b.jsx(xx,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-muted-foreground"}),b.jsx(ao,{placeholder:"... (Search places)",value:n,onChange:d=>i(d.target.value),className:"pl-10 h-12 bg-background"})]}),b.jsxs(De,{variant:"outline",className:"md:hidden h-12",onClick:()=>e(!t),children:[b.jsx($D,{className:"w-5 h-5 mr-2"}),"Filters",c&&b.jsx(Ys,{className:"ml-2 bg-primary text-primary-foreground",children:"Active"})]}),c&&b.jsxs(De,{variant:"ghost",onClick:u,className:"hidden md:flex h-12",children:[b.jsx(rh,{className:"w-4 h-4 mr-2"}),"Clear"]})]}),b.jsxs("div",{className:`mt-4 space-y-4 ${t?"block":"hidden md:block"}`,children:[b.jsxs("div",{children:[b.jsx("p",{className:"text-sm font-medium text-muted-foreground mb-2",children:" (District)"}),b.jsx("div",{className:"flex flex-wrap gap-2",children:jU.map(d=>b.jsxs(De,{variant:r===d.value?"default":"outline",size:"sm",onClick:()=>a(d.value),className:"rounded-full",children:[d.label,b.jsxs("span",{className:"text-xs opacity-70 ml-1",children:["(",d.labelEn,")"]})]},d.value))})]}),b.jsxs("div",{children:[b.jsx("p",{className:"text-sm font-medium text-muted-foreground mb-2",children:" (Category)"}),b.jsx("div",{className:"flex flex-wrap gap-2",children:UU.map(d=>b.jsxs(De,{variant:o===d.value?"sky":"outline",size:"sm",onClick:()=>s(d.value),className:"rounded-full",children:[d.label,b.jsxs("span",{className:"text-xs opacity-70 ml-1",children:["(",d.labelEn,")"]})]},d.value))})]})]})]})}),b.jsx("main",{className:"py-8",children:b.jsxs("div",{className:"container mx-auto px-4",children:[b.jsxs("p",{className:"text-muted-foreground mb-6",children:[" ",l.length,"  (Found ",l.length," ","places)"]}),l.length>0?b.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:l.map((d,f)=>b.jsx(FU,{id:d.id,name:d.name,nameTh:d.nameTh,location:d.location,image:d.image,rating:d.rating,tags:d.tags,isOpen:d.isOpen,className:`animate-slide-up animation-delay-${f%3*100}`},d.id))}):b.jsxs("div",{className:"text-center py-20",children:[b.jsx("div",{className:"w-16 h-16 bg-muted rounded-full flex items-center justify-center mx-auto mb-4",children:b.jsx(xx,{className:"w-8 h-8 text-muted-foreground"})}),b.jsx("h3",{className:"font-display text-xl font-semibold text-foreground mb-2",children:""}),b.jsx("p",{className:"text-muted-foreground",children:"No places found. Try adjusting your filters."}),b.jsx(De,{variant:"outline",onClick:u,className:"mt-4",children:"Clear Filters"})]})]})})]})},$U=()=>{const{id:t}=Z4(),e=Wc(),[n,r]=C.useState(!1),o=OI(t||"");return o?b.jsxs("div",{className:"min-h-screen bg-background",children:[b.jsx(Xs,{}),b.jsxs("div",{className:"relative h-[50vh] min-h-[400px]",children:[b.jsx("img",{src:o.image,alt:o.nameTh,className:"w-full h-full object-cover"}),b.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-background via-background/20 to-transparent"}),b.jsx(De,{variant:"ghost",size:"icon",onClick:()=>e(-1),className:"absolute top-20 left-4 bg-card/80 backdrop-blur-sm hover:bg-card",children:b.jsx(DD,{className:"w-5 h-5"})}),b.jsx("div",{className:"absolute top-20 right-4",children:b.jsxs("div",{className:"flex items-center gap-1 bg-card/90 backdrop-blur-sm px-3 py-1.5 rounded-full shadow-soft",children:[b.jsx(LC,{className:"w-4 h-4 fill-golden text-golden"}),b.jsx("span",{className:"font-medium text-foreground",children:o.rating.toFixed(1)})]})})]}),b.jsxs("main",{className:"container mx-auto px-4 -mt-20 relative z-10 pb-12",children:[b.jsxs("div",{className:"bg-card rounded-2xl shadow-elevated p-6 md:p-8",children:[b.jsxs("div",{className:"mb-6",children:[b.jsxs("div",{className:"flex items-start justify-between gap-4 mb-3",children:[b.jsxs("div",{children:[b.jsx("h1",{className:"font-display text-2xl md:text-3xl font-bold text-foreground mb-1",children:o.nameTh}),b.jsx("p",{className:"text-muted-foreground text-lg",children:o.name})]}),b.jsxs(Ys,{variant:o.isOpen?"default":"secondary",className:o.isOpen?"bg-accent text-accent-foreground":"bg-muted text-muted-foreground",children:[b.jsx(Gd,{className:"w-3 h-3 mr-1"}),o.isOpen?"":""]})]}),b.jsx("div",{className:"flex flex-wrap gap-2",children:o.tags.map(i=>b.jsx(Ys,{variant:"outline",className:"border-border text-muted-foreground",children:i},i))})]}),b.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[b.jsxs("div",{className:"space-y-2",children:[b.jsxs("h3",{className:"font-medium text-foreground flex items-center gap-2",children:[b.jsx(Ws,{className:"w-4 h-4 text-secondary"})," (Address)"]}),b.jsx("p",{className:"text-muted-foreground text-sm",children:o.addressTh}),b.jsx("p",{className:"text-muted-foreground text-sm",children:o.address})]}),b.jsxs("div",{className:"space-y-2",children:[b.jsxs("h3",{className:"font-medium text-foreground flex items-center gap-2",children:[b.jsx(Gd,{className:"w-4 h-4 text-secondary"}),"- (Hours)"]}),b.jsxs("p",{className:"text-muted-foreground",children:[o.openTime," - ",o.closeTime]})]})]}),b.jsx("a",{href:o.googleMapsUrl,target:"_blank",rel:"noopener noreferrer",children:b.jsxs(De,{variant:"outline",className:"w-full md:w-auto mb-6",children:[b.jsx(Ws,{className:"w-4 h-4"}),"Open in Google Maps",b.jsx(UD,{className:"w-4 h-4"})]})}),b.jsxs("div",{className:"border-t border-border pt-6",children:[b.jsx("h3",{className:"font-medium text-foreground mb-3",children:" (Description)"}),b.jsxs("div",{className:`text-muted-foreground leading-relaxed ${!n&&"line-clamp-3"}`,children:[b.jsx("p",{className:"mb-3",children:o.descriptionTh}),b.jsx("p",{children:o.description})]}),b.jsx(De,{variant:"ghost",size:"sm",onClick:()=>r(!n),className:"mt-2 text-primary",children:n?b.jsxs(b.Fragment,{children:[b.jsx(LD,{className:"w-4 h-4"}),"Show Less"]}):b.jsxs(b.Fragment,{children:[b.jsx(OD,{className:"w-4 h-4"}),"Read More"]})})]})]}),b.jsx("div",{className:"mt-6 bg-gradient-river rounded-2xl p-6 shadow-elevated",children:b.jsxs("div",{className:"flex flex-col md:flex-row items-center gap-4 text-center md:text-left",children:[b.jsx("div",{className:"w-12 h-12 bg-primary-foreground/20 rounded-xl flex items-center justify-center flex-shrink-0",children:b.jsx(Kd,{className:"w-6 h-6 text-primary-foreground"})}),b.jsxs("div",{className:"flex-1",children:[b.jsx("h3",{className:"font-display text-lg font-semibold text-primary-foreground mb-1",children:" AI "}),b.jsx("p",{className:"text-primary-foreground/80 text-sm",children:"Get tips, recommendations, and plan your visit with our AI assistant"})]}),b.jsx(dn,{to:`/chat?place=${o.id}`,children:b.jsx(De,{variant:"heroOutline",className:"bg-primary-foreground text-primary hover:bg-primary-foreground/90",children:"Ask AI Guide"})})]})})]})]}):b.jsxs("div",{className:"min-h-screen bg-background",children:[b.jsx(Xs,{}),b.jsxs("div",{className:"pt-24 container mx-auto px-4 text-center",children:[b.jsx("h1",{className:"font-display text-2xl font-bold text-foreground mb-4",children:""}),b.jsx("p",{className:"text-muted-foreground mb-8",children:"Place not found"}),b.jsx(dn,{to:"/places",children:b.jsx(De,{children:"Back to Places"})})]})]})},zU="/assets/logochat%E0%B8%99%E0%B9%89%E0%B8%AD%E0%B8%87%E0%B8%9B%E0%B8%A5%E0%B8%B2%E0%B8%97%E0%B8%B9-DvqOaGyL.png",VU="/assets/hero-floating-market-C9FyTcU2.jpg",FI=()=>{var e;const t="https://nongplatoo.online".trim();return t||(typeof window<"u"&&((e=window.location)!=null&&e.origin)?window.location.origin:"")},LI=FI(),HU=t=>{if(!t)return"";if(typeof t=="string")return t;const e=t.district||"",n=t.province||"";return[e,n].filter(Boolean).join(", ")},GU=t=>{if(t)return Array.isArray(t)?t.join(", "):t},KU=({place:t,fallback:e})=>{const[n,r]=C.useState(!1),o=t.place_name||t.name||"",i=t.short_description||t.description||"",a=t.category||GU(t.type),s=HU(t.location)||t.address,l=(m=>{if(!m)return[];if(Array.isArray(m))return m.filter(p=>p).map(p=>String(p).trim());if(typeof m=="string"){const p=m.trim();if(p.startsWith("["))try{const g=JSON.parse(p);if(Array.isArray(g))return g.filter(v=>v).map(v=>String(v).trim())}catch(g){console.warn("Failed to parse images JSON:",g)}return p?[p]:[]}return[]})(t.images)[0],f=n||!l?e:(m=>m?m.startsWith("https://lh3.googleusercontent.com")?`${LI}/api/image-proxy?url=${encodeURIComponent(m)}`:m:e)(l),h=()=>{r(!0)};return b.jsx("div",{className:"rounded-xl border border-border bg-muted/40 p-3",children:b.jsxs("div",{className:"flex items-start gap-3",children:[b.jsx("img",{src:f,alt:o,className:"w-16 h-16 rounded-lg object-cover flex-shrink-0",loading:"lazy",crossOrigin:"anonymous",referrerPolicy:"no-referrer",onError:h}),b.jsxs("div",{className:"space-y-1",children:[b.jsx("p",{className:"font-semibold text-foreground leading-tight",children:o}),a&&b.jsx("p",{className:"text-xs text-muted-foreground",children:a}),b.jsx("p",{className:"text-sm text-foreground/80 leading-relaxed line-clamp-3",children:i}),s&&b.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[b.jsx(Ws,{className:"w-3.5 h-3.5"}),b.jsx("span",{children:s})]}),t.opening_hours&&b.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[b.jsx(Gd,{className:"w-3.5 h-3.5"}),b.jsx("span",{children:t.opening_hours})]}),t.contact&&b.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[b.jsx(GD,{className:"w-3.5 h-3.5"}),b.jsx("span",{children:t.contact})]})]})]})})},qU=({places:t})=>t.length?b.jsx("div",{className:"mt-3 space-y-3",children:t.map((e,n)=>b.jsx(KU,{place:e,fallback:VU},e.id||`${e.place_name||e.name||"place"}-${n}`))}):null,XU=({message:t,isUser:e,timestamp:n,structuredData:r=[],meta:o,messageId:i,chatLogId:a,userMessage:s})=>{const[u,c]=C.useState(null),[l,d]=C.useState(!1),f=async h=>{const m=a||i;if(!(!m||l)){d(!0);try{(await fetch(`${LI}/api/feedback`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({chat_log_id:m,type:h,comment:""})})).ok&&c(h)}catch(p){console.error("Failed to submit feedback:",p)}finally{d(!1)}}};return b.jsxs("div",{className:we("flex gap-3 animate-slide-up",e?"flex-row-reverse":"flex-row"),children:[b.jsx("div",{className:we("flex-shrink-0 w-9 h-9 rounded-full flex items-center justify-center overflow-hidden",e?"bg-primary text-primary-foreground":"bg-secondary text-secondary-foreground"),children:e?b.jsx(BC,{className:"w-5 h-5"}):b.jsx("img",{src:zU,alt:"NongPlatoo",className:"w-full h-full object-cover"})}),b.jsxs("div",{className:we("max-w-[80%] rounded-2xl px-4 py-3",e?"bg-primary text-primary-foreground rounded-br-sm":"bg-card shadow-soft border border-border rounded-bl-sm"),children:[b.jsx("p",{className:we("text-sm leading-relaxed whitespace-pre-wrap",e?"text-primary-foreground":"text-foreground"),children:t}),r.length>0&&b.jsx(qU,{places:r}),!e&&(a||i)&&b.jsxs("div",{className:"flex items-center gap-2 mt-3 pt-2 border-t border-border",children:[b.jsxs(De,{variant:"ghost",size:"sm",className:we("h-7 px-2 text-xs",u==="like"&&"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400"),onClick:()=>f("like"),disabled:l||u!==null,children:[b.jsx(YD,{className:"w-3.5 h-3.5 mr-1"}),"Helpful"]}),b.jsxs(De,{variant:"ghost",size:"sm",className:we("h-7 px-2 text-xs",u==="dislike"&&"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400"),onClick:()=>f("dislike"),disabled:l||u!==null,children:[b.jsx(XD,{className:"w-3.5 h-3.5 mr-1"}),"Not helpful"]})]}),(n||(o==null?void 0:o.source))&&b.jsxs("p",{className:we("text-xs mt-1.5 flex items-center gap-2",e?"text-primary-foreground/60":"text-muted-foreground"),children:[n,(o==null?void 0:o.source)&&b.jsx("span",{className:"rounded-full bg-muted px-2 py-0.5 text-[11px] border border-border",children:o.source})]})]})]})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var BI=function(t,e){return(BI=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)r.hasOwnProperty(o)&&(n[o]=r[o])})(t,e)};function br(t,e){function n(){this.constructor=t}BI(t,e),t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}function ue(t,e,n,r){return new(n||(n=Promise))(function(o,i){function a(c){try{u(r.next(c))}catch(l){i(l)}}function s(c){try{u(r.throw(c))}catch(l){i(l)}}function u(c){c.done?o(c.value):new n(function(l){l(c.value)}).then(a,s)}u((r=r.apply(t,[])).next())})}function ce(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function s(u){return function(c){return function(l){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&l[0]?r.return:l[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,l[1])).done)return o;switch(r=0,o&&(l=[2&l[0],o.value]),l[0]){case 0:case 1:o=l;break;case 4:return a.label++,{value:l[1],done:!1};case 5:a.label++,r=l[1],l=[0];continue;case 7:l=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(l[0]===6||l[0]===2)){a=0;continue}if(l[0]===3&&(!o||l[1]>o[0]&&l[1]<o[3])){a.label=l[1];break}if(l[0]===6&&a.label<o[1]){a.label=o[1],o=l;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(l);break}o[2]&&a.ops.pop(),a.trys.pop();continue}l=e.call(t,a)}catch(d){l=[6,d],r=0}finally{n=o=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([u,c])}}}var YU=function(){function t(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.populateURLFlags()}return t.prototype.setPlatform=function(e,n){this.platform!=null&&console.warn("Platform "+this.platformName+" has already been set. Overwriting the platform with "+n+"."),this.platformName=e,this.platform=n},t.prototype.registerFlag=function(e,n,r){if(this.flagRegistry[e]={evaluationFn:n,setHook:r},this.urlFlags[e]!=null){var o=this.urlFlags[e];console.warn("Setting feature override from URL "+e+": "+o+"."),this.set(e,o)}},t.prototype.get=function(e){return e in this.flags?this.flags[e]:(this.flags[e]=this.evaluateFlag(e),this.flags[e])},t.prototype.getNumber=function(e){return this.get(e)},t.prototype.getBool=function(e){return this.get(e)},t.prototype.getFlags=function(){return this.flags},Object.defineProperty(t.prototype,"features",{get:function(){return this.flags},enumerable:!0,configurable:!0}),t.prototype.set=function(e,n){if(this.flagRegistry[e]==null)throw new Error("Cannot set flag "+e+" as it has not been registered.");this.flags[e]=n,this.flagRegistry[e].setHook!=null&&this.flagRegistry[e].setHook(n)},t.prototype.evaluateFlag=function(e){if(this.flagRegistry[e]==null)throw new Error("Cannot evaluate flag '"+e+"': no evaluation function found.");return this.flagRegistry[e].evaluationFn()},t.prototype.setFlags=function(e){this.flags=Object.assign({},e)},t.prototype.reset=function(){this.flags={},this.urlFlags={},this.populateURLFlags()},t.prototype.populateURLFlags=function(){var e=this;if(this.global!==void 0&&this.global.location!==void 0&&this.global.location.search!==void 0){var n,r,o=(n=this.global.location.search,r={},n.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,function(i){for(var a=[],s=1;s<arguments.length;s++)a[s-1]=arguments[s];return QU(r,a[0],a[1]),a.join("=")}),r);"tfjsflags"in o&&o.tfjsflags.split(",").forEach(function(i){var a=i.split(":"),s=a[0],u=a[1];e.urlFlags[s]=function(c,l){if((l=l.toLowerCase())==="true"||l==="false")return l==="true";if(""+ +l===l)return+l;throw new Error("Could not parse value flag value "+l+" for flag "+c+".")}(s,u)})}},t}();function QU(t,e,n){t[decodeURIComponent(e)]=decodeURIComponent(n||"")}function K(){return jI}var jI=null,ff=new Map,Ov=new Map;function UI(t,e){var n=$I(t,e);return ff.get(n)}function JU(t){return Ov.get(t)}function Ww(t){for(var e=ff.entries(),n=[];;){var r=e.next(),o=r.done,i=r.value;if(o)break;var a=i[0],s=i[1];a.split("_")[0]===t&&n.push(s)}return n}function WI(t){var e=t.kernelName,n=t.backendName,r=$I(e,n);if(ff.has(r))throw new Error("The kernel '"+e+"' for backend '"+n+"' is already registered");ff.set(r,t)}function ZU(t){var e=t.kernelName;Ov.has(e)&&console.warn("Overriding the gradient for '"+e+"'"),Ov.set(e,t)}function $I(t,e){return e+"_"+t}function Fv(t,e,n){return Math.max(t,Math.min(e,n))}function zI(t){return t%2==0?t:t+1}function eW(t){for(var e=0,n=0;n<t.length;n++)e+=t[n];return e}function N(t,e){if(!t)throw new Error(typeof e=="string"?e:e())}function We(t,e,n){n===void 0&&(n=""),N(Nt(t,e),function(){return n+" Shapes "+t+" and "+e+" must match"})}function cu(t){N(t!=null,function(){return"The input to the tensor constructor must be a non-null value."})}function Qs(t,e,n){if(e===void 0&&(e=[]),n===void 0&&(n=!1),e==null&&(e=[]),Array.isArray(t)||zr(t)&&!n)for(var r=0;r<t.length;++r)Qs(t[r],e,n);else e.push(t);return e}function le(t){if(t.length===0)return 1;for(var e=t[0],n=1;n<t.length;n++)e*=t[n];return e}function Nt(t,e){if(t===e)return!0;if(t==null||e==null||t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function ft(t){return t%1==0}function tW(t){if(Math.tanh!=null)return Math.tanh(t);if(t===1/0)return 1;if(t===-1/0)return-1;var e=Math.exp(2*t);return(e-1)/(e+1)}function Lv(t){var e=Math.ceil(Math.sqrt(t));return[e,Math.ceil(t/e)]}function ys(t,e){return e<=t.length?t:t+" ".repeat(e-t.length)}function $w(t,e,n){return e===void 0&&(e=function(r){return 0}),new Promise(function(r,o){var i=0,a=function(){if(t())r();else{i++;var s=e(i);n!=null&&i>=n?o():setTimeout(a,s)}};a()})}function nW(t,e){for(var n=1,r=-1,o=0;o<t.length;++o)if(t[o]>=0)n*=t[o];else if(t[o]===-1){if(r!==-1)throw Error("Shapes can only have 1 implicit size. Found -1 at dim "+r+" and dim "+o);r=o}else if(t[o]<0)throw Error("Shapes can not be < 0. Found "+t[o]+" at dim "+o);if(r===-1){if(e>0&&e!==n)throw Error("Size("+e+") must match the product of shape "+t);return t}if(n===0)throw Error("Cannot infer the missing size in ["+t+"] when there are 0 elements");if(e%n!=0)throw Error("The implicit shape can't be a fractional number. Got "+e+" / "+n);var i=t.slice();return i[r]=e/n,i}function _t(t,e){var n=e.length;return N((t=t==null?e.map(function(r,o){return o}):[].concat(t)).every(function(r){return r>=-n&&r<n}),function(){return"All values in axis param must be in range [-"+n+", "+n+") but got axis "+t}),N(t.every(function(r){return ft(r)}),function(){return"All values in axis param must be integers but got axis "+t}),t.map(function(r){return r<0?n+r:r})}function qi(t,e){for(var n=[],r=[],o=e!=null&&Array.isArray(e)&&e.length===0,i=e==null||o?null:_t(e,t).sort(),a=0,s=0;s<t.length;++s){if(i!=null){if(i[a]===s&&t[s]!==1)throw new Error("Can't squeeze axis "+s+" since its dim '"+t[s]+"' is not 1");(i[a]==null||i[a]>s)&&t[s]===1&&(n.push(t[s]),r.push(s)),i[a]<=s&&a++}t[s]!==1&&(n.push(t[s]),r.push(s))}return{newShape:n,keptDims:r}}function Cc(t,e){var n=null;if(t==null||t==="float32")n=new Float32Array(e);else if(t==="int32")n=new Int32Array(e);else{if(t!=="bool")throw new Error("Unknown data type "+t);n=new Uint8Array(e)}return n}function hf(t,e){var n=null;if(t==null||t==="float32")n=new Float32Array(e);else if(t==="int32")n=new Int32Array(e);else if(t==="bool")n=new Uint8Array(e);else{if(t!=="string")throw new Error("Unknown data type "+t);n=new Array(e)}return n}function rW(t,e){for(var n=0;n<t.length;n++){var r=t[n];if(isNaN(r)||!isFinite(r))throw Error("A tensor of type "+e+" being uploaded contains "+r+".")}}function oW(t){return t==="bool"||t==="complex64"||t==="float32"||t==="int32"||t==="string"}function iW(t,e){return e!=="complex64"&&(e!=="float32"||t==="complex64")&&(e!=="int32"||t==="float32"||t==="complex64")&&(e!=="bool"||t!=="bool")}function zr(t){return t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array}function VI(t){if(t==="float32"||t==="int32")return 4;if(t==="complex64")return 8;if(t==="bool")return 1;throw new Error("Unknown dtype "+t)}function aW(t){if(t==null)return 0;var e=0;return t.forEach(function(n){return e+=n.length}),e}function zy(t){return typeof t=="string"||t instanceof String}function sW(t){return typeof t=="boolean"}function uW(t){return typeof t=="number"}function Zc(t){return Array.isArray(t)?Zc(t[0]):t instanceof Float32Array?"float32":t instanceof Int32Array||t instanceof Uint8Array?"int32":uW(t)?"float32":zy(t)?"string":sW(t)?"bool":"float32"}function Bv(t){return!!(t&&t.constructor&&t.call&&t.apply)}function jv(t,e){for(var n=e;n<t;++n)if(t%n==0)return n;return t}function Vr(t){var e=t.length;if(e<2)return[];var n=new Array(e-1);n[e-2]=t[e-1];for(var r=e-3;r>=0;--r)n[r]=n[r+1]*t[r+1];return n}function HI(t,e,n){if(e==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(t)&&(t=Qs(t)),n&&rW(t,e),function(i,a){return i instanceof Float32Array&&a==="float32"||i instanceof Int32Array&&a==="int32"||i instanceof Uint8Array&&a==="bool"}(t,e))return t;if(e==null||e==="float32"||e==="complex64")return new Float32Array(t);if(e==="int32")return new Int32Array(t);if(e==="bool"){for(var r=new Uint8Array(t.length),o=0;o<r.length;++o)Math.round(t[o])!==0&&(r[o]=1);return r}throw new Error("Unknown data type "+e)}function zw(t,e){if(t.length===0)return e[0];var n=t.reduce(function(r,o){return r*o});if(n===0)return[];if(n!==e.length)throw new Error("["+t+"] does not match the input size.");return function r(o,i,a){var s=new Array;if(i.length===1)for(var u=i[0],c=0;c<u;c++)s[c]=a[o+c];else{u=i[0];var l=i.slice(1),d=l.reduce(function(f,h){return f*h});for(c=0;c<u;c++)s[c]=r(o+c*d,l,a)}return s}(0,t,e)}function GI(t,e){for(var n=el(t,e),r=0;r<n.length;r++)n[r]=1;return n}function el(t,e){if(e==null||e==="float32"||e==="complex64")return new Float32Array(t);if(e==="int32")return new Int32Array(t);if(e==="bool")return new Uint8Array(t);throw new Error("Unknown data type "+e)}function Ar(){return K().platform.now()}function KI(t){t.forEach(function(e){N(Number.isInteger(e)&&e>=0,function(){return"Tensor must have a shape comprised of positive integers but got shape ["+t+"]."})})}function cW(t,e){return e===void 0&&(e="utf-8"),e=e||"utf-8",K().platform.encode(t,e)}function pf(t,e){return e===void 0&&(e="utf-8"),e=e||"utf-8",K().platform.decode(t,e)}function Vw(t,e,n){if(e===0)return 0;if(e===1)return t[0];for(var r=t[t.length-1],o=0;o<t.length-1;++o)r+=n[o]*t[o];return r}function lW(t,e,n){if(e===0)return[];if(e===1)return[t];for(var r=new Array(e),o=0;o<r.length-1;++o)r[o]=Math.floor(t/n[o]),t-=r[o]*n[o];return r[r.length-1]=t,r}var dW=function(){function t(e,n){this.backendTimer=e,this.logger=n,n==null&&(this.logger=new fW)}return t.prototype.profileKernel=function(e,n,r){var o,i=this,a=this.backendTimer.time(function(){o=r()});return o.forEach(function(s){s.data().then(function(u){(function(c,l,d){if(l!=="float32")return!1;for(var f=0;f<c.length;f++){var h=c[f];if(isNaN(h)||!isFinite(h))return console.warn("Found "+h+" in the result of '"+d+"'"),!0}})(u,s.dtype,e),a.then(function(c){var l="";c.getExtraProfileInfo!=null&&(l=c.getExtraProfileInfo()),i.logger.logKernelProfile(e,s,u,c.kernelMs,n,l)})})}),o},t}(),fW=function(){function t(){}return t.prototype.logKernelProfile=function(e,n,r,o,i,a){var s=typeof o=="number"?ys(o+"ms",9):o.error,u=ys(e,25),c=n.rank,l=n.size,d=ys(n.shape.toString(),14),f="";for(var h in i){var m=i[h].shape||n.shape,p=m.length;f+=h+": "+p+"D "+(p>0?m:"")+" "}console.log("%c"+u+"	%c"+s+"	%c"+c+"D "+d+"	%c"+l+"	%c"+f+"	%c"+a,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")},t}(),Hw=20,Eu=3,Bp=7;function hW(t,e,n,r){var o=Vr(e),i=function(c,l,d,f){var h=le(l),m=f[f.length-1],p=new Array(m).fill(0),g=l.length,v=d==="complex64"?_u(c):c;if(g>1)for(var y=0;y<h/m;y++)for(var x=y*m,w=0;w<m;w++)p[w]=Math.max(p[w],Cu(v[x+w],0,d).length);return p}(t,e,n,o),a=e.length,s=function c(l,d,f,h,m,p){p===void 0&&(p=!0);var g=f==="complex64"?2:1,v=d[0],y=d.length;if(y===0)return f==="complex64"?[Cu(_u(l)[0],0,f)]:f==="bool"?[qI(l[0])]:[l[0].toString()];if(y===1){if(v>Hw){var x=Eu*g,w=Array.from(l.slice(0,x)),E=Array.from(l.slice((v-Eu)*g,v*g));return f==="complex64"&&(w=_u(w),E=_u(E)),["["+w.map(function(W,U){return Cu(W,m[U],f)}).join(", ")+", ..., "+E.map(function(W,U){return Cu(W,m[v-Eu+U],f)}).join(", ")+"]"]}return["["+(f==="complex64"?_u(l):Array.from(l)).map(function(W,U){return Cu(W,m[U],f)}).join(", ")+"]"]}var _=d.slice(1),S=h.slice(1),k=h[0]*g,I=[];if(v>Hw){for(var R=0;R<Eu;R++){var D=(A=R*k)+k;I.push.apply(I,c(l.slice(A,D),_,f,S,m,!1))}for(I.push("..."),R=v-Eu;R<v;R++)D=(A=R*k)+k,I.push.apply(I,c(l.slice(A,D),_,f,S,m,R===v-1))}else for(R=0;R<v;R++){var A;D=(A=R*k)+k,I.push.apply(I,c(l.slice(A,D),_,f,S,m,R===v-1))}var j=y===2?",":"";for(I[0]="["+I[0]+j,R=1;R<I.length-1;R++)I[R]=" "+I[R]+j;var F=`,
`;for(R=2;R<y;R++)F+=`
`;return I[I.length-1]=" "+I[I.length-1]+"]"+(p?"":F),I}(t,e,n,o,i),u=["Tensor"];return r&&(u.push("  dtype: "+n),u.push("  rank: "+a),u.push("  shape: ["+e+"]"),u.push("  values:")),u.push(s.map(function(c){return"    "+c}).join(`
`)),u.join(`
`)}function Cu(t,e,n){return ys(Array.isArray(t)?parseFloat(t[0].toFixed(Bp))+" + "+parseFloat(t[1].toFixed(Bp))+"j":zy(t)?"'"+t+"'":n==="bool"?qI(t):parseFloat(t.toFixed(Bp)).toString(),e)}function qI(t){return t===0?"false":"true"}function _u(t){for(var e=[],n=0;n<t.length;n+=2)e.push([t[n],t[n+1]]);return e}var _c=function(){function t(e,n,r){var o=this;if(this.dtype=n,this.shape=e.slice(),this.size=le(e),r!=null){var i=r.length;N(i===this.size,function(){return"Length of values '"+i+"' does not match the size inferred by the shape '"+o.size+"'."})}if(n==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||hf(n,this.size),this.strides=Vr(e)}return t.prototype.set=function(e){for(var n=this,r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];r.length===0&&(r=[0]),N(r.length===this.rank,function(){return"The number of provided coordinates ("+r.length+") must match the rank ("+n.rank+")"});var i=this.locToIndex(r);this.values[i]=e},t.prototype.get=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];e.length===0&&(e=[0]);for(var r=0,o=0,i=e;o<i.length;o++){var a=i[o];if(a<0||a>=this.shape[r]){var s="Requested out of range element at "+e+".   Buffer shape="+this.shape;throw new Error(s)}r++}for(var u=e[e.length-1],c=0;c<e.length-1;++c)u+=this.strides[c]*e[c];return this.values[u]},t.prototype.locToIndex=function(e){if(this.rank===0)return 0;if(this.rank===1)return e[0];for(var n=e[e.length-1],r=0;r<e.length-1;++r)n+=this.strides[r]*e[r];return n},t.prototype.indexToLoc=function(e){if(this.rank===0)return[];if(this.rank===1)return[e];for(var n=new Array(this.shape.length),r=0;r<n.length-1;++r)n[r]=Math.floor(e/this.strides[r]),e-=n[r]*this.strides[r];return n[n.length-1]=e,n},Object.defineProperty(t.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),t.prototype.toTensor=function(){return Mr().makeTensor(this.values,this.shape,this.dtype)},t}(),Mr=null,V=null,XI=null,tt=function(){function t(e,n,r,o){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=n||"float32",this.size=le(e),this.strides=Vr(e),this.dataId=r,this.id=o,this.rankType=this.rank<5?this.rank.toString():"higher"}return t.prototype.flatten=function(){return this.throwIfDisposed(),this.as1D()},t.prototype.asScalar=function(){return this.throwIfDisposed(),N(this.size===1,function(){return"The array must have only 1 element."}),this.reshape([])},t.prototype.as1D=function(){return this.throwIfDisposed(),this.reshape([this.size])},t.prototype.as2D=function(e,n){return this.throwIfDisposed(),this.reshape([e,n])},t.prototype.as3D=function(e,n,r){return this.throwIfDisposed(),this.reshape([e,n,r])},t.prototype.as4D=function(e,n,r,o){return this.throwIfDisposed(),this.reshape([e,n,r,o])},t.prototype.as5D=function(e,n,r,o,i){return this.throwIfDisposed(),this.reshape([e,n,r,o,i])},t.prototype.asType=function(e){return this.throwIfDisposed(),V.cast(this,e)},Object.defineProperty(t.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),t.prototype.buffer=function(){return ue(this,void 0,void 0,function(){var e;return ce(this,function(n){switch(n.label){case 0:return[4,this.data()];case 1:return e=n.sent(),[2,V.buffer(this.shape,this.dtype,e)]}})})},t.prototype.bufferSync=function(){return V.buffer(this.shape,this.dtype,this.dataSync())},t.prototype.array=function(){return ue(this,void 0,void 0,function(){var e;return ce(this,function(n){switch(n.label){case 0:return[4,this.data()];case 1:return e=n.sent(),[2,zw(this.shape,e)]}})})},t.prototype.arraySync=function(){return zw(this.shape,this.dataSync())},t.prototype.data=function(){return ue(this,void 0,void 0,function(){var e,n;return ce(this,function(r){switch(r.label){case 0:return this.throwIfDisposed(),e=Mr().read(this.dataId),this.dtype!=="string"?[3,2]:[4,e];case 1:n=r.sent();try{return[2,n.map(function(o){return pf(o)})]}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}r.label=2;case 2:return[2,e]}})})},t.prototype.dataSync=function(){this.throwIfDisposed();var e=Mr().readSync(this.dataId);if(this.dtype==="string")try{return e.map(function(n){return pf(n)})}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e},t.prototype.bytes=function(){return ue(this,void 0,void 0,function(){var e;return ce(this,function(n){switch(n.label){case 0:return this.throwIfDisposed(),[4,Mr().read(this.dataId)];case 1:return e=n.sent(),this.dtype==="string"?[2,e]:[2,new Uint8Array(e.buffer)]}})})},t.prototype.dispose=function(){this.isDisposed||(Mr().disposeTensor(this),this.isDisposedInternal=!0)},Object.defineProperty(t.prototype,"isDisposed",{get:function(){return this.isDisposedInternal},enumerable:!0,configurable:!0}),t.prototype.throwIfDisposed=function(){if(this.isDisposed)throw new Error("Tensor is disposed.")},t.prototype.toFloat=function(){return this.asType("float32")},t.prototype.toInt=function(){return this.asType("int32")},t.prototype.toBool=function(){return this.asType("bool")},t.prototype.print=function(e){return e===void 0&&(e=!1),V.print(this,e)},t.prototype.reshape=function(e){return this.throwIfDisposed(),V.reshape(this,e)},t.prototype.reshapeAs=function(e){return this.throwIfDisposed(),this.reshape(e.shape)},t.prototype.expandDims=function(e){return e===void 0&&(e=0),V.expandDims(this,e)},t.prototype.cumsum=function(e,n,r){return e===void 0&&(e=0),n===void 0&&(n=!1),r===void 0&&(r=!1),V.cumsum(this,e,n,r)},t.prototype.squeeze=function(e){return this.throwIfDisposed(),V.squeeze(this,e)},t.prototype.clone=function(){return this.throwIfDisposed(),V.clone(this)},t.prototype.oneHot=function(e,n,r){return this.throwIfDisposed(),V.oneHot(this,e,n,r)},t.prototype.toString=function(e){return e===void 0&&(e=!1),hW(this.dataSync(),this.shape,this.dtype,e)},t.prototype.tile=function(e){return this.throwIfDisposed(),V.tile(this,e)},t.prototype.gather=function(e,n){return n===void 0&&(n=0),this.throwIfDisposed(),V.gather(this,e,n)},t.prototype.matMul=function(e,n,r){return n===void 0&&(n=!1),r===void 0&&(r=!1),this.throwIfDisposed(),V.matMul(this,e,n,r)},t.prototype.dot=function(e){return this.throwIfDisposed(),V.dot(this,e)},t.prototype.norm=function(e,n,r){return e===void 0&&(e="euclidean"),n===void 0&&(n=null),r===void 0&&(r=!1),this.throwIfDisposed(),V.norm(this,e,n,r)},t.prototype.slice=function(e,n){return this.throwIfDisposed(),V.slice(this,e,n)},t.prototype.reverse=function(e){return this.throwIfDisposed(),V.reverse(this,e)},t.prototype.concat=function(e,n){return n===void 0&&(n=0),this.throwIfDisposed(),e instanceof t&&(e=[e]),V.concat([this].concat(e),n)},t.prototype.split=function(e,n){return n===void 0&&(n=0),this.throwIfDisposed(),V.split(this,e,n)},t.prototype.stack=function(e,n){return n===void 0&&(n=0),V.stack([this,e],n)},t.prototype.unstack=function(e){return e===void 0&&(e=0),V.unstack(this,e)},t.prototype.pad=function(e,n){return n===void 0&&(n=0),V.pad(this,e,n)},t.prototype.batchNormalization=function(e,n,r,o,i){return r===void 0&&(r=.001),XI("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon"),this.batchNorm(e,n,i,o,r)},t.prototype.batchNorm=function(e,n,r,o,i){return i===void 0&&(i=.001),this.throwIfDisposed(),V.batchNorm(this,e,n,r,o,i)},t.prototype.all=function(e,n){return e===void 0&&(e=null),n===void 0&&(n=!1),this.throwIfDisposed(),V.all(this,e,n)},t.prototype.any=function(e,n){return e===void 0&&(e=null),n===void 0&&(n=!1),this.throwIfDisposed(),V.any(this,e,n)},t.prototype.logSumExp=function(e,n){return e===void 0&&(e=null),n===void 0&&(n=!1),this.throwIfDisposed(),V.logSumExp(this,e,n)},t.prototype.sum=function(e,n){return e===void 0&&(e=null),n===void 0&&(n=!1),this.throwIfDisposed(),V.sum(this,e,n)},t.prototype.prod=function(e,n){return e===void 0&&(e=null),n===void 0&&(n=!1),this.throwIfDisposed(),V.prod(this,e,n)},t.prototype.mean=function(e,n){return e===void 0&&(e=null),n===void 0&&(n=!1),this.throwIfDisposed(),V.mean(this,e,n)},t.prototype.min=function(e,n){return e===void 0&&(e=null),n===void 0&&(n=!1),this.throwIfDisposed(),V.min(this,e,n)},t.prototype.max=function(e,n){return e===void 0&&(e=null),n===void 0&&(n=!1),this.throwIfDisposed(),V.max(this,e,n)},t.prototype.argMin=function(e){return e===void 0&&(e=null),this.throwIfDisposed(),V.argMin(this,e)},t.prototype.argMax=function(e){return e===void 0&&(e=null),this.throwIfDisposed(),V.argMax(this,e)},t.prototype.cast=function(e){return this.throwIfDisposed(),V.cast(this,e)},t.prototype.add=function(e){return this.throwIfDisposed(),V.add(this,e)},t.prototype.addStrict=function(e){return this.throwIfDisposed(),V.addStrict(this,e)},t.prototype.atan2=function(e){return this.throwIfDisposed(),V.atan2(this,e)},t.prototype.sub=function(e){return this.throwIfDisposed(),V.sub(this,e)},t.prototype.subStrict=function(e){return this.throwIfDisposed(),V.subStrict(this,e)},t.prototype.pow=function(e){return this.throwIfDisposed(),V.pow(this,e)},t.prototype.powStrict=function(e){return this.throwIfDisposed(),V.powStrict(this,e)},t.prototype.mul=function(e){return this.throwIfDisposed(),V.mul(this,e)},t.prototype.mulStrict=function(e){return this.throwIfDisposed(),V.mulStrict(this,e)},t.prototype.div=function(e){return this.throwIfDisposed(),V.div(this,e)},t.prototype.divNoNan=function(e){return this.throwIfDisposed(),V.divNoNan(this,e)},t.prototype.floorDiv=function(e){return this.throwIfDisposed(),V.floorDiv(this,e)},t.prototype.divStrict=function(e){return this.throwIfDisposed(),V.divStrict(this,e)},t.prototype.minimum=function(e){return this.throwIfDisposed(),V.minimum(this,e)},t.prototype.minimumStrict=function(e){return this.throwIfDisposed(),V.minimumStrict(this,e)},t.prototype.maximum=function(e){return this.throwIfDisposed(),V.maximum(this,e)},t.prototype.maximumStrict=function(e){return this.throwIfDisposed(),V.maximumStrict(this,e)},t.prototype.mod=function(e){return this.throwIfDisposed(),V.mod(this,e)},t.prototype.modStrict=function(e){return this.throwIfDisposed(),V.modStrict(this,e)},t.prototype.squaredDifferenceStrict=function(e){return this.throwIfDisposed(),V.squaredDifferenceStrict(this,e)},t.prototype.transpose=function(e){return this.throwIfDisposed(),V.transpose(this,e)},t.prototype.notEqual=function(e){return this.throwIfDisposed(),V.notEqual(this,e)},t.prototype.notEqualStrict=function(e){return this.throwIfDisposed(),V.notEqualStrict(this,e)},t.prototype.less=function(e){return this.throwIfDisposed(),V.less(this,e)},t.prototype.lessStrict=function(e){return this.throwIfDisposed(),V.lessStrict(this,e)},t.prototype.equal=function(e){return this.throwIfDisposed(),V.equal(this,e)},t.prototype.equalStrict=function(e){return this.throwIfDisposed(),V.equalStrict(this,e)},t.prototype.lessEqual=function(e){return this.throwIfDisposed(),V.lessEqual(this,e)},t.prototype.lessEqualStrict=function(e){return this.throwIfDisposed(),V.lessEqualStrict(this,e)},t.prototype.greater=function(e){return this.throwIfDisposed(),V.greater(this,e)},t.prototype.greaterStrict=function(e){return this.throwIfDisposed(),V.greaterStrict(this,e)},t.prototype.greaterEqual=function(e){return this.throwIfDisposed(),V.greaterEqual(this,e)},t.prototype.greaterEqualStrict=function(e){return this.throwIfDisposed(),V.greaterEqualStrict(this,e)},t.prototype.logicalAnd=function(e){return this.throwIfDisposed(),V.logicalAnd(this,e)},t.prototype.logicalOr=function(e){return this.throwIfDisposed(),V.logicalOr(this,e)},t.prototype.logicalNot=function(){return this.throwIfDisposed(),V.logicalNot(this)},t.prototype.logicalXor=function(e){return this.throwIfDisposed(),V.logicalXor(this,e)},t.prototype.where=function(e,n){return this.throwIfDisposed(),V.where(e,this,n)},t.prototype.neg=function(){return this.throwIfDisposed(),V.neg(this)},t.prototype.ceil=function(){return this.throwIfDisposed(),V.ceil(this)},t.prototype.floor=function(){return this.throwIfDisposed(),V.floor(this)},t.prototype.sign=function(){return this.throwIfDisposed(),V.sign(this)},t.prototype.isNaN=function(){return this.throwIfDisposed(),V.isNaN(this)},t.prototype.isInf=function(){return this.throwIfDisposed(),V.isInf(this)},t.prototype.isFinite=function(){return this.throwIfDisposed(),V.isFinite(this)},t.prototype.exp=function(){return this.throwIfDisposed(),V.exp(this)},t.prototype.expm1=function(){return this.throwIfDisposed(),V.expm1(this)},t.prototype.log=function(){return this.throwIfDisposed(),V.log(this)},t.prototype.log1p=function(){return this.throwIfDisposed(),V.log1p(this)},t.prototype.sqrt=function(){return this.throwIfDisposed(),V.sqrt(this)},t.prototype.rsqrt=function(){return this.throwIfDisposed(),V.rsqrt(this)},t.prototype.square=function(){return this.throwIfDisposed(),V.square(this)},t.prototype.reciprocal=function(){return this.throwIfDisposed(),V.reciprocal(this)},t.prototype.abs=function(){return this.throwIfDisposed(),V.abs(this)},t.prototype.clipByValue=function(e,n){return this.throwIfDisposed(),V.clipByValue(this,e,n)},t.prototype.relu=function(){return this.throwIfDisposed(),V.relu(this)},t.prototype.relu6=function(){return this.throwIfDisposed(),V.relu6(this)},t.prototype.elu=function(){return this.throwIfDisposed(),V.elu(this)},t.prototype.selu=function(){return this.throwIfDisposed(),V.selu(this)},t.prototype.leakyRelu=function(e){return e===void 0&&(e=.2),this.throwIfDisposed(),V.leakyRelu(this,e)},t.prototype.prelu=function(e){return this.throwIfDisposed(),V.prelu(this,e)},t.prototype.sigmoid=function(){return this.throwIfDisposed(),V.sigmoid(this)},t.prototype.logSigmoid=function(){return this.throwIfDisposed(),V.logSigmoid(this)},t.prototype.softplus=function(){return this.throwIfDisposed(),V.softplus(this)},t.prototype.zerosLike=function(){return this.throwIfDisposed(),V.zerosLike(this)},t.prototype.onesLike=function(){return this.throwIfDisposed(),V.onesLike(this)},t.prototype.sin=function(){return this.throwIfDisposed(),V.sin(this)},t.prototype.cos=function(){return this.throwIfDisposed(),V.cos(this)},t.prototype.tan=function(){return this.throwIfDisposed(),V.tan(this)},t.prototype.asin=function(){return this.throwIfDisposed(),V.asin(this)},t.prototype.acos=function(){return this.throwIfDisposed(),V.acos(this)},t.prototype.atan=function(){return this.throwIfDisposed(),V.atan(this)},t.prototype.sinh=function(){return this.throwIfDisposed(),V.sinh(this)},t.prototype.cosh=function(){return this.throwIfDisposed(),V.cosh(this)},t.prototype.tanh=function(){return this.throwIfDisposed(),V.tanh(this)},t.prototype.asinh=function(){return this.throwIfDisposed(),V.asinh(this)},t.prototype.acosh=function(){return this.throwIfDisposed(),V.acosh(this)},t.prototype.atanh=function(){return this.throwIfDisposed(),V.atanh(this)},t.prototype.erf=function(){return this.throwIfDisposed(),V.erf(this)},t.prototype.round=function(){return this.throwIfDisposed(),V.round(this)},t.prototype.step=function(e){return e===void 0&&(e=0),this.throwIfDisposed(),V.step(this,e)},t.prototype.softmax=function(e){return e===void 0&&(e=-1),this.throwIfDisposed(),V.softmax(this,e)},t.prototype.logSoftmax=function(e){return e===void 0&&(e=-1),this.throwIfDisposed(),V.logSoftmax(this,e)},t.prototype.resizeBilinear=function(e,n){return n===void 0&&(n=!1),this.throwIfDisposed(),V.image.resizeBilinear(this,e,n)},t.prototype.resizeNearestNeighbor=function(e,n){return n===void 0&&(n=!1),this.throwIfDisposed(),V.image.resizeNearestNeighbor(this,e,n)},t.prototype.conv1d=function(e,n,r,o,i,a){return o===void 0&&(o="NWC"),i===void 0&&(i=1),this.throwIfDisposed(),V.conv1d(this,e,n,r,o,i,a)},t.prototype.conv2d=function(e,n,r,o,i,a){return o===void 0&&(o="NHWC"),i===void 0&&(i=[1,1]),this.throwIfDisposed(),V.conv2d(this,e,n,r,o,i,a)},t.prototype.conv2dTranspose=function(e,n,r,o,i){return this.throwIfDisposed(),V.conv2dTranspose(this,e,n,r,o,i)},t.prototype.depthwiseConv2D=function(e,n,r,o,i,a){return o===void 0&&(o="NHWC"),i===void 0&&(i=[1,1]),this.throwIfDisposed(),V.depthwiseConv2d(this,e,n,r,o,i,a)},t.prototype.separableConv2d=function(e,n,r,o,i,a){return i===void 0&&(i=[1,1]),a===void 0&&(a="NHWC"),this.throwIfDisposed(),V.separableConv2d(this,e,n,r,o,i,a)},t.prototype.avgPool=function(e,n,r,o){return this.throwIfDisposed(),V.avgPool(this,e,n,r,o)},t.prototype.maxPool=function(e,n,r,o){return this.throwIfDisposed(),V.maxPool(this,e,n,r,o)},t.prototype.localResponseNormalization=function(e,n,r,o){return e===void 0&&(e=5),n===void 0&&(n=1),r===void 0&&(r=1),o===void 0&&(o=.5),V.localResponseNormalization(this,e,n,r,o)},t.prototype.pool=function(e,n,r,o,i){return this.throwIfDisposed(),V.pool(this,e,n,r,o,i)},t.prototype.variable=function(e,n,r){return e===void 0&&(e=!0),this.throwIfDisposed(),Mr().makeVariable(this,e,n,r)},t.prototype.unsortedSegmentSum=function(e,n){return this.throwIfDisposed(),V.unsortedSegmentSum(this,e,n)},t.prototype.batchToSpaceND=function(e,n){return this.throwIfDisposed(),V.batchToSpaceND(this,e,n)},t.prototype.spaceToBatchND=function(e,n){return this.throwIfDisposed(),V.spaceToBatchND(this,e,n)},t.prototype.topk=function(e,n){return e===void 0&&(e=1),n===void 0&&(n=!0),this.throwIfDisposed(),V.topk(this,e,n)},t.prototype.stridedSlice=function(e,n,r,o,i,a,s,u){return o===void 0&&(o=0),i===void 0&&(i=0),a===void 0&&(a=0),s===void 0&&(s=0),u===void 0&&(u=0),this.throwIfDisposed(),V.stridedSlice(this,e,n,r,o,i,a,s,u)},t.prototype.depthToSpace=function(e,n){return this.throwIfDisposed(),V.depthToSpace(this,e,n)},t.prototype.fft=function(){return this.throwIfDisposed(),V.spectral.fft(this)},t.prototype.ifft=function(){return this.throwIfDisposed(),V.spectral.ifft(this)},t.prototype.rfft=function(){return this.throwIfDisposed(),V.spectral.rfft(this)},t.prototype.irfft=function(){return this.throwIfDisposed(),V.spectral.irfft(this)},t}();Object.defineProperty(tt,Symbol.hasInstance,{value:function(t){return!!t&&t.dataId!=null&&t.shape!=null&&t.dtype!=null}});var Gw,Uv,Wv,$v,zv,Js=function(t){function e(n,r,o,i){var a=t.call(this,n.shape,n.dtype,n.dataId,i)||this;return a.trainable=r,a.name=o,a}return br(e,t),e.prototype.assign=function(n){if(n.dtype!==this.dtype)throw new Error("dtype of the new value ("+n.dtype+") and previous value ("+this.dtype+") must match");if(!Nt(n.shape,this.shape))throw new Error("shape of the new value ("+n.shape+") and previous value ("+this.shape+") must match");Mr().disposeTensor(this),this.dataId=n.dataId,Mr().incRef(this,null)},e.prototype.dispose=function(){Mr().disposeVariable(this),this.isDisposedInternal=!0},e}(tt);Object.defineProperty(Js,Symbol.hasInstance,{value:function(t){return t instanceof tt&&t.assign!=null&&t.assign instanceof Function}}),function(t){t.R0="R0",t.R1="R1",t.R2="R2",t.R3="R3",t.R4="R4",t.R5="R5",t.R6="R6"}(Gw||(Gw={})),function(t){t.float32="float32",t.int32="int32",t.bool="int32",t.complex64="complex64"}(Uv||(Uv={})),function(t){t.float32="float32",t.int32="int32",t.bool="bool",t.complex64="complex64"}(Wv||(Wv={})),function(t){t.float32="float32",t.int32="float32",t.bool="float32",t.complex64="complex64"}($v||($v={})),function(t){t.float32="complex64",t.int32="complex64",t.bool="complex64",t.complex64="complex64"}(zv||(zv={}));var pW={float32:$v,int32:Uv,bool:Wv,complex64:zv};function Ot(t,e){if(t==="string"||e==="string"){if(t==="string"&&e==="string")return"string";throw new Error("Can not upcast "+t+" with "+e)}return pW[t][e]}function jp(t){return Ot(t,"int32")}function it(t,e){if(t.dtype===e.dtype)return[t,e];var n=Ot(t.dtype,e.dtype);return[t.cast(n),e.cast(n)]}function mW(t,e){N(t.dtype===e.dtype,function(){return"The dtypes of the first("+t.dtype+") and second("+e.dtype+") input must match"})}function YI(t){var e=[];return function n(r,o,i){if(r!=null){if(r instanceof tt)return void o.push(r);if(a=r,!(!Array.isArray(a)&&typeof a!="object")){var a,s=r;for(var u in s){var c=s[u];i.has(c)||(i.add(c),n(c,o,i))}}}}(t,e,new Set),e}var Up,Kw=function(){function t(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null}}return t.prototype.dispose=function(){for(var e in this.registeredVariables)this.registeredVariables[e].dispose()},t}(),vW=function(){function t(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new Kw}return t.prototype.ready=function(){return ue(this,void 0,void 0,function(){var e,n,r;return ce(this,function(o){switch(o.label){case 0:if(this.pendingBackendInit!=null)return[2,this.pendingBackendInit.then(function(){})];if(this.backendInstance!=null)return[2];e=this.getSortedBackends(),n=0,o.label=1;case 1:return n<e.length?(r=e[n],[4,this.initializeBackend(r).success]):[3,5];case 2:return o.sent()?[4,this.setBackend(r)]:[3,4];case 3:return o.sent(),[2];case 4:return n++,[3,1];case 5:throw new Error("Could not initialize any backends, all backend initializations failed.")}})})},Object.defineProperty(t.prototype,"backend",{get:function(){if(this.pendingBackendInit!=null)throw new Error("Backend '"+this.backendName+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");if(this.backendInstance==null){var e=this.initializeBackendsAndReturnBest(),n=e.name;if(e.asyncInit)throw new Error("The highest priority backend '"+n+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");this.setBackend(n)}return this.backendInstance},enumerable:!0,configurable:!0}),t.prototype.backendNames=function(){return Object.keys(this.registryFactory)},t.prototype.findBackend=function(e){return!(e in this.registry)&&(!(e in this.registryFactory)||this.initializeBackend(e).asyncInit)?null:this.registry[e]},t.prototype.findBackendFactory=function(e){return e in this.registryFactory?this.registryFactory[e].factory:null},t.prototype.registerBackend=function(e,n,r){return r===void 0&&(r=1),e in this.registryFactory?(console.warn(e+" backend was already registered. Reusing existing backend factory."),!1):(this.registryFactory[e]={factory:n,priority:r},!0)},t.prototype.setBackend=function(e){return ue(this,void 0,void 0,function(){var n,r,o;return ce(this,function(i){switch(i.label){case 0:if(this.registryFactory[e]==null)throw new Error("Backend name '"+e+"' not found in registry");return this.backendName=e,this.registry[e]!=null?[3,4]:(this.backendInstance=null,n=this.initializeBackend(e),r=n.success,n.asyncInit?[4,r]:[3,2]);case 1:return o=i.sent(),[3,3];case 2:o=r,i.label=3;case 3:if(!o)return[2,!1];i.label=4;case 4:return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new dW(this.backendInstance),[2,!0]}})})},t.prototype.setupRegisteredKernels=function(){var e=this;Ww(this.backendName).forEach(function(n){n.setupFunc!=null&&n.setupFunc(e.backendInstance)})},t.prototype.disposeRegisteredKernels=function(e){var n=this;Ww(e).forEach(function(r){r.disposeFunc!=null&&r.disposeFunc(n.registry[e])})},t.prototype.initializeBackend=function(e){var n=this,r=this.registryFactory[e];if(r==null)throw new Error("Cannot initialize backend "+e+", no registration found.");try{var o=r.factory();if(Promise.resolve(o)===o){var i=++this.pendingBackendInitId,a=o.then(function(s){return!(i<n.pendingBackendInitId)&&(n.registry[e]=s,n.pendingBackendInit=null,!0)}).catch(function(s){return!(i<n.pendingBackendInitId)&&(n.pendingBackendInit=null,console.warn("Initialization of backend "+e+" failed"),console.warn(s.stack||s.message),!1)});return this.pendingBackendInit=a,{success:a,asyncInit:!0}}return this.registry[e]=o,{success:!0,asyncInit:!1}}catch(s){return console.warn("Initialization of backend "+e+" failed"),console.warn(s.stack||s.message),{success:!1,asyncInit:!1}}},t.prototype.removeBackend=function(e){if(!(e in this.registryFactory))throw new Error(e+" backend not found in registry");this.backendName===e&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)},t.prototype.getSortedBackends=function(){var e=this;if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort(function(n,r){return e.registryFactory[r].priority-e.registryFactory[n].priority})},t.prototype.initializeBackendsAndReturnBest=function(){for(var e=this.getSortedBackends(),n=0;n<e.length;n++){var r=e[n],o=this.initializeBackend(r),i=o.success,a=o.asyncInit;if(a||i)return{name:r,asyncInit:a}}throw new Error("Could not initialize any backends, all backend initializations failed.")},t.prototype.moveData=function(e,n){var r=this.state.tensorInfo.get(n),o=r.backend,i=this.readSync(n);o.disposeData(n),r.backend=e,e.move(n,i,r.shape,r.dtype),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++},t.prototype.tidy=function(e,n){var r,o=this,i=null;if(n==null){if(typeof e!="function")throw new Error("Please provide a function to tidy()");n=e}else{if(typeof e!="string"&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof n!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");i=e}return this.scopedRun(function(){return o.startScope(i)},function(){return o.endScope(r)},function(){return(r=n())instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),r})},t.prototype.scopedRun=function(e,n,r){e();try{var o=r();return n(),o}catch(i){throw n(),i}},t.prototype.nextTensorId=function(){return t.nextTensorId++},t.prototype.nextVariableId=function(){return t.nextVariableId++},t.prototype.clone=function(e){var n=this.makeTensorFromDataId(e.dataId,e.shape,e.dtype),r={x:e};return this.addTapeNode(this.state.activeScope.name,r,[n],function(o){return{x:function(){return o.toFloat()}}},[]),n},t.prototype.runKernel=function(e,n,r,o,i){return this.runKernelFunc(null,n,null,e,r,o,i)},t.prototype.shouldCheckForMemLeaks=function(){return this.ENV.getBool("IS_TEST")},t.prototype.checkKernelForMemLeak=function(e,n,r){var o=this.backend.numDataIds(),i=0;r.forEach(function(u){i+=u.dtype==="complex64"?3:1});var a=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],s=o-n-i-a;if(s>0)throw new Error("Backend '"+this.backendName+"' has an internal memory leak ("+s+" data ids) after running '"+e+"'")},t.prototype.runKernelFunc=function(e,n,r,o,i,a,s){var u,c=this;a===void 0&&(a=[]),s===void 0&&(s=[]);var l=[],d=this.isTapeOn();o==null&&(o=this.state.activeScope!=null?this.state.activeScope.name:"");var f,h=function(y){d&&(l=y.map(function(x){return c.keep(c.clone(x))}))},m=this.state.numBytes,p=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);var g,v=UI(o,this.backendName);return f=v!=null?function(){var y=c.backend.numDataIds();g=v.kernelFunc({inputs:n,attrs:i,backend:c.backend});var x=Array.isArray(g)?g:[g];c.shouldCheckForMemLeaks()&&c.checkKernelForMemLeak(o,y,x);var w=x.map(function(_){var S=_.dataId,k=_.shape,I=_.dtype;return c.makeTensorFromDataId(S,k,I)}),E=w.filter(function(_,S){return s[S]});return h((a||[]).slice().concat(E)),w}:function(){var y=c.backend.numDataIds();g=c.tidy(function(){return e(c.backend,h)});var x=Array.isArray(g)?g:[g];return c.shouldCheckForMemLeaks()&&c.checkKernelForMemLeak(o,y,x),x},this.scopedRun(function(){return c.state.kernelDepth++},function(){return c.state.kernelDepth--},function(){u=c.ENV.getBool("DEBUG")?c.profiler.profileKernel(o,n,function(){return f()}):f()}),d&&this.addTapeNode(o,n,u,r,l),this.state.profiling&&this.state.activeProfile.kernels.push({name:o,bytesAdded:this.state.numBytes-m,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-p,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(n).map(function(y){return n[y].shape}),outputShapes:u.map(function(y){return y.shape})}),Array.isArray(g)?u:u[0]},t.prototype.makeTensor=function(e,n,r,o){if(e==null)throw new Error("Values passed to engine.makeTensor() are null");r=r||"float32",o=o||this.backend;var i=e;r==="string"&&zy(e[0])&&(i=e.map(function(l){return cW(l)}));var a=o.write(i,n,r),s=new tt(n,r,a,this.nextTensorId());if(this.incRef(s,o),r==="string"){var u=this.state.tensorInfo.get(a),c=aW(i);this.state.numBytes+=c-u.bytes,u.bytes=c}return s},t.prototype.makeTensorFromDataId=function(e,n,r,o){var i=new tt(n,r=r||"float32",e,this.nextTensorId());return this.incRef(i,o),i},t.prototype.makeVariable=function(e,n,r,o){n===void 0&&(n=!0),r=r||this.nextVariableId().toString(),o!=null&&o!==e.dtype&&(e=e.asType(o));var i=new Js(e,n,r,this.nextTensorId());if(this.state.registeredVariables[i.name]!=null)throw new Error("Variable with name "+i.name+" was already registered");return this.state.registeredVariables[i.name]=i,this.incRef(i,this.backend),i},t.prototype.incRef=function(e,n){var r=this.state.tensorInfo.has(e.dataId)?this.state.tensorInfo.get(e.dataId).refCount:0;if(this.state.numTensors++,e.dtype==="string"&&this.state.numStringTensors++,r===0){this.state.numDataBuffers++;var o=0;e.dtype!=="complex64"&&e.dtype!=="string"&&(o=e.size*VI(e.dtype)),this.state.tensorInfo.set(e.dataId,{backend:n||this.backend,dtype:e.dtype,shape:e.shape,bytes:o,refCount:0}),this.state.numBytes+=o}this.state.tensorInfo.get(e.dataId).refCount++,e instanceof Js||this.track(e)},t.prototype.disposeTensor=function(e){if(this.state.tensorInfo.has(e.dataId)){this.state.numTensors--,e.dtype==="string"&&this.state.numStringTensors--;var n=this.state.tensorInfo.get(e.dataId);n.refCount<=1?(e.dtype!=="complex64"&&(this.state.numBytes-=n.bytes),this.state.numDataBuffers--,n.backend.disposeData(e.dataId),this.state.tensorInfo.delete(e.dataId)):this.state.tensorInfo.get(e.dataId).refCount--}},t.prototype.disposeVariables=function(){for(var e in this.state.registeredVariables){var n=this.state.registeredVariables[e];this.disposeVariable(n)}},t.prototype.disposeVariable=function(e){this.disposeTensor(e),this.state.registeredVariables[e.name]!=null&&delete this.state.registeredVariables[e.name]},t.prototype.memory=function(){var e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,e.reasons==null&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e},t.prototype.profile=function(e){return ue(this,void 0,void 0,function(){var n,r;return ce(this,function(o){return this.state.profiling=!0,n=this.state.numBytes,r=this.state.numTensors,this.state.activeProfile.kernels=[],this.state.activeProfile.result=e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max.apply(Math,this.state.activeProfile.kernels.map(function(i){return i.totalBytesSnapshot})),this.state.activeProfile.newBytes=this.state.numBytes-n,this.state.activeProfile.newTensors=this.state.numTensors-r,[2,this.state.activeProfile]})})},t.prototype.isTapeOn=function(){return this.state.gradientDepth>0&&this.state.kernelDepth===0},t.prototype.addTapeNode=function(e,n,r,o,i){var a=this,s={id:this.state.nextTapeNodeId++,kernelName:e,inputs:n,outputs:r,saved:i},u=JU(e);u!=null&&(o=u.gradFunc),o!=null&&(s.gradient=function(c){return c=c.map(function(l,d){if(l==null){var f=r[d],h=el(f.size,f.dtype);return a.makeTensor(h,f.shape,f.dtype)}return l}),o(c.length>1?c:c[0],i)}),this.state.activeTape.push(s)},t.prototype.keep=function(e){return e.kept=!0,e},t.prototype.startTape=function(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++},t.prototype.endTape=function(){this.state.gradientDepth--},t.prototype.startScope=function(e){var n={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(n.name=e),this.state.scopeStack.push(n),this.state.activeScope=n},t.prototype.endScope=function(e){for(var n=this,r=YI(e),o=new Set(r.map(function(u){return u.id})),i=0;i<this.state.activeScope.track.length;i++){var a=this.state.activeScope.track[i];a.kept||o.has(a.id)||a.dispose()}var s=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],r.forEach(function(u){u.kept||u.scopeId!==s.id||n.track(u)})},t.prototype.gradients=function(e,n,r,o){var i=this;if(o===void 0&&(o=!1),N(n.length>0,function(){return"gradients() received an empty list of xs."}),r!=null&&r.dtype!=="float32")throw new Error("dy must have 'float32' dtype, but has '"+r.dtype+"'");var a=this.scopedRun(function(){return i.startTape()},function(){return i.endTape()},function(){return i.tidy("forward",e)});N(a instanceof tt,function(){return"The result y returned by f() must be a tensor."});var s=function(u,c,l){for(var d={},f={},h=0;h<c.length;h++)d[c[h].id]=!0;for(h=0;h<u.length;h++){var m=(_=u[h]).inputs;for(var p in m){for(var g=m[p],v=!1,y=0;y<c.length;y++)if(d[g.id]){_.outputs.forEach(function(R){return d[R.id]=!0}),v=!0,f[_.id]=!0;break}if(v)break}}var x={};x[l.id]=!0;var w={};for(h=u.length-1;h>=0;h--)for(m=(_=u[h]).inputs,y=0;y<_.outputs.length;y++)if(x[_.outputs[y].id]){for(var p in m)x[m[p].id]=!0,w[_.id]=!0;break}var E=[];for(h=0;h<u.length;h++){var _;if(f[(_=u[h]).id]&&w[_.id]){var S={};for(var p in _.inputs){var k=_.inputs[p];d[k.id]&&(S[p]=k)}var I=Object.assign({},_);I.inputs=S,I.outputs=_.outputs,E.push(I)}}return E}(this.state.activeTape,n,a);if(!o&&s.length===0&&n.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",function(){var u,c,l={};l[a.id]=r??(u=a.shape,c=GI(le(u),"float32"),L.makeTensor(c,u,"float32")),function(f,h,m){for(var p=function(v){var y=h[v],x=[];if(y.outputs.forEach(function(S){var k=f[S.id];k!=null?x.push(k):x.push(null)}),y.gradient==null)throw new Error("Cannot compute gradient: gradient function not found for "+y.kernelName+".");var w=y.gradient(x),E=function(S){if(!(S in w))throw new Error("Cannot backprop through input "+S+". Available gradients found: "+Object.keys(w)+".");var k=m(function(){return w[S]()});if(k.dtype!=="float32")throw new Error("Error in gradient for op "+y.kernelName+". The gradient of input "+S+" must have 'float32' dtype, but has '"+k.dtype+"'");var I=y.inputs[S];if(!Nt(k.shape,I.shape))throw new Error("Error in gradient for op "+y.kernelName+". The gradient of input '"+S+"' has shape '"+k.shape+"', which does not match the shape of the input '"+I.shape+"'");if(f[I.id]==null)f[I.id]=k;else{var R=f[I.id];f[I.id]=R.add(k),R.dispose()}};for(var _ in y.inputs)E(_)},g=h.length-1;g>=0;g--)p(g)}(l,s,function(f){return i.tidy(f)});var d=n.map(function(f){return l[f.id]});return i.state.gradientDepth===0&&(i.state.activeTape.forEach(function(f){for(var h=0,m=f.saved;h<m.length;h++)m[h].dispose()}),i.state.activeTape=null),{value:a,grads:d}})},t.prototype.customGrad=function(e){var n=this;return N(Bv(e),function(){return"The f passed in customGrad(f) must be a function."}),function(){for(var r,o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];N(o.every(function(s){return s instanceof tt}),function(){return"The args passed in customGrad(f)(x1, x2,...) must all be tensors"});var a={};return o.forEach(function(s,u){a[u]=s}),n.runKernelFunc(function(s,u){return N((r=e.apply(void 0,o.concat([u]))).value instanceof tt,function(){return"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"}),N(Bv(r.gradFunc),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."}),r.value},a,function(s,u){var c=r.gradFunc(s,u),l=Array.isArray(c)?c:[c];N(l.length===o.length,function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."}),N(l.every(function(f){return f instanceof tt}),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."});var d={};return l.forEach(function(f,h){d[h]=function(){return f}}),d})}},t.prototype.readSync=function(e){return this.state.tensorInfo.get(e).backend.readSync(e)},t.prototype.read=function(e){return this.state.tensorInfo.get(e).backend.read(e)},t.prototype.time=function(e){return ue(this,void 0,void 0,function(){var n,r;return ce(this,function(o){switch(o.label){case 0:return n=Ar(),[4,this.backend.time(e)];case 1:return(r=o.sent()).wallMs=Ar()-n,[2,r]}})})},t.prototype.track=function(e){return this.state.activeScope!=null&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e},Object.defineProperty(t.prototype,"registeredVariables",{get:function(){return this.state.registeredVariables},enumerable:!0,configurable:!0}),t.prototype.reset=function(){for(var e in this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new Kw,this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null},t.nextTensorId=0,t.nextVariableId=0,t}(),L=function(){var t=function(){if(Up==null){var n=void 0;if(typeof window<"u")n=window;else if(typeof global<"u")n=global;else if(typeof process<"u")n=process;else{if(typeof self>"u")throw new Error("Could not find a global object");n=self}Up=n}return Up}();if(t._tfengine==null){var e=new YU(t);t._tfengine=new vW(e)}return function(n){jI=n}(t._tfengine.ENV),Mr=function(){return t._tfengine},t._tfengine}();function QI(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}var to=K();to.registerFlag("DEBUG",function(){return!1},function(t){t&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")}),to.registerFlag("IS_BROWSER",function(){return QI()}),to.registerFlag("IS_NODE",function(){return typeof process<"u"&&process.versions!==void 0&&process.versions.node!==void 0}),to.registerFlag("IS_CHROME",function(){return typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)}),to.registerFlag("PROD",function(){return!1}),to.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",function(){return to.getBool("DEBUG")}),to.registerFlag("DEPRECATION_WARNINGS_ENABLED",function(){return!0}),to.registerFlag("IS_TEST",function(){return!1});var Sc,In,Sn,Gi={},Wp={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function gW(t,e){Gi[t]=e}function Yr(t){t in Gi||(Gi[t]=function(n){if(n!==1&&n!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");var r=function(o){if(typeof OffscreenCanvas<"u"&&o===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}(n);return r.addEventListener("webglcontextlost",function(o){o.preventDefault(),delete Gi[n]},!1),n===1?r.getContext("webgl",Wp)||r.getContext("experimental-webgl",Wp):r.getContext("webgl2",Wp)}(t));var e=Gi[t];return e.isContextLost()?(delete Gi[t],Yr(t)):(e.disable(e.DEPTH_TEST),e.disable(e.STENCIL_TEST),e.disable(e.BLEND),e.disable(e.DITHER),e.disable(e.POLYGON_OFFSET_FILL),e.disable(e.SAMPLE_COVERAGE),e.enable(e.SCISSOR_TEST),e.enable(e.CULL_FACE),e.cullFace(e.BACK),Gi[t])}function Ch(t,e){return[e,t]}function Hu(t){var e=le(t);return Lv(Math.ceil(e/4))}function tl(t,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(t/2))]}function Vy(t,e){var n,r,o,i,a,s,u,c,l,d=t;return K().getNumber("WEBGL_VERSION")===2?(n=d.R32F,r=d.R16F,o=d.RGBA16F,i=d.RGBA32F,a=d.RED,s=4,u=1,c=d.HALF_FLOAT,l=d.FLOAT):(n=t.RGBA,r=t.RGBA,o=t.RGBA,i=d.RGBA,a=t.RGBA,s=4,u=4,c=e!=null?e.HALF_FLOAT_OES:null,l=t.FLOAT),{internalFormatFloat:n,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:o,internalFormatPackedFloat:i,textureFormatFloat:a,downloadTextureFormat:t.RGBA,downloadUnpackNumChannels:s,defaultNumChannels:u,textureTypeHalfFloat:c,textureTypeFloat:l}}function de(t,e,n){var r=n();return e&&function(o){var i=o.getError();if(i!==o.NO_ERROR)throw new Error("WebGL Error: "+bW(o,i))}(t),r}(function(t){t[t.DENSE=0]="DENSE",t[t.SHARED_BATCH=1]="SHARED_BATCH"})(Sc||(Sc={})),function(t){t[t.RENDER=0]="RENDER",t[t.UPLOAD=1]="UPLOAD",t[t.PIXELS=2]="PIXELS",t[t.DOWNLOAD=3]="DOWNLOAD"}(In||(In={})),function(t){t[t.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",t[t.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",t[t.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",t[t.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",t[t.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(Sn||(Sn={}));var yW=596e-10,xW=65504;function wW(t){return!!(K().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||t===0||yW<Math.abs(t)&&Math.abs(t)<xW)}function bW(t,e){switch(e){case t.NO_ERROR:return"NO_ERROR";case t.INVALID_ENUM:return"INVALID_ENUM";case t.INVALID_VALUE:return"INVALID_VALUE";case t.INVALID_OPERATION:return"INVALID_OPERATION";case t.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case t.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case t.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code "+e}}function Ul(t,e,n){return Ro(t,e,function(){return t.getExtension(n)},'Extension "'+n+'" not supported on this browser.')}function EW(t,e,n){var r=Ro(t,e,function(){return t.createShader(t.VERTEX_SHADER)},"Unable to create vertex WebGLShader.");if(de(t,e,function(){return t.shaderSource(r,n)}),de(t,e,function(){return t.compileShader(r)}),t.getShaderParameter(r,t.COMPILE_STATUS)===!1)throw console.log(t.getShaderInfoLog(r)),new Error("Failed to compile vertex shader.");return r}function CW(t,e,n){var r=Ro(t,e,function(){return t.createShader(t.FRAGMENT_SHADER)},"Unable to create fragment WebGLShader.");if(de(t,e,function(){return t.shaderSource(r,n)}),de(t,e,function(){return t.compileShader(r)}),t.getShaderParameter(r,t.COMPILE_STATUS)===!1)throw function(o,i){var a=_W.exec(i);if(a==null)return console.log("Couldn't parse line number in error: "+i),void console.log(o);for(var s=+a[1],u=o.split(`
`),c=u.length.toString().length+2,l=u.map(function(g,v){return ys((v+1).toString(),c)+g}),d=0,f=0;f<l.length;f++)d=Math.max(l[f].length,d);var h=l.slice(0,s-1),m=l.slice(s-1,s),p=l.slice(s);console.log(h.join(`
`)),console.log(i.split(`
`)[0]),console.log("%c "+ys(m[0],d),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(p.join(`
`))}(n,t.getShaderInfoLog(r)),new Error("Failed to compile fragment shader.");return r}var $p,zp,_W=/ERROR: [0-9]+:([0-9]+):/g;function SW(t,e){return Ro(t,e,function(){return t.createProgram()},"Unable to create WebGLProgram.")}function kW(t,e,n){if(de(t,e,function(){return t.linkProgram(n)}),t.getProgramParameter(n,t.LINK_STATUS)===!1)throw console.log(t.getProgramInfoLog(n)),new Error("Failed to link vertex and fragment shaders.")}function Vp(t,e,n){if(de(t,e,function(){return t.validateProgram(n)}),t.getProgramParameter(n,t.VALIDATE_STATUS)===!1)throw console.log(t.getProgramInfoLog(n)),new Error("Shader program validation failed.")}function IW(t,e,n){var r=Ro(t,e,function(){return t.createBuffer()},"Unable to create WebGLBuffer");return de(t,e,function(){return t.bindBuffer(t.ARRAY_BUFFER,r)}),de(t,e,function(){return t.bufferData(t.ARRAY_BUFFER,n,t.STATIC_DRAW)}),r}function RW(t,e,n){var r=Ro(t,e,function(){return t.createBuffer()},"Unable to create WebGLBuffer");return de(t,e,function(){return t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,r)}),de(t,e,function(){return t.bufferData(t.ELEMENT_ARRAY_BUFFER,n,t.STATIC_DRAW)}),r}function TW(t,e){return Ro(t,e,function(){return t.createTexture()},"Unable to create WebGLTexture.")}function NW(t,e){var n=K().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t<=0||e<=0){var r="["+t+"x"+e+"]";throw new Error("Requested texture size "+r+" is invalid.")}if(t>n||e>n)throw r="["+t+"x"+e+"]",new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU "+("["+n+"x"+n+"]")+".")}function AW(t,e){return Ro(t,e,function(){return t.createFramebuffer()},"Unable to create WebGLFramebuffer.")}function qw(t,e,n,r,o,i,a,s){var u=t.getAttribLocation(n,r);return u!==-1&&(de(t,e,function(){return t.bindBuffer(t.ARRAY_BUFFER,o)}),de(t,e,function(){return t.vertexAttribPointer(u,i,t.FLOAT,!1,a,s)}),de(t,e,function(){return t.enableVertexAttribArray(u)}),!0)}function PW(t,e,n,r){LW(t,r),de(t,e,function(){return t.activeTexture(t.TEXTURE0+r)}),de(t,e,function(){return t.bindTexture(t.TEXTURE_2D,n)})}function DW(t,e,n,r){return Ro(t,e,function(){return t.getUniformLocation(n,r)},'uniform "'+r+'" not present in program.')}function MW(t,e,n){return t.getUniformLocation(e,n)}function OW(t,e,n,r,o,i){de(t,e,function(){return PW(t,e,r,i)}),de(t,e,function(){return t.uniform1i(o,i)})}function Hp(t,e,n,r){de(t,e,function(){return t.bindFramebuffer(t.FRAMEBUFFER,r)}),de(t,e,function(){return t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0)})}function Xw(t,e,n){de(t,e,function(){return t.bindFramebuffer(t.FRAMEBUFFER,n)}),de(t,e,function(){return t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,null,0)})}function Wl(t){var e=t.checkFramebufferStatus(t.FRAMEBUFFER);if(e!==t.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+FW(t,e))}function FW(t,e){switch(e){case t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case t.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error "+e}}function Ro(t,e,n,r){var o=de(t,e,function(){return n()});if(o==null)throw new Error(r);return o}function LW(t,e){var n=t.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=e+t.TEXTURE0;if(r<t.TEXTURE0||r>n)throw new Error("textureUnit must be in "+("[gl.TEXTURE0, gl.TEXTURE"+n+"]")+".")}function mf(t,e){return e===void 0&&(e=2),le(t.slice(0,t.length-e))}function vf(t){if(t.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[t.length>1?t[t.length-2]:1,t[t.length-1]]}function Gp(t){var e=[1,1,1];return t.length===0||t.length===1&&t[0]===1||(e=[mf(t)].concat(vf(t))),e}function BW(t,e){var n;e===void 0&&(e=!1);var r=K().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e&&(r*=2,(t=t.map(function(c,l){return l>=t.length-2?zI(t[l]):t[l]})).length===1&&(t=[2,t[0]])),t.length!==2){var o=qi(t);t=o.newShape}var i=le(t);if(t.length<=1&&i<=r)return[1,i];if(t.length===2&&t[0]<=r&&t[1]<=r)return t;if(t.length===3&&t[0]*t[1]<=r&&t[2]<=r)return[t[0]*t[1],t[2]];if(t.length===3&&t[0]<=r&&t[1]*t[2]<=r)return[t[0],t[1]*t[2]];if(t.length===4&&t[0]*t[1]*t[2]<=r&&t[3]<=r)return[t[0]*t[1]*t[2],t[3]];if(t.length===4&&t[0]<=r&&t[1]*t[2]*t[3]<=r)return[t[0],t[1]*t[2]*t[3]];if(e){var a=mf(t),s=2,u=2;return t.length&&(s=(n=vf(t))[0],u=n[1]),Lv(i=a*(s/2)*(u/2)).map(function(c){return 2*c})}return Lv(i)}function $l(t){return t%2==0}function zl(t,e){if(Nt(t=t.slice(-2),e=e.slice(-2))||!t.length||!e.length||t[0]===0||t[1]===0||e[0]===0||e[1]===0)return!0;if(t.length!==e.length){var n=t.slice(-1)[0],r=e.slice(-1)[0];if(n===r||$l(n)&&$l(r)&&(t[0]===1||e[0]===1))return!0}return t[1]===e[1]&&$l(t[0])&&$l(e[0])}function jW(t){if($p==null){var e=Yr(t);$p=e.getParameter(e.MAX_TEXTURE_SIZE)}return $p}function UW(t){if(zp==null){var e=Yr(t);zp=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,zp)}function WW(t){if(t===0)return 0;var e=Yr(t);return Vn(e,"EXT_disjoint_timer_query_webgl2")&&t===2?2:Vn(e,"EXT_disjoint_timer_query")?1:0}function Vn(t,e){return t.getExtension(e)!=null}function Yw(t){try{if(Yr(t)!=null)return!0}catch{return!1}return!1}function $W(t){if(t===0)return!1;var e=Yr(t);if(t===1){if(!Vn(e,"OES_texture_float"))return!1}else if(!Vn(e,"EXT_color_buffer_float"))return!1;return Vv(e)}function zW(t){if(t===0)return!1;var e=Yr(t);if(t!==1){if(Vn(e,"EXT_color_buffer_float"))return Vv(e);if(Vn(e,"EXT_color_buffer_half_float")){var n=e.getExtension("EXT_color_buffer_half_float");return function(r,o){var i=Vy(r,o),a=r.createTexture();r.bindTexture(r.TEXTURE_2D,a),r.texImage2D(r.TEXTURE_2D,0,i.internalFormatHalfFloat,1,1,0,i.textureFormatFloat,i.textureTypeHalfFloat,null);var s=r.createFramebuffer();r.bindFramebuffer(r.FRAMEBUFFER,s),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,a,0);var u=r.checkFramebufferStatus(r.FRAMEBUFFER)===r.FRAMEBUFFER_COMPLETE;return r.bindTexture(r.TEXTURE_2D,null),r.bindFramebuffer(r.FRAMEBUFFER,null),r.deleteTexture(a),r.deleteFramebuffer(s),u}(e,n)}return!1}return!!Vn(e,"OES_texture_float")&&!!Vn(e,"WEBGL_color_buffer_float")&&Vv(e)}function Vv(t){var e=Vy(t),n=t.createTexture();t.bindTexture(t.TEXTURE_2D,n),t.texImage2D(t.TEXTURE_2D,0,e.internalFormatFloat,1,1,0,e.textureFormatFloat,e.textureTypeFloat,null);var r=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,r),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0);var o=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(n),t.deleteFramebuffer(r),o}function VW(t){return t===2&&Yr(t).fenceSync!=null}var ye=K();function JI(t){K().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(t+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function ie(t,e){return L.tidy(t,e)}function gn(t){YI(t).forEach(function(e){return e.dispose()})}function HW(t){return L.keep(t)}function gf(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];K().getBool("IS_TEST")||console.warn.apply(console,t)}function Oi(t,e){var n=t;if(zr(t))return e==="string"?[]:[t.length];if(!Array.isArray(t))return[];for(var r=[];Array.isArray(n)||zr(n)&&e!=="string";)r.push(n.length),n=n[0];return Array.isArray(t)&&K().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&function o(i,a,s){if(s=s||[],!Array.isArray(i)&&!zr(i))return void N(a.length===0,function(){return"Element arr["+s.join("][")+"] is a primitive, but should be an array/TypedArray of "+a[0]+" elements"});N(a.length>0,function(){return"Element arr["+s.join("][")+"] should be a primitive, but is an array of "+i.length+" elements"}),N(i.length===a[0],function(){return"Element arr["+s.join("][")+"] should have "+a[0]+" elements, but has "+i.length+" elements"});for(var u=a.slice(1),c=0;c<i.length;++c)o(i[c],u,s.concat(c))}(t,r,[]),r}function Qw(t,e,n,r){if(t!=null&&(t!=="numeric"&&t!==e||t==="numeric"&&e==="string"))throw new Error("Argument '"+n+"' passed to '"+r+"' must be "+t+" tensor, but got "+e+" tensor")}function T(t,e,n,r){if(r===void 0&&(r="numeric"),t instanceof tt)return Qw(r,t.dtype,e,n),t;var o=Zc(t);if(o!=="string"&&["bool","int32","float32"].indexOf(r)>=0&&(o=r),Qw(r,o,e,n),t==null||!zr(t)&&!Array.isArray(t)&&typeof t!="number"&&typeof t!="boolean"&&typeof t!="string"){var i=t==null?"null":t.constructor.name;throw new Error("Argument '"+e+"' passed to '"+n+"' must be a Tensor or TensorLike, but got '"+i+"'")}var a=Oi(t,o);zr(t)||Array.isArray(t)||(t=[t]);var s=o!=="string"?HI(t,o,K().getBool("DEBUG")):Qs(t,[],!0);return L.makeTensor(s,a,o)}function yf(t,e,n,r){if(r===void 0&&(r="numeric"),!Array.isArray(t))throw new Error("Argument "+e+" passed to "+n+" must be a `Tensor[]` or `TensorLike[]`");return t.map(function(o,i){return T(o,e+"["+i+"]",n)},r)}function ZI(t,e){for(var n=0;n<t.length;++n)if(t[t.length-n-1]!==e-1-n)return!1;return!0}function GW(t,e,n){for(var r=t.length+e.length,o=[],i=0,a=0,s=0;s<r;s++)n.indexOf(s)===-1?o.push(t[i++]):o.push(e[a++]);return o}function Ht(t,e){for(var n=[],r=t.length,o=0;o<r;o++)e.indexOf(o)===-1&&n.push(t[o]);return[n,e.map(function(i){return t[i]})]}function xn(t,e){return GW(t,e.map(function(n){return 1}),e)}function Cn(t,e,n){N(ZI(e,n),function(){return t+" supports only inner-most axes for now. Got axes "+e+" and rank-"+n+" input."})}function Qr(t,e){if(ZI(t,e))return null;for(var n=[],r=0;r<e;++r)t.indexOf(r)===-1&&n.push(r);return t.forEach(function(o){return n.push(o)}),n}function Hy(t){return t.map(function(e,n){return[n,e]}).sort(function(e,n){return e[1]-n[1]}).map(function(e){return e[0]})}function Jr(t,e){for(var n=[],r=e-t;r<e;++r)n.push(r);return n}function KW(t,e){var n=t[0].length;t.forEach(function(o,i){N(o.length===n,function(){return"Error in concat"+n+"D: rank of tensors["+i+"] must be the same as the rank of the rest ("+n+")"})}),N(e>=0&&e<n,function(){return"Error in concat"+n+"D: axis must be between 0 and "+(n-1)+"."});var r=t[0];t.forEach(function(o,i){for(var a=0;a<n;a++)N(a===e||o[a]===r[a],function(){return"Error in concat"+n+"D: Shape of tensors["+i+"] ("+o+") does not match the shape of the rest ("+r+") along the non-concatenated axis "+i+"."})})}function Zs(t,e){for(var n=t[0].slice(),r=1;r<t.length;r++)n[e]+=t[r][e];return n}function O(t){var e=Object.keys(t);if(e.length!==1)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+e.length+" keys.");var n=e[0],r=t[n];n.endsWith("_")&&(n=n.substring(0,n.length-1));var o=function(){for(var i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];L.startScope(n);try{var s=r.apply(void 0,i);return s instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),L.endScope(s),s}catch(u){throw L.endScope(null),u}};return Object.defineProperty(o,"name",{value:n,configurable:!0}),o}ye.registerFlag("HAS_WEBGL",function(){return ye.getNumber("WEBGL_VERSION")>0}),ye.registerFlag("WEBGL_VERSION",function(){return Yw(2)?2:Yw(1)?1:0}),ye.registerFlag("WEBGL_BUFFER_SUPPORTED",function(){return ye.get("WEBGL_VERSION")===2}),ye.registerFlag("WEBGL_CPU_FORWARD",function(){return!0}),ye.registerFlag("WEBGL_FORCE_F16_TEXTURES",function(){return!1}),ye.registerFlag("WEBGL_PACK",function(){return ye.getBool("HAS_WEBGL")}),ye.registerFlag("WEBGL_PACK_NORMALIZATION",function(){return ye.getBool("WEBGL_PACK")}),ye.registerFlag("WEBGL_PACK_CLIP",function(){return ye.getBool("WEBGL_PACK")}),ye.registerFlag("WEBGL_PACK_DEPTHWISECONV",function(){return!1}),ye.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",function(){return ye.getBool("WEBGL_PACK")}),ye.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",function(){return ye.getBool("WEBGL_PACK")}),ye.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",function(){return ye.getBool("WEBGL_PACK")}),ye.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",function(){return ye.getBool("WEBGL_PACK")}),ye.registerFlag("WEBGL_PACK_REDUCE",function(){return ye.getBool("WEBGL_PACK")}),ye.registerFlag("WEBGL_LAZILY_UNPACK",function(){return ye.getBool("WEBGL_PACK")}),ye.registerFlag("WEBGL_CONV_IM2COL",function(){return ye.getBool("WEBGL_PACK")}),ye.registerFlag("WEBGL_MAX_TEXTURE_SIZE",function(){return jW(ye.getNumber("WEBGL_VERSION"))}),ye.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",function(){return UW(ye.getNumber("WEBGL_VERSION"))}),ye.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",function(){var t=ye.getNumber("WEBGL_VERSION");return t===0?0:WW(t)}),ye.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",function(){return ye.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&(t=navigator.userAgent||navigator.vendor||window.opera,!(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))));var t}),ye.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",function(){return $W(ye.getNumber("WEBGL_VERSION"))}),ye.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",function(){return!ye.getBool("WEBGL_FORCE_F16_TEXTURES")&&ye.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")}),ye.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",function(){return zW(ye.getNumber("WEBGL_VERSION"))}),ye.registerFlag("WEBGL_FENCE_API_ENABLED",function(){return VW(ye.getNumber("WEBGL_VERSION"))}),ye.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",function(){return ye.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0}),XI=JI;var Mt=O({complex_:function(t,e){var n=T(t,"real","complex"),r=T(e,"imag","complex");return We(n.shape,r.shape,"real and imag shapes, "+n.shape+" and "+r.shape+", must match in call to tf.complex()."),L.runKernelFunc(function(o){return o.complex(n,r)},{$real:n,$imag:r})}}),$n=O({real_:function(t){var e=T(t,"input","real");return L.runKernelFunc(function(n){return n.real(e)},{$input:e})}}),Or=O({imag_:function(t){var e=T(t,"input","imag");return L.runKernelFunc(function(n){return n.imag(e)},{$input:e})}});function Ft(t,e,n){return Fi(t,e,Oi(t,n),n)}function Fi(t,e,n,r){if(r==null&&(r=Zc(t)),r==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!zr(t)&&!Array.isArray(t)&&typeof t!="number"&&typeof t!="boolean"&&typeof t!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(e!=null){KI(e);var o=le(e),i=le(n);N(o===i,function(){return"Based on the provided shape, ["+e+"], the tensor should have "+o+" values but has "+i});for(var a=0;a<n.length;++a){var s=n[a],u=a!==n.length-1||s!==le(e.slice(a));N(n[a]===e[a]||!u,function(){return"Error creating a new Tensor. Inferred shape ("+n+") does not match the provided shape ("+e+"). "})}}return zr(t)||Array.isArray(t)||(t=[t]),e=e||n,t=r!=="string"?HI(t,r,K().getBool("DEBUG")):Qs(t,[],!0),L.makeTensor(t,e,r)}function oe(t,e){if((zr(t)&&e!=="string"||Array.isArray(t))&&e!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(e==="string"&&zr(t)&&!(t instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return Fi(t,[],[],e)}function mt(t,e){cu(t);var n=Oi(t,e);if(n.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return Fi(t,null,n,e)}function wi(t,e,n){if(cu(t),e!=null&&e.length!==2)throw new Error("tensor2d() requires shape to have two numbers");var r=Oi(t,n);if(r.length!==2&&r.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return Fi(t,e,r,n)}function Gy(t,e,n){if(cu(t),e!=null&&e.length!==3)throw new Error("tensor3d() requires shape to have three numbers");var r=Oi(t,n);if(r.length!==3&&r.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return Fi(t,e,r,n)}function ln(t,e,n){if(cu(t),e!=null&&e.length!==4)throw new Error("tensor4d() requires shape to have four numbers");var r=Oi(t,n);if(r.length!==4&&r.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return Fi(t,e,r,n)}function qW(t,e,n){if(cu(t),e!=null&&e.length!==5)throw new Error("tensor5d() requires shape to have five numbers");var r=Oi(t,n);if(r.length!==5&&r.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return Fi(t,e,r,n)}function XW(t,e,n){if(cu(t),e!=null&&e.length!==6)throw new Error("tensor6d() requires shape to have six numbers");var r=Oi(t,n);if(r.length!==6&&r.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return Fi(t,e=e||r,r,n)}function YW(t,e,n,r){return e===void 0&&(e=!0),L.makeVariable(t,e,n,r)}function lu(t,e){if(e===void 0&&(e="float32"),e==="complex64"){var n=lu(t,"float32"),r=Xe(t,"float32");return Mt(n,r)}var o=GI(le(t),e);return L.makeTensor(o,t,e)}function Xe(t,e){if(e===void 0&&(e="float32"),e==="complex64"){var n=Xe(t,"float32"),r=Xe(t,"float32");return Mt(n,r)}var o=el(le(t),e);return L.makeTensor(o,t,e)}function Hr(t,e,n){return L.runKernelFunc(function(r){return r.fill(t,e,n)},{})}function QW(t,e,n){if(n<=0)throw new Error("The number of values should be positive.");return L.runKernelFunc(function(r){return r.linspace(t,e,n)},{})}function xf(t,e,n,r){if(n===void 0&&(n=1),r===void 0&&(r="float32"),n===0)throw new Error("Cannot have a step of zero");if(t===e||t<e&&n<0||e<t&&n>1)return Xe([0],r);var o=el(Math.abs(Math.ceil((e-t)/n)),r);e<t&&n===1&&(n=-1),o[0]=t;for(var i=1;i<o.length;i++)o[i]=o[i-1]+n;return mt(o,r)}var eR=O({onesLike_:function(t){var e=T(t,"x","onesLike");if(e.dtype==="complex64"){var n=eR($n(e)),r=Me(Or(e));return Mt(n,r)}return L.runKernelFunc(function(o){return o.onesLike(e)},{$x:e},function(o,i){return{$x:function(){return Me(o)}}})}}),Me=O({zerosLike_:function(t){var e=T(t,"x","zerosLike");return L.runKernelFunc(function(n){return n.zerosLike(e)},{$x:e},function(n,r){return{$x:function(){return Me(n)}}})}}),wt=O({concat_:function(t,e){e===void 0&&(e=0),N(t.length>=1,function(){return"Pass at least one tensor to concat"});var n=yf(t,"tensors","concat");n[0].dtype==="complex64"&&n.forEach(function(s){if(s.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype `+s.dtype+". ")}),e=_t(e,n[0].shape)[0];var r=Zs(n.map(function(s){return s.shape}),e);if(le(r)===0)return Ft([],r);if((n=n.filter(function(s){return s.size>0})).length===1)return n[0];var o=n.map(function(s){return s.shape});KW(o,e);var i=n,a={axis:e};return L.runKernelFunc(function(s){return s.concat(n,e)},i,function(s){var u=o.map(function(c){return c[e]});return Ky(s,u,e).map(function(c){return function(){return c}})},"Concat",a)}}),JW=O({concat1d_:function(t){return wt(t,0)}}),ZW=O({concat2d_:function(t,e){return wt(t,e)}}),e$=O({concat3d_:function(t,e){return wt(t,e)}}),t$=O({concat4d_:function(t,e){return wt(t,e)}}),Ky=O({split_:function(t,e,n){n===void 0&&(n=0);var r,o=T(t,"x","split");return n=_t(n,o.shape)[0],typeof e=="number"?(N(o.shape[n]%e==0,function(){return"Number of splits must evenly divide the axis."}),r=new Array(e).fill(o.shape[n]/e)):(N(o.shape[n]===e.reduce(function(i,a){return i+a}),function(){return"The sum of sizes must match the size of the axis dimension."}),r=e),L.runKernelFunc(function(i){return i.split(o,r,n)},{$x:o},function(i){return{$x:function(){return wt(i,n)}}})}});function ka(t,e){return t(e={exports:{}},e.exports),e.exports}var n$=ka(function(t){(function(e,n,r){function o(s){var u,c=this,l=(u=4022871197,function(d){d=d.toString();for(var f=0;f<d.length;f++){var h=.02519603282416938*(u+=d.charCodeAt(f));h-=u=h>>>0,u=(h*=u)>>>0,u+=4294967296*(h-=u)}return 23283064365386963e-26*(u>>>0)});c.next=function(){var d=2091639*c.s0+23283064365386963e-26*c.c;return c.s0=c.s1,c.s1=c.s2,c.s2=d-(c.c=0|d)},c.c=1,c.s0=l(" "),c.s1=l(" "),c.s2=l(" "),c.s0-=l(s),c.s0<0&&(c.s0+=1),c.s1-=l(s),c.s1<0&&(c.s1+=1),c.s2-=l(s),c.s2<0&&(c.s2+=1),l=null}function i(s,u){return u.c=s.c,u.s0=s.s0,u.s1=s.s1,u.s2=s.s2,u}function a(s,u){var c=new o(s),l=u&&u.state,d=c.next;return d.int32=function(){return 4294967296*c.next()|0},d.double=function(){return d()+11102230246251565e-32*(2097152*d()|0)},d.quick=d,l&&(typeof l=="object"&&i(l,c),d.state=function(){return i(c,{})}),d}n&&n.exports?n.exports=a:this.alea=a})(0,t)}),r$=ka(function(t){(function(e,n,r){function o(s){var u=this,c="";u.x=0,u.y=0,u.z=0,u.w=0,u.next=function(){var d=u.x^u.x<<11;return u.x=u.y,u.y=u.z,u.z=u.w,u.w^=u.w>>>19^d^d>>>8},s===(0|s)?u.x=s:c+=s;for(var l=0;l<c.length+64;l++)u.x^=0|c.charCodeAt(l),u.next()}function i(s,u){return u.x=s.x,u.y=s.y,u.z=s.z,u.w=s.w,u}function a(s,u){var c=new o(s),l=u&&u.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var f=((c.next()>>>11)+(c.next()>>>0)/4294967296)/2097152;while(f===0);return f},d.int32=c.next,d.quick=d,l&&(typeof l=="object"&&i(l,c),d.state=function(){return i(c,{})}),d}n&&n.exports?n.exports=a:this.xor128=a})(0,t)}),o$=ka(function(t){(function(e,n,r){function o(s){var u=this,c="";u.next=function(){var d=u.x^u.x>>>2;return u.x=u.y,u.y=u.z,u.z=u.w,u.w=u.v,(u.d=u.d+362437|0)+(u.v=u.v^u.v<<4^d^d<<1)|0},u.x=0,u.y=0,u.z=0,u.w=0,u.v=0,s===(0|s)?u.x=s:c+=s;for(var l=0;l<c.length+64;l++)u.x^=0|c.charCodeAt(l),l==c.length&&(u.d=u.x<<10^u.x>>>4),u.next()}function i(s,u){return u.x=s.x,u.y=s.y,u.z=s.z,u.w=s.w,u.v=s.v,u.d=s.d,u}function a(s,u){var c=new o(s),l=u&&u.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var f=((c.next()>>>11)+(c.next()>>>0)/4294967296)/2097152;while(f===0);return f},d.int32=c.next,d.quick=d,l&&(typeof l=="object"&&i(l,c),d.state=function(){return i(c,{})}),d}n&&n.exports?n.exports=a:this.xorwow=a})(0,t)}),i$=ka(function(t){(function(e,n,r){function o(s){var u=this;u.next=function(){var c,l,d=u.x,f=u.i;return c=d[f],l=(c^=c>>>7)^c<<24,l^=(c=d[f+1&7])^c>>>10,l^=(c=d[f+3&7])^c>>>3,l^=(c=d[f+4&7])^c<<7,c=d[f+7&7],l^=(c^=c<<13)^c<<9,d[f]=l,u.i=f+1&7,l},function(c,l){var d,f=[];if(l===(0|l))f[0]=l;else for(l=""+l,d=0;d<l.length;++d)f[7&d]=f[7&d]<<15^l.charCodeAt(d)+f[d+1&7]<<13;for(;f.length<8;)f.push(0);for(d=0;d<8&&f[d]===0;++d);for(d==8?f[7]=-1:f[d],c.x=f,c.i=0,d=256;d>0;--d)c.next()}(u,s)}function i(s,u){return u.x=s.x.slice(),u.i=s.i,u}function a(s,u){s==null&&(s=+new Date);var c=new o(s),l=u&&u.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var f=((c.next()>>>11)+(c.next()>>>0)/4294967296)/2097152;while(f===0);return f},d.int32=c.next,d.quick=d,l&&(l.x&&i(l,c),d.state=function(){return i(c,{})}),d}n&&n.exports?n.exports=a:this.xorshift7=a})(0,t)}),a$=ka(function(t){(function(e,n,r){function o(s){var u=this;u.next=function(){var c,l,d=u.w,f=u.X,h=u.i;return u.w=d=d+1640531527|0,l=f[h+34&127],c=f[h=h+1&127],l^=l<<13,c^=c<<17,l^=l>>>15,c^=c>>>12,l=f[h]=l^c,u.i=h,l+(d^d>>>16)|0},function(c,l){var d,f,h,m,p,g=[],v=128;for(l===(0|l)?(f=l,l=null):(l+="\0",f=0,v=Math.max(v,l.length)),h=0,m=-32;m<v;++m)l&&(f^=l.charCodeAt((m+32)%l.length)),m===0&&(p=f),f^=f<<10,f^=f>>>15,f^=f<<4,f^=f>>>13,m>=0&&(p=p+1640531527|0,h=(d=g[127&m]^=f+p)==0?h+1:0);for(h>=128&&(g[127&(l&&l.length||0)]=-1),h=127,m=512;m>0;--m)f=g[h+34&127],d=g[h=h+1&127],f^=f<<13,d^=d<<17,f^=f>>>15,d^=d>>>12,g[h]=f^d;c.w=p,c.X=g,c.i=h}(u,s)}function i(s,u){return u.i=s.i,u.w=s.w,u.X=s.X.slice(),u}function a(s,u){s==null&&(s=+new Date);var c=new o(s),l=u&&u.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var f=((c.next()>>>11)+(c.next()>>>0)/4294967296)/2097152;while(f===0);return f},d.int32=c.next,d.quick=d,l&&(l.X&&i(l,c),d.state=function(){return i(c,{})}),d}n&&n.exports?n.exports=a:this.xor4096=a})(0,t)}),s$=ka(function(t){(function(e,n,r){function o(s){var u=this,c="";u.next=function(){var d=u.b,f=u.c,h=u.d,m=u.a;return d=d<<25^d>>>7^f,f=f-h|0,h=h<<24^h>>>8^m,m=m-d|0,u.b=d=d<<20^d>>>12^f,u.c=f=f-h|0,u.d=h<<16^f>>>16^m,u.a=m-d|0},u.a=0,u.b=0,u.c=-1640531527,u.d=1367130551,s===Math.floor(s)?(u.a=s/4294967296|0,u.b=0|s):c+=s;for(var l=0;l<c.length+20;l++)u.b^=0|c.charCodeAt(l),u.next()}function i(s,u){return u.a=s.a,u.b=s.b,u.c=s.c,u.d=s.d,u}function a(s,u){var c=new o(s),l=u&&u.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var f=((c.next()>>>11)+(c.next()>>>0)/4294967296)/2097152;while(f===0);return f},d.int32=c.next,d.quick=d,l&&(typeof l=="object"&&i(l,c),d.state=function(){return i(c,{})}),d}n&&n.exports?n.exports=a:this.tychei=a})(0,t)}),Ki=ka(function(t){(function(e,n){var r,o=this,i=256,a=6,s="random",u=n.pow(i,a),c=n.pow(2,52),l=2*c,d=i-1;function f(v,y,x){var w=[],E=p(function k(I,R){var D,A=[],j=typeof I;if(R&&j=="object")for(D in I)try{A.push(k(I[D],R-1))}catch{}return A.length?A:j=="string"?I:I+"\0"}((y=y==1?{entropy:!0}:y||{}).entropy?[v,g(e)]:v??function(){try{var k;return r&&(k=r.randomBytes)?k=k(i):(k=new Uint8Array(i),(o.crypto||o.msCrypto).getRandomValues(k)),g(k)}catch{var I=o.navigator,R=I&&I.plugins;return[+new Date,o,R,o.screen,g(e)]}}(),3),w),_=new h(w),S=function(){for(var k=_.g(a),I=u,R=0;k<c;)k=(k+R)*i,I*=i,R=_.g(1);for(;k>=l;)k/=2,I/=2,R>>>=1;return(k+R)/I};return S.int32=function(){return 0|_.g(4)},S.quick=function(){return _.g(4)/4294967296},S.double=S,p(g(_.S),e),(y.pass||x||function(k,I,R,D){return D&&(D.S&&m(D,_),k.state=function(){return m(_,{})}),R?(n[s]=k,I):k})(S,E,"global"in y?y.global:this==n,y.state)}function h(v){var y,x=v.length,w=this,E=0,_=w.i=w.j=0,S=w.S=[];for(x||(v=[x++]);E<i;)S[E]=E++;for(E=0;E<i;E++)S[E]=S[_=d&_+v[E%x]+(y=S[E])],S[_]=y;(w.g=function(k){for(var I,R=0,D=w.i,A=w.j,j=w.S;k--;)I=j[D=d&D+1],R=R*i+j[d&(j[D]=j[A=d&A+I])+(j[A]=I)];return w.i=D,w.j=A,R})(i)}function m(v,y){return y.i=v.i,y.j=v.j,y.S=v.S.slice(),y}function p(v,y){for(var x,w=v+"",E=0;E<w.length;)y[d&E]=d&(x^=19*y[d&E])+w.charCodeAt(E++);return g(y)}function g(v){return String.fromCharCode.apply(0,v)}if(n["seed"+s]=f,p(n.random(),e),t.exports){t.exports=f;try{r=require("crypto")}catch{}}})([],Math)});Ki.alea=n$,Ki.xor128=r$,Ki.xorwow=o$,Ki.xorshift7=i$,Ki.xor4096=a$,Ki.tychei=s$;var _h=Ki.alea,qy=function(){function t(e,n,r,o,i){this.mean=e,this.stdDev=n,this.dtype=r,this.nextVal=NaN,this.truncated=o,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);var a=i||Math.random();this.random=_h(a.toString())}return t.prototype.nextValue=function(){if(!isNaN(this.nextVal)){var e=this.nextVal;return this.nextVal=NaN,e}for(var n,r,o=!1;!o;){var i=void 0,a=void 0,s=void 0;do s=(i=2*this.random()-1)*i+(a=2*this.random()-1)*a;while(s>=1||s===0);var u=Math.sqrt(-2*Math.log(s)/s);n=this.mean+this.stdDev*i*u,r=this.mean+this.stdDev*a*u,this.truncated&&!this.isValidTruncated(n)||(o=!0)}return this.truncated&&!this.isValidTruncated(r)||(this.nextVal=this.convertValue(r)),this.convertValue(n)},t.prototype.convertValue=function(e){return this.dtype==null||this.dtype==="float32"?e:Math.round(e)},t.prototype.isValidTruncated=function(e){return e<=this.upper&&e>=this.lower},t}(),u$=function(){function t(e,n,r,o){this.alpha=e,this.beta=1/n,this.dtype=r;var i=o||Math.random();this.randu=_h(i.toString()),this.randn=new qy(0,1,r,!1,this.randu()),this.d=e<1?e+2/3:e-1/3,this.c=1/Math.sqrt(9*this.d)}return t.prototype.nextValue=function(){for(var e,n,r,o,i,a;;){do o=this.randn.nextValue(),a=1+this.c*o;while(a<=0);if(a*=a*a,n=1-.331*(e=o*o)*e,r=.5*e+this.d*(1-a+Math.log(a)),(i=this.randu())<n||Math.log(i)<r)break}return a=1/this.beta*this.d*a,this.alpha<1&&(a*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(a)},t.prototype.convertValue=function(e){return this.dtype==="float32"?e:Math.round(e)},t}(),c$=function(){function t(e,n,r,o){var i=this;if(e===void 0&&(e=0),n===void 0&&(n=1),this.canReturnFloat=function(){return i.dtype==null||i.dtype==="float32"},this.min=e,this.range=n-e,this.dtype=r,o==null&&(o=Math.random()),typeof o=="number"&&(o=o.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between "+e+" - "+n+" <= 1 and dtype is not float");this.random=_h(o)}return t.prototype.convertValue=function(e){return this.canReturnFloat()?e:Math.round(e)},t.prototype.nextValue=function(){return this.convertValue(this.min+this.range*this.random())},t}();function Ce(t,e,n){return e===void 0&&(e="float32"),e=e||"float32",KI(t),new _c(t,e,n)}function l$(t,e){e===void 0&&(e=!1),console.log(t.toString(e))}var tR=O({batchToSpaceND_:function(t,e,n){var r=T(t,"x","batchToSpaceND"),o=e.reduce(function(i,a){return i*a});return N(r.rank>=1+e.length,function(){return"input rank is "+r.rank+" but should be > than blockShape.length "+e.length}),N(n.length===e.length,function(){return"crops.length is "+n.length+" but should be equal to blockShape.length  "+e.length}),N(r.shape[0]%o==0,function(){return"input tensor batch is "+r.shape[0]+" but is not divisible by the product of the elements of blockShape "+e.join(" * ")+" === "+o}),L.runKernelFunc(function(i){return i.batchToSpaceND(r,e,n)},{$x:r},function(i){return{$x:function(){return i.spaceToBatchND(e,n)}}})}}),d$=O({broadcastTo_:function(t,e){var n=T(t,"broadcastTo","x"),r=n.shape;if(e.some(function(u){return!(u>0)||u%1!=0}))throw new Error("broadcastTo(): Invalid broadcast shape ["+e+"].");if(e.length<n.rank)throw new Error("broadcastTo(): shape.length="+e.length+" < input.rank="+n.rank+".");if(e.length>n.rank){for(var o=n.shape.slice();o.length<e.length;)o.unshift(1);n=n.reshape(o)}for(var i=Array.from(e),a=e.length-1;a>=0;a--)if(n.shape[a]===e[a])i[a]=1;else if(n.shape[a]!==1)throw new Error("broadcastTo(): ["+r+"] cannot be broadcast to ["+e+"].");var s=i.map(function(u,c){return u>1?c:-1}).filter(function(u){return u>=0});return s.length===0?n.clone():L.runKernelFunc(function(u){return u.tile(n,i)},{input:n},function(u){return{input:function(){return u.sum(s,!0)}}})}}),f$=O({cast_:function(t,e){var n=T(t,"x","cast");if(!oW(e))throw new Error("Failed to cast to unknown dtype "+e);if(e==="string"&&n.dtype!=="string"||e!=="string"&&n.dtype==="string")throw new Error("Only strings can be casted to strings");var r={dtype:e};return L.runKernelFunc(function(o){return o.cast(n,e)},{x:n},function(o){return{x:function(){return o.clone()}}},"Cast",r)}}),h$=O({clone_:function(t){var e=T(t,"x","clone",null);return L.runKernelFunc(function(){return L.makeTensorFromDataId(e.dataId,e.shape,e.dtype)},{$x:e},function(n){return{$x:function(){return n.toFloat()}}})}}),p$=O({cumsum_:function(t,e,n,r){e===void 0&&(e=0),n===void 0&&(n=!1),r===void 0&&(r=!1);var o=T(t,"x","cumsum"),i=Qr([e|=0],o.rank),a=o;i!=null&&(a=o.transpose(i));var s=Jr(1,o.rank)[0],u=L.runKernelFunc(function(c){return c.cumsum(a,s,n,r)},{permutedX:a},function(c){return{permutedX:function(){return c.cumsum(e,n,!r)}}});return i!=null&&(u=u.transpose(i)),u}}),m$=O({depthToSpace_:function(t,e,n){n===void 0&&(n="NHWC");var r=T(t,"x","depthToSpace"),o=n==="NHWC"?r.shape[1]:r.shape[2],i=n==="NHWC"?r.shape[2]:r.shape[3],a=n==="NHWC"?r.shape[3]:r.shape[1];return N(o*e>=0,function(){return`Negative dimension size caused by overflow when multiplying
      `+o+" and "+e+`  for depthToSpace with input shape
      `+r.shape}),N(i*e>=0,function(){return`Negative dimension size caused by overflow when multiplying
      `+i+" and "+e+` for depthToSpace with input shape
          `+r.shape}),N(a%(e*e)==0,function(){return"Dimension size must be evenly divisible by "+e*e+" but is "+a+" for depthToSpace with input shape "+r.shape}),L.runKernelFunc(function(s){return s.depthToSpace(r,e,n)},{$x:r})}}),Wn=O({expandDims_:function(t,e){e===void 0&&(e=0);var n=T(t,"x","expandDims",null);N(e<=n.rank,function(){return"Axis must be <= rank of the tensor"});var r=n.shape.slice();return e<0&&(N(-(n.rank+1)<=e,function(){return"Axis must be in the interval ["+-(n.rank+1)+", "+n.rank+"]"}),e=n.rank+e+1),r.splice(e,0,1),hr(n,r)}}),nR=O({eye_:function(t,e,n,r){r===void 0&&(r="float32"),e==null&&(e=t);for(var o=Ce([t,e],r),i=t<=e?t:e,a=0;a<i;++a)o.set(1,a,a);var s=o.toTensor().as2D(t,e);if(n==null)return s;if(n.length===1)return xs(Wn(s,0),[n[0],1,1]);if(n.length===2)return xs(Wn(Wn(s,0),0),[n[0],n[1],1,1]);if(n.length===3)return xs(Wn(Wn(Wn(s,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error("eye() currently supports only 1D and 2D batchShapes, but received "+n.length+"D.")}}),v$=O({multinomial_:function(t,e,n,r){r===void 0&&(r=!1);var o=T(t,"logits","multinomial"),i=o.size,a=o.rank;if(i<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+i+".");if(a>2)throw new Error("Rank of probabilities must be 1 or 2, but is "+a);n=n||Math.random();var s=a===1?o.as2D(1,-1):o,u=L.runKernelFunc(function(c){return c.multinomial(s,r,e,n)},{logits2D:s});return a===1?u.as1D():u}}),Hv=O({oneHot_:function(t,e,n,r){if(n===void 0&&(n=1),r===void 0&&(r=0),e<2)throw new Error("Error in oneHot: depth must be >=2, but it is "+e);var o=T(t,"indices","oneHot","int32"),i=o.shape.concat([e]);return o=o.flatten(),L.runKernelFunc(function(a){return a.oneHot(o,e,n,r)},{$indices:o},function(a){return{$indices:function(){return Xe(o.shape,"float32")}}}).reshape(i)}}),Ia=O({pad_:function(t,e,n){n===void 0&&(n=0);var r=T(t,"x","pad");if(r.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");var o={paddings:e,constantValue:n};return L.runKernelFunc(function(i){return i.pad(r,e,n)},{x:r},function(i){var a=e.map(function(s){return s[0]});return{x:function(){return i.slice(a,r.shape)}}},"PadV2",o)}}),g$=O({pad1d_:function(t,e,n){return n===void 0&&(n=0),N(e.length===2,function(){return"Invalid number of paddings. Must be length of 2."}),Ia(t,[e],n)}}),y$=O({pad2d_:function(t,e,n){return n===void 0&&(n=0),N(e.length===2&&e[0].length===2&&e[1].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),Ia(t,e,n)}}),x$=O({pad3d_:function(t,e,n){return n===void 0&&(n=0),N(e.length===3&&e[0].length===2&&e[1].length===2&&e[2].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),Ia(t,e,n)}}),w$=O({pad4d_:function(t,e,n){return n===void 0&&(n=0),N(e.length===4&&e[0].length===2&&e[1].length===2&&e[2].length===2&&e[3].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),Ia(t,e,n)}}),b$=O({rand_:function(t,e,n){var r=le(t),o=null;if(n==null||n==="float32")o=new Float32Array(r);else if(n==="int32")o=new Int32Array(r);else{if(n!=="bool")throw new Error("Unknown data type "+n);o=new Uint8Array(r)}for(var i=0;i<r;i++)o[i]=e();return L.makeTensor(o,t,n)}}),E$=O({randomNormal_:function(t,e,n,r,o){if(e===void 0&&(e=0),n===void 0&&(n=1),r!=null&&r==="bool")throw new Error("Unsupported data type "+r);for(var i=new qy(e,n,r,!1,o),a=Ce(t,r),s=0;s<a.values.length;s++)a.values[s]=i.nextValue();return a.toTensor()}}),C$=O({randomGamma_:function(t,e,n,r,o){if(n===void 0&&(n=1),r===void 0&&(r="float32"),n==null&&(n=1),r==null&&(r="float32"),r!=="float32"&&r!=="int32")throw new Error("Unsupported data type "+r);for(var i=new u$(e,n,r,o),a=Ce(t,r),s=0;s<a.values.length;s++)a.values[s]=i.nextValue();return a.toTensor()}}),rR=O({randomUniform_:function(t,e,n,r,o){e===void 0&&(e=0),n===void 0&&(n=1),r===void 0&&(r="float32");for(var i=Ce(t,r),a=new c$(e,n,null,o),s=0;s<i.values.length;s++)i.values[s]=a.nextValue();return i.toTensor()}}),hr=O({reshape_:function(t,e){var n=T(t,"x","reshape",null);e=nW(e,n.size),N(n.size===le(e),function(){return"new shape and old shape must have the same number of elements."});var r={shape:e};return L.runKernelFunc(function(o){return o.reshape(n,e)},{x:n},function(o){return{x:function(){return o.reshape(n.shape)}}},"Reshape",r)}}),oR=O({spaceToBatchND_:function(t,e,n){var r=T(t,"x","spaceToBatchND");return N(r.rank>=1+e.length,function(){return"input rank "+r.rank+" should be > than [blockShape] "+e.length}),N(n.length===e.length,function(){return"paddings.shape[0] "+n.length+" must be equal to [blockShape] "+e.length}),N(r.shape.reduce(function(o,i,a){return a>0&&a<=e.length?o&&(i+n[a-1][0]+n[a-1][1])%e[a-1]==0:o},!0),function(){return"input spatial dimensions "+r.shape.slice(1)+" with paddings "+n.toString()+" must be divisible by blockShapes "+e.toString()}),L.runKernelFunc(function(o){return o.spaceToBatchND(r,e,n)},{$x:r},function(o){return{$x:function(){return o.batchToSpaceND(e,n)}}})}}),iR=O({squeeze_:function(t,e){var n=T(t,"x","squeeze");return hr(n,qi(n.shape,e).newShape)}}),Dn=O({stack_:function(t,e){e===void 0&&(e=0);var n=yf(t,"tensors","stack");if(N(n.length>=1,function(){return"Pass at least one tensor to tf.stack"}),n.length===1)return n[0].expandDims(e);var r=n[0].rank,o=n[0].shape,i=n[0].dtype;N(e<=r,function(){return"Axis must be <= rank of the tensor"}),n.forEach(function(s){We(o,s.shape,"All tensors passed to stack must have matching shapes")}),n.forEach(function(s){N(i===s.dtype,function(){return"All tensors passed to stack must have matching dtypes"})});var a=n.map(function(s){return s.expandDims(e)});return wt(a,e)}}),xs=O({tile_:function(t,e){var n=T(t,"x","tile",null);N(n.rank===e.length,function(){return"Error in transpose: rank of input "+n.rank+" must match length of reps "+e+"."});var r=[n],o={reps:e};return L.runKernelFunc(function(i,a){var s=i.tile(n,e);return a([n]),s},{x:n},function(i,a){var s=a[0];return{x:function(){var u=Me(s);if(s.rank===1)for(var c=0;c<e[0];++c)u=u.add(i.slice([c*s.shape[0]],[s.shape[0]]));else if(s.rank===2)for(c=0;c<e[0];++c)for(var l=0;l<e[1];++l)u=u.add(i.slice([c*s.shape[0],l*s.shape[1]],[s.shape[0],s.shape[1]]));else if(s.rank===3)for(c=0;c<e[0];++c)for(l=0;l<e[1];++l)for(var d=0;d<e[2];++d)u=u.add(i.slice([c*s.shape[0],l*s.shape[1],d*s.shape[2]],[s.shape[0],s.shape[1],s.shape[2]]));else{if(s.rank!==4)throw new Error("Gradient for tile operation is not implemented for rank-"+s.rank+" tensors yet.");for(c=0;c<e[0];++c)for(l=0;l<e[1];++l)for(d=0;d<e[2];++d)for(var f=0;f<e[3];++f)u=u.add(i.slice([c*s.shape[0],l*s.shape[1],d*s.shape[2],f*s.shape[3]],[s.shape[0],s.shape[1],s.shape[2],s.shape[3]]))}return u}}},"Tile",o,r)}}),_$=O({truncatedNormal_:function(t,e,n,r,o){if(e===void 0&&(e=0),n===void 0&&(n=1),r!=null&&r==="bool")throw new Error("Unsupported data type "+r);for(var i=new qy(e,n,r,!0,o),a=Ce(t,r),s=0;s<a.values.length;s++)a.values[s]=i.nextValue();return a.toTensor()}}),bt=O({unstack_:function(t,e){e===void 0&&(e=0),e=e||0;var n=T(t,"x","unstack");N(e>=-n.shape.length&&e<n.shape.length,function(){return"Axis = "+e+" is not in [-"+n.shape.length+", "+n.shape.length+")"}),e<0&&(e+=n.shape.length);var r={axis:e};return L.runKernelFunc(function(o){return o.unstack(n,e)},{x:n},function(o){return{x:function(){return Dn(o,e)}}},"Unpack",r)}}),S$=function(t,e){return ue(this,void 0,void 0,function(){var n,r,o,i,a,s,u,c,l,d;return ce(this,function(f){switch(f.label){case 0:return n=T(t,"x","setdiff1d"),r=T(e,"y","setdiff1d"),N(n.dtype===r.dtype,function(){return"x and y should have the same dtype, but got x ("+n.dtype+") and y ("+r.dtype+")."}),N(n.rank===1,function(){return"x should be 1D tensor, but got x ("+n.shape+")."}),N(r.rank===1,function(){return"y should be 1D tensor, but got y ("+r.shape+")."}),[4,n.data()];case 1:return o=f.sent(),[4,r.data()];case 2:for(i=f.sent(),a=new Set(i),s=0,l=0;l<o.length;l++)a.has(o[l])||s++;for(u=new _c([s],n.dtype),c=new _c([s],"int32"),l=0,d=0;l<o.length;l++)a.has(o[l])||(u.values[d]=o[l],c.values[d]=l,d++);return[2,[u.toTensor(),c.toTensor()]]}})})};function wf(t,e,n,r){r===void 0&&(r=!0);var o=[];if(r)(o=o.concat(e.slice(0))).push(t[0]/n),o=o.concat(t.slice(1));else{o=o.concat(t[0]);for(var i=e.length,a=0;a<i;++a)o=o.concat([t[a+1]/e[a],e[a]]);o=o.concat(t.slice(i+1))}return o}function bf(t,e,n){n===void 0&&(n=!0);var r=[];if(n){r.push(e);for(var o=e+1;o<t;++o)o<=2*e?(r.push(o),r.push(o-(e+1))):r.push(o)}else{var i=[],a=[];for(o=1;o<t;++o)o>=2*e+1||o%2==1?a.push(o):i.push(o);r.push.apply(r,i),r.push(0),r.push.apply(r,a)}return r}function Ef(t,e,n,r){r===void 0&&(r=!0);var o=[];r?o.push(t[0]/n):o.push(t[0]*n);for(var i=1;i<t.length;++i)i<=e.length?r?o.push(e[i-1]*t[i]):o.push(t[i]/e[i-1]):o.push(t[i]);return o}function aR(t,e){for(var n=[0],r=0;r<e;++r)n.push(t[r][0]);return n}function sR(t,e,n){for(var r=t.slice(0,1),o=0;o<n;++o)r.push(t[o+1]-e[o][0]-e[o][1]);return r}function uR(t,e){if(t.rank<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher, but the rank was "+t.rank+".");if(e.rank<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher, but the rank was "+e.rank+".");if(e.dtype!=="int32")throw new Error("tf.gatherND() expects the indices to be int32 type, but the dtype was "+e.dtype+".");if(e.shape[e.rank-1]>t.rank)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+e.shape[e.rank-1]+" vs. "+t.rank);if(t.size===0)throw new Error("Requested more than 0 entries, but input is empty. Input shape: "+t.shape+".");for(var n=e.shape,r=n[n.length-1],o=1,i=0;i<n.length-1;++i)o*=n[i];var a=t.shape,s=n.slice();s.pop();var u=1;for(i=r;i<t.rank;++i)u*=a[i],s.push(a[i]);var c=Vr(t.shape).map(function(l){return l/u}).concat([1]).slice(0,r);return[s,o,u,c]}var cR=30;function Kp(t){return t<=cR?t:jv(t,Math.floor(Math.sqrt(t)))}function k$(t,e,n){var r=e.rank>1?e.shape[e.rank-1]:1,o=e.rank>1?e.rank-1:1,i="Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: "+n.shape+", indices.shape: "+e.shape+", shape: "+t+", sliceDim: "+r+", and batchDim: "+o+".";if(n.rank<o)throw new Error(i+" update.rank < "+o+". ");if(t.length<r+(n.rank-o))throw new Error(i+" Output shape length < "+(r+(n.rank-o)));if(n.rank!==o+t.length-r)throw new Error(i+" update.rank != "+(o+t.length-r));for(var a=0;a<o;++a)if(n.shape[a]!==e.shape[a])throw new Error(i+" updates.shape["+a+"] ("+n.shape[a]+") != indices.shape["+a+"] ("+e.shape[a]+").");for(a=0;a<n.rank-o;++a)if(n.shape[a+o]!==t[a+r])throw new Error(i+" updates.shape["+(a+o)+"] ("+n.shape[a+o]+") != shape["+(a+o)+"] ("+t[a+o]+")")}function I$(t,e,n){if(e.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher, but the rank was "+e.rank+".");if(t.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher, but the rank was "+t.rank+".");if(e.dtype!=="int32")throw new Error("The dtype of 'indices' should be int32, but got dtype: "+e.dtype);if(n.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: "+n);if(n.length===0){if(e.size===0)throw new Error("Indices specified for empty output. indices shape: "+e.shape);if(t.size===0)throw new Error("Updates specified for empty output. updates shape: "+t.shape)}k$(n,e,t)}function Cf(t,e,n){for(var r=e.shape.length,o=r>1?e.shape[r-1]:1,i=n.length,a=1,s=o;s<i;++s)a*=n[s];var u=o<1?1:o;return{sliceRank:o,numUpdates:le(e.shape)/u,sliceSize:a,strides:Vr(n.slice(0,o)).concat([1]),outputSize:le(n)}}function R$(t,e,n){N(t.rank===e.length,function(){return"Error in slice"+t.rank+"D: Length of begin "+e+" must match the rank of the array ("+t.rank+")."}),N(t.rank===n.length,function(){return"Error in slice"+t.rank+"D: Length of size "+n+" must match the rank of the array ("+t.rank+")."});for(var r=function(i){N(e[i]+n[i]<=t.shape[i],function(){return"Error in slice"+t.rank+"D: begin["+i+"] + size["+i+"] ("+(e[i]+n[i])+") would overflow input.shape["+i+"] ("+t.shape[i]+")"})},o=0;o<t.rank;++o)r(o)}function Jw(t){for(var e=[],n=0;t>0;)1&t&&e.push(n),t/=2,n++;return e}function Xy(t,e,n){for(var r=[],o=0;o<t.length;o++)r[o]=Math.ceil((e[o]-t[o])/n[o]);return r}function T$(t,e,n,r,o){var i=e[o],a=n[o]||1;(t&1<<o||i==null)&&(i=a>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);var s=r[o];return i<0&&(i+=s),i=Fv(0,i,s-1)}function N$(t,e,n,r,o){var i=e[o],a=n[o]||1;(t&1<<o||i==null)&&(i=a>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);var s=r[o];return i<0&&(i+=s),i=a>0?Fv(0,i,s):Fv(-1,i,s-1)}function lR(t,e,n){for(var r=n.length,o=0;o<n.length;o++)if(n[o]>1){r=o;break}for(o=r+1;o<n.length;o++)if(e[o]>0||n[o]!==t[o])return!1;return!0}function dR(t,e){for(var n=t.length>0?t[t.length-1]:1,r=0;r<t.length-1;r++)n+=t[r]*e[r];return n}function A$(t,e){N(Bv(t),function(){return"The f passed in variableGrads(f) must be a function"}),N(e==null||Array.isArray(e)&&e.every(function(l){return l instanceof Js}),function(){return"The varList passed in variableGrads(f, varList) must be an array of variables"});var n=e!=null;if(!n)for(var r in e=[],L.registeredVariables)e.push(L.registeredVariables[r]);var o=n?e.filter(function(l){return!l.trainable}):null,i=e.length;N((e=e.filter(function(l){return l.trainable})).length>0,function(){return"variableGrads() expects at least one of the input variables to be trainable, but none of the "+i+" variables is trainable."});var a=L.gradients(t,e,null,!0),s=a.value,u=a.grads;N(u.some(function(l){return l!=null}),function(){return"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."}),N(s.rank===0,function(){return"The f passed in variableGrads(f) must return a scalar, but it returned a rank-"+s.rank+" tensor"});var c={};return e.forEach(function(l,d){u[d]!=null&&(c[l.name]=u[d])}),o!=null&&o.forEach(function(l){return c[l.name]=null}),{value:s,grads:c}}function Sh(t){return L.customGrad(t)}var To=O({softmax_:function(t,e){e===void 0&&(e=-1);var n=T(t,"logits","softmax","float32");if(e===-1&&(e=n.rank-1),e!==n.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. Logits was rank "+n.rank+" and dim was "+e);return L.runKernelFunc(function(r,o){var i=r.softmax(n,e);return o([i]),i},{logits:n},function(r,o){var i=o[0],a=r.mul(i);return{logits:function(){return a.sub(a.sum([e],!0).mul(i))}}},"Softmax",{dim:e},[],[!0])}}),P$=O({logSoftmax_:function(t,e){e===void 0&&(e=-1);var n=T(t,"logits","logSoftmax");if(e===-1&&(e=n.rank-1),e!==n.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. Logits was rank "+n.rank+" and axis was "+e);return Sh(function(r,o){var i=r.max(e,!0),a=r.sub(i),s=a.toFloat().sub(a.exp().sum(e,!0).log());return o([s]),{value:s,gradFunc:function(u,c){var l=c[0].exp();return u.sub(u.sum(e,!0).mul(l))}}})(n)}}),fR=function(){function t(e,n){this.backend=e,this.dataMover=n,this.data=new WeakMap,this.dataIdsCount=0}return t.prototype.get=function(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)},t.prototype.set=function(e,n){this.dataIdsCount++,this.data.set(e,n)},t.prototype.has=function(e){return this.data.has(e)},t.prototype.delete=function(e){return this.dataIdsCount--,this.data.delete(e)},t.prototype.numDataIds=function(){return this.dataIdsCount},t}(),hR=function(){function t(){}return t.prototype.time=function(e){return z("time")},t.prototype.read=function(e){return z("read")},t.prototype.readSync=function(e){return z("readSync")},t.prototype.numDataIds=function(){return z("numDataIds")},t.prototype.disposeData=function(e){return z("disposeData")},t.prototype.write=function(e,n,r){return z("write")},t.prototype.move=function(e,n,r,o){return z("move")},t.prototype.memory=function(){return z("memory")},t.prototype.floatPrecision=function(){return z("floatPrecision")},t.prototype.epsilon=function(){return this.floatPrecision()===32?1e-7:1e-4},t.prototype.batchMatMul=function(e,n,r,o){return z("batchMatMul")},t.prototype.fusedBatchMatMul=function(e){return e.a,e.b,e.transposeA,e.transposeB,e.bias,e.activation,e.preluActivationWeights,z("fusedBatchMatMul")},t.prototype.slice=function(e,n,r){return z("slice")},t.prototype.stridedSlice=function(e,n,r,o){return z("stridedSlice")},t.prototype.unstack=function(e,n){return z("unstack")},t.prototype.reverse=function(e,n){return z("reverse")},t.prototype.concat=function(e,n){return z("concat")},t.prototype.neg=function(e){return z("neg")},t.prototype.add=function(e,n){return z("add")},t.prototype.addN=function(e){return z("addN")},t.prototype.subtract=function(e,n){return z("subtract")},t.prototype.multiply=function(e,n){return z("multiply")},t.prototype.realDivide=function(e,n){return z("realDivide")},t.prototype.floorDiv=function(e,n){return z("floorDiv")},t.prototype.sum=function(e,n){return z("sum")},t.prototype.prod=function(e,n){return z("prod")},t.prototype.unsortedSegmentSum=function(e,n,r){return z("unsortedSegmentSum")},t.prototype.argMin=function(e,n){return z("argMin")},t.prototype.argMax=function(e,n){return z("argMax")},t.prototype.equal=function(e,n){return z("equal")},t.prototype.notEqual=function(e,n){return z("notEqual")},t.prototype.less=function(e,n){return z("less")},t.prototype.lessEqual=function(e,n){return z("lessEqual")},t.prototype.greater=function(e,n){return z("greater")},t.prototype.greaterEqual=function(e,n){return z("greaterEqual")},t.prototype.logicalNot=function(e){return z("logicalNot")},t.prototype.logicalAnd=function(e,n){return z("logicalAnd")},t.prototype.logicalOr=function(e,n){return z("logicalOr")},t.prototype.where=function(e){return z("where")},t.prototype.select=function(e,n,r){return z("select")},t.prototype.topk=function(e,n,r){return z("topk")},t.prototype.min=function(e,n){return z("min")},t.prototype.minimum=function(e,n){return z("minimum")},t.prototype.mod=function(e,n){return z("mod")},t.prototype.max=function(e,n){return z("max")},t.prototype.maximum=function(e,n){return z("maximum")},t.prototype.all=function(e,n){return z("all")},t.prototype.any=function(e,n){return z("any")},t.prototype.squaredDifference=function(e,n){return z("squaredDifference")},t.prototype.ceil=function(e){return z("ceil")},t.prototype.floor=function(e){return z("floor")},t.prototype.round=function(e){return z("round")},t.prototype.sign=function(e){return z("sign")},t.prototype.isNaN=function(e){return z("isNaN")},t.prototype.isInf=function(e){return z("isInf")},t.prototype.isFinite=function(e){return z("isFinite")},t.prototype.pow=function(e,n){return z("pow")},t.prototype.exp=function(e){return z("exp")},t.prototype.expm1=function(e){return z("expm1")},t.prototype.softmax=function(e,n){return z("softmax")},t.prototype.log=function(e){return z("log")},t.prototype.log1p=function(e){return z("log1p")},t.prototype.sqrt=function(e){return z("sqrt")},t.prototype.rsqrt=function(e){return z("rsqrt")},t.prototype.square=function(e){return z("square")},t.prototype.reciprocal=function(e){return z("reciprocal")},t.prototype.relu=function(e){return z("relu")},t.prototype.relu6=function(e){return z("relu6")},t.prototype.prelu=function(e,n){return z("prelu")},t.prototype.elu=function(e){return z("elu")},t.prototype.eluDer=function(e,n){return z("eluDer")},t.prototype.selu=function(e){return z("selu")},t.prototype.int=function(e){return z("int")},t.prototype.clip=function(e,n,r){return z("clip")},t.prototype.abs=function(e){return z("abs")},t.prototype.complexAbs=function(e){return z("complexAbs")},t.prototype.sigmoid=function(e){return z("sigmoid")},t.prototype.softplus=function(e){return z("softplus")},t.prototype.sin=function(e){return z("sin")},t.prototype.cos=function(e){return z("cos")},t.prototype.tan=function(e){return z("tan")},t.prototype.asin=function(e){return z("asin")},t.prototype.acos=function(e){return z("acos")},t.prototype.atan=function(e){return z("atan")},t.prototype.atan2=function(e,n){return z("atan2")},t.prototype.sinh=function(e){return z("sinh")},t.prototype.cosh=function(e){return z("cosh")},t.prototype.tanh=function(e){return z("tanh")},t.prototype.asinh=function(e){return z("asinh")},t.prototype.acosh=function(e){return z("acosh")},t.prototype.atanh=function(e){return z("atanh")},t.prototype.erf=function(e){return z("erf")},t.prototype.step=function(e,n){return z("step")},t.prototype.fusedConv2d=function(e){return e.input,e.filter,e.convInfo,e.bias,e.activation,e.preluActivationWeights,z("fusedConv2d")},t.prototype.conv2d=function(e,n,r){return z("conv2d")},t.prototype.conv2dDerInput=function(e,n,r){return z("conv2dDerInput")},t.prototype.conv2dDerFilter=function(e,n,r){return z("conv2dDerFilter")},t.prototype.fusedDepthwiseConv2D=function(e){return e.input,e.filter,e.convInfo,e.bias,e.activation,e.preluActivationWeights,z("fusedDepthwiseConv2D")},t.prototype.depthwiseConv2D=function(e,n,r){return z("depthwiseConv2D")},t.prototype.depthwiseConv2DDerInput=function(e,n,r){return z("depthwiseConv2DDerInput")},t.prototype.depthwiseConv2DDerFilter=function(e,n,r){return z("depthwiseConv2DDerFilter")},t.prototype.conv3d=function(e,n,r){return z("conv3d")},t.prototype.conv3dDerInput=function(e,n,r){return z("conv3dDerInput")},t.prototype.conv3dDerFilter=function(e,n,r){return z("conv3dDerFilter")},t.prototype.maxPool=function(e,n){return z("maxPool")},t.prototype.maxPoolBackprop=function(e,n,r,o){return z("maxPoolBackprop")},t.prototype.avgPool=function(e,n){return z("avgPool")},t.prototype.avgPoolBackprop=function(e,n,r){return z("avgPoolBackprop")},t.prototype.avgPool3d=function(e,n){return z("avgPool3d")},t.prototype.avgPool3dBackprop=function(e,n,r){return z("avgPool3dBackprop")},t.prototype.maxPool3d=function(e,n){return z("maxPool3d")},t.prototype.maxPool3dBackprop=function(e,n,r,o){return z("maxPool3dBackprop")},t.prototype.reshape=function(e,n){return z("reshape")},t.prototype.cast=function(e,n){return z("cast")},t.prototype.tile=function(e,n){return z("tile")},t.prototype.pad=function(e,n,r){return z("pad")},t.prototype.transpose=function(e,n){return z("transpose")},t.prototype.gather=function(e,n,r){return z("gather")},t.prototype.gatherND=function(e,n){return z("gatherND")},t.prototype.scatterND=function(e,n,r){return z("scatterND")},t.prototype.batchToSpaceND=function(e,n,r){return z("batchToSpaceND")},t.prototype.spaceToBatchND=function(e,n,r){return z("spaceToBatchND")},t.prototype.resizeBilinear=function(e,n,r,o){return z("resizeBilinear")},t.prototype.resizeBilinearBackprop=function(e,n,r){return z("resizeBilinearBackprop")},t.prototype.resizeNearestNeighbor=function(e,n,r,o){return z("resizeNearestNeighbor")},t.prototype.resizeNearestNeighborBackprop=function(e,n,r){return z("resizeNearestNeighborBackprop")},t.prototype.batchNormalization=function(e,n,r,o,i,a){return z("batchNormalization")},t.prototype.localResponseNormalization4D=function(e,n,r,o,i){return z("localResponseNormalization4D")},t.prototype.LRNGrad=function(e,n,r,o,i,a,s){return z("LRNGrad")},t.prototype.multinomial=function(e,n,r,o){return z("multinomial")},t.prototype.oneHot=function(e,n,r,o){return z("oneHot")},t.prototype.cumsum=function(e,n,r,o){return z("cumsum")},t.prototype.nonMaxSuppression=function(e,n,r,o,i){return z("nonMaxSuppression")},t.prototype.fft=function(e){return z("fft")},t.prototype.ifft=function(e){return z("ifft")},t.prototype.complex=function(e,n){return z("complex")},t.prototype.real=function(e){return z("real")},t.prototype.imag=function(e){return z("imag")},t.prototype.cropAndResize=function(e,n,r,o,i,a){return z("cropAndResize")},t.prototype.depthToSpace=function(e,n,r){return z("depthToSpace")},t.prototype.split=function(e,n,r){return z("split")},t.prototype.sparseToDense=function(e,n,r,o){return z("sparseToDense")},t.prototype.diag=function(e){return z("diag")},t.prototype.fill=function(e,n,r){return z("fill")},t.prototype.onesLike=function(e){return z("onesLike")},t.prototype.zerosLike=function(e){return z("zerosLike")},t.prototype.linspace=function(e,n,r){return z("linspace")},t.prototype.dispose=function(){return z("dispose")},t}();function z(t){throw new Error("'"+t+"' not yet implemented or not found in the registry. Did you forget to import the kernel?")}function si(t,e){for(var n=t.length,r=[],o=0;o<n;o++){var i=n-1-o,a=t[i]||1;(e[e.length-1-o]||1)>1&&a===1&&r.unshift(i)}return r}function Et(t,e){for(var n=[],r=0;r<e.length;r++){var o=t[t.length-r-1],i=e.length-r-1,a=e[i];(o==null||o===1&&a>1)&&n.unshift(i)}return n}function Ne(t,e){for(var n=[],r=Math.max(t.length,e.length),o=0;o<r;o++){var i=t[t.length-o-1];i==null&&(i=1);var a=e[e.length-o-1];if(a==null&&(a=1),i===1)n.unshift(a);else if(a===1)n.unshift(i);else{if(i!==a)throw Error("Operands could not be broadcast together with shapes "+t+" and "+e+".");n.unshift(i)}}return n}function kc(t,e,n,r,o,i,a){a===void 0&&(a="channelsLast");var s,u=kf(e),c=u[0],l=u[1];if(a==="channelsLast")s=[c,l,t[3],t[3]];else{if(a!=="channelsFirst")throw new Error("Unknown dataFormat "+a);s=[c,l,t[1],t[1]]}return Ra(t,s,n,r,o,i,!1,a)}function _f(t,e,n,r,o,i,a){a===void 0&&(a="NDHWC");var s,u,c=Gv(e),l=c[0],d=c[1],f=c[2];if(a==="NDHWC")u="channelsLast",s=[l,d,f,t[4],t[4]];else{if(a!=="NCDHW")throw new Error("Unknown dataFormat "+a);u="channelsFirst",s=[l,d,f,t[1],t[1]]}return Sf(t,s,n,r,o,!1,u,i)}function Ra(t,e,n,r,o,i,a,s){a===void 0&&(a=!1),s===void 0&&(s="channelsLast");var u=[-1,-1,-1,-1],c=u[0],l=u[1],d=u[2],f=u[3];if(s==="channelsLast")c=t[0],l=t[1],d=t[2],f=t[3];else{if(s!=="channelsFirst")throw new Error("Unknown dataFormat "+s);c=t[0],f=t[1],l=t[2],d=t[3]}var h,m=e[0],p=e[1],g=e[3],v=kf(n),y=v[0],x=v[1],w=kf(r),E=w[0],_=w[1],S=ws(m,E),k=ws(p,_),I=function(F,W,U,$,M,P,B,G){var q,J,H;if(typeof F=="number"){q={top:F,bottom:F,left:F,right:F,type:F===0?"VALID":"NUMBER"};var Q=function(pe,be,ve,Pe,Ue){Pe==null&&(Pe=pR(pe,be,ve));var Le=pe[0],St=pe[1],ht=Gu((Le-be+2*Pe)/ve+1,Ue);N(ft(ht),function(){return"The output # of rows ("+ht+") must be an integer. Change the stride and/or zero pad parameters"});var ct=Gu((St-be+2*Pe)/ve+1,Ue);return N(ft(ct),function(){return"The output # of columns ("+ct+") must be an integer. Change the stride and/or zero pad parameters"}),[ht,ct]}([W,U],P,$,F,G);J=Q[0],H=Q[1]}else if(F==="same"){J=Math.ceil(W/$),H=Math.ceil(U/M);var ne=Math.max(0,(J-1)*$+P-W),Z=Math.max(0,(H-1)*M+B-U),se=Math.floor(ne/2),re=ne-se,xe=Math.floor(Z/2);q={top:se,bottom:re,left:xe,right:Z-xe,type:"SAME"}}else{if(F!=="valid")throw Error("Unknown padding parameter: "+F);q={top:0,bottom:0,left:0,right:0,type:"VALID"},J=Math.ceil((W-P+1)/$),H=Math.ceil((U-B+1)/M)}return{padInfo:q,outHeight:J,outWidth:H}}(o,l,d,y,x,S,k,i),R=I.padInfo,D=I.outHeight,A=I.outWidth,j=a?g*f:g;return s==="channelsFirst"?h=[c,j,D,A]:s==="channelsLast"&&(h=[c,D,A,j]),{batchSize:c,dataFormat:s,inHeight:l,inWidth:d,inChannels:f,outHeight:D,outWidth:A,outChannels:j,padInfo:R,strideHeight:y,strideWidth:x,filterHeight:m,filterWidth:p,effectiveFilterHeight:S,effectiveFilterWidth:k,dilationHeight:E,dilationWidth:_,inShape:t,outShape:h,filterShape:e}}function Sf(t,e,n,r,o,i,a,s){i===void 0&&(i=!1),a===void 0&&(a="channelsLast");var u=[-1,-1,-1,-1,-1],c=u[0],l=u[1],d=u[2],f=u[3],h=u[4];if(a==="channelsLast")c=t[0],l=t[1],d=t[2],f=t[3],h=t[4];else{if(a!=="channelsFirst")throw new Error("Unknown dataFormat "+a);c=t[0],h=t[1],l=t[2],d=t[3],f=t[4]}var m,p=e[0],g=e[1],v=e[2],y=e[4],x=Gv(n),w=x[0],E=x[1],_=x[2],S=Gv(r),k=S[0],I=S[1],R=S[2],D=ws(p,k),A=ws(g,I),j=ws(v,R),F=function(B,G,q,J,H,Q,ne,Z,se,re,xe){var pe,be,ve,Pe;if(typeof B=="number"){pe={top:B,bottom:B,left:B,right:B,front:B,back:B,type:B===0?"VALID":"NUMBER"};var Ue=function(jt,Jn,Ut,bn,Ln,du){Ln==null&&(Ln=pR(jt,Jn,bn));var Aa=jt[0],jh=jt[1],cl=jt[2],Bi=Gu((Aa-Jn+2*Ln)/bn+1,du);N(ft(Bi),function(){return"The output # of depths ("+Bi+") must be an integer. Change the stride and/or zero pad parameters"});var Cr=Gu((jh-Jn+2*Ln)/bn+1,du);N(ft(Cr),function(){return"The output # of rows ("+Cr+") must be an integer. Change the stride and/or zero pad parameters"});var Pa=Gu((cl-Jn+2*Ln)/bn+1,du);return N(ft(Pa),function(){return"The output # of columns ("+Pa+") must be an integer. Change the stride and/or zero pad parameters"}),[Bi,Cr,Pa,Ut]}([G,q,J,1],Z,1,H,B,xe);be=Ue[0],ve=Ue[1],Pe=Ue[2]}else if(B==="same"){be=Math.ceil(G/H),ve=Math.ceil(q/Q),Pe=Math.ceil(J/ne);var Le=(be-1)*H+Z-G,St=(ve-1)*Q+se-q,ht=(Pe-1)*ne+re-J,ct=Math.floor(Le/2),Qn=Le-ct,kt=Math.floor(St/2),Qe=St-kt,lt=Math.floor(ht/2);pe={top:kt,bottom:Qe,left:lt,right:ht-lt,front:ct,back:Qn,type:"SAME"}}else{if(B!=="valid")throw Error("Unknown padding parameter: "+B);pe={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},be=Math.ceil((G-Z+1)/H),ve=Math.ceil((q-se+1)/Q),Pe=Math.ceil((J-re+1)/ne)}return{padInfo:pe,outDepth:be,outHeight:ve,outWidth:Pe}}(o,l,d,f,w,E,_,D,A,j,s),W=F.padInfo,U=F.outDepth,$=F.outHeight,M=F.outWidth,P=i?y*h:y;return a==="channelsFirst"?m=[c,P,U,$,M]:a==="channelsLast"&&(m=[c,U,$,M,P]),{batchSize:c,dataFormat:a,inDepth:l,inHeight:d,inWidth:f,inChannels:h,outDepth:U,outHeight:$,outWidth:M,outChannels:P,padInfo:W,strideDepth:w,strideHeight:E,strideWidth:_,filterDepth:p,filterHeight:g,filterWidth:v,effectiveFilterDepth:D,effectiveFilterHeight:A,effectiveFilterWidth:j,dilationDepth:k,dilationHeight:I,dilationWidth:R,inShape:t,outShape:m,filterShape:e}}function pR(t,e,n,r){r===void 0&&(r=1);var o=ws(e,r);return Math.floor((t[0]*(n-1)-n+o)/2)}function kf(t){return typeof t=="number"?[t,t,t]:t.length===2?[t[0],t[1],1]:t}function Gv(t){return typeof t=="number"?[t,t,t]:t}function ws(t,e){return e<=1?t:t+(t-1)*(e-1)}function Gu(t,e){if(!e)return t;switch(e){case"round":return Math.round(t);case"ceil":return Math.ceil(t);case"floor":return Math.floor(t);default:throw new Error("Unknown roundingMode "+e)}}function eu(t){var e=kf(t),n=e[0],r=e[1],o=e[2];return n===1&&r===1&&o===1}function wn(t,e){return eu(t)||eu(e)}function Yy(t){if(t==="NHWC")return"channelsLast";if(t==="NCHW")return"channelsFirst";throw new Error("Unknown dataFormat "+t)}function mR(t,e,n){if(e==="complex64"){if(t.dtype==="complex64")return t.clone();var r=Xe(t.shape),o=t.toFloat(),i=n.complex(o,r);return r.dispose(),o.dispose(),i}if(!iW(t.dtype,e))return L.makeTensorFromDataId(t.dataId,t.shape,e);if(t.dtype==="complex64"){var a=n.real(t);return i=a.cast(e),a.dispose(),i}if(e==="int32")return n.int(t);if(e==="bool"){var s=oe(0,t.dtype);return i=n.notEqual(t,s),s.dispose(),i}throw new Error("Error in Cast: failed to cast "+t.dtype+" to "+e)}function Kv(t,e){return L.makeTensorFromDataId(t.dataId,e,t.dtype)}function vR(t,e,n){var r=(e-t)/(n-1),o=el(n,"float32");o[0]=t;for(var i=1;i<o.length;i++)o[i]=o[i-1]+r;return mt(o,"float32")}function qv(t,e){if(t.length!==e.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+t.length+", imag: "+e.length+".");for(var n=new Float32Array(2*t.length),r=0;r<n.length;r+=2)n[r]=t[r/2],n[r+1]=e[r/2];return n}function Zw(t,e){return{real:t[2*e],imag:t[2*e+1]}}function D$(t,e,n,r){t[2*r]=e,t[2*r+1]=n}function M$(t,e,n){var r=(n?2:-2)*Math.PI*(t/e);return{real:Math.cos(r),imag:Math.sin(r)}}function O$(t,e,n){var r=function(i,a,s){return function(u,c,l){for(var d=0,f=u.length,h=0,m=!1;d<f;){var p=l(c,u[h=d+(f-d>>>1)]);p>0?d=h+1:(f=h,m=!p)}return m?d:-d-1}(i,a,s||F$)}(t,e,n),o=r<0?-(r+1):r;t.splice(o,0,e)}function F$(t,e){return t>e?1:t<e?-1:0}function Qy(t,e,n,r,o){return gR(t,e,n,r,o,0).selectedIndices}function Jy(t,e,n,r,o,i){var a=gR(t,e,n,r,o,i);return a.numValidOutputs.dispose(),{selectedIndices:a.selectedIndices,selectedScores:a.selectedScores}}function gR(t,e,n,r,o,i,a,s){s===void 0&&(s=!1);for(var u=Array.from(e).map(function(w,E){return{score:w,boxIndex:E,suppressBeginIndex:0}}).filter(function(w){return w.score>o}).sort(eb),c=i>0?-.5/i:0,l=[],d=[];l.length<n&&u.length>0;){var f=u.pop(),h=f.score,m=f.boxIndex,p=f.suppressBeginIndex;if(h<o)break;for(var g=!1,v=l.length-1;v>=p;--v){var y=L$(t,m,l[v]);if(y>=r){g=!0;break}if(f.score=f.score*B$(r,c,y),f.score<=o)break}f.suppressBeginIndex=l.length,g||(f.score===h?(l.push(m),d.push(f.score)):f.score>o&&O$(u,f,eb))}var x=l.length;return s&&(l.fill(0,x),d.fill(0,x)),{selectedIndices:mt(l,"int32"),selectedScores:mt(d,"float32"),numValidOutputs:oe(x,"int32")}}function L$(t,e,n){var r=t.subarray(4*e,4*e+4),o=t.subarray(4*n,4*n+4),i=Math.min(r[0],r[2]),a=Math.min(r[1],r[3]),s=Math.max(r[0],r[2]),u=Math.max(r[1],r[3]),c=Math.min(o[0],o[2]),l=Math.min(o[1],o[3]),d=Math.max(o[0],o[2]),f=Math.max(o[1],o[3]),h=(s-i)*(u-a),m=(d-c)*(f-l);if(h<=0||m<=0)return 0;var p=Math.max(i,c),g=Math.max(a,l),v=Math.min(s,d),y=Math.min(u,f),x=Math.max(v-p,0)*Math.max(y-g,0);return x/(h+m-x)}function B$(t,e,n){var r=Math.exp(e*n*n);return n<=t?r:0}function eb(t,e){return t.score-e.score||t.score===e.score&&e.boxIndex-t.boxIndex}function yR(t,e,n){var r=new Array(t.rank).fill(0),o=t.shape.slice();return e.map(function(i){o[n]=i;var a=t.slice(r,o);return r[n]+=i,a})}function xR(t,e){for(var n=new Array(t.rank),r=0;r<n.length;r++)n[r]=t.shape[r]*e[r];var o=Ce(n,t.dtype);for(r=0;r<o.values.length;++r){for(var i=o.indexToLoc(r),a=new Array(t.rank),s=0;s<a.length;s++)a[s]=i[s]%t.shape[s];var u=t.locToIndex(a);o.values[r]=t.values[u]}return o.toTensor()}function wR(t,e,n,r,o){for(var i=e[e.length-1],a=[t.length/i,i],s=a[0],u=a[1],c=Cc(n,s*r),l=Cc("int32",s*r),d=0;d<s;d++){for(var f=d*u,h=t.subarray(f,f+u),m=[],p=0;p<h.length;p++)m.push({value:h[p],index:p});m.sort(function(w,E){return E.value-w.value});var g=d*r,v=c.subarray(g,g+r),y=l.subarray(g,g+r);for(p=0;p<r;p++)v[p]=m[p].value,y[p]=m[p].index}var x=e.slice();return x[x.length-1]=r,[Ft(c,x,n),Ft(l,x,"int32")]}function Zy(t,e){for(var n=[],r=0;r<e.length;r++)e[r]&&n.push(r);var o=Ce(t,"int32"),i=Ce([n.length,t.length],"int32");for(r=0;r<n.length;r++){var a=o.indexToLoc(n[r]),s=r*t.length;i.values.set(a,s)}return i.toTensor()}var j$=function(t,e){this.outputShape=[],this.outputShape=t,this.variableNames=e.map(function(o,i){return"T"+i});var n=[];this.variableNames.forEach(function(o){n.push("float v"+o+" = get"+o+"AtOutCoords();")});var r=this.variableNames.map(function(o){return"v"+o}).join(" + ");this.userCode=`
      void main() {
        `+n.join(`
        `)+`

        float result = `+r+`;
        setOutput(result);
      }
    `},U$=function(t,e){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.variableNames=e.map(function(o,i){return"T"+i});var n=[];this.variableNames.forEach(function(o){n.push("vec4 v"+o+" = get"+o+"AtOutCoords();")});var r=this.variableNames.map(function(o){return"v"+o}).join(" + ");this.userCode=`
      void main() {
        `+n.join(`
        `)+`

        vec4 result = `+r+`;
        setOutput(result);
      }
    `},W$=function(t,e,n){this.variableNames=["A"];var r=t.windowSize,o=t.batchSize,i=t.inSize,a=Math.ceil(i/r);n||this.variableNames.push("bestIndicesA"),this.outputShape=[o,a];var s=e==="max"?">":"<",u=n?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * `+r+`;

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < `+r+`; i++) {
          int inIdx = `+u+`;
          float candidate = getA(batch, inIdx);
          if (candidate `+s+` bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `};function bR(t,e){return["x","y","z","w","u","v"].slice(0,e).map(function(n){return t+"."+n})}function fn(t,e){return e===1?[t]:bR(t,e)}function qt(){var t,e,n,r,o,i,a,s,u,c;return K().getNumber("WEBGL_VERSION")===2?(t="#version 300 es",e="in",n="out",r="in",o="texture",i="outputColor",a="out vec4 outputColor;",s=`
      bool isnan_custom(float val) {
        return (val > 0.0 || val < 0.0) ? false : val != 0.0;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `,u="",c=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(t="",e="attribute",n="varying",r="varying",o="texture2D",i="gl_FragColor",a="",s=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,u=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,c=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:t,attribute:e,varyingVs:n,varyingFs:r,texture2D:o,output:i,defineOutput:a,defineSpecialNaN:s,defineSpecialInf:u,defineRound:c}}function Ji(t,e,n){n===void 0&&(n="index");var r=Vr(e);return r.map(function(o,i){return"int "+t[i]+" = "+n+" / "+o+"; "+(i===r.length-1?"int "+t[i+1]+" = "+n+" - "+t[i]+" * "+o:"index -= "+t[i]+" * "+o)+";"}).join("")}function e0(t){var e=Vr(t).map(function(n){return n.toString()});return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * `+e[0]+" + coords.y * "+e[1]+` + coords.z;
  }
`}var ER=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;function $$(t,e,n,r){var o=[];t.forEach(function(h){var m=le(h.shapeInfo.logicalShape);h.shapeInfo.isUniform?o.push("uniform float "+h.name+(m>1?"["+m+"]":"")+";"):(o.push("uniform sampler2D "+h.name+";"),o.push("uniform int offset"+h.name+";"))});var i,a,s=o.join(`
`),u=t.map(function(h){return function(m,p,g){g===void 0&&(g=!1);var v="";v+=g?CR(m):$a(m);var y=m.shapeInfo.logicalShape,x=p.logicalShape;return y.length<=x.length&&(v+=g?function(w,E){var _,S=w.name,k=S.charAt(0).toUpperCase()+S.slice(1),I="get"+k+"AtOutCoords",R=w.shapeInfo.logicalShape.length,D=E.logicalShape.length,A=si(w.shapeInfo.logicalShape,E.logicalShape),j=Ge(D),F=D-R,W=["x","y","z","w","u","v"];_=R===0?"":D<2&&A.length>=1?"coords = 0;":A.map(function(q){return"coords."+W[q+F]+" = 0;"}).join(`
`);var U="";U=D<2&&R>0?"coords":w.shapeInfo.logicalShape.map(function(q,J){return"coords."+W[J+F]}).join(", ");var $="return outputValue;",M=le(w.shapeInfo.logicalShape)===1,P=le(E.logicalShape)===1;if(R!==1||M||P){if(M&&!P)$=D===1?`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:`
        return vec4(outputValue.x);
      `;else if(A.length){var B=R-2,G=R-1;A.indexOf(B)>-1&&A.indexOf(G)>-1?$="return vec4(outputValue.x);":A.indexOf(B)>-1?$="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":A.indexOf(G)>-1&&($="return vec4(outputValue.xx, outputValue.zz);")}}else $=`
      return vec4(outputValue.xy, outputValue.xy);
    `;return`
    vec4 `+I+`() {
      `+j+` coords = getOutputCoords();
      `+_+`
      vec4 outputValue = get`+k+"("+U+`);
      `+$+`
    }
  `}(m,p):function(w,E){var _=w.name,S=_.charAt(0).toUpperCase()+_.slice(1),k="get"+S+"AtOutCoords",I=E.texShape,R=w.shapeInfo.texShape,D=w.shapeInfo.logicalShape.length,A=E.logicalShape.length;if(!w.shapeInfo.isUniform&&D===A&&w.shapeInfo.flatOffset==null&&Nt(R,I))return`
      float `+k+`() {
        return sampleTexture(`+_+`, resultUV);
      }
    `;var j,F=Ge(A),W=si(w.shapeInfo.logicalShape,E.logicalShape),U=A-D,$=["x","y","z","w","u","v"];j=D===0?"":A<2&&W.length>=1?"coords = 0;":W.map(function(P){return"coords."+$[P+U]+" = 0;"}).join(`
`);var M="";return M=A<2&&D>0?"coords":w.shapeInfo.logicalShape.map(function(P,B){return"coords."+$[B+U]}).join(", "),`
    float `+k+`() {
      `+F+` coords = getOutputCoords();
      `+j+`
      return get`+S+"("+M+`);
    }
  `}(m,p)),v}(h,e,r)}).join(`
`),c=e.texShape,l=qt(),d=function(h){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return `+h.texture2D+`(textureSampler, uv).r;
    }
  `}(l),f=function(h){return h.version+`
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    `+h.varyingFs+` vec2 resultUV;
    `+h.defineOutput+`
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    `+h.defineSpecialNaN+`
    `+h.defineSpecialInf+`
    `+h.defineRound+`

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    `+z$+`
    `+V$+`
    `+H$+`
  `}(l);return e.isPacked?(i=function(h,m){switch(h.length){case 0:return`
    int getOutputCoords() {
      return 0;
    }
  `;case 1:return function(w,E){var _=[Math.ceil(E[0]/2),Math.ceil(E[1]/2)];return _[0]===1?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * `+_[1]+`.0);
      }
    `:_[1]===1?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * `+_[0]+`.0);
      }
    `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+_[0]+", "+_[1]+`));
      return 2 * (resTexRC.x * `+_[1]+` + resTexRC.y);
    }
  `}(0,m);case 2:return function(w,E){var _=[Math.ceil(E[0]/2),Math.ceil(E[1]/2)];if(Nt(w,E))return`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(`+_[0]+", "+_[1]+`));
      }
    `;var S=Math.ceil(w[1]/2);return`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+_[0]+", "+_[1]+`));

      int index = resTexRC.x * `+_[1]+` + resTexRC.y;
      int r = 2 * (index / `+S+`);
      int c = imod(index, `+S+`) * 2;

      return ivec2(r, c);
    }
  `}(h,m);case 3:return p=h,g=m,v=[Math.ceil(g[0]/2),Math.ceil(g[1]/2)],y=Math.ceil(p[2]/2),x=y*Math.ceil(p[1]/2),`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+v[0]+", "+v[1]+`));
      int index = resTexRC.x * `+v[1]+` + resTexRC.y;

      int b = index / `+x+`;
      index -= b * `+x+`;

      int r = 2 * (index / `+y+`);
      int c = imod(index, `+y+`) * 2;

      return ivec3(b, r, c);
    }
  `;default:return function(w,E){for(var _=[Math.ceil(E[0]/2),Math.ceil(E[1]/2)],S=Math.ceil(w[w.length-1]/2),k=S*Math.ceil(w[w.length-2]/2),I=k,R="",D="b, r, c",A=2;A<w.length-1;A++)I*=w[w.length-A-1],R=`
      int b`+A+" = index / "+I+`;
      index -= b`+A+" * "+I+`;
    `+R,D="b"+A+", "+D;return`
    ivec`+w.length+` getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+_[0]+", "+_[1]+`));
      int index = resTexRC.x * `+_[1]+` + resTexRC.y;

      `+R+`

      int b = index / `+k+`;
      index -= b * `+k+`;

      int r = 2 * (index / `+S+`);
      int c = imod(index, `+S+`) * 2;

      return ivec`+w.length+"("+D+`);
    }
  `}(h,m)}var p,g,v,y,x}(e.logicalShape,c),a=function(h){return`
    void setOutput(vec4 val) {
      `+h.output+` = val;
    }
  `}(l)):(i=function(h,m){switch(h.length){case 0:return`
    int getOutputCoords() {
      return 0;
    }
  `;case 1:return function(v,y){return y[0]===1?`
      int getOutputCoords() {
        return int(resultUV.x * `+y[1]+`.0);
      }
    `:y[1]===1?`
      int getOutputCoords() {
        return int(resultUV.y * `+y[0]+`.0);
      }
    `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+y[0]+", "+y[1]+`));
      return resTexRC.x * `+y[1]+` + resTexRC.y;
    }
  `}(0,m);case 2:return function(v,y){return Nt(v,y)?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(`+y[0]+", "+y[1]+`));
      }
    `:v[1]===1?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(`+y[0]+", "+y[1]+`));
        int index = resTexRC.x * `+y[1]+` + resTexRC.y;
        return ivec2(index, 0);
      }
    `:v[0]===1?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(`+y[0]+", "+y[1]+`));
        int index = resTexRC.x * `+y[1]+` + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+y[0]+", "+y[1]+`));
      int index = resTexRC.x * `+y[1]+` + resTexRC.y;
      int r = index / `+v[1]+`;
      int c = index - r * `+v[1]+`;
      return ivec2(r, c);
    }
  `}(h,m);case 3:return p=m,g=Ji(["r","c","d"],h),`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+p[0]+", "+p[1]+`));
      int index = resTexRC.x * `+p[1]+` + resTexRC.y;
      `+g+`
      return ivec3(r, c, d);
    }
  `;case 4:return function(v,y){var x=Ji(["r","c","d","d2"],v);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(`+y[0]+", "+y[1]+`));
      int index = resTexRC.x * `+y[1]+` + resTexRC.y;
      `+x+`
      return ivec4(r, c, d, d2);
    }
  `}(h,m);case 5:return function(v,y){var x=Ji(["r","c","d","d2","d3"],v);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(`+y[0]+`,
                             `+y[1]+`));

      int index = resTexRC.x * `+y[1]+` + resTexRC.y;

      `+x+`

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}(h,m);case 6:return function(v,y){var x=Ji(["r","c","d","d2","d3","d4"],v);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(`+y[0]+", "+y[1]+`));
      int index = resTexRC.x * `+y[1]+` + resTexRC.y;

      `+x+`

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}(h,m);default:throw new Error(h.length+"-D output sampling is not yet supported")}var p,g}(e.logicalShape,c),a=function(h){return`
    void setOutput(float val) {
      `+h.output+` = vec4(val, 0, 0, 0);
    }
  `}(l)),r&&(f+=G$),[f,d,a,s,i,u,n].join(`
`)}function $a(t){var e=t.shapeInfo.logicalShape;switch(e.length){case 0:return function(n){var r=n.name,o="get"+r.charAt(0).toUpperCase()+r.slice(1);if(n.shapeInfo.isUniform)return"float "+o+"() {return "+r+";}";var i=n.shapeInfo.texShape,a=i[0],s=i[1];if(a===1&&s===1)return`
      float `+o+`() {
        return sampleTexture(`+r+`, halfCR);
      }
    `;var u=n.shapeInfo.texShape,c=u[0],l=u[1],d=Ui(r);return`
    float `+o+`() {
      vec2 uv = uvFromFlat(`+c+", "+l+", "+d+`);
      return sampleTexture(`+r+`, uv);
    }
  `}(t);case 1:return function(n){var r=n.name,o="get"+r.charAt(0).toUpperCase()+r.slice(1);if(n.shapeInfo.isUniform)return`
      float `+o+`(int index) {
        `+Ba(n)+`
      }
    `;var i=n.shapeInfo.texShape,a=i[0],s=i[1];if(s===1&&a===1)return`
      float `+o+`(int index) {
        return sampleTexture(`+r+`, halfCR);
      }
    `;var u=Ui(r);return s===1?`
      float `+o+`(int index) {
        vec2 uv = vec2(0.5, (float(index + `+u+") + 0.5) / "+a+`.0);
        return sampleTexture(`+r+`, uv);
      }
    `:a===1?`
      float `+o+`(int index) {
        vec2 uv = vec2((float(index + `+u+") + 0.5) / "+s+`.0, 0.5);
        return sampleTexture(`+r+`, uv);
      }
    `:`
    float `+o+`(int index) {
      vec2 uv = uvFromFlat(`+a+", "+s+", index + "+u+`);
      return sampleTexture(`+r+`, uv);
    }
  `}(t);case 2:return function(n){var r=n.shapeInfo.logicalShape,o=n.name,i="get"+o.charAt(0).toUpperCase()+o.slice(1),a=n.shapeInfo.texShape;if(a!=null&&Nt(r,a)){var s=a[0],u=a[1];return`
    float `+i+`(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(`+u+".0, "+s+`.0);
      return sampleTexture(`+o+`, uv);
    }
  `}var c=qi(r),l=c.newShape,d=c.keptDims,f=l;if(f.length<r.length){var h=za(n,f);return`
      `+$a(h)+`
      float `+i+`(int row, int col) {
        return `+i+"("+Va(["row","col"],d)+`);
      }
    `}if(n.shapeInfo.isUniform)return`
      float `+i+`(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(`+r[1]+`, 1)));
        `+Ba(n)+`
      }
    `;var m=a[0],p=a[1],g=Ui(o);return p===1?`
    float `+i+`(int row, int col) {
      float index = dot(vec3(row, col, `+g+"), vec3("+r[1]+`, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / `+m+`.0);
      return sampleTexture(`+o+`, uv);
    }
  `:m===1?`
    float `+i+`(int row, int col) {
      float index = dot(vec3(row, col, `+g+"), vec3("+r[1]+`, 1, 1));
      vec2 uv = vec2((index + 0.5) / `+p+`.0, 0.5);
      return sampleTexture(`+o+`, uv);
    }
  `:`
  float `+i+`(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * `+r[1]+" + col + "+g+`;
    vec2 uv = uvFromFlat(`+m+", "+p+`, index);
    return sampleTexture(`+o+`, uv);
  }
`}(t);case 3:return function(n){var r=n.shapeInfo.logicalShape,o=n.name,i="get"+o.charAt(0).toUpperCase()+o.slice(1),a=r[1]*r[2],s=r[2],u=qi(r),c=u.newShape,l=u.keptDims,d=c;if(d.length<r.length){var f=za(n,d);return`
        `+$a(f)+`
        float `+i+`(int row, int col, int depth) {
          return `+i+"("+Va(["row","col","depth"],l)+`);
        }
      `}if(n.shapeInfo.isUniform)return`
      float `+i+`(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(`+a+", "+s+`, 1)));
        `+Ba(n)+`
      }
    `;var h=n.shapeInfo.texShape,m=h[0],p=h[1],g=n.shapeInfo.flatOffset;if(p===a&&g==null)return`
        float `+i+`(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(`+s+`, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(`+p+".0, "+m+`.0);
          return sampleTexture(`+o+`, uv);
        }
      `;if(p===s&&g==null)return`
    float `+i+`(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(`+r[1]+`, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+p+".0, "+m+`.0);
      return sampleTexture(`+o+`, uv);
    }
  `;var v=Ui(o);return`
      float `+i+`(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * `+a+" + col * "+s+" + depth + "+v+`;
        vec2 uv = uvFromFlat(`+m+", "+p+`, index);
        return sampleTexture(`+o+`, uv);
      }
  `}(t);case 4:return function(n){var r=n.shapeInfo.logicalShape,o=n.name,i="get"+o.charAt(0).toUpperCase()+o.slice(1),a=r[3],s=r[2]*a,u=r[1]*s,c=qi(r),l=c.newShape,d=c.keptDims;if(l.length<r.length){var f=za(n,l);return`
      `+$a(f)+`
      float `+i+`(int row, int col, int depth, int depth2) {
        return `+i+"("+Va(["row","col","depth","depth2"],d)+`);
      }
    `}if(n.shapeInfo.isUniform)return`
      float `+i+`(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(`+u+", "+s+", "+a+`, 1)));
        `+Ba(n)+`
      }
    `;var h=n.shapeInfo.flatOffset,m=n.shapeInfo.texShape,p=m[0],g=m[1];if(g===u&&h==null)return`
      float `+i+`(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(`+s+", "+a+`, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+g+".0, "+p+`.0);
        return sampleTexture(`+o+`, uv);
      }
    `;if(g===a&&h==null)return`
      float `+i+`(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(`+r[1]*r[2]+", "+r[2]+`, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+g+".0, "+p+`.0);
        return sampleTexture(`+o+`, uv);
      }
    `;var v=Ui(o);return`
    float `+i+`(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+u+" + col * "+s+` +
          depth * `+a+` + depth2;
      vec2 uv = uvFromFlat(`+p+", "+g+", index + "+v+`);
      return sampleTexture(`+o+`, uv);
    }
  `}(t);case 5:return function(n){var r=n.shapeInfo.logicalShape,o=n.name,i="get"+o.charAt(0).toUpperCase()+o.slice(1),a=r[4],s=r[3]*a,u=r[2]*s,c=r[1]*u,l=qi(r),d=l.newShape,f=l.keptDims;if(d.length<r.length){var h=za(n,d);return`
      `+$a(h)+`
      float `+i+`(int row, int col, int depth, int depth2, int depth3) {
        return `+i+"("+Va(["row","col","depth","depth2","depth3"],f)+`);
      }
    `}if(n.shapeInfo.isUniform)return`
      float `+i+`(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(`+c+", "+u+", "+s+", "+a+`)) +
          depth3;
        `+Ba(n)+`
      }
    `;var m=n.shapeInfo.flatOffset,p=n.shapeInfo.texShape,g=p[0],v=p[1];if(v===c&&m==null)return`
      float `+i+`(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(`+u+", "+s+", "+a+`, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+v+".0, "+g+`.0);
        return sampleTexture(`+o+`, uv);
      }
    `;if(v===a&&m==null)return`
      float `+i+`(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(`+r[1]*r[2]*r[3]+`,
               `+r[2]*r[3]+", "+r[3]+`, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+v+".0, "+g+`.0);
        return sampleTexture(`+o+`, uv);
      }
    `;var y=Ui(o);return`
    float `+i+`(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+c+" + col * "+u+" + depth * "+s+` +
          depth2 * `+a+" + depth3 + "+y+`;
      vec2 uv = uvFromFlat(`+g+", "+v+`, index);
      return sampleTexture(`+o+`, uv);
    }
  `}(t);case 6:return function(n){var r=n.shapeInfo.logicalShape,o=n.name,i="get"+o.charAt(0).toUpperCase()+o.slice(1),a=qi(r),s=a.newShape,u=a.keptDims;if(s.length<r.length){var c=za(n,s);return`
      `+$a(c)+`
      float `+i+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return `+i+"("+Va(["row","col","depth","depth2","depth3","depth4"],u)+`);
      }
    `}var l=r[5],d=r[4]*l,f=r[3]*d,h=r[2]*f,m=r[1]*h;if(n.shapeInfo.isUniform)return`
      float `+i+`(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(`+m+", "+h+", "+f+", "+d+`)) +
          dot(
            vec2(depth3, depth4),
            vec2(`+l+`, 1)));
        `+Ba(n)+`
      }
    `;var p=n.shapeInfo.flatOffset,g=n.shapeInfo.texShape,v=g[0],y=g[1];if(y===m&&p==null)return`
      float `+i+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(`+h+", "+f+", "+d+", "+l+`)) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+y+".0, "+v+`.0);
        return sampleTexture(`+o+`, uv);
      }
    `;if(y===l&&p==null)return`
      float `+i+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(`+r[1]*r[2]*r[3]*r[4]+`,
               `+r[2]*r[3]*r[4]+`,
               `+r[3]*r[4]+`,
               `+r[4]+`)) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+y+".0, "+v+`.0);
        return sampleTexture(`+o+`, uv);
      }
    `;var x=Ui(o);return`
    float `+i+`(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+m+" + col * "+h+" + depth * "+f+` +
          depth2 * `+d+" + depth3 * "+l+" + depth4 + "+x+`;
      vec2 uv = uvFromFlat(`+v+", "+y+`, index);
      return sampleTexture(`+o+`, uv);
    }
  `}(t);default:throw new Error(e.length+"-D input sampling is not yet supported")}}function CR(t){var e,n,r;switch(t.shapeInfo.logicalShape.length){case 0:return e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1),r=qt(),`
    vec4 `+n+`() {
      return `+r.texture2D+"("+e+`, halfCR);
    }
  `;case 1:return function(o){var i=o.name,a="get"+i.charAt(0).toUpperCase()+i.slice(1),s=o.shapeInfo.texShape,u=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)],c=qt();return`
    vec4 `+a+`(int index) {
      vec2 uv = packedUVfrom1D(
        `+u[0]+", "+u[1]+`, index);
      return `+c.texture2D+"("+i+`, uv);
    }
  `}(t);case 2:return function(o){var i=o.shapeInfo.logicalShape,a=o.name,s="get"+a.charAt(0).toUpperCase()+a.slice(1),u=o.shapeInfo.texShape,c=u[0],l=u[1],d=qt();if(u!=null&&Nt(i,u))return`
      vec4 `+s+`(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(`+l+".0, "+c+`.0);

        return `+d.texture2D+"("+a+`, uv);
      }
    `;var f=[Math.ceil(u[0]/2),Math.ceil(u[1]/2)],h=Math.ceil(i[1]/2);return`
    vec4 `+s+`(int row, int col) {
      vec2 uv = packedUVfrom2D(`+h+", "+f[0]+", "+f[1]+`, row, col);
      return `+d.texture2D+"("+a+`, uv);
    }
  `}(t);case 3:return function(o){var i=o.shapeInfo.logicalShape,a=o.name,s="get"+a.charAt(0).toUpperCase()+a.slice(1),u=o.shapeInfo.texShape,c=[Math.ceil(u[0]/2),Math.ceil(u[1]/2)];if(i[0]===1){var l=i.slice(1),d=za(o,l);return`
        `+CR(d)+`
        vec4 `+s+`(int b, int row, int col) {
          return `+s+"("+Va(["b","row","col"],[1,2])+`);
        }
      `}var f=c[0],h=c[1],m=Math.ceil(i[2]/2),p=m*Math.ceil(i[1]/2),g=qt();return`
    vec4 `+s+`(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        `+f+", "+h+", "+p+", "+m+`, b, row, col);
      return `+g.texture2D+"("+a+`, uv);
    }
  `}(t);default:return function(o){for(var i=o.shapeInfo.logicalShape,a=i.length,s=o.name,u="get"+s.charAt(0).toUpperCase()+s.slice(1),c=o.shapeInfo.texShape,l=[Math.ceil(c[0]/2),Math.ceil(c[1]/2)],d=l[0],f=l[1],h=Math.ceil(i[a-1]/2),m=h*Math.ceil(i[a-2]/2),p="int b, int row, int col",g="b * "+m+" + (row / 2) * "+h+" + (col / 2)",v=2;v<a-1;v++)p="int b"+v+", "+p,m*=i[a-v-1],g="b"+v+" * "+m+" + "+g;var y=qt();return`
    vec4 `+u+"("+p+`) {
      int index = `+g+`;
      int texR = index / `+f+`;
      int texC = index - texR * `+f+`;
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+f+", "+d+`);
      return `+y.texture2D+"("+s+`, uv);
    }
  `}(t)}}var z$=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,V$=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,H$=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,G$=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function Ui(t){return"offset"+t}function Ba(t){var e=t.name,n=le(t.shapeInfo.logicalShape);return n<2?"return "+e+";":`
    for (int i = 0; i < `+n+`; i++) {
      if (i == index) {
        return `+e+`[i];
      }
    }
  `}function Ge(t){if(t<=1)return"int";if(t===2)return"ivec2";if(t===3)return"ivec3";if(t===4)return"ivec4";if(t===5)return"ivec5";if(t===6)return"ivec6";throw Error("GPU for rank "+t+" is not yet supported")}function za(t,e){var n=JSON.parse(JSON.stringify(t));return n.shapeInfo.logicalShape=e,n}function Va(t,e){return e.map(function(n){return t[n]}).join(", ")}var K$=function(t,e,n,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,N(t.length>2,function(){return"Packed arg"+(n.charAt(0).toUpperCase()+n.slice(1))+" supports only inputs with rank above 2."});var o=t[t.length-1],i=Math.ceil(o/e);this.outputShape=t.slice(0,-1),i>1&&this.outputShape.push(i),r||this.variableNames.push("bestIndicesA");var a,s,u=this.outputShape,c=u.length,l=Ge(c),d=fn("coords",c);if(i===1){var f=Ge(s=c+1);a=`
        `+f+" sourceLocR = "+f+"("+d.join()+`, 0);
        ++`+d[c-1]+`;
        `+f+" sourceLocG = "+f+"("+d.join()+`, 0);
        ++`+d[c-2]+`;
        `+f+" sourceLocA = "+f+"("+d.join()+`, 0);
        --`+d[c-1]+`;
        `+f+" sourceLocB = "+f+"("+d.join()+`, 0);
        --`+d[c-2]+";"}else s=c,a=`
        `+l+` sourceLocR = coords;
        ++`+d[c-1]+`;
        `+l+` sourceLocG = coords;
        ++`+d[c-2]+`;
        `+l+` sourceLocA = coords;
        --`+d[c-1]+`;
        `+l+` sourceLocB = coords;
        --`+d[c-2]+";";var h=["x","y","z","w","u","v"].slice(0,s),m="."+h[s-1],p=h.map(function(k){return"int "+k}),g=fn("sourceLocR",s-1).concat("inIdx.r"),v=fn("sourceLocG",s-1).concat("inIdx.g"),y=fn("sourceLocB",s-1).concat("inIdx.b"),x=fn("sourceLocA",s-1).concat("inIdx.a"),w=n==="max"?"greaterThan":"lessThan",E=r?"":`
          inIdx = round(vec4(getBestIndicesAChannel(`+g.join()+`),
                             getBestIndicesAChannel(`+v.join()+`),
                             getBestIndicesAChannel(`+y.join()+`),
                             getBestIndicesAChannel(`+x.join()+")));",_=`vec4(
            getAChannel(`+g.join()+`),
            hasNextCol ? getAChannel(`+v.join()+`) : 0.,
            hasNextRow ? getAChannel(`+y.join()+`) : 0.,
            hasNextRow && hasNextCol ? getAChannel(`+x.join()+") : 0.)",S=r?"":`
      float getBestIndicesAChannel(`+p.join()+`) {
        return getChannel(getBestIndicesA(`+h.join()+`),
                                          vec2(`+h.slice(-2).join()+`));
      }`;this.userCode=`
      float getAChannel(`+p.join()+`) {
        return getChannel(getA(`+h.join()+`),
                               vec2(`+h.slice(-2).join()+`));
      }
      `+S+`
      void main() {
        `+l+` coords = getOutputCoords();
        bool hasNextCol = `+d[c-1]+" < "+(u[c-1]-1)+`;
        bool hasNextRow = `+d[c-2]+" < "+(u[c-2]-1)+`;
        `+a+`
        ivec4 srcIdx = ivec4(sourceLocR`+m+", sourceLocG"+m+`,
          sourceLocB`+m+", sourceLocA"+m+") * "+e+`;
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = `+_+`;

        for (int i = 0; i < `+e+`; i++) {
          inIdx = srcIdx;
          `+E+`
          vec4 candidate = `+_+`;
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(`+w+`(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `},q$=function(t){this.variableNames=["dy"],this.outputShape=t.inShape;var e=t.filterHeight,n=t.filterWidth,r=t.strideHeight,o=t.strideWidth,i=t.dilationHeight,a=t.dilationWidth,s=t.effectiveFilterHeight,u=t.effectiveFilterWidth,c=s-1-t.padInfo.top,l=u-1-t.padInfo.left,d=1/(e*n);this.userCode=`
      const ivec2 pads = ivec2(`+c+", "+l+`);
      const float avgMultiplier = float(`+d+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+s+`;
            wR += `+i+`) {
          float dyR = float(dyRCorner + wR) / `+r+`.0;

          if (dyR < 0.0 || dyR >= `+t.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < `+u+`;
            wC+= `+a+`) {
            float dyC = float(dyCCorner + wC) / `+o+`.0;

            if (dyC < 0.0 || dyC >= `+t.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `},X$=function(t){this.variableNames=["dy"],this.outputShape=t.inShape;var e=t.filterDepth,n=t.filterHeight,r=t.filterWidth,o=t.strideDepth,i=t.strideHeight,a=t.strideWidth,s=t.dilationDepth,u=t.dilationHeight,c=t.dilationWidth,l=t.effectiveFilterDepth,d=t.effectiveFilterHeight,f=t.effectiveFilterWidth,h=l-1-t.padInfo.front,m=d-1-t.padInfo.top,p=f-1-t.padInfo.left,g=1/(e*n*r);this.userCode=`
      const ivec3 pads = ivec3(`+h+", "+m+", "+p+`);
      const float avgMultiplier = float(`+g+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < `+l+`;
            wD += `+s+`) {
          float dyD = float(dyDCorner + wD) / `+o+`.0;

          if (dyD < 0.0 || dyD >= `+t.outDepth+`.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < `+d+`;
              wR += `+u+`) {
            float dyR = float(dyRCorner + wR) / `+i+`.0;

            if (dyR < 0.0 || dyR >= `+t.outHeight+`.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < `+f+`;
                wC += `+c+`) {
              float dyC = float(dyCCorner + wC) / `+a+`.0;

              if (dyC < 0.0 || dyC >= `+t.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `},Y$=function(t,e,n,r,o,i){this.outputShape=[],this.variableNames=["x","mean","variance"],Ne(t,e),Ne(t,n);var a="0.0";r!=null&&(Ne(t,r),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");var s="1.0";o!=null&&(Ne(t,o),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=t,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = `+a+`;
        float scale = `+s+`;
        float inv = scale * inversesqrt(variance + float(`+i+`));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `},Q$=function(t,e,n,r,o,i){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],Ne(t,e),Ne(t,n);var a="vec4(0.0)";r!=null&&(Ne(t,r),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");var s="vec4(1.0)";o!=null&&(Ne(t,o),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=t,this.userCode=`
      void main() {
        vec4 offset = `+a+`;
        vec4 scale = `+s+`;

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(`+i+`));

        setOutput((x - mean) * inv + offset);
      }
    `},J$="return areal * breal - aimag * bimag;",Z$="return areal * bimag + aimag * breal;",tb=function(t,e,n){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=Ne(e,n),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        `+t+`
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `},qp="return a + b;",Xp="return a - b;",nb="return a * b;",_R="return (a < 0.) ? b * a : a;",at=function(t,e,n){this.variableNames=["A","B"],this.outputShape=Ne(e,n),this.userCode=`
      float binaryOperation(float a, float b) {
        `+t+`
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `},SR=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`,ro=function(t,e,n,r){r===void 0&&(r=!1),this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=Ne(e,n);var o=this.outputShape.length,i="";if(r)if(o===0||le(this.outputShape)===1)i=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(i=`
          `+Ge(o)+` coords = getOutputCoords();
        `,o===1)i+=`
            result.y = (coords + 1) >= `+this.outputShape[0]+` ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{var a=fn("coords",o);i+=`
            bool nextRowOutOfBounds =
              (`+a[o-2]+" + 1) >= "+this.outputShape[o-2]+`;
            bool nextColOutOfBounds =
              (`+a[o-1]+" + 1) >= "+this.outputShape[o-1]+`;
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        `+t+`
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        `+i+`

        setOutput(result);
      }
    `},ez=function(){function t(e){this.variableNames=["A"],this.outputShape=e,this.userCode=`
      uniform float minVal;
      uniform float maxVal;

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}return t.prototype.getCustomSetupFunc=function(e,n){var r=this;return function(o,i){r.minLoc==null&&(r.minLoc=o.getUniformLocationNoThrow(i,"minVal"),r.maxLoc=o.getUniformLocationNoThrow(i,"maxVal")),o.gl.uniform1f(r.minLoc,e),o.gl.uniform1f(r.maxLoc,n)}},t}(),tz=function(){function t(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.userCode=`
      uniform float minVal;
      uniform float maxVal;

      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}return t.prototype.getCustomSetupFunc=function(e,n){var r=this;return function(o,i){r.minLoc==null&&(r.minLoc=o.getUniformLocationNoThrow(i,"minVal"),r.maxLoc=o.getUniformLocationNoThrow(i,"maxVal")),o.gl.uniform1f(r.minLoc,e),o.gl.uniform1f(r.maxLoc,n)}},t}(),nz=function(t){this.variableNames=["real","imag"],this.outputShape=t,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `},rz=function(t){this.outputShape=[],this.outputShape=Zs(t,1),this.variableNames=t.map(function(s,u){return"T"+u});var e=new Array(t.length-1);e[0]=t[0][1];for(var n=1;n<e.length;n++)e[n]=e[n-1]+t[n][1];var r=["if (yC < "+e[0]+") setOutput(getT0(yR, yC));"];for(n=1;n<e.length;n++){var o=e[n-1];r.push("else if (yC < "+e[n]+") setOutput(getT"+n+"(yR, yC-"+o+"));")}var i=e.length,a=e[e.length-1];r.push("else setOutput(getT"+i+"(yR, yC-"+a+"));"),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        `+r.join(`
        `)+`
      }
    `},oz=function(t,e){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=Zs(t,e);var n=this.outputShape,r=n.length,o=Ge(r),i=fn("coords",r),a=["x","y","z","w","u","v"].slice(0,r);this.variableNames=t.map(function(g,v){return"T"+v});var s=new Array(t.length-1);s[0]=t[0][e];for(var u=1;u<s.length;u++)s[u]=s[u-1]+t[u][e];var c=a[e],l=a.slice(-2),d=a.join(),f="if ("+c+" < "+s[0]+`) {
        return getChannel(
            getT0(`+d+"), vec2("+l.join()+`));
        }`;for(u=1;u<s.length;u++){var h=s[u-1];f+=`
        if (`+c+" < "+s[u]+"  && "+c+" >= "+s[u-1]+`) {
          return getChannel(
            getT`+u+"("+Vl(a,c,h)+`),
            vec2(`+Vl(l,c,h)+`));
        }`}var m=s.length,p=s[s.length-1];f+=`
        return getChannel(
          getT`+m+"("+Vl(a,c,p)+`),
          vec2(`+Vl(l,c,p)+"));",this.userCode=`
      float getValue(`+a.map(function(g){return"int "+g})+`) {
        `+f+`
      }

      void main() {
        `+o+` coords = getOutputCoords();
        vec4 result = vec4(getValue(`+i+`), 0., 0., 0.);

        `+i[r-1]+" = "+i[r-1]+` + 1;
        if (`+i[r-1]+" < "+n[r-1]+`) {
          result.g = getValue(`+i+`);
        }

        `+i[r-2]+" = "+i[r-2]+` + 1;
        if (`+i[r-2]+" < "+n[r-2]+`) {
          result.a = getValue(`+i+`);
        }

        `+i[r-1]+" = "+i[r-1]+` - 1;
        if (`+i[r-2]+" < "+n[r-2]+` &&
            `+i[r-1]+" < "+n[r-1]+`) {
          result.b = getValue(`+i+`);
        }
        setOutput(result);
      }
    `};function Vl(t,e,n){var r=t.indexOf(e);return t.map(function(o,i){return i===r?o+" - "+n:o}).join()}var iz=function(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;var e=t.strideHeight,n=t.strideWidth,r=t.padInfo.top,o=t.padInfo.left,i=t.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < `+t.batchSize+`; b++) {
          for (int yR = 0; yR < `+t.outHeight+`; yR++) {
            int xR = wR + yR * `+e+" - "+r+`;

            if (xR < 0 || xR >= `+t.inHeight+`) {
              continue;
            }

            for (int yC = 0; yC < `+t.outWidth+`; yC++) {
              int xC = wC + yC * `+n+" - "+o+`;

              if (xC < 0 || xC >= `+t.inWidth+`) {
                continue;
              }

              if (`+i+`) {
                float dyValue = getDy(b, yR, yC, d2);
                float xValue = getX(b, xR, xC, d1);
                dotProd += (xValue * dyValue);
              } else {
                float dyValue = getDy(b, d2, yR, yC);
                float xValue = getX(b, d1, xR, xC);
                dotProd += (xValue * dyValue);
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `},az=function(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;var e=t.filterHeight,n=t.filterWidth,r=t.strideHeight,o=t.strideWidth,i=t.dataFormat==="channelsLast",a=e-1-t.padInfo.top,s=n-1-t.padInfo.left,u=i?1:2,c=i?2:3,l=i?3:1;this.userCode=`
      const ivec2 pads = ivec2(`+a+", "+s+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[`+l+`];

        ivec2 dyCorner = ivec2(coords[`+u+"], coords["+c+`]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+e+`; wR++) {
          float dyR = float(dyRCorner + wR) / `+r+`.0;

          if (dyR < 0.0 || dyR >= `+t.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = `+e+` - 1 - wR;

          for (int wC = 0; wC < `+n+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+o+`.0;

            if (dyC < 0.0 || dyC >= `+t.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = `+n+` - 1 - wC;

            for (int d2 = 0; d2 < `+t.outChannels+`; d2++) {

              if (`+i+`) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `},sz=function(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;var e=t.strideDepth,n=t.strideHeight,r=t.strideWidth,o=t.padInfo.front,i=t.padInfo.top,a=t.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < `+t.batchSize+`; b++) {
          for (int yF = 0; yF < `+t.outDepth+`; yF++) {
            int xF = wF + yF * `+e+" - "+o+`;

            if (xF < 0 || xF >= `+t.inDepth+`) {
              continue;
            }

            for (int yR = 0; yR < `+t.outHeight+`; yR++) {
              int xR = wR + yR * `+n+" - "+i+`;

              if (xR < 0 || xR >= `+t.inHeight+`) {
                continue;
              }

              for (int yC = 0; yC < `+t.outWidth+`; yC++) {
                int xC = wC + yC * `+r+" - "+a+`;

                if (xC < 0 || xC >= `+t.inWidth+`) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},uz=function(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;var e=t.filterDepth,n=t.filterHeight,r=t.filterWidth,o=t.strideDepth,i=t.strideHeight,a=t.strideWidth,s=e-1-t.padInfo.front,u=n-1-t.padInfo.top,c=r-1-t.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(`+s+", "+u+", "+c+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < `+e+`; wF++) {
          float dyF = float(dyFCorner + wF) / `+o+`.0;

          if (dyF < 0.0 || dyF >= `+t.outDepth+`.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = `+e+` - 1 - wF;

          for (int wR = 0; wR < `+n+`; wR++) {
            float dyR = float(dyRCorner + wR) / `+i+`.0;

            if (dyR < 0.0 || dyR >= `+t.outHeight+`.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = `+n+` - 1 - wR;

            for (int wC = 0; wC < `+r+`; wC++) {
              float dyC = float(dyCCorner + wC) / `+a+`.0;

              if (dyC < 0.0 || dyC >= `+t.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = `+r+` - 1 - wC;

              for (int d2 = 0; d2 < `+t.outChannels+`; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},cz=function(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;var e=t.strideHeight,n=t.strideWidth,r=t.padInfo.top,o=t.padInfo.left,i=t.outChannels/t.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * `+i+` + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < `+t.batchSize+`; b++) {
          for (int yR = 0; yR < `+t.outHeight+`; yR++) {
            int xR = wR + yR * `+e+" - "+r+`;

            if (xR < 0 || xR >= `+t.inHeight+`) {
              continue;
            }

            for (int yC = 0; yC < `+t.outWidth+`; yC++) {
              int xC = wC + yC * `+n+" - "+o+`;

              if (xC < 0 || xC >= `+t.inWidth+`) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `},lz=function(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;var e=t.filterHeight,n=t.filterWidth,r=t.strideHeight,o=t.strideWidth,i=e-1-t.padInfo.top,a=n-1-t.padInfo.left,s=t.outChannels/t.inChannels;this.userCode=`
      const ivec2 pads = ivec2(`+i+", "+a+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < `+e+`; wR++) {
          float dyR = float(dyRCorner + wR) / `+r+`.0;

          if (dyR < 0.0 || dyR >= `+t.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = `+e+` - 1 - wR;

          for (int wC = 0; wC < `+n+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+o+`.0;

            if (dyC < 0.0 || dyC >= `+t.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = `+n+` - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < `+s+`; dm++) {
              int d2 = d1 * `+s+` + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `},rb=function(t,e,n,r){e===void 0&&(e=!1),n===void 0&&(n=null),r===void 0&&(r=!1),this.variableNames=["x","W"],this.outputShape=t.outShape;var o=t.padInfo.top,i=t.padInfo.left,a=t.strideHeight,s=t.strideWidth,u=t.dilationHeight,c=t.dilationWidth,l=t.filterHeight,d=t.filterWidth,f=4*Math.floor(t.inChannels/4),h=t.inChannels%4,m=t.dataFormat==="channelsLast",p=m?1:2,g=m?2:3,v=m?3:1,y="",x="";n&&(y=r?`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          `+n+`
        }`:`
          float activation(float x) {
            `+n+`
          }
        `,x="result = activation(result);");var w=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+y+`

      const ivec2 strides = ivec2(`+a+", "+s+`);
      const ivec2 pads = ivec2(`+o+", "+i+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[`+v+`];

        ivec2 xRCCorner =
            ivec2(coords[`+p+"], coords["+g+`]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+l+`; wR++) {
          int xR = xRCorner + wR * `+u+`;

          if (xR < 0 || xR >= `+t.inHeight+`) {
            continue;
          }

          for (int wC = 0; wC < `+d+`; wC++) {
            int xC = xCCorner + wC * `+c+`;

            if (xC < 0 || xC >= `+t.inWidth+`) {
              continue;
            }

            for (int d1 = 0; d1 < `+f+`; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (`+m+`) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (`+(h===1)+`) {

              if (`+m+`) {
                dotProd +=
                    getX(batch, xR, xC, `+f+`) *
                    getW(wR, wC, `+f+`, d2);
              } else {
                dotProd +=
                    getX(batch, `+f+`, xR, xC) *
                    getW(wR, wC, `+f+`, d2);
              }

            } else if (`+(h===2)+`) {
              vec2 wValues = vec2(
                getW(wR, wC, `+f+`, d2),
                getW(wR, wC, `+f+` + 1, d2)
              );

              if (`+m+`) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, `+f+`),
                  getX(batch, xR, xC, `+f+` + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, `+f+`, xR, xC),
                  getX(batch, `+f+` + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (`+(h===3)+`) {
              vec3 wValues = vec3(
                getW(wR, wC, `+f+`, d2),
                getW(wR, wC, `+f+` + 1, d2),
                getW(wR, wC, `+f+` + 2, d2)
              );

              if (`+m+`) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, `+f+`),
                  getX(batch, xR, xC, `+f+` + 1),
                  getX(batch, xR, xC, `+f+` + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, `+f+`, xR, xC),
                  getX(batch, `+f+` + 1, xR, xC),
                  getX(batch, `+f+` + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        `+w+`
        `+x+`
        setOutput(result);
      }
    `},dz=function(t){this.variableNames=["x","W"],this.outputShape=t.outShape;var e=t.padInfo.front,n=t.padInfo.top,r=t.padInfo.left,o=t.strideDepth,i=t.strideHeight,a=t.strideWidth,s=t.dilationDepth,u=t.dilationHeight,c=t.dilationWidth,l=t.filterDepth,d=t.filterHeight,f=t.filterWidth,h=4*Math.floor(t.inChannels/4),m=t.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(`+o+", "+i+", "+a+`);
      const ivec3 pads = ivec3(`+e+", "+n+", "+r+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < `+l+`; wF++) {
          int xF = xFCorner + wF * `+s+`;

          if (xF < 0 || xF >= `+t.inDepth+`) {
            continue;
          }

          for (int wR = 0; wR < `+d+`; wR++) {
            int xR = xRCorner + wR * `+u+`;

            if (xR < 0 || xR >= `+t.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+f+`; wC++) {
              int xC = xCCorner + wC * `+c+`;

              if (xC < 0 || xC >= `+t.inWidth+`) {
                continue;
              }

              for (int d1 = 0; d1 < `+h+`; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (`+(m===1)+`) {
                dotProd +=
                  getX(batch, xF, xR, xC, `+h+`) *
                  getW(wF, wR, wC, `+h+`, d2);
              } else if (`+(m===2)+`) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, `+h+`),
                  getX(batch, xF, xR, xC, `+h+` + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, `+h+`, d2),
                  getW(wF, wR, wC, `+h+` + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (`+(m===3)+`) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, `+h+`),
                  getX(batch, xF, xR, xC, `+h+` + 1),
                  getX(batch, xF, xR, xC, `+h+` + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, `+h+`, d2),
                  getW(wF, wR, wC, `+h+` + 1, d2),
                  getW(wF, wR, wC, `+h+` + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},ob=function(t,e,n,r){e===void 0&&(e=!1),n===void 0&&(n=null),r===void 0&&(r=!1),this.variableNames=["x","W"],this.outputShape=t.outShape;var o=t.inHeight,i=t.inWidth,a=t.padInfo.top,s=t.padInfo.left,u=t.strideHeight,c=t.strideWidth,l=t.dilationHeight,d=t.dilationWidth,f=t.filterHeight,h=t.filterWidth,m=t.outChannels/t.inChannels,p="",g="";n&&(p=r?`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          `+n+`
        }`:`
          float activation(float x) {
            `+n+`
          }
        `,g="result = activation(result);");var v=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+p+`

      const ivec2 strides = ivec2(`+u+", "+c+`);
      const ivec2 pads = ivec2(`+a+", "+s+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / `+m+`;
        int q = d2 - d1 * `+m+`;

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < `+f+`; wR++) {
          int xR = xRCorner + wR * `+l+`;

          if (xR < 0 || xR >= `+o+`) {
            continue;
          }

          for (int wC = 0; wC < `+h+`; wC++) {
            int xC = xCCorner + wC * `+d+`;

            if (xC < 0 || xC >= `+i+`) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        `+v+`
        `+g+`
        setOutput(result);
      }
    `},ib=function(t,e,n,r){e===void 0&&(e=!1),n===void 0&&(n=null),r===void 0&&(r=!1),this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.outShape;for(var o=t.inHeight,i=t.inWidth,a=t.padInfo.top,s=t.padInfo.left,u=t.strideHeight,c=t.strideWidth,l=t.dilationHeight,d=t.dilationWidth,f=t.filterHeight,h=t.filterWidth,m=h,p="int xR; int xC; int xCOffset;",g=0;g<f;g++)for(var v=0;v<h;v++)p+=`
          vec4 xTexelR`+g+"C"+2*v+` = vec4(0.);
          vec4 wR`+g+"C"+v+` = vec4(0.);
          vec4 xR`+g+"C"+v+" = vec4(0.);";for(g=0;g<f;g++)for(var y=0;y<m;y++){if(p+=`
          xR = xRCorner + `+g*l+`;
          xC = xCCorner + `+(v=2*y)*d+`;
        `,c===1){if(v<h&&(p+=s%2==1?`
                xCOffset = xC + 1;
                if(xR >= 0 && xR < `+o+" && xCOffset >= 0 && xCOffset < "+i+`) {
                  xTexelR`+g+"C"+v+` = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if(xCOffset + 1 >= `+i+`) {
                    xTexelR`+g+"C"+v+`.zw = vec2(0.);
                  }
                } else {
                  xTexelR`+g+"C"+v+` = vec4(0.);
                }

                xCOffset = xC + 1 - 2;
                if(xR >= 0 && xR < `+o+" && xCOffset >= 0 && xCOffset < "+i+`) {
                  vec4 previous = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if(xCOffset + 1 >= `+i+`) {
                    previous.zw = vec2(0.);
                  }

                  xR`+g+"C"+v+" = vec4(previous.zw, xTexelR"+g+"C"+v+`.xy);
                } else {
                  xR`+g+"C"+v+" = vec4(0, 0, xTexelR"+g+"C"+v+`.xy);
                }
              `:`
                if(xR >= 0 && xR < `+o+" && xC >= 0 && xC < "+i+`) {
                  xTexelR`+g+"C"+v+` = getX(batch, xR, xC, d1);
                } else {
                  xTexelR`+g+"C"+v+` = vec4(0.);
                }

                xR`+g+"C"+v+" = xTexelR"+g+"C"+v+`;
              `,v+1<h)){var x=s%2==0?zI(d):d;d%2==0&&s%2==1||d%2!=0&&s%2!=1?(p+=`
                  xCOffset = xC + `+s%2+" + "+x+`;

                  if(xR >= 0 && xR < `+o+` &&
                    xCOffset >= 0 && xCOffset < `+i+`) {
                    xTexelR`+g+"C"+(v+2)+` = getX(batch, xR, xCOffset, d1);
                  }
                `,d>1&&(p+=`
                    xCOffset -= 2;
                    if(xR >= 0 && xR < `+o+` &&
                      xCOffset >= 0 && xCOffset < `+i+`) {
                      xTexelR`+g+"C"+v+` = getX(batch, xR, xCOffset, d1);
                    } else {
                      xTexelR`+g+"C"+v+` = vec4(0.);
                    }
                  `),p+=`
                  xR`+g+"C"+(v+1)+` = vec4(
                    xTexelR`+g+"C"+v+".zw, xTexelR"+g+"C"+(v+2)+`.xy);
                `):p+=`
                  xCOffset = xC + `+x+`;

                  if(xR >= 0 && xR < `+o+` &&
                    xCOffset >= 0 && xCOffset < `+i+`) {
                    xTexelR`+g+"C"+(v+2)+` = getX(batch, xR, xCOffset, d1);
                  }

                  xR`+g+"C"+(v+1)+" = xTexelR"+g+"C"+(v+2)+`;
                `}}else v<h&&(p+=`
              if(xR >= 0 && xR < `+o+`) {
            `,s%2==1?(p+=`
                xCOffset = xC + 1 - `+c+`;
                if(xCOffset >= 0 && xCOffset < `+i+`) {
                  xTexelR`+g+"C"+v+` = getX(batch, xR, xCOffset, d1);
                } else {
                  xTexelR`+g+"C"+v+` = vec4(0.);
                }

                if(xC + 1 >= 0 && xC + 1 < `+i+`) {
                  xTexelR`+g+"C"+(v+2)+` = getX(batch, xR, xC + 1, d1);
                } else {
                  xTexelR`+g+"C"+(v+2)+` = vec4(0.);
                }

                xR`+g+"C"+v+` = vec4(
                  xTexelR`+g+"C"+v+".zw, xTexelR"+g+"C"+(v+2)+`.zw);
              `,v+1<h&&(p+=`
                  vec4 final = vec4(0.);
                  xCOffset = xC + 1 + `+c+`;
                  if(xCOffset >= 0 && xCOffset < `+i+`) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xR`+g+"C"+(v+1)+" = vec4(xTexelR"+g+"C"+(v+2)+`.xy, final.xy);
                `)):(p+=`
                if(xC >= 0 && xC < `+i+`) {
                  xTexelR`+g+"C"+v+` = getX(batch, xR, xC, d1);
                } else {
                  xTexelR`+g+"C"+v+` = vec4(0.);
                }

                xCOffset = xC + `+c+`;
                if(xCOffset >= 0 && xCOffset < `+i+`) {
                  xTexelR`+g+"C"+(v+2)+` = getX(batch, xR, xCOffset, d1);
                } else {
                  xTexelR`+g+"C"+(v+2)+` = vec4(0.);
                }

                xR`+g+"C"+v+` = vec4(
                  xTexelR`+g+"C"+v+".xy, xTexelR"+g+"C"+(v+2)+`.xy);
              `,v+1<h&&(p+=`
                  xR`+g+"C"+(v+1)+` = vec4(
                    xTexelR`+g+"C"+v+".zw, xTexelR"+g+"C"+(v+2)+`.zw);
                `)),p+="}");v<h&&(p+=`
            vec4 wTexelR`+g+"C"+v+" = getW("+g+", "+v+`, d1, q);
            wR`+g+"C"+v+" = vec4(wTexelR"+g+"C"+v+".xz, wTexelR"+g+"C"+v+`.xz);
          `,v+1<h&&(p+=`
              vec4 wTexelR`+g+"C"+(v+1)+" = getW("+g+", "+(v+1)+`, d1, q);
              wR`+g+"C"+(v+1)+` =
                vec4(wTexelR`+g+"C"+(v+1)+".xz, wTexelR"+g+"C"+(v+1)+".xz);"))}for(g=0;g<f;g++)for(v=0;v<h;v++)p+="dotProd += xR"+g+"C"+v+" * wR"+g+"C"+v+";";var w="",E="";n&&(w=r?`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          `+n+`
        }`:`vec4 activation(vec4 x) {
          `+n+`
        }`,E="result = activation(result);");var _=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+w+`

      const ivec2 strides = ivec2(`+u+", "+c+`);
      const ivec2 pads = ivec2(`+a+", "+s+`);

      void main() {

        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2;
        int q = 0;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        vec4 dotProd = vec4(0.);

        `+p+`

        vec4 result = dotProd;
        `+_+`
        `+E+`
        setOutput(result);
      }
    `},fz=function(t,e,n,r,o){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];var i=t[0],a=t[1],s=t[2],u=t[3],c=e[0],l=n[0],d=n[1];this.outputShape=[c,l,d,u];var f=r==="bilinear"?1:0,h=[a-1+".0",s-1+".0"],m=h[0],p=h[1],g=l>1?[""+(a-1)/(l-1),"(y2-y1) * height_ratio","y1*"+m+" + float(y)*(height_scale)"]:["0.0","0.0","0.5 * (y1+y2) * "+m],v=g[0],y=g[1],x=g[2],w=d>1?[""+(s-1)/(d-1),"(x2-x1) * width_ratio","x1*"+p+" + float(x)*(width_scale)"]:["0.0","0.0","0.5 * (x1+x2) * "+p],E=w[0],_=w[1],S=w[2];this.userCode=`
      const float height_ratio = float(`+v+`);
      const float width_ratio = float(`+E+`);
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= `+i+`) {
          return;
        }

        float height_scale = `+y+`;
        float width_scale = `+_+`;

        float in_y = `+x+`;
        if( in_y < 0.0 || in_y > `+m+` ) {
          setOutput(float(`+o+`));
          return;
        }
        float in_x = `+S+`;
        if( in_x < 0.0 || in_x > `+p+` ) {
          setOutput(float(`+o+`));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(`+f+` == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `},hz=function(t,e,n){this.variableNames=["x"],this.outputShape=t;var r=t.length,o=t[t.length-1],i=n?"<":">";this.userCode=`
      int getIndex(int i) {
        `+(n?"return "+o+" -i - 1;":"return i;")+`
      }

      void main() {
        `+Ge(r)+` coords = getOutputCoords();
        int end = `+ab(r,"coords")+`;
        float val = 0.0;
        for (int i = `+o+` - 1; i >= 0; i -= 1) {
          int idx = getIndex(i);
          if (idx `+i+` end) {
            continue;
          }
          if (idx == end && `+e+`) {
            continue;
          }
          `+ab(r,"coords")+` = idx;
          val += getX(`+function(a,s){if(a===1)return""+s;if(a===2)return s+".x, "+s+".y";if(a===3)return s+".x, "+s+".y, "+s+".z";if(a===4)return s+".x, "+s+".y, "+s+".z, "+s+".w";throw Error("Cumulative sum for rank "+a+" is not yet supported")}(r,"coords")+`);
        }
        setOutput(val);
      }
    `};function ab(t,e){if(t===1)return""+e;if(t===2)return e+".y";if(t===3)return e+".z";if(t===4)return e+".w";throw Error("Cumulative sum for rank "+t+" is not yet supported")}var pz=function(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=Sc.DENSE;var e=Hu(t),n=qt();this.outputShape=t,this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        `+Ji(["r","c","d"],t)+`
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx *
          vec2(`+e[0]+", "+e[1]+`));
        int index = 4 * (resTexRC.x * `+e[1]+` + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        `+n.output+` = result;
      }
    `},mz=function(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=Sc.DENSE;var e=Hu(t),n=qt();this.outputShape=t,this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        `+Ji(["r","c","d"],t)+`
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx *
          vec2(`+e[0]+", "+e[1]+`));
        int index = 4 * (resTexRC.x * `+e[1]+` + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        `+n.output+` = result;
      }
    `},vz=function(){function t(e,n,r){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=n,this.dataFormat=r,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = `+this.getHeightCoordString()+`;
      int w = `+this.getWidthCoordString()+`;
      int d = `+this.getDepthCoordString()+`;

      int in_h = h / `+n+`;
      int offset_h = imod(h, `+n+`);
      int in_w = w / `+n+`;
      int offset_w = imod(w, `+n+`);
      int offset_d = (offset_h * `+n+` + offset_w) *
        `+this.getOutputDepthSize()+`;
      int in_d = d + offset_d;

      float result = `+this.getInputSamplingString()+`;
      setOutput(result);
    }
  `}return t.prototype.getHeightCoordString=function(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"},t.prototype.getWidthCoordString=function(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"},t.prototype.getDepthCoordString=function(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"},t.prototype.getOutputDepthSize=function(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]},t.prototype.getInputSamplingString=function(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"},t}(),gz=function(t){this.variableNames=["X"],this.outputShape=[t,t],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `},yz=function(t){this.variableNames=["A"],this.outTexUsage=In.DOWNLOAD;var e=qt();this.outputShape=t,this.userCode=`
      `+ER+`

      void main() {
        float x = getAAtOutCoords();
        `+e.output+` = encode_float(x);
      }
    `},xz=function(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=In.DOWNLOAD;var e=qt();this.outputShape=t,this.userCode=`
      `+ER+`

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        `+e.output+` = encode_float(x);
      }
    `},wz=function(t,e,n){n===void 0&&(n=!1),this.variableNames=["A"];var r=qt(),o=e[0],i=e[1];this.outputShape=t;var a="result";n&&(a="floor(result * 255. + 0.5)"),this.userCode=`
      `+e0(t)+`

      void main() {
        ivec3 coords = getOutputCoords();

        int flatIndex = getFlatIndex(coords);
        int offset = imod(flatIndex, 4);

        flatIndex = idiv(flatIndex, 4, 1.);
        
        int r = flatIndex / `+i+`;
        int c = imod(flatIndex, `+i+`);
        vec2 uv = (vec2(c, r) + halfCR) / vec2(`+i+".0, "+o+`.0);
        vec4 values = `+r.texture2D+`(A, uv);

        float result;

        if(offset == 0) {
          result = values[0];
        } else if(offset == 1) {
          result = values[1];
        } else if(offset == 2) {
          result = values[2];
        } else {
          result = values[3];
        }

        `+r.output+" = vec4("+a+`, 0., 0., 0.);
      }
    `},bz=function(t,e,n){n===void 0&&(n=!1),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var r=qt(),o=e[0],i=e[1];this.outputShape=t;var a="",s="result";n&&(s="floor(result * 255. + 0.5)");for(var u=0;u<=1;u++)for(var c=0;c<=1;c++){var l=2*u+c;a+=`
          localCoords = coords;
          if(localCoords[2] + `+c+" < "+t[2]+`) {
            localCoords[2] += `+c+`;
            if(localCoords[1] + `+u+" < "+t[1]+`) {
              localCoords[1] += `+u+`;

              flatIndex = getFlatIndex(localCoords);
              offset = imod(flatIndex, 4);

              flatIndex = idiv(flatIndex, 4, 1.);

              r = flatIndex / `+i+`;
              c = imod(flatIndex, `+i+`);
              uv = (vec2(c, r) + halfCR) / vec2(`+i+".0, "+o+`.0);
              values = `+r.texture2D+`(A, uv);

              if(offset == 0) {
                result[`+l+`] = values[0];
              } else if(offset == 1) {
                result[`+l+`] = values[1];
              } else if(offset == 2) {
                result[`+l+`] = values[2];
              } else {
                result[`+l+`] = values[3];
              }
            }
          }
        `}this.userCode=`
      `+e0(t)+`

      void main() {
        ivec3 coords = getOutputCoords();

        vec4 result = vec4(0.);
        int flatIndex, r, c, offset;
        ivec3 localCoords;
        vec2 uv;
        vec4 values;

        `+a+`

        `+r.output+" = "+s+`;
      }
    `},Ez="return real * expR - imag * expI;",Cz="return real * expI + imag * expR;",sb=function(t,e,n){this.variableNames=["real","imag"];var r=e[1];this.outputShape=e;var o=n?"2.0 * "+Math.PI:"-2.0 * "+Math.PI,i=n?r+".0":"1.0";this.userCode=`
      const float exponentMultiplier = `+o+`;

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        `+t+`
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(`+r+`);
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < `+r+`; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / `+i+`;
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `},_z=function(){function t(e,n){this.outputShape=[],this.variableNames=["x"],this.outputShape=e,this.userCode=`
      uniform float value;
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}return t.prototype.getCustomSetupFunc=function(e){var n=this;return function(r,o){n.valueLoc==null&&(n.valueLoc=r.getUniformLocationNoThrow(o,"value")),r.gl.uniform1f(n.valueLoc,e)}},t}(),Sz=function(t,e,n){this.variableNames=["A","indices"];var r=t.slice();r[n]=e,this.outputShape=r,this.rank=r.length;var o=Ge(this.rank),i=function(a,s){var u=a.length;if(u>4)throw Error("Gather for rank "+u+" is not yet supported");if(u===1)return"int(getIndices(resRC))";for(var c=["resRC.x","resRC.y","resRC.z","resRC.w"],l=[],d=0;d<a.length;d++)d===s?l.push("int(getIndices("+c[d]+"))"):l.push(""+c[d]);return l.join()}(t,n);this.userCode=`
      void main() {
        `+o+` resRC = getOutputCoords();
        setOutput(getA(`+i+`));
      }
    `},kz=function(t,e,n){this.sliceDim=t,this.strides=e,this.variableNames=["x","indices"],this.outputShape=n;var r=Ge(e.length),o=Ge(n.length),i=this.sliceDim>1?"strides[j]":"strides";this.userCode=`
        `+r+" strides = "+r+"("+this.strides+`);
         void main() {
          `+o+` coords = getOutputCoords();
          int flattenIndex = 0;
          for (int j = 0; j < `+this.sliceDim+`; j++) {
            int index = round(getIndices(coords[0], j));
            flattenIndex += index * `+i+`;
          }
          setOutput(getX(flattenIndex, coords[1]));
        }
      `};function Iz(t,e){var n=qt();return EW(t,e,n.version+`
    precision highp float;
    `+n.attribute+` vec3 clipSpacePos;
    `+n.attribute+` vec2 uv;
    `+n.varyingVs+` vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`)}function Rz(t,e){return IW(t,e,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function Tz(t,e){return RW(t,e,new Uint16Array([0,1,2,2,1,3]))}function nl(t,e,n,r,o,i,a){NW(n,r);var s=TW(t,e),u=t.TEXTURE_2D;return de(t,e,function(){return t.bindTexture(u,s)}),de(t,e,function(){return t.texParameteri(u,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE)}),de(t,e,function(){return t.texParameteri(u,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)}),de(t,e,function(){return t.texParameteri(u,t.TEXTURE_MIN_FILTER,t.NEAREST)}),de(t,e,function(){return t.texParameteri(u,t.TEXTURE_MAG_FILTER,t.NEAREST)}),de(t,e,function(){return t.texImage2D(u,0,o,n,r,0,i,a,null)}),de(t,e,function(){return t.bindTexture(t.TEXTURE_2D,null)}),s}function Nz(t,e,n,r,o){var i=Ch(n,r);return nl(t,e,i[0],i[1],o.internalFormatFloat,o.textureFormatFloat,t.FLOAT)}function Az(t,e,n,r,o){var i=Ch(n,r);return nl(t,e,i[0],i[1],o.internalFormatHalfFloat,o.textureFormatFloat,o.textureTypeHalfFloat)}function Pz(t,e,n,r,o){var i=Ch(n,r);return nl(t,e,i[0],i[1],t.RGBA,t.RGBA,t.UNSIGNED_BYTE)}function Dz(t,e,n,r,o){var i=tl(n,r);return nl(t,e,i[0],i[1],o.internalFormatPackedFloat,t.RGBA,t.FLOAT)}function Mz(t,e,n,r,o){var i=tl(n,r);return nl(t,e,i[0],i[1],o.internalFormatPackedHalfFloat,t.RGBA,o.textureTypeHalfFloat)}function Oz(t,e,n,r){return de(t,e,function(){return t.bindBuffer(t.ARRAY_BUFFER,r)}),qw(t,e,n,"clipSpacePos",r,3,20,0)&&qw(t,e,n,"uv",r,2,20,12)}function Fz(t,e,n,r,o,i,a){var s,u,c;de(t,e,function(){return t.bindTexture(t.TEXTURE_2D,n)}),i instanceof Uint8Array?(s=new Uint8Array(r*o*4),u=t.UNSIGNED_BYTE,c=t.RGBA):(s=new Float32Array(r*o*4),u=t.FLOAT,c=a.internalFormatPackedFloat),s.set(i),de(t,e,function(){return t.texImage2D(t.TEXTURE_2D,0,c,r,o,0,t.RGBA,u,s)}),de(t,e,function(){return t.bindTexture(t.TEXTURE_2D,null)})}function Lz(t,e,n,r){de(t,e,function(){return t.bindTexture(t.TEXTURE_2D,n)}),r.data instanceof Uint8Array?de(t,e,function(){return t.texImage2D(t.TEXTURE_2D,0,t.RGBA,r.width,r.height,0,t.RGBA,t.UNSIGNED_BYTE,r.data)}):de(t,e,function(){return t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,r)}),de(t,e,function(){return t.bindTexture(t.TEXTURE_2D,null)})}function Bz(t,e,n,r,o){var i=t.createBuffer();de(t,e,function(){return t.bindBuffer(t.PIXEL_PACK_BUFFER,i)});var a=16*n*r;return de(t,e,function(){return t.bufferData(t.PIXEL_PACK_BUFFER,a,t.STREAM_READ)}),de(t,e,function(){return t.readPixels(0,0,r,n,t.RGBA,t.FLOAT,0)}),de(t,e,function(){return t.bindBuffer(t.PIXEL_PACK_BUFFER,null)}),i}function jz(t,e,n){var r=t,o=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,e),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,o),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),o}function Uz(t,e,n,r,o){var i=Ch(n,r),a=i[0],s=i[1],u=new Uint8Array(n*r*4);return de(t,e,function(){return t.readPixels(0,0,a,s,o.downloadTextureFormat,t.UNSIGNED_BYTE,u)}),new Float32Array(u.buffer)}function Wz(t,e,n,r,o,i,a,s){var u=t,c=new Float32Array(function(l,d){var f=tl(l,d);return f[0]*f[1]*4}(i,a));return u.bindBuffer(u.PIXEL_PACK_BUFFER,e),u.getBufferSubData(u.PIXEL_PACK_BUFFER,0,c),u.bindBuffer(u.PIXEL_PACK_BUFFER,null),c}function $z(t,e,n,r){var o=new Float32Array(n*r*4);return de(t,e,function(){return t.readPixels(0,0,r,n,t.RGBA,t.FLOAT,o)}),o}var zz=function(){function t(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];var n=K().getNumber("WEBGL_VERSION");e!=null?(this.gl=e,gW(n,e)):this.gl=Yr(n);var r="WEBGL_color_buffer_float";if(K().getNumber("WEBGL_VERSION")===1){if(this.textureFloatExtension=Ul(this.gl,this.debug,"OES_texture_float"),Vn(this.gl,"OES_texture_half_float"))this.textureHalfFloatExtension=Ul(this.gl,this.debug,"OES_texture_half_float");else if(K().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(r),Vn(this.gl,"EXT_color_buffer_half_float"))this.colorBufferHalfFloatExtension=Ul(this.gl,this.debug,"EXT_color_buffer_half_float");else if(K().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(r="EXT_color_buffer_float",Vn(this.gl,r))this.colorBufferFloatExtension=this.gl.getExtension(r);else{if(!Vn(this.gl,"EXT_color_buffer_half_float"))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension("EXT_color_buffer_half_float")}this.vertexBuffer=Rz(this.gl,this.debug),this.indexBuffer=Tz(this.gl,this.debug),this.framebuffer=AW(this.gl,this.debug),this.textureConfig=Vy(this.gl,this.textureHalfFloatExtension)}return Object.defineProperty(t.prototype,"debug",{get:function(){return K().getBool("DEBUG")},enumerable:!0,configurable:!0}),t.prototype.dispose=function(){var e=this;if(!this.disposed){this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");var n=this.gl;de(n,this.debug,function(){return n.finish()}),de(n,this.debug,function(){return n.bindFramebuffer(n.FRAMEBUFFER,null)}),de(n,this.debug,function(){return n.deleteFramebuffer(e.framebuffer)}),de(n,this.debug,function(){return n.bindBuffer(n.ARRAY_BUFFER,null)}),de(n,this.debug,function(){return n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,null)}),de(n,this.debug,function(){return n.deleteBuffer(e.indexBuffer)}),this.disposed=!0}},t.prototype.createFloat32MatrixTexture=function(e,n){return this.throwIfDisposed(),Nz(this.gl,this.debug,e,n,this.textureConfig)},t.prototype.createFloat16MatrixTexture=function(e,n){return this.throwIfDisposed(),Az(this.gl,this.debug,e,n,this.textureConfig)},t.prototype.createUnsignedBytesMatrixTexture=function(e,n){return this.throwIfDisposed(),Pz(this.gl,this.debug,e,n,this.textureConfig)},t.prototype.uploadPixelDataToTexture=function(e,n){this.throwIfDisposed(),Lz(this.gl,this.debug,e,n)},t.prototype.uploadDenseMatrixToTexture=function(e,n,r,o){this.throwIfDisposed(),Fz(this.gl,this.debug,e,n,r,o,this.textureConfig)},t.prototype.createFloat16PackedMatrixTexture=function(e,n){return this.throwIfDisposed(),Mz(this.gl,this.debug,e,n,this.textureConfig)},t.prototype.createPackedMatrixTexture=function(e,n){return this.throwIfDisposed(),Dz(this.gl,this.debug,e,n,this.textureConfig)},t.prototype.deleteMatrixTexture=function(e){var n=this;this.throwIfDisposed(),this.outputTexture===e&&(Xw(this.gl,this.debug,this.framebuffer),this.outputTexture=null),de(this.gl,this.debug,function(){return n.gl.deleteTexture(e)})},t.prototype.downloadByteEncodedFloatMatrixFromOutputTexture=function(e,n,r){var o=this;return this.downloadMatrixDriver(e,function(){return Uz(o.gl,o.debug,n,r,o.textureConfig)})},t.prototype.downloadPackedMatrixFromBuffer=function(e,n,r,o,i,a){return Wz(this.gl,e,0,0,0,i,a,this.textureConfig)},t.prototype.downloadFloat32MatrixFromBuffer=function(e,n){return jz(this.gl,e,n)},t.prototype.createBufferFromTexture=function(e,n,r){this.bindTextureToFrameBuffer(e);var o=Bz(this.gl,this.debug,n,r,this.textureConfig);return this.unbindTextureToFrameBuffer(),o},t.prototype.createAndWaitForFence=function(){var e=this.createFence(this.gl);return this.pollFence(e)},t.prototype.createFence=function(e){var n,r,o=this;if(K().getBool("WEBGL_FENCE_API_ENABLED")){var i=e,a=i.fenceSync(i.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),r=function(){var s=i.clientWaitSync(a,0,0);return s===i.ALREADY_SIGNALED||s===i.CONDITION_SATISFIED},n=a}else K().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(n=this.beginQuery(),this.endQuery(),r=function(){return o.isQueryAvailable(n,K().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}):r=function(){return!0};return{query:n,isFencePassed:r}},t.prototype.downloadMatrixFromPackedTexture=function(e,n,r){var o=this;return this.downloadMatrixDriver(e,function(){return $z(o.gl,o.debug,n,r)})},t.prototype.createProgram=function(e){this.throwIfDisposed();var n=this.gl,r=CW(n,this.debug,e),o=Iz(n,this.debug),i=SW(n,this.debug);return de(n,this.debug,function(){return n.attachShader(i,o)}),de(n,this.debug,function(){return n.attachShader(i,r)}),kW(n,this.debug,i),this.debug&&Vp(n,this.debug,i),this.vertexAttrsAreBound||(this.setProgram(i),this.vertexAttrsAreBound=Oz(n,this.debug,this.program,this.vertexBuffer)),i},t.prototype.deleteProgram=function(e){var n=this;this.throwIfDisposed(),e===this.program&&(this.program=null),e!=null&&de(this.gl,this.debug,function(){return n.gl.deleteProgram(e)})},t.prototype.setProgram=function(e){var n=this;this.throwIfDisposed(),this.program=e,this.program!=null&&this.debug&&Vp(this.gl,this.debug,this.program),de(this.gl,this.debug,function(){return n.gl.useProgram(e)})},t.prototype.getUniformLocation=function(e,n,r){return r===void 0&&(r=!0),this.throwIfDisposed(),r?DW(this.gl,this.debug,e,n):MW(this.gl,e,n)},t.prototype.getAttributeLocation=function(e,n){var r=this;return this.throwIfDisposed(),de(this.gl,this.debug,function(){return r.gl.getAttribLocation(e,n)})},t.prototype.getUniformLocationNoThrow=function(e,n){return this.throwIfDisposed(),this.gl.getUniformLocation(e,n)},t.prototype.setInputMatrixTexture=function(e,n,r){this.throwIfDisposed(),this.throwIfNoProgram(),OW(this.gl,this.debug,this.program,e,n,r)},t.prototype.setOutputMatrixTexture=function(e,n,r){this.setOutputMatrixTextureDriver(e,r,n)},t.prototype.setOutputPackedMatrixTexture=function(e,n,r){this.throwIfDisposed();var o=tl(n,r),i=o[0],a=o[1];this.setOutputMatrixTextureDriver(e,i,a)},t.prototype.setOutputMatrixWriteRegion=function(e,n,r,o){this.setOutputMatrixWriteRegionDriver(r,e,o,n)},t.prototype.setOutputPackedMatrixWriteRegion=function(e,n,r,o){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")},t.prototype.debugValidate=function(){this.program!=null&&Vp(this.gl,this.debug,this.program),Wl(this.gl)},t.prototype.executeProgram=function(){this.throwIfDisposed(),this.throwIfNoProgram();var e=this.gl;this.debug&&this.debugValidate(),de(e,this.debug,function(){return e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0)})},t.prototype.blockUntilAllProgramsCompleted=function(){var e=this;this.throwIfDisposed(),de(this.gl,this.debug,function(){return e.gl.finish()})},t.prototype.getQueryTimerExtension=function(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=Ul(this.gl,this.debug,K().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension},t.prototype.getQueryTimerExtensionWebGL2=function(){return this.getQueryTimerExtension()},t.prototype.getQueryTimerExtensionWebGL1=function(){return this.getQueryTimerExtension()},t.prototype.beginQuery=function(){if(K().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){var e=this.gl,n=this.getQueryTimerExtensionWebGL2(),r=e.createQuery();return e.beginQuery(n.TIME_ELAPSED_EXT,r),r}var o=this.getQueryTimerExtensionWebGL1(),i=o.createQueryEXT();return o.beginQueryEXT(o.TIME_ELAPSED_EXT,i),i},t.prototype.endQuery=function(){if(K().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")!==2){var e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}else{var n=this.gl,r=this.getQueryTimerExtensionWebGL2();n.endQuery(r.TIME_ELAPSED_EXT)}},t.prototype.waitForQueryAndGetTime=function(e){return ue(this,void 0,void 0,function(){var n=this;return ce(this,function(r){switch(r.label){case 0:return[4,$w(function(){return n.disposed||n.isQueryAvailable(e,K().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))})];case 1:return r.sent(),[2,this.getQueryTime(e,K().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))]}})})},t.prototype.getQueryTime=function(e,n){if(n===0)return null;if(n===2){var r=this.gl;return r.getQueryParameter(e,r.QUERY_RESULT)/1e6}var o=this.getQueryTimerExtensionWebGL1();return o.getQueryObjectEXT(e,o.QUERY_RESULT_EXT)/1e6},t.prototype.isQueryAvailable=function(e,n){if(n===0)return!0;if(n===2){var r=this.gl,o=this.getQueryTimerExtensionWebGL2(),i=r.getQueryParameter(e,r.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(o.GPU_DISJOINT_EXT)),i&&!this.disjoint}return i=(o=this.getQueryTimerExtensionWebGL1()).getQueryObjectEXT(e,o.QUERY_RESULT_AVAILABLE_EXT),this.disjoint==null&&(this.disjoint=this.gl.getParameter(o.GPU_DISJOINT_EXT)),i&&!this.disjoint},t.prototype.pollFence=function(e){var n=this;return new Promise(function(r){n.addItemToPoll(function(){return e.isFencePassed()},function(){return r()})})},t.prototype.pollItems=function(){for(var e=function(r){for(var o=0;o<r.length&&r[o]();++o);return o-1}(this.itemsToPoll.map(function(r){return r.isDoneFn})),n=0;n<=e;++n)(0,this.itemsToPoll[n].resolveFn)();this.itemsToPoll=this.itemsToPoll.slice(e+1)},t.prototype.addItemToPoll=function(e,n){var r=this;this.itemsToPoll.push({isDoneFn:e,resolveFn:n}),this.itemsToPoll.length>1||$w(function(){return r.pollItems(),r.itemsToPoll.length===0})},t.prototype.bindTextureToFrameBuffer=function(e){this.throwIfDisposed(),Hp(this.gl,this.debug,e,this.framebuffer),this.debug&&Wl(this.gl)},t.prototype.unbindTextureToFrameBuffer=function(){this.outputTexture!=null?(Hp(this.gl,this.debug,this.outputTexture,this.framebuffer),this.debug&&Wl(this.gl)):Xw(this.gl,this.debug,this.framebuffer)},t.prototype.downloadMatrixDriver=function(e,n){this.bindTextureToFrameBuffer(e);var r=n();return this.unbindTextureToFrameBuffer(),r},t.prototype.setOutputMatrixTextureDriver=function(e,n,r){this.throwIfDisposed();var o=this.gl;Hp(o,this.debug,e,this.framebuffer),this.debug&&Wl(o),this.outputTexture=e,de(o,this.debug,function(){return o.viewport(0,0,n,r)}),de(o,this.debug,function(){return o.scissor(0,0,n,r)})},t.prototype.setOutputMatrixWriteRegionDriver=function(e,n,r,o){var i=this;this.throwIfDisposed(),de(this.gl,this.debug,function(){return i.gl.scissor(e,n,r,o)})},t.prototype.throwIfDisposed=function(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")},t.prototype.throwIfNoProgram=function(){if(this.program==null)throw new Error("No GPU program is currently set.")},t}();function ub(t,e){if(t.length!==e.length)throw Error("Binary was compiled with "+t.length+" inputs, but was executed with "+e.length+" inputs");t.forEach(function(n,r){var o=n.logicalShape,i=e[r],a=i.shape;if(!Nt(o,a))throw Error("Binary was compiled with different shapes than the current args. Shapes "+o+" and "+a+" must match");if(!n.isUniform||!i.isUniform){var s=n.texShape,u=i.isUniform?null:i.texData.texShape;if(!Nt(s,u))throw Error("Binary was compiled with different texture shapes than the current args. Shape "+s+" and "+u+" must match")}})}var Vz=function(t,e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;for(var r=n.filterWidth,o=n.inChannels,i=n.strideWidth,a=n.strideHeight,s=n.padInfo,u=n.outWidth,c=n.dilationWidth,l=n.dilationHeight,d=n.dataFormat,f=s.left,h=s.top,m=o*r,p=qt(),g=d==="channelsLast",v=g?0:1,y=g?1:2,x="",w=0;w<=1;w++)for(var E=0;E<=1;E++)x+=`
          blockIndex = rc.y + `+E+`;
          pos = rc.x + `+w+`;

          if(blockIndex < `+t[1]+" && pos < "+t[0]+`) {
            offsetY = int(blockIndex / (`+u+")) * "+a+" - "+h+`;
            d0 = offsetY + `+l+" * (pos / "+m+`);

            if(d0 < `+e[v]+` && d0 >= 0) {

              offsetX = int(mod(float(blockIndex), `+u+".) * "+i+". - "+f+`.);
              d1 = offsetX + `+c+" * (int(mod(float(pos), "+m+".) / "+o+`.));

              if(d1 < `+e[y]+` && d1 >= 0) {

                ch = int(mod(float(pos), `+o+`.));

                if (`+g+`) {
                  innerDims = vec2(d1, ch);
                  result[`+(2*w+E)+`] = getChannel(
                    getA(d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[`+(2*w+E)+`] = getChannel(
                    getA(ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec2 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        `+x+`

        `+p.output+` = result;
      }
    `},Hz=function(t,e,n,r,o){this.variableNames=["x"],this.outputShape=[];var i,a=e,s=t[3]-1;this.outputShape=t;var u="float("+n+") + float("+r+") * sum";i=o===.5?"inversesqrt("+u+")":o===1?"1.0/("+u+")":"exp(log("+u+") * float(-"+o+"));",this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -`+a+"; j <= "+a+`; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  `+s+`) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * `+i+`;
        setOutput(val);
      }
    `},Gz=function(t,e,n,r,o){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=t,this.depth=t[3],this.depthRadius=e,this.bias=n,this.alpha=r,this.beta=o,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < `+this.depth+`; ++d) {
          int depthBegin = int(max(0.0, float(d - `+e+`)));
          int depthEnd = int(min(float(`+this.depth+`),
              float(d + `+e+` + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = `+this.depth+`;

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(`+r+") * norm + float("+n+`);

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(`+r+`)
                * float(`+o+`)
                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * `+o+`);
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `},Kz=function(t,e,n,r,o){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;var i,a=e,s=t[3]-1;this.outputShape=t;var u="float("+n+") + float("+r+") * sum";i=o===.5?"inversesqrt("+u+")":o===1?"1.0/("+u+")":"exp(log("+u+") * float(-"+o+"));",this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < `+this.outputShape[3]+`;
        bool hasNextRow = c < `+this.outputShape[2]+`;

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - `+a+`;
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - `+a+"; j <= "+a+`; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(`+s+`));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * `+i+`;
        setOutput(result);
      }
    `},qz=function(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;var e=t.strideHeight,n=t.strideWidth,r=t.dilationHeight,o=t.effectiveFilterHeight,i=t.effectiveFilterWidth,a=o-1-t.padInfo.top,s=i-1-t.padInfo.left,u=o*i-1;this.userCode=`
      const ivec2 pads = ivec2(`+a+", "+s+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+o+`;
          wR += `+r+`) {
          float dyR = float(dyRCorner + wR) / `+e+`.0;

          if (dyR < 0.0 || dyR >= `+t.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < `+i+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+n+`.0;

            if (dyC < 0.0 || dyC >= `+t.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = `+u+` - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * `+i+` + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `},Xz=function(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;var e=t.strideDepth,n=t.strideHeight,r=t.strideWidth,o=t.dilationDepth,i=t.dilationHeight,a=t.dilationWidth,s=t.effectiveFilterDepth,u=t.effectiveFilterHeight,c=t.effectiveFilterWidth,l=s-1-t.padInfo.front,d=u-1-t.padInfo.top,f=c-1-t.padInfo.left,h=s*u*c-1;this.userCode=`
      const ivec3 pads = ivec3(`+l+", "+d+", "+f+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < `+s+`;
           wD += `+o+`) {
          float dyD = float(dyDCorner + wD) / `+e+`.0;

          if (dyD < 0.0 || dyD >= `+t.outDepth+`.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < `+u+`;
              wR += `+i+`) {
            float dyR = float(dyRCorner + wR) / `+n+`.0;

            if (dyR < 0.0 || dyR >= `+t.outHeight+`.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < `+c+`;
                wC += `+a+`) {
              float dyC = float(dyCCorner + wC) / `+r+`.0;

              if (dyC < 0.0 || dyC >= `+t.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = `+h+` -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * `+u+" * "+c+` +
                  wR * `+c+` + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `},Yp=function(t,e,n,r,o,i,a){n===void 0&&(n=!1),r===void 0&&(r=!1),o===void 0&&(o=!1),i===void 0&&(i=null),a===void 0&&(a=!1),this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e;var s=n?t[1]:t[2],u=Math.ceil(s/2),c=n?"i * 2, rc.y":"rc.y, i * 2",l=r?"rc.z, i * 2":"i * 2, rc.z",d=n?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],f=r?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],h="",m="";i&&(h=a?`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          `+i+`
        }`:`vec4 activation(vec4 x) {
          `+i+`
        }`,m="result = activation(result);");var p=o?"result += getBiasAtOutCoords();":"";o&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+h+`

      const float sharedDimension = `+u+`.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        for (int i = 0; i < `+u+`; i++) {
          vec4 a = getMatrixA(rc.x, `+c+`);
          vec4 b = getMatrixB(rc.x, `+l+`);

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (`+d[0]+" * "+f[0]+`);
          result += (`+d[1]+" * "+f[1]+`);
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        `+p+`

        `+m+`

        setOutput(result);
      }
    `},Yz=function(){function t(e,n,r){this.variableNames=["probs"],this.outputShape=[e,r],this.userCode=`
      uniform float seed;

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < `+(n-1)+`; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(`+(n-1)+`));
      }
    `}return t.prototype.getCustomSetupFunc=function(e){var n=this;return function(r,o){n.seedLoc==null&&(n.seedLoc=r.getUniformLocation(o,"seed")),r.gl.uniform1f(n.seedLoc,e)}},t}(),Qz=function(t,e,n,r){this.variableNames=["indices"],this.outputShape=[t,e],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(`+r+"), float("+n+`),
                      float(index == coords.y)));
      }
    `},Jz=function(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=t;var e=t.length;if(e===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{var n=fn("rc",e),r=Ge(e),o=function(s,u,c){if(s===1)return"rc > "+u[0];for(var l="",d=s-2;d<s;d++)l+=c[d]+" >= "+u[d],d<s-1&&(l+="||");return l}(e,t,n),i=function(s,u,c,l){if(s===1)return"";var d=l.slice(-2);return`
    int r = `+d[0]+`;
    int c = `+d[1]+`;
    int rp1 = r + 1;
    int cp1 = c + 1;

    bool cEdge = cp1 >= `+u+`;
    bool rEdge = rp1 >= `+c+`;
  `}(e,t[t.length-1],t[t.length-2],n),a=function(s,u){var c=s.length,l=function(d,f){for(var h=[],m=0;m<=1;m++)for(var p=0;p<=1;p++){for(var g=(m===0?"r":"rp1")+", "+(p===0?"c":"cp1"),v=2;v<d;v++)g=f[f.length-1-v]+","+g;h.push(g)}return h}(c,u);return c===1?`getA(rc),
            rc + 1 >= `+s[0]+` ? 0. : getA(rc + 1),
            0, 0`:"getA("+l[0]+`),
          cEdge ? 0. : getA(`+l[1]+`),
          rEdge ? 0. : getA(`+l[2]+`),
          rEdge || cEdge ? 0. : getA(`+l[3]+")"}(t,n);this.userCode=`
        void main() {
          `+r+` rc = getOutputCoords();

          if(`+o+`) {
            setOutput(vec4(0));
          } else {
            `+i+`

            setOutput(vec4(`+a+`));
          }
        }
      `}},Zz=function(t,e,n){this.variableNames=["x"],this.outputShape=e.map(function(u,c){return u[0]+t[c]+u[1]});var r=t.length,o=Ge(r),i=e.map(function(u){return u[0]}).join(","),a=e.map(function(u,c){return u[0]+t[c]}).join(","),s=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);this.userCode=r!==1?`
      `+o+" start = "+o+"("+i+`);
      `+o+" end = "+o+"("+a+`);

      void main() {
        `+o+` outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(float(`+n+`));
        } else {
          `+o+` coords = outC - start;
          setOutput(getX(`+s+`));
        }
      }
    `:`
        int start = `+i+`;
        int end = `+a+`;

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(float(`+n+`));
          } else {
            setOutput(getX(outC - start));
          }
        }
      `},eV=function(t,e,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e.map(function(g,v){return g[0]+t[v]+g[1]});for(var r=t.length,o=Ge(r),i=e.map(function(g){return g[0]}).join(","),a=e.map(function(g,v){return g[0]+t[v]}).join(","),s=fn("rc",r),u=fn("source",r),c=s[r-1]+" < "+this.outputShape[r-1],l=r===1?"source":"vec2("+u.slice(-2).join()+")",d=[o+" rc = outputLoc;",s[r-1]+` += 1;
       if(`+c+`) {
      `,r===1?"":`}
       rc = outputLoc;
       `+s[r-2]+` += 1;
       if(`+s[r-2]+" < "+this.outputShape[r-2]+") {",r===1?"":"  "+s[r-1]+` += 1;
         if(`+c+") {"],f=r===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",h="",m=0,p=r===1?2:4;m<p;m++)h+=`
        `+d[m]+`
        if (`+f+`) {
          result[`+m+"] = float("+n+`);
        } else {
          `+o+` source = rc - start;
          result[`+m+"] = getChannel(getX("+u.join()+"), "+l+`);
        }
      `;h+=r===1?"} ":"}}",this.userCode=`
      const `+o+" start = "+o+"("+i+`);
      const `+o+" end = "+o+"("+a+`);

      void main() {
        `+o+` outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        `+h+`
        setOutput(result);
      }
    `},Qp=function(t,e,n){if(this.variableNames=["x"],e==="avg"&&n)throw new Error("Cannot compute positions for average pool.");var r=t.filterWidth,o=t.strideHeight,i=t.strideWidth,a=t.dilationHeight,s=t.dilationWidth,u=t.effectiveFilterHeight,c=t.effectiveFilterWidth,l=t.padInfo.top,d=t.padInfo.left;this.outputShape=t.outShape;var f=e==="avg",h="0.0";if(f||(h="-1.0 / 1e-20"),n)this.userCode=`
        const ivec2 strides = ivec2(`+o+", "+i+`);
        const ivec2 pads = ivec2(`+l+", "+d+`);

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < `+u+`;
              wR += `+a+`) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= `+t.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+c+`;
                wC += `+s+`) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= `+t.inWidth+`) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value >= currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = wR * `+c+` + wC;
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;else{var m=e+"("+e+"("+e+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";e==="avg"&&(m="avgValue / count");var p=4*Math.floor(r/4),g=r%4,v=`
      if (`+f+`) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = max(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(`+o+", "+i+`);
      const ivec2 pads = ivec2(`+l+", "+d+`);
      const float initializationValue = `+h+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= `+t.inWidth+`) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(`+h+`);
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < `+u+`;
            wR += `+a+`) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= `+t.inHeight+`) {
            continue;
          }

          for (int wC = 0; wC < `+p+`; wC += 4) {
            int xC = xCCorner + wC * `+s+`;

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+s+`, d),
              getValue(batch, xR, xC + 2 * `+s+`, d),
              getValue(batch, xR, xC + 3 * `+s+`, d)
            );

            `+v+`
          }

          int xC = xCCorner + `+p+`;
          if (`+(g===1)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            `+v+`
          } else if (`+(g===2)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+s+`, d),
              initializationValue,
              initializationValue
            );

            `+v+`
          } else if (`+(g===3)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+s+`, d),
              getValue(batch, xR, xC + 2 * `+s+`, d),
              initializationValue
            );

            `+v+`
          }
        }
        setOutput(`+m+`);
      }
    `}},Jp=function(t,e,n){if(this.variableNames=["x"],e==="avg"&&n)throw new Error("Cannot compute positions for average pool.");var r=t.filterWidth,o=t.strideDepth,i=t.strideHeight,a=t.strideWidth,s=t.dilationDepth,u=t.dilationHeight,c=t.dilationWidth,l=t.effectiveFilterDepth,d=t.effectiveFilterHeight,f=t.effectiveFilterWidth,h=t.padInfo.front,m=t.padInfo.top,p=t.padInfo.left;this.outputShape=t.outShape;var g=e==="avg",v="0.0";if(g||(v="-1.0 / 1e-20"),n)this.userCode=`
        const ivec3 strides =
            ivec3(`+o+", "+i+", "+a+`);
        const ivec3 pads = ivec3(`+h+", "+m+", "+p+`);

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < `+l+`;
              wD += `+s+`) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= `+t.inDepth+`) {
              continue;
            }

            for (int wR = 0; wR < `+d+`;
                wR += `+u+`) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= `+t.inHeight+`) {
                continue;
              }

              for (int wC = 0; wC < `+f+`;
                  wC += `+c+`) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= `+t.inWidth+`) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value >= currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition =
                      wD * `+d+" * "+f+` +
                      wR * `+f+` + wC;;
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;else{var y=e+"("+e+"("+e+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";e==="avg"&&(y="avgValue / count");var x=4*Math.floor(r/4),w=r%4,E=`
      if (`+g+`) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = max(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(`+o+", "+i+", "+a+`);
      const ivec3 pads = ivec3(`+h+", "+m+", "+p+`);
      const float initializationValue = `+v+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= `+t.inWidth+`) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(`+v+`);
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < `+l+`;
            wD += `+s+`) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= `+t.inDepth+`) {
            continue;
          }

          for (int wR = 0; wR < `+d+`;
            wR += `+u+`) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= `+t.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+x+`; wC += 4) {
              int xC = xCCorner + wC * `+c+`;

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+c+`, ch),
                getValue(batch, xD, xR, xC + 2 * `+c+`, ch),
                getValue(batch, xD, xR, xC + 3 * `+c+`, ch)
              );

              `+E+`
            }

            int xC = xCCorner + `+x+`;
            if (`+(w===1)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              `+E+`
            } else if (`+(w===2)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+c+`, ch),
                initializationValue,
                initializationValue
              );

              `+E+`
            } else if (`+(w===3)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+c+`, ch),
                getValue(batch, xD, xR, xC + 2 * `+c+`, ch),
                initializationValue
              );

              `+E+`
            }
          }
          setOutput(`+y+`);
        }
      }
    `}},tV=function(t,e){this.variableNames=["x"];var n=t.windowSize,r=t.batchSize,o=t.inSize,i=Math.ceil(o/n);this.outputShape=[r,i];var a="0.0",s="";e==="prod"?a="1.0":e==="min"?(a="1.0 / 1e-20",s="min"):e==="max"&&(a="-1.0 / 1e-20",s="max");var u=e+"("+e+"("+e+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";e==="sum"?u="sumValue":e==="prod"?u="prodValue":e==="all"?u="allValue":e==="any"&&(u="anyValue");var c=4*Math.floor(n/4),l=n%4,d=`
      if (`+(e==="sum")+`) {
        sumValue += dot(values, ones);
      } else if (`+(e==="prod")+`) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = `+s+`(values, minMaxValue);
      }
    `,f="vec4";e==="all"?(a="1.0",d=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,f="bvec4"):e==="any"&&(a="0.0",d=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,f="bvec4");var h="";o%n>0&&(h=`
        if (inIdx < 0 || inIdx >= `+o+`) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = `+a+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        `+h+`
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * `+n+`;

        vec4 minMaxValue = vec4(`+a+`);
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < `+c+`; i += 4) {
          int inIdx = inOffset + i;
          `+f+" values = "+f+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          `+d+`
        }

        int inIdx = inOffset + `+c+`;
        if (`+(l===1)+`) {
          `+f+" values = "+f+`(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          `+d+`
        } else if (`+(l===2)+`) {
          `+f+" values = "+f+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          `+d+`
        } else if (`+(l===3)+`) {
          `+f+" values = "+f+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          `+d+`
        }
        setOutput(`+u+`);
      }
    `},nV=function(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;for(var n="",r=0;r<4;r++){var o="thisRC = rc;";r%2==1&&(o+="thisRC.z += 1;"),r>1&&(o+="thisRC.y += 1;"),n+=`
        `+o+`
        `+(r>0?"if(thisRC.y < rows && thisRC.z < cols){":"")+`
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[`+r+`] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        `+(r>0?"}":"")+`
      `}this.userCode=`
      
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      `+Ji(["r","c","d"],e)+`
      return ivec3(r, c, d);
    }
  
      `+e0(t)+`

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = `+t[1]+`;
        int cols = `+t[2]+`;

        `+n+`

        setOutput(result);
      }
    `},rV=function(t,e,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=e.shape;var r=e.shape,o=r[1],i=r[2],a=t.shape,s=a[1],u=a[2],c=[n&&s>1?o-1:o,n&&u>1?i-1:i],l=[n&&s>1?s-1:s,n&&u>1?u-1:u],d=c[0]/l[0],f=c[1]/l[1],h=1/d,m=1/f,p=2*Math.ceil(h)+2,g=2*Math.ceil(m)+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(`+d+`);
        const float widthScale = float(`+f+`);

        const float invHeightScale = float(`+h+`);
        const float invWidthScale = float(`+m+`);

        const int winHeight = int(`+p+`);
        const int winWidth = int(`+g+`);

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= `+s+`) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= `+u+`) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), `+(o-1)+`.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), `+(i-1)+`.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `},oV=function(t,e,n,r){this.variableNames=["A"],this.outputShape=[];var o=t[0],i=t[1],a=t[2],s=t[3];this.outputShape=[o,e,n,s];var u=[r&&e>1?i-1:i,r&&n>1?a-1:a],c=[r&&e>1?e-1:e,r&&n>1?n-1:n];this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          `+u[0]/c[0]+`,
          `+u[1]/c[1]+`);
      const vec2 inputShapeRC = vec2(`+i+".0, "+a+`.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(sourceFracIndexRC);
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `},iV=function(t,e,n,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];var o=t[0],i=t[1],a=t[2],s=t[3];this.outputShape=[o,e,n,s];var u=[r&&e>1?i-1:i,r&&n>1?a-1:a],c=[r&&e>1?e-1:e,r&&n>1?n-1:n];this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          `+u[0]/c[0]+`,
          `+u[1]/c[1]+`,
          `+u[1]/c[1]+`);
      const vec3 inputShapeRC = vec3(`+i+".0, "+a+`.0,
                                     `+a+`.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = vec3(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(sourceFracIndexRC);
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < `+(s-1)+`;
        bool hasNextRow = coords.z < `+(n-1)+`;

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `},aV=function(t,e,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=e.shape;var r=e.shape,o=r[1],i=r[2],a=t.shape,s=a[1],u=a[2],c=[n&&s>1?o-1:o,n&&u>1?i-1:i],l=[n&&s>1?s-1:s,n&&u>1?u-1:u],d=c[0]/l[0],f=c[1]/l[1],h=1/d,m=1/f,p=2*Math.ceil(h)+2,g=2*Math.ceil(m)+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(`+d+`);
        const float widthScale = float(`+f+`);

        const float invHeightScale = float(`+h+`);
        const float invWidthScale = float(`+m+`);

        const int winHeight = int(`+p+`);
        const int winWidth = int(`+g+`);

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= `+s+`) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= `+u+`) {
              continue;
            }

            float sourceFracRow =
              float(`+c[0]+`) *
                (float(dyR) / float(`+l[0]+`));

            float sourceFracCol =
                float(`+c[1]+`) *
                  (float(dyC) / float(`+l[1]+`));

            int sourceNearestRow = int(min(
                float(int(`+o+`) - 1),
                `+n+` ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(`+i+`) - 1),
                `+n+` ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `},sV=function(t,e,n,r){this.variableNames=["A"],this.outputShape=[];var o=t[0],i=t[1],a=t[2],s=t[3];this.outputShape=[o,e,n,s];var u=[r&&e>1?i-1:i,r&&n>1?a-1:a],c=[r&&e>1?e-1:e,r&&n>1?n-1:n],l=r?"0.5":"0.0";this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          `+u[0]/c[0]+`,
          `+u[1]/c[1]+`);
      const vec2 inputShapeRC = vec2(`+i+".0, "+a+`.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + `+l+`)));

        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `},uV=function(t,e){this.variableNames=["x"];var n=t.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-"+n+" tensor is not yet supported");if(this.outputShape=t,n!==1){var r=t.map(function(i,a){return function(s){return e.indexOf(s)!==-1&&t[s]!==1?t[s]+" - coords["+s+"] - 1":"coords["+s+"]"}(a)}).join(","),o=Ge(n);this.userCode=`
      void main() {
        `+o+` coords = getOutputCoords();
        setOutput(getX(`+r+`));
      }
    `}else this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(`+t[0]+` - coord - 1));
        }
      `},cV=function(t,e){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;var n=t.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-"+n+" tensor is not yet supported");this.outputShape=t;var r=fn("rc",n),o=r[n-1]+" + 1 < "+this.outputShape[n-1],i=r[n-2]+" + 1 < "+this.outputShape[n-2],a=Ge(n);function s(u){var c=t.map(function(l,d){return function(f,h){return e.indexOf(f)!==-1&&t[f]!==1?t[f]+" - "+h[f]+" - 1":""+h[f]}(d,u)});return"getChannel(getX("+c.join(",")+"), vec2("+c.slice(-2).join(",")+"))"}this.userCode=n===1?`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(`+t[0]+` - rc - 1),
            `+t[0]+` - rc - 1);
          if(`+o+`){
              result.g = getChannel(getX(`+t[0]+` - (rc  + 1) - 1),
                `+t[0]+` - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:`
        void main() {
          `+a+` rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = `+function(u){return s(u)}(r.slice())+`;
          if(`+o+`){
            result.g = `+function(u){return u[n-1]="("+u[n-1]+" + 1)",s(u)}(r.slice())+`;
          }
          if(`+i+`) {
            result.b = `+function(u){return u[n-2]="("+u[n-2]+" + 1)",s(u)}(r.slice())+`;
            if(`+o+`) {
              result.a = `+function(u){return u[n-1]="("+u[n-1]+" + 1)",u[n-2]="("+u[n-2]+" + 1)",s(u)}(r.slice())+`;
            }
          }
          setOutput(result);
        }
    `},cb=function(t,e,n,r,o,i,a){this.variableNames=["updates","indices","defaultValue"],this.outputShape=i;var s=Ge(o.length),u=Ge(i.length),c="";n===1?c="i":n===2&&(c="i, j");var l="getIndices("+c+")",d="";r===1?d="i":r===2&&(d="i, coords[1]");var f="getUpdates("+d+")",h=e>1?"strides[j]":"strides";this.userCode=`
        `+s+" strides = "+s+"("+o+`);

        void main() {
          `+u+` coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < `+t+`; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < `+e+`; j++) {
              int index = round(`+l+`);
              flattenedIndex += index * `+h+`;
            }
            if (flattenedIndex == coords[0]) {
              sum += `+f+`;
              found = true;
            }
          }
          setOutput(mix(getDefaultValue(), sum, float(found)));
        }
      `},lV=function(t,e){this.variableNames=["x","segmentIds"];var n=t.windowSize,r=t.batchSize,o=t.inSize,i=t.numSegments,a=i*Math.ceil(o/n);this.outputShape=[r,a];var s=4*Math.floor(n/4),u=n%4,c=`
        sumValue += dot(values, segFilter);
    `,l="";o%n>0&&(l=`
        if (inIdx < 0 || inIdx >= `+o+`) {
          return initializationValue;
        }
      `);var d="";o%n>0&&(d=`
        if (inIdx < 0 || inIdx >= `+o+`) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = 0.0;

      float getValue(int batch, int inIdx) {
        `+l+`
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        `+d+`
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          `+i+")) * float("+n+`));
        int currentSeg = int(mod(float(outIdx), float(`+i+`)));

        float sumValue = 0.0;

        for (int i = 0; i < `+s+`; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          `+c+`
        }

        int inIdx = inOffset + `+s+`;
        if (`+(u===1)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          `+c+`
        } else if (`+(u===2)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          `+c+`
        } else if (`+(u===3)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          `+c+`
        }
        setOutput(sumValue);
      }
    `},dV=function(t,e,n){var r,o;if(this.variableNames=["c","a","b"],this.outputShape=e,n>4)throw Error("Where for rank "+n+" is not yet supported");if(n===1)o="resRC",r="resRC";else{for(var i=["resRC.x","resRC.y","resRC.z","resRC.w"],a=[],s=[],u=0;u<e.length;u++)s.push(""+i[u]),u<t&&a.push(""+i[u]);r=a.join(),o=s.join()}var c=Ge(n);this.userCode=`
      void main() {
        `+c+` resRC = getOutputCoords();
        float cVal = getC(`+r+`);
        if (cVal >= 1.0) {
          setOutput(getA(`+o+`));
        } else {
          setOutput(getB(`+o+`));
        }
      }
    `},fV=function(){function t(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;var n,r=Ge(this.rank),o="uniform int start["+this.rank+"];",i=function(a){if(a===1)return"sourceLoc";if(a<=6)return Zp.slice(0,a).map(function(s){return"sourceLoc."+s}).join(",");throw Error("Slicing for rank "+a+" is not yet supported")}(this.rank);n=`
        `+r+` sourceLoc;
        `+r+` coords = getOutputCoords();
        `+e.map(function(a,s){return"sourceLoc."+Zp[s]+" = start["+s+"] + coords."+Zp[s]+";"}).join(`
`)+`
      `,this.userCode=`
      `+o+`
      void main() {
        `+n+`
        setOutput(getSource(`+i+`));
      }
    `}return t.prototype.getCustomSetupFunc=function(e){var n=this;if(e.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+e.length+")");return function(r,o){n.startLoc==null&&(n.startLoc=r.getUniformLocationNoThrow(o,"start"),n.startLoc==null)||r.gl.uniform1iv(n.startLoc,e)}},t}(),Zp=["x","y","z","w","u","v"],hV=function(){function t(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length;var n=Ge(this.rank),r=fn("coords",this.rank),o=fn("sourceLoc",this.rank),i=this.rank===1?"sourceLoc":"vec2("+o.slice(-2).join()+")",a="getChannel(getSource("+o.join()+"), "+i+")",s=`
      result.x = `+a+`;
      if (++`+r[this.rank-1]+" < "+e[this.rank-1]+`) {
        ++`+o[this.rank-1]+`;
        result.y = `+a+`;
        --`+o[this.rank-1]+`;
      }
    `,u=this.rank===1?"":`
      --`+r[this.rank-1]+`;
      if (++`+r[this.rank-2]+" < "+e[this.rank-2]+`) {
        ++`+o[this.rank-2]+`;
        result.z = `+a+`;
        if (++`+r[this.rank-1]+" < "+e[this.rank-1]+`) {
          ++`+o[this.rank-1]+`;
          result.w = `+a+`;
        }
      }
    `,c=this.rank<=4?`sourceLoc = coords +
            `+n+"("+e.map(function(l,d){return"start["+d+"]"}).join()+");":e.map(function(l,d){return o[d]+" = "+r[d]+" + start["+d+"];"}).join(`
`);this.userCode=`
      uniform int start[`+this.rank+`];
      void main() {
        `+n+` coords = getOutputCoords();
        `+n+` sourceLoc;
        `+c+`
        vec4 result = vec4(0.);
        `+s+`
        `+u+`
        setOutput(result);
      }
    `}return t.prototype.getCustomSetupFunc=function(e){var n=this;if(e.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+e.length+")");return function(r,o){n.startLoc==null&&(n.startLoc=r.getUniformLocationNoThrow(o,"start"),n.startLoc==null)||r.gl.uniform1iv(n.startLoc,e)}},t}(),pV=function(t,e,n){this.variableNames=["x"],this.outputShape=n;var r=n.length,o=Ge(n.length),i=Ge(n.length),a="";if(r===1)a="coords * strides + begin";else{var s=0;a=n.map(function(u,c){return s++,n.length===1?"coords * strides["+c+"] + begin["+c+"]":"coords["+(s-1)+"] * strides["+c+"] + begin["+c+"]"}).join(",")}this.userCode=`
      `+o+" begin = "+o+"("+t+`);
      `+o+" strides = "+o+"("+e+`);

      void main() {
        `+i+` coords = getOutputCoords();
        setOutput(getX(`+a+`));
      }
    `},mV=function(){function t(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}return t.prototype.acquireTexture=function(e,n,r){var o,i=lb(n,r),a=db(e,i,r);if(a in this.freeTextures||(this.freeTextures[a]=[]),a in this.usedTextures||(this.usedTextures[a]=[]),this.freeTextures[a].length>0){this.numFreeTextures--,this.numUsedTextures++,this.log();var s=this.freeTextures[a].shift();return this.usedTextures[a].push(s),s}return this.numUsedTextures++,this.log(),i===Sn.PACKED_2X2_FLOAT32?o=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):i===Sn.PACKED_2X2_FLOAT16?o=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):i===Sn.UNPACKED_FLOAT32?o=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):i===Sn.UNPACKED_FLOAT16?o=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):i===Sn.PACKED_4X1_UNSIGNED_BYTE&&(o=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[a].push(o),o},t.prototype.releaseTexture=function(e,n,r,o){if(this.freeTextures!=null){var i=db(n,lb(r,o),o);i in this.freeTextures||(this.freeTextures[i]=[]),this.freeTextures[i].push(e),this.numFreeTextures++,this.numUsedTextures--;var a=this.usedTextures[i],s=a.indexOf(e);if(s<0)throw new Error("Cannot release a texture that was never provided by this texture manager");a.splice(s,1),this.log()}},t.prototype.log=function(){if(this.logEnabled){var e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",this.numFreeTextures+" / "+this.numUsedTextures,"("+e+")")}},t.prototype.getNumUsedTextures=function(){return this.numUsedTextures},t.prototype.getNumFreeTextures=function(){return this.numFreeTextures},t.prototype.dispose=function(){var e=this;if(this.freeTextures!=null){for(var n in this.freeTextures)this.freeTextures[n].forEach(function(r){e.gpgpu.deleteMatrixTexture(r)});for(var n in this.usedTextures)this.usedTextures[n].forEach(function(o){e.gpgpu.deleteMatrixTexture(o)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0}},t}();function lb(t,e){if(t===In.UPLOAD)return Sn.PACKED_2X2_FLOAT32;if(t===In.RENDER||t==null)return function(n){return K().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?n?Sn.PACKED_2X2_FLOAT32:Sn.UNPACKED_FLOAT32:n?Sn.PACKED_2X2_FLOAT16:Sn.UNPACKED_FLOAT16}(e);if(t===In.DOWNLOAD||t===In.PIXELS)return Sn.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type "+t)}function db(t,e,n){return t[0]+"_"+t[1]+"_"+e+"_"+n}var vV=function(t,e){this.variableNames=["A"];for(var n=new Array(t.length),r=0;r<n.length;r++)n[r]=t[r]*e[r];this.outputShape=n,this.rank=n.length;var o=Ge(this.rank),i=function(a){var s=a.length;if(s>5)throw Error("Tile for rank "+s+" is not yet supported");if(s===1)return"imod(resRC, "+a[0]+")";for(var u=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],c=[],l=0;l<a.length;l++)c.push("imod("+u[l]+", "+a[l]+")");return c.join()}(t);this.userCode=`
      void main() {
        `+o+` resRC = getOutputCoords();
        setOutput(getA(`+i+`));
      }
    `},gV=function(t,e){this.variableNames=["A"];for(var n=new Array(t.length),r=0;r<n.length;r++)n[r]=t[e[r]];this.outputShape=n,this.rank=n.length;var o=Ge(this.rank),i=function(a){var s=a.length;if(s>6)throw Error("Transpose for rank "+s+" is not yet supported");for(var u=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],c=new Array(s),l=0;l<a.length;l++)c[a[l]]=u[l];return c.join()}(e);this.userCode=`
    void main() {
      `+o+` resRC = getOutputCoords();
      setOutput(getA(`+i+`));
    }
    `},yV=function(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;for(var n=new Array(t.length),r=0;r<n.length;r++)n[r]=t[e[r]];if(this.outputShape=n,this.rank=n.length,this.rank>6)throw Error("Packed transpose for rank "+this.rank+" is not yet supported.");var o=Ge(this.rank),i=bR("rc",this.rank),a=new Array(this.rank);for(r=0;r<e.length;r++)a[e[r]]=i[r];var s="vec2("+a.slice(-2).join()+")",u="++"+i[this.rank-1]+" < "+n[this.rank-1],c="getChannel(getA("+a.join()+"), "+s+")";this.userCode=`
    void main() {
      `+o+` rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = `+c+`;
      if(`+u+`) {
        result[1] = `+c+`;
      }
      --`+i[this.rank-1]+`;
      if(++`+i[this.rank-2]+" < "+n[this.rank-2]+`) {
        result[2] = `+c+`;
        if(`+u+`) {
          result[3] = `+c+`;
        }
      }
      setOutput(result);
    }
    `},t0=1.7580993408473768,n0=1.0507009873554805,Ie=function(t,e){this.variableNames=["A"],this.outputShape=t,this.userCode=`
      float unaryOperation(float x) {
        `+e+`
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `},Er="if (isnan(x)) return x;",xV="return x;",fb="return abs(x);",kR=Er+`
  return (x < 0.0) ? 0.0 : x;
`,IR=Er+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,RR="return (x >= 0.0) ? x : (exp(x) - 1.0);",wV=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = `+t0+`;
  float scale = `+n0+`;
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,hb="return -x;",pb="return ceil(x);",mb="return floor(x);",vb="return exp(x);",gb="return exp(x) - 1.0;",bV=Er+`
  return sin(x);
`,EV=Er+`
  return cos(x);
`,CV=Er+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,_V=Er+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,SV=Er+`
  return atan(x);
`,kV=Er+"return log(x + sqrt(x * x + 1.0));",IV=Er+`
  if (x < 1.0) return NAN;
  return log(x + sqrt(x * x - 1.0));`,RV=Er+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
  return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,Hl="return x;",TV="return x;",TR=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,NR=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,AR=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,Su=function(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.userCode=`
      vec4 unaryOperation(vec4 x) {
        `+e+`
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `},NV=function(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=t;var e=t.length,n=fn("rc",e),r=Ge(e),o=function(s,u){if(s===1)return"rc";for(var c="",l=0;l<s;l++)c+=u[l],l<s-1&&(c+=",");return c}(e,n),i=n.slice(-2),a=e<=1?"rc":"vec2("+i.join(",")+")";this.userCode=`
      void main() {
        `+r+` rc = getOutputCoords();
        vec4 packedInput = getA(`+o+`);

        setOutput(getChannel(packedInput, `+a+`));
      }
    `},Gl={};function Kl(t,e){if(e===void 0&&(e=!1),t==="linear")return e?TV:xV;if(t==="relu")return e?TR:kR;if(t==="elu")return e?AR:RR;if(t==="relu6")return e?NR:IR;if(t==="prelu")return e?SR:_R;throw new Error("Activation "+t+" has not been implemented for the WebGL backend.")}var AV=600,PV=function(t){function e(n){var r,o=t.call(this)||this;if(o.pendingRead=new WeakMap,o.pendingDisposal=new WeakSet,o.dataRefCount=new WeakMap,o.numBytesInGPU=0,o.uploadWaitMs=0,o.downloadWaitMs=0,o.warnedAboutMemory=!1,o.pendingDeletes=0,o.disposed=!1,!K().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if(n==null){var i=Yr(K().getNumber("WEBGL_VERSION"));o.binaryCache=((r=K().getNumber("WEBGL_VERSION"))in Gl||(Gl[r]={}),Gl[r]),o.gpgpu=new zz(i),o.canvas=i.canvas,o.gpgpuCreatedLocally=!0}else o.gpgpu=n,o.binaryCache={},o.gpgpuCreatedLocally=!1,o.canvas=n.gl.canvas;return o.textureManager=new mV(o.gpgpu),o.numMBBeforeWarning=K().global.screen==null?1024:K().global.screen.height*K().global.screen.width*window.devicePixelRatio*AV/1024/1024,o.texData=new fR(o,L),o}return br(e,t),e.prototype.numDataIds=function(){return this.texData.numDataIds()+(this.cpuBackend?this.cpuBackend.numDataIds():0)-this.pendingDeletes},e.prototype.write=function(n,r,o){if(K().getBool("DEBUG")&&this.checkNumericalProblems(n),o==="complex64"&&n!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");var i={};return this.texData.set(i,{shape:r,dtype:o,values:n,usage:In.UPLOAD}),i},e.prototype.move=function(n,r,o,i){if(K().getBool("DEBUG")&&this.checkNumericalProblems(r),i==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(n,{shape:o,dtype:i,values:r,usage:In.UPLOAD})},e.prototype.readSync=function(n){var r=this.texData.get(n),o=r.values,i=r.dtype,a=r.complexTensors,s=r.slice,u=r.shape,c=r.isPacked;if(s!=null){var l=void 0;l=c?new Su(u,Hl):new Ie(u,Hl);var d=this.runWebGLProgram(l,[{dataId:n,shape:u,dtype:i}],i),f=this.readSync(d.dataId);return this.disposeData(d.dataId),f}if(o!=null)return this.convertAndCacheOnCPU(n);if(i==="string")return o;var h,m,p=this.activeTimers!=null;return p&&(h=Ar()),i==="complex64"?m=qv(a.real.dataSync(),a.imag.dataSync()):m=this.getValuesFromTexture(n),p&&(this.downloadWaitMs+=Ar()-h),this.convertAndCacheOnCPU(n,m)},e.prototype.read=function(n){return ue(this,void 0,void 0,function(){var r,o,i,a,s,u,c,l,d,f,h,m,p,g,v,y,x,w,E,_,S,k;return ce(this,function(I){switch(I.label){case 0:if(this.pendingRead.has(n))return r=this.pendingRead.get(n),[2,new Promise(function(R){return r.push(R)})];if(o=this.texData.get(n),i=o.values,a=o.shape,s=o.slice,u=o.dtype,c=o.complexTensors,l=o.isPacked,s!=null)return d=void 0,d=l?new Su(a,Hl):new Ie(a,Hl),f=this.runWebGLProgram(d,[{dataId:n,shape:a,dtype:u}],u),h=this.read(f.dataId),this.disposeData(f.dataId),[2,h];if(i!=null)return[2,this.convertAndCacheOnCPU(n)];if(!K().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&K().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");return m=null,u!=="complex64"&&K().get("WEBGL_BUFFER_SUPPORTED")&&(p=this.decode(n),g=this.texData.get(p.dataId),m=(k=this.gpgpu).createBufferFromTexture.apply(k,[g.texture].concat(Hu(a)))),this.pendingRead.set(n,[]),u==="complex64"?[3,2]:[4,this.gpgpu.createAndWaitForFence()];case 1:I.sent(),I.label=2;case 2:return u!=="complex64"?[3,4]:[4,Promise.all([c.real.data(),c.imag.data()])];case 3:return y=I.sent(),x=y[0],w=y[1],v=qv(x,w),[3,5];case 4:m==null?v=this.getValuesFromTexture(n):(E=le(a),v=this.gpgpu.downloadFloat32MatrixFromBuffer(m,E)),I.label=5;case 5:return p!=null&&this.disposeData(p.dataId),_=this.convertAndCacheOnCPU(n,v),S=this.pendingRead.get(n),this.pendingRead.delete(n),S.forEach(function(R){return R(_)}),this.pendingDisposal.has(n)&&(this.pendingDisposal.delete(n),this.disposeData(n),this.pendingDeletes--),[2,_]}})})},e.prototype.checkNumericalProblems=function(n){if(n!=null)for(var r=0;r<n.length;r++){var o=n[r];if(!wW(o))throw K().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error("The value "+o+" cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'"):Error("The value "+o+" cannot be represented on this device.")}},e.prototype.getValuesFromTexture=function(n){var r,o=this.texData.get(n),i=o.shape,a=o.dtype,s=o.isPacked,u=le(i);if(K().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){var c=this.decode(n),l=this.texData.get(c.dataId),d=(r=this.gpgpu).downloadMatrixFromPackedTexture.apply(r,[l.texture].concat(Hu(i))).subarray(0,u);return this.disposeData(c.dataId),d}var f=K().getBool("WEBGL_PACK")&&s===!0,h=f?Gp(i):i,m=f?new xz(h):new yz(h),p=this.runWebGLProgram(m,[{shape:h,dtype:a,dataId:n}],"float32"),g=this.texData.get(p.dataId),v=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(g.texture,g.texShape[0],g.texShape[1]).subarray(0,u);return this.disposeData(p.dataId),v},e.prototype.time=function(n){return ue(this,void 0,void 0,function(){var r,o,i,a,s,u,c;return ce(this,function(l){switch(l.label){case 0:return r=this.activeTimers,o=[],i=!1,this.programTimersStack==null?(this.programTimersStack=o,i=!0):this.activeTimers.push(o),this.activeTimers=o,n(),a=Qs(this.activeTimers.map(function(d){return d.query})).filter(function(d){return d!=null}),s=Qs(this.activeTimers.map(function(d){return d.name})).filter(function(d){return d!=null}),this.activeTimers=r,i&&(this.programTimersStack=null),u={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null},K().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[4,Promise.all(a)]:[3,2];case 1:return c=l.sent(),u.kernelMs=eW(c),u.getExtraProfileInfo=function(){return c.map(function(d,f){return{name:s[f],ms:d}}).map(function(d){return d.name+": "+d.ms}).join(", ")},[3,3];case 2:u.kernelMs={error:"WebGL query timers are not supported in this environment."},l.label=3;case 3:return this.uploadWaitMs=0,this.downloadWaitMs=0,[2,u]}})})},e.prototype.memory=function(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU}},e.prototype.startTimer=function(){return K().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:Ar(),endMs:null}},e.prototype.endTimer=function(n){return K().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),n):(n.endMs=Ar(),n)},e.prototype.getQueryTime=function(n){return ue(this,void 0,void 0,function(){var r;return ce(this,function(o){return K().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[2,this.gpgpu.waitForQueryAndGetTime(n)]:[2,(r=n).endMs-r.startMs]})})},e.prototype.disposeData=function(n){if(!this.pendingDisposal.has(n)){if(this.pendingRead.has(n))return this.pendingDisposal.add(n),void this.pendingDeletes++;if(this.texData.has(n)){this.releaseGPUData(n);var r=this.texData.get(n).complexTensors;r!=null&&(r.real.dispose(),r.imag.dispose()),this.texData.delete(n)}}},e.prototype.releaseGPUData=function(n){var r=this.texData.get(n),o=r.texture,i=r.dtype,a=r.texShape,s=r.usage,u=r.isPacked,c=r.slice,l=c&&c.origDataId||n,d=this.dataRefCount.get(l);d>1?this.dataRefCount.set(l,d-1):(this.dataRefCount.delete(l),o!=null&&(this.numBytesInGPU-=this.computeBytes(a,i),this.textureManager.releaseTexture(o,a,s,u)));var f=this.texData.get(n);f.texture=null,f.texShape=null,f.isPacked=!1,f.slice=null},e.prototype.getTexture=function(n){return this.uploadToGPU(n),this.texData.get(n).texture},e.prototype.getDataInfo=function(n){return this.texData.get(n)},e.prototype.getCPUBackend=function(){return K().getBool("WEBGL_CPU_FORWARD")?(this.cpuBackend==null&&(this.cpuBackend=L.findBackend("cpu")),this.cpuBackend):null},e.prototype.shouldExecuteOnCPU=function(n,r){var o=this;return r===void 0&&(r=128),this.getCPUBackend()!=null&&n.every(function(i){return o.texData.get(i.dataId).texture==null&&i.size<r})},e.prototype.getGPGPUContext=function(){return this.gpgpu},e.prototype.complex=function(n,r){var o=this.makeOutput(n.shape,"complex64");return this.texData.get(o.dataId).complexTensors={real:L.keep(n.clone()),imag:L.keep(r.clone())},o},e.prototype.real=function(n){return this.texData.get(n.dataId).complexTensors.real.clone()},e.prototype.imag=function(n){return this.texData.get(n.dataId).complexTensors.imag.clone()},e.prototype.slice=function(n,r,o){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.slice(n,r,o);if(le(o)===0)return Ft([],o,n.dtype);var i=this.texData.get(n.dataId).isPacked,a=lR(n.shape,r,o);if(i||!a){var s=K().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new hV(o):new fV(o),u=s.getCustomSetupFunc(r);return this.compileAndRun(s,[n],null,u)}return this.uploadToGPU(n.dataId),this.shallowSlice(n,r,o)},e.prototype.shallowSlice=function(n,r,o){var i=this.texData.get(n.dataId),a=this.makeOutput(o,n.dtype),s=this.texData.get(a.dataId);Object.assign(s,i),s.shape=o,s.dtype=n.dtype;var u=dR(r,n.strides);i.slice&&(u+=i.slice.flatOffset),s.slice={flatOffset:u,origDataId:i.slice&&i.slice.origDataId||n.dataId};var c=this.dataRefCount.get(s.slice.origDataId)||1;return this.dataRefCount.set(s.slice.origDataId,c+1),a},e.prototype.stridedSlice=function(n,r,o,i){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.stridedSlice(n,r,o,i);var a=Xy(r,o,i);if(a.some(function(u){return u===0}))return Ft([],a);var s=new pV(r,i,a);return this.compileAndRun(s,[n])},e.prototype.reverse=function(n,r){var o=K().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new cV(n.shape,r):new uV(n.shape,r);return this.compileAndRun(o,[n])},e.prototype.concat=function(n,r){if(n[0].dtype==="complex64"){var o=n.map(function(h){return $n(h)}),i=n.map(function(h){return Or(h)});return Mt(this.concat(o,r),this.concat(i,r))}if(this.shouldExecuteOnCPU(n))return this.cpuBackend.concat(n,r);if(n.length===1)return n[0];if(n.length>K().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){var a=Math.floor(n.length/2),s=this.concat(n.slice(0,a),r),u=this.concat(n.slice(a),r);return this.concat([s,u],r)}if(K().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&n[0].rank>1){var c=new oz(n.map(function(h){return h.shape}),r);return this.compileAndRun(c,n)}var l=Zs(n.map(function(h){return h.shape}),r),d=n.map(function(h){return h.as2D(-1,le(h.shape.slice(r)))}),f=new rz(d.map(function(h){return h.shape}));return this.compileAndRun(f,d).reshape(l)},e.prototype.neg=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.neg(n);if(K().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,hb,n.dtype);var r=new Ie(n.shape,hb);return this.compileAndRun(r,[n])},e.prototype.batchMatMul=function(n,r,o,i){var a=o?n.shape[2]:n.shape[1],s=i?r.shape[1]:r.shape[2],u=o?n.shape[1]:n.shape[2],c=n.shape[0];if((a===1||s===1)&&u>1e3){o&&(n=n.transpose([0,2,1])),i&&(r=r.transpose([0,2,1]));var l=s===1?n:n.as3D(c,u,1),d=s===1?2:1,f=s===1?r.as3D(c,1,u):r;return this.multiply(l,f).sum(d,!0)}var h=Ot(n.dtype,r.dtype),m=new Yp(n.shape,[c,a,s],o,i);return this.compileAndRun(m,[n,r],h)},e.prototype.fusedBatchMatMul=function(n){var r=n.a,o=n.b,i=n.transposeA,a=n.transposeB,s=n.bias,u=n.activation,c=n.preluActivationWeights,l=i?r.shape[2]:r.shape[1],d=a?o.shape[1]:o.shape[2],f=r.shape[0],h=Ot(r.dtype,o.dtype),m=s!=null,p=c!=null,g=u?Kl(u,!0):null,v=new Yp(r.shape,[f,l,d],i,a,m,g,p),y=[r,o];return s&&y.push(s),c&&y.push(c),this.compileAndRun(v,y,h)},e.prototype.multiply=function(n,r){if(n.dtype==="complex64"){var o=this.texData.get(n.dataId),i=this.texData.get(r.dataId),a=new tb(J$,n.shape,r.shape),s=new tb(Z$,n.shape,r.shape),u=[this.makeComplexComponentTensorInfo(n,o.complexTensors.real),this.makeComplexComponentTensorInfo(n,o.complexTensors.imag),this.makeComplexComponentTensorInfo(r,i.complexTensors.real),this.makeComplexComponentTensorInfo(r,i.complexTensors.imag)],c=this.compileAndRun(a,u),l=this.compileAndRun(s,u),d=this.complex(c,l);return c.dispose(),l.dispose(),d}if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.multiply(n,r);if(K().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,nb,n.dtype);var f=new at(nb,n.shape,r.shape);return this.compileAndRun(f,[n,r],n.dtype)},e.prototype.batchNormalization=function(n,r,o,i,a,s){var u=[n,r,o],c=null;s!=null&&(c=s.shape,u.push(s));var l=null;if(a!=null&&(l=a.shape,u.push(a)),K().getBool("WEBGL_PACK_NORMALIZATION")){var d=new Q$(n.shape,r.shape,o.shape,c,l,i);return this.compileAndRun(d,u)}var f=new Y$(n.shape,r.shape,o.shape,c,l,i);return this.compileAndRun(f,u)},e.prototype.localResponseNormalization4D=function(n,r,o,i,a){var s=K().getBool("WEBGL_PACK_NORMALIZATION")?new Kz(n.shape,r,o,i,a):new Hz(n.shape,r,o,i,a);return this.compileAndRun(s,[n])},e.prototype.LRNGrad=function(n,r,o,i,a,s,u){var c=new Gz(r.shape,i,a,s,u);return this.compileAndRun(c,[r,o,n])},e.prototype.tile=function(n,r){if(n.dtype==="string"){var o=this.readSync(n.dataId).map(function(a){return pf(a)});return xR(Ce(n.shape,n.dtype,o),r)}var i=new vV(n.shape,r);return this.compileAndRun(i,[n])},e.prototype.pad=function(n,r,o){var i=K().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new eV(n.shape,r,o):new Zz(n.shape,r,o);return this.compileAndRun(i,[n])},e.prototype.transpose=function(n,r){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.transpose(n,r);var o=K().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new yV(n.shape,r):new gV(n.shape,r);return this.compileAndRun(o,[n])},e.prototype.gather=function(n,r,o){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.gather(n,r,o);var i=new Sz(n.shape,r.size,o);return this.compileAndRun(i,[n,r])},e.prototype.batchToSpaceND=function(n,r,o){N(n.rank<=4,function(){return"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"});var i=r.reduce(function(d,f){return d*f}),a=wf(n.shape,r,i),s=bf(a.length,r.length),u=Ef(n.shape,r,i),c=aR(o,r.length),l=sR(u,o,r.length);return n.reshape(a).transpose(s).reshape(u).slice(c,l)},e.prototype.spaceToBatchND=function(n,r,o){N(n.rank<=4,function(){return"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"});var i=r.reduce(function(f,h){return f*h}),a=[[0,0]];a.push.apply(a,o);for(var s=1+r.length;s<n.shape.length;++s)a.push([0,0]);var u=n.pad(a),c=wf(u.shape,r,i,!1),l=bf(c.length,r.length,!1),d=Ef(u.shape,r,i,!1);return u.reshape(c).transpose(l).reshape(d)},e.prototype.reduce=function(n,r,o){var i=n.shape[0],a=n.shape[1],s=Kp(a),u=new tV({windowSize:s,inSize:a,batchSize:i},r),c=this.compileAndRun(u,[n],o);return c.shape[1]===1?c:this.reduce(c,r,o)},e.prototype.argReduce=function(n,r,o){o===void 0&&(o=null);var i=n.shape[0],a=n.shape[1];o!=null&&(i=o.shape[0],a=o.shape[1]);var s=Kp(a),u=new W$({windowSize:s,inSize:a,batchSize:i},r,o==null),c=[n];o!=null&&c.push(o);var l=this.compileAndRun(u,c,"int32");return l.shape[1]===1?l:this.argReduce(n,r,l)},e.prototype.argReducePacked=function(n,r,o){o===void 0&&(o=null);var i=o!=null?o.shape:n.shape,a=Kp(i[i.length-1]),s=new K$(i,a,r,o==null),u=o==null?[n]:[n,o],c=this.compileAndRun(s,u,"int32");return c.rank===n.rank?this.argReducePacked(n,r,c):c},e.prototype.sum=function(n,r){Cn("sum",r,n.rank);var o=Ht(n.shape,r),i=o[0],a=le(o[1]),s=n.as2D(-1,a),u=jp(n.dtype);return this.reduce(s,"sum",u).reshape(i)},e.prototype.prod=function(n,r){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.prod(n,r);var o=Ht(n.shape,r),i=o[0],a=le(o[1]),s=n.as2D(-1,a),u=jp(n.dtype);return this.reduce(s,"prod",u).reshape(i)},e.prototype.unsortedSegmentSum=function(n,r,o){var i=0,a=Qr([i],n.rank),s=n;a!=null&&(s=n.transpose(a),i=Jr(1,n.rank)[0]);var u=function(h,m,p){for(var g=[],v=h.length,y=0;y<v;y++)y!==m?g.push(h[y]):g.push(p);return g}(s.shape,i,o),c=le([s.shape[i]]),l=s.as2D(-1,c),d=jp(n.dtype),f=this.segOpCompute(l,"unsortedSegmentSum",r,d,o).reshape(u);return a!=null&&(f=f.transpose(Hy(a))),f},e.prototype.segOpCompute=function(n,r,o,i,a){var s=n.shape[0],u=n.shape[1],c=function(f,h){var m,p=!1;for(f<=cR?(m=f,p=!0):m=jv(f,Math.floor(Math.sqrt(f)));!p;)m>h||m===f?p=!0:m=jv(f,m+1);return m}(u,a),l=new lV({windowSize:c,inSize:u,batchSize:s,numSegments:a}),d=this.compileAndRun(l,[n,o],i);return d.shape[1]===a?d:(o=xf(0,a).tile([u/c]),this.segOpCompute(d,r,o,i,a))},e.prototype.argMinMaxReduce=function(n,r,o){var i=[r];if(Cn("arg"+o.charAt(0).toUpperCase()+o.slice(1),i,n.rank),!K().getBool("WEBGL_PACK_REDUCE")||n.rank<=2){var a=Ht(n.shape,i),s=a[0],u=le(a[1]),c=n.as2D(-1,u);return this.argReduce(c,o).reshape(s)}return this.argReducePacked(n,o)},e.prototype.argMin=function(n,r){return this.argMinMaxReduce(n,r,"min")},e.prototype.argMax=function(n,r){return this.argMinMaxReduce(n,r,"max")},e.prototype.cumsum=function(n,r,o,i){if(r!==n.rank-1)throw new Error("WebGL cumsum shader expects an inner-most axis="+(n.rank-1)+" but got axis="+r);var a=new hz(n.shape,o,i);return this.compileAndRun(a,[n])},e.prototype.equal=function(n,r){if(K().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(equal(a, b));
`,"bool");var o=new at("return float(a == b);",n.shape,r.shape);return this.compileAndRun(o,[n,r],"bool")},e.prototype.notEqual=function(n,r){if(K().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(notEqual(a, b));
`,"bool");var o=new at("return float(a != b);",n.shape,r.shape);return this.compileAndRun(o,[n,r],"bool")},e.prototype.less=function(n,r){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.less(n,r);if(K().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(lessThan(a, b));
`,"bool");var o=new at("return float(a < b);",n.shape,r.shape);return this.compileAndRun(o,[n,r],"bool")},e.prototype.lessEqual=function(n,r){if(K().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(lessThanEqual(a, b));
`,"bool");var o=new at("return float(a <= b);",n.shape,r.shape);return this.compileAndRun(o,[n,r],"bool")},e.prototype.greater=function(n,r){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.greater(n,r);if(K().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(greaterThan(a, b));
`,"bool");var o=new at("return float(a > b);",n.shape,r.shape);return this.compileAndRun(o,[n,r],"bool")},e.prototype.greaterEqual=function(n,r){if(K().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(greaterThanEqual(a, b));
`,"bool");var o=new at("return float(a >= b);",n.shape,r.shape);return this.compileAndRun(o,[n,r],"bool")},e.prototype.logicalNot=function(n){var r=new Ie(n.shape,"return float(!(x >= 1.0));");return this.compileAndRun(r,[n])},e.prototype.logicalAnd=function(n,r){if(K().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,"bool");var o=new at("return float(a >= 1.0 && b >= 1.0);",n.shape,r.shape);return this.compileAndRun(o,[n,r],"bool")},e.prototype.logicalOr=function(n,r){if(K().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,"bool");var o=new at("return float(a >= 1.0 || b >= 1.0);",n.shape,r.shape);return this.compileAndRun(o,[n,r],"bool")},e.prototype.select=function(n,r,o){var i=new dV(n.rank,r.shape,r.rank);return this.compileAndRun(i,[n,r,o],Ot(r.dtype,o.dtype))},e.prototype.where=function(n){gf("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");var r=n.dataSync();return Zy(n.shape,r)},e.prototype.topk=function(n,r,o){return wR(n.dataSync(),n.shape,n.dtype,r)},e.prototype.min=function(n,r){Cn("min",r,n.rank);var o=Ht(n.shape,r),i=o[0],a=le(o[1]),s=n.as2D(-1,a);return this.reduce(s,"min",s.dtype).reshape(i)},e.prototype.minimum=function(n,r){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.minimum(n,r);var o=K().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ro(`
  vec4 result = vec4(min(a, b));
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new at(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return min(a, b);
`,n.shape,r.shape);return this.compileAndRun(o,[n,r])},e.prototype.mod=function(n,r){var o=K().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ro(`
  vec4 result = mod(a, b);
  vec4 isNaN = vec4(equal(b, vec4(0.0)));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new at(`if (b == 0.0) return NAN;
  return mod(a, b);`,n.shape,r.shape);return this.compileAndRun(o,[n,r])},e.prototype.max=function(n,r){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.max(n,r);Cn("max",r,n.rank);var o=Ht(n.shape,r),i=o[0],a=le(o[1]),s=n.as2D(-1,a);return this.reduce(s,"max",s.dtype).reshape(i)},e.prototype.maximum=function(n,r){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.maximum(n,r);var o=K().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ro(`
  vec4 result = vec4(max(a, b));
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new at(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return max(a, b);
`,n.shape,r.shape);return this.compileAndRun(o,[n,r])},e.prototype.all=function(n,r){Cn("all",r,n.rank);var o=Ht(n.shape,r),i=o[0],a=le(o[1]),s=n.as2D(-1,a);return this.reduce(s,"all",s.dtype).reshape(i)},e.prototype.any=function(n,r){Cn("any",r,n.rank);var o=Ht(n.shape,r),i=o[0],a=le(o[1]),s=n.as2D(-1,a);return this.reduce(s,"any",s.dtype).reshape(i)},e.prototype.realDivide=function(n,r){if(K().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,"float32",!0);var o=new at(`
if (a == b) {
  return 1.0;
};
return a / b;`,n.shape,r.shape);return this.compileAndRun(o,[n,r],"float32")},e.prototype.floorDiv=function(n,r){if(K().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,"int32");var o=new at(`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,n.shape,r.shape);return this.compileAndRun(o,[n,r],"int32")},e.prototype.add=function(n,r){if(n.dtype==="complex64"&&r.dtype==="complex64")return this.complexSeparableBinaryOp(n,r,qp);if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.add(n,r);var o=Ot(n.dtype,r.dtype);if(K().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,qp,o);var i=new at(qp,n.shape,r.shape);return this.compileAndRun(i,[n,r],o)},e.prototype.packedUnaryOp=function(n,r,o){var i=new Su(n.shape,r);return this.compileAndRun(i,[n],o)},e.prototype.packedBinaryOp=function(n,r,o,i,a){a===void 0&&(a=!1);var s=new ro(o,n.shape,r.shape,a);return this.compileAndRun(s,[n,r],i)},e.prototype.complexSeparableBinaryOp=function(n,r,o){var i=this,a=this.texData.get(n.dataId),s=this.texData.get(r.dataId),u=[[a.complexTensors.real,s.complexTensors.real],[a.complexTensors.imag,s.complexTensors.imag]].map(function(f){var h=f[0],m=f[1],p=i.makeComplexComponentTensorInfo(n,h),g=i.makeComplexComponentTensorInfo(r,m),v=new at(o,n.shape,r.shape);return i.compileAndRun(v,[p,g],Ot(h.dtype,m.dtype))}),c=u[0],l=u[1],d=this.complex(c,l);return c.dispose(),l.dispose(),d},e.prototype.makeComplexComponentTensorInfo=function(n,r){return{dataId:r.dataId,dtype:r.dtype,shape:n.shape}},e.prototype.addN=function(n){if(n.length===1)return n[0];if(n.length>K().get("WEBGL_MAX_TEXTURES_IN_SHADER")){var r=Math.floor(n.length/2),o=this.addN(n.slice(0,r)),i=this.addN(n.slice(r));return this.addN([o,i])}var a=n.map(function(c){return c.dtype}).reduce(function(c,l){return Ot(c,l)}),s=n.map(function(c){return c.shape}),u=K().getBool("WEBGL_PACK")?new U$(n[0].shape,s):new j$(n[0].shape,s);return this.compileAndRun(u,n,a)},e.prototype.subtract=function(n,r){if(n.dtype==="complex64"&&r.dtype==="complex64")return this.complexSeparableBinaryOp(n,r,Xp);if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.subtract(n,r);var o=Ot(n.dtype,r.dtype);if(K().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,Xp,n.dtype);var i=new at(Xp,n.shape,r.shape);return this.compileAndRun(i,[n,r],o)},e.prototype.pow=function(n,r){var o=K().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ro(`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  vec4 isNaN = vec4(lessThan(a, vec4(0.0))) * vec4(lessThan(floor(b), b));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new at(`
if(a < 0.0 && floor(b) < b){
  return NAN;
}
if (b == 0.0) {
  return 1.0;
}
return (round(mod(b, 2.0)) != 1) ?
    pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,n.shape,r.shape),i=Ot(n.dtype,r.dtype);return this.compileAndRun(o,[n,r],i)},e.prototype.ceil=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.ceil(n);if(K().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,pb,n.dtype);var r=new Ie(n.shape,pb);return this.compileAndRun(r,[n])},e.prototype.floor=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.floor(n);if(K().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,mb,n.dtype);var r=new Ie(n.shape,mb);return this.compileAndRun(r,[n])},e.prototype.sign=function(n){var r=new Ie(n.shape,`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`);return this.compileAndRun(r,[n])},e.prototype.isNaN=function(n){var r=new Ie(n.shape,"return float(isnan(x));");return this.compileAndRun(r,[n],"bool")},e.prototype.isInf=function(n){var r=new Ie(n.shape,"return float(isinf(x));");return this.compileAndRun(r,[n],"bool")},e.prototype.isFinite=function(n){var r=new Ie(n.shape,"return float(!isnan(x) && !isinf(x));");return this.compileAndRun(r,[n],"bool")},e.prototype.round=function(n){var r=new Ie(n.shape,`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`);return this.compileAndRun(r,[n])},e.prototype.exp=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.exp(n);if(K().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,vb,n.dtype);var r=new Ie(n.shape,vb);return this.compileAndRun(r,[n])},e.prototype.expm1=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.expm1(n);if(K().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,gb,n.dtype);var r=new Ie(n.shape,gb);return this.compileAndRun(r,[n])},e.prototype.softmax=function(n,r){var o=_t([r],n.shape),i=this.max(n,o),a=xn(i.shape,o),s=this.subtract(n,i.reshape(a)),u=this.exp(s),c=this.sum(u,o).reshape(a);return this.realDivide(u,c)},e.prototype.log=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.log(n);if(K().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,`
  vec4 result = log(x);
  vec4 isNaN = vec4(lessThan(x, vec4(0.0)));
  result.r = isNaN.r == 1.0 ? NAN : result.r;
  result.g = isNaN.g == 1.0 ? NAN : result.g;
  result.b = isNaN.b == 1.0 ? NAN : result.b;
  result.a = isNaN.a == 1.0 ? NAN : result.a;

  return result;
`,n.dtype);var r=new Ie(n.shape,`if (x < 0.0) return NAN;
  return log(x);`);return this.compileAndRun(r,[n])},e.prototype.log1p=function(n){var r=new Ie(n.shape,"return log(1.0 + x);");return this.compileAndRun(r,[n])},e.prototype.sqrt=function(n){var r=new Ie(n.shape,"return sqrt(x);");return this.compileAndRun(r,[n])},e.prototype.rsqrt=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.rsqrt(n);var r=new Ie(n.shape,"return inversesqrt(x);");return this.compileAndRun(r,[n])},e.prototype.reciprocal=function(n){var r=new Ie(n.shape,"return 1.0 / x;");return this.compileAndRun(r,[n])},e.prototype.relu=function(n){var r;return r=K().getBool("WEBGL_PACK")?new Su(n.shape,TR):new Ie(n.shape,kR),this.compileAndRun(r,[n])},e.prototype.relu6=function(n){var r;return r=K().getBool("WEBGL_PACK")?new Su(n.shape,NR):new Ie(n.shape,IR),this.compileAndRun(r,[n])},e.prototype.prelu=function(n,r){var o=K().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ro(SR,n.shape,r.shape):new at(_R,n.shape,r.shape);return this.compileAndRun(o,[n,r])},e.prototype.elu=function(n){if(K().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,AR,n.dtype);var r=new Ie(n.shape,RR);return this.compileAndRun(r,[n])},e.prototype.eluDer=function(n,r){var o=K().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ro(`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,n.shape,r.shape):new at("return (b >= 1.0) ? a : a * (b + 1.0);",n.shape,r.shape);return this.compileAndRun(o,[n,r])},e.prototype.selu=function(n){var r=new Ie(n.shape,wV);return this.compileAndRun(r,[n])},e.prototype.int=function(n){var r=new Ie(n.shape,"return float(int(x));");return this.compileAndRun(r,[n],"int32")},e.prototype.clip=function(n,r,o){var i,a=(i=K().getBool("WEBGL_PACK_CLIP")?new tz(n.shape):new ez(n.shape)).getCustomSetupFunc(r,o);return this.compileAndRun(i,[n],null,a)},e.prototype.abs=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.abs(n);if(K().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,fb,n.dtype);var r=new Ie(n.shape,fb);return this.compileAndRun(r,[n])},e.prototype.complexAbs=function(n){var r=this.texData.get(n.dataId),o=new nz(n.shape),i=[this.makeComplexComponentTensorInfo(n,r.complexTensors.real),this.makeComplexComponentTensorInfo(n,r.complexTensors.imag)];return this.compileAndRun(o,i)},e.prototype.sigmoid=function(n){var r=new Ie(n.shape,"return 1.0 / (1.0 + exp(-1.0 * x));");return this.compileAndRun(r,[n])},e.prototype.softplus=function(n){var r=new Ie(n.shape,`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`);return this.compileAndRun(r,[n])},e.prototype.sin=function(n){var r=new Ie(n.shape,bV);return this.compileAndRun(r,[n])},e.prototype.cos=function(n){var r=new Ie(n.shape,EV);return this.compileAndRun(r,[n])},e.prototype.tan=function(n){var r=new Ie(n.shape,"return tan(x);");return this.compileAndRun(r,[n])},e.prototype.asin=function(n){var r=new Ie(n.shape,CV);return this.compileAndRun(r,[n])},e.prototype.acos=function(n){var r=new Ie(n.shape,_V);return this.compileAndRun(r,[n])},e.prototype.atan=function(n){var r=new Ie(n.shape,SV);return this.compileAndRun(r,[n])},e.prototype.atan2=function(n,r){var o=K().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ro(`
  vec4 result = atan(a, b);
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new at(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return atan(a, b);
`,n.shape,r.shape);return this.compileAndRun(o,[n,r])},e.prototype.sinh=function(n){var r=new Ie(n.shape,`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`);return this.compileAndRun(r,[n])},e.prototype.cosh=function(n){var r=new Ie(n.shape,`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`);return this.compileAndRun(r,[n])},e.prototype.tanh=function(n){var r=new Ie(n.shape,`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`);return this.compileAndRun(r,[n])},e.prototype.asinh=function(n){var r=new Ie(n.shape,kV);return this.compileAndRun(r,[n])},e.prototype.acosh=function(n){var r=new Ie(n.shape,IV);return this.compileAndRun(r,[n])},e.prototype.atanh=function(n){var r=new Ie(n.shape,RV);return this.compileAndRun(r,[n])},e.prototype.erf=function(n){var r=new Ie(n.shape,`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = 0.3275911;
  float a1 = 0.254829592;
  float a2 = -0.284496736;
  float a3 = 1.421413741;
  float a4 = -1.453152027;
  float a5 = 1.061405429;

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`);return this.compileAndRun(r,[n])},e.prototype.step=function(n,r){var o=new Ie(n.shape,function(i){return i===void 0&&(i=0),Er+`
    return x > 0.0 ? 1.0 : float(`+i+`);
  `}(r));return this.compileAndRun(o,[n])},e.prototype.conv2dByMatMul=function(n,r,o,i,a,s){var u=n.shape,c=this.texData.get(n.dataId),l=o.inChannels,d=u[0]*u[1]*u[2],f=o.outChannels,h=o.dataFormat==="channelsLast",m=(d===1||f===1)&&l>1e3,p=u[2]%2!=0&&!!c.isPacked;if(m||!K().getBool("WEBGL_LAZILY_UNPACK")||!K().getBool("WEBGL_PACK_BINARY_OPERATIONS")||!p){var g=h?u[0]*u[1]*u[2]:u[0]*u[2]*u[3],v=this.reshape(n,[1,g,o.inChannels]),y=this.reshape(r,[1,o.inChannels,o.outChannels]);return this.reshape(this.fusedBatchMatMul({a:v,b:y,transposeA:!1,transposeB:!1,bias:i,activation:a,preluActivationWeights:s}),o.outShape)}var x=h?u[0]*u[1]*(u[2]+1):u[0]*u[2]*(u[3]+1),w={dataId:n.dataId,shape:[1,x,o.inChannels],dtype:n.dtype},E=c.shape;c.shape=c.shape.slice(),c.shape[c.shape.length-2]++,N(zl(c.shape,w.shape),function(){return"packed reshape "+c.shape+" to "+w.shape+" isn't free"});var _=this.reshape(r,[1,o.inChannels,o.outChannels]),S=this.fusedBatchMatMul({a:w,b:_,transposeA:!1,transposeB:!1,bias:i,activation:a,preluActivationWeights:s}),k=this.texData.get(S.dataId);return N(k.isPacked,function(){return"batchMatMul result is expected to be packed"}),c.shape=E,k.shape=o.outShape,L.makeTensorFromDataId(S.dataId,o.outShape,S.dtype)},e.prototype.conv2dWithIm2Row=function(n,r,o,i,a,s){var u=o.filterWidth,c=o.filterHeight,l=o.inChannels,d=o.outWidth,f=o.outHeight,h=o.dataFormat==="channelsLast",m=u*c*l,p=f*d,g=[m,p],v=n.squeeze([0]),y=r.reshape([1,m,-1]),x=new Vz(g,v.shape,o),w=this.compileAndRun(x,[v]).reshape([1,g[0],g[1]]),E=i!=null,_=s!=null,S=a?Kl(a,!0):null,k=new Yp(w.shape,[1,p,o.outChannels],!0,!1,E,S,_),I=[w,y];i&&I.push(i),_&&I.push(s);var R=this.compileAndRun(k,I);return h?R.reshape([1,f,d,o.outChannels]):R.reshape([1,o.outChannels,f,d])},e.prototype.fusedConv2d=function(n){var r=n.input,o=n.filter,i=n.convInfo,a=n.bias,s=n.activation,u=n.preluActivationWeights;if(i.filterHeight===1&&i.filterWidth===1&&i.dilationHeight===1&&i.dilationWidth===1&&i.strideHeight===1&&i.strideWidth===1&&(i.padInfo.type==="SAME"||i.padInfo.type==="VALID"))return this.conv2dByMatMul(r,o,i,a,s,u);if(K().getBool("WEBGL_CONV_IM2COL")&&r.shape[0]===1)return this.conv2dWithIm2Row(r,o,i,a,s,u);var c=a!=null,l=u!=null,d=s?Kl(s,!1):null,f=new rb(i,c,d,l),h=[r,o];return a&&h.push(a),u&&h.push(u),this.compileAndRun(f,h)},e.prototype.conv2d=function(n,r,o){if(o.filterHeight===1&&o.filterWidth===1&&o.dilationHeight===1&&o.dilationWidth===1&&o.strideHeight===1&&o.strideWidth===1&&(o.padInfo.type==="SAME"||o.padInfo.type==="VALID"))return this.conv2dByMatMul(n,r,o);if(K().getBool("WEBGL_CONV_IM2COL")&&n.shape[0]===1)return this.conv2dWithIm2Row(n,r,o);var i=new rb(o);return this.compileAndRun(i,[n,r])},e.prototype.conv2dDerInput=function(n,r,o){var i=new az(o);return this.compileAndRun(i,[n,r])},e.prototype.conv2dDerFilter=function(n,r,o){var i=new iz(o);return this.compileAndRun(i,[n,r])},e.prototype.fusedDepthwiseConv2D=function(n){var r,o=n.input,i=n.filter,a=n.convInfo,s=n.bias,u=n.activation,c=n.preluActivationWeights,l=K().getBool("WEBGL_PACK_DEPTHWISECONV")&&a.strideWidth<=2&&a.outChannels/a.inChannels==1,d=u?Kl(u,l):null,f=[o,i],h=s!=null,m=c!=null;return h&&f.push(s),m&&f.push(c),l?(r=new ib(a,h,d,m),this.compileAndRun(r,f)):(r=new ob(a,h,d,m),this.compileAndRun(r,f))},e.prototype.depthwiseConv2D=function(n,r,o){var i;return K().getBool("WEBGL_PACK_DEPTHWISECONV")&&o.strideWidth<=2&&o.outChannels/o.inChannels==1?(i=new ib(o),this.compileAndRun(i,[n,r])):(i=new ob(o),this.compileAndRun(i,[n,r]))},e.prototype.depthwiseConv2DDerInput=function(n,r,o){var i=new lz(o);return this.compileAndRun(i,[n,r])},e.prototype.depthwiseConv2DDerFilter=function(n,r,o){var i=new cz(o);return this.compileAndRun(i,[n,r])},e.prototype.conv3d=function(n,r,o){var i=new dz(o);return this.compileAndRun(i,[n,r])},e.prototype.conv3dDerInput=function(n,r,o){var i=new uz(o);return this.compileAndRun(i,[n,r])},e.prototype.conv3dDerFilter=function(n,r,o){var i=new sz(o);return this.compileAndRun(i,[n,r])},e.prototype.maxPool=function(n,r){var o=new Qp(r,"max",!1);return this.compileAndRun(o,[n])},e.prototype.avgPool=function(n,r){var o=new Qp(r,"avg",!1);return this.compileAndRun(o,[n],"float32")},e.prototype.maxPoolBackprop=function(n,r,o,i){var a=new Qp(i,"max",!0),s=this.compileAndRun(a,[r]),u=new qz(i),c=this.compileAndRun(u,[n,s],r.dtype);return s.dispose(),c},e.prototype.avgPoolBackprop=function(n,r,o){var i=new q$(o);return this.compileAndRun(i,[n],r.dtype)},e.prototype.cast=function(n,r){return mR(n,r,this)},e.prototype.unstack=function(n,r){for(var o=n.shape[r],i=new Array(n.rank-1),a=0,s=0;s<n.rank;s++)s!==r&&(i[a++]=n.shape[s]);var u=new Array(n.rank).fill(0),c=n.shape.slice();c[r]=1;var l=new Array(o);for(s=0;s<l.length;s++)u[r]=s,l[s]=this.slice(n,u,c).reshape(i);return l},e.prototype.avgPool3d=function(n,r){var o=new Jp(r,"avg",!1);return this.compileAndRun(o,[n],"float32")},e.prototype.avgPool3dBackprop=function(n,r,o){var i=new X$(o);return this.compileAndRun(i,[n],r.dtype)},e.prototype.maxPool3d=function(n,r){var o=new Jp(r,"max",!1);return this.compileAndRun(o,[n],"float32")},e.prototype.maxPool3dBackprop=function(n,r,o,i){var a=new Jp(i,"max",!0),s=this.compileAndRun(a,[r]),u=new Xz(i),c=this.compileAndRun(u,[n,s],r.dtype);return s.dispose(),c},e.prototype.reshape=function(n,r){var o=this.texData.get(n.dataId);if(o.isPacked&&!zl(n.shape,r)&&(o.texture===null||!zl(o.shape,r))){var i=this.packedReshape(n,r);return L.makeTensorFromDataId(i.dataId,i.shape,i.dtype)}return Kv(n,r)},e.prototype.resizeBilinear=function(n,r,o,i){var a=K().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new iV(n.shape,r,o,i):new oV(n.shape,r,o,i);return this.compileAndRun(a,[n],"float32")},e.prototype.resizeBilinearBackprop=function(n,r,o){var i=new rV(n,r,o);return this.compileAndRun(i,[n])},e.prototype.resizeNearestNeighbor=function(n,r,o,i){var a=new sV(n.shape,r,o,i);return this.compileAndRun(a,[n])},e.prototype.resizeNearestNeighborBackprop=function(n,r,o){var i=new aV(n,r,o);return this.compileAndRun(i,[n])},e.prototype.multinomial=function(n,r,o,i){var a=r?n:To(n),s=a.shape[0],u=a.shape[1],c=new Yz(s,u,o),l=c.getCustomSetupFunc(i);return this.compileAndRun(c,[a],"int32",l)},e.prototype.oneHot=function(n,r,o,i){var a=new Qz(n.size,r,o,i);return this.compileAndRun(a,[n])},e.prototype.diag=function(n){var r=new gz(n.size);return this.compileAndRun(r,[n])},e.prototype.nonMaxSuppression=function(n,r,o,i,a){return gf("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead"),Qy(n.dataSync(),r.dataSync(),o,i,a)},e.prototype.cropAndResize=function(n,r,o,i,a,s){var u=new fz(n.shape,r.shape,i,a,s);return this.compileAndRun(u,[n,r,o],"float32")},e.prototype.depthToSpace=function(n,r,o){N(r>1,function(){return"blockSize should be > 1 for depthToSpace, but was: "+r});var i=n.shape[0],a=o==="NHWC"?n.shape[1]:n.shape[2],s=o==="NHWC"?n.shape[2]:n.shape[3],u=o==="NHWC"?n.shape[3]:n.shape[1],c=a*r,l=s*r,d=u/(r*r),f=new vz(o==="NHWC"?[i,c,l,d]:[i,d,c,l],r,o);return this.compileAndRun(f,[n])},e.prototype.split=function(n,r,o){return yR(n,r,o)},e.prototype.scatterND=function(n,r,o){var i=Cf(0,n,o),a=i.sliceRank,s=i.numUpdates,u=i.sliceSize,c=i.strides,l=i.outputSize,d=[l/u,u],f=n.reshape([s,a]),h=r.reshape([s,u]);if(l===0)return Kv(Ft([]),o);var m=oe(0),p=new cb(s,a,f.rank,h.rank,c,d);return this.compileAndRun(p,[h,f,m]).reshape(o)},e.prototype.sparseToDense=function(n,r,o,i){var a=Cf(0,n,o),s=a.sliceRank,u=a.numUpdates,c=a.strides,l=a.outputSize,d=new cb(u,s,n.rank,r.rank,c,[l,1]);return this.compileAndRun(d,[r,n,i]).reshape(o)},e.prototype.fft=function(n){return this.fftImpl(n,!1)},e.prototype.ifft=function(n){return this.fftImpl(n,!0)},e.prototype.fftImpl=function(n,r){var o=this.texData.get(n.dataId),i=new sb(Ez,n.shape,r),a=new sb(Cz,n.shape,r),s=[this.makeComplexComponentTensorInfo(n,o.complexTensors.real),this.makeComplexComponentTensorInfo(n,o.complexTensors.imag)],u=this.compileAndRun(i,s),c=this.compileAndRun(a,s),l=this.complex(u,c).as2D(n.shape[0],n.shape[1]);return u.dispose(),c.dispose(),l},e.prototype.gatherND=function(n,r){var o=r.shape,i=o[o.length-1],a=uR(n,r),s=a[0],u=a[1],c=a[2],l=a[3],d=r.reshape([u,i]),f=n.reshape([n.size/c,c]),h=new kz(i,l,[u,c]);return this.compileAndRun(h,[f,d]).reshape(s)},e.prototype.fill=function(n,r,o){if((o=o||Zc(r))==="string"){var i=hf(o,le(n));return i.fill(r),L.makeTensor(i,n,o,this)}var a=new _z(n,r),s=a.getCustomSetupFunc(r);return this.compileAndRun(a,[],o,s)},e.prototype.onesLike=function(n){if(n.dtype==="string")throw new Error("onesLike is not supported under string dtype");return this.fill(n.shape,1,n.dtype)},e.prototype.zerosLike=function(n){return this.fill(n.shape,n.dtype==="string"?"":0,n.dtype)},e.prototype.linspace=function(n,r,o){return vR(n,r,o)},e.prototype.makeTensorInfo=function(n,r){var o=this.write(null,n,r);return this.texData.get(o).usage=null,{dataId:o,shape:n,dtype:r}},e.prototype.makeOutput=function(n,r){var o=this.makeTensorInfo(n,r).dataId;return L.makeTensorFromDataId(o,n,r,this)},e.prototype.unpackTensor=function(n){var r=new NV(n.shape);return this.runWebGLProgram(r,[n],n.dtype)},e.prototype.packTensor=function(n){var r=new Jz(n.shape);return this.runWebGLProgram(r,[n],n.dtype,null,!0)},e.prototype.packedReshape=function(n,r){var o=[mf(n.shape)].concat(vf(n.shape)),i={dtype:n.dtype,shape:o,dataId:n.dataId},a=[mf(r)].concat(vf(r)),s=new nV(a,o),u=this.runWebGLProgram(s,[i],n.dtype,null,!0);return{dataId:u.dataId,shape:r,dtype:u.dtype}},e.prototype.decode=function(n){var r,o=this.texData.get(n),i=o.isPacked,a=o.shape,s=o.dtype,u=Gp(a);return r=i?new mz(u):new pz(u),{dtype:s,shape:a,dataId:this.runWebGLProgram(r,[{shape:u,dtype:s,dataId:n}],s,null,!0).dataId}},e.prototype.runWebGLProgram=function(n,r,o,i,a){var s=this;a===void 0&&(a=!1);var u=this.makeTensorInfo(n.outputShape,o),c=this.texData.get(u.dataId);if(n.packedOutput&&(c.isPacked=!0),n.outPackingScheme===Sc.DENSE){var l=Hu(n.outputShape);c.texShape=l.map(function(x){return 2*x})}if(n.outTexUsage!=null&&(c.usage=n.outTexUsage),le(u.shape)===0)return c.values=Cc(u.dtype,0),u;var d=[],f=r.map(function(x){if(x.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");var w=s.texData.get(x.dataId);if(w.texture==null){if(!n.packedInputs&&le(x.shape)<=K().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:x.shape,texData:null,isUniform:!0,uniformValues:w.values};n.packedInputs&&(w.isPacked=!0,w.shape=x.shape)}else if(!!w.isPacked!=!!n.packedInputs)x=w.isPacked?s.unpackTensor(x):s.packTensor(x),d.push(x),w=s.texData.get(x.dataId);else if(w.isPacked&&!zl(w.shape,x.shape)){var E=x,_=x.shape;x.shape=w.shape,x=s.packedReshape(x,_),d.push(x),w=s.texData.get(x.dataId),E.shape=_}return s.uploadToGPU(x.dataId),{shape:x.shape,texData:w,isUniform:!1}});this.uploadToGPU(u.dataId);var h,m={shape:u.shape,texData:c,isUniform:!1},p=function(x,w,E){var _="";w.concat(E).forEach(function(I){var R=I.texData!=null&&I.texData.slice!=null&&I.texData.slice.flatOffset>0,D=I.isUniform?"uniform":I.texData.texShape;_+=I.shape+"_"+D+"_"+R});var S=x.userCode,k=x.constructor.name;return k+="_"+_+"_"+S}(n,f,m),g=this.getAndSaveBinary(p,function(){return function(x,w,E,_){var S=w.userCode,k=E.map(function(M,P){var B={logicalShape:M.shape,texShape:M.isUniform?null:M.texData.texShape,isUniform:M.isUniform,isPacked:!M.isUniform&&M.texData.isPacked,flatOffset:null};return M.texData!=null&&M.texData.slice!=null&&M.texData.slice.flatOffset>0&&(B.flatOffset=M.texData.slice.flatOffset),{name:w.variableNames[P],shapeInfo:B}}),I=k.map(function(M){return M.shapeInfo}),R={logicalShape:_.shape,texShape:_.texData.texShape,isUniform:!1,isPacked:_.texData.isPacked,flatOffset:null},D=$$(k,R,S,w.packedInputs),A=x.createProgram(D),j=null,F=x.getUniformLocation(A,"NAN",!1);K().getNumber("WEBGL_VERSION")===1&&(j=x.getUniformLocation(A,"INFINITY",!1));for(var W={},U=0;U<w.variableNames.length;U++){var $=w.variableNames[U];W[$]=x.getUniformLocation(A,$,!1),W["offset"+$]=x.getUniformLocation(A,"offset"+$,!1)}return{program:w,source:D,webGLProgram:A,uniformLocations:W,inShapeInfos:I,outShapeInfo:R,infLoc:j,nanLoc:F}}(s.gpgpu,n,f,m)}),v=this.activeTimers!=null;if(v&&(h=this.startTimer()),function(x,w,E,_,S){ub(w.inShapeInfos,E),ub([w.outShapeInfo],[_]);var k=_.texData.texture,I=_.texData.texShape;_.texData.isPacked?x.setOutputPackedMatrixTexture(k,I[0],I[1]):x.setOutputMatrixTexture(k,I[0],I[1]),x.setProgram(w.webGLProgram),K().getNumber("WEBGL_VERSION")===1&&w.infLoc!==null&&x.gl.uniform1f(w.infLoc,1/0),w.nanLoc!==null&&x.gl.uniform1f(w.nanLoc,NaN),E.forEach(function(R,D){var A=w.program.variableNames[D],j=w.uniformLocations[A],F=w.uniformLocations["offset"+A];if(j!=null)if(R.isUniform)if(le(R.shape)<2)x.gl.uniform1f(j,R.uniformValues[0]);else{var W=R.uniformValues;W instanceof Float32Array||(W=new Float32Array(W)),x.gl.uniform1fv(j,W)}else R.texData.slice!=null&&F!=null&&x.gl.uniform1i(F,R.texData.slice.flatOffset),x.setInputMatrixTexture(R.texData.texture,j,D)}),S!=null&&S(x,w.webGLProgram),x.executeProgram()}(this.gpgpu,g,f,m,i),d.forEach(function(x){return s.disposeData(x.dataId)}),v&&(h=this.endTimer(h),this.activeTimers.push({name:n.constructor.name,query:this.getQueryTime(h)})),!K().getBool("WEBGL_LAZILY_UNPACK")&&c.isPacked&&a===!1){var y=this.unpackTensor(u);return this.disposeData(u.dataId),y}return u},e.prototype.compileAndRun=function(n,r,o,i,a){a===void 0&&(a=!1),o=o||r[0].dtype;var s=this.runWebGLProgram(n,r,o,i,a);return L.makeTensorFromDataId(s.dataId,s.shape,s.dtype)},e.prototype.getAndSaveBinary=function(n,r){return n in this.binaryCache||(this.binaryCache[n]=r()),this.binaryCache[n]},e.prototype.getTextureManager=function(){return this.textureManager},e.prototype.dispose=function(){var n=this;this.disposed||(K().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(function(r){n.gpgpu.deleteProgram(n.binaryCache[r].webGLProgram),delete n.binaryCache[r]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)},e.prototype.floatPrecision=function(){var n=this;return this.floatPrecisionValue==null&&(this.floatPrecisionValue=ie(function(){if(!K().get("WEBGL_RENDER_FLOAT32_ENABLED")){var r=K().getBool("DEBUG");K().set("DEBUG",!1);var o=n.abs(oe(1e-8)).dataSync()[0];if(K().set("DEBUG",r),o>0)return 32}return 16})),this.floatPrecisionValue},e.prototype.epsilon=function(){return this.floatPrecision()===32?1e-7:1e-4},e.prototype.uploadToGPU=function(n){var r,o=this.texData.get(n),i=o.shape,a=o.dtype,s=o.values,u=o.texture,c=o.usage,l=o.isPacked;if(u==null){var d,f=this.activeTimers!=null;f&&(d=Ar());var h=o.texShape;if(h==null&&(h=BW(i,l),o.texShape=h),s!=null){var m=Gp(i),p=void 0,g=h[1],v=h[0],y=s instanceof Uint8Array;l?(g=(r=tl(h[0],h[1]))[0],v=r[1],p=new bz(m,[v,g],y)):p=new wz(m,[v,g],y);var x=this.makeTensorInfo([v,g],a);this.texData.get(x.dataId).usage=y?In.PIXELS:In.UPLOAD,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(x.dataId),g,v,s);var w=this.runWebGLProgram(p,[x],a,null,!0),E=this.texData.get(w.dataId);o.texture=E.texture,o.texShape=E.texShape,o.isPacked=E.isPacked,o.usage=E.usage,this.disposeData(x.dataId),this.texData.delete(w.dataId),o.values=null,f&&(this.uploadWaitMs+=Ar()-d)}else{var _=this.acquireTexture(h,c,a,l);o.texture=_}}},e.prototype.convertAndCacheOnCPU=function(n,r){var o=this.texData.get(n),i=o.dtype;return this.releaseGPUData(n),r!=null&&(o.values=function(a,s){if(s==="float32"||s==="complex64")return a;if(s==="int32"||s==="bool"){for(var u=s==="int32"?new Int32Array(a.length):new Uint8Array(a.length),c=0;c<u.length;++c)u[c]=Math.round(a[c]);return u}throw new Error("Unknown dtype "+s)}(r,i)),o.values},e.prototype.acquireTexture=function(n,r,o,i){if(this.numBytesInGPU+=this.computeBytes(n,o),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){var a=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: "+a+" MB, most likely due to a memory leak")}return this.textureManager.acquireTexture(n,r,i)},e.prototype.computeBytes=function(n,r){return n[0]*n[1]*VI(r)},e}(hR);QI()&&L.registerBackend("webgl",function(){return new PV},2);var DV=O({square_:function(t){var e=T(t,"x","square"),n=[e];return L.runKernelFunc(function(r,o){return o([e]),r.square(e)},{x:e},null,"Square",{},n,[])}}),Ic="SquaredDifference",PR=O({squaredDifference_:function(t,e){var n,r=T(t,"a","squaredDifference"),o=T(e,"b","squaredDifference");n=it(r,o),r=n[0],o=n[1],Ne(r.shape,o.shape);var i={a:r,b:o},a=[r,o];return L.runKernelFunc(function(s,u){var c=s.squaredDifference(r,o);return u([r,o]),c},i,function(s,u){var c=u[0],l=u[1],d=oe(2);return{a:function(){return s.mul(c.sub(l).mul(d))},b:function(){return s.mul(l.sub(c).mul(d))}}},Ic,{},a,[])}}),MV=O({abs_:function(t){var e=T(t,"x","abs");return e.dtype==="complex64"?L.runKernelFunc(function(n){return n.complexAbs(e)},{$x:e}):L.runKernelFunc(function(n,r){var o=n.abs(e);return r([e]),o},{x:e},function(n,r){var o=r[0];return{x:function(){return n.mul(o.toFloat().step(-1))}}},"Abs")}}),OV=O({acos_:function(t){var e=T(t,"x","acos");return L.runKernelFunc(function(n,r){var o=n.acos(e);return r([e]),o},{$x:e},function(n,r){var o=r[0];return{$x:function(){return n.divStrict(oe(1).sub(o.toFloat().square()).sqrt()).neg()}}})}}),FV=O({acosh_:function(t){var e=T(t,"x","acosh");return L.runKernelFunc(function(n,r){var o=n.acosh(e);return r([e]),o},{$x:e},function(n,r){var o=r[0];return{$x:function(){return n.divStrict(o.toFloat().square().sub(1).sqrt())}}})}}),LV=O({asin_:function(t){var e=T(t,"x","asin");return L.runKernelFunc(function(n,r){var o=n.asin(e);return r([e]),o},{$x:e},function(n,r){var o=r[0];return{$x:function(){return n.divStrict(oe(1).sub(o.toFloat().square()).sqrt())}}})}}),BV=O({asinh_:function(t){var e=T(t,"x","asinh");return L.runKernelFunc(function(n,r){var o=n.asinh(e);return r([e]),o},{$x:e},function(n,r){var o=r[0];return{$x:function(){return n.divStrict(oe(1).add(o.toFloat().square()).sqrt())}}})}}),jV=O({atan_:function(t){var e=T(t,"x","atan");return L.runKernelFunc(function(n,r){var o=n.atan(e);return r([e]),o},{$x:e},function(n,r){var o=r[0];return{$x:function(){return n.div(o.toFloat().square().add(1))}}})}}),UV=O({atanh_:function(t){var e=T(t,"x","atanh");return L.runKernelFunc(function(n,r){var o=n.atanh(e);return r([e]),o},{$x:e},function(n,r){var o=r[0];return{$x:function(){return n.div(oe(1).sub(o.toFloat().square()))}}})}}),WV=O({ceil_:function(t){var e=T(t,"x","ceil");return L.runKernelFunc(function(n){return n.ceil(e)},{$x:e},function(n){return{$x:function(){return Me(n)}}})}}),r0=O({clipByValue_:function(t,e,n){var r=T(t,"x","clipByValue");N(e<=n,function(){return"Error in clip: min ("+e+") must be less than or equal to max ("+n+")."});var o=[r],i={min:e,max:n};return L.runKernelFunc(function(a,s){var u=a.clip(r,e,n);return s([r]),u},{x:r},function(a,s){var u=s[0];return{x:function(){return a.where(u.greaterEqual(e).logicalAnd(u.lessEqual(n)),Me(a))}}},"ClipByValue",i,o)}}),$V=O({cos_:function(t){var e=T(t,"x","cos"),n=[e];return L.runKernelFunc(function(r,o){var i=r.cos(e);return o([e]),i},{x:e},function(r,o){var i=o[0];return{x:function(){return i.toFloat().sin().neg().mul(r)}}},"Cos",{},n)}}),zV=O({cosh_:function(t){var e=T(t,"x","cosh");return L.runKernelFunc(function(n,r){var o=n.cosh(e);return r([e]),o},{$x:e},function(n,r){var o=r[0];return{$x:function(){return o.toFloat().sinh().mulStrict(n)}}})}}),VV=O({erf_:function(t){var e=T(t,"x","erf");return N(e.dtype==="int32"||e.dtype==="float32",function(){return"Input dtype must be `int32` or `float32`."}),e.dtype==="int32"&&(e=e.toFloat()),L.runKernelFunc(function(n,r){var o=n.erf(e);return r([e]),o},{$x:e},function(n,r){var o=r[0];return{$x:function(){return n.mul(o.square().neg().exp().mul(2/Math.sqrt(Math.PI)))}}})}}),Xv=O({exp_:function(t){var e=T(t,"x","exp");return L.runKernelFunc(function(n,r){var o=n.exp(e);return r([o]),o},{x:e},function(n,r){return{x:function(){return n.mulStrict(r[0])}}},"Exp",{},[],[!0])}}),HV=O({expm1_:function(t){var e=T(t,"x","expm1");return L.runKernelFunc(function(n,r){var o=n.expm1(e);return r([e]),o},{$x:e},function(n,r){var o=r[0];return{$x:function(){return n.mul(o.exp())}}})}}),GV=O({floor_:function(t){var e=T(t,"x","floor");return L.runKernelFunc(function(n){return n.floor(e)},{$x:e},function(n){return{$x:function(){return Me(n)}}})}}),KV=O({log_:function(t){var e=T(t,"x","log"),n=[e];return L.runKernelFunc(function(r,o){var i=r.log(e);return o([e]),i},{x:e},function(r,o){var i=o[0];return{x:function(){return r.div(i.toFloat())}}},"Log",{},n)}}),qV=O({log1p_:function(t){var e=T(t,"x","log1p");return L.runKernelFunc(function(n,r){var o=n.log1p(e);return r([e]),o},{$x:e},function(n,r){var o=r[0];return{$x:function(){return n.div(o.add(1))}}})}}),XV=O({logSigmoid_:function(t){var e=T(t,"x","logSigmoid");return L.runKernelFunc(function(n,r){var o=n.softplus(e.neg()).neg();return r([e]),o},{$x:e},function(n,r){var o=r[0];return{$x:function(){return n.mul(o.neg().sigmoid())}}})}}),If=O({neg_:function(t){var e=T(t,"x","neg"),n=[e];return L.runKernelFunc(function(r){return r.neg(e)},{x:e},function(r){return{x:function(){return r.neg()}}},"Neg",{},n)}}),YV=O({reciprocal_:function(t){var e=T(t,"x","reciprocal");return L.runKernelFunc(function(n,r){var o=n.reciprocal(e);return r([e]),o},{$x:e},function(n,r){var o=r[0];return{$x:function(){return n.div(o.square().neg())}}})}}),QV=O({round_:function(t){var e=T(t,"x","round");return L.runKernelFunc(function(n){return n.round(e)},{$x:e},function(n){return{$x:function(){return Me(n)}}})}}),DR=O({rsqrt_:function(t){var e=T(t,"x","rsqrt"),n=[e];return L.runKernelFunc(function(r,o){var i=r.rsqrt(e);return o([e]),i},{x:e},function(r,o){var i=o[0];return{x:function(){return r.div(i.pow(1.5).mul(2)).neg()}}},"Rsqrt",{},n)}}),MR=O({sigmoid_:function(t){var e=T(t,"x","sigmoid");return L.runKernelFunc(function(n,r){var o=n.sigmoid(e);return r([o]),o},{x:e},function(n,r){var o=r[0];return{x:function(){return n.mul(o.mul(oe(1).sub(o)))}}},"Sigmoid")}}),JV=O({sign_:function(t){var e=T(t,"x","sign");return L.runKernelFunc(function(n){return n.sign(e)},{$x:e},function(n){return{$x:function(){return Me(n)}}})}}),ZV=O({isNaN_:function(t){var e=T(t,"x","isNaN");return L.runKernelFunc(function(n){return n.isNaN(e)},{$x:e},function(n){return{$x:function(){return Me(n)}}})}}),eH=O({isInf_:function(t){var e=T(t,"x","isInf");return L.runKernelFunc(function(n){return n.isInf(e)},{$x:e},function(n){return{$x:function(){return Me(n)}}})}}),tH=O({isFinite_:function(t){var e=T(t,"x","isFinite");return L.runKernelFunc(function(n){return n.isFinite(e)},{$x:e},function(n){return{$x:function(){return Me(n)}}})}}),nH=O({sin_:function(t){var e=T(t,"x","sin"),n=[e];return L.runKernelFunc(function(r,o){var i=r.sin(e);return o([e]),i},{x:e},function(r,o){var i=o[0];return{x:function(){return i.toFloat().cos().mul(r)}}},"Sin",{},n)}}),rH=O({sinh_:function(t){var e=T(t,"x","sinh");return L.runKernelFunc(function(n,r){var o=n.sinh(e);return r([e]),o},{$x:e},function(n,r){var o=r[0];return{$x:function(){return o.toFloat().cosh().mulStrict(n)}}})}}),oH=O({softplus_:function(t){var e=T(t,"x","softplus");return L.runKernelFunc(function(n,r){var o=n.softplus(e);return r([e]),o},{$x:e},function(n,r){var o=r[0];return{$x:function(){return n.mul(o.sigmoid())}}})}}),iH=O({sqrt_:function(t){var e=T(t,"x","sqrt");return L.runKernelFunc(function(n,r){var o=n.sqrt(e);return r([e]),o},{$x:e},function(n,r){var o=r[0];return{$x:function(){return n.div(o.toFloat().sqrt().mul(2))}}})}}),aH=O({step_:function(t,e){e===void 0&&(e=0);var n=T(t,"x","step");return L.runKernelFunc(function(r){return r.step(n,e)},{$x:n},function(r){return{$x:function(){return Me(r)}}})}}),sH=O({tan_:function(t){var e=T(t,"x","tan");return L.runKernelFunc(function(n,r){var o=n.tan(e);return r([e]),o},{$x:e},function(n,r){var o=r[0];return{$x:function(){return n.div(o.cos().square())}}})}}),uH=O({tanh_:function(t){var e=T(t,"x","tanh");return L.runKernelFunc(function(n,r){var o=n.tanh(e);return r([o]),o},{x:e},function(n,r){var o=r[0];return{x:function(){return oe(1).sub(o.square()).mulStrict(n)}}},"Tanh",{},null,[!0])}});function OR(t,e,n,r,o,i){var a,s,u=T(t,"x","batchNorm"),c=T(e,"mean","batchNorm"),l=T(n,"variance","batchNorm");return o!=null&&(a=T(o,"scale","batchNorm")),r!=null&&(s=T(r,"offset","batchNorm")),N(u.rank===2,function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+u.rank+"."}),N(c.rank===2||c.rank===1,function(){return"Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank "+c.rank+"."}),N(l.rank===2||l.rank===1,function(){return"Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank "+l.rank+"."}),a!=null&&N(a.rank===2||a.rank===1,function(){return"Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank "+a.rank+"."}),s!=null&&N(s.rank===2||s.rank===1,function(){return"Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank "+s.rank+"."}),rl(u,c,l,s,a,i)}function FR(t,e,n,r,o,i){var a,s,u=T(t,"x","batchNorm"),c=T(e,"mean","batchNorm"),l=T(n,"variance","batchNorm");return o!=null&&(a=T(o,"scale","batchNorm")),r!=null&&(s=T(r,"offset","batchNorm")),N(u.rank===3,function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+u.rank+"."}),N(c.rank===3||c.rank===1,function(){return"Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank "+c.rank+"."}),N(l.rank===3||l.rank===1,function(){return"Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank "+l.rank+"."}),a!=null&&N(a.rank===3||a.rank===1,function(){return"Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank "+a.rank+"."}),s!=null&&N(s.rank===3||s.rank===1,function(){return"Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank "+s.rank+"."}),rl(u,c,l,s,a,i)}function LR(t,e,n,r,o,i){var a,s,u=T(t,"x","batchNorm"),c=T(e,"mean","batchNorm"),l=T(n,"variance","batchNorm");return o!=null&&(a=T(o,"scale","batchNorm")),r!=null&&(s=T(r,"offset","batchNorm")),N(u.rank===4,function(){return"Error in batchNorm4D: x must be rank 4 but got rank "+u.rank+"."}),N(c.rank===4||c.rank===1,function(){return"Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank "+c.rank+"."}),N(l.rank===4||l.rank===1,function(){return"Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank "+l.rank+"."}),a!=null&&N(a.rank===4||a.rank===1,function(){return"Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank "+a.rank+"."}),s!=null&&N(s.rank===4||s.rank===1,function(){return"Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank "+s.rank+"."}),rl(u,c,l,s,a,i)}function rl(t,e,n,r,o,i){i==null&&(i=.001);var a,s,u,c=T(t,"x","batchNorm"),l=T(e,"mean","batchNorm"),d=T(n,"variance","batchNorm");o!=null&&(a=T(o,"scale","batchNorm")),r!=null&&(s=T(r,"offset","batchNorm")),N(l.rank===d.rank,function(){return"Batch normalization gradient requires mean and variance to have equal ranks."}),N(s==null||l.rank===s.rank,function(){return"Batch normalization gradient requires mean and offset to have equal ranks."}),N(a==null||l.rank===a.rank,function(){return"Batch normalization gradient requires mean and scale to have equal ranks."}),u=c.rank===0||c.rank===1?c.as4D(1,1,1,c.size):c.rank===2?c.as4D(1,1,c.shape[0],c.shape[1]):c.rank===3?c.as4D(1,c.shape[0],c.shape[1],c.shape[2]):c;var f=[c,l,d,a];return L.runKernelFunc(function(h,m){var p=h.batchNormalization(u,ql(l),ql(d),i,ql(a),ql(s));return m([c,l,d,a]),p},{x:c,mean:l,variance:d,scale:a,offset:s},function(h,m){var p=m,g=p[0],v=p[1],y=p[2],x=p[3],w=x??oe(1),E=Et(v.shape,u.shape),_=[];if(v.rank===1){for(var S=0;S<u.shape.length-1;++S)_.push(u.shape[S]);_.push(1)}var k=g.sub(v),I=h.mul(w),R=DR(y.add(oe(i))),D=R.mul(R).mul(R).mul(oe(-.5));return{x:function(){return v.rank===1?h.mul(xs(R.as4D(1,1,1,v.shape[0]),_)).mul(w).reshape(g.shape):h.mul(R).mul(w).reshape(g.shape)},mean:function(){var A=R.mul(oe(-1)).mul(I);return v.rank===1&&(A=A.sum(E)),A.reshape(v.shape)},variance:function(){var A=D.mul(k).mul(I);return v.rank===1&&(A=A.sum(E)),A.reshape(v.shape)},scale:function(){var A=k.mul(R),j=h.mul(A);return v.rank===1&&(j=j.sum(E)),j.reshape(v.shape)},offset:function(){var A=h;return v.rank===1&&(A=A.sum(E)),A.reshape(v.shape)}}},"BatchNormalization",{varianceEpsilon:i},f).reshape(c.shape)}function ql(t){return t==null?null:t.rank===0?t.as1D():t.rank===1?t:t.rank===2?t.as4D(1,1,t.shape[0],t.shape[1]):t.rank===3?t.as4D(1,t.shape[0],t.shape[1],t.shape[2]):t}function kh(){JI("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon")}var cH=O({batchNormalization2d_:function(t,e,n,r,o,i){return r===void 0&&(r=.001),kh(),OR(t,e,n,i,o,r)}}),lH=O({batchNormalization3d_:function(t,e,n,r,o,i){return r===void 0&&(r=.001),kh(),FR(t,e,n,i,o,r)}}),dH=O({batchNormalization4d_:function(t,e,n,r,o,i){return r===void 0&&(r=.001),kh(),LR(t,e,n,i,o,r)}}),fH=O({batchNormalization_:function(t,e,n,r,o,i){return r===void 0&&(r=.001),kh(),rl(t,e,n,i,o,r)}}),BR=O({batchNorm_:rl}),hH=O({batchNorm2d_:OR}),pH=O({batchNorm3d_:FR}),mH=O({batchNorm4d_:LR}),Ih=O({logicalAnd_:function(t,e){var n=T(t,"a","logicalAnd","bool"),r=T(e,"b","logicalAnd","bool");return Ne(n.shape,r.shape),L.runKernelFunc(function(o){return o.logicalAnd(n,r)},{a:n,b:r},null,"LogicalAnd")}}),vH=O({logicalNot_:function(t){var e=T(t,"x","logicalNot","bool");return L.runKernelFunc(function(n){return n.logicalNot(e)},{$x:e})}}),jR=O({logicalOr_:function(t,e){var n=T(t,"a","logicalOr","bool"),r=T(e,"b","logicalOr","bool");return Ne(n.shape,r.shape),L.runKernelFunc(function(o){return o.logicalOr(n,r)},{$a:n,$b:r})}}),gH=O({logicalXor_:function(t,e){var n=T(t,"a","logicalXor","bool"),r=T(e,"b","logicalXor","bool");return Ne(n.shape,r.shape),jR(t,e).logicalAnd(Ih(t,e).logicalNot())}}),ga=O({where_:function(t,e,n){var r=T(e,"a","where"),o=T(n,"b","where"),i=T(t,"condition","where","bool");return We(r.shape,o.shape,"Error in where: "),i.rank===1?N(i.shape[0]===r.shape[0],function(){return"The first dimension of `a` must match the size of `condition`."}):We(i.shape,o.shape,"Error in where: "),L.runKernelFunc(function(a,s){var u=a.select(i,r,o);return s([i]),u},{$condition:i,$a:r,$b:o},function(a,s){var u=s[0];return{$condition:function(){return Me(u).toFloat()},$a:function(){return a.mul(u.cast(a.dtype))},$b:function(){return a.mul(u.logicalNot().cast(a.dtype))}}})}}),UR=function(t){return ue(this,void 0,void 0,function(){var e,n,r;return ce(this,function(o){switch(o.label){case 0:return[4,(e=T(t,"condition","whereAsync","bool")).data()];case 1:return n=o.sent(),r=Zy(e.shape,n),t!==e&&e.dispose(),[2,r]}})})},Re=O({add_:function(t,e){var n,r=T(t,"a","add"),o=T(e,"b","add");n=it(r,o),r=n[0],o=n[1];var i=Ne(r.shape,o.shape);return L.runKernelFunc(function(a){return a.add(r,o)},{a:r,b:o},function(a){return{a:function(){var s=a,u=Et(r.shape,i);return u.length>0&&(s=s.sum(u)),s.reshape(r.shape)},b:function(){var s=a,u=Et(o.shape,i);return u.length>0&&(s=s.sum(u)),s.reshape(o.shape)}}},"Add")}}),yH=O({addN_:function(t){N(Array.isArray(t),function(){return"The argument passed to tf.addN() must be a list of tensors"}),N(t.length>=1,function(){return"Must pass at least one tensor to tf.addN(), but got "+t.length});var e=t.map(function(o,i){return T(o,"tensors"+i,"addN")}),n=e[0];e.forEach(function(o){if(o.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),e.forEach(function(o){if(!Nt(o.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});var r=e;return L.runKernelFunc(function(o){return o.addN(e)},r,function(o){var i={};return e.forEach(function(a,s){i[s]=function(){return o.clone()}}),i},"AddN")}}),xH=O({addStrict_:function(t,e){var n=T(t,"a","addStrict"),r=T(e,"b","addStrict");return We(n.shape,r.shape,"Error in addStrict: "),n.add(r)}}),wH=O({atan2_:function(t,e){var n,r=T(t,"a","atan2"),o=T(e,"b","atan2");n=it(r,o),r=n[0],o=n[1];var i=Ne(r.shape,o.shape);return L.runKernelFunc(function(a,s){var u=a.atan2(r,o);return s([r,o]),u},{$a:r,$b:o},function(a,s){var u=s[0],c=s[1];return{$a:function(){var l=Re(u.square(),c.square()),d=a.mul(c.div(l)),f=Et(u.shape,i);return f.length>0&&(d=d.sum(f)),d.reshape(u.shape)},$b:function(){var l=Re(u.square(),c.square()),d=If(a.mul(u.div(l))),f=Et(c.shape,i);return f.length>0&&(d=d.sum(f)),d.reshape(c.shape)}}})}}),lr=O({div_:function(t,e){var n,r=T(t,"a","div"),o=T(e,"b","div");if(n=it(r,o),r=n[0],o=n[1],r.dtype==="int32"&&o.dtype==="int32")return WR(r,o);var i=Ne(r.shape,o.shape);return L.runKernelFunc(function(a,s){var u=a.realDivide(r,o);return s([r,o]),u},{a:r,b:o},function(a,s){var u=s[0],c=s[1];return{a:function(){var l=a.div(c.toFloat()),d=Et(u.shape,i);return d.length>0?l.sum(d).reshape(u.shape):l},b:function(){var l=a.mul(u.toFloat()),d=Et(c.shape,i);d.length>0&&(l=l.sum(d).reshape(c.shape));var f=c.square();return l.div(f.toFloat()).neg()}}},"Div")}}),bH=O({divNoNan_:function(t,e){var n,r=T(t,"a","div"),o=T(e,"b","div");r=(n=it(r,o))[0],o=n[1];var i=lr(r,o),a=Me(i),s=o.equal(a);return ga(s,a,i)}}),EH=O({divStrict_:function(t,e){var n=T(t,"a","div"),r=T(e,"b","div");return We(n.shape,r.shape,"Error in divideStrict: "),n.div(r)}}),WR=O({floorDiv_:function(t,e){var n,r=T(t,"a","floorDiv"),o=T(e,"b","floorDiv");n=it(r,o),r=n[0],o=n[1];var i=Ne(r.shape,o.shape);return L.runKernelFunc(function(a,s){var u=a.floorDiv(r,o);return s([r,o]),u},{a:r,b:o},function(a,s){var u=s[0],c=s[1];return{a:function(){var l=a.div(c.toFloat()),d=Et(u.shape,i);return d.length>0?l.sum(d).reshape(u.shape):l},b:function(){var l=a.mul(u.toFloat()),d=Et(c.shape,i);d.length>0&&(l=l.sum(d).reshape(c.shape));var f=c.square();return l.div(f.toFloat()).neg()}}},"FloorDiv")}}),o0=O({maximum_:function(t,e){var n,r=T(t,"a","maximum"),o=T(e,"b","maximum");return n=it(r,o),r=n[0],o=n[1],r.dtype==="bool"&&(r=r.toInt(),o=o.toInt()),Ne(r.shape,o.shape),L.runKernelFunc(function(i,a){var s=i.maximum(r,o);return a([r,o]),s},{a:r,b:o},function(i,a){var s=a[0],u=a[1];return{a:function(){return i.mul(s.greaterEqual(u).toFloat())},b:function(){return i.mul(s.less(u).toFloat())}}},"Maximum")}}),CH=O({maximumStrict_:function(t,e){var n=T(t,"a","maximumStrict"),r=T(e,"b","maximumStrict");return We(n.shape,r.shape,"Error in maximumStrict: "),n.maximum(r)}}),$R=O({minimum_:function(t,e){var n,r=T(t,"a","minimum"),o=T(e,"b","minimum");return n=it(r,o),r=n[0],o=n[1],r.dtype==="bool"&&(r=r.toInt(),o=o.toInt()),Ne(r.shape,o.shape),L.runKernelFunc(function(i,a){var s=i.minimum(r,o);return a([r,o]),s},{a:r,b:o},function(i,a){var s=a[0],u=a[1];return{a:function(){return i.mul(s.lessEqual(u).toFloat())},b:function(){return i.mul(s.greater(u).toFloat())}}},"Minimum")}}),_H=O({minimumStrict_:function(t,e){var n=T(t,"a","minimumStrict"),r=T(e,"b","minimumStrict");return We(n.shape,r.shape,"Error in minimumStrict: "),n.minimum(r)}}),SH=O({mod_:function(t,e){var n,r=T(t,"a","mod"),o=T(e,"b","mod");n=it(r,o),r=n[0],o=n[1];var i=Ne(r.shape,o.shape);return L.runKernelFunc(function(a,s){var u=a.mod(r,o);return s([r,o]),u},{$a:r,$b:o},function(a,s){var u=s[0],c=s[1];return{$a:function(){var l=Et(u.shape,i);return l.length>0?a.sum(l).reshape(u.shape):a},$b:function(){var l=a.mul(u.div(c).floor().neg()),d=Et(c.shape,i);return d.length>0?l.sum(d).reshape(c.shape):l}}})}}),kH=O({modStrict_:function(t,e){var n=T(t,"a","modStrict"),r=T(e,"b","modStrict");return We(n.shape,r.shape,"Error in modStrict: "),n.mod(r)}}),Yt=O({mul_:function(t,e){var n,r=T(t,"a","mul"),o=T(e,"b","mul");n=it(r,o),r=n[0],o=n[1];var i=Ne(r.shape,o.shape);return L.runKernelFunc(function(a,s){var u=a.multiply(r,o);return s([r,o]),u},{a:r,b:o},function(a,s){var u=s[0],c=s[1];return{a:function(){var l=a.mul(c.toFloat()),d=Et(u.shape,i);return d.length>0?l.sum(d).reshape(u.shape):l},b:function(){var l=a.mul(u.toFloat()),d=Et(c.shape,i);return d.length>0?l.sum(d).reshape(c.shape):l}}},"Mul")}}),IH=O({mulStrict_:function(t,e){var n=T(t,"a","mul"),r=T(e,"b","mul");return We(n.shape,r.shape,"Error in multiplyStrict: "),n.mul(r)}}),Rf=O({pow_:function(t,e){var n,r=T(t,"base","pow"),o=T(e,"exp","pow");n=it(r,o),r=n[0],o=n[1];var i=Ne(r.shape,o.shape),a=[r,o];return L.runKernelFunc(function(s,u){var c=s.pow(r,o);return u([r,o,c]),c},{a:r,b:o},function(s,u){var c=u[0],l=u[1],d=u[2];return{a:function(){var f=l.toFloat(),h=s.mul(f.mul(c.pow(f.sub(oe(1))))),m=Et(c.shape,i);return m.length>0&&(h=h.sum(m)),h.reshape(c.shape)},b:function(){var f=c.greater(0),h=c.log().where(f,Me(c)),m=s.mul(d.mul(h)),p=Et(l.shape,i);return p.length>0&&(m=m.sum(p)),m.reshape(l.shape)}}},"Pow",{},a,[!0])}}),RH=O({powStrict_:function(t,e){return We(t.shape,e.shape,"Error in powStrict: "),t.pow(e)}}),TH=O({squaredDifferenceStrict_:function(t,e){var n=T(t,"a","squaredDifferenceStrict"),r=T(e,"b","squaredDifferenceStrict");return We(n.shape,r.shape,"Error in squaredDifferenceStrict: "),n.squaredDifference(r)}}),Ct=O({sub_:function(t,e){var n,r=T(t,"a","sub"),o=T(e,"b","sub");n=it(r,o),r=n[0],o=n[1];var i=Ne(r.shape,o.shape);return L.runKernelFunc(function(a){return a.subtract(r,o)},{a:r,b:o},function(a){return{a:function(){var s=a,u=Et(r.shape,i);return u.length>0&&(s=s.sum(u)),s.reshape(r.shape)},b:function(){var s=a,u=Et(o.shape,i);return u.length>0&&(s=s.sum(u)),s.neg().reshape(o.shape)}}},"Sub")}}),NH=O({subStrict_:function(t,e){var n=T(t,"a","subStrict"),r=T(e,"b","subStrict");return We(n.shape,r.shape,"Error in subStrict: "),n.sub(r)}}),zR=O({equal_:function(t,e){var n,r=T(t,"a","equal"),o=T(e,"b","equal");return n=it(r,o),r=n[0],o=n[1],Ne(r.shape,o.shape),L.runKernelFunc(function(i){return i.equal(r,o)},{$a:r,$b:o})}}),AH=O({equalStrict_:function(t,e){var n=T(t,"a","equalStrict"),r=T(e,"b","equalStrict");return We(n.shape,r.shape,"Error in equalStrict: "),n.equal(r)}}),PH=O({greater_:function(t,e){var n,r=T(t,"a","greater"),o=T(e,"b","greater");return n=it(r,o),r=n[0],o=n[1],Ne(r.shape,o.shape),L.runKernelFunc(function(i){return i.greater(r,o)},{a:r,b:o},null,"Greater")}}),VR=O({greaterEqual_:function(t,e){var n,r=T(t,"a","greaterEqual"),o=T(e,"b","greaterEqual");return n=it(r,o),r=n[0],o=n[1],Ne(r.shape,o.shape),L.runKernelFunc(function(i,a){var s=i.greaterEqual(r,o);return a([r,o]),s},{a:r,b:o},function(i,a){var s=a[0],u=a[1];return{a:function(){return Me(s)},b:function(){return Me(u)}}},"GreaterEqual")}}),DH=O({greaterEqualStrict_:function(t,e){var n=T(t,"a","greaterEqualStrict"),r=T(e,"b","greaterEqualStrict");return We(n.shape,r.shape,"Error in greaterEqualStrict: "),n.greaterEqual(r)}}),MH=O({greaterStrict_:function(t,e){var n=T(t,"a","greaterStrict"),r=T(e,"b","greaterStrict");return We(n.shape,r.shape,"Error in greaterStrict: "),n.greater(r)}}),OH=O({less_:function(t,e){var n,r=T(t,"a","less"),o=T(e,"b","less");return n=it(r,o),r=n[0],o=n[1],Ne(r.shape,o.shape),L.runKernelFunc(function(i){return i.less(r,o)},{a:r,b:o},null,"Less")}}),FH=O({lessEqual_:function(t,e){var n,r=T(t,"a","lessEqual"),o=T(e,"b","lessEqual");return n=it(r,o),r=n[0],o=n[1],Ne(r.shape,o.shape),L.runKernelFunc(function(i,a){var s=i.lessEqual(r,o);return a([r,o]),s},{a:r,b:o},null,"LessEqual")}}),LH=O({lessEqualStrict_:function(t,e){var n=T(t,"a","lessEqualStrict"),r=T(e,"b","lessEqualStrict");return We(n.shape,r.shape,"Error in lessEqualStrict: "),n.lessEqual(r)}}),BH=O({lessStrict_:function(t,e){var n=T(t,"a","lessStrict"),r=T(e,"b","lessStrict");return We(n.shape,r.shape,"Error in lessStrict: "),n.less(r)}}),jH=O({notEqual_:function(t,e){var n,r=T(t,"a","notEqual"),o=T(e,"b","notEqual");return n=it(r,o),r=n[0],o=n[1],Ne(r.shape,o.shape),L.runKernelFunc(function(i){return i.notEqual(r,o)},{a:r,b:o},null,"NotEqual")}}),UH=O({notEqualStrict_:function(t,e){var n=T(t,"a","notEqualStrict"),r=T(e,"b","notEqualStrict");return We(n.shape,r.shape,"Error in notEqualStrict: "),n.notEqual(r)}});function yb(t,e){for(var n=[],r=t;r<e;++r)n.push(r);return n}function xb(t){for(var e=[],n=0;n<t.length;++n)for(var r=0;r<t[n].length;++r)e.push(t[n][r]);return e}var i0=O({gather_:function(t,e,n){n===void 0&&(n=0);var r=T(t,"x","gather"),o=T(e,"indices","gather","int32");n=_t(n,r.shape)[0];var i=function(a,s,u){for(var c=a.shape[u],l=[],d=1,f=1,h=0;h<u;h++)l.push(a.shape[h]),d*=a.shape[h];for(h=0;h<s.rank;h++)l.push(s.shape[h]);for(h=u+1;h<a.rank;h++)l.push(a.shape[h]),f*=a.shape[h];return{batchSize:d,sliceSize:f,dimSize:c,outputShape:l}}(r,o,n);return L.runKernelFunc(function(a,s){var u=a.gather(r,o.flatten(),n);return s([o]),u},{x:r,indices:o},function(a,s){var u=s[0];return{x:function(){var c=r.shape,l=u.size,d=c.slice(0,n),f=d.length,h=c.slice(n,c.length).slice(1),m=h.length,p=yb(0,f),g=yb(f+1,f+1+m),v=xb([d,[l],h]),y=a.reshape(v),x=u.reshape([l]),w=xb([[f],p,g]),E=y.transpose(w),_=HR(E,x,r.shape[n]),S=Hy(w);return _=_.transpose(S)},indices:function(){return u}}},"Gather",{axis:n}).reshape(i.outputShape)}}),HR=O({unsortedSegmentSum_:function(t,e,n){var r=T(t,"x","unsortedSegmentSum"),o=T(e,"segmentIds","unsortedSegmentSum","int32");return N(ft(n),function(){return"numSegments must be of dtype int"}),L.runKernelFunc(function(i,a){var s=i.unsortedSegmentSum(r,o,n);return a([o]),s},{$x:r},function(i,a){var s=a[0];return{$x:function(){return function(u,c){for(var l=o0(c,Me(c)),d=i0(u,l),f=VR(c,oe(0,"int32")),h=d.rank-f.rank,m=0;m<h;++m)f=Wn(f,m+1);f=Ih(f,lu(d.shape,"bool"));var p=Me(d);return ga(f,d,p)}(i,s)}}})}}),WH=function(t,e,n){return ue(this,void 0,void 0,function(){var r,o,i,a,s,u,c,l,d,f,h,m,p;return ce(this,function(g){switch(g.label){case 0:for(r=T(t,"tensor","boolMask"),o=T(e,"mask","boolMask","bool"),i=n??0,a=o.rank,s=r.shape,N(a>0,function(){return"mask cannot be scalar"}),We(s.slice(i,i+a),o.shape,"mask's shape must match the first K dimensions of tensor's shape,"),u=1,c=i;c<i+a;c++)u*=s[c];return l=s.slice(0,i).concat([u],s.slice(i+a)),d=r.reshape(l),f=o.reshape([-1]),[4,UR(f)];case 1:return h=g.sent(),m=h.squeeze([1]),p=i0(d,m,i),t!==r&&r.dispose(),e!==o&&o.dispose(),m.dispose(),d.dispose(),f.dispose(),h.dispose(),[2,p]}})})};function GR(t,e,n,r,o,i,a){i===void 0&&(i="NHWC"),N(t.length===e.rank,function(){return"Length of inShape ("+t.length+") and rank of dy ("+e.rank+") must match"});var s=t,u=e,c=!1;e.rank===3&&(c=!0,u=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]),s=[1,t[0],t[1],t[2]]),N(s.length===4,function(){return"Error in conv2dDerInput: inShape must be length 4, but got length "+s.length+"."}),N(u.rank===4,function(){return"Error in conv2dDerInput: dy must be rank 4, but got rank "+u.rank}),N(n.rank===4,function(){return"Error in conv2dDerInput: filter must be rank 4, but got rank "+n.rank});var l=i==="NHWC"?s[3]:s[1],d=i==="NHWC"?u.shape[3]:u.shape[1];N(l===n.shape[2],function(){return"Error in conv2dDerInput: depth of input ("+l+") must match input depth for filter "+n.shape[2]+"."}),N(d===n.shape[3],function(){return"Error in conv2dDerInput: depth of output ("+d+") must match output depth for filter "+n.shape[3]+"."}),a!=null&&N(ft(o),function(){return"Error in conv2dDerInput: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+o+"."});var f=Yy(i),h=Ra(s,n.shape,r,1,o,a,!1,f),m=L.runKernelFunc(function(p,g){var v=p.conv2dDerInput(u,n,h);return g([n,u]),v},{dy4D:u,filter:n},function(p,g){var v=g[0],y=g[1];return{dy4D:function(){return Yn(p,v,r,o,i,1,a)},filter:function(){return a0(p,y,v.shape,r,o,i,a)}}});return c?m.as3D(m.shape[1],m.shape[2],m.shape[3]):m}function em(t){var e=function(i){return typeof i=="number"?[i,i,i]:i.length===2?[i[0],i[1],1]:i}(t),n=e[0],r=e[1],o=e[2];return n===1&&r===1&&o===1}function KR(t,e,n,r,o){N(t.length===e.rank,function(){return"Length of inShape ("+t.length+") and rank of dy ("+e.rank+") must match"});var i=t,a=e,s=!1;e.rank===4&&(s=!0,a=e.as5D(1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]),i=[1,t[0],t[1],t[2],t[3]]);var u=i[4],c=a.shape[4];N(i.length===5,function(){return"Error in conv3dDerInput: inShape must be length 5, but got length "+i.length+"."}),N(a.rank===5,function(){return"Error in conv3dDerInput: dy must be rank 5, but got rank "+a.rank}),N(n.rank===5,function(){return"Error in conv3dDerInput: filter must be rank 5, but got rank "+n.rank}),N(u===n.shape[3],function(){return"Error in conv3dDerInput: depth of input ("+u+") must match input depth for filter "+n.shape[3]+"."}),N(c===n.shape[4],function(){return"Error in conv3dDerInput: depth of output ("+c+") must match output depth for filter "+n.shape[4]+"."});var l=Sf(i,n.shape,r,1,o),d=L.runKernelFunc(function(f){return f.conv3dDerInput(a,n,l)},{dy5D:a});return s?d.as4D(d.shape[1],d.shape[2],d.shape[3],d.shape[4]):d}var $H=O({conv1d_:function(t,e,n,r,o,i,a){o===void 0&&(o="NWC"),i===void 0&&(i=1);var s=T(t,"x","conv1d"),u=T(e,"filter","conv1d"),c=s,l=!1;s.rank===2&&(l=!0,c=s.as3D(1,s.shape[0],s.shape[1])),N(c.rank===3,function(){return"Error in conv1d: input must be rank 3, but got rank "+c.rank+"."}),N(u.rank===3,function(){return"Error in conv1d: filter must be rank 3, but got rank "+u.rank+"."}),a!=null&&N(ft(r),function(){return"Error in conv1d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+r+"."}),N(c.shape[2]===u.shape[1],function(){return"Error in conv1d: depth of input ("+c.shape[2]+") must match input depth for filter "+u.shape[1]+"."}),N(wn(n,i),function(){return"Error in conv1D: Either stride or dilation must be 1. Got stride "+n+" and dilation '"+i+"'"}),N(o==="NWC",function(){return"Error in conv1d: got dataFormat of "+o+" but only NWC is currently supported."});var d=u.as4D(1,u.shape[0],u.shape[1],u.shape[2]),f=c.as4D(c.shape[0],1,c.shape[1],c.shape[2]),h=Yn(f,d,[1,n],r,"NHWC",[1,i],a);return l?h.as2D(h.shape[2],h.shape[3]):h.as3D(h.shape[0],h.shape[2],h.shape[3])}}),Yn=O({conv2d_:function(t,e,n,r,o,i,a){o===void 0&&(o="NHWC"),i===void 0&&(i=[1,1]);var s=T(t,"x","conv2d"),u=T(e,"filter","conv2d"),c=s,l=!1;s.rank===3&&(l=!0,c=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),N(c.rank===4,function(){return"Error in conv2d: input must be rank 4, but got rank "+c.rank+"."}),N(u.rank===4,function(){return"Error in conv2d: filter must be rank 4, but got rank "+u.rank+"."}),a!=null&&N(ft(r),function(){return"Error in conv2d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+r+"."});var d=o==="NHWC"?c.shape[3]:c.shape[1];N(d===u.shape[2],function(){return"Error in conv2d: depth of input ("+d+") must match input depth for filter "+u.shape[2]+"."}),N(wn(n,i),function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+i+"'"});var f=Yy(o),h=Ra(c.shape,u.shape,n,i,r,a,!1,f),m=[u,c],p=L.runKernelFunc(function(g,v){var y=g.conv2d(c,u,h);return v([u,c]),y},{x:c,filter:u},function(g,v){var y=v,x=y[0],w=y[1];return N(eu(i),function(){return"Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+i+"'"}),{x:function(){return qR(w.shape,g,x,n,r,o)},filter:function(){return a0(w,g,x.shape,n,r,o)}}},"Conv2D",h,m);return l?p.as3D(p.shape[1],p.shape[2],p.shape[3]):p}}),zH=O({conv3d_:function(t,e,n,r,o,i){o===void 0&&(o="NDHWC"),i===void 0&&(i=[1,1,1]);var a=T(t,"x","conv3d"),s=T(e,"filter","conv3d"),u=a,c=!1;a.rank===4&&(c=!0,u=a.as5D(1,a.shape[0],a.shape[1],a.shape[2],a.shape[3])),N(u.rank===5,function(){return"Error in conv3d: input must be rank 5, but got rank "+u.rank+"."}),N(s.rank===5,function(){return"Error in conv3d: filter must be rank 5, but got rank "+s.rank+"."}),N(u.shape[4]===s.shape[3],function(){return"Error in conv3d: depth of input ("+u.shape[4]+") must match input depth for filter "+s.shape[3]+"."}),N(function(f,h){return em(f)||em(h)}(n,i),function(){return"Error in conv3D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+i+"'"}),N(o==="NDHWC",function(){return"Error in conv3d: got dataFormat of "+o+" but only NDHWC is currently supported."});var l=Sf(u.shape,s.shape,n,i,r),d=L.runKernelFunc(function(f,h){var m=f.conv3d(u,s,l);return h([u,s]),m},{x:u,$filter:s},function(f,h){N(em(i),function(){return"Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+i+"'"});var m=h[0],p=h[1];return{x:function(){return KR(m.shape,f,p,n,r)},$filter:function(){return function(g,v,y,x,w){var E=g;g.rank===4&&(E=g.as5D(1,g.shape[0],g.shape[1],g.shape[2],g.shape[3]));var _=v;_.rank===4&&(_=v.as5D(1,v.shape[0],v.shape[1],v.shape[2],v.shape[3])),N(E.rank===5,function(){return"Error in conv3dDerFilter: input must be rank 5, but got shape "+E.shape+"."}),N(_.rank===5,function(){return"Error in conv3dDerFilter: dy must be rank 5, but got shape "+_.shape+"."}),N(y.length===5,function(){return"Error in conv3dDerFilter: filterShape must be length 5, but got "+y+"."}),N(E.shape[4]===y[3],function(){return"Error in conv3dDerFilter: depth of input "+E.shape[4]+") must match input depth in filter ("+y[3]+"."}),N(_.shape[4]===y[4],function(){return"Error in conv3dDerFilter: depth of dy ("+_.shape[4]+") must match output depth for filter ("+y[4]+")."});var S=Sf(E.shape,y,x,1,w);return L.runKernelFunc(function(k){return k.conv3dDerFilter(E,_,S)},{x5D:E,dy5D:_})}(m,f,p.shape,n,r)}}});return c?d.as4D(d.shape[1],d.shape[2],d.shape[3],d.shape[4]):d}}),a0=O({conv2dDerFilter_:function(t,e,n,r,o,i,a){i===void 0&&(i="NHWC");var s=t;t.rank===3&&(s=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]));var u=e;u.rank===3&&(u=e.as4D(1,e.shape[0],e.shape[1],e.shape[2])),N(s.rank===4,function(){return"Error in conv2dDerFilter: input must be rank 4, but got shape "+s.shape+"."}),N(u.rank===4,function(){return"Error in conv2dDerFilter: dy must be rank 4, but got shape "+u.shape+"."}),N(n.length===4,function(){return"Error in conv2dDerFilter: filterShape must be length 4, but got "+n+"."});var c=i==="NHWC"?s.shape[3]:s.shape[1],l=i==="NHWC"?u.shape[3]:u.shape[1];N(c===n[2],function(){return"Error in conv2dDerFilter: depth of input "+c+") must match input depth in filter ("+n[2]+"."}),N(l===n[3],function(){return"Error in conv2dDerFilter: depth of dy ("+l+") must match output depth for filter ("+n[3]+")."}),a!=null&&N(ft(o),function(){return"Error in conv2dDerFilter: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+o+"."});var d=Yy(i),f=Ra(s.shape,n,r,1,o,a,!1,d);return L.runKernelFunc(function(h){return h.conv2dDerFilter(s,u,f)},{x4D:s,dy4D:u})}}),qR=O({conv2dDerInput_:GR}),Rh=O({depthwiseConv2d_:function(t,e,n,r,o,i,a){i===void 0&&(i=[1,1]);var s=T(t,"x","depthwiseConv2d"),u=T(e,"filter","depthwiseConv2d"),c=s,l=!1;s.rank===3&&(l=!0,c=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),N(c.rank===4,function(){return"Error in depthwiseConv2d: input must be rank 4, but got rank "+c.rank+"."}),N(u.rank===4,function(){return"Error in depthwiseConv2d: filter must be rank 4, but got rank "+u.rank+"."}),N(c.shape[3]===u.shape[2],function(){return"Error in depthwiseConv2d: number of input channels ("+c.shape[3]+") must match the inChannels dimension in filter "+u.shape[2]+"."}),i==null&&(i=[1,1]),N(wn(n,i),function(){return"Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+i+"'"}),a!=null&&N(ft(r),function(){return"Error in depthwiseConv2d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+r+"."});var d=Ra(c.shape,u.shape,n,i,r,a,!0),f=[c,u],h=L.runKernelFunc(function(m,p){var g=m.depthwiseConv2D(c,u,d);return p([c,u]),g},{x:c,filter:u},function(m,p){N(eu(i),function(){return"Error in gradient of depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+i+"'"});var g=p[0],v=p[1];return{x:function(){return XR(g.shape,m,v,d)},filter:function(){return YR(g,m,v.shape,d)}}},"DepthwiseConv2dNative",d,f);return l?h.as3D(h.shape[1],h.shape[2],h.shape[3]):h}}),XR=O({depthwiseConv2dDerInput_:function(t,e,n,r){var o=e,i=!1;e.rank===3&&(i=!0,o=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var a=L.runKernelFunc(function(s){return s.depthwiseConv2DDerInput(o,n,r)},{dy4D:o});return i?a.as3D(a.shape[1],a.shape[2],a.shape[3]):a}}),YR=O({depthwiseConv2dDerFilter_:function(t,e,n,r){var o=t;t.rank===3&&(o=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]));var i=e;return i.rank===3&&(i=e.as4D(1,e.shape[0],e.shape[1],e.shape[2])),L.runKernelFunc(function(a){return a.depthwiseConv2DDerFilter(o,i,r)},{x4D:o,dy4D:i})}}),s0=O({separableConv2d_:function(t,e,n,r,o,i,a){i===void 0&&(i=[1,1]),a===void 0&&(a="NHWC");var s=T(t,"x","separableConv2d"),u=T(e,"depthwiseFilter","separableConv2d"),c=T(n,"pointwiseFilter","separableConv2d"),l=s,d=!1;if(s.rank===3&&(d=!0,l=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),a==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");N(l.rank===4,function(){return"Error in separableConv2d: input must be rank 4, but got rank "+l.rank+"."}),N(u.rank===4,function(){return"Error in separableConv2d: depthwise filter must be rank 4, but got rank "+u.rank+"."}),N(c.rank===4,function(){return"Error in separableConv2d: pointwise filter must be rank 4, but got rank "+u.rank+"."}),N(c.shape[0]===1,function(){return"Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got "+c.shape[0]+"."}),N(c.shape[1]===1,function(){return"Error in separableConv2d: the second dimension of pointwise filter must be 1, but got "+c.shape[1]+"."});var f=u.shape[2],h=u.shape[3];N(c.shape[2]===f*h,function(){return"Error in separableConv2d: the third dimension of pointwise filter must be "+f*h+", but got "+c.shape[2]+"."});var m=Rh(l,u,r,o,a,i),p=Yn(m,c,1,"valid",a);return d?p.as3D(p.shape[1],p.shape[2],p.shape[3]):p}}),VH=O({conv2dTranspose_:function(t,e,n,r,o,i){return GR(n,T(t,"x","conv2dTranspose"),T(e,"filter","conv2dTranspose"),r,o,"NHWC",i)}}),HH=O({conv3dTranspose_:function(t,e,n,r,o){return KR(n,T(t,"x","conv3dTranspose"),T(e,"filter","conv3dTranspose"),r,o)}}),Th=O({matMul_:function(t,e,n,r){var o;n===void 0&&(n=!1),r===void 0&&(r=!1);var i=T(t,"a","matMul"),a=T(e,"b","matMul");o=it(i,a),i=o[0],a=o[1];var s=n?i.shape[i.rank-2]:i.shape[i.rank-1],u=r?a.shape[a.rank-1]:a.shape[a.rank-2],c=n?i.shape[i.rank-1]:i.shape[i.rank-2],l=r?a.shape[a.rank-2]:a.shape[a.rank-1],d=i.shape.slice(0,-2),f=a.shape.slice(0,-2),h=le(d),m=le(f);N(i.rank>=2&&a.rank>=2&&i.rank===a.rank,function(){return"Error in matMul: inputs must have the same rank of at least 2, got ranks "+i.rank+" and "+a.rank+"."}),N(Nt(d,f),function(){return"Error in matMul: outer dimensions ("+d+") and ("+f+") of Tensors with shapes "+i.shape+" and "+a.shape+" must match."}),N(s===u,function(){return"Error in matMul: inner shapes ("+s+") and ("+u+") of Tensors with shapes "+i.shape+" and "+a.shape+" and transposeA="+n+" and transposeB="+r+" must match."});var p=i.shape.slice(0,-2).concat([c,l]),g=n?i.as3D(h,s,c):i.as3D(h,c,s),v=r?a.as3D(m,l,u):a.as3D(m,u,l),y={transposeA:n,transposeB:r};return L.runKernelFunc(function(x,w){var E=x.batchMatMul(g,v,n,r);return w([g,v]),E},{a:g,b:v},function(x,w){var E=w,_=E[0],S=E[1];return n||r?!n&&r?{a:function(){return x.matMul(S,!1,!1)},b:function(){return x.matMul(_,!0,!1)}}:n&&!r?{a:function(){return S.matMul(x,!1,!0)},b:function(){return _.matMul(x,!1,!1)}}:{a:function(){return S.matMul(x,!0,!0)},b:function(){return x.matMul(_,!0,!0)}}:{a:function(){return x.matMul(S,!1,!0)},b:function(){return _.matMul(x,!0,!1)}}},"BatchMatMul",y).reshape(p)}}),GH=O({dot_:function(t,e){var n=T(t,"t1","dot"),r=T(e,"t2","dot");N(!(n.rank!==1&&n.rank!==2||r.rank!==1&&r.rank!==2),function(){return"Error in dot: inputs must all be rank 1 or 2, but got ranks "+n.rank+" and "+r.rank+"."});var o=n.rank===1?n.size:n.shape[1],i=r.rank===1?r.size:r.shape[0];return N(o===i,function(){return"Error in dot: inner dimensions of inputs must match, but got "+o+" and "+i+"."}),n.rank===1&&r.rank===1?n.as2D(1,-1).matMul(r.as2D(-1,1)).asScalar():n.rank===1&&r.rank===2?n.as2D(1,-1).matMul(r.as2D(r.shape[0],r.shape[1])).as1D():n.rank===2&&r.rank===1?n.matMul(r.as2D(-1,1)).as1D():n.matMul(r.as2D(r.shape[0],r.shape[1]))}}),KH=O({outerProduct_:function(t,e){var n=T(t,"v1","outerProduct"),r=T(e,"v2","outerProduct");return N(n.rank===1&&r.rank===1,function(){return"Error in outerProduct: inputs must be rank 1, but got ranks "+n.rank+" and "+r.rank+"."}),n.as2D(-1,1).matMul(r.as2D(1,-1))}}),ol=O({reverse_:function(t,e){var n=T(t,"x","reverse");if(n.rank===0)return n.clone();var r=_t(e,n.shape);return L.runKernelFunc(function(o){return o.reverse(n,r)},{$x:n},function(o){return{$x:function(){return o.reverse(r)}}}).reshapeAs(n)}}),qH=O({reverse1d_:function(t){var e=T(t,"x","reverse");return N(e.rank===1,function(){return"Error in reverse1D: x must be rank 1 but got rank "+e.rank+"."}),ol(e,0)}}),XH=O({reverse2d_:function(t,e){var n=T(t,"x","reverse");return N(n.rank===2,function(){return"Error in reverse2D: x must be rank 2 but got rank "+n.rank+"."}),ol(n,e)}}),YH=O({reverse3d_:function(t,e){var n=T(t,"x","reverse");return N(n.rank===3,function(){return"Error in reverse3D: x must be rank 3 but got rank "+n.rank+"."}),ol(n,e)}}),QH=O({reverse4d_:function(t,e){var n=T(t,"x","reverse");return N(n.rank===4,function(){return"Error in reverse4D: x must be rank 4 but got rank "+n.rank+"."}),ol(n,e)}});function QR(t,e,n,r,o,i){var a=T(t,"x","maxPool"),s=a,u=!1;a.rank===3&&(u=!0,s=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),N(s.rank===4,function(){return"Error in maxPool: input must be rank 4 but got rank "+s.rank+"."}),N(wn(n,r),function(){return"Error in maxPool: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+r+"'"}),i!=null&&N(ft(o),function(){return"Error in maxPool: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+o+"."});var c=kc(s.shape,e,n,r,o,i);if(c.filterWidth===1&&c.filterHeight===1&&Nt(c.inShape,c.outShape))return a.clone();var l=[s],d=L.runKernelFunc(function(f,h){var m=f.maxPool(s,c);return h([s,m]),m},{x:s},function(f,h){var m=h[0],p=h[1];return{x:function(){return function(g,v,y,x,w,E,_,S){var k=T(g,"dy","maxPoolBackprop"),I=T(v,"input","maxPoolBackprop"),R=T(y,"output","maxPoolBackprop");N(I.rank===k.rank,function(){return"Rank of input ("+I.rank+") does not match rank of dy ("+k.rank+")"}),N(wn(w,E),function(){return"Error in maxPoolBackProp: Either strides or dilations must be 1. Got strides "+w+" and dilations '"+E+"'"}),N(k.rank===4,function(){return"Error in maxPoolBackprop: dy must be rank 4 but got rank "+k.rank+"."}),N(I.rank===4,function(){return"Error in maxPoolBackprop: input must be rank 4 but got rank "+I.rank+"."});var D=kc(I.shape,x,w,E,_,S);return L.runKernelFunc(function(A){return A.maxPoolBackprop(k,I,R,D)},{$dy:k,$input:I})}(f,m,p,e,n,r,o)}}},"MaxPool",c,l);return u?d.as3D(d.shape[1],d.shape[2],d.shape[3]):d}function JR(t,e,n,r,o,i){var a=T(t,"x","avgPool","float32");N(wn(n,r),function(){return"Error in avgPool: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+r+"'"});var s=a,u=!1;a.rank===3&&(u=!0,s=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),N(s.rank===4,function(){return"Error in avgPool: x must be rank 4 but got rank "+s.rank+"."}),i!=null&&N(ft(o),function(){return"Error in avgPool: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+o+"."});var c=kc(s.shape,e,n,r,o,i);if(c.filterWidth===1&&c.filterHeight===1&&Nt(c.inShape,c.outShape))return a.clone();var l=L.runKernelFunc(function(d){return d.avgPool(s,c)},{x:s},function(d){return{x:function(){return function(f,h,m,p,g,v){var y=T(f,"dy","avgPoolBackprop"),x=T(h,"input","avgPoolBackprop");N(x.rank===y.rank,function(){return"Rank of input ("+x.rank+") does not match rank of dy ("+y.rank+")"}),N(wn(p,g),function(){return"Error in avgPoolBackprop: Either strides or dilations must be 1. Got strides "+p+" and dilations '"+g+"'"});var w=x,E=y,_=!1;x.rank===3&&(_=!0,w=x.as4D(1,x.shape[0],x.shape[1],x.shape[2]),E=y.as4D(1,y.shape[0],y.shape[1],y.shape[2])),N(E.rank===4,function(){return"Error in avgPoolBackprop: dy must be rank 4 but got rank "+E.rank+"."}),N(w.rank===4,function(){return"Error in avgPoolBackprop: input must be rank 4 but got rank "+w.rank+"."});var S=kc(w.shape,m,p,g,v),k=L.runKernelFunc(function(I){return I.avgPoolBackprop(E,w,S)},{dy4D:E,input4D:w});return _?k.as3D(k.shape[1],k.shape[2],k.shape[3]):k}(d,s,e,n,r,o)}}},"AvgPool",c);return l=l.cast(a.dtype),u?l.as3D(l.shape[1],l.shape[2],l.shape[3]):l}var It=O({maxPool_:function(t,e,n,r,o){return QR(t,e,n,1,r,o)}}),il=O({avgPool_:function(t,e,n,r,o){return JR(t,e,n,1,r,o)}}),JH=O({pool_:function(t,e,n,r,o,i){o==null&&(o=[1,1]),i==null&&(i=1),r===0&&(r="valid");var a=T(t,"x","maxPool"),s=a,u=!1;a.rank===3&&(u=!0,s=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),N(wn(i,o),function(){return"Error in pool: Either strides or dilations must be 1. Got strides "+i+" and dilations '"+o+"'"});var c,l=kc(s.shape,e,i,o,r),d=[l.dilationHeight,l.dilationWidth];c=r==="same"?function(w,E){var _=w.map(function(I,R){return I+(I-1)*(E[R]-1)}).map(function(I){return I-1}),S=_.map(function(I){return Math.floor(I/2)}),k=_.map(function(I,R){return I-S[R]});return _.map(function(I,R){return[S[R],k[R]]})}([l.filterHeight,l.filterWidth],d):[[0,0],[0,0]];var f=d[0]===1&&d[1]===1,h=function(w,E,_){var S=_.map(function(F){return F[0]}),k=_.map(function(F){return F[1]}),I=w.concat(S,k),R=E.map(function(F,W){return(F-I[W]%F)%F}),D=k.map(function(F,W){return F+R[W]}),A=E.map(function(F,W){return[S[W],D[W]]}),j=E.map(function(F,W){return[0,R[W]]});return[A,j]}([l.inHeight,l.inWidth],d,c),m=h[0],p=h[1],g=f?r:"valid",v=f?s:oR(s,d,m),y=(n==="avg"?function(){return JR(v,e,i,1,g)}:function(){return QR(v,e,i,1,g)})(),x=f?y:tR(y,d,p);return u?x.as3D(x.shape[1],x.shape[2],x.shape[3]):x}}),ZH=O({maxPool3d_:function(t,e,n,r,o,i,a){i===void 0&&(i="NDHWC");var s=T(t,"x","maxPool3d"),u=s,c=!1;s.rank===4&&(c=!0,u=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),a==null&&(a=[1,1,1]),N(u.rank===5,function(){return"Error in maxPool3d: x must be rank 5 but got rank "+u.rank+"."}),N(i==="NDHWC",function(){return"Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of "+i}),N(wn(n,a),function(){return"Error in maxPool3d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+a+"'"}),o!=null&&N(ft(r),function(){return"Error in maxPool3d: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+r+"."});var l=_f(u.shape,e,n,a,r,o,i),d=L.runKernelFunc(function(f,h){var m=f.maxPool3d(u,l);return h([u,m]),m},{x:u},function(f,h){var m=h[0],p=h[1];return{x:function(){return function(g,v,y,x,w,E,_,S){var k=T(g,"dy","maxPool3dBackprop"),I=T(v,"input","maxPool3dBackprop"),R=T(y,"output","maxPool3dBackprop"),D=k,A=I,j=R,F=!1;I.rank===4&&(F=!0,D=k.as5D(1,k.shape[0],k.shape[1],k.shape[2],k.shape[3]),A=I.as5D(1,I.shape[0],I.shape[1],I.shape[2],I.shape[3]),j=R.as5D(1,R.shape[0],R.shape[1],R.shape[2],R.shape[3])),N(D.rank===5,function(){return"Error in maxPool3dBackprop: dy must be rank 5 but got rank "+D.rank+"."}),N(A.rank===5,function(){return"Error in maxPool3dBackprop: input must be rank 5 but got rank "+A.rank+"."}),N(j.rank===5,function(){return"Error in maxPool3dBackprop: output must be rank 5 but got rank "+j.rank+"."}),E==null&&(E=[1,1,1]),N(wn(w,E),function(){return"Error in maxPool3dBackprop: Either strides or dilations must be 1. Got strides "+w+" and dilations '"+E+"'"}),S!=null&&N(ft(_),function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+S+" but got pad "+_+"."});var W=_f(A.shape,x,w,E,_,S),U=L.runKernelFunc(function($){return $.maxPool3dBackprop(D,A,j,W)},{dy5D:D,input5D:A});return F?U.as4D(U.shape[1],U.shape[2],U.shape[3],U.shape[4]):U}(f,m,p,e,n,a,r,o)}}});return c?d.as4D(d.shape[1],d.shape[2],d.shape[3],d.shape[4]):d}}),eG=O({avgPool3d_:function(t,e,n,r,o,i,a){i===void 0&&(i="NDHWC");var s=T(t,"x","avgPool3d","float32"),u=s,c=!1;s.rank===4&&(c=!0,u=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),a==null&&(a=[1,1,1]),N(u.rank===5,function(){return"Error in avgPool3d: x must be rank 5 but got rank "+u.rank+"."}),N(i==="NDHWC",function(){return"Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of "+i}),N(wn(n,a),function(){return"Error in avgPool3d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+a+"'"}),o!=null&&N(ft(r),function(){return"Error in avgPool3d: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+r+"."});var l=_f(u.shape,e,n,a,r,o,i),d=L.runKernelFunc(function(f){return f.avgPool3d(u,l)},{x:u},function(f){return{x:function(){return function(h,m,p,g,v,y,x){var w=T(h,"dy","avgPool3dBackprop"),E=T(m,"input","avgPool3dBackprop"),_=w,S=E,k=!1;E.rank===4&&(k=!0,_=w.as5D(1,w.shape[0],w.shape[1],w.shape[2],w.shape[3]),S=E.as5D(1,E.shape[0],E.shape[1],E.shape[2],E.shape[3])),N(_.rank===5,function(){return"Error in avgPool3dBackprop: dy must be rank 5 but got rank "+_.rank+"."}),N(S.rank===5,function(){return"Error in avgPool3dBackprop: input must be rank 5 but got rank "+S.rank+"."}),v==null&&(v=[1,1,1]),N(wn(g,v),function(){return"Error in avgPool3dBackprop: Either strides or dilations must be 1. Got strides "+g+" and dilations '"+v+"'"}),x!=null&&N(ft(y),function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+x+" but got pad "+y+"."});var I=_f(S.shape,p,g,v,y,x),R=L.runKernelFunc(function(D){return D.avgPool3dBackprop(_,S,I)},{dy5D:_,input5D:S});return k?R.as4D(R.shape[1],R.shape[2],R.shape[3],R.shape[4]):R}(f,u,e,n,a,r,o)}}});return d=d.cast(u.dtype),c?d.as4D(d.shape[1],d.shape[2],d.shape[3],d.shape[4]):d}}),Kr=O({slice_:function(t,e,n){var r,o,i=T(t,"x","slice");if(i.rank===0)throw new Error("Slicing scalar is not possible");(r=typeof e=="number"?[e].concat(new Array(i.rank-1).fill(0)):e.length<i.rank?e.concat(new Array(i.rank-e.length).fill(0)):e.slice()).forEach(function(u){N(u!==-1,function(){return"slice() does not support negative begin indexing."})}),o=(o=n==null?new Array(i.rank).fill(-1):typeof n=="number"?[n].concat(new Array(i.rank-1).fill(-1)):n.length<i.rank?n.concat(new Array(i.rank-n.length).fill(-1)):n).map(function(u,c){return u>=0?u:(N(u===-1,function(){return"Negative size values should be exactly -1 but got "+u+" for the slice() size at index "+c+"."}),i.shape[c]-r[c])}),R$(i,r,o);var a=i.shape,s={begin:r,size:o};return L.runKernelFunc(function(u){return u.slice(i,r,o)},{x:i},function(u){for(var c=[],l=0;l<u.rank;l++)c.push([r[l],a[l]-r[l]-o[l]]);return{x:function(){return u.pad(c)}}},"Slice",s)}}),tG=O({slice1d_:function(t,e,n){var r=T(t,"x","slice1d");return N(r.rank===1,function(){return"slice1d expects a rank-1 tensor, but got a rank-"+r.rank+" tensor"}),Kr(r,[e],[n])}}),nG=O({slice2d_:function(t,e,n){var r=T(t,"x","slice2d");return N(r.rank===2,function(){return"slice2d expects a rank-2 tensor, but got a rank-"+r.rank+" tensor"}),Kr(r,e,n)}}),ZR=O({slice3d_:function(t,e,n){var r=T(t,"x","slice3d");return N(r.rank===3,function(){return"slice3d expects a rank-3 tensor, but got a rank-"+r.rank+" tensor"}),Kr(r,e,n)}}),rG=O({slice4d_:function(t,e,n){var r=T(t,"x","slice4d");return N(r.rank===4,function(){return"slice4d expects a rank-4 tensor, but got a rank-"+r.rank+" tensor"}),Kr(r,e,n)}});function eT(t,e,n,r,o){return e.rank<n.rank&&(e=e.reshape(xn(e.shape,r))),t.rank<n.rank&&(t=t.reshape(xn(t.shape,r))),{x:function(){var i=t.mul(n.equal(e).cast(t.dtype));return o==null?i:i.transpose(o)}}}var oG=O({all_:function(t,e,n){e===void 0&&(e=null),n===void 0&&(n=!1);var r=T(t,"x","all","bool"),o=_t(e,r.shape),i=o,a=Qr(i,r.rank);a!=null&&(r=r.transpose(a),i=Jr(i.length,r.rank));var s=L.runKernelFunc(function(c){return c.all(r,i)},{$x:r});if(n){var u=xn(s.shape,o);return s.reshape(u)}return s}}),iG=O({any_:function(t,e,n){e===void 0&&(e=null),n===void 0&&(n=!1);var r=T(t,"x","any","bool"),o=_t(e,r.shape),i=o,a=Qr(i,r.rank);a!=null&&(r=r.transpose(a),i=Jr(i.length,r.rank));var s=L.runKernelFunc(function(c){return c.any(r,i)},{$x:r});if(n){var u=xn(s.shape,o);return s.reshape(u)}return s}}),aG=O({argMax_:function(t,e){e===void 0&&(e=0);var n=T(t,"x","argMax");e==null&&(e=0);var r=_t(e,n.shape),o=Qr(r,n.rank);o!=null&&(n=n.transpose(o),r=Jr(r.length,n.rank));var i={axis:r[0]},a=[n];return L.runKernelFunc(function(s,u){var c=s.argMax(n,r[0]);return u([n]),c},{x:n},function(s,u){var c=u[0];return{x:function(){return Me(c)}}},"ArgMax",i,a)}}),sG=O({argMin_:function(t,e){e===void 0&&(e=0);var n=T(t,"x","argMin");e==null&&(e=0);var r=_t(e,n.shape),o=Qr(r,n.rank);return o!=null&&(n=n.transpose(o),r=Jr(r.length,n.rank)),L.runKernelFunc(function(i,a){var s=i.argMin(n,r[0]);return a([n]),s},{$x:n},function(i,a){var s=a[0];return{$x:function(){return Me(s)}}})}}),uG=O({logSumExp_:function(t,e,n){e===void 0&&(e=null),n===void 0&&(n=!1);var r=T(t,"x","logSumExp"),o=_t(e,r.shape),i=r.max(o,!0),a=r.sub(i).exp().sum(o).log(),s=i.reshape(a.shape).add(a);if(n){var u=xn(s.shape,o);return s.reshape(u)}return s}}),Nh=O({max_:function(t,e,n){e===void 0&&(e=null),n===void 0&&(n=!1);var r=T(t,"x","max"),o=r,i=_t(e,r.shape),a=i,s=Qr(a,r.rank);s!=null&&(r=r.transpose(s),a=Jr(a.length,r.rank));var u=[r],c=L.runKernelFunc(function(d,f){var h=d.max(r,a);return f([o,h]),h},{x:r},function(d,f){return eT(d,f[1],f[0],i,s)},"Max",{axes:a},u,[!0]);if(n){var l=xn(c.shape,i);c=c.reshape(l)}return c}}),cG=O({mean_:function(t,e,n){e===void 0&&(e=null),n===void 0&&(n=!1);var r=T(t,"x","mean"),o=_t(e,r.shape),i=le(Ht(r.shape,o)[1]);return Sh(function(a){var s=oe(i);return{value:(s.dtype===a.dtype?a:a.cast(s.dtype)).div(s).sum(e,n),gradFunc:function(u){var c=a.shape.slice();return o.forEach(function(l){c[l]=1}),u.reshape(c).mul(lu(a.shape,"float32")).div(i)}}})(r)}}),lG=O({min_:function(t,e,n){e===void 0&&(e=null),n===void 0&&(n=!1);var r=T(t,"x","min"),o=r,i=_t(e,r.shape),a=i,s=Qr(a,r.rank);s!=null&&(r=r.transpose(s),a=Jr(a.length,r.rank));var u=[r],c=L.runKernelFunc(function(d,f){var h=d.min(r,a);return f([o,h]),h},{x:r},function(d,f){return eT(d,f[1],f[0],i,s)},"Min",{axes:a},u,[!0]);if(n){var l=xn(c.shape,i);c=c.reshape(l)}return c}}),dG=O({moments_:function(t,e,n){e===void 0&&(e=null),n===void 0&&(n=!1);var r=_t(e,(t=T(t,"x","moments")).shape),o=t.mean(r,n),i=o.shape;n||(i=xn(o.shape,r));var a=t.toFloat().sub(o.reshape(i)).square();return{mean:o,variance:a.mean(r,n)}}}),tT=O({sum_:function(t,e,n){e===void 0&&(e=null),n===void 0&&(n=!1);var r=T(t,"x","sum");r.dtype==="bool"&&(r=r.toInt());var o=_t(e,r.shape);return Sh(function(i){var a=Qr(o,i.rank),s=o,u=i;a!=null&&(u=i.transpose(a),s=Jr(s.length,i.rank));var c=function(h){var m=i.shape.slice();return o.forEach(function(p){m[p]=1}),h.reshape(m).mul(lu(i.shape,"float32"))},l={axes:s},d=L.runKernelFunc(function(h){return h.sum(u,s)},{x:u},function(h){return{x:function(){return c(h)}}},"Sum",l);if(n){var f=xn(d.shape,o);d=d.reshape(f)}return{value:d,gradFunc:c}})(r)}}),fG=O({prod_:function(t,e,n){e===void 0&&(e=null),n===void 0&&(n=!1);var r=T(t,"x","prod");r.dtype==="bool"&&(r=r.toInt());var o=_t(e,r.shape),i=Qr(o,r.rank),a=o,s=r;i!=null&&(s=r.transpose(i),a=Jr(a.length,r.rank));var u=L.runKernelFunc(function(l){return l.prod(s,a)},{permutedX:s});if(n){var c=xn(u.shape,o);u=u.reshape(c)}return u}}),nT=O({elu_:function(t){var e=T(t,"x","elu");return L.runKernelFunc(function(n,r){var o=n.elu(e);return r([o]),o},{$x:e},function(n,r){var o=r[0];return{$x:function(){return L.runKernelFunc(function(i){return i.eluDer(n,o)},{dy:n,y:o})}}})}}),hG=O({leakyRelu_:function(t,e){e===void 0&&(e=.2);var n=T(t,"x","leakyRelu");return o0(oe(e).mul(n),n)}}),rT=O({prelu_:function(t,e){var n=T(t,"x","prelu"),r=T(e,"alpha","prelu");return L.runKernelFunc(function(o,i){var a=o.prelu(n,r);return i([n,r]),a},{x:n,alpha:r},function(o,i){var a=i[0],s=i[1],u=a.greater(0);return{x:function(){return ga(u,o,o.mul(s))},alpha:function(){var c=ga(u,Me(o),o.mul(a)),l=Et(s.shape,o.shape);return l.length>0&&(c=c.sum(l)),c.reshape(s.shape)}}},"Prelu")}}),nt=O({relu_:function(t){var e=T(t,"x","relu");return e.dtype==="bool"?e.toInt():L.runKernelFunc(function(n,r){var o=n.relu(e);return r([e]),o},{x:e},function(n,r){var o=r[0];return{x:function(){return n.mulStrict(o.step().toFloat())}}},"Relu")}}),oT=O({relu6_:function(t){var e=T(t,"x","relu6");return e.dtype==="bool"?e.toInt():L.runKernelFunc(function(n,r){var o=n.relu6(e);return r([e]),o},{x:e},function(n,r){var o=r[0],i=o.lessEqual(6).mul(o.step());return{x:function(){return n.mulStrict(i.toFloat())}}},"Relu6")}}),pG=O({selu_:function(t){var e=T(t,"x","selu");return L.runKernelFunc(function(n,r){var o=n.selu(e);return r([e]),o},{$x:e},function(n,r){var o=r[0];return{$x:function(){var i=o.greater(oe(0)),a=oe(t0),s=oe(n0),u=n.mul(s),c=n.mul(a).mul(o.toFloat().exp());return ga(i,u,c)}}})}}),Ii=O({transpose_:function(t,e){var n=T(t,"x","transpose");if(e==null&&(e=n.shape.map(function(o,i){return i}).reverse()),N(n.rank===e.length,function(){return"Error in transpose: rank of input "+n.rank+" must match length of perm "+e+"."}),e.forEach(function(o){N(o>=0&&o<n.rank,function(){return"All entries in 'perm' must be between 0 and "+(n.rank-1)+" but got "+e})}),n.rank<=1)return n.clone();var r={perm:e};return L.runKernelFunc(function(o){return o.transpose(n,e)},{x:n},function(o){var i=Hy(e);return{x:function(){return o.transpose(i)}}},"Transpose",r)}}),mG=O({localResponseNormalization_:function(t,e,n,r,o){e===void 0&&(e=5),n===void 0&&(n=1),r===void 0&&(r=1),o===void 0&&(o=.5);var i=T(t,"x","localResponseNormalization");N(i.rank===4||i.rank===3,function(){return`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank `+i.rank+"."}),N(ft(e),function(){return"Error in localResponseNormalization: depthRadius must be an integer but got depthRadius "+e+"."});var a=i,s=!1;i.rank===3&&(s=!0,a=i.as4D(1,i.shape[0],i.shape[1],i.shape[2]));var u=L.runKernelFunc(function(c,l){var d=c.localResponseNormalization4D(a,e,n,r,o);return l([a,d]),d},{x4D:a},function(c,l){var d=l[0],f=l[1];return{x4D:function(){return L.runKernelFunc(function(h){return h.LRNGrad(c,d,f,e,n,r,o)},{})}}});return s?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),iT=O({norm_:function(t,e,n,r){e===void 0&&(e="euclidean"),n===void 0&&(n=null),r===void 0&&(r=!1);var o=function s(u,c,l){if(l===void 0&&(l=null),u.rank===0)return u.abs();if(u.rank!==1&&l===null)return s(u.reshape([-1]),c,l);if(u.rank===1||typeof l=="number"||Array.isArray(l)&&l.length===1){if(c===1)return u.abs().sum(l);if(c===1/0)return u.abs().max(l);if(c===-1/0)return u.abs().min(l);if(c==="euclidean"||c===2)return u.abs().pow(oe(2,"int32")).sum(l).sqrt();throw new Error("Error in norm: invalid ord value: "+c)}if(Array.isArray(l)&&l.length===2){if(c===1)return u.abs().sum(l[0]).max(l[1]-1);if(c===1/0)return u.abs().sum(l[1]).max(l[0]);if(c===-1/0)return u.abs().sum(l[1]).min(l[0]);if(c==="fro"||c==="euclidean")return u.square().sum(l).sqrt();throw new Error("Error in norm: invalid ord value: "+c)}throw new Error("Error in norm: invalid axis: "+l)}(t=T(t,"x","norm"),e,n),i=o.shape;if(r){var a=_t(n,t.shape);i=xn(o.shape,a)}return o.reshape(i)}}),vG=O({basicLSTMCell_:function(t,e,n,r,o,i){var a=T(t,"forgetBias","basicLSTMCell"),s=T(e,"lstmKernel","basicLSTMCell"),u=T(n,"lstmBias","basicLSTMCell"),c=T(r,"data","basicLSTMCell"),l=T(o,"c","basicLSTMCell"),d=T(i,"h","basicLSTMCell"),f=c.concat(d,1).matMul(s).add(u),h=f.shape[0],m=f.shape[1]/4,p=[h,m],g=f.slice([0,0],p),v=f.slice([0,m],p),y=f.slice([0,2*m],p),x=f.slice([0,3*m],p),w=g.sigmoid().mulStrict(v.tanh()).addStrict(l.mulStrict(a.add(y).sigmoid())),E=w.tanh().mulStrict(x.sigmoid());return[w,E]}}),gG=O({multiRNNCell_:function(t,e,n,r){for(var o=T(e,"data","multiRNNCell"),i=yf(n,"c","multiRNNCell"),a=yf(r,"h","multiRNNCell"),s=o,u=[],c=0;c<t.length;c++){var l=t[c](s,i[c],a[c]);u.push(l[0]),u.push(l[1]),s=l[1]}var d=[],f=[];for(c=0;c<u.length;c+=2)d.push(u[c]),f.push(u[c+1]);return[d,f]}}),yG=O({movingAverage_:function(t,e,n,r,o){o===void 0&&(o=!0);var i=T(t,"v","movingAverage"),a=T(e,"x","movingAverage"),s=T(n,"decay","movingAverage");mW(i,a),N(Nt(i.shape,a.shape),function(){return"Shape mismatch in v and x"});var u=oe(1),c=u.sub(s),l=a.sub(i).mul(c);if(o){N(r!=null,function(){return"When using zeroDebias: true, step is required."});var d=T(r,"step","movingAverage");l=l.div(u.sub(Rf(s,d)))}return i.add(l)}}),xG=O({stridedSlice_:function(t,e,n,r,o,i,a,s,u){if(o===void 0&&(o=0),i===void 0&&(i=0),a===void 0&&(a=0),s===void 0&&(s=0),u===void 0&&(u=0),r==null&&(r=new Array(e.length)),a!==0)throw new Error("ellipsis mask is not yet supported");var c=T(t,"x","stridedSlice"),l=Jw(s),d=c.shape.slice();l.forEach(function(g){e[g]=0,n[g]=1,d.splice(g,0,1)}),c=c.reshape(d);for(var f=0;f<c.rank;f++)e[f]=T$(o,e,r,c.shape,f),n[f]=N$(i,n,r,c.shape,f),r[f]=r[f]||1;var h=Jw(u);h.forEach(function(g){n[g]=e[g]+1,r[g]=1});var m=Xy(e,n,r),p=m.filter(function(g,v){return h.indexOf(v)===-1});return r.every(function(g){return g===1})?Kr(c,e,m).reshape(p):L.runKernelFunc(function(g){return g.stridedSlice(c,e,n,r)},{$x:c}).reshape(p)}}),wG=O({topk_:function(t,e,n){e===void 0&&(e=1),n===void 0&&(n=!0);var r=T(t,"x","topk");if(r.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");var o=r.shape[r.shape.length-1];if(e>o)throw new Error("'k' passed to topk() must be <= the last dimension ("+o+") but got "+e);var i=L.runKernelFunc(function(a){return a.topk(r,e,n)},{$x:r});return{values:i[0],indices:i[1]}}}),bG=O({scatterND_:function(t,e,n){var r=T(t,"indices","scatterND","int32"),o=T(e,"updates","scatterND");return I$(o,r,n),L.runKernelFunc(function(i){return i.scatterND(r,o,n)},{indices:r,updates:o},null,"ScatterNd",{shape:n})}}),u0=O({fft_:function(t){N(t.dtype==="complex64",function(){return"The dtype for tf.spectral.fft() must be complex64 but got "+t.dtype+"."});var e=t.shape[t.shape.length-1],n=t.size/e,r=t.as2D(n,e);return L.runKernelFunc(function(o){return o.fft(r)},{input:t}).reshape(t.shape)}}),Tf=O({ifft_:function(t){N(t.dtype==="complex64",function(){return"The dtype for tf.spectral.ifft() must be complex64 but got "+t.dtype+"."});var e=t.shape[t.shape.length-1],n=t.size/e,r=t.as2D(n,e);return L.runKernelFunc(function(o){return o.ifft(r)},{input:t}).reshape(t.shape)}}),c0=O({rfft_:function(t,e){N(t.dtype==="float32",function(){return"The dtype for rfft() must be real value but got "+t.dtype});var n,r=t.shape[t.shape.length-1],o=t.size/r;if(e!=null&&e<r){var i=t.shape.map(function(v){return 0}),a=t.shape.map(function(v){return v});a[t.shape.length-1]=e,n=t.slice(i,a),r=e}else if(e!=null&&e>r){var s=t.shape.map(function(v){return v});s[t.shape.length-1]=e-r,n=t.concat(Xe(s),t.shape.length-1),r=e}else n=t;var u=n.zerosLike(),c=Mt(n,u).as2D(o,r),l=u0(c),d=Math.floor(r/2)+1,f=$n(l),h=Or(l),m=f.split([d,r-d],f.shape.length-1),p=h.split([d,r-d],h.shape.length-1),g=n.shape.slice();return g[n.shape.length-1]=d,Mt(m[0],p[0]).reshape(g)}}),aT=O({irfft_:function(t){var e=t.shape[t.shape.length-1],n=t.size/e;if(e<=2){var r=t.as2D(n,e),o=Tf(r);return $n(o)}var i=[n,2*(e-1)],a=$n(t).as2D(n,e),s=Or(t).as2D(n,e),u=a.slice([0,1],[n,e-2]).reverse(1),c=s.slice([0,1],[n,e-2]).reverse(1).mul(oe(-1)),l=a.concat(u,1),d=s.concat(c,1);return r=Mt(l,d).as2D(i[0],i[1]),o=Tf(r),$n(o)}}),EG=Object.freeze({fft:u0,ifft:Tf,rfft:c0,irfft:aT}),CG=O({sparseToDense_:function(t,e,n,r){r===void 0&&(r=0);var o=T(t,"sparseIndices","sparseToDense","int32"),i=T(e,"sparseValues","sparseToDense"),a=T(r,"defaultValue","sparseToDense",i.dtype);return function(s,u,c,l){if(s.dtype!=="int32")throw new Error("tf.sparseToDense() expects the indices to be int32 type, but the dtype was "+s.dtype+".");if(s.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix, but got shape "+s.shape+".");var d=s.rank>0?s.shape[0]:1,f=s.rank>1?s.shape[1]:1;if(c.length!==f)throw new Error("outputShape has incorrect number of elements:, "+c.length+", should be: "+f+".");var h=u.size;if(u.rank!==0&&(u.rank!==1||h!==d))throw new Error("sparseValues has incorrect shape "+u.shape+", should be [] or ["+d+"]");if(u.dtype!==l.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}(o,i,n,a),L.runKernelFunc(function(s){return s.sparseToDense(o,i,n,a)},{$sparseIndices:o,$sparseValues:i,$defaultValue:a})}}),_G=O({gatherND_:function(t,e){var n=T(e,"indices","gatherND","int32"),r=T(t,"x","gatherND");return L.runKernelFunc(function(o){return o.gatherND(r,n)},{x:r,indices:n},null,"GatherNd")}}),SG=O({diag_:function(t){var e=T(t,"x","diag").flatten(),n=t.shape.concat(t.shape);return L.runKernelFunc(function(r){return r.diag(e)},{$x:e}).reshape(n)}}),kG=O({dropout_:function(t,e,n,r){var o=T(t,"x","dropout");if(N(o.dtype==="float32",function(){return"x has to be a floating point tensor since it's going to be scaled, but got a "+o.dtype+" tensor instead."}),N(e>=0&&e<1,function(){return"rate must be a float in the range [0, 1), but got "+e+"."}),e===0)return t instanceof tt?o.clone():o;var i=function(u,c){if(c==null)return u.shape.slice();if(Nt(u.shape,c))return c;if(u.shape.length===c.length){for(var l=[],d=0;d<u.shape.length;d++)c[d]==null&&u.shape[d]!=null?l.push(u.shape[d]):l.push(c[d]);return l}return c}(o,n),a=1-e,s=rR(i,0,1,"float32",r).add(a).floor().div(a);return o.mul(s)}});function sT(t,e,n){for(var r=1-t%2,o=new Float32Array(t),i=0;i<t;++i){var a=2*Math.PI*i/(t+r-1);o[i]=e-n*Math.cos(a)}return mt(o,"float32")}var l0=O({hannWindow_:function(t){return sT(t,.5,.5)}}),uT=O({hammingWindow_:function(t){return sT(t,.54,.46)}}),d0=O({frame_:function(t,e,n,r,o){r===void 0&&(r=!1),o===void 0&&(o=0);for(var i=0,a=[];i+e<=t.size;)a.push(Kr(t,i,e)),i+=n;if(r)for(;i<t.size;){var s=i+e-t.size,u=wt([Kr(t,i,e-s),Hr([s],o)]);a.push(u),i+=n}return a.length===0?wi([],[0,e]):wt(a).as2D(a.length,e)}}),cT=O({stft_:function(t,e,n,r,o){var i;o===void 0&&(o=l0),r==null&&(i=e,r=Math.floor(Math.pow(2,Math.ceil(Math.log(i)/Math.log(2)))));for(var a=d0(t,e,n),s=Yt(a,o(e)),u=[],c=0;c<a.shape[0];c++)u.push(c0(s.slice([c,0],[1,e]),r));return wt(u)}}),IG=Object.freeze({hannWindow:l0,hammingWindow:uT,frame:d0,stft:cT}),Xt,RG=function(t,e,n){return n===void 0&&(n=1),ue(this,void 0,void 0,function(){var r,o,i,a,s,u,c,l,d,f,h,m,p,g;return ce(this,function(v){switch(v.label){case 0:return r=T(t,"predictions","inTopK"),o=T(e,"targets","inTopK"),N(r.rank>1,function(){return"inTopK() expects the predictions to be of rank 2 or higher, but got "+r.rank}),N(r.rank-1===o.rank,function(){return"predictions rank should be 1 larger than targets rank, but got predictions rank "+r.rank+" and targets rank "+o.rank}),We(r.shape.slice(0,r.shape.length-1),o.shape,"predictions's shape should be align with the targets' shape, except the last dimension."),i=r.shape[r.shape.length-1],N(n>0&&n<=i,function(){return"'k' passed to inTopK() must be > 0 && <= the predictions last dimension ("+i+"), but got "+n}),[4,r.data()];case 1:return a=v.sent(),[4,o.data()];case 2:for(s=v.sent(),u=[a.length/i,i],l=u[1],d=Cc("bool",c=u[0]),f=0;f<c;f++){for(h=f*l,m=a.subarray(h,h+l),p=[],g=0;g<m.length;g++)p.push({value:m[g],index:g});for(p.sort(function(y,x){return x.value-y.value}),d[f]=0,g=0;g<n;g++)if(p[g].index===s[f]){d[f]=1;break}}return t!==r&&r.dispose(),e!==o&&o.dispose(),[2,Ft(d,o.shape,"bool")]}})})};(function(t){t[t.NONE=0]="NONE",t[t.MEAN=1]="MEAN",t[t.SUM=2]="SUM",t[t.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(Xt||(Xt={}));var TG=O({absoluteDifference_:function(t,e,n,r){r===void 0&&(r=Xt.SUM_BY_NONZERO_WEIGHTS);var o=T(t,"labels","absoluteDifference"),i=T(e,"predictions","absoluteDifference"),a=null;n!=null&&(a=T(n,"weights","absoluteDifference")),We(o.shape,i.shape,"Error in absoluteDifference: ");var s=o.sub(i).abs();return No(s,a,r)}}),No=O({computeWeightedLoss_:function(t,e,n){n===void 0&&(n=Xt.SUM_BY_NONZERO_WEIGHTS);var r=T(t,"losses","computeWeightedLoss"),o=null;e!=null&&(o=T(e,"weights","computeWeightedLoss"));var i=o==null?r:r.mul(o);if(n===Xt.NONE)return i;if(n===Xt.SUM)return i.sum();if(n===Xt.MEAN){if(o==null)return i.mean();var a=r.size/o.size,s=i.sum().div(o.sum());return a>1?s.div(oe(a)):s}if(n===Xt.SUM_BY_NONZERO_WEIGHTS){if(o==null)return i.sum().div(oe(r.size));var u=o.mul(lu(r.shape)).notEqual(oe(0)).sum().toFloat();return i.sum().div(u)}throw Error("Unknown reduction: "+n)}}),NG=O({cosineDistance_:function(t,e,n,r,o){o===void 0&&(o=Xt.SUM_BY_NONZERO_WEIGHTS);var i=T(t,"labels","cosineDistance"),a=T(e,"predictions","cosineDistance"),s=null;r!=null&&(s=T(r,"weights","cosineDistance")),We(i.shape,a.shape,"Error in cosineDistance: ");var u=oe(1).sub(i.mul(a).sum(n,!0));return No(u,s,o)}}),AG=O({hingeLoss_:function(t,e,n,r){r===void 0&&(r=Xt.SUM_BY_NONZERO_WEIGHTS);var o=T(t,"labels","hingeLoss"),i=T(e,"predictions","hingeLoss"),a=null;n!=null&&(a=T(n,"weights","hingeLoss")),We(o.shape,i.shape,"Error in hingeLoss: ");var s=oe(1);o=oe(2).mul(o).sub(s);var u=s.sub(o.mul(i)).relu();return No(u,a,r)}}),PG=O({huberLoss_:function(t,e,n,r,o){r===void 0&&(r=1),o===void 0&&(o=Xt.SUM_BY_NONZERO_WEIGHTS);var i=T(t,"labels","huberLoss"),a=T(e,"predictions","huberLoss"),s=null;n!=null&&(s=T(n,"weights","huberLoss")),We(i.shape,a.shape,"Error in huberLoss: ");var u=oe(r),c=a.sub(i).abs(),l=$R(c,u),d=c.sub(l),f=oe(.5).mul(l.square()).add(u.mul(d));return No(f,s,o)}}),DG=O({logLoss_:function(t,e,n,r,o){r===void 0&&(r=1e-7),o===void 0&&(o=Xt.SUM_BY_NONZERO_WEIGHTS);var i=T(t,"labels","logLoss"),a=T(e,"predictions","logLoss"),s=null;n!=null&&(s=T(n,"weights","logLoss")),We(i.shape,a.shape,"Error in logLoss: ");var u=oe(1),c=oe(r),l=i.mul(a.add(c).log()).neg().sub(u.sub(i).mul(u.sub(a).add(c).log()));return No(l,s,o)}}),MG=O({meanSquaredError_:function(t,e,n,r){r===void 0&&(r=Xt.SUM_BY_NONZERO_WEIGHTS);var o=T(t,"labels","meanSquaredError"),i=T(e,"predictions","meanSquaredError"),a=null;n!=null&&(a=T(n,"weights","meanSquaredError")),We(o.shape,i.shape,"Error in meanSquaredError: ");var s=o.squaredDifference(i);return No(s,a,r)}}),OG=O({sigmoidCrossEntropy_:function(t,e,n,r,o){r===void 0&&(r=0),o===void 0&&(o=Xt.SUM_BY_NONZERO_WEIGHTS);var i=T(t,"multiClassLabels","sigmoidCrossEntropy"),a=T(e,"logits","sigmoidCrossEntropy"),s=null;if(n!=null&&(s=T(n,"weights","sigmoidCrossEntropy")),We(i.shape,a.shape,"Error in sigmoidCrossEntropy: "),r>0){var u=oe(r),c=oe(1),l=oe(.5);i=i.mul(c.sub(u)).add(l.mul(u))}var d=function(f,h){var m=T(f,"labels","sigmoidCrossEntropyWithLogits"),p=T(h,"logits","sigmoidCrossEntropyWithLogits");We(m.shape,p.shape,"Error in sigmoidCrossEntropyWithLogits: ");var g=p.relu(),v=p.mul(m),y=p.abs().neg().exp().log1p();return g.sub(v).add(y)}(i,a);return No(d,s,o)}}),FG=O({softmaxCrossEntropy_:function(t,e,n,r,o){r===void 0&&(r=0),o===void 0&&(o=Xt.SUM_BY_NONZERO_WEIGHTS);var i=T(t,"onehotLabels","softmaxCrossEntropy"),a=T(e,"logits","softmaxCrossEntropy"),s=null;if(n!=null&&(s=T(n,"weights","softmaxCrossEntropy")),We(i.shape,a.shape,"Error in softmaxCrossEntropy: "),r>0){var u=oe(r),c=oe(1),l=oe(i.shape[1]);i=i.mul(c.sub(u)).add(u.div(l))}var d=function(f,h,m){if(m===void 0&&(m=-1),m===-1&&(m=h.rank-1),m!==h.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank "+h.rank+" and dim was "+m);return Sh(function(p,g,v){var y=g.logSumExp([m],!0),x=g.toFloat().sub(y);return v([p,x]),{value:x.mul(p).neg().sum([m]),gradFunc:function(w,E){var _=E[0],S=E[1],k=xn(w.shape,[m]);return[w.reshape(k).mul(_.toFloat().sub(S.exp())),w.reshape(k).mul(S.exp().sub(_.toFloat()))]}}})(f,h)}(i,a);return No(d,s,o)}}),LG=Object.freeze({get Reduction(){return Xt},absoluteDifference:TG,computeWeightedLoss:No,cosineDistance:NG,hingeLoss:AG,huberLoss:PG,logLoss:DG,meanSquaredError:MG,sigmoidCrossEntropy:OG,softmaxCrossEntropy:FG});function wb(t,e){return e===void 0&&(e=!1),L.tidy(function(){if(t.shape.length!==2)throw new Error("qr2d() requires a 2D Tensor, but got a "+t.shape.length+"D Tensor.");for(var n=t.shape[0],r=t.shape[1],o=nR(n),i=t.clone(),a=wi([[1]],[1,1]),s=a.clone(),u=n>=r?r:n,c=function(d){var f,h=i,m=s,p=o;f=L.tidy(function(){var g=i.slice([d,d],[n-d,1]),v=g.norm(),y=i.slice([d,d],[1,1]),x=wi([[-1]]).where(y.greater(0),wi([[1]])),w=y.sub(x.mul(v)),E=g.div(w);s=E.shape[0]===1?a.clone():a.concat(E.slice([1,0],[E.shape[0]-1,E.shape[1]]),0);var _=x.matMul(w).div(v).neg(),S=i.slice([d,0],[n-d,r]),k=_.mul(s);if(d===0)i=S.sub(k.matMul(s.transpose().matMul(S)));else{var I=S.sub(k.matMul(s.transpose().matMul(S)));i=i.slice([0,0],[d,r]).concat(I,0)}var R=o.slice([0,d],[n,o.shape[1]-d]);if(d===0)o=R.sub(R.matMul(s).matMul(k.transpose()));else{var D=R.sub(R.matMul(s).matMul(k.transpose()));o=o.slice([0,0],[n,d]).concat(D,1)}return[s,i,o]}),s=f[0],i=f[1],o=f[2],gn([h,m,p])},l=0;l<u;++l)c(l);return!e&&n>r&&(o=o.slice([0,0],[n,r]),i=i.slice([0,0],[r,r])),[o,i]})}var BG=O({bandPart_:function(t,e,n){if(e%1!=0)throw new Error("bandPart(): numLower must be an integer, got "+e+".");if(n%1!=0)throw new Error("bandPart(): numUpper must be an integer, got "+n+".");var r=T(t,"a","bandPart");if(r.rank<2)throw new Error("bandPart(): Rank must be at least 2, got "+r.rank+".");var o=r.shape,i=r.shape.slice(-2),a=i[0],s=i[1];if(!(e<=a))throw new Error("bandPart(): numLower ("+e+") must not be greater than the number of rows ("+a+").");if(!(n<=s))throw new Error("bandPart(): numUpper ("+n+") must not be greater than the number of columns ("+s+").");e<0&&(e=a),n<0&&(n=s);var u=xf(0,a,1,"int32").reshape([-1,1]),c=xf(0,s,1,"int32"),l=Ct(u,c),d=Ih(l.lessEqual(oe(+e,"int32")),l.greaterEqual(oe(-n,"int32"))),f=Xe([a,s],r.dtype);return Dn(bt(r.reshape([-1,a,s])).map(function(h){return ga(d,h,f)})).reshape(o)}}),jG=O({gramSchmidt_:function(t){var e;if(Array.isArray(t)){e=!1,N(t!=null&&t.length>0,function(){return"Gram-Schmidt process: input must not be null, undefined, or empty"});for(var n=t[0].shape[0],r=function(u){N(t[u].shape[0]===n,function(){return"Gram-Schmidt: Non-unique lengths found in the input vectors: ("+t[u].shape[0]+" vs. "+n+")"})},o=1;o<t.length;++o)r(o)}else e=!0,t=Ky(t,t.shape[0],0).map(function(u){return iR(u,[0])});N(t.length<=t[0].shape[0],function(){return"Gram-Schmidt: Number of vectors ("+t.length+") exceeds number of dimensions ("+t[0].shape[0]+")."});var i=[],a=t,s=function(u){i.push(L.tidy(function(){var c=a[u];if(u>0)for(var l=0;l<u;++l){var d=tT(i[l].mulStrict(c)).mul(i[l]);c=c.sub(d)}return c.div(iT(c,"euclidean"))}))};for(o=0;o<t.length;++o)s(o);return e?Dn(i,0):i}}),UG=O({qr_:function(t,e){if(e===void 0&&(e=!1),t.rank<2)throw new Error("qr() requires input tensor to have a rank >= 2, but got rank "+t.rank);if(t.rank===2)return wb(t,e);var n=t.shape.slice(0,t.shape.length-2).reduce(function(a,s){return a*s}),r=bt(t.reshape([n,t.shape[t.shape.length-2],t.shape[t.shape.length-1]]),0),o=[],i=[];return r.forEach(function(a){var s=wb(a,e),u=s[0],c=s[1];o.push(u),i.push(c)}),[Dn(o,0).reshape(t.shape),Dn(i,0).reshape(t.shape)]}}),WG=Object.freeze({bandPart:BG,gramSchmidt:jG,qr:UG});function Ah(t,e,n,r,o,i){r==null&&(r=.5),o==null&&(o=Number.NEGATIVE_INFINITY),i==null&&(i=0);var a=t.shape[0];return n=Math.min(n,a),N(0<=r&&r<=1,function(){return"iouThreshold must be in [0, 1], but was '"+r+"'"}),N(t.rank===2,function(){return"boxes must be a 2D tensor, but was of rank '"+t.rank+"'"}),N(t.shape[1]===4,function(){return"boxes must have 4 columns, but 2nd dimension was "+t.shape[1]}),N(e.rank===1,function(){return"scores must be a 1D tensor"}),N(e.shape[0]===a,function(){return"scores has incompatible shape with boxes. Expected "+a+", but was "+e.shape[0]}),N(0<=i&&i<=1,function(){return"softNmsSigma must be in [0, 1], but was '"+i+"'"}),{maxOutputSize:n,iouThreshold:r,scoreThreshold:o,softNmsSigma:i}}var $G=O({resizeBilinear_:function(t,e,n){n===void 0&&(n=!1);var r=T(t,"images","resizeBilinear");N(r.rank===3||r.rank===4,function(){return"Error in resizeBilinear: x must be rank 3 or 4, but got rank "+r.rank+"."}),N(e.length===2,function(){return"Error in resizeBilinear: new shape must 2D, but got shape "+e+"."});var o=r,i=!1;r.rank===3&&(i=!0,o=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var a=e[0],s=e[1],u=L.runKernelFunc(function(c,l){return l([o]),c.resizeBilinear(o,a,s,n)},{x:o},function(c,l){return{x:function(){return L.runKernelFunc(function(d){return d.resizeBilinearBackprop(c,l[0],n)},{})}}},"ResizeBilinear",{alignCorners:n,newHeight:a,newWidth:s});return i?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),zG=O({resizeNearestNeighbor_:function(t,e,n){n===void 0&&(n=!1);var r=T(t,"images","resizeNearestNeighbor");N(r.rank===3||r.rank===4,function(){return"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank "+r.rank+"."}),N(e.length===2,function(){return"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+e+"."}),N(r.dtype==="float32"||r.dtype==="int32",function(){return"`images` must have `int32` or `float32` as dtype"});var o=r,i=!1;r.rank===3&&(i=!0,o=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var a=e[0],s=e[1],u=L.runKernelFunc(function(c,l){return l([o]),c.resizeNearestNeighbor(o,a,s,n)},{batchImages:o},function(c,l){return{batchImages:function(){return L.runKernelFunc(function(d){return d.resizeNearestNeighborBackprop(c,l[0],n)},{})}}});return i?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),VG=O({nonMaxSuppression_:function(t,e,n,r,o){r===void 0&&(r=.5),o===void 0&&(o=Number.NEGATIVE_INFINITY);var i=T(t,"boxes","nonMaxSuppression"),a=T(e,"scores","nonMaxSuppression"),s=Ah(i,a,n,r,o);n=s.maxOutputSize,r=s.iouThreshold,o=s.scoreThreshold;var u={maxOutputSize:n,iouThreshold:r,scoreThreshold:o};return L.runKernelFunc(function(c){return c.nonMaxSuppression(i,a,n,r,o)},{boxes:i,scores:a},null,"NonMaxSuppressionV3",u)}}),HG=function(t,e,n,r,o){return r===void 0&&(r=.5),o===void 0&&(o=Number.NEGATIVE_INFINITY),ue(this,void 0,void 0,function(){var i,a,s,u,c,l,d;return ce(this,function(f){switch(f.label){case 0:return i=T(t,"boxes","nonMaxSuppressionAsync"),a=T(e,"scores","nonMaxSuppressionAsync"),s=Ah(i,a,n,r,o),n=s.maxOutputSize,r=s.iouThreshold,o=s.scoreThreshold,[4,Promise.all([i.data(),a.data()])];case 1:return u=f.sent(),c=u[0],l=u[1],d=Qy(c,l,n,r,o),i!==t&&i.dispose(),a!==e&&a.dispose(),[2,d]}})})},GG=O({nonMaxSuppressionWithScore_:function(t,e,n,r,o,i){r===void 0&&(r=.5),o===void 0&&(o=Number.NEGATIVE_INFINITY),i===void 0&&(i=0);var a=T(t,"boxes","nonMaxSuppression"),s=T(e,"scores","nonMaxSuppression"),u=Ah(a,s,n,r,o,i),c={maxOutputSize:n=u.maxOutputSize,iouThreshold:r=u.iouThreshold,scoreThreshold:o=u.scoreThreshold,softNmsSigma:i=u.softNmsSigma},l=L.runKernel("NonMaxSuppressionV5",{boxes:a,scores:s},c);return{selectedIndices:l[0],selectedScores:l[1]}}}),KG=function(t,e,n,r,o,i){return r===void 0&&(r=.5),o===void 0&&(o=Number.NEGATIVE_INFINITY),i===void 0&&(i=0),ue(this,void 0,void 0,function(){var a,s,u,c,l,d,f;return ce(this,function(h){switch(h.label){case 0:return a=T(t,"boxes","nonMaxSuppressionAsync"),s=T(e,"scores","nonMaxSuppressionAsync"),u=Ah(a,s,n,r,o,i),n=u.maxOutputSize,r=u.iouThreshold,o=u.scoreThreshold,i=u.softNmsSigma,[4,Promise.all([a.data(),s.data()])];case 1:return c=h.sent(),l=c[0],d=c[1],f=Jy(l,d,n,r,o,i),a!==t&&a.dispose(),s!==e&&s.dispose(),[2,f]}})})},qG=O({cropAndResize_:function(t,e,n,r,o,i){var a=T(t,"image","cropAndResize"),s=T(e,"boxes","cropAndResize","float32"),u=T(n,"boxInd","cropAndResize","int32");o=o||"bilinear",i=i||0;var c=s.shape[0];return N(a.rank===4,function(){return"Error in cropAndResize: image must be rank 4,but got rank "+a.rank+"."}),N(s.rank===2&&s.shape[1]===4,function(){return"Error in cropAndResize: boxes must be have size ["+c+",4] but had shape "+s.shape+"."}),N(u.rank===1&&u.shape[0]===c,function(){return"Error in cropAndResize: boxInd must be have size ["+c+"] but had shape "+s.shape+"."}),N(r.length===2,function(){return"Error in cropAndResize: cropSize must be of length 2, but got length "+r.length+"."}),N(r[0]>=1&&r[1]>=1,function(){return"cropSize must be atleast [1,1], but was "+r}),N(o==="bilinear"||o==="nearest",function(){return"method must be bilinear or nearest, but was "+o}),L.runKernelFunc(function(l,d){return l.cropAndResize(a,s,u,r,o,i)},{images:a,boxes:s,boxInd:u},null,"CropAndResize",{method:o,extrapolationValue:i,cropSize:r})}}),f0=Object.freeze({resizeBilinear:$G,resizeNearestNeighbor:zG,nonMaxSuppression:VG,nonMaxSuppressionAsync:HG,nonMaxSuppressionWithScore:GG,nonMaxSuppressionWithScoreAsync:KG,cropAndResize:qG}),h0=function(t,e){return!(t>0)||e==="linear"},p0=function(t,e,n){if(n==null||n==="linear")return t;if(n==="relu")return t.mul(e.step());throw new Error("Gradient for activation "+n+" has not been implemented yet.")},m0=function(t,e){var n=e,r=Et(t.shape,e.shape);return r.length>0&&(n=n.sum(r)),n.reshape(t.shape)},v0=function(t,e,n){if(e==="linear")return t;if(e==="relu")return nt(t);if(e==="elu")return nT(t);if(e==="relu6")return oT(t);if(e==="prelu")return rT(t,n);throw new Error("Unknown fused activation "+e+".")},XG=O({fusedMatMul_:function(t){var e,n=t.a,r=t.b,o=t.transposeA,i=o!==void 0&&o,a=t.transposeB,s=a!==void 0&&a,u=t.bias,c=t.activation,l=c===void 0?"linear":c,d=t.preluActivationWeights;if(h0(L.state.gradientDepth,l)===!1){var f=Th(n,r,i,s);return u!=null&&(f=Re(f,u)),v0(f,l,d)}var h=T(n,"a","fused matMul"),m=T(r,"b","fused matMul");e=it(h,m),h=e[0],m=e[1];var p=i?h.shape[h.rank-2]:h.shape[h.rank-1],g=s?m.shape[m.rank-1]:m.shape[m.rank-2],v=i?h.shape[h.rank-1]:h.shape[h.rank-2],y=s?m.shape[m.rank-2]:m.shape[m.rank-1],x=h.shape.slice(0,-2),w=m.shape.slice(0,-2),E=le(x),_=le(w);N(h.rank>=2&&m.rank>=2&&h.rank===m.rank,function(){return"Error in fused matMul: inputs must have the same rank of at least 2, got ranks "+h.rank+" and "+m.rank+"."}),N(Nt(x,w),function(){return"Error in fused matMul: outer dimensions ("+x+") and ("+w+") of Tensors with shapes "+h.shape+" and "+m.shape+" must match."}),N(p===g,function(){return"Error in fused matMul: inner shapes ("+p+") and ("+g+") of Tensors with shapes "+h.shape+" and "+m.shape+" and transposeA="+i+" and transposeB="+s+" must match."});var S,k,I=h.shape.slice(0,-2).concat([v,y]),R=i?h.as3D(E,p,v):h.as3D(E,v,p),D=s?m.as3D(_,y,g):m.as3D(_,g,y);u!=null&&Ne(I,(S=it(S=T(u,"bias","fused matMul"),h)[0]).shape),d!=null&&(k=T(d,"prelu weights","fused matMul"));var A={a:R,b:D};u!=null&&(A.bias=S),d!=null&&(A.preluActivationWeights=k);var j=[R,D];return L.runKernelFunc(function(F,W){var U=F.fusedBatchMatMul({a:R,b:D,transposeA:i,transposeB:s,bias:S,activation:l,preluActivationWeights:k});return W([R,D,U]),U},A,function(F,W){var U=W[0],$=W[1],M=W[2],P=p0(F,M,l),B={};return u!=null&&(B={bias:function(){return m0(S,P)}}),Object.assign(i||s?!i&&s?{a:function(){return P.matMul($,!1,!1)},b:function(){return P.matMul(U,!0,!1)}}:i&&!s?{a:function(){return $.matMul(P,!1,!0)},b:function(){return U.matMul(P,!1,!1)}}:{a:function(){return $.matMul(P,!0,!0)},b:function(){return P.matMul(U,!0,!0)}}:{a:function(){return P.matMul($,!1,!0)},b:function(){return U.matMul(P,!0,!1)}},B)},"_FusedMatMul",{transposeA:i,transposeB:s,activation:l},j,[!0]).reshape(I)}}),YG=O({fusedConv2d_:function(t){var e=t.x,n=t.filter,r=t.strides,o=t.pad,i=t.dataFormat,a=i===void 0?"NHWC":i,s=t.dilations,u=s===void 0?[1,1]:s,c=t.dimRoundingMode,l=t.bias,d=t.activation,f=d===void 0?"linear":d,h=t.preluActivationWeights;if(f=f||"linear",h0(L.state.gradientDepth,f)===!1){var m=Yn(e,n,r,o,a,u,c);return l!=null&&(m=Re(m,l)),v0(m,f,h)}var p=T(e,"x","conv2d"),g=T(n,"filter","conv2d"),v=p,y=!1;p.rank===3&&(y=!0,v=p.as4D(1,p.shape[0],p.shape[1],p.shape[2])),N(v.rank===4,function(){return"Error in fused conv2d: input must be rank 4, but got rank "+v.rank+"."}),N(g.rank===4,function(){return"Error in fused conv2d: filter must be rank 4, but got rank "+g.rank+"."}),c!=null&&N(ft(o),function(){return"Error in fused conv2d: pad must be an integer when using, dimRoundingMode "+c+" but got pad "+o+"."}),N(v.shape[3]===g.shape[2],function(){return"Error in conv2d: depth of input ("+v.shape[3]+") must match input depth for filter "+g.shape[2]+"."}),N(wn(r,u),function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+u+"'"}),N(a==="NHWC",function(){return"Error in conv2d: got dataFormat of "+a+" but only NHWC is currently supported."});var x,w,E=Ra(v.shape,g.shape,r,u,o,c);l!=null&&(x=it(x=T(l,"bias","fused conv2d"),p)[0],Ne(E.outShape,x.shape)),h!=null&&(w=T(h,"prelu weights","fused conv2d"));var _={x:v,filter:g};l!=null&&(_.bias=x),h!=null&&(_.preluActivationWeights=w);var S=[g,v],k=L.runKernelFunc(function(I,R){var D=I.fusedConv2d({input:v,filter:g,convInfo:E,bias:x,activation:f,preluActivationWeights:w});return R([g,v,D]),D},_,function(I,R){var D=R,A=D[0],j=D[1],F=D[2],W=p0(I,F,f);N(eu(u),function(){return"Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+u+"'"});var U={};return l!=null&&(U={bias:function(){return m0(x,W)}}),Object.assign({x:function(){return qR(j.shape,W,A,r,o)},filter:function(){return a0(j,W,A.shape,r,o)}},U)},"FusedConv2D",{convInfo:E,activation:f},S,[!0]);return y?k.as3D(k.shape[1],k.shape[2],k.shape[3]):k}}),QG=O({fusedDepthwiseConv2d_:function(t){var e=t.x,n=t.filter,r=t.strides,o=t.pad,i=t.dataFormat,a=i===void 0?"NHWC":i,s=t.dilations,u=s===void 0?[1,1]:s,c=t.dimRoundingMode,l=t.bias,d=t.activation,f=d===void 0?"linear":d,h=t.preluActivationWeights;if(h0(L.state.gradientDepth,f)===!1){var m=Rh(e,n,r,o,a,u,c);return l!=null&&(m=Re(m,l)),v0(m,f,h)}var p=T(e,"x","depthwiseConv2d"),g=T(n,"filter","depthwiseConv2d"),v=p,y=!1;p.rank===3&&(y=!0,v=p.as4D(1,p.shape[0],p.shape[1],p.shape[2])),N(v.rank===4,function(){return"Error in fused depthwiseConv2d: input must be rank 4, but got rank "+v.rank+"."}),N(g.rank===4,function(){return"Error in fused depthwiseConv2d: filter must be rank 4, but got rank "+g.rank+"."}),N(v.shape[3]===g.shape[2],function(){return"Error in fused depthwiseConv2d: number of input channels ("+v.shape[3]+") must match the inChannels dimension in filter "+g.shape[2]+"."}),u==null&&(u=[1,1]),N(wn(r,u),function(){return"Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+u+"'"}),c!=null&&N(ft(o),function(){return"Error in fused depthwiseConv2d: pad must be an integer when using dimRoundingMode "+c+" but got pad "+o+"."});var x,w,E=Ra(v.shape,g.shape,r,u,o,c,!0);l!=null&&(x=it(x=T(l,"bias","fused conv2d"),p)[0],Ne(E.outShape,x.shape)),h!=null&&(w=T(h,"prelu weights","fused depthwiseConv2d"));var _={x:v,filter:g};l!=null&&(_.bias=x),h!=null&&(_.preluActivationWeights=w);var S=[g,v],k=L.runKernelFunc(function(I,R){var D=I.fusedDepthwiseConv2D({input:v,filter:g,convInfo:E,bias:x,activation:f,preluActivationWeights:w});return R([g,v,D]),D},_,function(I,R){N(eu(u),function(){return"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+u+"'"});var D=R[0],A=R[1],j=R[2],F=p0(I,j,f),W={};return l!=null&&(W={bias:function(){return m0(x,F)}}),Object.assign({x:function(){return XR(A.shape,F,D,E)},filter:function(){return YR(A,F,D.shape,E)}},W)},"FusedDepthwiseConv2D",{convInfo:E,activation:f},S,[!0]);return y?k.as3D(k.shape[1],k.shape[2],k.shape[3]):k}}),JG=Object.freeze({matMul:XG,conv2d:YG,depthwiseConv2d:QG}),ZG=Object.freeze({image:f0,linalg:WG,losses:LG,spectral:EG,fused:JG,signal:IG,square:DV,squaredDifference:PR,conv1d:$H,conv2d:Yn,conv3d:zH,depthwiseConv2d:Rh,separableConv2d:s0,conv2dTranspose:VH,conv3dTranspose:HH,op:O,batchNormalization2d:cH,batchNormalization3d:lH,batchNormalization4d:dH,batchNormalization:fH,batchNorm:BR,batchNorm2d:hH,batchNorm3d:pH,batchNorm4d:mH,booleanMaskAsync:WH,complex:Mt,real:$n,imag:Or,concat:wt,concat1d:JW,concat2d:ZW,concat3d:e$,concat4d:t$,split:Ky,matMul:Th,dot:GH,outerProduct:KH,reverse:ol,reverse1d:qH,reverse2d:XH,reverse3d:YH,reverse4d:QH,maxPool:It,avgPool:il,pool:JH,maxPool3d:ZH,avgPool3d:eG,slice:Kr,slice1d:tG,slice2d:nG,slice3d:ZR,slice4d:rG,abs:MV,acos:OV,acosh:FV,asin:LV,asinh:BV,atan:jV,atanh:UV,ceil:WV,clipByValue:r0,cos:$V,cosh:zV,erf:VV,exp:Xv,expm1:HV,floor:GV,log:KV,log1p:qV,logSigmoid:XV,neg:If,reciprocal:YV,round:QV,rsqrt:DR,sigmoid:MR,sign:JV,isNaN:ZV,isInf:eH,isFinite:tH,sin:nH,sinh:rH,softplus:oH,sqrt:iH,step:aH,tan:sH,tanh:uH,all:oG,any:iG,argMax:aG,argMin:sG,logSumExp:uG,max:Nh,mean:cG,min:lG,moments:dG,sum:tT,prod:fG,equal:zR,equalStrict:AH,greater:PH,greaterEqual:VR,greaterEqualStrict:DH,greaterStrict:MH,less:OH,lessEqual:FH,lessEqualStrict:LH,lessStrict:BH,notEqual:jH,notEqualStrict:UH,add:Re,addN:yH,addStrict:xH,atan2:wH,div:lr,divNoNan:bH,divStrict:EH,floorDiv:WR,maximum:o0,maximumStrict:CH,minimum:$R,minimumStrict:_H,mod:SH,modStrict:kH,mul:Yt,mulStrict:IH,pow:Rf,powStrict:RH,squaredDifferenceStrict:TH,sub:Ct,subStrict:NH,elu:nT,leakyRelu:hG,prelu:rT,relu:nt,relu6:oT,selu:pG,logicalAnd:Ih,logicalNot:vH,logicalOr:jR,logicalXor:gH,where:ga,whereAsync:UR,buffer:Ce,print:l$,batchToSpaceND:tR,broadcastTo:d$,cast:f$,clone:h$,cumsum:p$,depthToSpace:m$,expandDims:Wn,eye:nR,multinomial:v$,oneHot:Hv,pad:Ia,pad1d:g$,pad2d:y$,pad3d:x$,pad4d:w$,rand:b$,randomNormal:E$,randomGamma:C$,randomUniform:rR,reshape:hr,spaceToBatchND:oR,squeeze:iR,stack:Dn,tile:xs,truncatedNormal:_$,unstack:bt,setdiff1dAsync:S$,fill:Hr,linspace:QW,ones:lu,range:xf,scalar:oe,tensor:Ft,tensor1d:mt,tensor2d:wi,tensor3d:Gy,tensor4d:ln,tensor5d:qW,tensor6d:XW,variable:YW,zeros:Xe,onesLike:eR,zerosLike:Me,transpose:Ii,softmax:To,logSoftmax:P$,localResponseNormalization:mG,norm:iT,gather:i0,unsortedSegmentSum:HR,basicLSTMCell:vG,multiRNNCell:gG,movingAverage:yG,stridedSlice:xG,topk:wG,scatterND:bG,fft:u0,ifft:Tf,rfft:c0,irfft:aT,sparseToDense:CG,gatherND:_G,diag:SG,dropout:kG,hannWindow:l0,hammingWindow:uT,frame:d0,stft:cT,inTopKAsync:RG});function Y(t,e){Array.isArray(t)||(t=[t]),t.forEach(function(n){n!=null&&N(n.dtype!=="complex64",function(){return e+" does not support complex64 tensors."})})}function tm(t,e,n,r){if(n==="linear")return t.linear(e);if(n==="relu")return t.relu(e);if(n==="elu")return t.elu(e);if(n==="relu6")return t.relu6(e);if(n==="prelu")return t.prelu(e,r);throw new Error("Activation "+n+" has not been implemented for the CPU backend.")}var e7=function(t){function e(){var n=t.call(this)||this;return n.blockSize=48,n.firstUse=!0,n.data=new fR(n,L),n}return br(e,t),e.prototype.write=function(n,r,o){this.firstUse&&(this.firstUse=!1,K().get("IS_NODE")&&gf(`
============================
Hi there . Looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, which binds to TensorFlow C++, by running npm i @tensorflow/tfjs-node, or npm i @tensorflow/tfjs-node-gpu if you have CUDA. Then call require('@tensorflow/tfjs-node'); (-gpu suffix for CUDA) at the start of your program. Visit https://github.com/tensorflow/tfjs-node for more details.
============================`));var i={};return this.data.set(i,{values:n,dtype:o}),i},e.prototype.move=function(n,r,o,i){this.data.set(n,{values:r,dtype:i})},e.prototype.numDataIds=function(){return this.data.numDataIds()},e.prototype.read=function(n){return ue(this,void 0,void 0,function(){return ce(this,function(r){return[2,this.readSync(n)]})})},e.prototype.readSync=function(n){var r=this.data.get(n),o=r.dtype,i=r.complexTensors;return o==="complex64"?qv(this.readSync(i.real.dataId),this.readSync(i.imag.dataId)):this.data.get(n).values},e.prototype.bufferSync=function(n){var r=this.readSync(n.dataId),o=r;if(n.dtype==="string")try{o=r.map(function(i){return pf(i)})}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return Ce(n.shape,n.dtype,o)},e.prototype.makeOutput=function(n,r,o){var i=this.write(n,r,o);return L.makeTensorFromDataId(i,r,o,this)},e.prototype.disposeData=function(n){if(this.data.has(n)){var r=this.data.get(n).complexTensors;r!=null&&(r.real.dispose(),r.imag.dispose()),this.data.delete(n)}},e.prototype.time=function(n){return ue(this,void 0,void 0,function(){var r;return ce(this,function(o){return r=Ar(),n(),[2,{kernelMs:Ar()-r}]})})},e.prototype.memory=function(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}},e.prototype.complex=function(n,r){var o=this.makeOutput(null,n.shape,"complex64");return this.data.get(o.dataId).complexTensors={real:L.keep(n.clone()),imag:L.keep(r.clone())},o},e.prototype.real=function(n){return this.data.get(n.dataId).complexTensors.real.clone()},e.prototype.imag=function(n){return this.data.get(n.dataId).complexTensors.imag.clone()},e.prototype.slice=function(n,r,o){if(Y(n,"slice"),lR(n.shape,r,o)){var i=dR(r,n.strides),a=le(o);return Ft(this.readSync(n.dataId).subarray(i,i+a),o,n.dtype)}for(var s=Ce(o,n.dtype),u=this.bufferSync(n),c=0;c<s.size;++c){var l=s.indexToLoc(c).map(function(d,f){return d+r[f]});s.values[c]=u.get.apply(u,l)}return s.toTensor()},e.prototype.stridedSlice=function(n,r,o,i){Y(n,"stridedSlice");var a=Xy(r,o,i);if(a.some(function(h){return h===0}))return Ft([],a);for(var s=Ce(a,n.dtype),u=this.bufferSync(n),c=0;c<s.size;c++){for(var l=s.indexToLoc(c),d=new Array(l.length),f=0;f<d.length;f++)d[f]=l[f]*i[f]+r[f];s.set.apply(s,[u.get.apply(u,d)].concat(l))}return s.toTensor()},e.prototype.diag=function(n){for(var r=this.readSync(n.dataId),o=Ce([n.size,n.size],n.dtype),i=o.values,a=0;a<r.length;a++)i[a*n.size+a]=r[a];return o.toTensor()},e.prototype.unstack=function(n,r){for(var o=n.shape[r],i=new Array(n.rank-1),a=0,s=0;s<n.rank;s++)s!==r&&(i[a++]=n.shape[s]);var u=new Array(n.rank).fill(0),c=n.shape.slice();c[r]=1;var l=new Array(o);for(s=0;s<l.length;s++)u[r]=s,l[s]=this.slice(n,u,c).reshape(i);return l},e.prototype.reverse=function(n,r){Y(n,"reverse");for(var o=Ce(n.shape,n.dtype),i=this.bufferSync(n),a=function(u){var c=o.indexToLoc(u),l=c.slice();r.forEach(function(d){return l[d]=n.shape[d]-1-l[d]}),o.set.apply(o,[i.get.apply(i,l)].concat(c))},s=0;s<o.size;s++)a(s);return o.toTensor()},e.prototype.concat=function(n,r){var o=this;if(n[0].dtype==="complex64"){var i=n.map(function(h){return $n(h)}),a=n.map(function(h){return Or(h)});return Mt(this.concat(i,r),this.concat(a,r))}var s=n.map(function(h){var m=le(h.shape.slice(r));return h.as2D(-1,m)}),u=Zs(s.map(function(h){return h.shape}),1),c=Ce(u,n[0].dtype).values;if(s[0].shape[0]===1){var l=0;s.forEach(function(h){c.set(o.readSync(h.dataId),l),l+=h.size})}else{var d=0;s.forEach(function(h){for(var m=o.readSync(h.dataId),p=0,g=0;g<h.shape[0];++g)for(var v=g*u[1]+d,y=0;y<h.shape[1];++y)c[v+y]=m[p++];d+=h.shape[1]})}var f=Zs(n.map(function(h){return h.shape}),r);return Ft(c,f,n[0].dtype)},e.prototype.neg=function(n){return Y(n,"neg"),this.multiply(oe(-1),n)},e.prototype.add=function(n,r){return n.dtype==="complex64"||r.dtype==="complex64"?this.broadcastedBinaryComplexOp(n.cast("complex64"),r.cast("complex64"),function(o,i,a,s){return{real:o+a,imag:i+s}}):this.broadcastedBinaryOp(n,r,Ot(n.dtype,r.dtype),function(o,i){return o+i})},e.prototype.addN=function(n){var r=this;Y(n,"addN");for(var o=n.map(function(l){return r.readSync(l.dataId)}),i=Ce(n[0].shape,n[0].dtype),a=i.values,s=0;s<n.length;s++)for(var u=o[s],c=0;c<a.length;c++)a[c]+=u[c];return i.toTensor()},e.prototype.softmax=function(n,r){var o=_t([r],n.shape),i=this.max(n,o),a=xn(i.shape,o),s=this.subtract(n,i.reshape(a)),u=this.exp(s),c=this.sum(u,o).reshape(a);return this.realDivide(u,c)},e.prototype.subtract=function(n,r){return n.dtype==="complex64"||r.dtype==="complex64"?this.broadcastedBinaryComplexOp(n.cast("complex64"),r.cast("complex64"),function(o,i,a,s){return{real:o-a,imag:i-s}}):this.broadcastedBinaryOp(n,r,Ot(n.dtype,r.dtype),function(o,i){return o-i})},e.prototype.pow=function(n,r){return Y([n,r],"pow"),this.broadcastedBinaryOp(n,r,n.dtype,function(o,i){return Math.pow(o,i)})},e.prototype.batchMatMul=function(n,r,o,i){Y([n,r],"matMul");for(var a=o?n.shape[1]:n.shape[2],s=o?n.shape[2]:n.shape[1],u=i?r.shape[1]:r.shape[2],c=n.shape[0],l=this.readSync(n.dataId),d=this.readSync(r.dataId),f=o?[n.strides[0],1,n.strides[1]]:[n.strides[0],n.strides[1],1],h=f[0],m=f[1],p=f[2],g=i?[1,r.strides[1],r.strides[0]]:[r.strides[1],1,r.strides[0]],v=g[0],y=g[1],x=g[2],w=s*u,E=Ce([c,s,u],n.dtype),_=E.values,S=this.blockSize,k=0;k<c;k++)for(var I=0;I<s;I+=S)for(var R=0;R<u;R+=S)for(var D=0;D<a;D+=S)for(var A=Math.min(I+S,s),j=Math.min(R+S,u),F=Math.min(D+S,a),W=I;W<A;W++)for(var U=R;U<j;U++){for(var $=0,M=D;M<F;M++)$+=l[k*h+W*m+M*p]*d[M*v+U*y+k*x];_[k*w+(W*u+U)]+=$}return E.toTensor()},e.prototype.fusedBatchMatMul=function(n){var r=n.a,o=n.b,i=n.transposeA,a=n.transposeB,s=n.bias,u=n.activation,c=n.preluActivationWeights,l=this.batchMatMul(r,o,i,a);return s&&(l=this.add(l,s)),u&&(l=tm(this,l,u,c)),l},e.prototype.multiply=function(n,r){return n.dtype==="complex64"||r.dtype==="complex64"?this.broadcastedBinaryComplexOp(n.cast("complex64"),r.cast("complex64"),function(o,i,a,s){return{real:o*a-i*s,imag:o*s+i*a}}):this.broadcastedBinaryOp(n,r,Ot(n.dtype,r.dtype),function(o,i){return o*i})},e.prototype.realDivide=function(n,r){return Y([n,r],"realDivide"),this.broadcastedBinaryOp(n,r,"float32",function(o,i){return o/i})},e.prototype.floorDiv=function(n,r){return Y([n,r],"floorDiv"),this.broadcastedBinaryOp(n,r,"int32",function(o,i){return Math.floor(o/i)})},e.prototype.sum=function(n,r){Y(n,"sum"),Cn("sum",r,n.rank);for(var o=Ht(n.shape,r),i=o[0],a=o[1],s=Xe(i,Ot(n.dtype,"int32")),u=le(a),c=this.readSync(s.dataId),l=this.readSync(n.dataId),d=0;d<c.length;++d){for(var f=d*u,h=0,m=0;m<u;++m)h+=l[f+m];c[d]=h}return s},e.prototype.prod=function(n,r){Y(n,"sum");for(var o=Ht(n.shape,r),i=o[0],a=o[1],s=Xe(i,Ot(n.dtype,"int32")),u=le(a),c=this.readSync(s.dataId),l=this.readSync(n.dataId),d=0;d<c.length;++d){for(var f=d*u,h=1,m=0;m<u;++m)h*=l[f+m];c[d]=h}return s},e.prototype.unsortedSegmentSum=function(n,r,o){Y(n,"unsortedSegmentSum");for(var i=[],a=n.rank-r.rank,s=0;s<a;++s)r=r.expandDims(s+1);for(s=0;s<o;++s){var u=oe(s,"int32"),c=zR(u,r).asType("float32").mul(n).sum(0);i.push(c)}return Dn(i)},e.prototype.argMin=function(n,r){Y(n,"argMin");var o=[r];Cn("argMin",o,n.rank);for(var i=Ht(n.shape,o),a=i[0],s=i[1],u=Xe(a,"int32"),c=le(s),l=this.readSync(u.dataId),d=this.readSync(n.dataId),f=0;f<l.length;++f){for(var h=f*c,m=d[h],p=0,g=0;g<c;++g){var v=d[h+g];v<m&&(m=v,p=g)}l[f]=p}return u},e.prototype.argMax=function(n,r){Y(n,"argMax");var o=[r];Cn("argMax",o,n.rank);for(var i=Ht(n.shape,o),a=i[0],s=i[1],u=Xe(a,"int32"),c=le(s),l=this.readSync(u.dataId),d=this.readSync(n.dataId),f=0;f<l.length;++f){for(var h=f*c,m=d[h],p=0,g=0;g<c;++g){var v=d[h+g];v>m&&(m=v,p=g)}l[f]=p}return u},e.prototype.cumsum=function(n,r,o,i){if(Y(n,"cumsum"),r!==n.rank-1)throw new Error("backend.cumsum in CPU expects an inner-most axis="+(n.rank-1)+" but got axis="+r);for(var a=Ot(n.dtype,"int32"),s=Xe(n.shape,a),u=this.readSync(s.dataId),c=this.readSync(n.dataId),l=n.shape[n.rank-1],d=i?function(g,v){return g+l-v-1}:function(g,v){return g+v},f=0;f<c.length;f+=l)for(var h=0;h<l;h++){var m=d(f,h);if(h===0)u[m]=o?0:c[m];else{var p=d(f,h-1);u[m]=o?c[p]+u[p]:c[m]+u[p]}}return s},e.prototype.equal=function(n,r){return Y([n,r],"equal"),this.broadcastedBinaryOp(n,r,"bool",function(o,i){return o===i?1:0})},e.prototype.notEqual=function(n,r){return Y([n,r],"notEqual"),this.broadcastedBinaryOp(n,r,"bool",function(o,i){return o!==i?1:0})},e.prototype.less=function(n,r){return Y([n,r],"less"),this.broadcastedBinaryOp(n,r,"bool",function(o,i){return o<i?1:0})},e.prototype.lessEqual=function(n,r){return Y([n,r],"lessEqual"),this.broadcastedBinaryOp(n,r,"bool",function(o,i){return o<=i?1:0})},e.prototype.greater=function(n,r){return Y([n,r],"greater"),this.broadcastedBinaryOp(n,r,"bool",function(o,i){return o>i?1:0})},e.prototype.greaterEqual=function(n,r){return Y([n,r],"greaterEqual"),this.broadcastedBinaryOp(n,r,"bool",function(o,i){return o>=i?1:0})},e.prototype.logicalNot=function(n){Y(n,"logicalNot");for(var r=this.readSync(n.dataId),o=new Uint8Array(r.length),i=0;i<r.length;++i)o[i]=r[i]?0:1;return this.makeOutput(o,n.shape,"bool")},e.prototype.logicalAnd=function(n,r){return Y([n,r],"logicalAnd"),this.broadcastedBinaryOp(n,r,"bool",function(o,i){return o&&i})},e.prototype.logicalOr=function(n,r){return Y([n,r],"logicalOr"),this.broadcastedBinaryOp(n,r,"bool",function(o,i){return o||i})},e.prototype.select=function(n,r,o){Y([n,r,o],"select");for(var i=this.readSync(n.dataId),a=this.readSync(r.dataId),s=this.readSync(o.dataId),u=Xe(r.shape,Ot(r.dtype,o.dtype)),c=this.readSync(u.dataId),l=0,d=n.rank===0||n.rank>1||r.rank===1?1:le(r.shape.slice(1)),f=0;f<i.length;f++)for(var h=0;h<d;h++)i[f]===1?c[l++]=a[f]:c[l++]=s[f];return u},e.prototype.where=function(n){Y([n],"where");var r=this.readSync(n.dataId);return Zy(n.shape,r)},e.prototype.topk=function(n,r,o){return Y(n,"topk"),wR(this.readSync(n.dataId),n.shape,n.dtype,r)},e.prototype.min=function(n,r){Y(n,"min"),Cn("min",r,n.rank);for(var o=Ht(n.shape,r),i=o[0],a=o[1],s=Xe(i,n.dtype),u=le(a),c=this.readSync(s.dataId),l=this.readSync(n.dataId),d=0;d<c.length;++d){for(var f=d*u,h=l[f],m=0;m<u;++m){var p=l[f+m];p<h&&(h=p)}c[d]=h}return s},e.prototype.minimum=function(n,r){return Y([n,r],"minimum"),this.broadcastedBinaryOp(n,r,n.dtype,function(o,i){return Math.min(o,i)})},e.prototype.mod=function(n,r){return Y([n,r],"mod"),this.broadcastedBinaryOp(n,r,n.dtype,function(o,i){var a=o%i;return o<0&&i<0||o>=0&&i>=0?a:(a+i)%i})},e.prototype.max=function(n,r){Y(n,"max"),Cn("max",r,n.rank);for(var o=Ht(n.shape,r),i=o[0],a=o[1],s=Xe(i,n.dtype),u=le(a),c=this.readSync(s.dataId),l=this.readSync(n.dataId),d=0;d<c.length;++d){for(var f=d*u,h=l[f],m=0;m<u;++m){var p=l[f+m];p>h&&(h=p)}c[d]=h}return s},e.prototype.maximum=function(n,r){return Y([n,r],"maximum"),this.broadcastedBinaryOp(n,r,n.dtype,function(o,i){return Math.max(o,i)})},e.prototype.all=function(n,r){Y(n,"all"),Cn("all",r,n.rank);for(var o=Ht(n.shape,r),i=o[0],a=o[1],s=Xe(i,n.dtype),u=le(a),c=this.readSync(s.dataId),l=this.readSync(n.dataId),d=0;d<c.length;++d){for(var f=d*u,h=l[f],m=0;m<u;++m){var p=l[f+m];h=h&&p}c[d]=h}return s},e.prototype.any=function(n,r){Y(n,"any"),Cn("any",r,n.rank);for(var o=Ht(n.shape,r),i=o[0],a=o[1],s=Xe(i,n.dtype),u=le(a),c=this.readSync(s.dataId),l=this.readSync(n.dataId),d=0;d<c.length;++d){for(var f=d*u,h=l[f],m=0;m<u;++m){var p=l[f+m];h=h||p}c[d]=h}return s},e.prototype.squaredDifference=function(n,r){return Y([n,r],"squaredDifference"),this.broadcastedBinaryOp(n,r,n.dtype,function(o,i){var a=o-i;return a*a})},e.prototype.ceil=function(n){Y(n,"ceil");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i)o[i]=Math.ceil(r[i]);return this.makeOutput(o,n.shape,"float32")},e.prototype.floor=function(n){Y(n,"floor");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i)o[i]=Math.floor(r[i]);return this.makeOutput(o,n.shape,"float32")},e.prototype.sign=function(n){Y(n,"x");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i)r[i]<0?o[i]=-1:r[i]>0?o[i]=1:o[i]=0;return this.makeOutput(o,n.shape,"float32")},e.prototype.isNaN=function(n){Y(n,"x");for(var r=this.readSync(n.dataId),o=new Uint8Array(r.length),i=0;i<r.length;++i)Number.isNaN(r[i])&&(o[i]=1);return this.makeOutput(o,n.shape,"bool")},e.prototype.isInf=function(n){Y(n,"x");for(var r=this.readSync(n.dataId),o=new Uint8Array(r.length),i=0;i<r.length;++i)Math.abs(r[i])===1/0&&(o[i]=1);return this.makeOutput(o,n.shape,"bool")},e.prototype.isFinite=function(n){Y(n,"x");for(var r=this.readSync(n.dataId),o=new Uint8Array(r.length),i=0;i<r.length;++i)Number.isFinite(r[i])&&(o[i]=1);return this.makeOutput(o,n.shape,"bool")},e.prototype.round=function(n){Y(n,"round");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i){var a=Math.floor(r[i]);r[i]-a<.5?o[i]=Math.floor(r[i]):r[i]-a>.5?o[i]=Math.ceil(r[i]):o[i]=a%2==0?a:a+1}return this.makeOutput(o,n.shape,"float32")},e.prototype.exp=function(n){Y(n,"exp");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i)o[i]=Math.exp(r[i]);return this.makeOutput(o,n.shape,"float32")},e.prototype.expm1=function(n){Y(n,"expm1");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i)o[i]=Math.expm1(r[i]);return this.makeOutput(o,n.shape,"float32")},e.prototype.log=function(n){Y(n,"log");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i){var a=r[i];o[i]=Math.log(a)}return this.makeOutput(o,n.shape,"float32")},e.prototype.log1p=function(n){Y(n,"log1p");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i){var a=r[i];o[i]=Math.log1p(a)}return this.makeOutput(o,n.shape,"float32")},e.prototype.sqrt=function(n){Y(n,"sqrt");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i){var a=r[i];o[i]=Math.sqrt(a)}return this.makeOutput(o,n.shape,"float32")},e.prototype.rsqrt=function(n){Y(n,"rsqrt");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i){var a=r[i];o[i]=1/Math.sqrt(a)}return this.makeOutput(o,n.shape,"float32")},e.prototype.reciprocal=function(n){Y(n,"reciprocal");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i)o[i]=1/r[i];return this.makeOutput(o,n.shape,"float32")},e.prototype.linear=function(n){return n},e.prototype.relu=function(n){Y(n,"relu");for(var r=Xe(n.shape,n.dtype),o=this.readSync(r.dataId),i=this.readSync(n.dataId),a=0;a<i.length;++a)o[a]=Math.max(0,i[a]);return r},e.prototype.relu6=function(n){Y(n,"relu");for(var r=Xe(n.shape,n.dtype),o=this.readSync(r.dataId),i=this.readSync(n.dataId),a=0;a<i.length;++a)o[a]=Math.min(Math.max(0,i[a]),6);return r},e.prototype.prelu=function(n,r){return Y([n,r],"prelu"),this.broadcastedBinaryOp(n,r,n.dtype,function(o,i){return o<0?i*o:o})},e.prototype.elu=function(n){Y(n,"elu");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i){var a=o[i];r[i]=a>=0?a:Math.exp(a)-1}return this.makeOutput(r,n.shape,"float32")},e.prototype.eluDer=function(n,r){Y([n,r],"eluDer");for(var o=new Float32Array(r.size),i=this.readSync(r.dataId),a=this.readSync(n.dataId),s=0;s<i.length;++s){var u=i[s];o[s]=u>=1?a[s]:a[s]*(u+1)}return this.makeOutput(o,r.shape,"float32")},e.prototype.selu=function(n){Y(n,"selu");for(var r=t0,o=n0,i=new Float32Array(n.size),a=this.readSync(n.dataId),s=0;s<a.length;++s){var u=a[s];i[s]=u>=0?o*u:r*(Math.exp(u)-1)}return this.makeOutput(i,n.shape,"float32")},e.prototype.clip=function(n,r,o){Y(n,"clip");for(var i=new Float32Array(n.size),a=this.readSync(n.dataId),s=0;s<a.length;++s){var u=a[s];i[s]=u>o?o:u<r?r:u}return this.makeOutput(i,n.shape,"float32")},e.prototype.abs=function(n){for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.abs(o[i]);return this.makeOutput(r,n.shape,"float32")},e.prototype.complexAbs=function(n){for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<n.size;++i){var a=o[2*i],s=o[2*i+1];r[i]=Math.hypot(a,s)}return this.makeOutput(r,n.shape,"float32")},e.prototype.int=function(n){Y(n,"int");for(var r=new Int32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=o[i];return this.makeOutput(r,n.shape,"int32")},e.prototype.sigmoid=function(n){Y(n,"sigmoid");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=1/(1+Math.exp(-o[i]));return this.makeOutput(r,n.shape,"float32")},e.prototype.softplus=function(n){Y(n,"softplus");for(var r=Math.log(11920928955078125e-23)+2,o=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a){var s=i[a]>-r,u=i[a]<r,c=Math.exp(i[a]),l=void 0;l=u?c:s?i[a]:Math.log(1+c),o[a]=l}return this.makeOutput(o,n.shape,"float32")},e.prototype.sin=function(n){Y(n,"sin");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.sin(o[i]);return this.makeOutput(r,n.shape,"float32")},e.prototype.cos=function(n){Y(n,"cos");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.cos(o[i]);return this.makeOutput(r,n.shape,"float32")},e.prototype.tan=function(n){Y(n,"tan");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.tan(o[i]);return this.makeOutput(r,n.shape,"float32")},e.prototype.asin=function(n){Y(n,"asin");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.asin(o[i]);return this.makeOutput(r,n.shape,"float32")},e.prototype.acos=function(n){Y(n,"acos");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.acos(o[i]);return this.makeOutput(r,n.shape,"float32")},e.prototype.atan=function(n){Y(n,"atan");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.atan(o[i]);return this.makeOutput(r,n.shape,"float32")},e.prototype.atan2=function(n,r){return Y([n,r],"atan2"),this.broadcastedBinaryOp(n,r,n.dtype,function(o,i){return Math.atan2(o,i)})},e.prototype.sinh=function(n){Y(n,"sinh");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.sinh(o[i]);return this.makeOutput(r,n.shape,"float32")},e.prototype.cosh=function(n){Y(n,"cosh");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.cosh(o[i]);return this.makeOutput(r,n.shape,"float32")},e.prototype.tanh=function(n){Y(n,"tanh");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=tW(o[i]);return this.makeOutput(r,n.shape,"float32")},e.prototype.asinh=function(n){Y(n,"asinh");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.asinh(o[i]);return this.makeOutput(r,n.shape,"float32")},e.prototype.acosh=function(n){Y(n,"acosh");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.acosh(o[i]);return this.makeOutput(r,n.shape,"float32")},e.prototype.atanh=function(n){Y(n,"atanh");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.atanh(o[i]);return this.makeOutput(r,n.shape,"float32")},e.prototype.erf=function(n){Y(n,"erf");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i){var a=Math.sign(o[i]),s=Math.abs(o[i]),u=1/(1+.3275911*s);r[i]=a*(1-((((1.061405429*u-1.453152027)*u+1.421413741)*u-.284496736)*u+.254829592)*u*Math.exp(-s*s))}return this.makeOutput(r,n.shape,"float32")},e.prototype.step=function(n,r){r===void 0&&(r=0),Y(n,"step");for(var o=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a){var s=i[a];isNaN(s)?o[a]=NaN:o[a]=s>0?1:r}return this.makeOutput(o,n.shape,"float32")},e.prototype.fusedConv2d=function(n){var r=n.input,o=n.filter,i=n.convInfo,a=n.bias,s=n.activation,u=n.preluActivationWeights,c=this.conv2d(r,o,i);return a&&(c=this.add(c,a)),s&&(c=tm(this,c,s,u)),c},e.prototype.conv2d=function(n,r,o){Y([n,r],"conv2d");for(var i=o.filterHeight,a=o.filterWidth,s=o.dilationHeight,u=o.dilationWidth,c=o.padInfo.left,l=o.padInfo.top,d=o.dataFormat==="channelsLast",f=Ce(o.outShape,n.dtype),h=n.strides[0],m=d?n.strides[1]:n.strides[2],p=d?n.strides[2]:1,g=d?1:n.strides[1],v=f.strides[0],y=d?f.strides[1]:f.strides[2],x=d?f.strides[2]:1,w=d?1:f.strides[1],E=this.readSync(n.dataId),_=this.readSync(r.dataId),S=f.values,k=0;k<o.batchSize;++k)for(var I=k*h,R=k*v,D=0;D<o.outHeight;++D)for(var A=R+D*y,j=D*o.strideHeight-l,F=0;F<i;F++){var W=j+F*s;if(!(W<0||W>=o.inHeight))for(var U=F*r.strides[0],$=I+W*m,M=0;M<o.outWidth;++M)for(var P=A+M*x,B=M*o.strideWidth-c,G=0;G<a;G++){var q=B+G*u;if(!(q<0||q>=o.inWidth))for(var J=$+q*p,H=U+G*r.strides[1],Q=0;Q<o.inChannels;++Q){for(var ne=E[J+Q*g],Z=0;Z<o.outChannels;++Z)S[P+Z*w]+=ne*_[H+Z];H+=o.outChannels}}}return f.toTensor()},e.prototype.conv3d=function(n,r,o){for(var i=o.filterDepth,a=o.filterHeight,s=o.filterWidth,u=o.dilationDepth,c=o.dilationHeight,l=o.dilationWidth,d=o.padInfo.front,f=o.padInfo.left,h=o.padInfo.top,m=Ce(o.outShape,n.dtype),p=this.readSync(n.dataId),g=this.readSync(r.dataId),v=m.values,y=0;y<o.batchSize;++y)for(var x=y*n.strides[0],w=y*m.strides[0],E=0;E<o.outDepth;++E)for(var _=w+E*m.strides[1],S=E*o.strideDepth-d,k=0;k<i;k++){var I=S+k*u;if(!(I<0||I>=o.inDepth))for(var R=k*r.strides[0],D=x+I*n.strides[1],A=0;A<o.outHeight;++A)for(var j=_+A*m.strides[2],F=A*o.strideHeight-h,W=0;W<a;W++){var U=F+W*c;if(!(U<0||U>=o.inHeight))for(var $=R+W*r.strides[1],M=D+U*n.strides[2],P=0;P<o.outWidth;++P)for(var B=j+P*o.outChannels,G=P*o.strideWidth-f,q=0;q<s;q++){var J=G+q*l;if(!(J<0||J>=o.inWidth))for(var H=$+q*r.strides[2],Q=M+J*o.inChannels,ne=H,Z=0;Z<o.inChannels;++Z){for(var se=p[Q+Z],re=0;re<o.outChannels;++re)v[B+re]+=se*g[ne+re];ne+=o.outChannels}}}}return m.toTensor()},e.prototype.conv2dDerInput=function(n,r,o){Y([n,r],"conv2dDerInput");for(var i=Ce(o.inShape,"float32"),a=i.values,s=this.readSync(n.dataId),u=this.readSync(r.dataId),c=r.strides,l=c[0],d=c[1],f=c[2],h=o.batchSize,m=o.filterHeight,p=o.filterWidth,g=o.inChannels,v=o.inHeight,y=o.inWidth,x=o.outChannels,w=o.outHeight,E=o.outWidth,_=o.strideHeight,S=o.strideWidth,k=o.dataFormat,I=m-1-o.padInfo.top,R=p-1-o.padInfo.left,D=k==="channelsLast",A=i.strides[0],j=D?i.strides[1]:i.strides[2],F=D?i.strides[2]:1,W=D?1:i.strides[1],U=n.strides[0],$=D?n.strides[1]:n.strides[2],M=D?n.strides[2]:1,P=D?1:n.strides[1],B=0;B<h;++B)for(var G=0;G<g;++G)for(var q=0;q<v;++q)for(var J=q-I,H=Math.max(0,Math.ceil(J/_)),Q=Math.min(w,(m+J)/_),ne=0;ne<y;++ne){for(var Z=ne-R,se=Math.max(0,Math.ceil(Z/S)),re=Math.min(E,(p+Z)/S),xe=0,pe=H;pe<Q;++pe)for(var be=pe*_-J,ve=se;ve<re;++ve)for(var Pe=U*B+$*pe+M*ve,Ue=l*(m-1-be)+d*(p-1-(ve*S-Z))+f*G,Le=0;Le<x;++Le)xe+=s[Pe+P*Le]*u[Ue+Le];a[A*B+j*q+F*ne+W*G]=xe}return i.toTensor()},e.prototype.conv3dDerInput=function(n,r,o){for(var i=Ce(o.inShape,"float32"),a=i.values,s=i.strides,u=s[0],c=s[1],l=s[2],d=s[3],f=this.readSync(n.dataId),h=n.strides,m=h[0],p=h[1],g=h[2],v=h[3],y=this.readSync(r.dataId),x=r.strides,w=x[0],E=x[1],_=x[2],S=x[3],k=o.batchSize,I=o.filterDepth,R=o.filterHeight,D=o.filterWidth,A=o.inChannels,j=o.inDepth,F=o.inHeight,W=o.inWidth,U=o.outChannels,$=o.outDepth,M=o.outHeight,P=o.outWidth,B=o.strideDepth,G=o.strideHeight,q=o.strideWidth,J=I-1-o.padInfo.front,H=R-1-o.padInfo.top,Q=D-1-o.padInfo.left,ne=0;ne<k;++ne)for(var Z=0;Z<A;++Z)for(var se=0;se<j;++se)for(var re=se-J,xe=Math.max(0,Math.ceil(re/B)),pe=Math.min($,(I+re)/B),be=0;be<F;++be)for(var ve=be-H,Pe=Math.max(0,Math.ceil(ve/G)),Ue=Math.min(M,(R+ve)/G),Le=0;Le<W;++Le){for(var St=Le-Q,ht=Math.max(0,Math.ceil(St/q)),ct=Math.min(P,(D+St)/q),Qn=0,kt=xe;kt<pe;++kt)for(var Qe=kt*B-re,lt=Pe;lt<Ue;++lt)for(var jt=lt*G-ve,Jn=ht;Jn<ct;++Jn)for(var Ut=m*ne+p*kt+g*lt+v*Jn,bn=w*(I-1-Qe)+E*(R-1-jt)+_*(D-1-(Jn*q-St))+S*Z,Ln=0;Ln<U;++Ln)Qn+=f[Ut+Ln]*y[bn+Ln];a[u*ne+c*se+l*be+d*Le+Z]=Qn}return i.toTensor()},e.prototype.conv2dDerFilter=function(n,r,o){Y([n,r],"conv2dDerFilter");for(var i=o.strideHeight,a=o.strideWidth,s=o.filterHeight,u=o.filterWidth,c=o.dataFormat==="channelsLast",l=Ce(o.filterShape,"float32"),d=o.padInfo.left,f=o.padInfo.top,h=this.bufferSync(n),m=this.bufferSync(r),p=0;p<s;++p)for(var g=Math.max(0,Math.ceil((f-p)/i)),v=Math.min(o.outHeight,(o.inHeight+f-p)/i),y=0;y<u;++y)for(var x=Math.max(0,Math.ceil((d-y)/a)),w=Math.min(o.outWidth,(o.inWidth+d-y)/a),E=0;E<o.inChannels;++E)for(var _=0;_<o.outChannels;++_){for(var S=0,k=0;k<o.batchSize;++k)for(var I=g;I<v;++I)for(var R=p+I*i-f,D=x;D<w;++D){var A=y+D*a-d;S+=c?h.get(k,R,A,E)*m.get(k,I,D,_):h.get(k,E,R,A)*m.get(k,_,I,D)}l.set(S,p,y,E,_)}return l.toTensor()},e.prototype.conv3dDerFilter=function(n,r,o){for(var i=o.strideDepth,a=o.strideHeight,s=o.strideWidth,u=o.filterDepth,c=o.filterHeight,l=o.filterWidth,d=Ce(o.filterShape,"float32"),f=d.values,h=d.strides,m=h[0],p=h[1],g=h[2],v=h[3],y=this.readSync(r.dataId),x=r.strides,w=x[0],E=x[1],_=x[2],S=x[3],k=this.readSync(n.dataId),I=n.strides,R=I[0],D=I[1],A=I[2],j=I[3],F=o.padInfo.front,W=o.padInfo.left,U=o.padInfo.top,$=0;$<u;++$)for(var M=Math.max(0,Math.ceil((F-$)/i)),P=Math.min(o.outDepth,(o.inDepth+F-$)/i),B=$*m,G=0;G<c;++G)for(var q=Math.max(0,Math.ceil((U-G)/a)),J=Math.min(o.outHeight,(o.inHeight+U-G)/a),H=G*p+B,Q=0;Q<l;++Q)for(var ne=Math.max(0,Math.ceil((W-Q)/s)),Z=Math.min(o.outWidth,(o.inWidth+W-Q)/s),se=Q*g+H,re=0;re<o.inChannels;++re)for(var xe=re*v+se,pe=0;pe<o.outChannels;++pe){for(var be=0,ve=0;ve<o.batchSize;++ve)for(var Pe=ve*R,Ue=ve*w,Le=M;Le<P;++Le)for(var St=($+Le*i-F)*D+Pe,ht=Le*E+Ue,ct=q;ct<J;++ct)for(var Qn=(G+ct*a-U)*A+St,kt=ct*_+ht,Qe=ne;Qe<Z;++Qe){var lt=Qe*S+kt;be+=k[(Q+Qe*s-W)*j+Qn+re]*y[lt+pe]}f[xe+pe]=be}return d.toTensor()},e.prototype.fusedDepthwiseConv2D=function(n){var r=n.input,o=n.filter,i=n.convInfo,a=n.bias,s=n.activation,u=n.preluActivationWeights,c=this.depthwiseConv2D(r,o,i);return a&&(c=this.add(c,a)),s&&(c=tm(this,c,s,u)),c},e.prototype.depthwiseConv2D=function(n,r,o){Y([n,r],"depthwiseConv2D");for(var i=o.filterHeight,a=o.filterWidth,s=o.dilationHeight,u=o.dilationWidth,c=o.padInfo.left,l=o.padInfo.top,d=o.outChannels/o.inChannels,f=Ce(o.outShape,n.dtype),h=this.readSync(n.dataId),m=this.readSync(r.dataId),p=f.values,g=0;g<o.batchSize;++g)for(var v=g*n.strides[0],y=g*f.strides[0],x=0;x<o.outHeight;++x)for(var w=y+x*f.strides[1],E=x*o.strideHeight-c,_=0;_<i;++_){var S=E+_*s;if(!(S<0||S>=o.inHeight))for(var k=_*r.strides[0],I=v+S*n.strides[1],R=0;R<o.outWidth;++R)for(var D=w+R*f.strides[2],A=R*o.strideWidth-l,j=0;j<a;++j){var F=A+j*u;if(!(F<0||F>=o.inWidth))for(var W=k+j*r.strides[1],U=I+F*o.inChannels,$=D,M=W,P=0;P<o.inChannels;++P){for(var B=h[U+P],G=0;G<d;++G)p[$+G]+=B*m[M+G];$+=d,M+=d}}}return f.toTensor()},e.prototype.depthwiseConv2DDerInput=function(n,r,o){Y([n,r],"depthwiseConv2DDerInput");for(var i=Ce(o.inShape,"float32"),a=i.values,s=i.strides,u=s[0],c=s[1],l=s[2],d=this.readSync(n.dataId),f=n.strides,h=f[0],m=f[1],p=f[2],g=this.readSync(r.dataId),v=r.strides,y=v[0],x=v[1],w=v[2],E=o.batchSize,_=o.filterHeight,S=o.filterWidth,k=o.inChannels,I=o.inHeight,R=o.inWidth,D=o.outChannels,A=o.outHeight,j=o.outWidth,F=o.strideHeight,W=o.strideWidth,U=_-1-o.padInfo.top,$=S-1-o.padInfo.left,M=D/k,P=0;P<E;++P)for(var B=0;B<k;++B)for(var G=0;G<I;++G)for(var q=G-U,J=Math.max(0,Math.ceil(q/F)),H=Math.min(A,(_+q)/F),Q=0;Q<R;++Q){for(var ne=Q-$,Z=Math.max(0,Math.ceil(ne/W)),se=Math.min(j,(S+ne)/W),re=0,xe=J;xe<H;++xe)for(var pe=xe*F-q,be=Z;be<se;++be)for(var ve=h*P+m*xe+p*be,Pe=y*(_-1-pe)+x*(S-1-(be*W-ne))+w*B,Ue=0;Ue<M;++Ue)re+=d[ve+(B*M+Ue)]*g[Pe+Ue];a[u*P+c*G+l*Q+B]=re}return i.toTensor()},e.prototype.depthwiseConv2DDerFilter=function(n,r,o){Y([n,r],"depthwiseConv2DDerFilter");for(var i=o.strideHeight,a=o.strideWidth,s=o.filterHeight,u=o.filterWidth,c=Ce(o.filterShape,"float32"),l=o.padInfo.left,d=o.padInfo.top,f=o.outChannels/o.inChannels,h=this.bufferSync(n),m=this.bufferSync(r),p=0;p<s;++p)for(var g=Math.max(0,Math.ceil((d-p)/i)),v=Math.min(o.outHeight,(o.inHeight+d-p)/i),y=0;y<u;++y)for(var x=Math.max(0,Math.ceil((l-y)/a)),w=Math.min(o.outWidth,(o.inWidth+l-y)/a),E=0;E<o.outChannels;++E){for(var _=Math.trunc(E/f),S=E%f,k=0,I=0;I<o.batchSize;++I)for(var R=g;R<v;++R)for(var D=p+R*i-d,A=x;A<w;++A){var j=y+A*a-l;k+=h.get(I,D,j,_)*m.get(I,R,A,E)}c.set(k,p,y,_,S)}return c.toTensor()},e.prototype.tile=function(n,r){return Y(n,"tile"),xR(this.bufferSync(n),r)},e.prototype.pad=function(n,r,o){Y(n,"pad");var i=r.map(function(f,h){return f[0]+n.shape[h]+f[1]}),a=r.map(function(f){return f[0]}),s=this.bufferSync(n),u=Ce(i,n.dtype);o!==0&&u.values.fill(o);for(var c=0;c<n.size;c++){var l=s.indexToLoc(c),d=l.map(function(f,h){return f+a[h]});u.set.apply(u,[s.get.apply(s,l)].concat(d))}return u.toTensor()},e.prototype.transpose=function(n,r){Y(n,"transpose");for(var o=new Array(n.rank),i=0;i<o.length;i++)o[i]=n.shape[r[i]];var a=this.readSync(n.dataId),s=Ce(o,n.dtype),u=this.bufferSync(n);for(i=0;i<n.size;++i){for(var c=u.indexToLoc(i),l=new Array(c.length),d=0;d<l.length;d++)l[d]=c[r[d]];var f=s.locToIndex(l);s.values[f]=a[i]}return s.toTensor()},e.prototype.gather=function(n,r,o){Y([n,r],"gather");var i=n.shape.slice(),a=this.readSync(r.dataId);i[o]=a.length;for(var s=Ce(i,n.dtype),u=this.bufferSync(n),c=0;c<s.size;++c){var l=s.indexToLoc(c),d=l.slice();d[o]=a[l[o]];var f=u.locToIndex(d);s.values[c]=u.values[f]}return s.toTensor()},e.prototype.batchToSpaceND=function(n,r,o){Y([n],"batchToSpaceND");var i=r.reduce(function(d,f){return d*f}),a=wf(n.shape,r,i),s=bf(a.length,r.length),u=Ef(n.shape,r,i),c=aR(o,r.length),l=sR(u,o,r.length);return n.reshape(a).transpose(s).reshape(u).slice(c,l)},e.prototype.spaceToBatchND=function(n,r,o){Y([n],"spaceToBatchND");var i=r.reduce(function(f,h){return f*h}),a=[[0,0]];a.push.apply(a,o);for(var s=1+r.length;s<n.shape.length;++s)a.push([0,0]);var u=n.pad(a),c=wf(u.shape,r,i,!1),l=bf(c.length,r.length,!1),d=Ef(u.shape,r,i,!1);return u.reshape(c).transpose(l).reshape(d)},e.prototype.pool=function(n,r,o){Y(n,"pool");for(var i=r.strideHeight,a=r.strideWidth,s=r.dilationHeight,u=r.dilationWidth,c=r.effectiveFilterHeight,l=r.effectiveFilterWidth,d=r.padInfo.top,f=r.padInfo.left,h=o==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,m=this.readSync(n.dataId),p=Ce(r.outShape,n.dtype),g=p.values,v=r.outShape[1]*r.outShape[2]*r.outShape[3],y=r.outShape[2]*r.outShape[3],x=r.outShape[3],w=0;w<r.batchSize;++w)for(var E=w*v,_=w*n.strides[0],S=0;S<r.inChannels;++S)for(var k=0;k<r.outHeight;++k)for(var I=k*i-d,R=Math.max(0,I),D=Math.min(r.inHeight,c+I),A=E+k*y,j=0;j<r.outWidth;++j){for(var F=j*a-f,W=Math.max(0,F),U=Math.min(r.inWidth,l+F),$=h,M=0,P=0,B=R;B<D;B+=s){for(var G=_+B*n.strides[1],q=W;q<U;q+=u){var J=m[G+q*n.strides[2]+S];o==="max"&&J>$?$=J:o==="avg"&&(M+=J,P++)}if(isNaN($))break}g[A+j*x+S]=o==="avg"?M/P:$}return p.toTensor()},e.prototype.maxPool=function(n,r){return this.pool(n,r,"max")},e.prototype.maxPoolPositions=function(n,r){for(var o=Ce(r.outShape,"int32"),i=r.strideHeight,a=r.strideWidth,s=r.dilationHeight,u=r.dilationWidth,c=r.effectiveFilterHeight,l=r.effectiveFilterWidth,d=r.padInfo.top,f=r.padInfo.left,h=this.bufferSync(n),m=0;m<r.batchSize;++m)for(var p=0;p<r.inChannels;++p)for(var g=0;g<r.outHeight;++g){for(var v=g*i-d,y=v;y<0;)y+=s;for(var x=Math.min(r.inHeight,c+v),w=0;w<r.outWidth;++w){for(var E=w*a-f,_=E;_<0;)_+=u;for(var S=Math.min(r.inWidth,l+E),k=Number.NEGATIVE_INFINITY,I=-1,R=y;R<x;R+=s)for(var D=R-v,A=_;A<S;A+=u){var j=A-E,F=h.get(m,R,A,p);F>k&&(k=F,I=D*l+j)}o.set(I,m,g,w,p)}}return o.toTensor()},e.prototype.maxPoolBackprop=function(n,r,o,i){Y([r,o],"maxPoolBackprop");for(var a=this.maxPoolPositions(r,i),s=i.strideHeight,u=i.strideWidth,c=i.dilationHeight,l=i.dilationWidth,d=i.effectiveFilterHeight,f=i.effectiveFilterWidth,h=f-1-i.padInfo.left,m=d-1-i.padInfo.top,p=Ce(r.shape,"float32"),g=this.bufferSync(a),v=this.bufferSync(n),y=0;y<i.batchSize;++y)for(var x=0;x<i.inChannels;++x)for(var w=0;w<i.inHeight;++w)for(var E=0;E<i.inWidth;++E){for(var _=w-m,S=E-h,k=0,I=0;I<d;I+=c){var R=(_+I)/s;if(!(R<0||R>=i.outHeight||Math.floor(R)!==R))for(var D=0;D<f;D+=l){var A=(S+D)/u;if(!(A<0||A>=i.outWidth||Math.floor(A)!==A)){var j=d*f-1-g.get(y,R,A,x)===I*f+D?1:0;j!==0&&(k+=v.get(y,R,A,x)*j)}}}p.set(k,y,w,E,x)}return p.toTensor()},e.prototype.avgPoolBackprop=function(n,r,o){Y([n,r],"avgPoolBackprop");for(var i=o.strideHeight,a=o.strideWidth,s=o.filterHeight,u=o.filterWidth,c=o.dilationHeight,l=o.dilationWidth,d=o.effectiveFilterHeight,f=o.effectiveFilterWidth,h=f-1-o.padInfo.left,m=d-1-o.padInfo.top,p=Ce(r.shape,"float32"),g=1/(s*u),v=this.bufferSync(n),y=0;y<o.batchSize;++y)for(var x=0;x<o.inChannels;++x)for(var w=0;w<o.inHeight;++w)for(var E=0;E<o.inWidth;++E){for(var _=w-m,S=E-h,k=0,I=0;I<d;I+=c){var R=(_+I)/i;if(!(R<0||R>=o.outHeight||Math.floor(R)!==R))for(var D=0;D<f;D+=l){var A=(S+D)/a;A<0||A>=o.outWidth||Math.floor(A)!==A||(k+=v.get(y,R,A,x))}}p.set(k*g,y,w,E,x)}return p.toTensor()},e.prototype.pool3d=function(n,r,o){Y(n,"pool3d");for(var i=r.strideDepth,a=r.strideHeight,s=r.strideWidth,u=r.dilationDepth,c=r.dilationHeight,l=r.dilationWidth,d=r.effectiveFilterDepth,f=r.effectiveFilterHeight,h=r.effectiveFilterWidth,m=r.padInfo.front,p=r.padInfo.top,g=r.padInfo.left,v=o==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,y=this.readSync(n.dataId),x=Ce(r.outShape,n.dtype),w=x.values,E=r.outShape[1]*r.outShape[2]*r.outShape[3]*r.outShape[4],_=r.outShape[2]*r.outShape[3]*r.outShape[4],S=r.outShape[3]*r.outShape[4],k=r.outShape[4],I=0;I<r.batchSize;++I)for(var R=I*E,D=I*n.strides[0],A=0;A<r.inChannels;++A)for(var j=0;j<r.outDepth;++j){for(var F=j*i-m,W=F;W<0;)W+=u;for(var U=Math.min(r.inDepth,d+F),$=R+j*_,M=0;M<r.outHeight;++M){for(var P=M*a-p,B=P;B<0;)B+=c;for(var G=Math.min(r.inHeight,f+P),q=$+M*S,J=0;J<r.outWidth;++J){for(var H=J*s-g,Q=H;Q<0;)Q+=l;for(var ne=Math.min(r.inWidth,h+H),Z=q+J*k,se=v,re=0,xe=0,pe=W;pe<U;pe+=u){for(var be=D+pe*n.strides[1],ve=B;ve<G;ve+=c){for(var Pe=be+ve*n.strides[2],Ue=Q;Ue<ne;Ue+=l){var Le=y[Pe+Ue*n.strides[3]+A];if(o==="max"&&Le>se?se=Le:o==="avg"&&(re+=Le,xe++),isNaN(se))break}if(isNaN(se))break}if(isNaN(se))break}w[Z+A]=o==="avg"?re/xe:se}}}return x.toTensor()},e.prototype.avgPool3d=function(n,r){return Y(n,"avgPool3d"),this.pool3d(n,r,"avg").toFloat()},e.prototype.avgPool3dBackprop=function(n,r,o){Y([n,r],"avgPool3dBackprop");for(var i=o.strideDepth,a=o.strideHeight,s=o.strideWidth,u=o.filterDepth,c=o.filterHeight,l=o.filterWidth,d=o.dilationDepth,f=o.dilationHeight,h=o.dilationWidth,m=o.effectiveFilterDepth,p=o.effectiveFilterHeight,g=o.effectiveFilterWidth,v=m-1-o.padInfo.front,y=g-1-o.padInfo.left,x=p-1-o.padInfo.top,w=Ce(r.shape,"float32"),E=1/(u*c*l),_=this.bufferSync(n),S=0;S<o.batchSize;++S)for(var k=0;k<o.inChannels;++k)for(var I=0;I<o.inDepth;++I)for(var R=0;R<o.inHeight;++R)for(var D=0;D<o.inWidth;++D){for(var A=I-v,j=R-x,F=D-y,W=0,U=0;U<m;U+=d){var $=(A+U)/i;if(!($<0||$>=o.outDepth||Math.floor($)!==$))for(var M=0;M<p;M+=f){var P=(j+M)/a;if(!(P<0||P>=o.outHeight||Math.floor(P)!==P))for(var B=0;B<g;B+=h){var G=(F+B)/s;G<0||G>=o.outWidth||Math.floor(G)!==G||(W+=_.get(S,$,P,G,k))}}}w.set(W*E,S,I,R,D,k)}return w.toTensor()},e.prototype.maxPool3d=function(n,r){return Y(n,"maxPool3d"),this.pool3d(n,r,"max").toFloat()},e.prototype.maxPool3dPositions=function(n,r){for(var o=Ce(r.outShape,"int32"),i=r.strideDepth,a=r.strideHeight,s=r.strideWidth,u=r.dilationDepth,c=r.dilationHeight,l=r.dilationWidth,d=r.effectiveFilterDepth,f=r.effectiveFilterHeight,h=r.effectiveFilterWidth,m=r.padInfo.front,p=r.padInfo.top,g=r.padInfo.left,v=this.bufferSync(n),y=0;y<r.batchSize;++y)for(var x=0;x<r.inChannels;++x)for(var w=0;w<r.outDepth;++w){for(var E=w*i-m,_=E;_<0;)_+=u;for(var S=Math.min(r.inDepth,d+E),k=0;k<r.outHeight;++k){for(var I=k*a-p,R=I;R<0;)R+=c;for(var D=Math.min(r.inHeight,f+I),A=0;A<r.outWidth;++A){for(var j=A*s-g,F=j;F<0;)F+=l;for(var W=Math.min(r.inWidth,h+j),U=Number.NEGATIVE_INFINITY,$=-1,M=_;M<S;M+=u)for(var P=M-E,B=R;B<D;B+=c)for(var G=B-I,q=F;q<W;q+=l){var J=q-j,H=v.get(y,M,B,q,x);H>=U&&(U=H,$=P*f*h+G*f+J)}o.set($,y,w,k,A,x)}}}return o.toTensor()},e.prototype.maxPool3dBackprop=function(n,r,o,i){Y([r,o],"maxPool3dBackprop");for(var a=this.maxPool3dPositions(r,i),s=i.strideDepth,u=i.strideHeight,c=i.strideWidth,l=i.dilationDepth,d=i.dilationHeight,f=i.dilationWidth,h=i.effectiveFilterDepth,m=i.effectiveFilterHeight,p=i.effectiveFilterWidth,g=h-1-i.padInfo.front,v=p-1-i.padInfo.left,y=m-1-i.padInfo.top,x=Ce(r.shape,"float32"),w=this.bufferSync(a),E=this.bufferSync(n),_=0;_<i.batchSize;++_)for(var S=0;S<i.inChannels;++S)for(var k=0;k<i.inDepth;++k)for(var I=0;I<i.inHeight;++I)for(var R=0;R<i.inWidth;++R){for(var D=k-g,A=I-y,j=R-v,F=0,W=0;W<h;W+=l){var U=(D+W)/s;if(!(U<0||U>=i.outDepth||Math.floor(U)!==U))for(var $=0;$<m;$+=d){var M=(A+$)/u;if(!(M<0||M>=i.outHeight||Math.floor(M)!==M))for(var P=0;P<p;P+=f){var B=(j+P)/c;if(!(B<0||B>=i.outWidth||Math.floor(B)!==B)){var G=h*m*p-1-w.get(_,U,M,B,S)===W*m*p+$*p+P?1:0;G!==0&&(F+=E.get(_,U,M,B,S)*G)}}}}x.set(F,_,k,I,R,S)}return x.toTensor()},e.prototype.cast=function(n,r){return mR(n,r,this)},e.prototype.reshape=function(n,r){return Kv(n,r)},e.prototype.avgPool=function(n,r){return Y(n,"avgPool"),this.pool(n,r,"avg").toFloat()},e.prototype.resizeBilinear=function(n,r,o,i){Y(n,"resizeBilinear");for(var a=n.shape,s=a[0],u=a[1],c=a[2],l=a[3],d=this.readSync(n.dataId),f=new Float32Array(le([s,r,o,l])),h=[i&&r>1?u-1:u,i&&o>1?c-1:c],m=[i&&r>1?r-1:r,i&&o>1?o-1:o],p=0,g=h[0]/m[0],v=h[1]/m[1],y=0;y<s;y++)for(var x=0;x<r;x++)for(var w=g*x,E=Math.floor(w),_=w-E,S=Math.min(u-1,Math.ceil(w)),k=y*n.strides[0]+E*n.strides[1],I=y*n.strides[0]+S*n.strides[1],R=0;R<o;R++)for(var D=v*R,A=Math.floor(D),j=D-A,F=Math.min(c-1,Math.ceil(D)),W=k+A*n.strides[2],U=I+A*n.strides[2],$=k+F*n.strides[2],M=I+F*n.strides[2],P=0;P<l;P++){var B=d[W+P],G=d[U+P],q=B+(d[$+P]-B)*j,J=q+(G+(d[M+P]-G)*j-q)*_;f[p++]=J}return Ft(f,[s,r,o,l])},e.prototype.resizeBilinearBackprop=function(n,r,o){Y([n,r],"resizeBilinearBackprop");for(var i=r.shape,a=i[0],s=i[1],u=i[2],c=i[3],l=n.shape,d=l[1],f=l[2],h=new Float32Array(a*s*u*c),m=[o&&d>1?s-1:s,o&&f>1?u-1:u],p=[o&&d>1?d-1:d,o&&f>1?f-1:f],g=m[0]/p[0],v=m[1]/p[1],y=this.readSync(n.dataId),x=0,w=0;w<a;w++)for(var E=w*r.strides[0],_=0;_<d;_++)for(var S=_*g,k=Math.floor(S),I=Math.min(Math.ceil(S),s-1),R=E+k*r.strides[1],D=E+I*r.strides[1],A=S-k,j=1-A,F=0;F<f;F++)for(var W=F*v,U=Math.floor(W),$=Math.min(Math.ceil(W),u-1),M=W-U,P=1-M,B=R+U*r.strides[2],G=R+$*r.strides[2],q=D+U*r.strides[2],J=D+$*r.strides[2],H=j*P,Q=j*M,ne=A*P,Z=A*M,se=0;se<c;se++){var re=y[x++];h[B+se]+=re*H,h[G+se]+=re*Q,h[q+se]+=re*ne,h[J+se]+=re*Z}return ln(h,[a,u,s,c],r.dtype)},e.prototype.resizeNearestNeighbor=function(n,r,o,i){Y(n,"resizeNearestNeighbor");for(var a=n.shape,s=a[0],u=a[1],c=a[2],l=a[3],d=this.readSync(n.dataId),f=new Float32Array(s*r*o*l),h=[i&&r>1?u-1:u,i&&o>1?c-1:c],m=[i&&r>1?r-1:r,i&&o>1?o-1:o],p=h[0]/m[0],g=h[1]/m[1],v=0,y=0;y<s;y++)for(var x=y*n.strides[0],w=0;w<r;w++)for(var E=p*w,_=x+Math.min(u-1,i?Math.round(E):Math.floor(E))*n.strides[1],S=0;S<o;S++)for(var k=g*S,I=_+Math.min(c-1,i?Math.round(k):Math.floor(k))*n.strides[2],R=0;R<l;R++){var D=d[I+R];f[v++]=D}return Ft(f,[s,r,o,l],n.dtype)},e.prototype.resizeNearestNeighborBackprop=function(n,r,o){Y([n,r],"resizeNearestNeighborBackprop");for(var i=r.shape,a=i[0],s=i[1],u=i[2],c=i[3],l=n.shape,d=l[1],f=l[2],h=new Float32Array(a*s*u*c),m=this.readSync(n.dataId),p=[o&&d>1?s-1:s,o&&f>1?u-1:u],g=[o&&d>1?d-1:d,o&&f>1?f-1:f],v=p[0]/g[0],y=p[1]/g[1],x=1/v,w=1/y,E=2*Math.ceil(x)+2,_=2*Math.ceil(w)+2,S=0;S<a;S++)for(var k=S*r.strides[0],I=0;I<s;I++)for(var R=k+I*r.strides[1],D=Math.floor(I*x),A=Math.floor(D-E/2),j=0;j<u;j++)for(var F=R+j*r.strides[2],W=Math.floor(j*w),U=Math.floor(W-_/2),$=0;$<c;$++){for(var M=0,P=0;P<E;P++){var B=P+A;if(!(B<0||B>=d)){var G=k+B*n.strides[1],q=B*v;if(I===Math.min(s-1,o?Math.round(q):Math.floor(q)))for(var J=0;J<_;J++){var H=J+U;if(!(H<0||H>=f)){var Q=G+H*n.strides[2],ne=H*y;j===Math.min(u-1,o?Math.round(ne):Math.floor(ne))&&(M+=m[Q+$])}}}}h[F+$]=M}return ln(h,r.shape,r.dtype)},e.prototype.batchNormalization=function(n,r,o,i,a,s){Y([n,r,o,a,s],"batchNorm");for(var u=this.readSync(n.dataId),c=this.readSync(r.dataId),l=this.readSync(o.dataId),d=a?this.readSync(a.dataId):new Float32Array([1]),f=s?this.readSync(s.dataId):new Float32Array([0]),h=new Float32Array(u.length),m=f.length,p=d.length,g=l.length,v=c.length,y=0,x=0,w=0,E=0,_=0;_<u.length;++_)h[_]=f[y++]+(u[_]-c[x++])*d[w++]/Math.sqrt(l[E++]+i),y>=m&&(y=0),x>=v&&(x=0),w>=p&&(w=0),E>=g&&(E=0);return ln(h,n.shape)},e.prototype.localResponseNormalization4D=function(n,r,o,i,a){Y(n,"localResponseNormalization4D");var s=n.shape[3],u=s-1,c=this.readSync(n.dataId),l=n.size,d=new Float32Array(l);function f(g){for(var v=g%s,y=g-v+Math.max(0,v-r),x=g-v+Math.min(v+r,u),w=0;y<=x;y++){var E=c[y];w+=E*E}return w}for(var h=0;h<l;h++){var m=f(h),p=c[h]*Math.pow(o+i*m,-a);d[h]=p}return ln(d,n.shape)},e.prototype.LRNGrad=function(n,r,o,i,a,s,u){Y(n,"LRNGrad");for(var c=n.shape[3],l=this.readSync(n.dataId),d=this.readSync(r.dataId),f=this.readSync(o.dataId),h=new Float32Array(n.size),m=n.size,p=0;p<m;p++){for(var g=p%c,v=p-g+Math.max(0,g-i),y=p-g+Math.min(c,g+i+1),x=0,w=v;w<y;w++)x+=Math.pow(d[w],2);for(x=s*x+a,w=v;w<y;w++){var E=-2*s*u*d[w]*f[p]/x;p===w&&(E+=Math.pow(x,-u)),E*=l[p],h[w]+=E}}return ln(h,n.shape)},e.prototype.multinomial=function(n,r,o,i){Y(n,"multinomial");for(var a=r?n:To(n),s=a.shape[0],u=a.shape[1],c=Xe([s,o],"int32"),l=this.readSync(c.dataId),d=this.readSync(a.dataId),f=0;f<s;++f){var h=f*u,m=new Float32Array(u-1);m[0]=d[h];for(var p=1;p<m.length;++p)m[p]=m[p-1]+d[h+p];for(var g=_h(i.toString()),v=f*o,y=0;y<o;++y){var x=g();l[v+y]=m.length;for(var w=0;w<m.length;w++)if(x<m[w]){l[v+y]=w;break}}}return c},e.prototype.oneHot=function(n,r,o,i){Y(n,"oneHot");var a=new Float32Array(n.size*r);a.fill(i);for(var s=this.readSync(n.dataId),u=0;u<n.size;++u)s[u]>=0&&s[u]<r&&(a[u*r+s[u]]=o);return wi(a,[n.size,r],"int32")},e.prototype.nonMaxSuppression=function(n,r,o,i,a){return Y(n,"nonMaxSuppression"),Qy(this.readSync(n.dataId),this.readSync(r.dataId),o,i,a)},e.prototype.fft=function(n){return this.fftBatch(n,!1)},e.prototype.ifft=function(n){return this.fftBatch(n,!0)},e.prototype.fftBatch=function(n,r){for(var o=n.shape[0],i=n.shape[1],a=Ce(n.shape,"float32"),s=Ce(n.shape,"float32"),u=$n(n).as2D(o,i),c=Or(n).as2D(o,i),l=0;l<o;l++)for(var d=u.slice([l,0],[1,i]),f=c.slice([l,0],[1,i]),h=Mt(d,f),m=this.readSync(this.fftImpl(h,r).dataId),p=0;p<i;p++){var g=Zw(m,p);a.values[l*i+p]=g.real,s.values[l*i+p]=g.imag}return Mt(a.toTensor(),s.toTensor()).as2D(o,i)},e.prototype.fftImpl=function(n,r){var o=n.as1D(),i=o.size;if(this.isExponentOf2(i)){var a=this.fftRadix2(o,i,r).as2D(n.shape[0],n.shape[1]);return r&&(a=Mt($n(a).div(oe(i)),Or(a).div(oe(i)))),a}var s=this.readSync(n.dataId),u=function(c){for(var l=new Float32Array(c.length/2),d=new Float32Array(c.length/2),f=0;f<c.length;f+=2)l[f/2]=c[f],d[f/2]=c[f+1];return{real:l,imag:d}}(this.fourierTransformByMatmul(s,i,r));return Mt(u.real,u.imag).as2D(n.shape[0],n.shape[1])},e.prototype.isExponentOf2=function(n){return(n&n-1)==0},e.prototype.fftRadix2=function(n,r,o){if(r===1)return n;var i=this.readSync(n.dataId),a=r/2,s=function(v){for(var y=Math.ceil(v.length/4),x=new Float32Array(y),w=new Float32Array(y),E=0;E<v.length;E+=4)x[Math.floor(E/4)]=v[E],w[Math.floor(E/4)]=v[E+1];return{real:x,imag:w}}(i),u=Mt(s.real,s.imag).as1D(),c=function(v){for(var y=Math.floor(v.length/4),x=new Float32Array(y),w=new Float32Array(y),E=2;E<v.length;E+=4)x[Math.floor(E/4)]=v[E],w[Math.floor(E/4)]=v[E+1];return{real:x,imag:w}}(i),l=Mt(c.real,c.imag).as1D();u=this.fftRadix2(u,a,o),l=this.fftRadix2(l,a,o);var d=function(v,y){for(var x=new Float32Array(v/2),w=new Float32Array(v/2),E=0;E<Math.ceil(v/2);E++){var _=(y?2:-2)*Math.PI*(E/v);x[E]=Math.cos(_),w[E]=Math.sin(_)}return{real:x,imag:w}}(r,o),f=Mt(d.real,d.imag).mul(l),h=u.add(f),m=u.sub(f),p=$n(h).concat($n(m)),g=Or(h).concat(Or(m));return Mt(p,g).as1D()},e.prototype.fourierTransformByMatmul=function(n,r,o){for(var i=new Float32Array(2*r),a=0;a<r;a++){for(var s=0,u=0,c=0;c<r;c++){var l=M$(a*c,r,o),d=Zw(n,c);s+=d.real*l.real-d.imag*l.imag,u+=d.real*l.imag+d.imag*l.real}o&&(s/=r,u/=r),D$(i,s,u,a)}return i},e.prototype.depthToSpace=function(n,r,o){N(o==="NHWC",function(){return"Only NHWC dataFormat supported on CPU for depthToSpace. Got "+o}),N(r>1,function(){return"blockSize should be > 1 for depthToSpace, but was: "+r});for(var i=n.shape[0],a=n.shape[1],s=n.shape[2],u=n.shape[3],c=a*r,l=s*r,d=u/(r*r),f=this.readSync(n.dataId),h=new Float32Array(i*c*l*d),m=0,p=0;p<i;++p)for(var g=0;g<c;++g)for(var v=Math.floor(g/r),y=g%r,x=0;x<l;++x)for(var w=Math.floor(x/r),E=(y*r+x%r)*d,_=0;_<d;++_){var S=_+E+u*(w+s*(v+a*p));h[m++]=f[S]}return ln(h,[i,c,l,d])},e.prototype.broadcastedBinaryOp=function(n,r,o,i){var a=Ne(n.shape,r.shape),s=Ce(a,o),u=this.readSync(n.dataId),c=this.readSync(r.dataId),l=si(n.shape,a),d=si(r.shape,a),f=s.values;if(l.length+d.length===0)for(var h=0;h<f.length;++h)f[h]=i(u[h%u.length],c[h%c.length]);else{var m=this.bufferSync(n),p=this.bufferSync(r),g=function(v){var y=s.indexToLoc(v),x=y.slice(-n.rank);l.forEach(function(S){return x[S]=0});var w=m.locToIndex(x),E=y.slice(-r.rank);d.forEach(function(S){return E[S]=0});var _=p.locToIndex(E);f[v]=i(u[w],c[_])};for(h=0;h<f.length;++h)g(h)}return s.toTensor()},e.prototype.broadcastedBinaryComplexOp=function(n,r,o){var i=Ne(n.shape,r.shape),a=Ce(i,"float32"),s=Ce(i,"float32"),u=this.readSync(n.dataId),c=this.readSync(r.dataId),l=si(n.shape,i),d=si(r.shape,i),f=a.values,h=s.values;if(l.length+d.length===0)for(var m=0;m<f.length;m++){var p=m%u.length,g=m%c.length,v=o(u[2*p],u[2*p+1],c[2*g],c[2*g+1]);f[m]=v.real,h[m]=v.imag}else{var y=this.bufferSync(this.data.get(n.dataId).complexTensors.real),x=this.bufferSync(this.data.get(r.dataId).complexTensors.real),w=function(E){var _=a.indexToLoc(E),S=_.slice(-n.rank);l.forEach(function(A){return S[A]=0});var k=y.locToIndex(S),I=_.slice(-r.rank);d.forEach(function(A){return I[A]=0});var R=x.locToIndex(I),D=o(u[2*k],u[2*k+1],c[2*R],c[2*R+1]);f[E]=D.real,h[E]=D.imag};for(m=0;m<f.length;m++)w(m)}return this.complex(a.toTensor(),s.toTensor())},e.prototype.split=function(n,r,o){return yR(n,r,o)},e.prototype.dispose=function(){},e.prototype.floatPrecision=function(){return 32},e.prototype.epsilon=function(){return 1e-7},e.prototype.cropAndResize=function(n,r,o,i,a,s){for(var u=n.shape,c=u[0],l=u[1],d=u[2],f=u[3],h=r.shape[0],m=i[0],p=i[1],g=Ce([h,m,p,f],"float32"),v=this.readSync(r.dataId),y=this.readSync(o.dataId),x=this.readSync(n.dataId),w=n.strides,E=g.strides,_=0;_<h;_++){var S=4*_,k=v[S],I=v[S+1],R=v[S+2],D=v[S+3],A=y[_];if(!(A>=c))for(var j=m>1?(R-k)*(l-1)/(m-1):0,F=p>1?(D-I)*(d-1)/(p-1):0,W=0;W<m;W++){var U=m>1?k*(l-1)+W*j:.5*(k+R)*(l-1);if(U<0||U>l-1)for(var $=0;$<p;$++)for(var M=0;M<f;M++){var P=M+$*E[2]+W*E[1]+_*E[0];g.values[P]=s}else if(a==="bilinear"){var B=Math.floor(U),G=Math.ceil(U),q=U-B;for($=0;$<p;$++)if((pe=p>1?I*(d-1)+$*F:.5*(I+D)*(d-1))<0||pe>d-1)for(M=0;M<f;M++)P=M+$*E[2]+W*E[1]+_*E[0],g.values[P]=s;else{var J=Math.floor(pe),H=Math.ceil(pe),Q=pe-J;for(M=0;M<f;M++){var ne=x[P=M+J*w[2]+B*w[1]+A*w[0]],Z=x[P=M+H*w[2]+B*w[1]+A*w[0]],se=x[P=M+J*w[2]+G*w[1]+A*w[0]],re=ne+(Z-ne)*Q,xe=se+(x[P=M+H*w[2]+G*w[1]+A*w[0]]-se)*Q;P=M+$*E[2]+W*E[1]+_*E[0],g.values[P]=re+(xe-re)*q}}}else for($=0;$<p;++$){var pe;if((pe=p>1?I*(d-1)+$*F:.5*(I+D)*(d-1))<0||pe>d-1)for(M=0;M<f;M++)P=M+$*E[2]+W*E[1]+_*E[0],g.values[P]=s;else{var be=Math.round(pe),ve=Math.round(U);for(M=0;M<f;M++){var Pe=M+be*w[2]+ve*w[1]+A*w[0],Ue=M+$*E[2]+W*E[1]+_*E[0];g.values[Ue]=x[Pe]}}}}}return g.toTensor()},e.prototype.sparseToDense=function(n,r,o,i){var a=Cf(0,n,o),s=a.sliceRank,u=a.numUpdates,c=a.sliceSize,l=a.strides,d=a.outputSize;return this.scatter(n,r,o,d,c,u,s,l,i,!1)},e.prototype.gatherND=function(n,r){var o=r.shape,i=o[o.length-1],a=uR(n,r),s=a[0],u=a[1],c=a[2],l=a[3];if(u===0)return Ft([],s,n.dtype);for(var d=new _c([u,c],n.dtype),f=this.readSync(r.dataId),h=this.readSync(n.dataId),m=0;m<u;m++){for(var p=[],g=0,v=0;v<i;v++){var y=f[m*i+v];g+=y*l[v],p.push(y)}if(g<0||g>=n.size/c)throw new Error("Invalid indices: "+p+" does not index into "+n.shape);for(var x=0;x<c;x++)d.values[m*c+x]=h[g*c+x]}return d.toTensor().reshape(s)},e.prototype.scatterND=function(n,r,o){var i=Cf(0,n,o),a=i.sliceRank,s=i.numUpdates,u=i.sliceSize,c=i.strides,l=i.outputSize,d=oe(0);return this.scatter(n,r,o,l,u,s,a,c,d,!0)},e.prototype.fill=function(n,r,o){var i=hf(o=o||Zc(r),le(n));return i.fill(r),L.makeTensor(i,n,o,this)},e.prototype.onesLike=function(n){if(n.dtype==="string")throw new Error("onesLike is not supported for string tensors");return this.fill(n.shape,1,n.dtype)},e.prototype.zerosLike=function(n){var r=hf(n.dtype,le(n.shape));return this.makeOutput(r,n.shape,n.dtype)},e.prototype.linspace=function(n,r,o){return vR(n,r,o)},e.prototype.scatter=function(n,r,o,i,a,s,u,c,l,d){var f=[i/a,a],h=this.readSync(n.dataId),m=this.readSync(r.dataId);if(i===0)return Ft([],o,r.dtype);var p=new _c(f,r.dtype);p.values.fill(this.readSync(l.dataId)[0]);for(var g=0;g<s;g++){for(var v=[],y=0,x=0;x<u;x++){var w=h[g*u+x];v.push(w),y+=w*c[x]}if(y<0||y>=i/a)throw new Error("Invalid indices: "+v+" does not index into "+o);for(var E=0;E<a;E++)d?p.values[y*a+E]+=m[g*a+E]:p.values[y*a+E]=r.rank===0?m[0]:m[g*a+E]}return p.toTensor().reshape(o)},e}(hR);L.registerBackend("cpu",function(){return new e7},1);for(var nm=0,bb=[{kernelName:"NonMaxSuppressionV5",backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,o=e,i=o.boxes,a=o.scores,s=r,u=s.maxOutputSize,c=s.iouThreshold,l=s.scoreThreshold,d=s.softNmsSigma,f=n;Y(i,"NonMaxSuppressionWithScore");var h=Jy(f.data.get(i.dataId).values,f.data.get(a.dataId).values,u,c,l,d);return[h.selectedIndices,h.selectedScores]}},{kernelName:"Square",backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=e.x,o=n;Y(r,"square");for(var i=o.data.get(r.dataId).values,a=new Float32Array(i.length),s=0;s<i.length;++s){var u=i[s];a[s]=u*u}return{dataId:o.write(a,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},{kernelName:Ic,backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=e,o=r.a,i=r.b,a=n;Y([o,i],Ic);var s=a.data.get(o.dataId).values,u=a.data.get(i.dataId).values,c=function(f,h,m,p,g,v){var y=Ne(f,h),x=y.length,w=Vr(y),E=Cc(g,le(y)),_=f.length,S=h.length,k=Vr(f),I=Vr(h),R=si(f,y),D=si(h,y);if(R.length+D.length===0)for(var A=0;A<E.length;++A)E[A]=v(m[A%m.length],p[A%p.length]);else{var j=function(F){var W=lW(F,x,w),U=W.slice(-_);R.forEach(function(B){return U[B]=0});var $=Vw(U,_,k),M=W.slice(-S);D.forEach(function(B){return M[B]=0});var P=Vw(M,S,I);E[F]=v(m[$],p[P])};for(A=0;A<E.length;++A)j(A)}return[E,y]}(o.shape,i.shape,s,u,o.dtype,function(f,h){var m=f-h;return m*m}),l=c[0],d=c[1];return{dataId:a.write(l,d,o.dtype),shape:d,dtype:o.dtype}}}];nm<bb.length;nm++)WI(bb[nm]);var ja,t7=function(t){this.variableNames=["A"];var e=qt(),n=t[0],r=t[1];this.outputShape=t,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+r+".0, "+n+`.0);

        vec4 values = `+e.texture2D+`(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `},n7=function(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var e=qt(),n=t[0],r=t[1];this.outputShape=t,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(`+r+".0, "+n+`.0);
            vec4 values = `+e.texture2D+`(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        `+e.output+` = result;
      }
    `};for(var rm=0,Eb=[{kernelName:"FromPixels",backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,o=e.pixels,i=r.numChannels,a=typeof HTMLVideoElement<"u"&&o instanceof HTMLVideoElement,s=typeof HTMLImageElement<"u"&&o instanceof HTMLImageElement,u=a?[o.videoWidth,o.videoHeight]:[o.width,o.height],c=u[0],l=u[1],d=[l,c],f=[l,c,i];(s||a)&&(ja==null&&(ja=document.createElement("canvas").getContext("2d")),ja.canvas.width=c,ja.canvas.height=l,ja.drawImage(o,0,0,c,l),o=ja.canvas);var h=n.makeTensorInfo(d,"int32");n.texData.get(h.dataId).usage=In.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(h.dataId),o);var m=K().getBool("WEBGL_PACK")?new n7(f):new t7(f),p=n.runWebGLProgram(m,[h],"int32");return n.disposeData(h.dataId),p}},{kernelName:"NonMaxSuppressionV5",backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs;gf("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var o=e,i=o.boxes,a=o.scores,s=r,u=s.maxOutputSize,c=s.iouThreshold,l=s.scoreThreshold,d=s.softNmsSigma,f=n,h=Jy(f.readSync(i.dataId),f.readSync(a.dataId),u,c,l,d);return[h.selectedIndices,h.selectedScores]}},{kernelName:"Square",backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=e.x,o=n,i=new Ie(r.shape,"return x * x;");return o.runWebGLProgram(i,[r],r.dtype)}},{kernelName:Ic,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=e,o=r.a,i=r.b,a=n,s=K().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ro("return (a - b) * (a - b);",o.shape,i.shape):new at("return (a - b) * (a - b);",o.shape,i.shape);return a.compileAndRun(s,[o,i])}}];rm<Eb.length;rm++)WI(Eb[rm]);for(var om=0,Cb=[{kernelName:"Square",gradFunc:function(t,e){var n=e[0];return{x:function(){return t.mul(n.toFloat().mul(2))}}}},{kernelName:Ic,gradFunc:function(t,e){var n=e[0],r=e[1],o=oe(2);return{a:function(){return Yt(t,Yt(o,Ct(n,r)))},b:function(){return Yt(t,Yt(o,Ct(r,n)))}}}}];om<Cb.length;om++)ZU(Cb[om]);var r7=function(){function t(){}return t.prototype.fetch=function(e,n){return fetch(e,n)},t.prototype.now=function(){return performance.now()},t.prototype.encode=function(e,n){if(n!=="utf-8"&&n!=="utf8")throw new Error("Browser's encoder only supports utf-8, but got "+n);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)},t.prototype.decode=function(e,n){return new TextDecoder(n).decode(e)},t}();K().get("IS_BROWSER")&&K().setPlatform("browser",new r7);var im,o7=function(){return require("node-fetch")},i7=function(){function t(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}return t.prototype.fetch=function(e,n){return K().global.fetch!=null?K().global.fetch(e,n):(im==null&&(im=o7()),im(e,n))},t.prototype.now=function(){var e=process.hrtime();return 1e3*e[0]+e[1]/1e6},t.prototype.encode=function(e,n){if(n!=="utf-8"&&n!=="utf8")throw new Error("Node built-in encoder only supports utf-8, but got "+n);return this.textEncoder.encode(e)},t.prototype.decode=function(e,n){return e.length===0?"":new this.util.TextDecoder(n).decode(e)},t}();K().get("IS_NODE")&&K().setPlatform("node",new i7);var Yv={float32:4,int32:4,uint16:2,uint8:1,bool:1},Nf=4;function lT(t,e){for(var n={},r=0,o=function(s){var u=s.name,c=s.dtype,l=s.shape,d=le(l),f=void 0;if("quantization"in s){var h=s.quantization;if(h.dtype!=="uint8"&&h.dtype!=="uint16")throw new Error("Weight "+s.name+" has unknown quantization dtype "+h.dtype+". Supported quantization dtypes are: 'uint8' and 'uint16'.");var m=Yv[h.dtype],p=t.slice(r,r+d*m),g=h.dtype==="uint8"?new Uint8Array(p):new Uint16Array(p);if(c==="float32")f=Float32Array.from(g,function(_){return _*h.scale+h.min});else{if(c!=="int32")throw new Error("Unsupported dtype in weight '"+u+"': "+c);f=Int32Array.from(g,function(_){return Math.round(_*h.scale+h.min)})}r+=d*m}else if(c==="string"){var v=le(s.shape);f=[];for(var y=0;y<v;y++){var x=new Uint32Array(t.slice(r,r+Nf))[0];r+=Nf;var w=new Uint8Array(t.slice(r,r+x));f.push(w),r+=x}}else{var E=Yv[c];if(p=t.slice(r,r+d*E),c==="float32")f=new Float32Array(p);else if(c==="int32")f=new Int32Array(p);else{if(c!=="bool")throw new Error("Unsupported dtype in weight '"+u+"': "+c);f=new Uint8Array(p)}r+=d*E}n[u]=Ft(f,l,c)},i=0,a=e;i<a.length;i++)o(a[i]);return n}function a7(t){if(t===null)throw new Error("Invalid input value: "+JSON.stringify(t));var e=0,n=[];t.forEach(function(i){if(e+=i.byteLength,n.push(i.byteLength===i.buffer.byteLength?i:new i.constructor(i)),!(i instanceof Float32Array||i instanceof Int32Array||i instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: "+i.constructor.name)});var r=new Uint8Array(e),o=0;return n.forEach(function(i){r.set(new Uint8Array(i.buffer),o),o+=i.byteLength}),r.buffer}var Qv=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function _b(t){return Qv?Buffer.byteLength(t):new Blob([t]).size}function g0(t){var e=0;t.forEach(function(o){e+=o.byteLength});var n=new Uint8Array(e),r=0;return t.forEach(function(o){n.set(new Uint8Array(o),r),r+=o.byteLength}),n.buffer}function Sb(t){for(t=t.trim();t.endsWith("/");)t=t.slice(0,t.length-1);var e=t.split("/");return e[e.length-1]}function al(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:t.modelTopology==null?0:_b(JSON.stringify(t.modelTopology)),weightSpecsBytes:t.weightSpecs==null?0:_b(JSON.stringify(t.weightSpecs)),weightDataBytes:t.weightData==null?0:t.weightData.byteLength}}var Rn=function(){function t(){this.saveRouters=[],this.loadRouters=[]}return t.getInstance=function(){return t.instance==null&&(t.instance=new t),t.instance},t.registerSaveRouter=function(e){t.getInstance().saveRouters.push(e)},t.registerLoadRouter=function(e){t.getInstance().loadRouters.push(e)},t.getSaveHandlers=function(e){return t.getHandlers(e,"save")},t.getLoadHandlers=function(e,n){return t.getHandlers(e,"load",n)},t.getHandlers=function(e,n,r){var o=[];return(n==="load"?t.getInstance().loadRouters:t.getInstance().saveRouters).forEach(function(i){var a=i(e,r);a!==null&&o.push(a)}),o},t}(),bs="://",bi=function(){function t(){this.managers={}}return t.getInstance=function(){return t.instance==null&&(t.instance=new t),t.instance},t.registerManager=function(e,n){N(e!=null,function(){return"scheme must not be undefined or null."}),e.endsWith(bs)&&(e=e.slice(0,e.indexOf(bs))),N(e.length>0,function(){return"scheme must not be an empty string."});var r=t.getInstance();N(r.managers[e]==null,function(){return"A model store manager is already registered for scheme '"+e+"'."}),r.managers[e]=n},t.getManager=function(e){var n=this.getInstance().managers[e];if(n==null)throw new Error("Cannot find model manager for scheme '"+e+"'");return n},t.getSchemes=function(){return Object.keys(this.getInstance().managers)},t}();function bd(t){if(t.indexOf(bs)===-1)throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+bi.getSchemes().join(","));return{scheme:t.split(bs)[0],path:t.split(bs)[1]}}function kb(t,e,n){return n===void 0&&(n=!1),ue(this,void 0,void 0,function(){var r,o,i,a,s,u,c,l,d;return ce(this,function(f){switch(f.label){case 0:return N(t!==e,function(){return"Old path and new path are the same: '"+t+"'"}),N((r=Rn.getLoadHandlers(t)).length>0,function(){return"Copying failed because no load handler is found for source URL "+t+"."}),N(r.length<2,function(){return"Copying failed because more than one ("+r.length+") load handlers for source URL "+t+"."}),o=r[0],N((i=Rn.getSaveHandlers(e)).length>0,function(){return"Copying failed because no save handler is found for destination URL "+e+"."}),N(i.length<2,function(){return"Copying failed because more than one ("+r.length+") save handlers for destination URL "+e+"."}),a=i[0],s=bd(t).scheme,u=bd(t).path,c=s===bd(t).scheme,[4,o.load()];case 1:return l=f.sent(),n&&c?[4,bi.getManager(s).removeModel(u)]:[3,3];case 2:f.sent(),f.label=3;case 3:return[4,a.save(l)];case 4:return d=f.sent(),!n||c?[3,6]:[4,bi.getManager(s).removeModel(u)];case 5:f.sent(),f.label=6;case 6:return[2,d.modelArtifactsInfo]}})})}var Zi="models_store",ui="model_info_store";function dT(){if(!K().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");var t=window||self,e=t.indexedDB||t.mozIndexedDB||t.webkitIndexedDB||t.msIndexedDB||t.shimIndexedDB;if(e==null)throw new Error("The current browser does not appear to support IndexedDB.");return e}function Jv(t){var e=t.result;e.createObjectStore(Zi,{keyPath:"modelPath"}),e.createObjectStore(ui,{keyPath:"modelPath"})}var Es=function(){function t(e){if(this.indexedDB=dT(),e==null||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}return t.prototype.save=function(e){return ue(this,void 0,void 0,function(){return ce(this,function(n){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return[2,this.databaseAction(this.modelPath,e)]})})},t.prototype.load=function(){return ue(this,void 0,void 0,function(){return ce(this,function(e){return[2,this.databaseAction(this.modelPath)]})})},t.prototype.databaseAction=function(e,n){var r=this;return new Promise(function(o,i){var a=r.indexedDB.open("tensorflowjs",1);a.onupgradeneeded=function(){return Jv(a)},a.onsuccess=function(){var s=a.result;if(n==null){var u=s.transaction(Zi,"readonly"),c=u.objectStore(Zi).get(r.modelPath);c.onsuccess=function(){if(c.result==null)return s.close(),i(new Error("Cannot find model with path '"+r.modelPath+"' in IndexedDB."));o(c.result.modelArtifacts)},c.onerror=function(p){return s.close(),i(c.error)},u.oncomplete=function(){return s.close()}}else{var l,d=al(n),f=s.transaction(ui,"readwrite"),h=f.objectStore(ui),m=h.put({modelPath:r.modelPath,modelArtifactsInfo:d});m.onsuccess=function(){var p=(l=s.transaction(Zi,"readwrite")).objectStore(Zi).put({modelPath:r.modelPath,modelArtifacts:n,modelArtifactsInfo:d});p.onsuccess=function(){return o({modelArtifactsInfo:d})},p.onerror=function(g){var v=(h=f.objectStore(ui)).delete(r.modelPath);v.onsuccess=function(){return s.close(),i(p.error)},v.onerror=function(y){return s.close(),i(p.error)}}},m.onerror=function(p){return s.close(),i(m.error)},f.oncomplete=function(){l==null?s.close():l.oncomplete=function(){return s.close()}}}},a.onerror=function(s){return i(a.error)}})},t.URL_SCHEME="indexeddb://",t}(),Ib=function(t){return K().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(Es.URL_SCHEME)?(e=t.slice(Es.URL_SCHEME.length),new Es(e)):null;var e};Rn.registerSaveRouter(Ib),Rn.registerLoadRouter(Ib);var s7=function(){function t(){this.indexedDB=dT()}return t.prototype.listModels=function(){return ue(this,void 0,void 0,function(){var e=this;return ce(this,function(n){return[2,new Promise(function(r,o){var i=e.indexedDB.open("tensorflowjs",1);i.onupgradeneeded=function(){return Jv(i)},i.onsuccess=function(){var a=i.result,s=a.transaction(ui,"readonly"),u=s.objectStore(ui).getAll();u.onsuccess=function(){for(var c={},l=0,d=u.result;l<d.length;l++){var f=d[l];c[f.modelPath]=f.modelArtifactsInfo}r(c)},u.onerror=function(c){return a.close(),o(u.error)},s.oncomplete=function(){return a.close()}},i.onerror=function(a){return o(i.error)}})]})})},t.prototype.removeModel=function(e){return ue(this,void 0,void 0,function(){var n=this;return ce(this,function(r){var o;return e=(o=e).startsWith(Es.URL_SCHEME)?o.slice(Es.URL_SCHEME.length):o,[2,new Promise(function(i,a){var s=n.indexedDB.open("tensorflowjs",1);s.onupgradeneeded=function(){return Jv(s)},s.onsuccess=function(){var u,c=s.result,l=c.transaction(ui,"readwrite"),d=l.objectStore(ui),f=d.get(e);f.onsuccess=function(){if(f.result==null)return c.close(),a(new Error("Cannot find model with path '"+e+"' in IndexedDB."));var h=d.delete(e),m=function(){var p=(u=c.transaction(Zi,"readwrite")).objectStore(Zi).delete(e);p.onsuccess=function(){return i(f.result.modelArtifactsInfo)},p.onerror=function(g){return a(f.error)}};h.onsuccess=m,h.onerror=function(p){return m(),c.close(),a(f.error)}},f.onerror=function(h){return c.close(),a(f.error)},l.oncomplete=function(){u==null?c.close():u.oncomplete=function(){return c.close()}}},s.onerror=function(u){return a(s.error)}})]})})},t}();if(K().getBool("IS_BROWSER"))try{bi.registerManager(Es.URL_SCHEME,new s7)}catch{}var uo="/",Ha="tensorflowjs_models",fT="info",u7="model_topology",c7="weight_specs",l7="weight_data",d7="model_metadata";function hT(t){return{info:[Ha,t,fT].join(uo),topology:[Ha,t,u7].join(uo),weightSpecs:[Ha,t,c7].join(uo),weightData:[Ha,t,l7].join(uo),modelMetadata:[Ha,t,d7].join(uo)}}function f7(t){var e=t.split(uo);if(e.length<3)throw new Error("Invalid key format: "+t);return e.slice(1,e.length-1).join(uo)}var Cs=function(){function t(e){if(!K().getBool("IS_BROWSER")||typeof window>"u"||window.localStorage===void 0)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,e==null||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=hT(this.modelPath)}return t.prototype.save=function(e){return ue(this,void 0,void 0,function(){var n,r,o;return ce(this,function(i){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");n=JSON.stringify(e.modelTopology),r=JSON.stringify(e.weightSpecs),o=al(e);try{return this.LS.setItem(this.keys.info,JSON.stringify(o)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,function(a){if(Qv)return Buffer.from(a).toString("base64");for(var s=new Uint8Array(a),u="",c=0,l=s.length;c<l;c++)u+=String.fromCharCode(s[c]);return btoa(u)}(e.weightData)),this.LS.setItem(this.keys.modelMetadata,JSON.stringify({format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,userDefinedMetadata:e.userDefinedMetadata})),[2,{modelArtifactsInfo:o}]}catch{throw this.LS.removeItem(this.keys.info),this.LS.removeItem(this.keys.topology),this.LS.removeItem(this.keys.weightSpecs),this.LS.removeItem(this.keys.weightData),this.LS.removeItem(this.keys.modelMetadata),new Error("Failed to save model '"+this.modelPath+"' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes="+o.modelTopologyBytes+", weightSpecsBytes="+o.weightSpecsBytes+", weightDataBytes="+o.weightDataBytes+".")}return[2]})})},t.prototype.load=function(){return ue(this,void 0,void 0,function(){var e,n,r,o,i,a,s;return ce(this,function(u){if((e=JSON.parse(this.LS.getItem(this.keys.info)))==null)throw new Error("In local storage, there is no model with name '"+this.modelPath+"'");if(e.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");if(n={},(r=JSON.parse(this.LS.getItem(this.keys.topology)))==null)throw new Error("In local storage, the topology of model '"+this.modelPath+"' is missing.");if(n.modelTopology=r,(o=JSON.parse(this.LS.getItem(this.keys.weightSpecs)))==null)throw new Error("In local storage, the weight specs of model '"+this.modelPath+"' are missing.");if(n.weightSpecs=o,(i=this.LS.getItem(this.keys.modelMetadata))!=null&&(a=JSON.parse(i),n.format=a.format,n.generatedBy=a.generatedBy,n.convertedBy=a.convertedBy,n.userDefinedMetadata=a.userDefinedMetadata),(s=this.LS.getItem(this.keys.weightData))==null)throw new Error("In local storage, the binary weight values of model '"+this.modelPath+"' are missing.");return n.weightData=function(c){if(Qv){var l=Buffer.from(c,"base64");return l.buffer.slice(l.byteOffset,l.byteOffset+l.byteLength)}for(var d=atob(c),f=new Uint8Array(d.length),h=0;h<d.length;++h)f.set([d.charCodeAt(h)],h);return f.buffer}(s),[2,n]})})},t.URL_SCHEME="localstorage://",t}(),Rb=function(t){return K().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(Cs.URL_SCHEME)?(e=t.slice(Cs.URL_SCHEME.length),new Cs(e)):null;var e};Rn.registerSaveRouter(Rb),Rn.registerLoadRouter(Rb);var h7=function(){function t(){N(K().getBool("IS_BROWSER"),function(){return"Current environment is not a web browser"}),N(typeof window>"u"||window.localStorage!==void 0,function(){return"Current browser does not appear to support localStorage"}),this.LS=window.localStorage}return t.prototype.listModels=function(){return ue(this,void 0,void 0,function(){var e,n,r,o,i,a;return ce(this,function(s){for(e={},n=Ha+uo,r=uo+fT,o=0;o<this.LS.length;++o)(i=this.LS.key(o)).startsWith(n)&&i.endsWith(r)&&(a=f7(i),e[a]=JSON.parse(this.LS.getItem(i)));return[2,e]})})},t.prototype.removeModel=function(e){return ue(this,void 0,void 0,function(){var n,r;return ce(this,function(o){var i;if(e=(i=e).startsWith(Cs.URL_SCHEME)?i.slice(Cs.URL_SCHEME.length):i,n=hT(e),this.LS.getItem(n.info)==null)throw new Error("Cannot find model at path '"+e+"'");return r=JSON.parse(this.LS.getItem(n.info)),this.LS.removeItem(n.info),this.LS.removeItem(n.topology),this.LS.removeItem(n.weightSpecs),this.LS.removeItem(n.weightData),[2,r]})})},t}();if(K().getBool("IS_BROWSER"))try{bi.registerManager(Cs.URL_SCHEME,new h7)}catch{}var p7="model",m7=".json",v7=".weights.bin";function Tb(t){return new Promise(function(e){return setTimeout(e)}).then(t)}var am=function(){function t(e){if(!K().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");e.startsWith(t.URL_SCHEME)&&(e=e.slice(t.URL_SCHEME.length)),e!=null&&e.length!==0||(e=p7),this.modelTopologyFileName=e+m7,this.weightDataFileName=e+v7}return t.prototype.save=function(e){return ue(this,void 0,void 0,function(){var n,r,o,i,a,s;return ce(this,function(u){switch(u.label){case 0:if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");if(n=window.URL.createObjectURL(new Blob([e.weightData],{type:"application/octet-stream"})),!(e.modelTopology instanceof ArrayBuffer))return[3,1];throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");case 1:return r=[{paths:["./"+this.weightDataFileName],weights:e.weightSpecs}],o={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,weightsManifest:r},i=window.URL.createObjectURL(new Blob([JSON.stringify(o)],{type:"application/json"})),(a=this.jsonAnchor==null?document.createElement("a"):this.jsonAnchor).download=this.modelTopologyFileName,a.href=i,[4,Tb(function(){return a.dispatchEvent(new MouseEvent("click"))})];case 2:return u.sent(),e.weightData==null?[3,4]:((s=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor).download=this.weightDataFileName,s.href=n,[4,Tb(function(){return s.dispatchEvent(new MouseEvent("click"))})]);case 3:u.sent(),u.label=4;case 4:return[2,{modelArtifactsInfo:al(e)}]}})})},t.URL_SCHEME="downloads://",t}(),g7=function(){function t(e){if(e==null||e.length<1)throw new Error("When calling browserFiles, at least 1 file is required, but received "+e);this.files=e}return t.prototype.load=function(){return ue(this,void 0,void 0,function(){var e,n,r=this;return ce(this,function(o){return e=this.files[0],n=this.files.slice(1),[2,new Promise(function(i,a){var s=new FileReader;s.onload=function(u){var c=JSON.parse(u.target.result),l=c.modelTopology;if(l!=null){n.length===0&&i({modelTopology:l});var d=c.weightsManifest;if(d!=null){var f;try{f=r.checkManifestAndWeightFiles(d,n)}catch(g){return void a(g)}var h=[],m=[],p=[];d.forEach(function(g){g.paths.forEach(function(v){m.push(v),p.push(null)}),h.push.apply(h,g.weights)}),d.forEach(function(g){g.paths.forEach(function(v){var y=new FileReader;y.onload=function(x){var w=x.target.result,E=m.indexOf(v);p[E]=w,p.indexOf(null)===-1&&i({modelTopology:l,weightSpecs:h,weightData:g0(p),format:c.format,generatedBy:c.generatedBy,convertedBy:c.convertedBy,userDefinedMetadata:c.userDefinedMetadata})},y.onerror=function(x){return a("Failed to weights data from file of path '"+v+"'.")},y.readAsArrayBuffer(f[v])})})}else a(new Error("weightManifest field is missing from file "+e.name))}else a(new Error("modelTopology field is missing from file "+e.name))},s.onerror=function(u){return a("Failed to read model topology and weights manifest JSON from file '"+e.name+"'. BrowserFiles supports loading Keras-style tf.Model artifacts only.")},s.readAsText(e)})]})})},t.prototype.checkManifestAndWeightFiles=function(e,n){for(var r=[],o=n.map(function(u){return Sb(u.name)}),i={},a=0,s=e;a<s.length;a++)s[a].paths.forEach(function(u){var c=Sb(u);if(r.indexOf(c)!==-1)throw new Error("Duplicate file basename found in weights manifest: '"+c+"'");if(r.push(c),o.indexOf(c)===-1)throw new Error("Weight file with basename '"+c+"' is not provided.");i[u]=n[o.indexOf(c)]});if(r.length!==n.length)throw new Error("Mismatch in the number of files in weights manifest ("+r.length+") and the number of weight files provided ("+n.length+").");return i},t}();function Nb(t,e,n,r){(function(i){N(i!=null&&Array.isArray(i)&&i.length>0,function(){return"promises must be a none empty array"})})(t),function(i,a){N(i>=0&&i<=1,function(){return"Progress fraction must be in range [0, 1], but got startFraction "+i}),N(a>=0&&a<=1,function(){return"Progress fraction must be in range [0, 1], but got endFraction "+a}),N(a>=i,function(){return"startFraction must be no more than endFraction, but got startFraction "+i+" and endFraction "+a})}(n=n??0,r=r??1);var o=0;return Promise.all(t.map(function(i){return i.then(function(a){var s=n+ ++o/t.length*(r-n);return e(s),a}),i}))}function pT(t,e){return ue(this,void 0,void 0,function(){var n,r,o,i,a,s,u,c,l;return ce(this,function(d){switch(d.label){case 0:return e==null&&(e={}),n=e.fetchFunc==null?K().platform.fetch:e.fetchFunc,r=t.map(function(f){return n(f,e.requestInit,{isBinary:!0})}),o=0,i=.5,e.onProgress!=null?[3,2]:[4,Promise.all(r)];case 1:return a=d.sent(),[3,4];case 2:return[4,Nb(r,e.onProgress,o,i)];case 3:a=d.sent(),d.label=4;case 4:return s=a.map(function(f){return f.arrayBuffer()}),u=.5,c=1,e.onProgress!=null?[3,6]:[4,Promise.all(s)];case 5:return l=d.sent(),[3,8];case 6:return[4,Nb(s,e.onProgress,u,c)];case 7:l=d.sent(),d.label=8;case 8:return[2,l]}})})}function Ab(t){var e=this;return function(n,r,o){return r===void 0&&(r=""),ue(e,void 0,void 0,function(){var i,a,s,u,c,l,d,f,h,m;return ce(this,function(p){switch(p.label){case 0:if(i=n.map(function(){return!1}),a={},s=o!=null?o.map(function(){return!1}):[],u=[],n.forEach(function(g,v){var y=0;g.weights.forEach(function(x){var w="quantization"in x?x.quantization.dtype:x.dtype,E=Yv[w]*le(x.shape),_=function(){i[v]=!0,a[v]==null&&(a[v]=[]),a[v].push({manifestEntry:x,groupOffset:y,sizeBytes:E})};o!=null?o.forEach(function(S,k){S===x.name&&(_(),s[k]=!0)}):_(),u.push(x.name),y+=E})}),!s.every(function(g){return g}))throw c=o.filter(function(g,v){return!s[v]}),new Error("Could not find weights in manifest with names: "+c.join(", ")+`. 
Manifest JSON has weights with names: `+u.join(", ")+".");return l=i.reduce(function(g,v,y){return v&&g.push(y),g},[]),d=[],l.forEach(function(g){n[g].paths.forEach(function(v){var y=r+(r.endsWith("/")?"":"/")+v;d.push(y)})}),[4,t(d)];case 1:return f=p.sent(),h={},m=0,l.forEach(function(g){for(var v=n[g].paths.length,y=0,x=0;x<v;x++)y+=f[m+x].byteLength;for(var w=new ArrayBuffer(y),E=new Uint8Array(w),_=0,S=0;S<v;S++){var k=new Uint8Array(f[m+S]);E.set(k,_),_+=k.byteLength}a[g].forEach(function(I){var R=lT(w.slice(I.groupOffset,I.groupOffset+I.sizeBytes),[I.manifestEntry]);for(var D in R)h[D]=R[D]}),m+=v}),[2,h]}})})}}Rn.registerSaveRouter(function(t){return K().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(am.URL_SCHEME)?function(e){return e===void 0&&(e="model"),new am(e)}(t.slice(am.URL_SCHEME.length)):null});var mT=function(){function t(e,n){if(this.DEFAULT_METHOD="POST",n==null&&(n={}),this.weightPathPrefix=n.weightPathPrefix,this.onProgress=n.onProgress,n.fetchFunc!=null?(N(typeof n.fetchFunc=="function",function(){return"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"}),this.fetch=n.fetchFunc):this.fetch=K().platform.fetch,N(e!=null&&e.length>0,function(){return"URL path for http must not be null, undefined or empty."}),Array.isArray(e)&&N(e.length===2,function(){return"URL paths for http must have a length of 2, (actual length is "+e.length+")."}),this.path=e,n.requestInit!=null&&n.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=n.requestInit||{}}return t.prototype.save=function(e){return ue(this,void 0,void 0,function(){var n,r,o,i;return ce(this,function(a){switch(a.label){case 0:if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");return(n=Object.assign({method:this.DEFAULT_METHOD},this.requestInit)).body=new FormData,r=[{paths:["./model.weights.bin"],weights:e.weightSpecs}],o={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,userDefinedMetadata:e.userDefinedMetadata,weightsManifest:r},n.body.append("model.json",new Blob([JSON.stringify(o)],{type:"application/json"}),"model.json"),e.weightData!=null&&n.body.append("model.weights.bin",new Blob([e.weightData],{type:"application/octet-stream"}),"model.weights.bin"),[4,this.fetch(this.path,n)];case 1:if((i=a.sent()).ok)return[2,{modelArtifactsInfo:al(e),responses:[i]}];throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+i.status+".")}})})},t.prototype.load=function(){return ue(this,void 0,void 0,function(){var e,n,r,o,i,a,s,u,c,l,d,f;return ce(this,function(h){switch(h.label){case 0:return[4,this.fetch(this.path,this.requestInit)];case 1:if(!(e=h.sent()).ok)throw new Error("Request to "+this.path+" failed with status code "+e.status+". Please verify this URL points to the model JSON of the model to load.");h.label=2;case 2:return h.trys.push([2,4,,5]),[4,e.json()];case 3:return n=h.sent(),[3,5];case 4:throw h.sent(),r="Failed to parse model JSON of response from "+this.path+".",this.path.endsWith(".pb")?r+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":r+=" Please make sure the server is serving valid JSON for this request.",new Error(r);case 5:if(o=n.modelTopology,i=n.weightsManifest,a=n.generatedBy,s=n.convertedBy,u=n.format,c=n.userDefinedMetadata,o==null&&i==null)throw new Error("The JSON from HTTP path "+this.path+" contains neither model topology or manifest for weights.");return i==null?[3,7]:[4,this.loadWeights(i)];case 6:f=h.sent(),l=f[0],d=f[1],h.label=7;case 7:return[2,{modelTopology:o,weightSpecs:l,weightData:d,userDefinedMetadata:c,generatedBy:a,convertedBy:s,format:u}]}})})},t.prototype.loadWeights=function(e){return ue(this,void 0,void 0,function(){var n,r,o,i,a,s,u,c,l,d,f;return ce(this,function(h){switch(h.label){case 0:for(n=Array.isArray(this.path)?this.path[1]:this.path,r=function(m){var p=m.lastIndexOf("/"),g=m.lastIndexOf("?"),v=m.substring(0,p),y=g>p?m.substring(g):"";return[v+"/",y]}(n),o=r[0],i=r[1],a=this.weightPathPrefix||o,s=[],u=0,c=e;u<c.length;u++)l=c[u],s.push.apply(s,l.weights);return d=[],e.forEach(function(m){m.paths.forEach(function(p){d.push(a+p+i)})}),[4,pT(d,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress})];case 1:return f=h.sent(),[2,[s,g0(f)]]}})})},t.URL_SCHEME_REGEX=/^https?:\/\//,t}();function Zv(t){return t.match(mT.URL_SCHEME_REGEX)!=null}var Pb=function(t,e){return typeof fetch>"u"?null:(Array.isArray(t)?t.every(function(n){return Zv(n)}):Zv(t))?eg(t,{onProgress:e}):null};function eg(t,e){return new mT(t,e)}Rn.registerSaveRouter(Pb),Rn.registerLoadRouter(Pb);var sm=function(){function t(e){this.modelArtifacts=e}return t.prototype.load=function(){return ue(this,void 0,void 0,function(){return ce(this,function(e){return[2,this.modelArtifacts]})})},t}(),y7=function(){function t(e){this.saveHandler=e}return t.prototype.save=function(e){return ue(this,void 0,void 0,function(){return ce(this,function(n){return[2,this.saveHandler(e)]})})},t}(),vT=Object.freeze({browserFiles:function(t){return new g7(t)},browserHTTPRequest:function(t,e){return eg(t,e)},concatenateArrayBuffers:g0,decodeWeights:lT,encodeWeights:function(t,e){return ue(this,void 0,void 0,function(){var n,r,o,i,a,s=this;return ce(this,function(u){switch(u.label){case 0:for(n=[],r=[],o=Array.isArray(t)?t.map(function(c){return c.name}):Object.keys(t),i=function(c){var l=o[c],d=Array.isArray(t)?t[c].tensor:t[l];if(d.dtype!=="float32"&&d.dtype!=="int32"&&d.dtype!=="bool"&&d.dtype!=="string")throw new Error("Unsupported dtype in weight '"+l+"': "+d.dtype);var f={name:l,shape:d.shape,dtype:d.dtype};if(d.dtype==="string"){var h=new Promise(function(m){return ue(s,void 0,void 0,function(){var p,g,v,y,x,w,E;return ce(this,function(_){switch(_.label){case 0:return[4,d.bytes()];case 1:for(p=_.sent(),g=p.reduce(function(S,k){return S+k.length},0)+Nf*p.length,v=new Uint8Array(g),y=0,x=0;x<p.length;x++)w=p[x],E=new Uint8Array(new Uint32Array([w.length]).buffer),v.set(E,y),y+=Nf,v.set(w,y),y+=w.length;return m(v),[2]}})})});r.push(h)}else r.push(d.data());e!=null&&(f.group=e),n.push(f)},a=0;a<o.length;++a)i(a);return[4,Promise.all(r)];case 1:return[2,{data:a7(u.sent()),specs:n}]}})})},fromMemory:function(t,e,n,r){return arguments.length===1?t.modelTopology!=null||t.weightSpecs!=null?new sm(t):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new sm({modelTopology:t})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new sm({modelTopology:t,weightSpecs:e,weightData:n,trainingConfig:r}))},getLoadHandlers:function(t,e){return Rn.getLoadHandlers(t,e)},getModelArtifactsInfoForJSON:al,getSaveHandlers:function(t){return Rn.getSaveHandlers(t)},http:eg,isHTTPScheme:Zv,loadWeights:function(t,e,n,r){return e===void 0&&(e=""),ue(this,void 0,void 0,function(){return ce(this,function(o){return[2,Ab(function(i){return pT(i,{requestInit:r})})(t,e,n)]})})},registerLoadRouter:function(t){return Rn.registerLoadRouter(t)},registerSaveRouter:function(t){return Rn.registerSaveRouter(t)},weightsLoaderFactory:Ab,withSaveHandler:function(t){return new y7(t)},copyModel:function(t,e){return ue(this,void 0,void 0,function(){return ce(this,function(n){return[2,kb(t,e,!1)]})})},listModels:function(){return ue(this,void 0,void 0,function(){var t,e,n,r,o,i,a;return ce(this,function(s){switch(s.label){case 0:t=bi.getSchemes(),e={},n=0,r=t,s.label=1;case 1:return n<r.length?(o=r[n],[4,bi.getManager(o).listModels()]):[3,4];case 2:for(a in i=s.sent())e[o+bs+a]=i[a];s.label=3;case 3:return n++,[3,1];case 4:return[2,e]}})})},moveModel:function(t,e){return ue(this,void 0,void 0,function(){return ce(this,function(n){return[2,kb(t,e,!0)]})})},removeModel:function(t){return ue(this,void 0,void 0,function(){var e;return ce(this,function(n){return e=bd(t),[2,bi.getManager(e.scheme).removeModel(e.path)]})})}}),Ua;O({confusionMatrix_:function(t,e,n){var r=T(t,"labels","confusionMatrix"),o=T(e,"predictions","confusionMatrix");N(n==null||n>0&&Number.isInteger(n),function(){return"If provided, numClasses must be a positive integer, but got "+n}),N(r.rank===1,function(){return"Expected the rank of labels to be 1, but got "+r.rank}),N(o.rank===1,function(){return"Expected the rank of predictions to be 1, but got "+o.rank}),N(r.shape[0]===o.shape[0],function(){return"Mismatch in the number of examples: "+r.shape[0]+" vs. "+o.shape[0]+". Labels and predictions should have the same number of elements."}),N(n>0&&Number.isInteger(n),function(){return"numClasses is required to be a positive integer, but got "+n});var i=Hv(r.asType("int32"),n),a=Hv(o.asType("int32"),n);return i.transpose().matMul(a).asType("int32")}});var x7=O({fromPixels_:function(t,e){if(e===void 0&&(e=3),e>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(t==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var n=!1,r=!1,o=!1,i=!1,a=!1;if(t.data instanceof Uint8Array)n=!0;else if(typeof ImageData<"u"&&t instanceof ImageData)r=!0;else if(typeof HTMLVideoElement<"u"&&t instanceof HTMLVideoElement)o=!0;else if(typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement)i=!0;else{if(t.getContext==null)throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was "+t.constructor.name);a=!0}if(o&&o&&t.readyState<2)throw new Error("The video element has not loaded data yet. Please wait for `loadeddata` event on the <video> element.");if(UI("FromPixels",L.backendName)!=null)return L.runKernel("FromPixels",{pixels:t},{numChannels:e});var s,u,c=o?[t.videoWidth,t.videoHeight]:[t.width,t.height],l=c[0],d=c[1];if(a?s=t.getContext("2d").getImageData(0,0,l,d).data:r||n?s=t.data:(i||o)&&(Ua==null&&(Ua=document.createElement("canvas").getContext("2d")),Ua.canvas.width=l,Ua.canvas.height=d,Ua.drawImage(t,0,0,l,d),s=Ua.getImageData(0,0,l,d).data),e===4)u=new Int32Array(s);else{var f=l*d;u=new Int32Array(f*e);for(var h=0;h<f;h++)for(var m=0;m<e;++m)u[h*e+m]=s[4*h+m]}return Gy(u,[d,l,e],"int32")}}),y0=Object.freeze({toPixels:function(t,e){return ue(this,void 0,void 0,function(){var n,r,o,i,a,s,u,c,l,d,f,h,m,p,g,v,y,x,w,E,_,S,k;return ce(this,function(I){switch(I.label){case 0:if(n=T(t,"img","toPixels"),t instanceof tt||(n=n.toInt()),n.rank!==2&&n.rank!==3)throw new Error("toPixels only supports rank 2 or 3 tensors, got rank "+n.rank+".");if(r=n.shape.slice(0,2),o=r[0],i=r[1],(a=n.rank===2?1:n.shape[2])>4||a===2)throw new Error("toPixels only supports depth of size 1, 3 or 4 but got "+a);return[4,n.data()];case 1:return s=I.sent(),u=n.min(),c=n.max(),[4,Promise.all([u.data(),c.data()])];case 2:if(l=I.sent(),d=l[0],f=l[1],h=d[0],m=f[0],u.dispose(),c.dispose(),n.dtype==="float32"){if(h<0||m>1)throw new Error("Tensor values for a float32 Tensor must be in the range [0 - 1] but got range ["+h+" - "+m+"].")}else{if(n.dtype!=="int32")throw new Error("Unsupported type for toPixels: "+n.dtype+". Please use float32 or int32 tensors.");if(h<0||m>255)throw new Error("Tensor values for a int32 Tensor must be in the range [0 - 255] but got range ["+h+" - "+m+"].")}for(p=n.dtype==="float32"?255:1,g=new Uint8ClampedArray(i*o*4),v=0;v<o*i;++v)y=void 0,x=void 0,w=void 0,E=void 0,a===1?(y=s[v]*p,x=s[v]*p,w=s[v]*p,E=255):a===3?(y=s[3*v]*p,x=s[3*v+1]*p,w=s[3*v+2]*p,E=255):a===4&&(y=s[4*v]*p,x=s[4*v+1]*p,w=s[4*v+2]*p,E=s[4*v+3]*p),g[(_=4*v)+0]=Math.round(y),g[_+1]=Math.round(x),g[_+2]=Math.round(w),g[_+3]=Math.round(E);return e!=null&&(e.width=i,e.height=o,S=e.getContext("2d"),k=new ImageData(g,i,o),S.putImageData(k,0,0)),n!==t&&n.dispose(),[2,g]}})})},fromPixels:x7}),w7=function(){function t(){}return t.prototype.getClassName=function(){return this.constructor.className},t.fromConfig=function(e,n){return new e(n)},t}(),b7=function(){function t(){this.classNameMap={}}return t.getMap=function(){return t.instance==null&&(t.instance=new t),t.instance},t.register=function(e){t.getMap().classNameMap[e.className]=[e,e.fromConfig]},t}();function Ta(t){N(t.className!=null,function(){return"Class being registered does not have the static className property defined."}),N(typeof t.className=="string",function(){return"className is required to be a string, but got type "+typeof t.className}),N(t.className.length>0,function(){return"Class being registered has an empty-string as its className, which is disallowed."}),b7.register(t)}var Na=function(t){function e(){return t!==null&&t.apply(this,arguments)||this}return br(e,t),e.prototype.minimize=function(n,r,o){r===void 0&&(r=!1);var i=this.computeGradients(n,o),a=i.value,s=i.grads;if(o!=null){var u=o.map(function(c){return{name:c.name,tensor:s[c.name]}});this.applyGradients(u)}else this.applyGradients(s);return gn(s),r?a:(a.dispose(),null)},Object.defineProperty(e.prototype,"iterations",{get:function(){return this.iterations_==null&&(this.iterations_=0),this.iterations_},enumerable:!0,configurable:!0}),e.prototype.incrementIterations=function(){this.iterations_=this.iterations+1},e.prototype.computeGradients=function(n,r){return A$(n,r)},e.prototype.dispose=function(){this.iterations_!=null&&gn(this.iterations_)},e.prototype.saveIterations=function(){return ue(this,void 0,void 0,function(){return ce(this,function(n){return this.iterations_==null&&(this.iterations_=0),[2,{name:"iter",tensor:oe(this.iterations_,"int32")}]})})},e.prototype.getWeights=function(){return ue(this,void 0,void 0,function(){return ce(this,function(n){throw new Error("getWeights() is not implemented for this optimizer yet.")})})},e.prototype.setWeights=function(n){return ue(this,void 0,void 0,function(){return ce(this,function(r){throw new Error("setWeights() is not implemented for this optimizer class "+this.getClassName())})})},e.prototype.extractIterations=function(n){return ue(this,void 0,void 0,function(){var r;return ce(this,function(o){switch(o.label){case 0:return r=this,[4,n[0].tensor.data()];case 1:return r.iterations_=o.sent()[0],[2,n.slice(1)]}})})},e}(w7);Object.defineProperty(Na,Symbol.hasInstance,{value:function(t){return t.minimize!=null&&t.computeGradients!=null&&t.applyGradients!=null}});var E7=function(t){function e(n,r,o){o===void 0&&(o=null);var i=t.call(this)||this;return i.learningRate=n,i.rho=r,i.epsilon=o,i.accumulatedGrads=[],i.accumulatedUpdates=[],o==null&&(i.epsilon=L.backend.epsilon()),i}return br(e,t),e.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(o){return o.name}):Object.keys(n)).forEach(function(o,i){var a=L.registeredVariables[o];r.accumulatedGrads[i]==null&&(r.accumulatedGrads[i]={originalName:o+"/accum_grad",variable:ie(function(){return Me(a).variable(!1)})}),r.accumulatedUpdates[i]==null&&(r.accumulatedUpdates[i]={originalName:o+"/accum_var",variable:ie(function(){return Me(a).variable(!1)})});var s=Array.isArray(n)?n[i].tensor:n[o];if(s!=null){var u=r.accumulatedGrads[i].variable,c=r.accumulatedUpdates[i].variable;ie(function(){var l=u.mul(r.rho).add(s.square().mul(1-r.rho)),d=c.add(r.epsilon).sqrt().div(u.add(r.epsilon).sqrt()).mul(s),f=c.mul(r.rho).add(d.square().mul(1-r.rho));u.assign(l),c.assign(f);var h=d.mul(-r.learningRate).add(a);a.assign(h)})}}),this.incrementIterations()},e.prototype.dispose=function(){this.accumulatedUpdates!=null&&(gn(this.accumulatedGrads.map(function(n){return n.variable})),gn(this.accumulatedUpdates.map(function(n){return n.variable})))},e.prototype.getWeights=function(){return ue(this,void 0,void 0,function(){var n;return ce(this,function(r){switch(r.label){case 0:return n=this.accumulatedGrads.concat(this.accumulatedUpdates),[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(n.map(function(o){return{name:o.originalName,tensor:o.variable}}))]}})})},e.prototype.setWeights=function(n){return ue(this,void 0,void 0,function(){var r;return ce(this,function(o){switch(o.label){case 0:return[4,this.extractIterations(n)];case 1:return n=o.sent(),r=n.length/2,this.accumulatedGrads=n.slice(0,r).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),this.accumulatedUpdates=n.slice(r,2*r).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),[2]}})})},e.prototype.getConfig=function(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}},e.fromConfig=function(n,r){return new n(r.learningRate,r.rho,r.epsilon)},e.className="Adadelta",e}(Na);Ta(E7);var C7=function(t){function e(n,r){r===void 0&&(r=.1);var o=t.call(this)||this;return o.learningRate=n,o.initialAccumulatorValue=r,o.accumulatedGrads=[],o}return br(e,t),e.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(o){return o.name}):Object.keys(n)).forEach(function(o,i){var a=L.registeredVariables[o];r.accumulatedGrads[i]==null&&(r.accumulatedGrads[i]={originalName:o+"/accumulator",variable:ie(function(){return Hr(a.shape,r.initialAccumulatorValue).variable(!1)})});var s=Array.isArray(n)?n[i].tensor:n[o];if(s!=null){var u=r.accumulatedGrads[i].variable;ie(function(){var c=u.add(s.square());u.assign(c);var l=s.div(c.add(L.backend.epsilon()).sqrt()).mul(-r.learningRate).add(a);a.assign(l)})}}),this.incrementIterations()},e.prototype.dispose=function(){this.accumulatedGrads!=null&&gn(this.accumulatedGrads.map(function(n){return n.variable}))},e.prototype.getWeights=function(){return ue(this,void 0,void 0,function(){return ce(this,function(n){switch(n.label){case 0:return[4,this.saveIterations()];case 1:return[2,[n.sent()].concat(this.accumulatedGrads.map(function(r){return{name:r.originalName,tensor:r.variable}}))]}})})},e.prototype.setWeights=function(n){return ue(this,void 0,void 0,function(){return ce(this,function(r){switch(r.label){case 0:return[4,this.extractIterations(n)];case 1:return n=r.sent(),this.accumulatedGrads=n.map(function(o){return{originalName:o.name,variable:o.tensor.variable(!1)}}),[2]}})})},e.prototype.getConfig=function(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}},e.fromConfig=function(n,r){return new n(r.learningRate,r.initialAccumulatorValue)},e.className="Adagrad",e}(Na);Ta(C7);var _7=function(t){function e(n,r,o,i){i===void 0&&(i=null);var a=t.call(this)||this;return a.learningRate=n,a.beta1=r,a.beta2=o,a.epsilon=i,a.accumulatedFirstMoment=[],a.accumulatedSecondMoment=[],ie(function(){a.accBeta1=oe(r).variable(),a.accBeta2=oe(o).variable()}),i==null&&(a.epsilon=L.backend.epsilon()),a}return br(e,t),e.prototype.applyGradients=function(n){var r=this,o=Array.isArray(n)?n.map(function(i){return i.name}):Object.keys(n);ie(function(){var i=Ct(1,r.accBeta1),a=Ct(1,r.accBeta2);o.forEach(function(s,u){var c=L.registeredVariables[s];r.accumulatedFirstMoment[u]==null&&(r.accumulatedFirstMoment[u]={originalName:s+"/m",variable:ie(function(){return Me(c).variable(!1)})}),r.accumulatedSecondMoment[u]==null&&(r.accumulatedSecondMoment[u]={originalName:s+"/v",variable:ie(function(){return Me(c).variable(!1)})});var l=Array.isArray(n)?n[u].tensor:n[s];if(l!=null){var d=r.accumulatedFirstMoment[u].variable,f=r.accumulatedSecondMoment[u].variable,h=d.mul(r.beta1).add(l.mul(1-r.beta1)),m=f.mul(r.beta2).add(l.square().mul(1-r.beta2)),p=h.div(i),g=m.div(a);d.assign(h),f.assign(m);var v=p.div(g.sqrt().add(r.epsilon)).mul(-r.learningRate).add(c);c.assign(v)}}),r.accBeta1.assign(r.accBeta1.mul(r.beta1)),r.accBeta2.assign(r.accBeta2.mul(r.beta2))}),this.incrementIterations()},e.prototype.dispose=function(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&gn(this.accumulatedFirstMoment.map(function(n){return n.variable})),this.accumulatedSecondMoment!=null&&gn(this.accumulatedSecondMoment.map(function(n){return n.variable}))},e.prototype.getWeights=function(){return ue(this,void 0,void 0,function(){var n;return ce(this,function(r){switch(r.label){case 0:return n=this.accumulatedFirstMoment.concat(this.accumulatedSecondMoment),[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(n.map(function(o){return{name:o.originalName,tensor:o.variable}}))]}})})},e.prototype.setWeights=function(n){return ue(this,void 0,void 0,function(){var r,o=this;return ce(this,function(i){switch(i.label){case 0:return[4,this.extractIterations(n)];case 1:return n=i.sent(),ie(function(){o.accBeta1.assign(Rf(o.beta1,o.iterations_+1)),o.accBeta2.assign(Rf(o.beta2,o.iterations_+1))}),r=n.length/2,this.accumulatedFirstMoment=n.slice(0,r).map(function(a){return{originalName:a.name,variable:a.tensor.variable(!1)}}),this.accumulatedSecondMoment=n.slice(r,2*r).map(function(a){return{originalName:a.name,variable:a.tensor.variable(!1)}}),[2]}})})},e.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}},e.fromConfig=function(n,r){return new n(r.learningRate,r.beta1,r.beta2,r.epsilon)},e.className="Adam",e}(Na);Ta(_7);var S7=function(t){function e(n,r,o,i,a){i===void 0&&(i=null),a===void 0&&(a=0);var s=t.call(this)||this;return s.learningRate=n,s.beta1=r,s.beta2=o,s.epsilon=i,s.decay=a,s.accumulatedFirstMoment=[],s.accumulatedWeightedInfNorm=[],ie(function(){s.iteration=oe(0).variable(),s.accBeta1=oe(r).variable()}),i==null&&(s.epsilon=L.backend.epsilon()),s}return br(e,t),e.prototype.applyGradients=function(n){var r=this,o=Array.isArray(n)?n.map(function(i){return i.name}):Object.keys(n);ie(function(){var i=Ct(1,r.accBeta1),a=lr(-r.learningRate,r.iteration.mul(r.decay).add(1));o.forEach(function(s,u){var c=L.registeredVariables[s];r.accumulatedFirstMoment[u]==null&&(r.accumulatedFirstMoment[u]={originalName:s+"/m",variable:Me(c).variable(!1)}),r.accumulatedWeightedInfNorm[u]==null&&(r.accumulatedWeightedInfNorm[u]={originalName:s+"/v",variable:Me(c).variable(!1)});var l=Array.isArray(n)?n[u].tensor:n[s];if(l!=null){var d=r.accumulatedFirstMoment[u].variable,f=r.accumulatedWeightedInfNorm[u].variable,h=d.mul(r.beta1).add(l.mul(1-r.beta1)),m=f.mul(r.beta2),p=l.abs(),g=m.maximum(p);d.assign(h),f.assign(g);var v=a.div(i).mul(h.div(g.add(r.epsilon))).add(c);c.assign(v)}}),r.iteration.assign(r.iteration.add(1)),r.accBeta1.assign(r.accBeta1.mul(r.beta1))}),this.incrementIterations()},e.prototype.dispose=function(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&gn(this.accumulatedFirstMoment.map(function(n){return n.variable})),this.accumulatedWeightedInfNorm!=null&&gn(this.accumulatedWeightedInfNorm.map(function(n){return n.variable}))},e.prototype.getWeights=function(){return ue(this,void 0,void 0,function(){return ce(this,function(n){throw new Error("getWeights() is not implemented for Adamax yet.")})})},e.prototype.setWeights=function(n){return ue(this,void 0,void 0,function(){return ce(this,function(r){throw new Error("setWeights() is not implemented for Adamax yet.")})})},e.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}},e.fromConfig=function(n,r){return new n(r.learningRate,r.beta1,r.beta2,r.epsilon,r.decay)},e.className="Adamax",e}(Na);Ta(S7);var gT=function(t){function e(n){var r=t.call(this)||this;return r.learningRate=n,r.setLearningRate(n),r}return br(e,t),e.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(o){return o.name}):Object.keys(n)).forEach(function(o,i){var a=Array.isArray(n)?n[i].tensor:n[o];if(a!=null){var s=L.registeredVariables[o];ie(function(){var u=r.c.mul(a).add(s);s.assign(u)})}}),this.incrementIterations()},e.prototype.setLearningRate=function(n){this.learningRate=n,this.c!=null&&this.c.dispose(),this.c=HW(oe(-n))},e.prototype.dispose=function(){this.c.dispose()},e.prototype.getWeights=function(){return ue(this,void 0,void 0,function(){return ce(this,function(n){switch(n.label){case 0:return[4,this.saveIterations()];case 1:return[2,[n.sent()]]}})})},e.prototype.setWeights=function(n){return ue(this,void 0,void 0,function(){return ce(this,function(r){switch(r.label){case 0:return[4,this.extractIterations(n)];case 1:if((n=r.sent()).length!==0)throw new Error("SGD optimizer does not have settable weights.");return[2]}})})},e.prototype.getConfig=function(){return{learningRate:this.learningRate}},e.fromConfig=function(n,r){return new n(r.learningRate)},e.className="SGD",e}(Na);Ta(gT);var k7=function(t){function e(n,r,o){o===void 0&&(o=!1);var i=t.call(this,n)||this;return i.learningRate=n,i.momentum=r,i.useNesterov=o,i.accumulations=[],i.m=oe(i.momentum),i}return br(e,t),e.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(o){return o.name}):Object.keys(n)).forEach(function(o,i){var a=L.registeredVariables[o];r.accumulations[i]==null&&(r.accumulations[i]={originalName:o+"/momentum",variable:ie(function(){return Me(a).variable(!1)})});var s=r.accumulations[i].variable,u=Array.isArray(n)?n[i].tensor:n[o];u!=null&&ie(function(){var c,l=r.m.mul(s).add(u);c=r.useNesterov?r.c.mul(u.add(l.mul(r.m))).add(a):r.c.mul(l).add(a),s.assign(l),a.assign(c)})}),this.incrementIterations()},e.prototype.dispose=function(){this.m.dispose(),this.accumulations!=null&&gn(this.accumulations.map(function(n){return n.variable}))},e.prototype.setMomentum=function(n){this.momentum=n},e.prototype.getWeights=function(){return ue(this,void 0,void 0,function(){return ce(this,function(n){switch(n.label){case 0:return[4,this.saveIterations()];case 1:return[2,[n.sent()].concat(this.accumulations.map(function(r){return{name:r.originalName,tensor:r.variable}}))]}})})},e.prototype.setWeights=function(n){return ue(this,void 0,void 0,function(){return ce(this,function(r){switch(r.label){case 0:return[4,this.extractIterations(n)];case 1:return n=r.sent(),this.accumulations=n.map(function(o){return{originalName:o.name,variable:o.tensor.variable(!1)}}),[2]}})})},e.prototype.getConfig=function(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}},e.fromConfig=function(n,r){return new n(r.learningRate,r.momentum,r.useNesterov)},e.className="Momentum",e}(gT);Ta(k7);var I7=function(t){function e(n,r,o,i,a){r===void 0&&(r=.9),o===void 0&&(o=0),i===void 0&&(i=null),a===void 0&&(a=!1);var s=t.call(this)||this;if(s.learningRate=n,s.decay=r,s.momentum=o,s.epsilon=i,s.accumulatedMeanSquares=[],s.accumulatedMoments=[],s.accumulatedMeanGrads=[],s.centered=a,i==null&&(s.epsilon=L.backend.epsilon()),n==null)throw new Error("learningRate for RMSPropOptimizer must be defined.");return s}return br(e,t),e.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(o){return o.name}):Object.keys(n)).forEach(function(o,i){var a=L.registeredVariables[o];r.accumulatedMeanSquares[i]==null&&(r.accumulatedMeanSquares[i]={originalName:o+"/rms",variable:ie(function(){return Me(a).variable(!1)})}),r.accumulatedMoments[i]==null&&(r.accumulatedMoments[i]={originalName:o+"/momentum",variable:ie(function(){return Me(a).variable(!1)})}),r.accumulatedMeanGrads[i]==null&&r.centered&&(r.accumulatedMeanGrads[i]={originalName:o+"/mg",variable:ie(function(){return Me(a).variable(!1)})});var s=Array.isArray(n)?n[i].tensor:n[o];if(s!=null){var u=r.accumulatedMeanSquares[i].variable,c=r.accumulatedMoments[i].variable;ie(function(){var l=u.mul(r.decay).add(s.square().mul(1-r.decay));if(r.centered){var d=r.accumulatedMeanGrads[i].variable,f=d.mul(r.decay).add(s.mul(1-r.decay)),h=c.mul(r.momentum).add(s.mul(r.learningRate).div(l.sub(f.square().add(r.epsilon)).sqrt()));u.assign(l),d.assign(f),c.assign(h);var m=a.sub(h);a.assign(m)}else{var p=u.mul(r.decay).add(s.square().mul(1-r.decay));h=c.mul(r.momentum).add(s.mul(r.learningRate).div(p.add(r.epsilon).sqrt())),u.assign(p),c.assign(h),m=a.sub(h),a.assign(m)}})}}),this.incrementIterations()},e.prototype.dispose=function(){this.accumulatedMeanSquares!=null&&gn(this.accumulatedMeanSquares.map(function(n){return n.variable})),this.accumulatedMeanGrads!=null&&this.centered&&gn(this.accumulatedMeanGrads.map(function(n){return n.variable})),this.accumulatedMoments!=null&&gn(this.accumulatedMoments.map(function(n){return n.variable}))},e.prototype.getWeights=function(){return ue(this,void 0,void 0,function(){var n;return ce(this,function(r){switch(r.label){case 0:return n=this.accumulatedMeanSquares.concat(this.accumulatedMoments),this.centered&&n.push.apply(n,this.accumulatedMeanGrads),[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(n.map(function(o){return{name:o.originalName,tensor:o.variable}}))]}})})},e.prototype.setWeights=function(n){return ue(this,void 0,void 0,function(){var r;return ce(this,function(o){switch(o.label){case 0:return[4,this.extractIterations(n)];case 1:return n=o.sent(),r=this.centered?n.length/3:n.length/2,this.accumulatedMeanSquares=n.slice(0,r).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),this.accumulatedMoments=n.slice(r,2*r).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),this.centered&&(this.accumulatedMeanGrads=n.slice(2*r,3*r).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}})),[2]}})})},e.prototype.getConfig=function(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}},e.fromConfig=function(n,r){return new n(r.learningRate,r.decay,r.momentum,r.epsilon,r.centered)},e.className="RMSProp",e}(Na);Ta(I7);tt.prototype.squaredDifference=function(t){return PR(this,t)},V=ZG;/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var tg=function(t,e){return tg=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)r.hasOwnProperty(o)&&(n[o]=r[o])},tg(t,e)};function Ee(t,e){tg(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var Kt=function(){return Kt=Object.assign||function(e){for(var n,r=1,o=arguments.length;r<o;r++){n=arguments[r];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Kt.apply(this,arguments)};function fe(t,e,n,r){function o(i){return i instanceof n?i:new n(function(a){a(i)})}return new(n||(n=Promise))(function(i,a){function s(l){try{c(r.next(l))}catch(d){a(d)}}function u(l){try{c(r.throw(l))}catch(d){a(d)}}function c(l){l.done?i(l.value):o(l.value).then(s,u)}c((r=r.apply(t,[])).next())})}function he(t,e){var n={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},r,o,i,a;return a={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function s(c){return function(l){return u([c,l])}}function u(c){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,o&&(i=c[0]&2?o.return:c[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,c[1])).done)return i;switch(o=0,i&&(c=[c[0]&2,i.value]),c[0]){case 0:case 1:i=c;break;case 4:return n.label++,{value:c[1],done:!1};case 5:n.label++,o=c[1],c=[0];continue;case 7:c=n.ops.pop(),n.trys.pop();continue;default:if(i=n.trys,!(i=i.length>0&&i[i.length-1])&&(c[0]===6||c[0]===2)){n=0;continue}if(c[0]===3&&(!i||c[1]>i[0]&&c[1]<i[3])){n.label=c[1];break}if(c[0]===6&&n.label<i[1]){n.label=i[1],i=c;break}if(i&&n.label<i[2]){n.label=i[2],n.ops.push(c);break}i[2]&&n.ops.pop(),n.trys.pop();continue}c=e.call(t,n)}catch(l){c=[6,l],o=0}finally{r=i=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}function Ku(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),o=0,e=0;e<n;e++)for(var i=arguments[e],a=0,s=i.length;a<s;a++,o++)r[o]=i[a];return r}var _s=function(){function t(e,n){if(!ua(e)||!ua(n))throw new Error("Dimensions.constructor - expected width and height to be valid numbers, instead have "+JSON.stringify({width:e,height:n}));this._width=e,this._height=n}return Object.defineProperty(t.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),t.prototype.reverse=function(){return new t(1/this.width,1/this.height)},t}();function Ph(t,e){return t instanceof tt&&t.shape.length===e}function R7(t){return Ph(t,2)}function Dh(t){return Ph(t,3)}function Ei(t){return Ph(t,4)}function T7(t){return t%1!==0}function Db(t){return t%2===0}function N7(t,e){e===void 0&&(e=2);var n=Math.pow(10,e);return Math.floor(t*n)/n}function Mb(t){return t&&t.width&&t.height}function A7(t,e){var n=t.width,r=t.height,o=e/Math.max(r,n);return new _s(Math.round(n*o),Math.round(r*o))}function x0(t){return t.reduce(function(e,n){return e.add(n)},new Be(0,0)).div(new Be(t.length,t.length))}function Rc(t,e,n){return Array(t).fill(0).map(function(r,o){return e+o*n})}function ua(t){return!!t&&t!==1/0&&t!==-1/0&&!isNaN(t)||t===0}function Ob(t){return ua(t)&&0<=t&&t<=1}var Be=function(){function t(e,n){this._x=e,this._y=n}return Object.defineProperty(t.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),t.prototype.add=function(e){return new t(this.x+e.x,this.y+e.y)},t.prototype.sub=function(e){return new t(this.x-e.x,this.y-e.y)},t.prototype.mul=function(e){return new t(this.x*e.x,this.y*e.y)},t.prototype.div=function(e){return new t(this.x/e.x,this.y/e.y)},t.prototype.abs=function(){return new t(Math.abs(this.x),Math.abs(this.y))},t.prototype.magnitude=function(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))},t.prototype.floor=function(){return new t(Math.floor(this.x),Math.floor(this.y))},t}(),Ri=function(){function t(e,n){n===void 0&&(n=!0);var r=e||{},o=[r.left,r.top,r.right,r.bottom].every(ua),i=[r.x,r.y,r.width,r.height].every(ua);if(!i&&!o)throw new Error("Box.constructor - expected box to be IBoundingBox | IRect, instead have "+JSON.stringify(r));var a=i?[r.x,r.y,r.width,r.height]:[r.left,r.top,r.right-r.left,r.bottom-r.top],s=a[0],u=a[1],c=a[2],l=a[3];t.assertIsValidBox({x:s,y:u,width:c,height:l},"Box.constructor",n),this._x=s,this._y=u,this._width=c,this._height=l}return t.isRect=function(e){return!!e&&[e.x,e.y,e.width,e.height].every(ua)},t.assertIsValidBox=function(e,n,r){if(r===void 0&&(r=!1),!t.isRect(e))throw new Error(n+" - invalid box: "+JSON.stringify(e)+", expected object with properties x, y, width, height");if(!r&&(e.width<0||e.height<0))throw new Error(n+" - width ("+e.width+") and height ("+e.height+") must be positive numbers")},Object.defineProperty(t.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"top",{get:function(){return this.y},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"area",{get:function(){return this.width*this.height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"topLeft",{get:function(){return new Be(this.left,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"topRight",{get:function(){return new Be(this.right,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bottomLeft",{get:function(){return new Be(this.left,this.bottom)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bottomRight",{get:function(){return new Be(this.right,this.bottom)},enumerable:!0,configurable:!0}),t.prototype.round=function(){var e=[this.x,this.y,this.width,this.height].map(function(a){return Math.round(a)}),n=e[0],r=e[1],o=e[2],i=e[3];return new t({x:n,y:r,width:o,height:i})},t.prototype.floor=function(){var e=[this.x,this.y,this.width,this.height].map(function(a){return Math.floor(a)}),n=e[0],r=e[1],o=e[2],i=e[3];return new t({x:n,y:r,width:o,height:i})},t.prototype.toSquare=function(){var e=this,n=e.x,r=e.y,o=e.width,i=e.height,a=Math.abs(o-i);return o<i&&(n-=a/2,o+=a),i<o&&(r-=a/2,i+=a),new t({x:n,y:r,width:o,height:i})},t.prototype.rescale=function(e){var n=Mb(e)?e.width:e,r=Mb(e)?e.height:e;return new t({x:this.x*n,y:this.y*r,width:this.width*n,height:this.height*r})},t.prototype.pad=function(e,n){var r=[this.x-e/2,this.y-n/2,this.width+e,this.height+n],o=r[0],i=r[1],a=r[2],s=r[3];return new t({x:o,y:i,width:a,height:s})},t.prototype.clipAtImageBorders=function(e,n){var r=this,o=r.x,i=r.y,a=r.right,s=r.bottom,u=Math.max(o,0),c=Math.max(i,0),l=a-u,d=s-c,f=Math.min(l,e-u),h=Math.min(d,n-c);return new t({x:u,y:c,width:f,height:h}).floor()},t.prototype.shift=function(e,n){var r=this,o=r.width,i=r.height,a=this.x+e,s=this.y+n;return new t({x:a,y:s,width:o,height:i})},t.prototype.padAtBorders=function(e,n){var r=this.width+1,o=this.height+1,i=1,a=1,s=r,u=o,c=this.left,l=this.top,d=this.right,f=this.bottom;return d>n&&(s=-d+n+r,d=n),f>e&&(u=-f+e+o,f=e),c<1&&(u=2-c,c=1),l<1&&(u=2-l,l=1),{dy:a,edy:u,dx:i,edx:s,y:l,ey:f,x:c,ex:d,w:r,h:o}},t.prototype.calibrate=function(e){return new t({left:this.left+e.left*this.width,top:this.top+e.top*this.height,right:this.right+e.right*this.width,bottom:this.bottom+e.bottom*this.height}).toSquare().round()},t}(),Mh=function(t){Ee(e,t);function e(n,r,o,i,a){return a===void 0&&(a=!1),t.call(this,{left:n,top:r,right:o,bottom:i},a)||this}return e}(Ri),yT=function(){function t(e,n,r,o,i){this._imageDims=new _s(i.width,i.height),this._score=e,this._classScore=n,this._className=r,this._box=new Ri(o).rescale(this._imageDims)}return Object.defineProperty(t.prototype,"score",{get:function(){return this._score},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"classScore",{get:function(){return this._classScore},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"className",{get:function(){return this._className},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"box",{get:function(){return this._box},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imageDims",{get:function(){return this._imageDims},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imageWidth",{get:function(){return this.imageDims.width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imageHeight",{get:function(){return this.imageDims.height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"relativeBox",{get:function(){return new Ri(this._box).rescale(this.imageDims.reverse())},enumerable:!0,configurable:!0}),t.prototype.forSize=function(e,n){return new t(this.score,this.classScore,this.className,this.relativeBox,{width:e,height:n})},t}(),Zr=function(t){Ee(e,t);function e(n,r,o){return t.call(this,n,n,"",r,o)||this}return e.prototype.forSize=function(n,r){var o=t.prototype.forSize.call(this,n,r),i=o.score,a=o.relativeBox,s=o.imageDims;return new e(i,a,s)},e}(yT);function P7(t,e,n){n===void 0&&(n=!0);var r=Math.max(0,Math.min(t.right,e.right)-Math.max(t.left,e.left)),o=Math.max(0,Math.min(t.bottom,e.bottom)-Math.max(t.top,e.top)),i=r*o;return n?i/(t.area+e.area-i):i/Math.min(t.area,e.area)}function D7(t){var e=t.map(function(s){return s.x}),n=t.map(function(s){return s.y}),r=e.reduce(function(s,u){return u<s?u:s},1/0),o=n.reduce(function(s,u){return u<s?u:s},1/0),i=e.reduce(function(s,u){return s<u?u:s},0),a=n.reduce(function(s,u){return s<u?u:s},0);return new Mh(r,o,i,a)}function Tc(t,e,n,r){r===void 0&&(r=!0);for(var o=e.map(function(s,u){return{score:s,boxIndex:u}}).sort(function(s,u){return s.score-u.score}).map(function(s){return s.boxIndex}),i=[],a=function(){var s=o.pop();i.push(s);for(var u=o,c=[],l=0;l<u.length;l++){var d=u[l],f=t[s],h=t[d];c.push(P7(f,h,r))}o=o.filter(function(m,p){return c[p]<=n})};o.length>0;)a();return i}function sl(t,e){return ie(function(){var n=e[0],r=e[1],o=e[2],i=Hr(Ku(t.shape.slice(0,3),[1]),n),a=Hr(Ku(t.shape.slice(0,3),[1]),r),s=Hr(Ku(t.shape.slice(0,3),[1]),o),u=wt([i,a,s],3);return Ct(t,u)})}function M7(t,e){return e===void 0&&(e=!1),ie(function(){var n=t.shape.slice(1),r=n[0],o=n[1];if(r===o)return t;var i=Math.abs(r-o),a=Math.round(i*(e?.5:1)),s=r>o?2:1,u=function(h){var m=t.shape.slice();return m[s]=h,Hr(m,0)},c=u(a),l=i-c.shape[s],d=e&&l?u(l):null,f=[d,t,c].filter(function(h){return!!h}).map(function(h){return h.toFloat()});return wt(f,s)})}function um(t){return 1/(1+Math.exp(-t))}var w0=function(t){Ee(e,t);function e(n,r,o,i,a){return a===void 0&&(a=!1),t.call(this,{x:n,y:r,width:o,height:i},a)||this}return e}(Ri),O7=.5,F7=.43,L7=.45,Af=function(){function t(e,n,r){r===void 0&&(r=new Be(0,0));var o=n.width,i=n.height;this._imgDims=new _s(o,i),this._shift=r,this._positions=e.map(function(a){return a.mul(new Be(o,i)).add(r)})}return Object.defineProperty(t.prototype,"shift",{get:function(){return new Be(this._shift.x,this._shift.y)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imageWidth",{get:function(){return this._imgDims.width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imageHeight",{get:function(){return this._imgDims.height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"positions",{get:function(){return this._positions},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"relativePositions",{get:function(){var e=this;return this._positions.map(function(n){return n.sub(e._shift).div(new Be(e.imageWidth,e.imageHeight))})},enumerable:!0,configurable:!0}),t.prototype.forSize=function(e,n){return new this.constructor(this.relativePositions,{width:e,height:n})},t.prototype.shiftBy=function(e,n){return new this.constructor(this.relativePositions,this._imgDims,new Be(e,n))},t.prototype.shiftByPoint=function(e){return this.shiftBy(e.x,e.y)},t.prototype.align=function(e,n){if(n===void 0&&(n={}),e){var r=e instanceof Zr?e.box.floor():new Ri(e);return this.shiftBy(r.x,r.y).align(null,n)}var o=Object.assign({},{useDlibAlignment:!1,minBoxPadding:.2},n),i=o.useDlibAlignment,a=o.minBoxPadding;return i?this.alignDlib():this.alignMinBbox(a)},t.prototype.alignDlib=function(){var e=this.getRefPointsForAlignment(),n=e[0],r=e[1],o=e[2],i=function(d){return o.sub(d).magnitude()},a=(i(n)+i(r))/2,s=Math.floor(a/L7),u=x0(e),c=Math.floor(Math.max(0,u.x-O7*s)),l=Math.floor(Math.max(0,u.y-F7*s));return new w0(c,l,Math.min(s,this.imageWidth+c),Math.min(s,this.imageHeight+l))},t.prototype.alignMinBbox=function(e){var n=D7(this.positions);return n.pad(n.width*e,n.height*e)},t.prototype.getRefPointsForAlignment=function(){throw new Error("getRefPointsForAlignment not implemented by base class")},t}(),B7=function(t){Ee(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.getRefPointsForAlignment=function(){var n=this.positions;return[n[0],n[1],x0([n[3],n[4]])]},e}(Af),j7=function(t){Ee(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.getJawOutline=function(){return this.positions.slice(0,17)},e.prototype.getLeftEyeBrow=function(){return this.positions.slice(17,22)},e.prototype.getRightEyeBrow=function(){return this.positions.slice(22,27)},e.prototype.getNose=function(){return this.positions.slice(27,36)},e.prototype.getLeftEye=function(){return this.positions.slice(36,42)},e.prototype.getRightEye=function(){return this.positions.slice(42,48)},e.prototype.getMouth=function(){return this.positions.slice(48,68)},e.prototype.getRefPointsForAlignment=function(){return[this.getLeftEye(),this.getRightEye(),this.getMouth()].map(x0)},e}(Af),Fb=function(){function t(e,n){this._label=e,this._distance=n}return Object.defineProperty(t.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"distance",{get:function(){return this._distance},enumerable:!0,configurable:!0}),t.prototype.toString=function(e){return e===void 0&&(e=!0),""+this.label+(e?" ("+N7(this.distance)+")":"")},t}(),Lb=function(t){Ee(e,t);function e(n,r){var o=t.call(this,n)||this;return o._label=r,o}return e.assertIsValidLabeledBox=function(n,r){if(Ri.assertIsValidBox(n,r),!ua(n.label))throw new Error(r+" - expected property label ("+n.label+") to be a number")},Object.defineProperty(e.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),e}(Ri),Xl=function(){function t(e,n){if(typeof e!="string")throw new Error("LabeledFaceDescriptors - constructor expected label to be a string");if(!Array.isArray(n)||n.some(function(r){return!(r instanceof Float32Array)}))throw new Error("LabeledFaceDescriptors - constructor expected descriptors to be an array of Float32Array");this._label=e,this._descriptors=n}return Object.defineProperty(t.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"descriptors",{get:function(){return this._descriptors},enumerable:!0,configurable:!0}),t.prototype.toJSON=function(){return{label:this.label,descriptors:this.descriptors.map(function(e){return Array.from(e)})}},t.fromJSON=function(e){var n=e.descriptors.map(function(r){return new Float32Array(r)});return new t(e.label,n)},t}();(function(t){Ee(e,t);function e(n,r,o,i){var a=t.call(this,n,r)||this;return a._score=o,a._classScore=i,a}return e.assertIsValidPredictedBox=function(n,r){if(Lb.assertIsValidLabeledBox(n,r),!Ob(n.score)||!Ob(n.classScore))throw new Error(r+" - expected properties score ("+n.score+") and ("+n.classScore+") to be a number between [0, 1]")},Object.defineProperty(e.prototype,"score",{get:function(){return this._score},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"classScore",{get:function(){return this._classScore},enumerable:!0,configurable:!0}),e})(Lb);function U7(t){return t.detection instanceof Zr}function b0(t,e){var n={detection:e};return Object.assign({},t,n)}function xT(){var t=window.fetch||function(){throw new Error("fetch - missing fetch implementation for browser environment")},e=function(){throw new Error("readFile - filesystem not available for browser environment")};return{Canvas:HTMLCanvasElement,CanvasRenderingContext2D,Image:HTMLImageElement,ImageData,Video:HTMLVideoElement,createCanvasElement:function(){return document.createElement("canvas")},createImageElement:function(){return document.createElement("img")},fetch:t,readFile:e}}function wT(t){var e="";if(!t)try{t=require("fs")}catch(r){e=r.toString()}var n=t?function(r){return new Promise(function(o,i){t.readFile(r,function(a,s){return a?i(a):o(s)})})}:function(){throw new Error("readFile - failed to require fs in nodejs environment with error: "+e)};return{readFile:n}}function bT(){var t=global.Canvas||global.HTMLCanvasElement,e=global.Image||global.HTMLImageElement,n=function(){if(t)return new t;throw new Error("createCanvasElement - missing Canvas implementation for nodejs environment")},r=function(){if(e)return new e;throw new Error("createImageElement - missing Image implementation for nodejs environment")},o=global.fetch||function(){throw new Error("fetch - missing fetch implementation for nodejs environment")},i=wT();return Kt({Canvas:t||function(){function a(){}return a}(),CanvasRenderingContext2D:global.CanvasRenderingContext2D||function(){function a(){}return a}(),Image:e||function(){function a(){}return a}(),ImageData:global.ImageData||function(){function a(){}return a}(),Video:global.HTMLVideoElement||function(){function a(){}return a}(),createCanvasElement:n,createImageElement:r,fetch:o},i)}function ET(){return typeof window=="object"&&typeof document<"u"&&typeof HTMLImageElement<"u"&&typeof HTMLCanvasElement<"u"&&typeof HTMLVideoElement<"u"&&typeof ImageData<"u"&&typeof CanvasRenderingContext2D<"u"}function CT(){return typeof global=="object"&&typeof require=="function"&&typeof nN<"u"&&typeof process<"u"&&!!process.version}var gt;function W7(){if(!gt)throw new Error("getEnv - environment is not defined, check isNodejs() and isBrowser()");return gt}function ng(t){gt=t}function E0(){ET()&&ng(xT()),CT()&&ng(bT())}function $7(t){if(gt||E0(),!gt)throw new Error("monkeyPatch - environment is not defined, check isNodejs() and isBrowser()");var e=t.Canvas,n=e===void 0?gt.Canvas:e,r=t.Image,o=r===void 0?gt.Image:r;gt.Canvas=n,gt.Image=o,gt.createCanvasElement=t.createCanvasElement||function(){return new n},gt.createImageElement=t.createImageElement||function(){return new o},gt.ImageData=t.ImageData||gt.ImageData,gt.Video=t.Video||gt.Video,gt.fetch=t.fetch||gt.fetch,gt.readFile=t.readFile||gt.readFile}var Jt={getEnv:W7,setEnv:ng,initialize:E0,createBrowserEnv:xT,createFileSystem:wT,createNodejsEnv:bT,monkeyPatch:$7,isBrowser:ET,isNodejs:CT};E0();function _T(t){return!Jt.isNodejs()&&typeof t=="string"?document.getElementById(t):t}function ya(t){var e=Jt.getEnv(),n=e.Canvas,r=e.CanvasRenderingContext2D;if(t instanceof r)return t;var o=_T(t);if(!(o instanceof n))throw new Error("resolveContext2d - expected canvas to be of instance of Canvas");var i=o.getContext("2d");if(!i)throw new Error("resolveContext2d - canvas 2d context is null");return i}var Bb;(function(t){t.TOP_LEFT="TOP_LEFT",t.TOP_RIGHT="TOP_RIGHT",t.BOTTOM_LEFT="BOTTOM_LEFT",t.BOTTOM_RIGHT="BOTTOM_RIGHT"})(Bb||(Bb={}));function ST(t){var e=Jt.getEnv(),n=e.Image,r=e.Video;return t instanceof n&&t.complete||t instanceof r&&t.readyState>=3}function z7(t){return new Promise(function(e,n){if(t instanceof Jt.getEnv().Canvas||ST(t))return e();function r(i){i.currentTarget&&(i.currentTarget.removeEventListener("load",r),i.currentTarget.removeEventListener("error",o),e(i))}function o(i){i.currentTarget&&(i.currentTarget.removeEventListener("load",r),i.currentTarget.removeEventListener("error",o),n(i))}t.addEventListener("load",r),t.addEventListener("error",o)})}function kT(t){var e=Jt.getEnv(),n=e.Image,r=e.Video;return t instanceof n?new _s(t.naturalWidth,t.naturalHeight):t instanceof r?new _s(t.videoWidth,t.videoHeight):new _s(t.width,t.height)}function Oh(t){var e=t.width,n=t.height,r=Jt.getEnv().createCanvasElement,o=r();return o.width=e,o.height=n,o}function C0(t,e){var n=Jt.getEnv().ImageData;if(!(t instanceof n)&&!ST(t))throw new Error("createCanvasFromMedia - media has not finished loading yet");var r=kT(t),o=r.width,i=r.height,a=Oh({width:o,height:i});return t instanceof n?ya(a).putImageData(t,0,0):ya(a).drawImage(t,0,0,o,i),a}function V7(t,e){return fe(this,void 0,void 0,function(){var n,r,o,i,a,s;return he(this,function(u){switch(u.label){case 0:return n=Jt.getEnv().createCanvasElement(),r=t.shape.slice(Ei(t)?1:0),o=r[0],i=r[1],a=r[2],s=ie(function(){return t.as3D(o,i,a).toInt()}),[4,y0.toPixels(s,n)];case 1:return u.sent(),s.dispose(),[2,n]}})})}function jb(t){var e=Jt.getEnv(),n=e.Image,r=e.Canvas,o=e.Video;return t instanceof n||t instanceof r||t instanceof o}function H7(t,e,n){n===void 0&&(n=!1);var r=Jt.getEnv(),o=r.Image,i=r.Canvas;if(!(t instanceof o||t instanceof i))throw new Error("imageToSquare - expected arg0 to be HTMLImageElement | HTMLCanvasElement");var a=kT(t),s=e/Math.max(a.height,a.width),u=s*a.width,c=s*a.height,l=Oh({width:e,height:e}),d=t instanceof i?t:C0(t),f=Math.abs(u-c)/2,h=n&&u<c?f:0,m=n&&c<u?f:0;return ya(l).drawImage(d,h,m,u,c),l}var Pf=function(){function t(e,n){var r=this;if(n===void 0&&(n=!1),this._imageTensors=[],this._canvases=[],this._treatAsBatchInput=!1,this._inputDimensions=[],!Array.isArray(e))throw new Error("NetInput.constructor - expected inputs to be an Array of TResolvedNetInput or to be instanceof tf.Tensor4D, instead have "+e);this._treatAsBatchInput=n,this._batchSize=e.length,e.forEach(function(o,i){if(Dh(o)){r._imageTensors[i]=o,r._inputDimensions[i]=o.shape;return}if(Ei(o)){var a=o.shape[0];if(a!==1)throw new Error("NetInput - tf.Tensor4D with batchSize "+a+" passed, but not supported in input array");r._imageTensors[i]=o,r._inputDimensions[i]=o.shape.slice(1);return}var s=o instanceof Jt.getEnv().Canvas?o:C0(o);r._canvases[i]=s,r._inputDimensions[i]=[s.height,s.width,3]})}return Object.defineProperty(t.prototype,"imageTensors",{get:function(){return this._imageTensors},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"canvases",{get:function(){return this._canvases},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isBatchInput",{get:function(){return this.batchSize>1||this._treatAsBatchInput},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"batchSize",{get:function(){return this._batchSize},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"inputDimensions",{get:function(){return this._inputDimensions},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"inputSize",{get:function(){return this._inputSize},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"reshapedInputDimensions",{get:function(){var e=this;return Rc(this.batchSize,0,1).map(function(n,r){return e.getReshapedInputDimensions(r)})},enumerable:!0,configurable:!0}),t.prototype.getInput=function(e){return this.canvases[e]||this.imageTensors[e]},t.prototype.getInputDimensions=function(e){return this._inputDimensions[e]},t.prototype.getInputHeight=function(e){return this._inputDimensions[e][0]},t.prototype.getInputWidth=function(e){return this._inputDimensions[e][1]},t.prototype.getReshapedInputDimensions=function(e){if(typeof this.inputSize!="number")throw new Error("getReshapedInputDimensions - inputSize not set, toBatchTensor has not been called yet");var n=this.getInputWidth(e),r=this.getInputHeight(e);return A7({width:n,height:r},this.inputSize)},t.prototype.toBatchTensor=function(e,n){var r=this;return n===void 0&&(n=!0),this._inputSize=e,ie(function(){var o=Rc(r.batchSize,0,1).map(function(a){var s=r.getInput(a);if(s instanceof tt){var u=Ei(s)?s:s.expandDims();return u=M7(u,n),(u.shape[1]!==e||u.shape[2]!==e)&&(u=f0.resizeBilinear(u,[e,e])),u.as3D(e,e,3)}if(s instanceof Jt.getEnv().Canvas)return y0.fromPixels(H7(s,e,n));throw new Error("toBatchTensor - at batchIdx "+a+", expected input to be instanceof tf.Tensor or instanceof HTMLCanvasElement, instead have "+s)}),i=Dn(o.map(function(a){return a.toFloat()})).as4D(r.batchSize,e,e,3);return i})},t}();function Pt(t){return fe(this,void 0,void 0,function(){var e,n,r;return he(this,function(o){switch(o.label){case 0:if(t instanceof Pf)return[2,t];if(e=Array.isArray(t)?t:[t],!e.length)throw new Error("toNetInput - empty array passed as input");return n=function(i){return Array.isArray(t)?" at input index "+i+":":""},r=e.map(_T),r.forEach(function(i,a){if(!jb(i)&&!Dh(i)&&!Ei(i))throw typeof e[a]=="string"?new Error("toNetInput -"+n(a)+" string passed, but could not resolve HTMLElement for element id "+e[a]):new Error("toNetInput -"+n(a)+" expected media to be of type HTMLImageElement | HTMLVideoElement | HTMLCanvasElement | tf.Tensor3D, or to be an element id");if(Ei(i)){var s=i.shape[0];if(s!==1)throw new Error("toNetInput -"+n(a)+" tf.Tensor4D with batchSize "+s+" passed, but not supported in input array")}}),[4,Promise.all(r.map(function(i){return jb(i)&&z7(i)}))];case 1:return o.sent(),[2,new Pf(r,Array.isArray(t))]}})})}function _0(t,e){return fe(this,void 0,void 0,function(){var n,r,o,i,a,s,u;return he(this,function(c){switch(c.label){case 0:return n=Jt.getEnv().Canvas,r=t,t instanceof n?[3,5]:[4,Pt(t)];case 1:if(o=c.sent(),o.batchSize>1)throw new Error("extractFaces - batchSize > 1 not supported");return i=o.getInput(0),i instanceof n?(a=i,[3,4]):[3,2];case 2:return[4,V7(i)];case 3:a=c.sent(),c.label=4;case 4:r=a,c.label=5;case 5:return s=ya(r),u=e.map(function(l){return l instanceof Zr?l.forSize(r.width,r.height).box.floor():l}).map(function(l){return l.clipAtImageBorders(r.width,r.height)}),[2,u.map(function(l){var d=l.x,f=l.y,h=l.width,m=l.height,p=Oh({width:h,height:m});return ya(p).putImageData(s.getImageData(d,f,h,m),0,0),p})]}})})}function S0(t,e){return fe(this,void 0,void 0,function(){return he(this,function(n){if(!Dh(t)&&!Ei(t))throw new Error("extractFaceTensors - expected image tensor to be 3D or 4D");if(Ei(t)&&t.shape[0]>1)throw new Error("extractFaceTensors - batchSize > 1 not supported");return[2,ie(function(){var r=t.shape.slice(Ei(t)?1:0),o=r[0],i=r[1],a=r[2],s=e.map(function(c){return c instanceof Zr?c.forSize(i,o).box:c}).map(function(c){return c.clipAtImageBorders(i,o)}),u=s.map(function(c){var l=c.x,d=c.y,f=c.width,h=c.height;return ZR(t.as3D(o,i,a),[d,l,0],[h,f,a])});return u})]})})}function G7(t,e){return fe(this,void 0,void 0,function(){var n,r;return he(this,function(o){switch(o.label){case 0:return n=Jt.getEnv().fetch,[4,n(t,e)];case 1:if(r=o.sent(),!(r.status<400))throw new Error("failed to fetch: ("+r.status+") "+r.statusText+", from url: "+r.url);return[2,r]}})})}function K7(t){return fe(this,void 0,void 0,function(){return he(this,function(e){switch(e.label){case 0:return[4,G7(t)];case 1:return[2,e.sent().json()]}})})}function IT(t,e){var n=e+"-weights_manifest.json";if(!t)return{modelBaseUri:"",manifestUri:n};if(t==="/")return{modelBaseUri:"/",manifestUri:"/"+n};var r=t.startsWith("http://")?"http://":t.startsWith("https://")?"https://":"";t=t.replace(r,"");var o=t.split("/").filter(function(s){return s}),i=t.endsWith(".json")?o[o.length-1]:n,a=r+(t.endsWith(".json")?o.slice(0,o.length-1):o).join("/");return a=t.startsWith("/")?"/"+a:a,{modelBaseUri:a,manifestUri:a==="/"?"/"+i:a+"/"+i}}function q7(t,e){return fe(this,void 0,void 0,function(){var n,r,o,i;return he(this,function(a){switch(a.label){case 0:return n=IT(t,e),r=n.manifestUri,o=n.modelBaseUri,[4,K7(r)];case 1:return i=a.sent(),[2,vT.loadWeights(i,o)]}})})}var Ao=function(){function t(e){this._name=e,this._params=void 0,this._paramMappings=[]}return Object.defineProperty(t.prototype,"params",{get:function(){return this._params},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"paramMappings",{get:function(){return this._paramMappings},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isLoaded",{get:function(){return!!this.params},enumerable:!0,configurable:!0}),t.prototype.getParamFromPath=function(e){var n=this.traversePropertyPath(e),r=n.obj,o=n.objProp;return r[o]},t.prototype.reassignParamFromPath=function(e,n){var r=this.traversePropertyPath(e),o=r.obj,i=r.objProp;o[i].dispose(),o[i]=n},t.prototype.getParamList=function(){var e=this;return this._paramMappings.map(function(n){var r=n.paramPath;return{path:r,tensor:e.getParamFromPath(r)}})},t.prototype.getTrainableParams=function(){return this.getParamList().filter(function(e){return e.tensor instanceof Js})},t.prototype.getFrozenParams=function(){return this.getParamList().filter(function(e){return!(e.tensor instanceof Js)})},t.prototype.variable=function(){var e=this;this.getFrozenParams().forEach(function(n){var r=n.path,o=n.tensor;e.reassignParamFromPath(r,o.variable())})},t.prototype.freeze=function(){var e=this;this.getTrainableParams().forEach(function(n){var r=n.path,o=n.tensor,i=Ft(o.dataSync());o.dispose(),e.reassignParamFromPath(r,i)})},t.prototype.dispose=function(e){e===void 0&&(e=!0),this.getParamList().forEach(function(n){if(e&&n.tensor.isDisposed)throw new Error("param tensor has already been disposed for path "+n.path);n.tensor.dispose()}),this._params=void 0},t.prototype.serializeParams=function(){return new Float32Array(this.getParamList().map(function(e){var n=e.tensor;return Array.from(n.dataSync())}).reduce(function(e,n){return e.concat(n)}))},t.prototype.load=function(e){return fe(this,void 0,void 0,function(){return he(this,function(n){switch(n.label){case 0:return e instanceof Float32Array?(this.extractWeights(e),[2]):[4,this.loadFromUri(e)];case 1:return n.sent(),[2]}})})},t.prototype.loadFromUri=function(e){return fe(this,void 0,void 0,function(){var n;return he(this,function(r){switch(r.label){case 0:if(e&&typeof e!="string")throw new Error(this._name+".loadFromUri - expected model uri");return[4,q7(e,this.getDefaultModelName())];case 1:return n=r.sent(),this.loadFromWeightMap(n),[2]}})})},t.prototype.loadFromDisk=function(e){return fe(this,void 0,void 0,function(){var n,r,o,i,a,s,u,c,l,d;return he(this,function(f){switch(f.label){case 0:if(e&&typeof e!="string")throw new Error(this._name+".loadFromDisk - expected model file path");return n=Jt.getEnv().readFile,r=IT(e,this.getDefaultModelName()),o=r.manifestUri,i=r.modelBaseUri,a=function(h){return Promise.all(h.map(function(m){return n(m).then(function(p){return p.buffer})}))},s=vT.weightsLoaderFactory(a),l=(c=JSON).parse,[4,n(o)];case 1:return u=l.apply(c,[f.sent().toString()]),[4,s(u,i)];case 2:return d=f.sent(),this.loadFromWeightMap(d),[2]}})})},t.prototype.loadFromWeightMap=function(e){var n=this.extractParamsFromWeigthMap(e),r=n.paramMappings,o=n.params;this._paramMappings=r,this._params=o},t.prototype.extractWeights=function(e){var n=this.extractParams(e),r=n.paramMappings,o=n.params;this._paramMappings=r,this._params=o},t.prototype.traversePropertyPath=function(e){if(!this.params)throw new Error("traversePropertyPath - model has no loaded params");var n=e.split("/").reduce(function(i,a){if(!i.nextObj.hasOwnProperty(a))throw new Error("traversePropertyPath - object does not have property "+a+", for path "+e);return{obj:i.nextObj,objProp:a,nextObj:i.nextObj[a]}},{nextObj:this.params}),r=n.obj,o=n.objProp;if(!r||!o||!(r[o]instanceof tt))throw new Error("traversePropertyPath - parameter is not a tensor, for path "+e);return{obj:r,objProp:o}},t}();function Tn(t,e,n){return ie(function(){var r=s0(t,e.depthwise_filter,e.pointwise_filter,n,"same");return r=Re(r,e.bias),r})}function cm(t,e,n){return n===void 0&&(n=!1),ie(function(){var r=nt(n?Re(Yn(t,e.conv0.filters,[2,2],"same"),e.conv0.bias):Tn(t,e.conv0,[2,2])),o=Tn(r,e.conv1,[1,1]),i=nt(Re(r,o)),a=Tn(i,e.conv2,[1,1]);return nt(Re(r,Re(o,a)))})}function Yl(t,e,n,r){return n===void 0&&(n=!1),r===void 0&&(r=!0),ie(function(){var o=nt(n?Re(Yn(t,e.conv0.filters,r?[2,2]:[1,1],"same"),e.conv0.bias):Tn(t,e.conv0,r?[2,2]:[1,1])),i=Tn(o,e.conv1,[1,1]),a=nt(Re(o,i)),s=Tn(a,e.conv2,[1,1]),u=nt(Re(o,Re(i,s))),c=Tn(u,e.conv3,[1,1]);return nt(Re(o,Re(i,Re(s,c))))})}function vr(t,e,n,r){return n===void 0&&(n="same"),r===void 0&&(r=!1),ie(function(){var o=Re(Yn(t,e.filters,[1,1],n),e.bias);return r?nt(o):o})}function Po(t,e){Object.keys(t).forEach(function(n){e.some(function(r){return r.originalPath===n})||t[n].dispose()})}function Fh(t,e){return function(n,r,o,i){var a=ln(t(n*r*o*o),[o,o,n,r]),s=mt(t(r));return e.push({paramPath:i+"/filters"},{paramPath:i+"/bias"}),{filters:a,bias:s}}}function k0(t,e){return function(n,r,o){var i=wi(t(n*r),[n,r]),a=mt(t(r));return e.push({paramPath:o+"/weights"},{paramPath:o+"/bias"}),{weights:i,bias:a}}}var RT=function(){function t(e,n,r){this.depthwise_filter=e,this.pointwise_filter=n,this.bias=r}return t}();function I0(t,e){return function(n,r,o){var i=ln(t(9*n),[3,3,n,1]),a=ln(t(n*r),[1,1,n,r]),s=mt(t(r));return e.push({paramPath:o+"/depthwise_filter"},{paramPath:o+"/pointwise_filter"},{paramPath:o+"/bias"}),new RT(i,a,s)}}function R0(t){return function(e){var n=t(e+"/depthwise_filter",4),r=t(e+"/pointwise_filter",4),o=t(e+"/bias",1);return new RT(n,r,o)}}function Li(t,e){return function(n,r,o){var i=t[n];if(!Ph(i,r))throw new Error("expected weightMap["+n+"] to be a Tensor"+r+"D, instead have "+i);return e.push({originalPath:n,paramPath:o||n}),i}}function Do(t){var e=t;function n(o){var i=e.slice(0,o);return e=e.slice(o),i}function r(){return e}return{extractWeights:n,getRemainingWeights:r}}function TT(t,e){var n=Fh(t,e),r=I0(t,e);function o(a,s,u,c){c===void 0&&(c=!1);var l=c?n(a,s,3,u+"/conv0"):r(a,s,u+"/conv0"),d=r(s,s,u+"/conv1"),f=r(s,s,u+"/conv2");return{conv0:l,conv1:d,conv2:f}}function i(a,s,u,c){c===void 0&&(c=!1);var l=o(a,s,u,c),d=l.conv0,f=l.conv1,h=l.conv2,m=r(s,s,u+"/conv3");return{conv0:d,conv1:f,conv2:h,conv3:m}}return{extractDenseBlock3Params:o,extractDenseBlock4Params:i}}function X7(t){var e=[],n=Do(t),r=n.extractWeights,o=n.getRemainingWeights,i=TT(r,e).extractDenseBlock4Params,a=i(3,32,"dense0",!0),s=i(32,64,"dense1"),u=i(64,128,"dense2"),c=i(128,256,"dense3");if(o().length!==0)throw new Error("weights remaing after extract: "+o().length);return{paramMappings:e,params:{dense0:a,dense1:s,dense2:u,dense3:c}}}function NT(t){return function(e){var n=t(e+"/filters",4),r=t(e+"/bias",1);return{filters:n,bias:r}}}function AT(t,e){var n=Li(t,e),r=NT(n),o=R0(n);function i(s,u){u===void 0&&(u=!1);var c=u?r(s+"/conv0"):o(s+"/conv0"),l=o(s+"/conv1"),d=o(s+"/conv2");return{conv0:c,conv1:l,conv2:d}}function a(s,u){u===void 0&&(u=!1);var c=u?r(s+"/conv0"):o(s+"/conv0"),l=o(s+"/conv1"),d=o(s+"/conv2"),f=o(s+"/conv3");return{conv0:c,conv1:l,conv2:d,conv3:f}}return{extractDenseBlock3Params:i,extractDenseBlock4Params:a}}function Y7(t){var e=[],n=AT(t,e).extractDenseBlock4Params,r={dense0:n("dense0",!0),dense1:n("dense1"),dense2:n("dense2"),dense3:n("dense3")};return Po(t,e),{params:r,paramMappings:e}}var PT=function(t){Ee(e,t);function e(){return t.call(this,"FaceFeatureExtractor")||this}return e.prototype.forwardInput=function(n){var r=this.params;if(!r)throw new Error("FaceFeatureExtractor - load model before inference");return ie(function(){var o=n.toBatchTensor(112,!0),i=[122.782,117.001,104.298],a=sl(o,i).div(oe(255)),s=Yl(a,r.dense0,!0);return s=Yl(s,r.dense1),s=Yl(s,r.dense2),s=Yl(s,r.dense3),s=il(s,[7,7],[2,2],"valid"),s})},e.prototype.forward=function(n){return fe(this,void 0,void 0,function(){var r;return he(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,Pt(n)];case 1:return[2,r.apply(this,[o.sent()])]}})})},e.prototype.getDefaultModelName=function(){return"face_feature_extractor_model"},e.prototype.extractParamsFromWeigthMap=function(n){return Y7(n)},e.prototype.extractParams=function(n){return X7(n)},e}(Ao);function Lr(t,e){return ie(function(){return Re(Th(t,e.weights),e.bias)})}function Q7(t,e,n){var r=[],o=Do(t),i=o.extractWeights,a=o.getRemainingWeights,s=k0(i,r),u=s(e,n,"fc");if(a().length!==0)throw new Error("weights remaing after extract: "+a().length);return{paramMappings:r,params:{fc:u}}}function J7(t){var e=[],n=Li(t,e);function r(i){var a=n(i+"/weights",2),s=n(i+"/bias",1);return{weights:a,bias:s}}var o={fc:r("fc")};return Po(t,e),{params:o,paramMappings:e}}function DT(t){var e={},n={};return Object.keys(t).forEach(function(r){var o=r.startsWith("fc")?n:e;o[r]=t[r]}),{featureExtractorMap:e,classifierMap:n}}var MT=function(t){Ee(e,t);function e(n,r){var o=t.call(this,n)||this;return o._faceFeatureExtractor=r,o}return Object.defineProperty(e.prototype,"faceFeatureExtractor",{get:function(){return this._faceFeatureExtractor},enumerable:!0,configurable:!0}),e.prototype.runNet=function(n){var r=this,o=this.params;if(!o)throw new Error(this._name+" - load model before inference");return ie(function(){var i=n instanceof Pf?r.faceFeatureExtractor.forwardInput(n):n;return Lr(i.as2D(i.shape[0],-1),o.fc)})},e.prototype.dispose=function(n){n===void 0&&(n=!0),this.faceFeatureExtractor.dispose(n),t.prototype.dispose.call(this,n)},e.prototype.loadClassifierParams=function(n){var r=this.extractClassifierParams(n),o=r.params,i=r.paramMappings;this._params=o,this._paramMappings=i},e.prototype.extractClassifierParams=function(n){return Q7(n,this.getClassifierChannelsIn(),this.getClassifierChannelsOut())},e.prototype.extractParamsFromWeigthMap=function(n){var r=DT(n),o=r.featureExtractorMap,i=r.classifierMap;return this.faceFeatureExtractor.loadFromWeightMap(o),J7(i)},e.prototype.extractParams=function(n){var r=this.getClassifierChannelsIn(),o=this.getClassifierChannelsOut(),i=o*r+o,a=n.slice(0,n.length-i),s=n.slice(n.length-i);return this.faceFeatureExtractor.extractWeights(a),this.extractClassifierParams(s)},e}(Ao),Ub=["neutral","happy","sad","angry","fearful","disgusted","surprised"],Z7=function(){function t(e){var n=this;if(e.length!==7)throw new Error("FaceExpressions.constructor - expected probabilities.length to be 7, have: "+e.length);Ub.forEach(function(r,o){n[r]=e[o]})}return t.prototype.asSortedArray=function(){var e=this;return Ub.map(function(n){return{expression:n,probability:e[n]}}).sort(function(n,r){return r.probability-n.probability})},t}(),e9=function(t){Ee(e,t);function e(n){return n===void 0&&(n=new PT),t.call(this,"FaceExpressionNet",n)||this}return e.prototype.forwardInput=function(n){var r=this;return ie(function(){return To(r.runNet(n))})},e.prototype.forward=function(n){return fe(this,void 0,void 0,function(){var r;return he(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,Pt(n)];case 1:return[2,r.apply(this,[o.sent()])]}})})},e.prototype.predictExpressions=function(n){return fe(this,void 0,void 0,function(){var r,o,i,a,s=this;return he(this,function(u){switch(u.label){case 0:return[4,Pt(n)];case 1:return r=u.sent(),[4,this.forwardInput(r)];case 2:return o=u.sent(),[4,Promise.all(bt(o).map(function(c){return fe(s,void 0,void 0,function(){var l;return he(this,function(d){switch(d.label){case 0:return[4,c.data()];case 1:return l=d.sent(),c.dispose(),[2,l]}})})}))];case 3:return i=u.sent(),o.dispose(),a=i.map(function(c){return new Z7(c)}),[2,r.isBatchInput?a:a[0]]}})})},e.prototype.getDefaultModelName=function(){return"face_expression_model"},e.prototype.getClassifierChannelsIn=function(){return 256},e.prototype.getClassifierChannelsOut=function(){return 7},e}(MT);function OT(t,e){var n={expressions:e};return Object.assign({},t,n)}function t9(t){return U7(t)&&t.landmarks instanceof Af&&t.unshiftedLandmarks instanceof Af&&t.alignedRect instanceof Zr}function T0(t,e){var n=t.detection.box,r=e.shiftBy(n.x,n.y),o=r.align(),i=t.detection.imageDims,a=new Zr(t.detection.score,o.rescale(i.reverse()),i),s={landmarks:r,unshiftedLandmarks:e,alignedRect:a};return Object.assign({},t,s)}function n9(t,e){var n=Fh(t,e),r=I0(t,e);function o(a,s,u){var c=r(a,s,u+"/separable_conv0"),l=r(s,s,u+"/separable_conv1"),d=n(a,s,1,u+"/expansion_conv");return{separable_conv0:c,separable_conv1:l,expansion_conv:d}}function i(a,s){var u=r(a,a,s+"/separable_conv0"),c=r(a,a,s+"/separable_conv1"),l=r(a,a,s+"/separable_conv2");return{separable_conv0:u,separable_conv1:c,separable_conv2:l}}return{extractConvParams:n,extractSeparableConvParams:r,extractReductionBlockParams:o,extractMainBlockParams:i}}function r9(t,e){var n=[],r=Do(t),o=r.extractWeights,i=r.getRemainingWeights,a=n9(o,n),s=a.extractConvParams,u=a.extractSeparableConvParams,c=a.extractReductionBlockParams,l=a.extractMainBlockParams,d=s(3,32,3,"entry_flow/conv_in"),f=c(32,64,"entry_flow/reduction_block_0"),h=c(64,128,"entry_flow/reduction_block_1"),m={conv_in:d,reduction_block_0:f,reduction_block_1:h},p={};Rc(e,0,1).forEach(function(x){p["main_block_"+x]=l(128,"middle_flow/main_block_"+x)});var g=c(128,256,"exit_flow/reduction_block"),v=u(256,512,"exit_flow/separable_conv"),y={reduction_block:g,separable_conv:v};if(i().length!==0)throw new Error("weights remaing after extract: "+i().length);return{paramMappings:n,params:{entry_flow:m,middle_flow:p,exit_flow:y}}}function o9(t,e){var n=Li(t,e),r=NT(n),o=R0(n);function i(s){var u=o(s+"/separable_conv0"),c=o(s+"/separable_conv1"),l=r(s+"/expansion_conv");return{separable_conv0:u,separable_conv1:c,expansion_conv:l}}function a(s){var u=o(s+"/separable_conv0"),c=o(s+"/separable_conv1"),l=o(s+"/separable_conv2");return{separable_conv0:u,separable_conv1:c,separable_conv2:l}}return{extractConvParams:r,extractSeparableConvParams:o,extractReductionBlockParams:i,extractMainBlockParams:a}}function i9(t,e){var n=[],r=o9(t,n),o=r.extractConvParams,i=r.extractSeparableConvParams,a=r.extractReductionBlockParams,s=r.extractMainBlockParams,u=o("entry_flow/conv_in"),c=a("entry_flow/reduction_block_0"),l=a("entry_flow/reduction_block_1"),d={conv_in:u,reduction_block_0:c,reduction_block_1:l},f={};Rc(e,0,1).forEach(function(g){f["main_block_"+g]=s("middle_flow/main_block_"+g)});var h=a("exit_flow/reduction_block"),m=i("exit_flow/separable_conv"),p={reduction_block:h,separable_conv:m};return Po(t,n),{params:{entry_flow:d,middle_flow:f,exit_flow:p},paramMappings:n}}function FT(t,e,n){return Re(Yn(t,e.filters,n,"same"),e.bias)}function lm(t,e,n){n===void 0&&(n=!0);var r=n?nt(t):t;return r=Tn(r,e.separable_conv0,[1,1]),r=Tn(nt(r),e.separable_conv1,[1,1]),r=It(r,[3,3],[2,2],"same"),r=Re(r,FT(t,e.expansion_conv,[2,2])),r}function a9(t,e){var n=Tn(nt(t),e.separable_conv0,[1,1]);return n=Tn(nt(n),e.separable_conv1,[1,1]),n=Tn(nt(n),e.separable_conv2,[1,1]),n=Re(n,t),n}var s9=function(t){Ee(e,t);function e(n){var r=t.call(this,"TinyXception")||this;return r._numMainBlocks=n,r}return e.prototype.forwardInput=function(n){var r=this,o=this.params;if(!o)throw new Error("TinyXception - load model before inference");return ie(function(){var i=n.toBatchTensor(112,!0),a=[122.782,117.001,104.298],s=sl(i,a).div(oe(256)),u=nt(FT(s,o.entry_flow.conv_in,[2,2]));return u=lm(u,o.entry_flow.reduction_block_0,!1),u=lm(u,o.entry_flow.reduction_block_1),Rc(r._numMainBlocks,0,1).forEach(function(c){u=a9(u,o.middle_flow["main_block_"+c])}),u=lm(u,o.exit_flow.reduction_block),u=nt(Tn(u,o.exit_flow.separable_conv,[1,1])),u})},e.prototype.forward=function(n){return fe(this,void 0,void 0,function(){var r;return he(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,Pt(n)];case 1:return[2,r.apply(this,[o.sent()])]}})})},e.prototype.getDefaultModelName=function(){return"tiny_xception_model"},e.prototype.extractParamsFromWeigthMap=function(n){return i9(n,this._numMainBlocks)},e.prototype.extractParams=function(n){return r9(n,this._numMainBlocks)},e}(Ao);function u9(t){var e=[],n=Do(t),r=n.extractWeights,o=n.getRemainingWeights,i=k0(r,e),a=i(512,1,"fc/age"),s=i(512,2,"fc/gender");if(o().length!==0)throw new Error("weights remaing after extract: "+o().length);return{paramMappings:e,params:{fc:{age:a,gender:s}}}}function c9(t){var e=[],n=Li(t,e);function r(i){var a=n(i+"/weights",2),s=n(i+"/bias",1);return{weights:a,bias:s}}var o={fc:{age:r("fc/age"),gender:r("fc/gender")}};return Po(t,e),{params:o,paramMappings:e}}var Df;(function(t){t.FEMALE="female",t.MALE="male"})(Df||(Df={}));var l9=function(t){Ee(e,t);function e(n){n===void 0&&(n=new s9(2));var r=t.call(this,"AgeGenderNet")||this;return r._faceFeatureExtractor=n,r}return Object.defineProperty(e.prototype,"faceFeatureExtractor",{get:function(){return this._faceFeatureExtractor},enumerable:!0,configurable:!0}),e.prototype.runNet=function(n){var r=this,o=this.params;if(!o)throw new Error(this._name+" - load model before inference");return ie(function(){var i=n instanceof Pf?r.faceFeatureExtractor.forwardInput(n):n,a=il(i,[7,7],[2,2],"valid").as2D(i.shape[0],-1),s=Lr(a,o.fc.age).as1D(),u=Lr(a,o.fc.gender);return{age:s,gender:u}})},e.prototype.forwardInput=function(n){var r=this;return ie(function(){var o=r.runNet(n),i=o.age,a=o.gender;return{age:i,gender:To(a)}})},e.prototype.forward=function(n){return fe(this,void 0,void 0,function(){var r;return he(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,Pt(n)];case 1:return[2,r.apply(this,[o.sent()])]}})})},e.prototype.predictAgeAndGender=function(n){return fe(this,void 0,void 0,function(){var r,o,i,a,s,u,c=this;return he(this,function(l){switch(l.label){case 0:return[4,Pt(n)];case 1:return r=l.sent(),[4,this.forwardInput(r)];case 2:return o=l.sent(),i=bt(o.age),a=bt(o.gender),s=i.map(function(d,f){return{ageTensor:d,genderTensor:a[f]}}),[4,Promise.all(s.map(function(d){var f=d.ageTensor,h=d.genderTensor;return fe(c,void 0,void 0,function(){var m,p,g,v,y;return he(this,function(x){switch(x.label){case 0:return[4,f.data()];case 1:return m=x.sent()[0],[4,h.data()];case 2:return p=x.sent()[0],g=p>.5,v=g?Df.MALE:Df.FEMALE,y=g?p:1-p,f.dispose(),h.dispose(),[2,{age:m,gender:v,genderProbability:y}]}})})}))];case 3:return u=l.sent(),o.age.dispose(),o.gender.dispose(),[2,r.isBatchInput?u:u[0]]}})})},e.prototype.getDefaultModelName=function(){return"age_gender_model"},e.prototype.dispose=function(n){n===void 0&&(n=!0),this.faceFeatureExtractor.dispose(n),t.prototype.dispose.call(this,n)},e.prototype.loadClassifierParams=function(n){var r=this.extractClassifierParams(n),o=r.params,i=r.paramMappings;this._params=o,this._paramMappings=i},e.prototype.extractClassifierParams=function(n){return u9(n)},e.prototype.extractParamsFromWeigthMap=function(n){var r=DT(n),o=r.featureExtractorMap,i=r.classifierMap;return this.faceFeatureExtractor.loadFromWeightMap(o),c9(i)},e.prototype.extractParams=function(n){var r=1539,o=n.slice(0,n.length-r),i=n.slice(n.length-r);return this.faceFeatureExtractor.extractWeights(o),this.extractClassifierParams(i)},e}(Ao),LT=function(t){Ee(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.postProcess=function(n,r,o){var i=o.map(function(s){var u=s.width,c=s.height,l=r/Math.max(c,u);return{width:u*l,height:c*l}}),a=i.length;return ie(function(){var s=function(f,h){return Dn([Hr([68],f),Hr([68],h)],1).as2D(1,136).as1D()},u=function(f,h){var m=i[f],p=m.width,g=m.height;return h(p,g)?Math.abs(p-g)/2:0},c=function(f){return u(f,function(h,m){return h<m})},l=function(f){return u(f,function(h,m){return m<h})},d=n.mul(Hr([a,136],r)).sub(Dn(Array.from(Array(a),function(f,h){return s(c(h),l(h))}))).div(Dn(Array.from(Array(a),function(f,h){return s(i[h].width,i[h].height)})));return d})},e.prototype.forwardInput=function(n){var r=this;return ie(function(){var o=r.runNet(n);return r.postProcess(o,n.inputSize,n.inputDimensions.map(function(i){var a=i[0],s=i[1];return{height:a,width:s}}))})},e.prototype.forward=function(n){return fe(this,void 0,void 0,function(){var r;return he(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,Pt(n)];case 1:return[2,r.apply(this,[o.sent()])]}})})},e.prototype.detectLandmarks=function(n){return fe(this,void 0,void 0,function(){var r,o,i,a=this;return he(this,function(s){switch(s.label){case 0:return[4,Pt(n)];case 1:return r=s.sent(),o=ie(function(){return bt(a.forwardInput(r))}),[4,Promise.all(o.map(function(u,c){return fe(a,void 0,void 0,function(){var l,d,f,h,m;return he(this,function(p){switch(p.label){case 0:return f=(d=Array).from,[4,u.data()];case 1:return l=f.apply(d,[p.sent()]),h=l.filter(function(g,v){return Db(v)}),m=l.filter(function(g,v){return!Db(v)}),[2,new j7(Array(68).fill(0).map(function(g,v){return new Be(h[v],m[v])}),{height:r.getInputHeight(c),width:r.getInputWidth(c)})]}})})}))];case 2:return i=s.sent(),o.forEach(function(u){return u.dispose()}),[2,r.isBatchInput?i:i[0]]}})})},e.prototype.getClassifierChannelsOut=function(){return 136},e}(MT),BT=function(t){Ee(e,t);function e(n){return n===void 0&&(n=new PT),t.call(this,"FaceLandmark68Net",n)||this}return e.prototype.getDefaultModelName=function(){return"face_landmark_68_model"},e.prototype.getClassifierChannelsIn=function(){return 256},e}(LT);function d9(t){var e=[],n=AT(t,e).extractDenseBlock3Params,r={dense0:n("dense0",!0),dense1:n("dense1"),dense2:n("dense2")};return Po(t,e),{params:r,paramMappings:e}}function f9(t){var e=[],n=Do(t),r=n.extractWeights,o=n.getRemainingWeights,i=TT(r,e).extractDenseBlock3Params,a=i(3,32,"dense0",!0),s=i(32,64,"dense1"),u=i(64,128,"dense2");if(o().length!==0)throw new Error("weights remaing after extract: "+o().length);return{paramMappings:e,params:{dense0:a,dense1:s,dense2:u}}}var h9=function(t){Ee(e,t);function e(){return t.call(this,"TinyFaceFeatureExtractor")||this}return e.prototype.forwardInput=function(n){var r=this.params;if(!r)throw new Error("TinyFaceFeatureExtractor - load model before inference");return ie(function(){var o=n.toBatchTensor(112,!0),i=[122.782,117.001,104.298],a=sl(o,i).div(oe(255)),s=cm(a,r.dense0,!0);return s=cm(s,r.dense1),s=cm(s,r.dense2),s=il(s,[14,14],[2,2],"valid"),s})},e.prototype.forward=function(n){return fe(this,void 0,void 0,function(){var r;return he(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,Pt(n)];case 1:return[2,r.apply(this,[o.sent()])]}})})},e.prototype.getDefaultModelName=function(){return"face_feature_extractor_tiny_model"},e.prototype.extractParamsFromWeigthMap=function(n){return d9(n)},e.prototype.extractParams=function(n){return f9(n)},e}(Ao),p9=function(t){Ee(e,t);function e(n){return n===void 0&&(n=new h9),t.call(this,"FaceLandmark68TinyNet",n)||this}return e.prototype.getDefaultModelName=function(){return"face_landmark_68_tiny_model"},e.prototype.getClassifierChannelsIn=function(){return 128},e}(LT);(function(t){Ee(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e})(BT);function m9(t,e){return Re(Yt(t,e.weights),e.biases)}function N0(t,e,n,r,o){o===void 0&&(o="same");var i=e.conv,a=i.filters,s=i.bias,u=Yn(t,a,n,o);return u=Re(u,s),u=m9(u,e.scale),r?nt(u):u}function v9(t,e){return N0(t,e,[1,1],!0)}function jT(t,e){return N0(t,e,[1,1],!1)}function UT(t,e){return N0(t,e,[2,2],!0,"valid")}function g9(t,e){function n(s,u,c){var l=t(s),d=l.length/(u*c*c);if(T7(d))throw new Error("depth has to be an integer: "+d+", weights.length: "+l.length+", numFilters: "+u+", filterSize: "+c);return ie(function(){return Ii(ln(l,[u,d,c,c]),[2,3,1,0])})}function r(s,u,c,l){var d=n(s,u,c),f=mt(t(u));return e.push({paramPath:l+"/filters"},{paramPath:l+"/bias"}),{filters:d,bias:f}}function o(s,u){var c=mt(t(s)),l=mt(t(s));return e.push({paramPath:u+"/weights"},{paramPath:u+"/biases"}),{weights:c,biases:l}}function i(s,u,c,l){var d=r(s,u,c,l+"/conv"),f=o(u,l+"/scale");return{conv:d,scale:f}}function a(s,u,c,l,d){d===void 0&&(d=!1);var f=i((d?.5:1)*s,u,c,l+"/conv1"),h=i(s,u,c,l+"/conv2");return{conv1:f,conv2:h}}return{extractConvLayerParams:i,extractResidualLayerParams:a}}function y9(t){var e=Do(t),n=e.extractWeights,r=e.getRemainingWeights,o=[],i=g9(n,o),a=i.extractConvLayerParams,s=i.extractResidualLayerParams,u=a(4704,32,7,"conv32_down"),c=s(9216,32,3,"conv32_1"),l=s(9216,32,3,"conv32_2"),d=s(9216,32,3,"conv32_3"),f=s(36864,64,3,"conv64_down",!0),h=s(36864,64,3,"conv64_1"),m=s(36864,64,3,"conv64_2"),p=s(36864,64,3,"conv64_3"),g=s(147456,128,3,"conv128_down",!0),v=s(147456,128,3,"conv128_1"),y=s(147456,128,3,"conv128_2"),x=s(589824,256,3,"conv256_down",!0),w=s(589824,256,3,"conv256_1"),E=s(589824,256,3,"conv256_2"),_=s(589824,256,3,"conv256_down_out"),S=ie(function(){return Ii(wi(n(256*128),[128,256]),[1,0])});if(o.push({paramPath:"fc"}),r().length!==0)throw new Error("weights remaing after extract: "+r().length);var k={conv32_down:u,conv32_1:c,conv32_2:l,conv32_3:d,conv64_down:f,conv64_1:h,conv64_2:m,conv64_3:p,conv128_down:g,conv128_1:v,conv128_2:y,conv256_down:x,conv256_1:w,conv256_2:E,conv256_down_out:_,fc:S};return{params:k,paramMappings:o}}function x9(t,e){var n=Li(t,e);function r(a){var s=n(a+"/scale/weights",1),u=n(a+"/scale/biases",1);return{weights:s,biases:u}}function o(a){var s=n(a+"/conv/filters",4),u=n(a+"/conv/bias",1),c=r(a);return{conv:{filters:s,bias:u},scale:c}}function i(a){return{conv1:o(a+"/conv1"),conv2:o(a+"/conv2")}}return{extractConvLayerParams:o,extractResidualLayerParams:i}}function w9(t){var e=[],n=x9(t,e),r=n.extractConvLayerParams,o=n.extractResidualLayerParams,i=r("conv32_down"),a=o("conv32_1"),s=o("conv32_2"),u=o("conv32_3"),c=o("conv64_down"),l=o("conv64_1"),d=o("conv64_2"),f=o("conv64_3"),h=o("conv128_down"),m=o("conv128_1"),p=o("conv128_2"),g=o("conv256_down"),v=o("conv256_1"),y=o("conv256_2"),x=o("conv256_down_out"),w=t.fc;if(e.push({originalPath:"fc",paramPath:"fc"}),!R7(w))throw new Error("expected weightMap[fc] to be a Tensor2D, instead have "+w);var E={conv32_down:i,conv32_1:a,conv32_2:s,conv32_3:u,conv64_down:c,conv64_1:l,conv64_2:d,conv64_3:f,conv128_down:h,conv128_1:m,conv128_2:p,conv256_down:g,conv256_1:v,conv256_2:y,conv256_down_out:x,fc:w};return Po(t,e),{params:E,paramMappings:e}}function Sr(t,e){var n=v9(t,e.conv1);return n=jT(n,e.conv2),n=Re(n,t),n=nt(n),n}function Ql(t,e){var n=UT(t,e.conv1);n=jT(n,e.conv2);var r=il(t,2,2,"valid"),o=Xe(r.shape),i=r.shape[3]!==n.shape[3],a=r.shape[1]!==n.shape[1]||r.shape[2]!==n.shape[2];if(a){var s=Ku(n.shape);s[1]=1;var u=Xe(s);n=wt([n,u],1);var c=Ku(n.shape);c[2]=1;var l=Xe(c);n=wt([n,l],2)}return r=i?wt([r,o],3):r,n=Re(r,n),n=nt(n),n}var b9=function(t){Ee(e,t);function e(){return t.call(this,"FaceRecognitionNet")||this}return e.prototype.forwardInput=function(n){var r=this.params;if(!r)throw new Error("FaceRecognitionNet - load model before inference");return ie(function(){var o=n.toBatchTensor(150,!0).toFloat(),i=[122.782,117.001,104.298],a=sl(o,i).div(oe(256)),s=UT(a,r.conv32_down);s=It(s,3,2,"valid"),s=Sr(s,r.conv32_1),s=Sr(s,r.conv32_2),s=Sr(s,r.conv32_3),s=Ql(s,r.conv64_down),s=Sr(s,r.conv64_1),s=Sr(s,r.conv64_2),s=Sr(s,r.conv64_3),s=Ql(s,r.conv128_down),s=Sr(s,r.conv128_1),s=Sr(s,r.conv128_2),s=Ql(s,r.conv256_down),s=Sr(s,r.conv256_1),s=Sr(s,r.conv256_2),s=Ql(s,r.conv256_down_out);var u=s.mean([1,2]),c=Th(u,r.fc);return c})},e.prototype.forward=function(n){return fe(this,void 0,void 0,function(){var r;return he(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,Pt(n)];case 1:return[2,r.apply(this,[o.sent()])]}})})},e.prototype.computeFaceDescriptor=function(n){return fe(this,void 0,void 0,function(){var r,o,i,a=this;return he(this,function(s){switch(s.label){case 0:return[4,Pt(n)];case 1:return r=s.sent(),o=ie(function(){return bt(a.forwardInput(r))}),[4,Promise.all(o.map(function(u){return u.data()}))];case 2:return i=s.sent(),o.forEach(function(u){return u.dispose()}),[2,r.isBatchInput?i:i[0]]}})})},e.prototype.getDefaultModelName=function(){return"face_recognition_model"},e.prototype.extractParamsFromWeigthMap=function(n){return w9(n)},e.prototype.extractParams=function(n){return y9(n)},e}(Ao);function WT(t,e){var n={descriptor:e};return Object.assign({},t,n)}function $T(t,e){var n={age:e};return Object.assign({},t,n)}function zT(t,e,n){var r={gender:e,genderProbability:n};return Object.assign({},t,r)}var VT=function(){function t(e){var n=e===void 0?{}:e,r=n.minFaceSize,o=n.scaleFactor,i=n.maxNumScales,a=n.scoreThresholds,s=n.scaleSteps;if(this._name="MtcnnOptions",this._minFaceSize=r||20,this._scaleFactor=o||.709,this._maxNumScales=i||10,this._scoreThresholds=a||[.6,.7,.7],this._scaleSteps=s,typeof this._minFaceSize!="number"||this._minFaceSize<0)throw new Error(this._name+" - expected minFaceSize to be a number > 0");if(typeof this._scaleFactor!="number"||this._scaleFactor<=0||this._scaleFactor>=1)throw new Error(this._name+" - expected scaleFactor to be a number between 0 and 1");if(typeof this._maxNumScales!="number"||this._maxNumScales<0)throw new Error(this._name+" - expected maxNumScales to be a number > 0");if(!Array.isArray(this._scoreThresholds)||this._scoreThresholds.length!==3||this._scoreThresholds.some(function(u){return typeof u!="number"}))throw new Error(this._name+" - expected scoreThresholds to be an array of numbers of length 3");if(this._scaleSteps&&(!Array.isArray(this._scaleSteps)||this._scaleSteps.some(function(u){return typeof u!="number"})))throw new Error(this._name+" - expected scaleSteps to be an array of numbers")}return Object.defineProperty(t.prototype,"minFaceSize",{get:function(){return this._minFaceSize},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scaleFactor",{get:function(){return this._scaleFactor},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxNumScales",{get:function(){return this._maxNumScales},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scoreThresholds",{get:function(){return this._scoreThresholds},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scaleSteps",{get:function(){return this._scaleSteps},enumerable:!0,configurable:!0}),t}();function E9(t,e){function n(u,c){var l=ln(t(9*u),[3,3,u,1]),d=mt(t(u)),f=mt(t(u)),h=mt(t(u)),m=mt(t(u));return e.push({paramPath:c+"/filters"},{paramPath:c+"/batch_norm_scale"},{paramPath:c+"/batch_norm_offset"},{paramPath:c+"/batch_norm_mean"},{paramPath:c+"/batch_norm_variance"}),{filters:l,batch_norm_scale:d,batch_norm_offset:f,batch_norm_mean:h,batch_norm_variance:m}}function r(u,c,l,d,f){var h=ln(t(u*c*l*l),[l,l,u,c]),m=mt(t(c));return e.push({paramPath:d+"/filters"},{paramPath:d+"/"+(f?"batch_norm_offset":"bias")}),{filters:h,bias:m}}function o(u,c,l,d){var f=r(u,c,l,d,!0),h=f.filters,m=f.bias;return{filters:h,batch_norm_offset:m}}function i(u,c,l){var d=n(u,l+"/depthwise_conv"),f=o(u,c,1,l+"/pointwise_conv");return{depthwise_conv:d,pointwise_conv:f}}function a(){var u=o(3,32,3,"mobilenetv1/conv_0"),c=i(32,64,"mobilenetv1/conv_1"),l=i(64,128,"mobilenetv1/conv_2"),d=i(128,128,"mobilenetv1/conv_3"),f=i(128,256,"mobilenetv1/conv_4"),h=i(256,256,"mobilenetv1/conv_5"),m=i(256,512,"mobilenetv1/conv_6"),p=i(512,512,"mobilenetv1/conv_7"),g=i(512,512,"mobilenetv1/conv_8"),v=i(512,512,"mobilenetv1/conv_9"),y=i(512,512,"mobilenetv1/conv_10"),x=i(512,512,"mobilenetv1/conv_11"),w=i(512,1024,"mobilenetv1/conv_12"),E=i(1024,1024,"mobilenetv1/conv_13");return{conv_0:u,conv_1:c,conv_2:l,conv_3:d,conv_4:f,conv_5:h,conv_6:m,conv_7:p,conv_8:g,conv_9:v,conv_10:y,conv_11:x,conv_12:w,conv_13:E}}function s(){var u=o(1024,256,1,"prediction_layer/conv_0"),c=o(256,512,3,"prediction_layer/conv_1"),l=o(512,128,1,"prediction_layer/conv_2"),d=o(128,256,3,"prediction_layer/conv_3"),f=o(256,128,1,"prediction_layer/conv_4"),h=o(128,256,3,"prediction_layer/conv_5"),m=o(256,64,1,"prediction_layer/conv_6"),p=o(64,128,3,"prediction_layer/conv_7"),g=r(512,12,1,"prediction_layer/box_predictor_0/box_encoding_predictor"),v=r(512,9,1,"prediction_layer/box_predictor_0/class_predictor"),y=r(1024,24,1,"prediction_layer/box_predictor_1/box_encoding_predictor"),x=r(1024,18,1,"prediction_layer/box_predictor_1/class_predictor"),w=r(512,24,1,"prediction_layer/box_predictor_2/box_encoding_predictor"),E=r(512,18,1,"prediction_layer/box_predictor_2/class_predictor"),_=r(256,24,1,"prediction_layer/box_predictor_3/box_encoding_predictor"),S=r(256,18,1,"prediction_layer/box_predictor_3/class_predictor"),k=r(256,24,1,"prediction_layer/box_predictor_4/box_encoding_predictor"),I=r(256,18,1,"prediction_layer/box_predictor_4/class_predictor"),R=r(128,24,1,"prediction_layer/box_predictor_5/box_encoding_predictor"),D=r(128,18,1,"prediction_layer/box_predictor_5/class_predictor"),A={box_encoding_predictor:g,class_predictor:v},j={box_encoding_predictor:y,class_predictor:x},F={box_encoding_predictor:w,class_predictor:E},W={box_encoding_predictor:_,class_predictor:S},U={box_encoding_predictor:k,class_predictor:I},$={box_encoding_predictor:R,class_predictor:D};return{conv_0:u,conv_1:c,conv_2:l,conv_3:d,conv_4:f,conv_5:h,conv_6:m,conv_7:p,box_predictor_0:A,box_predictor_1:j,box_predictor_2:F,box_predictor_3:W,box_predictor_4:U,box_predictor_5:$}}return{extractMobilenetV1Params:a,extractPredictionLayerParams:s}}function C9(t){var e=[],n=Do(t),r=n.extractWeights,o=n.getRemainingWeights,i=E9(r,e),a=i.extractMobilenetV1Params,s=i.extractPredictionLayerParams,u=a(),c=s(),l=Gy(r(5118*4),[1,5118,4]),d={extra_dim:l};if(e.push({paramPath:"output_layer/extra_dim"}),o().length!==0)throw new Error("weights remaing after extract: "+o().length);return{params:{mobilenetv1:u,prediction_layer:c,output_layer:d},paramMappings:e}}function _9(t,e){var n=Li(t,e);function r(c,l,d){var f=n(c+"/Conv2d_"+l+"_pointwise/weights",4,d+"/filters"),h=n(c+"/Conv2d_"+l+"_pointwise/convolution_bn_offset",1,d+"/batch_norm_offset");return{filters:f,batch_norm_offset:h}}function o(c){var l="mobilenetv1/conv_"+c,d="MobilenetV1/Conv2d_"+c+"_depthwise",f=l+"/depthwise_conv",h=l+"/pointwise_conv",m=n(d+"/depthwise_weights",4,f+"/filters"),p=n(d+"/BatchNorm/gamma",1,f+"/batch_norm_scale"),g=n(d+"/BatchNorm/beta",1,f+"/batch_norm_offset"),v=n(d+"/BatchNorm/moving_mean",1,f+"/batch_norm_mean"),y=n(d+"/BatchNorm/moving_variance",1,f+"/batch_norm_variance");return{depthwise_conv:{filters:m,batch_norm_scale:p,batch_norm_offset:g,batch_norm_mean:v,batch_norm_variance:y},pointwise_conv:r("MobilenetV1",c,h)}}function i(){return{conv_0:r("MobilenetV1",0,"mobilenetv1/conv_0"),conv_1:o(1),conv_2:o(2),conv_3:o(3),conv_4:o(4),conv_5:o(5),conv_6:o(6),conv_7:o(7),conv_8:o(8),conv_9:o(9),conv_10:o(10),conv_11:o(11),conv_12:o(12),conv_13:o(13)}}function a(c,l){var d=n(c+"/weights",4,l+"/filters"),f=n(c+"/biases",1,l+"/bias");return{filters:d,bias:f}}function s(c){var l=a("Prediction/BoxPredictor_"+c+"/BoxEncodingPredictor","prediction_layer/box_predictor_"+c+"/box_encoding_predictor"),d=a("Prediction/BoxPredictor_"+c+"/ClassPredictor","prediction_layer/box_predictor_"+c+"/class_predictor");return{box_encoding_predictor:l,class_predictor:d}}function u(){return{conv_0:r("Prediction",0,"prediction_layer/conv_0"),conv_1:r("Prediction",1,"prediction_layer/conv_1"),conv_2:r("Prediction",2,"prediction_layer/conv_2"),conv_3:r("Prediction",3,"prediction_layer/conv_3"),conv_4:r("Prediction",4,"prediction_layer/conv_4"),conv_5:r("Prediction",5,"prediction_layer/conv_5"),conv_6:r("Prediction",6,"prediction_layer/conv_6"),conv_7:r("Prediction",7,"prediction_layer/conv_7"),box_predictor_0:s(0),box_predictor_1:s(1),box_predictor_2:s(2),box_predictor_3:s(3),box_predictor_4:s(4),box_predictor_5:s(5)}}return{extractMobilenetV1Params:i,extractPredictionLayerParams:u}}function S9(t){var e=[],n=_9(t,e),r=n.extractMobilenetV1Params,o=n.extractPredictionLayerParams,i=t["Output/extra_dim"];if(e.push({originalPath:"Output/extra_dim",paramPath:"output_layer/extra_dim"}),!Dh(i))throw new Error("expected weightMap['Output/extra_dim'] to be a Tensor3D, instead have "+i);var a={mobilenetv1:r(),prediction_layer:o(),output_layer:{extra_dim:i}};return Po(t,e),{params:a,paramMappings:e}}function Ir(t,e,n){return ie(function(){var r=Yn(t,e.filters,n,"same");return r=Re(r,e.batch_norm_offset),r0(r,0,6)})}var k9=.0010000000474974513;function I9(t,e,n){return ie(function(){var r=Rh(t,e.filters,n,"same");return r=BR(r,e.batch_norm_mean,e.batch_norm_variance,e.batch_norm_offset,e.batch_norm_scale,k9),r0(r,0,6)})}function R9(t){return[2,4,6,12].some(function(e){return e===t})?[2,2]:[1,1]}function T9(t,e){return ie(function(){var n=null,r=Ir(t,e.conv_0,[2,2]),o=[e.conv_1,e.conv_2,e.conv_3,e.conv_4,e.conv_5,e.conv_6,e.conv_7,e.conv_8,e.conv_9,e.conv_10,e.conv_11,e.conv_12,e.conv_13];if(o.forEach(function(i,a){var s=a+1,u=R9(s);r=I9(r,i.depthwise_conv,u),r=Ir(r,i.pointwise_conv,[1,1]),s===11&&(n=r)}),n===null)throw new Error("mobileNetV1 - output of conv layer 11 is null");return{out:r,conv11:n}})}function N9(t,e,n,r,o){var i=t.shape[0],a=Math.min(n,i),s=e.map(function(l,d){return{score:l,boxIndex:d}}).filter(function(l){return l.score>o}).sort(function(l,d){return d.score-l.score}),u=function(l){return l<=r?1:0},c=[];return s.forEach(function(l){if(!(c.length>=a)){for(var d=l.score,f=c.length-1;f>=0;--f){var h=A9(t,l.boxIndex,c[f]);if(h!==0&&(l.score*=u(h),l.score<=o))break}d===l.score&&c.push(l.boxIndex)}}),c}function A9(t,e,n){var r=t.arraySync(),o=Math.min(r[e][0],r[e][2]),i=Math.min(r[e][1],r[e][3]),a=Math.max(r[e][0],r[e][2]),s=Math.max(r[e][1],r[e][3]),u=Math.min(r[n][0],r[n][2]),c=Math.min(r[n][1],r[n][3]),l=Math.max(r[n][0],r[n][2]),d=Math.max(r[n][1],r[n][3]),f=(a-o)*(s-i),h=(l-u)*(d-c);if(f<=0||h<=0)return 0;var m=Math.max(o,u),p=Math.max(i,c),g=Math.min(a,l),v=Math.min(s,d),y=Math.max(g-m,0)*Math.max(v-p,0);return y/(f+h-y)}function P9(t){var e=bt(Ii(t,[1,0])),n=[Ct(e[2],e[0]),Ct(e[3],e[1])],r=[Re(e[0],lr(n[0],oe(2))),Re(e[1],lr(n[1],oe(2)))];return{sizes:n,centers:r}}function D9(t,e){var n=P9(t),r=n.sizes,o=n.centers,i=bt(Ii(e,[1,0])),a=lr(Yt(Xv(lr(i[2],oe(5))),r[0]),oe(2)),s=Re(Yt(lr(i[0],oe(10)),r[0]),o[0]),u=lr(Yt(Xv(lr(i[3],oe(5))),r[1]),oe(2)),c=Re(Yt(lr(i[1],oe(10)),r[1]),o[1]);return Ii(Dn([Ct(s,a),Ct(c,u),Re(s,a),Re(c,u)]),[1,0])}function M9(t,e,n){return ie(function(){var r=t.shape[0],o=D9(hr(xs(n.extra_dim,[r,1,1]),[-1,4]),hr(t,[-1,4]));o=hr(o,[r,o.shape[0]/r,4]);var i=MR(Kr(e,[0,0,1],[-1,-1,-1])),a=Kr(i,[0,0,0],[-1,-1,1]);a=hr(a,[r,a.shape[1]]);var s=bt(o),u=bt(a);return{boxes:s,scores:u}})}function Wa(t,e){return ie(function(){var n=t.shape[0],r=hr(vr(t,e.box_encoding_predictor),[n,-1,1,4]),o=hr(vr(t,e.class_predictor),[n,-1,3]);return{boxPredictionEncoding:r,classPrediction:o}})}function O9(t,e,n){return ie(function(){var r=Ir(t,n.conv_0,[1,1]),o=Ir(r,n.conv_1,[2,2]),i=Ir(o,n.conv_2,[1,1]),a=Ir(i,n.conv_3,[2,2]),s=Ir(a,n.conv_4,[1,1]),u=Ir(s,n.conv_5,[2,2]),c=Ir(u,n.conv_6,[1,1]),l=Ir(c,n.conv_7,[2,2]),d=Wa(e,n.box_predictor_0),f=Wa(t,n.box_predictor_1),h=Wa(o,n.box_predictor_2),m=Wa(a,n.box_predictor_3),p=Wa(u,n.box_predictor_4),g=Wa(l,n.box_predictor_5),v=wt([d.boxPredictionEncoding,f.boxPredictionEncoding,h.boxPredictionEncoding,m.boxPredictionEncoding,p.boxPredictionEncoding,g.boxPredictionEncoding],1),y=wt([d.classPrediction,f.classPrediction,h.classPrediction,m.classPrediction,p.classPrediction,g.classPrediction],1);return{boxPredictions:v,classPredictions:y}})}var Lh=function(){function t(e){var n=e===void 0?{}:e,r=n.minConfidence,o=n.maxResults;if(this._name="SsdMobilenetv1Options",this._minConfidence=r||.5,this._maxResults=o||100,typeof this._minConfidence!="number"||this._minConfidence<=0||this._minConfidence>=1)throw new Error(this._name+" - expected minConfidence to be a number between 0 and 1");if(typeof this._maxResults!="number")throw new Error(this._name+" - expected maxResults to be a number")}return Object.defineProperty(t.prototype,"minConfidence",{get:function(){return this._minConfidence},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxResults",{get:function(){return this._maxResults},enumerable:!0,configurable:!0}),t}(),HT=function(t){Ee(e,t);function e(){return t.call(this,"SsdMobilenetv1")||this}return e.prototype.forwardInput=function(n){var r=this.params;if(!r)throw new Error("SsdMobilenetv1 - load model before inference");return ie(function(){var o=n.toBatchTensor(512,!1).toFloat(),i=Ct(Yt(o,oe(.007843137718737125)),oe(1)),a=T9(i,r.mobilenetv1),s=O9(a.out,a.conv11,r.prediction_layer),u=s.boxPredictions,c=s.classPredictions;return M9(u,c,r.output_layer)})},e.prototype.forward=function(n){return fe(this,void 0,void 0,function(){var r;return he(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,Pt(n)];case 1:return[2,r.apply(this,[o.sent()])]}})})},e.prototype.locateFaces=function(n,r){return r===void 0&&(r={}),fe(this,void 0,void 0,function(){var o,i,a,s,u,c,l,d,f,h,m,p,g,v,y,x,w,E,_,S,k;return he(this,function(I){switch(I.label){case 0:return o=new Lh(r),i=o.maxResults,a=o.minConfidence,[4,Pt(n)];case 1:for(s=I.sent(),u=this.forwardInput(s),c=u.boxes,l=u.scores,d=c[0],f=l[0],h=1;h<c.length;h++)c[h].dispose(),l[h].dispose();return g=(p=Array).from,[4,f.data()];case 2:return m=g.apply(p,[I.sent()]),v=.5,y=N9(d,m,i,v,a),x=s.getReshapedInputDimensions(0),w=s.inputSize,E=w/x.width,_=w/x.height,S=d.arraySync(),k=y.map(function(R){var D=[Math.max(0,S[R][0]),Math.min(1,S[R][2])].map(function($){return $*_}),A=D[0],j=D[1],F=[Math.max(0,S[R][1]),Math.min(1,S[R][3])].map(function($){return $*E}),W=F[0],U=F[1];return new Zr(m[R],new w0(W,A,U-W,j-A),{height:s.getInputHeight(0),width:s.getInputWidth(0)})}),d.dispose(),f.dispose(),[2,k]}})})},e.prototype.getDefaultModelName=function(){return"ssd_mobilenetv1_model"},e.prototype.extractParamsFromWeigthMap=function(n){return S9(n)},e.prototype.extractParams=function(n){return C9(n)},e}(Ao);(function(t){Ee(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e})(HT);var F9=.4,L9=[new Be(.738768,.874946),new Be(2.42204,2.65704),new Be(4.30971,7.04493),new Be(10.246,4.59428),new Be(12.6868,11.8741)],B9=[new Be(1.603231,2.094468),new Be(6.041143,7.080126),new Be(2.882459,3.518061),new Be(4.266906,5.178857),new Be(9.041765,10.66308)],j9=[117.001,114.697,97.404],U9="tiny_yolov2_model",W9="tiny_yolov2_separable_conv_model",Jl=function(t){return typeof t=="number"};function $9(t){if(!t)throw new Error("invalid config: "+t);if(typeof t.withSeparableConvs!="boolean")throw new Error("config.withSeparableConvs has to be a boolean, have: "+t.withSeparableConvs);if(!Jl(t.iouThreshold)||t.iouThreshold<0||t.iouThreshold>1)throw new Error("config.iouThreshold has to be a number between [0, 1], have: "+t.iouThreshold);if(!Array.isArray(t.classes)||!t.classes.length||!t.classes.every(function(e){return typeof e=="string"}))throw new Error("config.classes has to be an array class names: string[], have: "+JSON.stringify(t.classes));if(!Array.isArray(t.anchors)||!t.anchors.length||!t.anchors.map(function(e){return e||{}}).every(function(e){return Jl(e.x)&&Jl(e.y)}))throw new Error("config.anchors has to be an array of { x: number, y: number }, have: "+JSON.stringify(t.anchors));if(t.meanRgb&&(!Array.isArray(t.meanRgb)||t.meanRgb.length!==3||!t.meanRgb.every(Jl)))throw new Error("config.meanRgb has to be an array of shape [number, number, number], have: "+JSON.stringify(t.meanRgb))}function A0(t){return ie(function(){var e=Yt(t,oe(.10000000149011612));return Re(nt(Ct(t,e)),e)})}function Wo(t,e){return ie(function(){var n=Ia(t,[[0,0],[1,1],[1,1],[0,0]]);return n=Yn(n,e.conv.filters,[1,1],"valid"),n=Ct(n,e.bn.sub),n=Yt(n,e.bn.truediv),n=Re(n,e.conv.bias),A0(n)})}function $o(t,e){return ie(function(){var n=Ia(t,[[0,0],[1,1],[1,1],[0,0]]);return n=s0(n,e.depthwise_filter,e.pointwise_filter,[1,1],"valid"),n=Re(n,e.bias),A0(n)})}function z9(t,e){var n=Fh(t,e);function r(a,s){var u=mt(t(a)),c=mt(t(a));return e.push({paramPath:s+"/sub"},{paramPath:s+"/truediv"}),{sub:u,truediv:c}}function o(a,s,u){var c=n(a,s,3,u+"/conv"),l=r(s,u+"/bn");return{conv:c,bn:l}}var i=I0(t,e);return{extractConvParams:n,extractConvWithBatchNormParams:o,extractSeparableConvParams:i}}function V9(t,e,n,r){var o=Do(t),i=o.extractWeights,a=o.getRemainingWeights,s=[],u=z9(i,s),c=u.extractConvParams,l=u.extractConvWithBatchNormParams,d=u.extractSeparableConvParams,f;if(e.withSeparableConvs){var h=r[0],m=r[1],p=r[2],g=r[3],v=r[4],y=r[5],x=r[6],w=r[7],E=r[8],_=e.isFirstLayerConv2d?c(h,m,3,"conv0"):d(h,m,"conv0"),S=d(m,p,"conv1"),k=d(p,g,"conv2"),I=d(g,v,"conv3"),R=d(v,y,"conv4"),D=d(y,x,"conv5"),A=w?d(x,w,"conv6"):void 0,j=E?d(w,E,"conv7"):void 0,F=c(E||w||x,5*n,1,"conv8");f={conv0:_,conv1:S,conv2:k,conv3:I,conv4:R,conv5:D,conv6:A,conv7:j,conv8:F}}else{var h=r[0],m=r[1],p=r[2],g=r[3],v=r[4],y=r[5],x=r[6],w=r[7],E=r[8],_=l(h,m,"conv0"),S=l(m,p,"conv1"),k=l(p,g,"conv2"),I=l(g,v,"conv3"),R=l(v,y,"conv4"),D=l(y,x,"conv5"),A=l(x,w,"conv6"),j=l(w,E,"conv7"),F=c(E,5*n,1,"conv8");f={conv0:_,conv1:S,conv2:k,conv3:I,conv4:R,conv5:D,conv6:A,conv7:j,conv8:F}}if(a().length!==0)throw new Error("weights remaing after extract: "+a().length);return{params:f,paramMappings:s}}function H9(t,e){var n=Li(t,e);function r(s){var u=n(s+"/sub",1),c=n(s+"/truediv",1);return{sub:u,truediv:c}}function o(s){var u=n(s+"/filters",4),c=n(s+"/bias",1);return{filters:u,bias:c}}function i(s){var u=o(s+"/conv"),c=r(s+"/bn");return{conv:u,bn:c}}var a=R0(n);return{extractConvParams:o,extractConvWithBatchNormParams:i,extractSeparableConvParams:a}}function G9(t,e){var n=[],r=H9(t,n),o=r.extractConvParams,i=r.extractConvWithBatchNormParams,a=r.extractSeparableConvParams,s;if(e.withSeparableConvs){var u=e.filterSizes&&e.filterSizes.length||9;s={conv0:e.isFirstLayerConv2d?o("conv0"):a("conv0"),conv1:a("conv1"),conv2:a("conv2"),conv3:a("conv3"),conv4:a("conv4"),conv5:a("conv5"),conv6:u>7?a("conv6"):void 0,conv7:u>8?a("conv7"):void 0,conv8:o("conv8")}}else s={conv0:i("conv0"),conv1:i("conv1"),conv2:i("conv2"),conv3:i("conv3"),conv4:i("conv4"),conv5:i("conv5"),conv6:i("conv6"),conv7:i("conv7"),conv8:o("conv8")};return Po(t,n),{params:s,paramMappings:n}}var Wb;(function(t){t[t.XS=224]="XS",t[t.SM=320]="SM",t[t.MD=416]="MD",t[t.LG=608]="LG"})(Wb||(Wb={}));var P0=function(){function t(e){var n=e===void 0?{}:e,r=n.inputSize,o=n.scoreThreshold;if(this._name="TinyYolov2Options",this._inputSize=r||416,this._scoreThreshold=o||.5,typeof this._inputSize!="number"||this._inputSize%32!==0)throw new Error(this._name+" - expected inputSize to be a number divisible by 32");if(typeof this._scoreThreshold!="number"||this._scoreThreshold<=0||this._scoreThreshold>=1)throw new Error(this._name+" - expected scoreThreshold to be a number between 0 and 1")}return Object.defineProperty(t.prototype,"inputSize",{get:function(){return this._inputSize},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scoreThreshold",{get:function(){return this._scoreThreshold},enumerable:!0,configurable:!0}),t}(),GT=function(t){Ee(e,t);function e(n){var r=t.call(this,"TinyYolov2")||this;return $9(n),r._config=n,r}return Object.defineProperty(e.prototype,"config",{get:function(){return this._config},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"withClassScores",{get:function(){return this.config.withClassScores||this.config.classes.length>1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"boxEncodingSize",{get:function(){return 5+(this.withClassScores?this.config.classes.length:0)},enumerable:!0,configurable:!0}),e.prototype.runTinyYolov2=function(n,r){var o=Wo(n,r.conv0);return o=It(o,[2,2],[2,2],"same"),o=Wo(o,r.conv1),o=It(o,[2,2],[2,2],"same"),o=Wo(o,r.conv2),o=It(o,[2,2],[2,2],"same"),o=Wo(o,r.conv3),o=It(o,[2,2],[2,2],"same"),o=Wo(o,r.conv4),o=It(o,[2,2],[2,2],"same"),o=Wo(o,r.conv5),o=It(o,[2,2],[1,1],"same"),o=Wo(o,r.conv6),o=Wo(o,r.conv7),vr(o,r.conv8,"valid",!1)},e.prototype.runMobilenet=function(n,r){var o=this.config.isFirstLayerConv2d?A0(vr(n,r.conv0,"valid",!1)):$o(n,r.conv0);return o=It(o,[2,2],[2,2],"same"),o=$o(o,r.conv1),o=It(o,[2,2],[2,2],"same"),o=$o(o,r.conv2),o=It(o,[2,2],[2,2],"same"),o=$o(o,r.conv3),o=It(o,[2,2],[2,2],"same"),o=$o(o,r.conv4),o=It(o,[2,2],[2,2],"same"),o=$o(o,r.conv5),o=It(o,[2,2],[1,1],"same"),o=r.conv6?$o(o,r.conv6):o,o=r.conv7?$o(o,r.conv7):o,vr(o,r.conv8,"valid",!1)},e.prototype.forwardInput=function(n,r){var o=this,i=this.params;if(!i)throw new Error("TinyYolov2 - load model before inference");return ie(function(){var a=n.toBatchTensor(r,!1).toFloat();return a=o.config.meanRgb?sl(a,o.config.meanRgb):a,a=a.div(oe(256)),o.config.withSeparableConvs?o.runMobilenet(a,i):o.runTinyYolov2(a,i)})},e.prototype.forward=function(n,r){return fe(this,void 0,void 0,function(){var o;return he(this,function(i){switch(i.label){case 0:return o=this.forwardInput,[4,Pt(n)];case 1:return[4,o.apply(this,[i.sent(),r])];case 2:return[2,i.sent()]}})})},e.prototype.detect=function(n,r){return r===void 0&&(r={}),fe(this,void 0,void 0,function(){var o,i,a,s,u,c,l,d,f,h,m,p,g,v,y=this;return he(this,function(x){switch(x.label){case 0:return o=new P0(r),i=o.inputSize,a=o.scoreThreshold,[4,Pt(n)];case 1:return s=x.sent(),[4,this.forwardInput(s,i)];case 2:return u=x.sent(),c=ie(function(){return bt(u)[0].expandDims()}),l={width:s.getInputWidth(0),height:s.getInputHeight(0)},[4,this.extractBoxes(c,s.getReshapedInputDimensions(0),a)];case 3:return d=x.sent(),u.dispose(),c.dispose(),f=d.map(function(w){return w.box}),h=d.map(function(w){return w.score}),m=d.map(function(w){return w.classScore}),p=d.map(function(w){return y.config.classes[w.label]}),g=Tc(f.map(function(w){return w.rescale(i)}),h,this.config.iouThreshold,!0),v=g.map(function(w){return new yT(h[w],m[w],p[w],f[w],l)}),[2,v]}})})},e.prototype.getDefaultModelName=function(){return""},e.prototype.extractParamsFromWeigthMap=function(n){return G9(n,this.config)},e.prototype.extractParams=function(n){var r=this.config.filterSizes||e.DEFAULT_FILTER_SIZES,o=r?r.length:void 0;if(o!==7&&o!==8&&o!==9)throw new Error("TinyYolov2 - expected 7 | 8 | 9 convolutional filters, but found "+o+" filterSizes in config");return V9(n,this.config,this.boxEncodingSize,r)},e.prototype.extractBoxes=function(n,r,o){return fe(this,void 0,void 0,function(){var i,a,s,u,c,l,d,f,h,m,p,g,v,y,x,w,E,_,S,k,I,R,D,A,j,F,W,U,$,M=this;return he(this,function(P){switch(P.label){case 0:return i=r.width,a=r.height,s=Math.max(i,a),u=s/i,c=s/a,l=n.shape[1],d=this.config.anchors.length,f=ie(function(){var B=n.reshape([l,l,d,M.boxEncodingSize]),G=B.slice([0,0,0,0],[l,l,d,4]),q=B.slice([0,0,0,4],[l,l,d,1]),J=M.withClassScores?To(B.slice([0,0,0,5],[l,l,d,M.config.classes.length]),3):oe(0);return[G,q,J]}),h=f[0],m=f[1],p=f[2],g=[],[4,m.array()];case 1:return v=P.sent(),[4,h.array()];case 2:y=P.sent(),x=0,P.label=3;case 3:if(!(x<l))return[3,12];w=0,P.label=4;case 4:if(!(w<l))return[3,11];E=0,P.label=5;case 5:return E<d?(_=um(v[x][w][E][0]),!o||_>o?(S=(w+um(y[x][w][E][0]))/l*u,k=(x+um(y[x][w][E][1]))/l*c,I=Math.exp(y[x][w][E][2])*this.config.anchors[E].x/l*u,R=Math.exp(y[x][w][E][3])*this.config.anchors[E].y/l*c,D=S-I/2,A=k-R/2,j={row:x,col:w,anchor:E},this.withClassScores?[4,this.extractPredictedClass(p,j)]:[3,7]):[3,9]):[3,10];case 6:return $=P.sent(),[3,8];case 7:$={classScore:1,label:0},P.label=8;case 8:F=$,W=F.classScore,U=F.label,g.push(Kt({box:new Mh(D,A,D+I,A+R),score:_,classScore:_*W,label:U},j)),P.label=9;case 9:return E++,[3,5];case 10:return w++,[3,4];case 11:return x++,[3,3];case 12:return h.dispose(),m.dispose(),p.dispose(),[2,g]}})})},e.prototype.extractPredictedClass=function(n,r){return fe(this,void 0,void 0,function(){var o,i,a,s;return he(this,function(u){switch(u.label){case 0:return o=r.row,i=r.col,a=r.anchor,[4,n.array()];case 1:return s=u.sent(),[2,Array(this.config.classes.length).fill(0).map(function(c,l){return s[o][i][a][l]}).map(function(c,l){return{classScore:c,label:l}}).reduce(function(c,l){return c.classScore>l.classScore?c:l})]}})})},e.DEFAULT_FILTER_SIZES=[3,16,32,64,128,256,512,1024,1024],e}(Ao),K9=function(t){Ee(e,t);function e(n){n===void 0&&(n=!0);var r=this,o=Object.assign({},{withSeparableConvs:n,iouThreshold:F9,classes:["face"]},n?{anchors:B9,meanRgb:j9}:{anchors:L9,withClassScores:!0});return r=t.call(this,o)||this,r}return Object.defineProperty(e.prototype,"withSeparableConvs",{get:function(){return this.config.withSeparableConvs},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"anchors",{get:function(){return this.config.anchors},enumerable:!0,configurable:!0}),e.prototype.locateFaces=function(n,r){return fe(this,void 0,void 0,function(){var o;return he(this,function(i){switch(i.label){case 0:return[4,this.detect(n,r)];case 1:return o=i.sent(),[2,o.map(function(a){return new Zr(a.score,a.relativeBox,{width:a.imageWidth,height:a.imageHeight})})]}})})},e.prototype.getDefaultModelName=function(){return this.withSeparableConvs?W9:U9},e.prototype.extractParamsFromWeigthMap=function(n){return t.prototype.extractParamsFromWeigthMap.call(this,n)},e}(GT),KT=function(t){Ee(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n._name="TinyFaceDetectorOptions",n}return e}(P0),ul=function(){function t(){}return t.prototype.then=function(e){return fe(this,void 0,void 0,function(){var n;return he(this,function(r){switch(r.label){case 0:return n=e,[4,this.run()];case 1:return[2,n.apply(void 0,[r.sent()])]}})})},t.prototype.run=function(){return fe(this,void 0,void 0,function(){return he(this,function(e){throw new Error("ComposableTask - run is not implemented")})})},t}();function Bh(t,e,n,r,o){return o===void 0&&(o=function(i){var a=i.alignedRect;return a}),fe(this,void 0,void 0,function(){var i,a,s,u,c;return he(this,function(l){switch(l.label){case 0:return i=t.map(function(d){return t9(d)?o(d):d.detection}),s=r,s?[3,5]:e instanceof tt?[4,S0(e,i)]:[3,2];case 1:return u=l.sent(),[3,4];case 2:return[4,_0(e,i)];case 3:u=l.sent(),l.label=4;case 4:s=u,l.label=5;case 5:return a=s,[4,n(a)];case 6:return c=l.sent(),a.forEach(function(d){return d instanceof tt&&d.dispose()}),[2,c]}})})}function D0(t,e,n,r,o){return fe(this,void 0,void 0,function(){var i=this;return he(this,function(a){return[2,Bh([t],e,function(s){return fe(i,void 0,void 0,function(){return he(this,function(u){return[2,n(s[0])]})})},r,o)]})})}function q9(t){return ie(function(){return Dn(bt(t,3).reverse(),3)})}var Zl=2,Mf=12;function X9(t,e){var n=Fh(t,e),r=k0(t,e);function o(c,l){var d=mt(t(c));return e.push({paramPath:l}),d}function i(c,l,d){d===void 0&&(d=!1);var f=n(c[0],c[1],3,l+"/conv1"),h=o(c[1],l+"/prelu1_alpha"),m=n(c[1],c[2],3,l+"/conv2"),p=o(c[2],l+"/prelu2_alpha"),g=n(c[2],c[3],d?2:3,l+"/conv3"),v=o(c[3],l+"/prelu3_alpha");return{conv1:f,prelu1_alpha:h,conv2:m,prelu2_alpha:p,conv3:g,prelu3_alpha:v}}function a(){var c=i([3,10,16,32],"pnet"),l=n(32,2,1,"pnet/conv4_1"),d=n(32,4,1,"pnet/conv4_2");return Kt(Kt({},c),{conv4_1:l,conv4_2:d})}function s(){var c=i([3,28,48,64],"rnet",!0),l=r(576,128,"rnet/fc1"),d=o(128,"rnet/prelu4_alpha"),f=r(128,2,"rnet/fc2_1"),h=r(128,4,"rnet/fc2_2");return Kt(Kt({},c),{fc1:l,prelu4_alpha:d,fc2_1:f,fc2_2:h})}function u(){var c=i([3,32,64,64],"onet"),l=n(64,128,2,"onet/conv4"),d=o(128,"onet/prelu4_alpha"),f=r(1152,256,"onet/fc1"),h=o(256,"onet/prelu5_alpha"),m=r(256,2,"onet/fc2_1"),p=r(256,4,"onet/fc2_2"),g=r(256,10,"onet/fc2_3");return Kt(Kt({},c),{conv4:l,prelu4_alpha:d,fc1:f,prelu5_alpha:h,fc2_1:m,fc2_2:p,fc2_3:g})}return{extractPNetParams:a,extractRNetParams:s,extractONetParams:u}}function Y9(t){var e=Do(t),n=e.extractWeights,r=e.getRemainingWeights,o=[],i=X9(n,o),a=i.extractPNetParams,s=i.extractRNetParams,u=i.extractONetParams,c=a(),l=s(),d=u();if(r().length!==0)throw new Error("weights remaing after extract: "+r().length);return{params:{pnet:c,rnet:l,onet:d},paramMappings:o}}function Q9(t,e){var n=Li(t,e);function r(l){var d=n(l+"/weights",4,l+"/filters"),f=n(l+"/bias",1);return{filters:d,bias:f}}function o(l){var d=n(l+"/weights",2),f=n(l+"/bias",1);return{weights:d,bias:f}}function i(l){return n(l,1)}function a(l){var d=r(l+"/conv1"),f=i(l+"/prelu1_alpha"),h=r(l+"/conv2"),m=i(l+"/prelu2_alpha"),p=r(l+"/conv3"),g=i(l+"/prelu3_alpha");return{conv1:d,prelu1_alpha:f,conv2:h,prelu2_alpha:m,conv3:p,prelu3_alpha:g}}function s(){var l=a("pnet"),d=r("pnet/conv4_1"),f=r("pnet/conv4_2");return Kt(Kt({},l),{conv4_1:d,conv4_2:f})}function u(){var l=a("rnet"),d=o("rnet/fc1"),f=i("rnet/prelu4_alpha"),h=o("rnet/fc2_1"),m=o("rnet/fc2_2");return Kt(Kt({},l),{fc1:d,prelu4_alpha:f,fc2_1:h,fc2_2:m})}function c(){var l=a("onet"),d=r("onet/conv4"),f=i("onet/prelu4_alpha"),h=o("onet/fc1"),m=i("onet/prelu5_alpha"),p=o("onet/fc2_1"),g=o("onet/fc2_2"),v=o("onet/fc2_3");return Kt(Kt({},l),{conv4:d,prelu4_alpha:f,fc1:h,prelu5_alpha:m,fc2_1:p,fc2_2:g,fc2_3:v})}return{extractPNetParams:s,extractRNetParams:u,extractONetParams:c}}function J9(t){var e=[],n=Q9(t,e),r=n.extractPNetParams,o=n.extractRNetParams,i=n.extractONetParams,a=r(),s=o(),u=i();return Po(t,e),{params:{pnet:a,rnet:s,onet:u},paramMappings:e}}function rg(t,e){var n=e[0],r=e[1];return{height:Math.floor(n*t),width:Math.floor(r*t)}}function Z9(t,e,n){for(var r=n[0],o=n[1],i=Mf/t,a=[],s=Math.min(r,o)*i,u=0;s>=12;)a.push(i*Math.pow(e,u)),s=s*e,u+=1;return a}var M0=function(t){Ee(e,t);function e(n,r,o,i){return t.call(this,{left:n,top:r,right:o,bottom:i},!0)||this}return e}(Ri);function qT(t){return ie(function(){return Yt(Ct(t,oe(127.5)),oe(.0078125))})}function Ss(t,e){return ie(function(){return Re(nt(t),Yt(e,If(nt(If(t)))))})}function O0(t,e,n){return n===void 0&&(n=!1),ie(function(){var r=vr(t,e.conv1,"valid");return r=Ss(r,e.prelu1_alpha),r=It(r,n?[2,2]:[3,3],[2,2],"same"),r=vr(r,e.conv2,"valid"),r=Ss(r,e.prelu2_alpha),r=n?r:It(r,[3,3],[2,2],"valid"),r=vr(r,e.conv3,"valid"),r=Ss(r,e.prelu3_alpha),r})}function eK(t,e){return ie(function(){var n=O0(t,e,!0),r=vr(n,e.conv4_1,"valid"),o=Wn(Nh(r,3),3),i=To(Ct(r,o),3),a=vr(n,e.conv4_2,"valid");return{prob:i,regions:a}})}function tK(t,e){return ie(function(){var n=rg(e,t.shape.slice(1)),r=n.height,o=n.width,i=f0.resizeBilinear(t,[r,o]),a=qT(i);return Ii(a,[0,2,1,3])})}function nK(t,e,n,r){for(var o=[],i=t.arraySync(),a=0;a<t.shape[0];a++)for(var s=0;s<t.shape[1];s++)i[a][s]>=r&&o.push(new Be(s,a));var u=o.map(function(c){var l=new Mh(Math.round((c.y*Zl+1)/n),Math.round((c.x*Zl+1)/n),Math.round((c.y*Zl+Mf)/n),Math.round((c.x*Zl+Mf)/n)),d=i[c.y][c.x],f=e.arraySync(),h=new M0(f[c.y][c.x][0],f[c.y][c.x][1],f[c.y][c.x][2],f[c.y][c.x][3]);return{cell:l,score:d,region:h}});return u}function rK(t,e,n,r,o){o.stage1=[];var i=e.map(function(f){return ie(function(){var h={scale:f},m=tK(t,f),p=Date.now(),g=eK(m,r),v=g.prob,y=g.regions;h.pnet=Date.now()-p;var x=bt(bt(v,3)[1])[0],w=bt(y)[0];return{scoresTensor:x,regionsTensor:w,scale:f,statsForScale:h}})}),a=i.map(function(f){var h=f.scoresTensor,m=f.regionsTensor,p=f.scale,g=f.statsForScale,v=nK(h,m,p,n);if(h.dispose(),m.dispose(),!v.length)return o.stage1.push(g),[];var y=Date.now(),x=Tc(v.map(function(w){return w.cell}),v.map(function(w){return w.score}),.5);return g.nms=Date.now()-y,g.numBoxes=x.length,o.stage1.push(g),x.map(function(w){return v[w]})}),s=a.reduce(function(f,h){return f.concat(h)},[]),u=[],c=[];if(s.length>0){var l=Date.now(),d=Tc(s.map(function(f){return f.cell}),s.map(function(f){return f.score}),.7);o.stage1_nms=Date.now()-l,c=d.map(function(f){return s[f].score}),u=d.map(function(f){return s[f]}).map(function(f){var h=f.cell,m=f.region;return new Mh(h.left+m.left*h.width,h.top+m.top*h.height,h.right+m.right*h.width,h.bottom+m.bottom*h.height).toSquare().round()})}return{boxes:u,scores:c}}function XT(t,e,n){var r=n.width,o=n.height;return fe(this,void 0,void 0,function(){var i,a,s,u=this;return he(this,function(c){switch(c.label){case 0:return i=ya(t),[4,Promise.all(e.map(function(l){return fe(u,void 0,void 0,function(){var d,f,h,m,p,g,v,y;return he(this,function(x){return d=l.padAtBorders(t.height,t.width),f=d.y,h=d.ey,m=d.x,p=d.ex,g=m-1,v=f-1,y=i.getImageData(g,v,p-g,h-v),[2,Jt.isNodejs()?C0(y):createImageBitmap(y)]})})}))];case 1:return a=c.sent(),s=[],a.forEach(function(l){var d=Oh({width:r,height:o}),f=ya(d);f.drawImage(l,0,0,r,o);for(var h=f.getImageData(0,0,r,o).data,m=[],p=0;p<h.length;p+=4)m.push(h[p+2]),m.push(h[p+1]),m.push(h[p]);s.push(m)}),[2,s.map(function(l){var d=ie(function(){var f=Ii(ln(l,[1,r,o,3]),[0,2,1,3]).toFloat();return qT(f)});return d})]}})})}function oK(t,e){return ie(function(){var n=O0(t,e),r=hr(n,[n.shape[0],e.fc1.weights.shape[0]]),o=Lr(r,e.fc1),i=Ss(o,e.prelu4_alpha),a=Lr(i,e.fc2_1),s=Wn(Nh(a,1),1),u=To(Ct(a,s),1),c=Lr(i,e.fc2_2),l=bt(u,1)[1];return{scores:l,regions:c}})}function iK(t,e,n,r,o){return fe(this,void 0,void 0,function(){var i,a,s,u,c,l,d,f,h,m,p,g,v,y;return he(this,function(x){switch(x.label){case 0:return i=Date.now(),[4,XT(t,e,{width:24,height:24})];case 1:return a=x.sent(),o.stage2_extractImagePatches=Date.now()-i,i=Date.now(),s=a.map(function(w){var E=oK(w,r);return w.dispose(),E}),o.stage2_rnet=Date.now()-i,u=s.length>1?wt(s.map(function(w){return w.scores})):s[0].scores,d=(l=Array).from,[4,u.data()];case 2:return c=d.apply(l,[x.sent()]),u.dispose(),f=c.map(function(w,E){return{score:w,idx:E}}).filter(function(w){return w.score>n}).map(function(w){var E=w.idx;return E}),h=f.map(function(w){return e[w]}),m=f.map(function(w){return c[w]}),p=[],g=[],h.length>0&&(i=Date.now(),v=Tc(h,m,.7),o.stage2_nms=Date.now()-i,y=v.map(function(w){var E=s[f[w]].regions.arraySync();return new M0(E[0][0],E[0][1],E[0][2],E[0][3])}),g=v.map(function(w){return m[w]}),p=v.map(function(w,E){return h[w].calibrate(y[E])})),s.forEach(function(w){w.regions.dispose(),w.scores.dispose()}),[2,{boxes:p,scores:g}]}})})}function aK(t,e){return ie(function(){var n=O0(t,e);n=It(n,[2,2],[2,2],"same"),n=vr(n,e.conv4,"valid"),n=Ss(n,e.prelu4_alpha);var r=hr(n,[n.shape[0],e.fc1.weights.shape[0]]),o=Lr(r,e.fc1),i=Ss(o,e.prelu5_alpha),a=Lr(i,e.fc2_1),s=Wn(Nh(a,1),1),u=To(Ct(a,s),1),c=Lr(i,e.fc2_2),l=Lr(i,e.fc2_3),d=bt(u,1)[1];return{scores:d,regions:c,points:l}})}function sK(t,e,n,r,o){return fe(this,void 0,void 0,function(){var i,a,s,u,c,l,d,f,h,m,p,g,v,y,x;return he(this,function(w){switch(w.label){case 0:return i=Date.now(),[4,XT(t,e,{width:48,height:48})];case 1:return a=w.sent(),o.stage3_extractImagePatches=Date.now()-i,i=Date.now(),s=a.map(function(E){var _=aK(E,r);return E.dispose(),_}),o.stage3_onet=Date.now()-i,u=s.length>1?wt(s.map(function(E){return E.scores})):s[0].scores,d=(l=Array).from,[4,u.data()];case 2:return c=d.apply(l,[w.sent()]),u.dispose(),f=c.map(function(E,_){return{score:E,idx:_}}).filter(function(E){return E.score>n}).map(function(E){var _=E.idx;return _}),h=f.map(function(E){var _=s[E].regions.arraySync();return new M0(_[0][0],_[0][1],_[0][2],_[0][3])}),m=f.map(function(E,_){return e[E].calibrate(h[_])}),p=f.map(function(E){return c[E]}),g=[],v=[],y=[],m.length>0&&(i=Date.now(),x=Tc(m,p,.7,!1),o.stage3_nms=Date.now()-i,g=x.map(function(E){return m[E]}),v=x.map(function(E){return p[E]}),y=x.map(function(E,_){return Array(5).fill(0).map(function(S,k){var I=s[E].points.arraySync();return new Be(I[0][k]*(g[_].width+1)+g[_].left,I[0][k+5]*(g[_].height+1)+g[_].top)})})),s.forEach(function(E){E.regions.dispose(),E.scores.dispose(),E.points.dispose()}),[2,{boxes:g,scores:v,points:y}]}})})}var uK=function(t){Ee(e,t);function e(){return t.call(this,"Mtcnn")||this}return e.prototype.load=function(n){return fe(this,void 0,void 0,function(){return he(this,function(r){return console.warn("mtcnn is deprecated and will be removed soon"),[2,t.prototype.load.call(this,n)]})})},e.prototype.loadFromDisk=function(n){return fe(this,void 0,void 0,function(){return he(this,function(r){return console.warn("mtcnn is deprecated and will be removed soon"),[2,t.prototype.loadFromDisk.call(this,n)]})})},e.prototype.forwardInput=function(n,r){return r===void 0&&(r={}),fe(this,void 0,void 0,function(){var o,i,a,s,u,c,l,d,f,h,m,p,g,v,y,x,w,E,_,S,k;return he(this,function(I){switch(I.label){case 0:if(o=this.params,!o)throw new Error("Mtcnn - load model before inference");if(i=n.canvases[0],!i)throw new Error("Mtcnn - inputCanvas is not defined, note that passing tensors into Mtcnn.forwardInput is not supported yet.");return a={},s=Date.now(),u=ie(function(){return q9(Wn(y0.fromPixels(i)).toFloat())}),c=function(R){return u.dispose(),a.total=Date.now()-s,R},l=u.shape.slice(1),d=l[0],f=l[1],h=new VT(r),m=h.minFaceSize,p=h.scaleFactor,g=h.maxNumScales,v=h.scoreThresholds,y=h.scaleSteps,x=(y||Z9(m,p,[d,f])).filter(function(R){var D=rg(R,[d,f]);return Math.min(D.width,D.height)>Mf}).slice(0,g),a.scales=x,a.pyramid=x.map(function(R){return rg(R,[d,f])}),w=Date.now(),[4,rK(u,x,v[0],o.pnet,a)];case 1:return E=I.sent(),a.total_stage1=Date.now()-w,E.boxes.length?(a.stage2_numInputBoxes=E.boxes.length,w=Date.now(),[4,iK(i,E.boxes,v[1],o.rnet,a)]):[2,c({results:[],stats:a})];case 2:return _=I.sent(),a.total_stage2=Date.now()-w,_.boxes.length?(a.stage3_numInputBoxes=_.boxes.length,w=Date.now(),[4,sK(i,_.boxes,v[2],o.onet,a)]):[2,c({results:[],stats:a})];case 3:return S=I.sent(),a.total_stage3=Date.now()-w,k=S.boxes.map(function(R,D){return T0(b0({},new Zr(S.scores[D],new w0(R.left/f,R.top/d,R.width/f,R.height/d),{height:d,width:f})),new B7(S.points[D].map(function(A){return A.sub(new Be(R.left,R.top)).div(new Be(R.width,R.height))}),{width:R.width,height:R.height}))}),[2,c({results:k,stats:a})]}})})},e.prototype.forward=function(n,r){return r===void 0&&(r={}),fe(this,void 0,void 0,function(){var o;return he(this,function(i){switch(i.label){case 0:return o=this.forwardInput,[4,Pt(n)];case 1:return[4,o.apply(this,[i.sent(),r])];case 2:return[2,i.sent().results]}})})},e.prototype.forwardWithStats=function(n,r){return r===void 0&&(r={}),fe(this,void 0,void 0,function(){var o;return he(this,function(i){switch(i.label){case 0:return o=this.forwardInput,[4,Pt(n)];case 1:return[2,o.apply(this,[i.sent(),r])]}})})},e.prototype.getDefaultModelName=function(){return"mtcnn_model"},e.prototype.extractParamsFromWeigthMap=function(n){return J9(n)},e.prototype.extractParams=function(n){return Y9(n)},e}(Ao),cK=.4,lK=[new Be(1.603231,2.094468),new Be(6.041143,7.080126),new Be(2.882459,3.518061),new Be(4.266906,5.178857),new Be(9.041765,10.66308)],dK=[117.001,114.697,97.404],fK=function(t){Ee(e,t);function e(){var n=this,r={withSeparableConvs:!0,iouThreshold:cK,classes:["face"],anchors:lK,meanRgb:dK,isFirstLayerConv2d:!0,filterSizes:[3,16,32,64,128,256,512]};return n=t.call(this,r)||this,n}return Object.defineProperty(e.prototype,"anchors",{get:function(){return this.config.anchors},enumerable:!0,configurable:!0}),e.prototype.locateFaces=function(n,r){return fe(this,void 0,void 0,function(){var o;return he(this,function(i){switch(i.label){case 0:return[4,this.detect(n,r)];case 1:return o=i.sent(),[2,o.map(function(a){return new Zr(a.score,a.relativeBox,{width:a.imageWidth,height:a.imageHeight})})]}})})},e.prototype.getDefaultModelName=function(){return"tiny_face_detector_model"},e.prototype.extractParamsFromWeigthMap=function(n){return t.prototype.extractParamsFromWeigthMap.call(this,n)},e}(GT),Nn={ssdMobilenetv1:new HT,tinyFaceDetector:new fK,tinyYolov2:new K9,mtcnn:new uK,faceLandmark68Net:new BT,faceLandmark68TinyNet:new p9,faceRecognitionNet:new b9,faceExpressionNet:new e9,ageGenderNet:new l9},YT=function(t){Ee(e,t);function e(n,r,o){var i=t.call(this)||this;return i.parentTask=n,i.input=r,i.extractedFaces=o,i}return e}(ul),F0=function(t){Ee(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.run=function(){return fe(this,void 0,void 0,function(){var n,r,o=this;return he(this,function(i){switch(i.label){case 0:return[4,this.parentTask];case 1:return n=i.sent(),[4,Bh(n,this.input,function(a){return fe(o,void 0,void 0,function(){return he(this,function(s){switch(s.label){case 0:return[4,Promise.all(a.map(function(u){return Nn.faceExpressionNet.predictExpressions(u)}))];case 1:return[2,s.sent()]}})})},this.extractedFaces)];case 2:return r=i.sent(),[2,n.map(function(a,s){return OT(a,r[s])})]}})})},e.prototype.withAgeAndGender=function(){return new U0(this,this.input)},e}(YT),L0=function(t){Ee(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.run=function(){return fe(this,void 0,void 0,function(){var n,r;return he(this,function(o){switch(o.label){case 0:return[4,this.parentTask];case 1:return n=o.sent(),n?[4,D0(n,this.input,function(i){return Nn.faceExpressionNet.predictExpressions(i)},this.extractedFaces)]:[2];case 2:return r=o.sent(),[2,OT(n,r)]}})})},e.prototype.withAgeAndGender=function(){return new W0(this,this.input)},e}(YT),B0=function(t){Ee(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.withAgeAndGender=function(){return new $0(this,this.input)},e.prototype.withFaceDescriptors=function(){return new V0(this,this.input)},e}(F0),j0=function(t){Ee(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.withAgeAndGender=function(){return new z0(this,this.input)},e.prototype.withFaceDescriptor=function(){return new H0(this,this.input)},e}(L0),QT=function(t){Ee(e,t);function e(n,r,o){var i=t.call(this)||this;return i.parentTask=n,i.input=r,i.extractedFaces=o,i}return e}(ul),U0=function(t){Ee(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.run=function(){return fe(this,void 0,void 0,function(){var n,r,o=this;return he(this,function(i){switch(i.label){case 0:return[4,this.parentTask];case 1:return n=i.sent(),[4,Bh(n,this.input,function(a){return fe(o,void 0,void 0,function(){return he(this,function(s){switch(s.label){case 0:return[4,Promise.all(a.map(function(u){return Nn.ageGenderNet.predictAgeAndGender(u)}))];case 1:return[2,s.sent()]}})})},this.extractedFaces)];case 2:return r=i.sent(),[2,n.map(function(a,s){var u=r[s],c=u.age,l=u.gender,d=u.genderProbability;return $T(zT(a,l,d),c)})]}})})},e.prototype.withFaceExpressions=function(){return new F0(this,this.input)},e}(QT),W0=function(t){Ee(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.run=function(){return fe(this,void 0,void 0,function(){var n,r,o,i,a;return he(this,function(s){switch(s.label){case 0:return[4,this.parentTask];case 1:return n=s.sent(),n?[4,D0(n,this.input,function(u){return Nn.ageGenderNet.predictAgeAndGender(u)},this.extractedFaces)]:[2];case 2:return r=s.sent(),o=r.age,i=r.gender,a=r.genderProbability,[2,$T(zT(n,i,a),o)]}})})},e.prototype.withFaceExpressions=function(){return new L0(this,this.input)},e}(QT),$0=function(t){Ee(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.withFaceExpressions=function(){return new B0(this,this.input)},e.prototype.withFaceDescriptors=function(){return new V0(this,this.input)},e}(U0),z0=function(t){Ee(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.withFaceExpressions=function(){return new j0(this,this.input)},e.prototype.withFaceDescriptor=function(){return new H0(this,this.input)},e}(W0),JT=function(t){Ee(e,t);function e(n,r){var o=t.call(this)||this;return o.parentTask=n,o.input=r,o}return e}(ul),V0=function(t){Ee(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.run=function(){return fe(this,void 0,void 0,function(){var n,r;return he(this,function(o){switch(o.label){case 0:return[4,this.parentTask];case 1:return n=o.sent(),[4,Bh(n,this.input,function(i){return Promise.all(i.map(function(a){return Nn.faceRecognitionNet.computeFaceDescriptor(a)}))},null,function(i){return i.landmarks.align(null,{useDlibAlignment:!0})})];case 2:return r=o.sent(),[2,r.map(function(i,a){return WT(n[a],i)})]}})})},e.prototype.withFaceExpressions=function(){return new B0(this,this.input)},e.prototype.withAgeAndGender=function(){return new $0(this,this.input)},e}(JT),H0=function(t){Ee(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.run=function(){return fe(this,void 0,void 0,function(){var n,r;return he(this,function(o){switch(o.label){case 0:return[4,this.parentTask];case 1:return n=o.sent(),n?[4,D0(n,this.input,function(i){return Nn.faceRecognitionNet.computeFaceDescriptor(i)},null,function(i){return i.landmarks.align(null,{useDlibAlignment:!0})})]:[2];case 2:return r=o.sent(),[2,WT(n,r)]}})})},e.prototype.withFaceExpressions=function(){return new j0(this,this.input)},e.prototype.withAgeAndGender=function(){return new z0(this,this.input)},e}(JT),ZT=function(t){Ee(e,t);function e(n,r,o){var i=t.call(this)||this;return i.parentTask=n,i.input=r,i.useTinyLandmarkNet=o,i}return Object.defineProperty(e.prototype,"landmarkNet",{get:function(){return this.useTinyLandmarkNet?Nn.faceLandmark68TinyNet:Nn.faceLandmark68Net},enumerable:!0,configurable:!0}),e}(ul),hK=function(t){Ee(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.run=function(){return fe(this,void 0,void 0,function(){var n,r,o,i,a,s=this;return he(this,function(u){switch(u.label){case 0:return[4,this.parentTask];case 1:return n=u.sent(),r=n.map(function(c){return c.detection}),this.input instanceof tt?[4,S0(this.input,r)]:[3,3];case 2:return i=u.sent(),[3,5];case 3:return[4,_0(this.input,r)];case 4:i=u.sent(),u.label=5;case 5:return o=i,[4,Promise.all(o.map(function(c){return s.landmarkNet.detectLandmarks(c)}))];case 6:return a=u.sent(),o.forEach(function(c){return c instanceof tt&&c.dispose()}),[2,n.map(function(c,l){return T0(c,a[l])})]}})})},e.prototype.withFaceExpressions=function(){return new B0(this,this.input)},e.prototype.withAgeAndGender=function(){return new $0(this,this.input)},e.prototype.withFaceDescriptors=function(){return new V0(this,this.input)},e}(ZT),pK=function(t){Ee(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.run=function(){return fe(this,void 0,void 0,function(){var n,r,o,i,a;return he(this,function(s){switch(s.label){case 0:return[4,this.parentTask];case 1:return n=s.sent(),n?(r=n.detection,this.input instanceof tt?[4,S0(this.input,[r])]:[3,3]):[2];case 2:return i=s.sent(),[3,5];case 3:return[4,_0(this.input,[r])];case 4:i=s.sent(),s.label=5;case 5:return o=i,[4,this.landmarkNet.detectLandmarks(o[0])];case 6:return a=s.sent(),o.forEach(function(u){return u instanceof tt&&u.dispose()}),[2,T0(n,a)]}})})},e.prototype.withFaceExpressions=function(){return new j0(this,this.input)},e.prototype.withAgeAndGender=function(){return new z0(this,this.input)},e.prototype.withFaceDescriptor=function(){return new H0(this,this.input)},e}(ZT),eN=function(t){Ee(e,t);function e(n,r){r===void 0&&(r=new Lh);var o=t.call(this)||this;return o.input=n,o.options=r,o}return e}(ul),tN=function(t){Ee(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.run=function(){return fe(this,void 0,void 0,function(){var n,r,o,i;return he(this,function(a){switch(a.label){case 0:return n=this,r=n.input,o=n.options,o instanceof VT?[4,Nn.mtcnn.forward(r,o)]:[3,2];case 1:return[2,a.sent().map(function(s){return s.detection})];case 2:if(i=o instanceof KT?function(s){return Nn.tinyFaceDetector.locateFaces(s,o)}:o instanceof Lh?function(s){return Nn.ssdMobilenetv1.locateFaces(s,o)}:o instanceof P0?function(s){return Nn.tinyYolov2.locateFaces(s,o)}:null,!i)throw new Error("detectFaces - expected options to be instance of TinyFaceDetectorOptions | SsdMobilenetv1Options | MtcnnOptions | TinyYolov2Options");return[2,i(r)]}})})},e.prototype.runAndExtendWithFaceDetections=function(){var n=this;return new Promise(function(r){return fe(n,void 0,void 0,function(){var o;return he(this,function(i){switch(i.label){case 0:return[4,this.run()];case 1:return o=i.sent(),[2,r(o.map(function(a){return b0({},a)}))]}})})})},e.prototype.withFaceLandmarks=function(n){return n===void 0&&(n=!1),new hK(this.runAndExtendWithFaceDetections(),this.input,n)},e.prototype.withFaceExpressions=function(){return new F0(this.runAndExtendWithFaceDetections(),this.input)},e.prototype.withAgeAndGender=function(){return new U0(this.runAndExtendWithFaceDetections(),this.input)},e}(eN);(function(t){Ee(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.run=function(){return fe(this,void 0,void 0,function(){var n,r;return he(this,function(o){switch(o.label){case 0:return[4,new tN(this.input,this.options)];case 1:return n=o.sent(),r=n[0],n.forEach(function(i){i.score>r.score&&(r=i)}),[2,r]}})})},e.prototype.runAndExtendWithFaceDetection=function(){var n=this;return new Promise(function(r){return fe(n,void 0,void 0,function(){var o;return he(this,function(i){switch(i.label){case 0:return[4,this.run()];case 1:return o=i.sent(),[2,r(o?b0({},o):void 0)]}})})})},e.prototype.withFaceLandmarks=function(n){return n===void 0&&(n=!1),new pK(this.runAndExtendWithFaceDetection(),this.input,n)},e.prototype.withFaceExpressions=function(){return new L0(this.runAndExtendWithFaceDetection(),this.input)},e.prototype.withAgeAndGender=function(){return new W0(this.runAndExtendWithFaceDetection(),this.input)},e})(eN);function mK(t,e){return e===void 0&&(e=new Lh),new tN(t,e)}function vK(t,e){if(t.length!==e.length)throw new Error("euclideanDistance: arr1.length !== arr2.length");var n=Array.from(t),r=Array.from(e);return Math.sqrt(n.map(function(o,i){return o-r[i]}).reduce(function(o,i){return o+Math.pow(i,2)},0))}(function(){function t(e,n){n===void 0&&(n=.6),this._distanceThreshold=n;var r=Array.isArray(e)?e:[e];if(!r.length)throw new Error("FaceRecognizer.constructor - expected atleast one input");var o=1,i=function(){return"person "+o++};this._labeledDescriptors=r.map(function(a){if(a instanceof Xl)return a;if(a instanceof Float32Array)return new Xl(i(),[a]);if(a.descriptor&&a.descriptor instanceof Float32Array)return new Xl(i(),[a.descriptor]);throw new Error("FaceRecognizer.constructor - expected inputs to be of type LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array | Array<LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array>")})}return Object.defineProperty(t.prototype,"labeledDescriptors",{get:function(){return this._labeledDescriptors},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"distanceThreshold",{get:function(){return this._distanceThreshold},enumerable:!0,configurable:!0}),t.prototype.computeMeanDistance=function(e,n){return n.map(function(r){return vK(r,e)}).reduce(function(r,o){return r+o},0)/(n.length||1)},t.prototype.matchDescriptor=function(e){var n=this;return this.labeledDescriptors.map(function(r){var o=r.descriptors,i=r.label;return new Fb(i,n.computeMeanDistance(e,o))}).reduce(function(r,o){return r.distance<o.distance?r:o})},t.prototype.findBestMatch=function(e){var n=this.matchDescriptor(e);return n.distance<this.distanceThreshold?n:new Fb("unknown",n.distance)},t.prototype.toJSON=function(){return{distanceThreshold:this.distanceThreshold,labeledDescriptors:this.labeledDescriptors.map(function(e){return e.toJSON()})}},t.fromJSON=function(e){var n=e.labeledDescriptors.map(function(r){return Xl.fromJSON(r)});return new t(n,e.distanceThreshold)},t})();const gK=(t=!0)=>{const e=C.useRef(null),n=C.useRef(null),[r,o]=C.useState({hasFace:!1,detections:0}),[i,a]=C.useState(!0),[s,u]=C.useState(!1),[c,l]=C.useState(!1),d=C.useRef(null),f=C.useRef(null);return C.useEffect(()=>{if(!t){a(!1);return}(async()=>{try{console.log(" Loading face-api.js models..."),await Nn.tinyFaceDetector.loadFromUri("/models"),console.log(" Face detection models loaded successfully!"),l(!0),a(!1)}catch(m){console.error(" Failed to load face detection models:",m);const p=m instanceof Error?m.message:String(m);o(g=>({...g,error:`Model loading failed: ${p}`})),a(!1)}})()},[t]),C.useEffect(()=>{if(!t||!e.current)return;const h=e.current;return console.log(" Requesting camera access..."),navigator.mediaDevices.getUserMedia({video:{width:{ideal:640},height:{ideal:480},facingMode:"user"}}).then(m=>{console.log(" Camera access granted:",m.getVideoTracks()[0].label),f.current=m,h.srcObject=m,h.onloadedmetadata=()=>{console.log(" Video metadata loaded"),h.play().then(()=>{console.log(" Video playing successfully"),u(!0)}).catch(p=>{console.error(" Video play error:",p),o(g=>({...g,error:"Video playback failed"}))})}}).catch(m=>{console.error(" Camera access error:",m.name,m.message),o(p=>({...p,error:m.name==="NotAllowedError"?"Camera access denied":m.name==="NotFoundError"?"No camera found":"Camera unavailable"}))}),()=>{f.current&&(console.log(" Stopping camera stream"),f.current.getTracks().forEach(m=>m.stop()),f.current=null)}},[t]),C.useEffect(()=>{if(!t||!c||!s||!e.current){console.log(" Waiting for:",{enabled:t,modelsLoaded:c,cameraReady:s,hasVideo:!!e.current});return}const h=e.current;console.log(" Starting face detection loop with face-api.js");const m=async()=>{try{if(h.readyState===h.HAVE_ENOUGH_DATA){const p=await mK(h,new KT({inputSize:224,scoreThreshold:.5}));o({hasFace:p.length>0,detections:p.length})}}catch(p){const g=p instanceof Error?p.message:String(p);console.error(" Face detection error:",g),o(v=>({...v,error:"Detection error"}))}};return d.current=window.setInterval(m,100),()=>{d.current&&(clearInterval(d.current),d.current=null)}},[t,c,s]),{videoRef:e,canvasRef:n,result:r,isLoading:i}},yK=({isOpen:t,onClose:e,onSpeak:n})=>{const[r,o]=C.useState(!1),[i,a]=C.useState(0),[s,u]=C.useState(!1),[c,l]=C.useState(!1),d=C.useRef(null),f=C.useRef(!1),{videoRef:h,result:m,isLoading:p}=gK(t);if(C.useEffect(()=>{if(!t){u(!1),l(!1),d.current&&clearTimeout(d.current);return}if(m.hasFace&&!s){if(u(!0),!f.current){l(!0),o(!0),f.current=!0;const y="   ";n&&setTimeout(()=>{n(y)},500),d.current=window.setTimeout(()=>{l(!1)},5e3)}}else!m.hasFace&&s&&u(!1)},[m.hasFace,t,s,n]),C.useEffect(()=>{if(!t||!r)return;const y=setInterval(()=>{a(Math.random()*100)},100);return()=>clearInterval(y)},[t,r]),!t)return null;const g=200+i*.5,v=20+i*.3;return b.jsxs("div",{className:"fixed inset-0 z-50 bg-gradient-to-br from-slate-950 via-blue-950 to-slate-950 flex flex-col overflow-hidden",children:[b.jsx("video",{ref:h,className:"hidden",autoPlay:!0,playsInline:!0,muted:!0}),b.jsx("div",{className:"absolute top-6 right-6 z-10",children:b.jsx(De,{variant:"ghost",size:"icon",onClick:e,className:"text-white/70 hover:text-white hover:bg-white/10 rounded-full w-12 h-12",children:b.jsx(rh,{className:"w-6 h-6"})})}),b.jsxs("div",{className:"pt-16 text-center",children:[b.jsxs("div",{className:"flex items-center justify-center gap-2 mb-2",children:[b.jsx($s,{className:"w-5 h-5 text-cyan-400"}),b.jsx("span",{className:"text-cyan-400 text-sm font-medium tracking-widest uppercase",children:"NongPlatoo Voice AI"}),b.jsx($s,{className:"w-5 h-5 text-cyan-400"})]}),b.jsx("p",{className:"text-white/60 text-sm",children:""})]}),b.jsxs("div",{className:"flex-1 flex items-center justify-center relative",children:[b.jsx("div",{className:"absolute inset-0 overflow-hidden",children:[...Array(20)].map((y,x)=>b.jsx("div",{className:"absolute w-1 h-1 bg-cyan-400/30 rounded-full animate-pulse",style:{left:`${Math.random()*100}%`,top:`${Math.random()*100}%`,animationDelay:`${Math.random()*2}s`,animationDuration:`${2+Math.random()*2}s`}},x))}),b.jsx("div",{className:"absolute rounded-full opacity-20 animate-ping",style:{width:g+100,height:g+100,background:"radial-gradient(circle, rgba(34, 211, 238, 0.3) 0%, transparent 70%)",animationDuration:"2s"}}),b.jsx("div",{className:"absolute rounded-full opacity-30",style:{width:g+60,height:g+60,background:"radial-gradient(circle, rgba(34, 211, 238, 0.2) 0%, transparent 70%)",animation:"pulse 1.5s ease-in-out infinite"}}),b.jsxs("div",{className:"absolute rounded-full border border-cyan-400/30",style:{width:g+40,height:g+40,animation:"spin 8s linear infinite"},children:[b.jsx("div",{className:"absolute -top-1 left-1/2 -translate-x-1/2 w-2 h-2 bg-cyan-400 rounded-full"}),b.jsx("div",{className:"absolute -bottom-1 left-1/2 -translate-x-1/2 w-2 h-2 bg-cyan-400 rounded-full"})]}),b.jsxs("div",{className:"absolute rounded-full border border-blue-400/20",style:{width:g+20,height:g+20,animation:"spin 6s linear infinite reverse"},children:[b.jsx("div",{className:"absolute top-1/2 -left-1 -translate-y-1/2 w-2 h-2 bg-blue-400 rounded-full"}),b.jsx("div",{className:"absolute top-1/2 -right-1 -translate-y-1/2 w-2 h-2 bg-blue-400 rounded-full"})]}),b.jsxs("div",{className:"relative rounded-full flex items-center justify-center transition-all duration-100",style:{width:g,height:g,background:`
              radial-gradient(circle at 30% 30%, rgba(34, 211, 238, 0.4) 0%, transparent 50%),
              radial-gradient(circle at 70% 70%, rgba(59, 130, 246, 0.3) 0%, transparent 50%),
              radial-gradient(circle, rgba(30, 58, 138, 0.9) 0%, rgba(15, 23, 42, 0.95) 100%)
            `,boxShadow:`
              0 0 ${v}px rgba(34, 211, 238, 0.5),
              0 0 ${v*2}px rgba(34, 211, 238, 0.3),
              0 0 ${v*3}px rgba(34, 211, 238, 0.1),
              inset 0 0 60px rgba(34, 211, 238, 0.1)
            `},children:[b.jsx("div",{className:"absolute rounded-full",style:{width:g*.7,height:g*.7,background:"radial-gradient(circle, rgba(34, 211, 238, 0.15) 0%, transparent 70%)",animation:"pulse 2s ease-in-out infinite"}}),b.jsx("div",{className:"flex items-center justify-center gap-1",children:[...Array(7)].map((y,x)=>{const w=r?20+Math.sin(Date.now()/200+x)*30+i*.3:10;return b.jsx("div",{className:"w-1.5 bg-gradient-to-t from-cyan-400 to-blue-400 rounded-full transition-all duration-75",style:{height:`${w}px`,opacity:.6+i/200}},x)})})]}),b.jsx("div",{className:"absolute",style:{width:g+150,height:g+150,animation:"spin 20s linear infinite"},children:[...Array(6)].map((y,x)=>b.jsx("div",{className:"absolute w-2 h-2 bg-cyan-400/50 rounded-full animate-pulse",style:{top:`${50+45*Math.cos(x*60*Math.PI/180)}%`,left:`${50+45*Math.sin(x*60*Math.PI/180)}%`,transform:"translate(-50%, -50%)",animationDelay:`${x*.2}s`}},x))})]}),b.jsxs("div",{className:"pb-16 text-center",children:[b.jsxs("div",{className:"mb-4",children:[c&&b.jsxs("div",{className:"mb-4 animate-in fade-in duration-500",children:[b.jsx("p",{className:"text-cyan-300 text-lg font-medium mb-2",children:"! "}),b.jsx("p",{className:"text-white/70 text-sm",children:" "}),b.jsx("p",{className:"text-white/60 text-xs mt-1",children:""})]}),b.jsx("p",{className:`text-lg font-medium ${r?"text-cyan-400":"text-white/60"}`,children:r?"...":""}),b.jsx("p",{className:"text-white/40 text-sm mt-2",children:""})]}),b.jsx("div",{className:"flex justify-center gap-4",children:b.jsx(De,{variant:"outline",size:"lg",onClick:()=>o(!r),className:`
              rounded-full px-8 border-2 transition-all duration-300
              ${r?"border-red-400/50 text-red-400 hover:bg-red-400/10 bg-red-400/5":"border-cyan-400/50 text-cyan-400 hover:bg-cyan-400/10 bg-cyan-400/5"}
            `,children:r?"":""})})]})]})},dm=FI(),xK=["","","",""],wK=()=>{const[t]=by(),e=t.get("place"),n=e?OI(e):null,[r,o]=C.useState([{id:"welcome",content:n?`! I see you're interested in ${n.nameTh} (${n.name}). I'd be happy to help you learn more about this place or plan your visit. What would you like to know?`:"!      ",isUser:!1,timestamp:new Date().toLocaleTimeString("th-TH",{hour:"2-digit",minute:"2-digit"})}]),[i,a]=C.useState(""),[s,u]=C.useState(!1),[c,l]=C.useState(null),[d,f]=C.useState(!1),[h,m]=C.useState(""),[p,g]=C.useState(!1),[v,y]=C.useState(!1),[x,w]=C.useState(null),[E,_]=C.useState(!1),S=C.useRef(null),k=C.useRef(""),I=C.useRef(null),R=C.useRef(null),D=C.useRef(null),A=()=>{var H;(H=R.current)==null||H.scrollIntoView({behavior:"smooth"})};C.useEffect(()=>{A()},[r]),C.useEffect(()=>{if(typeof window>"u")return;const H=window,Q=H.SpeechRecognition||H.webkitSpeechRecognition;return g(!!Q),()=>{var ne,Z;(ne=S.current)==null||ne.abort(),(Z=D.current)==null||Z.close(),x&&x.pause()}},[x]);const j=()=>new Date().toLocaleTimeString("th-TH",{hour:"2-digit",minute:"2-digit"}),F=(H,Q)=>({id:`${Date.now()}-assistant`,content:H.text,structuredData:H.structured_data,isUser:!1,timestamp:H.createdAt||new Date().toLocaleTimeString("th-TH",{hour:"2-digit",minute:"2-digit"}),meta:{source:H.source,intent:H.intent},userMessage:Q}),W=async H=>{try{x&&(x.pause(),w(null)),y(!0);try{const Q=await fetch(`${dm}/api/text-to-speech`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:H,language:"th"})});if(!Q.ok)throw new Error("Failed to generate speech");const ne=await Q.json();if(ne.success&&ne.audio){const Z=new Blob([Uint8Array.from(atob(ne.audio),xe=>xe.charCodeAt(0))],{type:"audio/mp3"}),se=URL.createObjectURL(Z),re=new Audio(se);re.onended=()=>{y(!1),w(null),URL.revokeObjectURL(se)},re.onerror=()=>{y(!1),w(null),U(H)},w(re),await re.play();return}}catch(Q){console.warn("Server TTS failed, using browser TTS:",Q),U(H)}}catch(Q){console.error("TTS error:",Q),y(!1),l("")}},U=H=>{if("speechSynthesis"in window){window.speechSynthesis.cancel();const Q=new SpeechSynthesisUtterance(H);Q.lang="th-TH",Q.rate=1.3,Q.pitch=1,Q.volume=1;const Z=window.speechSynthesis.getVoices().find(se=>se.lang.startsWith("th"));Z&&(Q.voice=Z),Q.onend=()=>{y(!1)},Q.onerror=()=>{y(!1),l("")},window.speechSynthesis.speak(Q)}else y(!1),l("")},$=()=>{x&&(x.pause(),w(null),y(!1)),"speechSynthesis"in window&&window.speechSynthesis.cancel()},M=async H=>{const Q=H||i;if(!Q.trim())return;const ne={id:Date.now().toString(),content:Q,isUser:!0,timestamp:j()};o(se=>[...se,ne]),a(""),u(!0),l(null);const Z=new AbortController;I.current=Z;try{const se=await fetch(`${dm}/api/messages`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:Q,user_id:"web"}),signal:Z.signal});if(!se.ok){const xe=await se.text();throw new Error(xe||"Unable to reach AI service")}const re=await se.json();re!=null&&re.assistant?o(xe=>[...xe,F(re.assistant,Q)]):o(xe=>[...xe,{id:`${Date.now()}-fallback`,content:"  ",isUser:!1,timestamp:j()}])}catch(se){console.error(se),se.name==="AbortError"?l(""):l(" AI  "),o(re=>[...re,{id:`${Date.now()}-error`,content:se.name==="AbortError"?"":"  AI  ",isUser:!1,timestamp:j()}])}finally{u(!1),I.current=null}},P=async H=>{var xe;const Q=H||i;if(!Q.trim())return;const ne={id:Date.now().toString(),content:Q,isUser:!0,timestamp:j()};o(pe=>[...pe,ne]),a(""),u(!0),l(null);const Z=`${Date.now()}-assistant`,se={id:Z,content:"",isUser:!1,timestamp:j(),isStreaming:!0};o(pe=>[...pe,se]);const re=new AbortController;I.current=re;try{const pe=await fetch(`${dm}/api/messages/stream`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:Q,user_id:"web"}),signal:re.signal});if(!pe.ok){o(St=>St.filter(ht=>ht.id!==Z)),await M(Q);return}const be=(xe=pe.body)==null?void 0:xe.getReader(),ve=new TextDecoder;let Pe="",Ue=[],Le="";if(be)for(;;){const{done:St,value:ht}=await be.read();if(St)break;const Qn=ve.decode(ht).split(`
`);for(const kt of Qn)if(kt.startsWith("data: "))try{const Qe=JSON.parse(kt.slice(6));if(Qe.type==="intent")Le=Qe.intent_type;else if(Qe.type==="structured_data")Ue=Qe.data;else if(Qe.type==="text")Pe+=Qe.text,o(lt=>lt.map(jt=>jt.id===Z?{...jt,content:Pe}:jt));else if(Qe.type==="done")o(lt=>lt.map(jt=>jt.id===Z?{...jt,content:Pe,structuredData:Ue,meta:{intent_type:Le,source:"streaming"},isStreaming:!1,chatLogId:Qe.chat_log_id}:jt));else if(Qe.type==="error")throw new Error(Qe.message)}catch(Qe){console.warn("Failed to parse SSE data:",Qe)}}}catch(pe){console.error(pe),pe.name==="AbortError"?l(""):l(" AI  "),o(be=>be.filter(ve=>ve.id!==Z)),o(be=>[...be,{id:`${Date.now()}-error`,content:"  ",isUser:!1,timestamp:j()}])}finally{u(!1),I.current=null}},B=H=>{H.key==="Enter"&&!H.shiftKey&&(H.preventDefault(),P())},G=()=>{var H;(H=S.current)==null||H.stop()},q=()=>{var H,Q;(H=I.current)==null||H.abort(),I.current=null,(Q=D.current)==null||Q.close(),D.current=null,u(!1)},J=async()=>{var se;if(typeof window>"u")return;const H=window,Q=H.SpeechRecognition||H.webkitSpeechRecognition;if(!Q){l("  Chrome  Edge");return}(se=S.current)==null||se.abort();const ne=new Q;ne.lang="th-TH",ne.interimResults=!0,ne.continuous=!1,ne.maxAlternatives=1,S.current=ne;let Z="";k.current="",m(""),f(!0),l(null),ne.onresult=re=>{var be;let xe="";for(let ve=re.resultIndex;ve<re.results.length;ve++){const Pe=((be=re.results[ve][0])==null?void 0:be.transcript)||"";re.results[ve].isFinal?Z+=Pe:xe+=Pe}const pe=`${Z} ${xe}`.trim();k.current=pe,m(pe)},ne.onerror=re=>{console.error("Voice recognition error",re.error),f(!1),l("  ")},ne.onend=()=>{f(!1);const re=(k.current||Z).trim();re?M(re):l("  ")},ne.start()};return b.jsxs("div",{className:"min-h-screen bg-background flex flex-col",children:[b.jsx(Xs,{}),d&&b.jsx("div",{className:"fixed inset-0 z-40 bg-background/60 backdrop-blur-sm flex items-end md:items-center justify-center px-4 pb-10",children:b.jsxs("div",{className:"w-full max-w-lg bg-gradient-to-br from-primary via-primary/80 to-primary-foreground text-primary-foreground rounded-3xl p-6 shadow-2xl border border-primary/40",children:[b.jsxs("div",{className:"flex items-center justify-between gap-3",children:[b.jsxs("div",{className:"flex items-center gap-4",children:[b.jsxs("div",{className:"relative",children:[b.jsx("div",{className:"absolute inset-0 rounded-2xl bg-primary-foreground/20 animate-ping"}),b.jsx("div",{className:"relative w-12 h-12 rounded-2xl bg-primary-foreground/30 flex items-center justify-center",children:b.jsx($s,{className:"w-6 h-6"})})]}),b.jsxs("div",{children:[b.jsx("p",{className:"text-xs uppercase tracking-[0.2em] text-primary-foreground/70",children:"NongPlaToo Voice"}),b.jsx("p",{className:"text-lg font-semibold",children:"..."}),b.jsx("p",{className:"text-sm text-primary-foreground/80",children:""})]})]}),b.jsxs(De,{size:"sm",variant:"secondary",onClick:G,className:"bg-primary-foreground text-primary hover:bg-primary-foreground/90",children:[b.jsx(bx,{className:"w-4 h-4"}),""]})]}),b.jsxs("div",{className:"mt-5 bg-white/10 border border-white/20 rounded-2xl p-4 min-h-[92px]",children:[b.jsx("p",{className:"text-sm text-primary-foreground/80",children:h||"..."}),b.jsxs("div",{className:"mt-4 flex items-center gap-1",children:[b.jsx("span",{className:"w-1.5 h-6 bg-white/40 rounded-full animate-[pulse_1s_ease-in-out_infinite]"}),b.jsx("span",{className:"w-1.5 h-9 bg-white/60 rounded-full animate-[pulse_1.2s_ease-in-out_infinite]"}),b.jsx("span",{className:"w-1.5 h-4 bg-white/30 rounded-full animate-[pulse_0.9s_ease-in-out_infinite]"}),b.jsx("span",{className:"w-1.5 h-7 bg-white/50 rounded-full animate-[pulse_1.1s_ease-in-out_infinite]"})]})]})]})}),b.jsx("main",{className:"flex-1 overflow-y-auto pt-16",children:b.jsxs("div",{className:"container mx-auto px-4 py-6 max-w-3xl",children:[c&&b.jsxs("div",{className:"mb-4 inline-flex items-center gap-2 text-sm text-red-500 bg-red-50 border border-red-200 rounded-xl px-3 py-2",children:[b.jsx(fx,{className:"w-4 h-4"}),b.jsx("span",{children:c})]}),b.jsxs("div",{className:"space-y-4",children:[r.map(H=>b.jsx(XU,{message:H.content,isUser:H.isUser,timestamp:H.timestamp,structuredData:H.structuredData,meta:H.meta,messageId:H.id,chatLogId:H.chatLogId,userMessage:H.userMessage},H.id)),s&&b.jsxs("div",{className:"flex gap-3",children:[b.jsx("div",{className:"w-9 h-9 bg-secondary rounded-full flex items-center justify-center",children:b.jsx($s,{className:"w-5 h-5 text-secondary-foreground animate-pulse"})}),b.jsx("div",{className:"bg-card shadow-soft border border-border rounded-2xl rounded-bl-sm px-4 py-3",children:b.jsxs("div",{className:"flex gap-1",children:[b.jsx("span",{className:"w-2 h-2 bg-muted-foreground rounded-full animate-pulse"}),b.jsx("span",{className:"w-2 h-2 bg-muted-foreground rounded-full animate-pulse animation-delay-100"}),b.jsx("span",{className:"w-2 h-2 bg-muted-foreground rounded-full animate-pulse animation-delay-200"})]})})]}),b.jsx("div",{ref:R})]})]})}),r.length<=2&&b.jsx("div",{className:"border-t border-border bg-muted/50",children:b.jsxs("div",{className:"container mx-auto px-4 py-3 max-w-3xl",children:[b.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:":"}),b.jsx("div",{className:"flex flex-wrap gap-2",children:xK.map(H=>b.jsx(De,{variant:"outline",size:"sm",className:"rounded-full text-xs",onClick:()=>P(H),children:H},H))})]})}),b.jsx("div",{className:"border-t border-border bg-card sticky bottom-0",children:b.jsxs("div",{className:"container mx-auto px-4 py-4 max-w-3xl",children:[b.jsxs("div",{className:"flex gap-3 items-center",children:[b.jsx(De,{type:"button",variant:d?"destructive":"secondary",size:"icon",onClick:d?G:J,disabled:!p||s,className:d?"animate-pulse shadow-elevated":"",children:b.jsx(HD,{className:"w-5 h-5"})}),b.jsx(De,{type:"button",variant:"outline",size:"icon",onClick:()=>_(!0),disabled:s,className:"border-cyan-500/50 text-cyan-600 hover:bg-cyan-500/10 hover:text-cyan-500",title:"Voice AI Assistant",children:b.jsx(KD,{className:"w-5 h-5"})}),b.jsx(ao,{value:i,onChange:H=>a(H.target.value),onKeyPress:B,placeholder:"... (Type a message)",className:"flex-1 h-12 bg-background rounded-xl",disabled:s}),v&&b.jsx(De,{type:"button",onClick:$,variant:"outline",size:"icon",className:"h-12 w-12 rounded-xl",children:b.jsx(JD,{className:"w-5 h-5"})}),s?b.jsxs(De,{type:"button",onClick:q,variant:"destructive",className:"h-12 px-4 rounded-xl",children:[b.jsx(bx,{className:"w-5 h-5"}),""]}):b.jsx(De,{onClick:()=>P(),disabled:!i.trim(),className:"h-12 w-12 rounded-xl",children:b.jsx(qD,{className:"w-5 h-5"})})]}),!p&&b.jsxs("p",{className:"mt-2 text-xs text-muted-foreground inline-flex items-center gap-1",children:[b.jsx(fx,{className:"w-3 h-3"}),"  Chrome  Edge"]})]})}),b.jsx(yK,{isOpen:E,onClose:()=>_(!1),onSpeak:W})]})},bK=()=>{const t=Ea();return C.useEffect(()=>{console.error("404 Error: User attempted to access non-existent route:",t.pathname)},[t.pathname]),b.jsx("div",{className:"flex min-h-screen items-center justify-center bg-muted",children:b.jsxs("div",{className:"text-center",children:[b.jsx("h1",{className:"mb-4 text-4xl font-bold",children:"404"}),b.jsx("p",{className:"mb-4 text-xl text-muted-foreground",children:"Oops! Page not found"}),b.jsx("a",{href:"/",className:"text-primary underline hover:text-primary/90",children:"Return to Home"})]})})},EK=new E4,CK=()=>b.jsx(_4,{client:EK,children:b.jsx(JO,{children:b.jsxs(hU,{children:[b.jsx(MM,{}),b.jsx(f3,{}),b.jsx(EF,{children:b.jsxs(pF,{children:[b.jsx(zi,{path:"/",element:b.jsx(CU,{})}),b.jsx(zi,{path:"/auth",element:b.jsx(DU,{})}),b.jsx(zi,{path:"/places",element:b.jsx(WU,{})}),b.jsx(zi,{path:"/places/:id",element:b.jsx($U,{})}),b.jsx(zi,{path:"/chat",element:b.jsx(wK,{})}),b.jsx(zi,{path:"*",element:b.jsx(bK,{})})]})})]})})});lC(document.getElementById("root")).render(b.jsx(CK,{}))});export default _K();
