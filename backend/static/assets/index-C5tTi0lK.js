var Z0=t=>{throw TypeError(t)};var wN=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var Vh=(t,e,n)=>e.has(t)||Z0("Cannot "+n);var q=(t,e,n)=>(Vh(t,e,"read from private field"),n?n.call(t):e.get(t)),Be=(t,e,n)=>e.has(t)?Z0("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,n),Se=(t,e,n,r)=>(Vh(t,e,"write to private field"),r?r.call(t,n):e.set(t,n),n),Wt=(t,e,n)=>(Vh(t,e,"access private method"),n);var hl=(t,e,n,r)=>({set _(o){Se(t,e,o,n)},get _(){return q(t,e,r)}});var UK=wN((QK,mN)=>{function bN(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const o in r)if(o!=="default"&&!(o in t)){const i=Object.getOwnPropertyDescriptor(r,o);i&&Object.defineProperty(t,o,i.get?i:{enumerable:!0,get:()=>r[o]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(o){if(o.ep)return;o.ep=!0;const i=n(o);fetch(o.href,i)}})();function i2(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var a2={exports:{}},Bf={},s2={exports:{}},De={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Oc=Symbol.for("react.element"),EN=Symbol.for("react.portal"),CN=Symbol.for("react.fragment"),_N=Symbol.for("react.strict_mode"),SN=Symbol.for("react.profiler"),kN=Symbol.for("react.provider"),IN=Symbol.for("react.context"),RN=Symbol.for("react.forward_ref"),TN=Symbol.for("react.suspense"),NN=Symbol.for("react.memo"),AN=Symbol.for("react.lazy"),e1=Symbol.iterator;function PN(t){return t===null||typeof t!="object"?null:(t=e1&&t[e1]||t["@@iterator"],typeof t=="function"?t:null)}var u2={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},c2=Object.assign,l2={};function nu(t,e,n){this.props=t,this.context=e,this.refs=l2,this.updater=n||u2}nu.prototype.isReactComponent={};nu.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};nu.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function d2(){}d2.prototype=nu.prototype;function ug(t,e,n){this.props=t,this.context=e,this.refs=l2,this.updater=n||u2}var cg=ug.prototype=new d2;cg.constructor=ug;c2(cg,nu.prototype);cg.isPureReactComponent=!0;var t1=Array.isArray,f2=Object.prototype.hasOwnProperty,lg={current:null},h2={key:!0,ref:!0,__self:!0,__source:!0};function p2(t,e,n){var r,o={},i=null,a=null;if(e!=null)for(r in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(i=""+e.key),e)f2.call(e,r)&&!h2.hasOwnProperty(r)&&(o[r]=e[r]);var s=arguments.length-2;if(s===1)o.children=n;else if(1<s){for(var u=Array(s),c=0;c<s;c++)u[c]=arguments[c+2];o.children=u}if(t&&t.defaultProps)for(r in s=t.defaultProps,s)o[r]===void 0&&(o[r]=s[r]);return{$$typeof:Oc,type:t,key:i,ref:a,props:o,_owner:lg.current}}function DN(t,e){return{$$typeof:Oc,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function dg(t){return typeof t=="object"&&t!==null&&t.$$typeof===Oc}function MN(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var n1=/\/+/g;function Hh(t,e){return typeof t=="object"&&t!==null&&t.key!=null?MN(""+t.key):e.toString(36)}function rd(t,e,n,r,o){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(i){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case Oc:case EN:a=!0}}if(a)return a=t,o=o(a),t=r===""?"."+Hh(a,0):r,t1(o)?(n="",t!=null&&(n=t.replace(n1,"$&/")+"/"),rd(o,e,n,"",function(c){return c})):o!=null&&(dg(o)&&(o=DN(o,n+(!o.key||a&&a.key===o.key?"":(""+o.key).replace(n1,"$&/")+"/")+t)),e.push(o)),1;if(a=0,r=r===""?".":r+":",t1(t))for(var s=0;s<t.length;s++){i=t[s];var u=r+Hh(i,s);a+=rd(i,e,n,u,o)}else if(u=PN(t),typeof u=="function")for(t=u.call(t),s=0;!(i=t.next()).done;)i=i.value,u=r+Hh(i,s++),a+=rd(i,e,n,u,o);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function pl(t,e,n){if(t==null)return t;var r=[],o=0;return rd(t,r,"","",function(i){return e.call(n,i,o++)}),r}function ON(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var an={current:null},od={transition:null},FN={ReactCurrentDispatcher:an,ReactCurrentBatchConfig:od,ReactCurrentOwner:lg};function m2(){throw Error("act(...) is not supported in production builds of React.")}De.Children={map:pl,forEach:function(t,e,n){pl(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return pl(t,function(){e++}),e},toArray:function(t){return pl(t,function(e){return e})||[]},only:function(t){if(!dg(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};De.Component=nu;De.Fragment=CN;De.Profiler=SN;De.PureComponent=ug;De.StrictMode=_N;De.Suspense=TN;De.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=FN;De.act=m2;De.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=c2({},t.props),o=t.key,i=t.ref,a=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,a=lg.current),e.key!==void 0&&(o=""+e.key),t.type&&t.type.defaultProps)var s=t.type.defaultProps;for(u in e)f2.call(e,u)&&!h2.hasOwnProperty(u)&&(r[u]=e[u]===void 0&&s!==void 0?s[u]:e[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){s=Array(u);for(var c=0;c<u;c++)s[c]=arguments[c+2];r.children=s}return{$$typeof:Oc,type:t.type,key:o,ref:i,props:r,_owner:a}};De.createContext=function(t){return t={$$typeof:IN,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:kN,_context:t},t.Consumer=t};De.createElement=p2;De.createFactory=function(t){var e=p2.bind(null,t);return e.type=t,e};De.createRef=function(){return{current:null}};De.forwardRef=function(t){return{$$typeof:RN,render:t}};De.isValidElement=dg;De.lazy=function(t){return{$$typeof:AN,_payload:{_status:-1,_result:t},_init:ON}};De.memo=function(t,e){return{$$typeof:NN,type:t,compare:e===void 0?null:e}};De.startTransition=function(t){var e=od.transition;od.transition={};try{t()}finally{od.transition=e}};De.unstable_act=m2;De.useCallback=function(t,e){return an.current.useCallback(t,e)};De.useContext=function(t){return an.current.useContext(t)};De.useDebugValue=function(){};De.useDeferredValue=function(t){return an.current.useDeferredValue(t)};De.useEffect=function(t,e){return an.current.useEffect(t,e)};De.useId=function(){return an.current.useId()};De.useImperativeHandle=function(t,e,n){return an.current.useImperativeHandle(t,e,n)};De.useInsertionEffect=function(t,e){return an.current.useInsertionEffect(t,e)};De.useLayoutEffect=function(t,e){return an.current.useLayoutEffect(t,e)};De.useMemo=function(t,e){return an.current.useMemo(t,e)};De.useReducer=function(t,e,n){return an.current.useReducer(t,e,n)};De.useRef=function(t){return an.current.useRef(t)};De.useState=function(t){return an.current.useState(t)};De.useSyncExternalStore=function(t,e,n){return an.current.useSyncExternalStore(t,e,n)};De.useTransition=function(){return an.current.useTransition()};De.version="18.3.1";s2.exports=De;var C=s2.exports;const ne=i2(C),fg=bN({__proto__:null,default:ne},[C]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var LN=C,BN=Symbol.for("react.element"),jN=Symbol.for("react.fragment"),UN=Object.prototype.hasOwnProperty,WN=LN.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,$N={key:!0,ref:!0,__self:!0,__source:!0};function v2(t,e,n){var r,o={},i=null,a=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(a=e.ref);for(r in e)UN.call(e,r)&&!$N.hasOwnProperty(r)&&(o[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)o[r]===void 0&&(o[r]=e[r]);return{$$typeof:BN,type:t,key:i,ref:a,props:o,_owner:WN.current}}Bf.Fragment=jN;Bf.jsx=v2;Bf.jsxs=v2;a2.exports=Bf;var w=a2.exports,g2={exports:{}},Fn={},y2={exports:{}},x2={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(M,P){var B=M.length;M.push(P);e:for(;0<B;){var V=B-1>>>1,K=M[V];if(0<o(K,P))M[V]=P,M[B]=K,B=V;else break e}}function n(M){return M.length===0?null:M[0]}function r(M){if(M.length===0)return null;var P=M[0],B=M.pop();if(B!==P){M[0]=B;e:for(var V=0,K=M.length,Q=K>>>1;V<Q;){var te=2*(V+1)-1,ae=M[te],X=te+1,J=M[X];if(0>o(ae,B))X<K&&0>o(J,ae)?(M[V]=J,M[X]=B,V=X):(M[V]=ae,M[te]=B,V=te);else if(X<K&&0>o(J,B))M[V]=J,M[X]=B,V=X;else break e}}return P}function o(M,P){var B=M.sortIndex-P.sortIndex;return B!==0?B:M.id-P.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var a=Date,s=a.now();t.unstable_now=function(){return a.now()-s}}var u=[],c=[],l=1,d=null,f=3,h=!1,m=!1,p=!1,g=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function x(M){for(var P=n(c);P!==null;){if(P.callback===null)r(c);else if(P.startTime<=M)r(c),P.sortIndex=P.expirationTime,e(u,P);else break;P=n(c)}}function b(M){if(p=!1,x(M),!m)if(n(u)!==null)m=!0,j(E);else{var P=n(c);P!==null&&U(b,P.startTime-M)}}function E(M,P){m=!1,p&&(p=!1,v(k),k=-1),h=!0;var B=f;try{for(x(P),d=n(u);d!==null&&(!(d.expirationTime>P)||M&&!D());){var V=d.callback;if(typeof V=="function"){d.callback=null,f=d.priorityLevel;var K=V(d.expirationTime<=P);P=t.unstable_now(),typeof K=="function"?d.callback=K:d===n(u)&&r(u),x(P)}else r(u);d=n(u)}if(d!==null)var Q=!0;else{var te=n(c);te!==null&&U(b,te.startTime-P),Q=!1}return Q}finally{d=null,f=B,h=!1}}var _=!1,S=null,k=-1,R=5,I=-1;function D(){return!(t.unstable_now()-I<R)}function A(){if(S!==null){var M=t.unstable_now();I=M;var P=!0;try{P=S(!0,M)}finally{P?W():(_=!1,S=null)}}else _=!1}var W;if(typeof y=="function")W=function(){y(A)};else if(typeof MessageChannel<"u"){var F=new MessageChannel,$=F.port2;F.port1.onmessage=A,W=function(){$.postMessage(null)}}else W=function(){g(A,0)};function j(M){S=M,_||(_=!0,W())}function U(M,P){k=g(function(){M(t.unstable_now())},P)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(M){M.callback=null},t.unstable_continueExecution=function(){m||h||(m=!0,j(E))},t.unstable_forceFrameRate=function(M){0>M||125<M?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<M?Math.floor(1e3/M):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return n(u)},t.unstable_next=function(M){switch(f){case 1:case 2:case 3:var P=3;break;default:P=f}var B=f;f=P;try{return M()}finally{f=B}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(M,P){switch(M){case 1:case 2:case 3:case 4:case 5:break;default:M=3}var B=f;f=M;try{return P()}finally{f=B}},t.unstable_scheduleCallback=function(M,P,B){var V=t.unstable_now();switch(typeof B=="object"&&B!==null?(B=B.delay,B=typeof B=="number"&&0<B?V+B:V):B=V,M){case 1:var K=-1;break;case 2:K=250;break;case 5:K=1073741823;break;case 4:K=1e4;break;default:K=5e3}return K=B+K,M={id:l++,callback:P,priorityLevel:M,startTime:B,expirationTime:K,sortIndex:-1},B>V?(M.sortIndex=B,e(c,M),n(u)===null&&M===n(c)&&(p?(v(k),k=-1):p=!0,U(b,B-V))):(M.sortIndex=K,e(u,M),m||h||(m=!0,j(E))),M},t.unstable_shouldYield=D,t.unstable_wrapCallback=function(M){var P=f;return function(){var B=f;f=P;try{return M.apply(this,arguments)}finally{f=B}}}})(x2);y2.exports=x2;var zN=y2.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var VN=C,On=zN;function Z(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var w2=new Set,Xu={};function ba(t,e){Fs(t,e),Fs(t+"Capture",e)}function Fs(t,e){for(Xu[t]=e,t=0;t<e.length;t++)w2.add(e[t])}var go=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),vm=Object.prototype.hasOwnProperty,HN=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,r1={},o1={};function GN(t){return vm.call(o1,t)?!0:vm.call(r1,t)?!1:HN.test(t)?o1[t]=!0:(r1[t]=!0,!1)}function KN(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function qN(t,e,n,r){if(e===null||typeof e>"u"||KN(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function sn(t,e,n,r,o,i,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=o,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=a}var Ut={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Ut[t]=new sn(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Ut[e]=new sn(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Ut[t]=new sn(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Ut[t]=new sn(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Ut[t]=new sn(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Ut[t]=new sn(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Ut[t]=new sn(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Ut[t]=new sn(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Ut[t]=new sn(t,5,!1,t.toLowerCase(),null,!1,!1)});var hg=/[\-:]([a-z])/g;function pg(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(hg,pg);Ut[e]=new sn(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(hg,pg);Ut[e]=new sn(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(hg,pg);Ut[e]=new sn(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Ut[t]=new sn(t,1,!1,t.toLowerCase(),null,!1,!1)});Ut.xlinkHref=new sn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Ut[t]=new sn(t,1,!1,t.toLowerCase(),null,!0,!0)});function mg(t,e,n,r){var o=Ut.hasOwnProperty(e)?Ut[e]:null;(o!==null?o.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(qN(e,n,o,r)&&(n=null),r||o===null?GN(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):o.mustUseProperty?t[o.propertyName]=n===null?o.type===3?!1:"":n:(e=o.attributeName,r=o.attributeNamespace,n===null?t.removeAttribute(e):(o=o.type,n=o===3||o===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var So=VN.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ml=Symbol.for("react.element"),qa=Symbol.for("react.portal"),Xa=Symbol.for("react.fragment"),vg=Symbol.for("react.strict_mode"),gm=Symbol.for("react.profiler"),b2=Symbol.for("react.provider"),E2=Symbol.for("react.context"),gg=Symbol.for("react.forward_ref"),ym=Symbol.for("react.suspense"),xm=Symbol.for("react.suspense_list"),yg=Symbol.for("react.memo"),Go=Symbol.for("react.lazy"),C2=Symbol.for("react.offscreen"),i1=Symbol.iterator;function fu(t){return t===null||typeof t!="object"?null:(t=i1&&t[i1]||t["@@iterator"],typeof t=="function"?t:null)}var it=Object.assign,Gh;function ku(t){if(Gh===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Gh=e&&e[1]||""}return`
`+Gh+t}var Kh=!1;function qh(t,e){if(!t||Kh)return"";Kh=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var r=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){r=c}t.call(e.prototype)}else{try{throw Error()}catch(c){r=c}t()}}catch(c){if(c&&r&&typeof c.stack=="string"){for(var o=c.stack.split(`
`),i=r.stack.split(`
`),a=o.length-1,s=i.length-1;1<=a&&0<=s&&o[a]!==i[s];)s--;for(;1<=a&&0<=s;a--,s--)if(o[a]!==i[s]){if(a!==1||s!==1)do if(a--,s--,0>s||o[a]!==i[s]){var u=`
`+o[a].replace(" at new "," at ");return t.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",t.displayName)),u}while(1<=a&&0<=s);break}}}finally{Kh=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?ku(t):""}function XN(t){switch(t.tag){case 5:return ku(t.type);case 16:return ku("Lazy");case 13:return ku("Suspense");case 19:return ku("SuspenseList");case 0:case 2:case 15:return t=qh(t.type,!1),t;case 11:return t=qh(t.type.render,!1),t;case 1:return t=qh(t.type,!0),t;default:return""}}function wm(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Xa:return"Fragment";case qa:return"Portal";case gm:return"Profiler";case vg:return"StrictMode";case ym:return"Suspense";case xm:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case E2:return(t.displayName||"Context")+".Consumer";case b2:return(t._context.displayName||"Context")+".Provider";case gg:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case yg:return e=t.displayName||null,e!==null?e:wm(t.type)||"Memo";case Go:e=t._payload,t=t._init;try{return wm(t(e))}catch{}}return null}function YN(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return wm(e);case 8:return e===vg?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function _i(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function _2(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function QN(t){var e=_2(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var o=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return o.call(this)},set:function(a){r=""+a,i.call(this,a)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(a){r=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function vl(t){t._valueTracker||(t._valueTracker=QN(t))}function S2(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=_2(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Sd(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function bm(t,e){var n=e.checked;return it({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function a1(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=_i(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function k2(t,e){e=e.checked,e!=null&&mg(t,"checked",e,!1)}function Em(t,e){k2(t,e);var n=_i(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Cm(t,e.type,n):e.hasOwnProperty("defaultValue")&&Cm(t,e.type,_i(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function s1(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Cm(t,e,n){(e!=="number"||Sd(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Iu=Array.isArray;function ss(t,e,n,r){if(t=t.options,e){e={};for(var o=0;o<n.length;o++)e["$"+n[o]]=!0;for(n=0;n<t.length;n++)o=e.hasOwnProperty("$"+t[n].value),t[n].selected!==o&&(t[n].selected=o),o&&r&&(t[n].defaultSelected=!0)}else{for(n=""+_i(n),e=null,o=0;o<t.length;o++){if(t[o].value===n){t[o].selected=!0,r&&(t[o].defaultSelected=!0);return}e!==null||t[o].disabled||(e=t[o])}e!==null&&(e.selected=!0)}}function _m(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Z(91));return it({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function u1(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(Z(92));if(Iu(n)){if(1<n.length)throw Error(Z(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:_i(n)}}function I2(t,e){var n=_i(e.value),r=_i(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function c1(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function R2(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Sm(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?R2(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var gl,T2=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,o){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,o)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(gl=gl||document.createElement("div"),gl.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=gl.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Yu(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Mu={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},JN=["Webkit","ms","Moz","O"];Object.keys(Mu).forEach(function(t){JN.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Mu[e]=Mu[t]})});function N2(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Mu.hasOwnProperty(t)&&Mu[t]?(""+e).trim():e+"px"}function A2(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,o=N2(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,o):t[n]=o}}var ZN=it({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function km(t,e){if(e){if(ZN[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Z(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Z(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Z(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Z(62))}}function Im(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Rm=null;function xg(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Tm=null,us=null,cs=null;function l1(t){if(t=Bc(t)){if(typeof Tm!="function")throw Error(Z(280));var e=t.stateNode;e&&(e=zf(e),Tm(t.stateNode,t.type,e))}}function P2(t){us?cs?cs.push(t):cs=[t]:us=t}function D2(){if(us){var t=us,e=cs;if(cs=us=null,l1(t),e)for(t=0;t<e.length;t++)l1(e[t])}}function M2(t,e){return t(e)}function O2(){}var Xh=!1;function F2(t,e,n){if(Xh)return t(e,n);Xh=!0;try{return M2(t,e,n)}finally{Xh=!1,(us!==null||cs!==null)&&(O2(),D2())}}function Qu(t,e){var n=t.stateNode;if(n===null)return null;var r=zf(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(Z(231,e,typeof n));return n}var Nm=!1;if(go)try{var hu={};Object.defineProperty(hu,"passive",{get:function(){Nm=!0}}),window.addEventListener("test",hu,hu),window.removeEventListener("test",hu,hu)}catch{Nm=!1}function eA(t,e,n,r,o,i,a,s,u){var c=Array.prototype.slice.call(arguments,3);try{e.apply(n,c)}catch(l){this.onError(l)}}var Ou=!1,kd=null,Id=!1,Am=null,tA={onError:function(t){Ou=!0,kd=t}};function nA(t,e,n,r,o,i,a,s,u){Ou=!1,kd=null,eA.apply(tA,arguments)}function rA(t,e,n,r,o,i,a,s,u){if(nA.apply(this,arguments),Ou){if(Ou){var c=kd;Ou=!1,kd=null}else throw Error(Z(198));Id||(Id=!0,Am=c)}}function Ea(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function L2(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function d1(t){if(Ea(t)!==t)throw Error(Z(188))}function oA(t){var e=t.alternate;if(!e){if(e=Ea(t),e===null)throw Error(Z(188));return e!==t?null:t}for(var n=t,r=e;;){var o=n.return;if(o===null)break;var i=o.alternate;if(i===null){if(r=o.return,r!==null){n=r;continue}break}if(o.child===i.child){for(i=o.child;i;){if(i===n)return d1(o),t;if(i===r)return d1(o),e;i=i.sibling}throw Error(Z(188))}if(n.return!==r.return)n=o,r=i;else{for(var a=!1,s=o.child;s;){if(s===n){a=!0,n=o,r=i;break}if(s===r){a=!0,r=o,n=i;break}s=s.sibling}if(!a){for(s=i.child;s;){if(s===n){a=!0,n=i,r=o;break}if(s===r){a=!0,r=i,n=o;break}s=s.sibling}if(!a)throw Error(Z(189))}}if(n.alternate!==r)throw Error(Z(190))}if(n.tag!==3)throw Error(Z(188));return n.stateNode.current===n?t:e}function B2(t){return t=oA(t),t!==null?j2(t):null}function j2(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=j2(t);if(e!==null)return e;t=t.sibling}return null}var U2=On.unstable_scheduleCallback,f1=On.unstable_cancelCallback,iA=On.unstable_shouldYield,aA=On.unstable_requestPaint,lt=On.unstable_now,sA=On.unstable_getCurrentPriorityLevel,wg=On.unstable_ImmediatePriority,W2=On.unstable_UserBlockingPriority,Rd=On.unstable_NormalPriority,uA=On.unstable_LowPriority,$2=On.unstable_IdlePriority,jf=null,Br=null;function cA(t){if(Br&&typeof Br.onCommitFiberRoot=="function")try{Br.onCommitFiberRoot(jf,t,void 0,(t.current.flags&128)===128)}catch{}}var hr=Math.clz32?Math.clz32:fA,lA=Math.log,dA=Math.LN2;function fA(t){return t>>>=0,t===0?32:31-(lA(t)/dA|0)|0}var yl=64,xl=4194304;function Ru(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Td(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,o=t.suspendedLanes,i=t.pingedLanes,a=n&268435455;if(a!==0){var s=a&~o;s!==0?r=Ru(s):(i&=a,i!==0&&(r=Ru(i)))}else a=n&~o,a!==0?r=Ru(a):i!==0&&(r=Ru(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&o)&&(o=r&-r,i=e&-e,o>=i||o===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-hr(e),o=1<<n,r|=t[n],e&=~o;return r}function hA(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function pA(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,o=t.expirationTimes,i=t.pendingLanes;0<i;){var a=31-hr(i),s=1<<a,u=o[a];u===-1?(!(s&n)||s&r)&&(o[a]=hA(s,e)):u<=e&&(t.expiredLanes|=s),i&=~s}}function Pm(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function z2(){var t=yl;return yl<<=1,!(yl&4194240)&&(yl=64),t}function Yh(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Fc(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-hr(e),t[e]=n}function mA(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var o=31-hr(n),i=1<<o;e[o]=0,r[o]=-1,t[o]=-1,n&=~i}}function bg(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-hr(n),o=1<<r;o&e|t[r]&e&&(t[r]|=e),n&=~o}}var ze=0;function V2(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var H2,Eg,G2,K2,q2,Dm=!1,wl=[],li=null,di=null,fi=null,Ju=new Map,Zu=new Map,qo=[],vA="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function h1(t,e){switch(t){case"focusin":case"focusout":li=null;break;case"dragenter":case"dragleave":di=null;break;case"mouseover":case"mouseout":fi=null;break;case"pointerover":case"pointerout":Ju.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Zu.delete(e.pointerId)}}function pu(t,e,n,r,o,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[o]},e!==null&&(e=Bc(e),e!==null&&Eg(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,o!==null&&e.indexOf(o)===-1&&e.push(o),t)}function gA(t,e,n,r,o){switch(e){case"focusin":return li=pu(li,t,e,n,r,o),!0;case"dragenter":return di=pu(di,t,e,n,r,o),!0;case"mouseover":return fi=pu(fi,t,e,n,r,o),!0;case"pointerover":var i=o.pointerId;return Ju.set(i,pu(Ju.get(i)||null,t,e,n,r,o)),!0;case"gotpointercapture":return i=o.pointerId,Zu.set(i,pu(Zu.get(i)||null,t,e,n,r,o)),!0}return!1}function X2(t){var e=Yi(t.target);if(e!==null){var n=Ea(e);if(n!==null){if(e=n.tag,e===13){if(e=L2(n),e!==null){t.blockedOn=e,q2(t.priority,function(){G2(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function id(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Mm(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Rm=r,n.target.dispatchEvent(r),Rm=null}else return e=Bc(n),e!==null&&Eg(e),t.blockedOn=n,!1;e.shift()}return!0}function p1(t,e,n){id(t)&&n.delete(e)}function yA(){Dm=!1,li!==null&&id(li)&&(li=null),di!==null&&id(di)&&(di=null),fi!==null&&id(fi)&&(fi=null),Ju.forEach(p1),Zu.forEach(p1)}function mu(t,e){t.blockedOn===e&&(t.blockedOn=null,Dm||(Dm=!0,On.unstable_scheduleCallback(On.unstable_NormalPriority,yA)))}function ec(t){function e(o){return mu(o,t)}if(0<wl.length){mu(wl[0],t);for(var n=1;n<wl.length;n++){var r=wl[n];r.blockedOn===t&&(r.blockedOn=null)}}for(li!==null&&mu(li,t),di!==null&&mu(di,t),fi!==null&&mu(fi,t),Ju.forEach(e),Zu.forEach(e),n=0;n<qo.length;n++)r=qo[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<qo.length&&(n=qo[0],n.blockedOn===null);)X2(n),n.blockedOn===null&&qo.shift()}var ls=So.ReactCurrentBatchConfig,Nd=!0;function xA(t,e,n,r){var o=ze,i=ls.transition;ls.transition=null;try{ze=1,Cg(t,e,n,r)}finally{ze=o,ls.transition=i}}function wA(t,e,n,r){var o=ze,i=ls.transition;ls.transition=null;try{ze=4,Cg(t,e,n,r)}finally{ze=o,ls.transition=i}}function Cg(t,e,n,r){if(Nd){var o=Mm(t,e,n,r);if(o===null)ap(t,e,r,Ad,n),h1(t,r);else if(gA(o,t,e,n,r))r.stopPropagation();else if(h1(t,r),e&4&&-1<vA.indexOf(t)){for(;o!==null;){var i=Bc(o);if(i!==null&&H2(i),i=Mm(t,e,n,r),i===null&&ap(t,e,r,Ad,n),i===o)break;o=i}o!==null&&r.stopPropagation()}else ap(t,e,r,null,n)}}var Ad=null;function Mm(t,e,n,r){if(Ad=null,t=xg(r),t=Yi(t),t!==null)if(e=Ea(t),e===null)t=null;else if(n=e.tag,n===13){if(t=L2(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Ad=t,null}function Y2(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(sA()){case wg:return 1;case W2:return 4;case Rd:case uA:return 16;case $2:return 536870912;default:return 16}default:return 16}}var ii=null,_g=null,ad=null;function Q2(){if(ad)return ad;var t,e=_g,n=e.length,r,o="value"in ii?ii.value:ii.textContent,i=o.length;for(t=0;t<n&&e[t]===o[t];t++);var a=n-t;for(r=1;r<=a&&e[n-r]===o[i-r];r++);return ad=o.slice(t,1<r?1-r:void 0)}function sd(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function bl(){return!0}function m1(){return!1}function Ln(t){function e(n,r,o,i,a){this._reactName=n,this._targetInst=o,this.type=r,this.nativeEvent=i,this.target=a,this.currentTarget=null;for(var s in t)t.hasOwnProperty(s)&&(n=t[s],this[s]=n?n(i):i[s]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?bl:m1,this.isPropagationStopped=m1,this}return it(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=bl)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=bl)},persist:function(){},isPersistent:bl}),e}var ru={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Sg=Ln(ru),Lc=it({},ru,{view:0,detail:0}),bA=Ln(Lc),Qh,Jh,vu,Uf=it({},Lc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:kg,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==vu&&(vu&&t.type==="mousemove"?(Qh=t.screenX-vu.screenX,Jh=t.screenY-vu.screenY):Jh=Qh=0,vu=t),Qh)},movementY:function(t){return"movementY"in t?t.movementY:Jh}}),v1=Ln(Uf),EA=it({},Uf,{dataTransfer:0}),CA=Ln(EA),_A=it({},Lc,{relatedTarget:0}),Zh=Ln(_A),SA=it({},ru,{animationName:0,elapsedTime:0,pseudoElement:0}),kA=Ln(SA),IA=it({},ru,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),RA=Ln(IA),TA=it({},ru,{data:0}),g1=Ln(TA),NA={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},AA={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},PA={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function DA(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=PA[t])?!!e[t]:!1}function kg(){return DA}var MA=it({},Lc,{key:function(t){if(t.key){var e=NA[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=sd(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?AA[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:kg,charCode:function(t){return t.type==="keypress"?sd(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?sd(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),OA=Ln(MA),FA=it({},Uf,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),y1=Ln(FA),LA=it({},Lc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:kg}),BA=Ln(LA),jA=it({},ru,{propertyName:0,elapsedTime:0,pseudoElement:0}),UA=Ln(jA),WA=it({},Uf,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),$A=Ln(WA),zA=[9,13,27,32],Ig=go&&"CompositionEvent"in window,Fu=null;go&&"documentMode"in document&&(Fu=document.documentMode);var VA=go&&"TextEvent"in window&&!Fu,J2=go&&(!Ig||Fu&&8<Fu&&11>=Fu),x1=" ",w1=!1;function Z2(t,e){switch(t){case"keyup":return zA.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function eE(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Ya=!1;function HA(t,e){switch(t){case"compositionend":return eE(e);case"keypress":return e.which!==32?null:(w1=!0,x1);case"textInput":return t=e.data,t===x1&&w1?null:t;default:return null}}function GA(t,e){if(Ya)return t==="compositionend"||!Ig&&Z2(t,e)?(t=Q2(),ad=_g=ii=null,Ya=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return J2&&e.locale!=="ko"?null:e.data;default:return null}}var KA={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function b1(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!KA[t.type]:e==="textarea"}function tE(t,e,n,r){P2(r),e=Pd(e,"onChange"),0<e.length&&(n=new Sg("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Lu=null,tc=null;function qA(t){fE(t,0)}function Wf(t){var e=Za(t);if(S2(e))return t}function XA(t,e){if(t==="change")return e}var nE=!1;if(go){var ep;if(go){var tp="oninput"in document;if(!tp){var E1=document.createElement("div");E1.setAttribute("oninput","return;"),tp=typeof E1.oninput=="function"}ep=tp}else ep=!1;nE=ep&&(!document.documentMode||9<document.documentMode)}function C1(){Lu&&(Lu.detachEvent("onpropertychange",rE),tc=Lu=null)}function rE(t){if(t.propertyName==="value"&&Wf(tc)){var e=[];tE(e,tc,t,xg(t)),F2(qA,e)}}function YA(t,e,n){t==="focusin"?(C1(),Lu=e,tc=n,Lu.attachEvent("onpropertychange",rE)):t==="focusout"&&C1()}function QA(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Wf(tc)}function JA(t,e){if(t==="click")return Wf(e)}function ZA(t,e){if(t==="input"||t==="change")return Wf(e)}function eP(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var vr=typeof Object.is=="function"?Object.is:eP;function nc(t,e){if(vr(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var o=n[r];if(!vm.call(e,o)||!vr(t[o],e[o]))return!1}return!0}function _1(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function S1(t,e){var n=_1(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=_1(n)}}function oE(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?oE(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function iE(){for(var t=window,e=Sd();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Sd(t.document)}return e}function Rg(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function tP(t){var e=iE(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&oE(n.ownerDocument.documentElement,n)){if(r!==null&&Rg(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var o=n.textContent.length,i=Math.min(r.start,o);r=r.end===void 0?i:Math.min(r.end,o),!t.extend&&i>r&&(o=r,r=i,i=o),o=S1(n,i);var a=S1(n,r);o&&a&&(t.rangeCount!==1||t.anchorNode!==o.node||t.anchorOffset!==o.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(o.node,o.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var nP=go&&"documentMode"in document&&11>=document.documentMode,Qa=null,Om=null,Bu=null,Fm=!1;function k1(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Fm||Qa==null||Qa!==Sd(r)||(r=Qa,"selectionStart"in r&&Rg(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Bu&&nc(Bu,r)||(Bu=r,r=Pd(Om,"onSelect"),0<r.length&&(e=new Sg("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Qa)))}function El(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Ja={animationend:El("Animation","AnimationEnd"),animationiteration:El("Animation","AnimationIteration"),animationstart:El("Animation","AnimationStart"),transitionend:El("Transition","TransitionEnd")},np={},aE={};go&&(aE=document.createElement("div").style,"AnimationEvent"in window||(delete Ja.animationend.animation,delete Ja.animationiteration.animation,delete Ja.animationstart.animation),"TransitionEvent"in window||delete Ja.transitionend.transition);function $f(t){if(np[t])return np[t];if(!Ja[t])return t;var e=Ja[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in aE)return np[t]=e[n];return t}var sE=$f("animationend"),uE=$f("animationiteration"),cE=$f("animationstart"),lE=$f("transitionend"),dE=new Map,I1="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ni(t,e){dE.set(t,e),ba(e,[t])}for(var rp=0;rp<I1.length;rp++){var op=I1[rp],rP=op.toLowerCase(),oP=op[0].toUpperCase()+op.slice(1);Ni(rP,"on"+oP)}Ni(sE,"onAnimationEnd");Ni(uE,"onAnimationIteration");Ni(cE,"onAnimationStart");Ni("dblclick","onDoubleClick");Ni("focusin","onFocus");Ni("focusout","onBlur");Ni(lE,"onTransitionEnd");Fs("onMouseEnter",["mouseout","mouseover"]);Fs("onMouseLeave",["mouseout","mouseover"]);Fs("onPointerEnter",["pointerout","pointerover"]);Fs("onPointerLeave",["pointerout","pointerover"]);ba("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ba("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ba("onBeforeInput",["compositionend","keypress","textInput","paste"]);ba("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ba("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ba("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Tu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),iP=new Set("cancel close invalid load scroll toggle".split(" ").concat(Tu));function R1(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,rA(r,e,void 0,t),t.currentTarget=null}function fE(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],o=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var a=r.length-1;0<=a;a--){var s=r[a],u=s.instance,c=s.currentTarget;if(s=s.listener,u!==i&&o.isPropagationStopped())break e;R1(o,s,c),i=u}else for(a=0;a<r.length;a++){if(s=r[a],u=s.instance,c=s.currentTarget,s=s.listener,u!==i&&o.isPropagationStopped())break e;R1(o,s,c),i=u}}}if(Id)throw t=Am,Id=!1,Am=null,t}function Xe(t,e){var n=e[Wm];n===void 0&&(n=e[Wm]=new Set);var r=t+"__bubble";n.has(r)||(hE(e,t,2,!1),n.add(r))}function ip(t,e,n){var r=0;e&&(r|=4),hE(n,t,r,e)}var Cl="_reactListening"+Math.random().toString(36).slice(2);function rc(t){if(!t[Cl]){t[Cl]=!0,w2.forEach(function(n){n!=="selectionchange"&&(iP.has(n)||ip(n,!1,t),ip(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Cl]||(e[Cl]=!0,ip("selectionchange",!1,e))}}function hE(t,e,n,r){switch(Y2(e)){case 1:var o=xA;break;case 4:o=wA;break;default:o=Cg}n=o.bind(null,e,n,t),o=void 0,!Nm||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(o=!0),r?o!==void 0?t.addEventListener(e,n,{capture:!0,passive:o}):t.addEventListener(e,n,!0):o!==void 0?t.addEventListener(e,n,{passive:o}):t.addEventListener(e,n,!1)}function ap(t,e,n,r,o){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var a=r.tag;if(a===3||a===4){var s=r.stateNode.containerInfo;if(s===o||s.nodeType===8&&s.parentNode===o)break;if(a===4)for(a=r.return;a!==null;){var u=a.tag;if((u===3||u===4)&&(u=a.stateNode.containerInfo,u===o||u.nodeType===8&&u.parentNode===o))return;a=a.return}for(;s!==null;){if(a=Yi(s),a===null)return;if(u=a.tag,u===5||u===6){r=i=a;continue e}s=s.parentNode}}r=r.return}F2(function(){var c=i,l=xg(n),d=[];e:{var f=dE.get(t);if(f!==void 0){var h=Sg,m=t;switch(t){case"keypress":if(sd(n)===0)break e;case"keydown":case"keyup":h=OA;break;case"focusin":m="focus",h=Zh;break;case"focusout":m="blur",h=Zh;break;case"beforeblur":case"afterblur":h=Zh;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=v1;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=CA;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=BA;break;case sE:case uE:case cE:h=kA;break;case lE:h=UA;break;case"scroll":h=bA;break;case"wheel":h=$A;break;case"copy":case"cut":case"paste":h=RA;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=y1}var p=(e&4)!==0,g=!p&&t==="scroll",v=p?f!==null?f+"Capture":null:f;p=[];for(var y=c,x;y!==null;){x=y;var b=x.stateNode;if(x.tag===5&&b!==null&&(x=b,v!==null&&(b=Qu(y,v),b!=null&&p.push(oc(y,b,x)))),g)break;y=y.return}0<p.length&&(f=new h(f,m,null,n,l),d.push({event:f,listeners:p}))}}if(!(e&7)){e:{if(f=t==="mouseover"||t==="pointerover",h=t==="mouseout"||t==="pointerout",f&&n!==Rm&&(m=n.relatedTarget||n.fromElement)&&(Yi(m)||m[yo]))break e;if((h||f)&&(f=l.window===l?l:(f=l.ownerDocument)?f.defaultView||f.parentWindow:window,h?(m=n.relatedTarget||n.toElement,h=c,m=m?Yi(m):null,m!==null&&(g=Ea(m),m!==g||m.tag!==5&&m.tag!==6)&&(m=null)):(h=null,m=c),h!==m)){if(p=v1,b="onMouseLeave",v="onMouseEnter",y="mouse",(t==="pointerout"||t==="pointerover")&&(p=y1,b="onPointerLeave",v="onPointerEnter",y="pointer"),g=h==null?f:Za(h),x=m==null?f:Za(m),f=new p(b,y+"leave",h,n,l),f.target=g,f.relatedTarget=x,b=null,Yi(l)===c&&(p=new p(v,y+"enter",m,n,l),p.target=x,p.relatedTarget=g,b=p),g=b,h&&m)t:{for(p=h,v=m,y=0,x=p;x;x=Fa(x))y++;for(x=0,b=v;b;b=Fa(b))x++;for(;0<y-x;)p=Fa(p),y--;for(;0<x-y;)v=Fa(v),x--;for(;y--;){if(p===v||v!==null&&p===v.alternate)break t;p=Fa(p),v=Fa(v)}p=null}else p=null;h!==null&&T1(d,f,h,p,!1),m!==null&&g!==null&&T1(d,g,m,p,!0)}}e:{if(f=c?Za(c):window,h=f.nodeName&&f.nodeName.toLowerCase(),h==="select"||h==="input"&&f.type==="file")var E=XA;else if(b1(f))if(nE)E=ZA;else{E=QA;var _=YA}else(h=f.nodeName)&&h.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(E=JA);if(E&&(E=E(t,c))){tE(d,E,n,l);break e}_&&_(t,f,c),t==="focusout"&&(_=f._wrapperState)&&_.controlled&&f.type==="number"&&Cm(f,"number",f.value)}switch(_=c?Za(c):window,t){case"focusin":(b1(_)||_.contentEditable==="true")&&(Qa=_,Om=c,Bu=null);break;case"focusout":Bu=Om=Qa=null;break;case"mousedown":Fm=!0;break;case"contextmenu":case"mouseup":case"dragend":Fm=!1,k1(d,n,l);break;case"selectionchange":if(nP)break;case"keydown":case"keyup":k1(d,n,l)}var S;if(Ig)e:{switch(t){case"compositionstart":var k="onCompositionStart";break e;case"compositionend":k="onCompositionEnd";break e;case"compositionupdate":k="onCompositionUpdate";break e}k=void 0}else Ya?Z2(t,n)&&(k="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(k="onCompositionStart");k&&(J2&&n.locale!=="ko"&&(Ya||k!=="onCompositionStart"?k==="onCompositionEnd"&&Ya&&(S=Q2()):(ii=l,_g="value"in ii?ii.value:ii.textContent,Ya=!0)),_=Pd(c,k),0<_.length&&(k=new g1(k,t,null,n,l),d.push({event:k,listeners:_}),S?k.data=S:(S=eE(n),S!==null&&(k.data=S)))),(S=VA?HA(t,n):GA(t,n))&&(c=Pd(c,"onBeforeInput"),0<c.length&&(l=new g1("onBeforeInput","beforeinput",null,n,l),d.push({event:l,listeners:c}),l.data=S))}fE(d,e)})}function oc(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Pd(t,e){for(var n=e+"Capture",r=[];t!==null;){var o=t,i=o.stateNode;o.tag===5&&i!==null&&(o=i,i=Qu(t,n),i!=null&&r.unshift(oc(t,i,o)),i=Qu(t,e),i!=null&&r.push(oc(t,i,o))),t=t.return}return r}function Fa(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function T1(t,e,n,r,o){for(var i=e._reactName,a=[];n!==null&&n!==r;){var s=n,u=s.alternate,c=s.stateNode;if(u!==null&&u===r)break;s.tag===5&&c!==null&&(s=c,o?(u=Qu(n,i),u!=null&&a.unshift(oc(n,u,s))):o||(u=Qu(n,i),u!=null&&a.push(oc(n,u,s)))),n=n.return}a.length!==0&&t.push({event:e,listeners:a})}var aP=/\r\n?/g,sP=/\u0000|\uFFFD/g;function N1(t){return(typeof t=="string"?t:""+t).replace(aP,`
`).replace(sP,"")}function _l(t,e,n){if(e=N1(e),N1(t)!==e&&n)throw Error(Z(425))}function Dd(){}var Lm=null,Bm=null;function jm(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Um=typeof setTimeout=="function"?setTimeout:void 0,uP=typeof clearTimeout=="function"?clearTimeout:void 0,A1=typeof Promise=="function"?Promise:void 0,cP=typeof queueMicrotask=="function"?queueMicrotask:typeof A1<"u"?function(t){return A1.resolve(null).then(t).catch(lP)}:Um;function lP(t){setTimeout(function(){throw t})}function sp(t,e){var n=e,r=0;do{var o=n.nextSibling;if(t.removeChild(n),o&&o.nodeType===8)if(n=o.data,n==="/$"){if(r===0){t.removeChild(o),ec(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=o}while(n);ec(e)}function hi(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function P1(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var ou=Math.random().toString(36).slice(2),Pr="__reactFiber$"+ou,ic="__reactProps$"+ou,yo="__reactContainer$"+ou,Wm="__reactEvents$"+ou,dP="__reactListeners$"+ou,fP="__reactHandles$"+ou;function Yi(t){var e=t[Pr];if(e)return e;for(var n=t.parentNode;n;){if(e=n[yo]||n[Pr]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=P1(t);t!==null;){if(n=t[Pr])return n;t=P1(t)}return e}t=n,n=t.parentNode}return null}function Bc(t){return t=t[Pr]||t[yo],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Za(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Z(33))}function zf(t){return t[ic]||null}var $m=[],es=-1;function Ai(t){return{current:t}}function Qe(t){0>es||(t.current=$m[es],$m[es]=null,es--)}function Ge(t,e){es++,$m[es]=t.current,t.current=e}var Si={},Qt=Ai(Si),vn=Ai(!1),la=Si;function Ls(t,e){var n=t.type.contextTypes;if(!n)return Si;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var o={},i;for(i in n)o[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=o),o}function gn(t){return t=t.childContextTypes,t!=null}function Md(){Qe(vn),Qe(Qt)}function D1(t,e,n){if(Qt.current!==Si)throw Error(Z(168));Ge(Qt,e),Ge(vn,n)}function pE(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var o in r)if(!(o in e))throw Error(Z(108,YN(t)||"Unknown",o));return it({},n,r)}function Od(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Si,la=Qt.current,Ge(Qt,t),Ge(vn,vn.current),!0}function M1(t,e,n){var r=t.stateNode;if(!r)throw Error(Z(169));n?(t=pE(t,e,la),r.__reactInternalMemoizedMergedChildContext=t,Qe(vn),Qe(Qt),Ge(Qt,t)):Qe(vn),Ge(vn,n)}var ao=null,Vf=!1,up=!1;function mE(t){ao===null?ao=[t]:ao.push(t)}function hP(t){Vf=!0,mE(t)}function Pi(){if(!up&&ao!==null){up=!0;var t=0,e=ze;try{var n=ao;for(ze=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}ao=null,Vf=!1}catch(o){throw ao!==null&&(ao=ao.slice(t+1)),U2(wg,Pi),o}finally{ze=e,up=!1}}return null}var ts=[],ns=0,Fd=null,Ld=0,jn=[],Un=0,da=null,lo=1,fo="";function $i(t,e){ts[ns++]=Ld,ts[ns++]=Fd,Fd=t,Ld=e}function vE(t,e,n){jn[Un++]=lo,jn[Un++]=fo,jn[Un++]=da,da=t;var r=lo;t=fo;var o=32-hr(r)-1;r&=~(1<<o),n+=1;var i=32-hr(e)+o;if(30<i){var a=o-o%5;i=(r&(1<<a)-1).toString(32),r>>=a,o-=a,lo=1<<32-hr(e)+o|n<<o|r,fo=i+t}else lo=1<<i|n<<o|r,fo=t}function Tg(t){t.return!==null&&($i(t,1),vE(t,1,0))}function Ng(t){for(;t===Fd;)Fd=ts[--ns],ts[ns]=null,Ld=ts[--ns],ts[ns]=null;for(;t===da;)da=jn[--Un],jn[Un]=null,fo=jn[--Un],jn[Un]=null,lo=jn[--Un],jn[Un]=null}var Pn=null,In=null,Ze=!1,ur=null;function gE(t,e){var n=zn(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function O1(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Pn=t,In=hi(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Pn=t,In=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=da!==null?{id:lo,overflow:fo}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=zn(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Pn=t,In=null,!0):!1;default:return!1}}function zm(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Vm(t){if(Ze){var e=In;if(e){var n=e;if(!O1(t,e)){if(zm(t))throw Error(Z(418));e=hi(n.nextSibling);var r=Pn;e&&O1(t,e)?gE(r,n):(t.flags=t.flags&-4097|2,Ze=!1,Pn=t)}}else{if(zm(t))throw Error(Z(418));t.flags=t.flags&-4097|2,Ze=!1,Pn=t}}}function F1(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Pn=t}function Sl(t){if(t!==Pn)return!1;if(!Ze)return F1(t),Ze=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!jm(t.type,t.memoizedProps)),e&&(e=In)){if(zm(t))throw yE(),Error(Z(418));for(;e;)gE(t,e),e=hi(e.nextSibling)}if(F1(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Z(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){In=hi(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}In=null}}else In=Pn?hi(t.stateNode.nextSibling):null;return!0}function yE(){for(var t=In;t;)t=hi(t.nextSibling)}function Bs(){In=Pn=null,Ze=!1}function Ag(t){ur===null?ur=[t]:ur.push(t)}var pP=So.ReactCurrentBatchConfig;function gu(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(Z(309));var r=n.stateNode}if(!r)throw Error(Z(147,t));var o=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(a){var s=o.refs;a===null?delete s[i]:s[i]=a},e._stringRef=i,e)}if(typeof t!="string")throw Error(Z(284));if(!n._owner)throw Error(Z(290,t))}return t}function kl(t,e){throw t=Object.prototype.toString.call(e),Error(Z(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function L1(t){var e=t._init;return e(t._payload)}function xE(t){function e(v,y){if(t){var x=v.deletions;x===null?(v.deletions=[y],v.flags|=16):x.push(y)}}function n(v,y){if(!t)return null;for(;y!==null;)e(v,y),y=y.sibling;return null}function r(v,y){for(v=new Map;y!==null;)y.key!==null?v.set(y.key,y):v.set(y.index,y),y=y.sibling;return v}function o(v,y){return v=gi(v,y),v.index=0,v.sibling=null,v}function i(v,y,x){return v.index=x,t?(x=v.alternate,x!==null?(x=x.index,x<y?(v.flags|=2,y):x):(v.flags|=2,y)):(v.flags|=1048576,y)}function a(v){return t&&v.alternate===null&&(v.flags|=2),v}function s(v,y,x,b){return y===null||y.tag!==6?(y=mp(x,v.mode,b),y.return=v,y):(y=o(y,x),y.return=v,y)}function u(v,y,x,b){var E=x.type;return E===Xa?l(v,y,x.props.children,b,x.key):y!==null&&(y.elementType===E||typeof E=="object"&&E!==null&&E.$$typeof===Go&&L1(E)===y.type)?(b=o(y,x.props),b.ref=gu(v,y,x),b.return=v,b):(b=pd(x.type,x.key,x.props,null,v.mode,b),b.ref=gu(v,y,x),b.return=v,b)}function c(v,y,x,b){return y===null||y.tag!==4||y.stateNode.containerInfo!==x.containerInfo||y.stateNode.implementation!==x.implementation?(y=vp(x,v.mode,b),y.return=v,y):(y=o(y,x.children||[]),y.return=v,y)}function l(v,y,x,b,E){return y===null||y.tag!==7?(y=ua(x,v.mode,b,E),y.return=v,y):(y=o(y,x),y.return=v,y)}function d(v,y,x){if(typeof y=="string"&&y!==""||typeof y=="number")return y=mp(""+y,v.mode,x),y.return=v,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case ml:return x=pd(y.type,y.key,y.props,null,v.mode,x),x.ref=gu(v,null,y),x.return=v,x;case qa:return y=vp(y,v.mode,x),y.return=v,y;case Go:var b=y._init;return d(v,b(y._payload),x)}if(Iu(y)||fu(y))return y=ua(y,v.mode,x,null),y.return=v,y;kl(v,y)}return null}function f(v,y,x,b){var E=y!==null?y.key:null;if(typeof x=="string"&&x!==""||typeof x=="number")return E!==null?null:s(v,y,""+x,b);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case ml:return x.key===E?u(v,y,x,b):null;case qa:return x.key===E?c(v,y,x,b):null;case Go:return E=x._init,f(v,y,E(x._payload),b)}if(Iu(x)||fu(x))return E!==null?null:l(v,y,x,b,null);kl(v,x)}return null}function h(v,y,x,b,E){if(typeof b=="string"&&b!==""||typeof b=="number")return v=v.get(x)||null,s(y,v,""+b,E);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case ml:return v=v.get(b.key===null?x:b.key)||null,u(y,v,b,E);case qa:return v=v.get(b.key===null?x:b.key)||null,c(y,v,b,E);case Go:var _=b._init;return h(v,y,x,_(b._payload),E)}if(Iu(b)||fu(b))return v=v.get(x)||null,l(y,v,b,E,null);kl(y,b)}return null}function m(v,y,x,b){for(var E=null,_=null,S=y,k=y=0,R=null;S!==null&&k<x.length;k++){S.index>k?(R=S,S=null):R=S.sibling;var I=f(v,S,x[k],b);if(I===null){S===null&&(S=R);break}t&&S&&I.alternate===null&&e(v,S),y=i(I,y,k),_===null?E=I:_.sibling=I,_=I,S=R}if(k===x.length)return n(v,S),Ze&&$i(v,k),E;if(S===null){for(;k<x.length;k++)S=d(v,x[k],b),S!==null&&(y=i(S,y,k),_===null?E=S:_.sibling=S,_=S);return Ze&&$i(v,k),E}for(S=r(v,S);k<x.length;k++)R=h(S,v,k,x[k],b),R!==null&&(t&&R.alternate!==null&&S.delete(R.key===null?k:R.key),y=i(R,y,k),_===null?E=R:_.sibling=R,_=R);return t&&S.forEach(function(D){return e(v,D)}),Ze&&$i(v,k),E}function p(v,y,x,b){var E=fu(x);if(typeof E!="function")throw Error(Z(150));if(x=E.call(x),x==null)throw Error(Z(151));for(var _=E=null,S=y,k=y=0,R=null,I=x.next();S!==null&&!I.done;k++,I=x.next()){S.index>k?(R=S,S=null):R=S.sibling;var D=f(v,S,I.value,b);if(D===null){S===null&&(S=R);break}t&&S&&D.alternate===null&&e(v,S),y=i(D,y,k),_===null?E=D:_.sibling=D,_=D,S=R}if(I.done)return n(v,S),Ze&&$i(v,k),E;if(S===null){for(;!I.done;k++,I=x.next())I=d(v,I.value,b),I!==null&&(y=i(I,y,k),_===null?E=I:_.sibling=I,_=I);return Ze&&$i(v,k),E}for(S=r(v,S);!I.done;k++,I=x.next())I=h(S,v,k,I.value,b),I!==null&&(t&&I.alternate!==null&&S.delete(I.key===null?k:I.key),y=i(I,y,k),_===null?E=I:_.sibling=I,_=I);return t&&S.forEach(function(A){return e(v,A)}),Ze&&$i(v,k),E}function g(v,y,x,b){if(typeof x=="object"&&x!==null&&x.type===Xa&&x.key===null&&(x=x.props.children),typeof x=="object"&&x!==null){switch(x.$$typeof){case ml:e:{for(var E=x.key,_=y;_!==null;){if(_.key===E){if(E=x.type,E===Xa){if(_.tag===7){n(v,_.sibling),y=o(_,x.props.children),y.return=v,v=y;break e}}else if(_.elementType===E||typeof E=="object"&&E!==null&&E.$$typeof===Go&&L1(E)===_.type){n(v,_.sibling),y=o(_,x.props),y.ref=gu(v,_,x),y.return=v,v=y;break e}n(v,_);break}else e(v,_);_=_.sibling}x.type===Xa?(y=ua(x.props.children,v.mode,b,x.key),y.return=v,v=y):(b=pd(x.type,x.key,x.props,null,v.mode,b),b.ref=gu(v,y,x),b.return=v,v=b)}return a(v);case qa:e:{for(_=x.key;y!==null;){if(y.key===_)if(y.tag===4&&y.stateNode.containerInfo===x.containerInfo&&y.stateNode.implementation===x.implementation){n(v,y.sibling),y=o(y,x.children||[]),y.return=v,v=y;break e}else{n(v,y);break}else e(v,y);y=y.sibling}y=vp(x,v.mode,b),y.return=v,v=y}return a(v);case Go:return _=x._init,g(v,y,_(x._payload),b)}if(Iu(x))return m(v,y,x,b);if(fu(x))return p(v,y,x,b);kl(v,x)}return typeof x=="string"&&x!==""||typeof x=="number"?(x=""+x,y!==null&&y.tag===6?(n(v,y.sibling),y=o(y,x),y.return=v,v=y):(n(v,y),y=mp(x,v.mode,b),y.return=v,v=y),a(v)):n(v,y)}return g}var js=xE(!0),wE=xE(!1),Bd=Ai(null),jd=null,rs=null,Pg=null;function Dg(){Pg=rs=jd=null}function Mg(t){var e=Bd.current;Qe(Bd),t._currentValue=e}function Hm(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function ds(t,e){jd=t,Pg=rs=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(mn=!0),t.firstContext=null)}function Kn(t){var e=t._currentValue;if(Pg!==t)if(t={context:t,memoizedValue:e,next:null},rs===null){if(jd===null)throw Error(Z(308));rs=t,jd.dependencies={lanes:0,firstContext:t}}else rs=rs.next=t;return e}var Qi=null;function Og(t){Qi===null?Qi=[t]:Qi.push(t)}function bE(t,e,n,r){var o=e.interleaved;return o===null?(n.next=n,Og(e)):(n.next=o.next,o.next=n),e.interleaved=n,xo(t,r)}function xo(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Ko=!1;function Fg(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function EE(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function mo(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function pi(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Le&2){var o=r.pending;return o===null?e.next=e:(e.next=o.next,o.next=e),r.pending=e,xo(t,n)}return o=r.interleaved,o===null?(e.next=e,Og(r)):(e.next=o.next,o.next=e),r.interleaved=e,xo(t,n)}function ud(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,bg(t,n)}}function B1(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var o=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?o=i=a:i=i.next=a,n=n.next}while(n!==null);i===null?o=i=e:i=i.next=e}else o=i=e;n={baseState:r.baseState,firstBaseUpdate:o,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Ud(t,e,n,r){var o=t.updateQueue;Ko=!1;var i=o.firstBaseUpdate,a=o.lastBaseUpdate,s=o.shared.pending;if(s!==null){o.shared.pending=null;var u=s,c=u.next;u.next=null,a===null?i=c:a.next=c,a=u;var l=t.alternate;l!==null&&(l=l.updateQueue,s=l.lastBaseUpdate,s!==a&&(s===null?l.firstBaseUpdate=c:s.next=c,l.lastBaseUpdate=u))}if(i!==null){var d=o.baseState;a=0,l=c=u=null,s=i;do{var f=s.lane,h=s.eventTime;if((r&f)===f){l!==null&&(l=l.next={eventTime:h,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var m=t,p=s;switch(f=e,h=n,p.tag){case 1:if(m=p.payload,typeof m=="function"){d=m.call(h,d,f);break e}d=m;break e;case 3:m.flags=m.flags&-65537|128;case 0:if(m=p.payload,f=typeof m=="function"?m.call(h,d,f):m,f==null)break e;d=it({},d,f);break e;case 2:Ko=!0}}s.callback!==null&&s.lane!==0&&(t.flags|=64,f=o.effects,f===null?o.effects=[s]:f.push(s))}else h={eventTime:h,lane:f,tag:s.tag,payload:s.payload,callback:s.callback,next:null},l===null?(c=l=h,u=d):l=l.next=h,a|=f;if(s=s.next,s===null){if(s=o.shared.pending,s===null)break;f=s,s=f.next,f.next=null,o.lastBaseUpdate=f,o.shared.pending=null}}while(!0);if(l===null&&(u=d),o.baseState=u,o.firstBaseUpdate=c,o.lastBaseUpdate=l,e=o.shared.interleaved,e!==null){o=e;do a|=o.lane,o=o.next;while(o!==e)}else i===null&&(o.shared.lanes=0);ha|=a,t.lanes=a,t.memoizedState=d}}function j1(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],o=r.callback;if(o!==null){if(r.callback=null,r=n,typeof o!="function")throw Error(Z(191,o));o.call(r)}}}var jc={},jr=Ai(jc),ac=Ai(jc),sc=Ai(jc);function Ji(t){if(t===jc)throw Error(Z(174));return t}function Lg(t,e){switch(Ge(sc,e),Ge(ac,t),Ge(jr,jc),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Sm(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Sm(e,t)}Qe(jr),Ge(jr,e)}function Us(){Qe(jr),Qe(ac),Qe(sc)}function CE(t){Ji(sc.current);var e=Ji(jr.current),n=Sm(e,t.type);e!==n&&(Ge(ac,t),Ge(jr,n))}function Bg(t){ac.current===t&&(Qe(jr),Qe(ac))}var tt=Ai(0);function Wd(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var cp=[];function jg(){for(var t=0;t<cp.length;t++)cp[t]._workInProgressVersionPrimary=null;cp.length=0}var cd=So.ReactCurrentDispatcher,lp=So.ReactCurrentBatchConfig,fa=0,ot=null,yt=null,Tt=null,$d=!1,ju=!1,uc=0,mP=0;function $t(){throw Error(Z(321))}function Ug(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!vr(t[n],e[n]))return!1;return!0}function Wg(t,e,n,r,o,i){if(fa=i,ot=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,cd.current=t===null||t.memoizedState===null?xP:wP,t=n(r,o),ju){i=0;do{if(ju=!1,uc=0,25<=i)throw Error(Z(301));i+=1,Tt=yt=null,e.updateQueue=null,cd.current=bP,t=n(r,o)}while(ju)}if(cd.current=zd,e=yt!==null&&yt.next!==null,fa=0,Tt=yt=ot=null,$d=!1,e)throw Error(Z(300));return t}function $g(){var t=uc!==0;return uc=0,t}function kr(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Tt===null?ot.memoizedState=Tt=t:Tt=Tt.next=t,Tt}function qn(){if(yt===null){var t=ot.alternate;t=t!==null?t.memoizedState:null}else t=yt.next;var e=Tt===null?ot.memoizedState:Tt.next;if(e!==null)Tt=e,yt=t;else{if(t===null)throw Error(Z(310));yt=t,t={memoizedState:yt.memoizedState,baseState:yt.baseState,baseQueue:yt.baseQueue,queue:yt.queue,next:null},Tt===null?ot.memoizedState=Tt=t:Tt=Tt.next=t}return Tt}function cc(t,e){return typeof e=="function"?e(t):e}function dp(t){var e=qn(),n=e.queue;if(n===null)throw Error(Z(311));n.lastRenderedReducer=t;var r=yt,o=r.baseQueue,i=n.pending;if(i!==null){if(o!==null){var a=o.next;o.next=i.next,i.next=a}r.baseQueue=o=i,n.pending=null}if(o!==null){i=o.next,r=r.baseState;var s=a=null,u=null,c=i;do{var l=c.lane;if((fa&l)===l)u!==null&&(u=u.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:t(r,c.action);else{var d={lane:l,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};u===null?(s=u=d,a=r):u=u.next=d,ot.lanes|=l,ha|=l}c=c.next}while(c!==null&&c!==i);u===null?a=r:u.next=s,vr(r,e.memoizedState)||(mn=!0),e.memoizedState=r,e.baseState=a,e.baseQueue=u,n.lastRenderedState=r}if(t=n.interleaved,t!==null){o=t;do i=o.lane,ot.lanes|=i,ha|=i,o=o.next;while(o!==t)}else o===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function fp(t){var e=qn(),n=e.queue;if(n===null)throw Error(Z(311));n.lastRenderedReducer=t;var r=n.dispatch,o=n.pending,i=e.memoizedState;if(o!==null){n.pending=null;var a=o=o.next;do i=t(i,a.action),a=a.next;while(a!==o);vr(i,e.memoizedState)||(mn=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function _E(){}function SE(t,e){var n=ot,r=qn(),o=e(),i=!vr(r.memoizedState,o);if(i&&(r.memoizedState=o,mn=!0),r=r.queue,zg(RE.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||Tt!==null&&Tt.memoizedState.tag&1){if(n.flags|=2048,lc(9,IE.bind(null,n,r,o,e),void 0,null),Nt===null)throw Error(Z(349));fa&30||kE(n,e,o)}return o}function kE(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=ot.updateQueue,e===null?(e={lastEffect:null,stores:null},ot.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function IE(t,e,n,r){e.value=n,e.getSnapshot=r,TE(e)&&NE(t)}function RE(t,e,n){return n(function(){TE(e)&&NE(t)})}function TE(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!vr(t,n)}catch{return!0}}function NE(t){var e=xo(t,1);e!==null&&pr(e,t,1,-1)}function U1(t){var e=kr();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:cc,lastRenderedState:t},e.queue=t,t=t.dispatch=yP.bind(null,ot,t),[e.memoizedState,t]}function lc(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=ot.updateQueue,e===null?(e={lastEffect:null,stores:null},ot.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function AE(){return qn().memoizedState}function ld(t,e,n,r){var o=kr();ot.flags|=t,o.memoizedState=lc(1|e,n,void 0,r===void 0?null:r)}function Hf(t,e,n,r){var o=qn();r=r===void 0?null:r;var i=void 0;if(yt!==null){var a=yt.memoizedState;if(i=a.destroy,r!==null&&Ug(r,a.deps)){o.memoizedState=lc(e,n,i,r);return}}ot.flags|=t,o.memoizedState=lc(1|e,n,i,r)}function W1(t,e){return ld(8390656,8,t,e)}function zg(t,e){return Hf(2048,8,t,e)}function PE(t,e){return Hf(4,2,t,e)}function DE(t,e){return Hf(4,4,t,e)}function ME(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function OE(t,e,n){return n=n!=null?n.concat([t]):null,Hf(4,4,ME.bind(null,e,t),n)}function Vg(){}function FE(t,e){var n=qn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Ug(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function LE(t,e){var n=qn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Ug(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function BE(t,e,n){return fa&21?(vr(n,e)||(n=z2(),ot.lanes|=n,ha|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,mn=!0),t.memoizedState=n)}function vP(t,e){var n=ze;ze=n!==0&&4>n?n:4,t(!0);var r=lp.transition;lp.transition={};try{t(!1),e()}finally{ze=n,lp.transition=r}}function jE(){return qn().memoizedState}function gP(t,e,n){var r=vi(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},UE(t))WE(e,n);else if(n=bE(t,e,n,r),n!==null){var o=rn();pr(n,t,r,o),$E(n,e,r)}}function yP(t,e,n){var r=vi(t),o={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(UE(t))WE(e,o);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var a=e.lastRenderedState,s=i(a,n);if(o.hasEagerState=!0,o.eagerState=s,vr(s,a)){var u=e.interleaved;u===null?(o.next=o,Og(e)):(o.next=u.next,u.next=o),e.interleaved=o;return}}catch{}finally{}n=bE(t,e,o,r),n!==null&&(o=rn(),pr(n,t,r,o),$E(n,e,r))}}function UE(t){var e=t.alternate;return t===ot||e!==null&&e===ot}function WE(t,e){ju=$d=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function $E(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,bg(t,n)}}var zd={readContext:Kn,useCallback:$t,useContext:$t,useEffect:$t,useImperativeHandle:$t,useInsertionEffect:$t,useLayoutEffect:$t,useMemo:$t,useReducer:$t,useRef:$t,useState:$t,useDebugValue:$t,useDeferredValue:$t,useTransition:$t,useMutableSource:$t,useSyncExternalStore:$t,useId:$t,unstable_isNewReconciler:!1},xP={readContext:Kn,useCallback:function(t,e){return kr().memoizedState=[t,e===void 0?null:e],t},useContext:Kn,useEffect:W1,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,ld(4194308,4,ME.bind(null,e,t),n)},useLayoutEffect:function(t,e){return ld(4194308,4,t,e)},useInsertionEffect:function(t,e){return ld(4,2,t,e)},useMemo:function(t,e){var n=kr();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=kr();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=gP.bind(null,ot,t),[r.memoizedState,t]},useRef:function(t){var e=kr();return t={current:t},e.memoizedState=t},useState:U1,useDebugValue:Vg,useDeferredValue:function(t){return kr().memoizedState=t},useTransition:function(){var t=U1(!1),e=t[0];return t=vP.bind(null,t[1]),kr().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=ot,o=kr();if(Ze){if(n===void 0)throw Error(Z(407));n=n()}else{if(n=e(),Nt===null)throw Error(Z(349));fa&30||kE(r,e,n)}o.memoizedState=n;var i={value:n,getSnapshot:e};return o.queue=i,W1(RE.bind(null,r,i,t),[t]),r.flags|=2048,lc(9,IE.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=kr(),e=Nt.identifierPrefix;if(Ze){var n=fo,r=lo;n=(r&~(1<<32-hr(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=uc++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=mP++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},wP={readContext:Kn,useCallback:FE,useContext:Kn,useEffect:zg,useImperativeHandle:OE,useInsertionEffect:PE,useLayoutEffect:DE,useMemo:LE,useReducer:dp,useRef:AE,useState:function(){return dp(cc)},useDebugValue:Vg,useDeferredValue:function(t){var e=qn();return BE(e,yt.memoizedState,t)},useTransition:function(){var t=dp(cc)[0],e=qn().memoizedState;return[t,e]},useMutableSource:_E,useSyncExternalStore:SE,useId:jE,unstable_isNewReconciler:!1},bP={readContext:Kn,useCallback:FE,useContext:Kn,useEffect:zg,useImperativeHandle:OE,useInsertionEffect:PE,useLayoutEffect:DE,useMemo:LE,useReducer:fp,useRef:AE,useState:function(){return fp(cc)},useDebugValue:Vg,useDeferredValue:function(t){var e=qn();return yt===null?e.memoizedState=t:BE(e,yt.memoizedState,t)},useTransition:function(){var t=fp(cc)[0],e=qn().memoizedState;return[t,e]},useMutableSource:_E,useSyncExternalStore:SE,useId:jE,unstable_isNewReconciler:!1};function rr(t,e){if(t&&t.defaultProps){e=it({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Gm(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:it({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Gf={isMounted:function(t){return(t=t._reactInternals)?Ea(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=rn(),o=vi(t),i=mo(r,o);i.payload=e,n!=null&&(i.callback=n),e=pi(t,i,o),e!==null&&(pr(e,t,o,r),ud(e,t,o))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=rn(),o=vi(t),i=mo(r,o);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=pi(t,i,o),e!==null&&(pr(e,t,o,r),ud(e,t,o))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=rn(),r=vi(t),o=mo(n,r);o.tag=2,e!=null&&(o.callback=e),e=pi(t,o,r),e!==null&&(pr(e,t,r,n),ud(e,t,r))}};function $1(t,e,n,r,o,i,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,a):e.prototype&&e.prototype.isPureReactComponent?!nc(n,r)||!nc(o,i):!0}function zE(t,e,n){var r=!1,o=Si,i=e.contextType;return typeof i=="object"&&i!==null?i=Kn(i):(o=gn(e)?la:Qt.current,r=e.contextTypes,i=(r=r!=null)?Ls(t,o):Si),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Gf,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=o,t.__reactInternalMemoizedMaskedChildContext=i),e}function z1(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Gf.enqueueReplaceState(e,e.state,null)}function Km(t,e,n,r){var o=t.stateNode;o.props=n,o.state=t.memoizedState,o.refs={},Fg(t);var i=e.contextType;typeof i=="object"&&i!==null?o.context=Kn(i):(i=gn(e)?la:Qt.current,o.context=Ls(t,i)),o.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(Gm(t,e,i,n),o.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof o.getSnapshotBeforeUpdate=="function"||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(e=o.state,typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount(),e!==o.state&&Gf.enqueueReplaceState(o,o.state,null),Ud(t,n,o,r),o.state=t.memoizedState),typeof o.componentDidMount=="function"&&(t.flags|=4194308)}function Ws(t,e){try{var n="",r=e;do n+=XN(r),r=r.return;while(r);var o=n}catch(i){o=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:o,digest:null}}function hp(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function qm(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var EP=typeof WeakMap=="function"?WeakMap:Map;function VE(t,e,n){n=mo(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Hd||(Hd=!0,ov=r),qm(t,e)},n}function HE(t,e,n){n=mo(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var o=e.value;n.payload=function(){return r(o)},n.callback=function(){qm(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){qm(t,e),typeof r!="function"&&(mi===null?mi=new Set([this]):mi.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),n}function V1(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new EP;var o=new Set;r.set(e,o)}else o=r.get(e),o===void 0&&(o=new Set,r.set(e,o));o.has(n)||(o.add(n),t=FP.bind(null,t,e,n),e.then(t,t))}function H1(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function G1(t,e,n,r,o){return t.mode&1?(t.flags|=65536,t.lanes=o,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=mo(-1,1),e.tag=2,pi(n,e,1))),n.lanes|=1),t)}var CP=So.ReactCurrentOwner,mn=!1;function tn(t,e,n,r){e.child=t===null?wE(e,null,n,r):js(e,t.child,n,r)}function K1(t,e,n,r,o){n=n.render;var i=e.ref;return ds(e,o),r=Wg(t,e,n,r,i,o),n=$g(),t!==null&&!mn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~o,wo(t,e,o)):(Ze&&n&&Tg(e),e.flags|=1,tn(t,e,r,o),e.child)}function q1(t,e,n,r,o){if(t===null){var i=n.type;return typeof i=="function"&&!Jg(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,GE(t,e,i,r,o)):(t=pd(n.type,null,r,e,e.mode,o),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&o)){var a=i.memoizedProps;if(n=n.compare,n=n!==null?n:nc,n(a,r)&&t.ref===e.ref)return wo(t,e,o)}return e.flags|=1,t=gi(i,r),t.ref=e.ref,t.return=e,e.child=t}function GE(t,e,n,r,o){if(t!==null){var i=t.memoizedProps;if(nc(i,r)&&t.ref===e.ref)if(mn=!1,e.pendingProps=r=i,(t.lanes&o)!==0)t.flags&131072&&(mn=!0);else return e.lanes=t.lanes,wo(t,e,o)}return Xm(t,e,n,r,o)}function KE(t,e,n){var r=e.pendingProps,o=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ge(is,Cn),Cn|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Ge(is,Cn),Cn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,Ge(is,Cn),Cn|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,Ge(is,Cn),Cn|=r;return tn(t,e,o,n),e.child}function qE(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Xm(t,e,n,r,o){var i=gn(n)?la:Qt.current;return i=Ls(e,i),ds(e,o),n=Wg(t,e,n,r,i,o),r=$g(),t!==null&&!mn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~o,wo(t,e,o)):(Ze&&r&&Tg(e),e.flags|=1,tn(t,e,n,o),e.child)}function X1(t,e,n,r,o){if(gn(n)){var i=!0;Od(e)}else i=!1;if(ds(e,o),e.stateNode===null)dd(t,e),zE(e,n,r),Km(e,n,r,o),r=!0;else if(t===null){var a=e.stateNode,s=e.memoizedProps;a.props=s;var u=a.context,c=n.contextType;typeof c=="object"&&c!==null?c=Kn(c):(c=gn(n)?la:Qt.current,c=Ls(e,c));var l=n.getDerivedStateFromProps,d=typeof l=="function"||typeof a.getSnapshotBeforeUpdate=="function";d||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(s!==r||u!==c)&&z1(e,a,r,c),Ko=!1;var f=e.memoizedState;a.state=f,Ud(e,r,a,o),u=e.memoizedState,s!==r||f!==u||vn.current||Ko?(typeof l=="function"&&(Gm(e,n,l,r),u=e.memoizedState),(s=Ko||$1(e,n,s,r,f,u,c))?(d||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=u),a.props=r,a.state=u,a.context=c,r=s):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{a=e.stateNode,EE(t,e),s=e.memoizedProps,c=e.type===e.elementType?s:rr(e.type,s),a.props=c,d=e.pendingProps,f=a.context,u=n.contextType,typeof u=="object"&&u!==null?u=Kn(u):(u=gn(n)?la:Qt.current,u=Ls(e,u));var h=n.getDerivedStateFromProps;(l=typeof h=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(s!==d||f!==u)&&z1(e,a,r,u),Ko=!1,f=e.memoizedState,a.state=f,Ud(e,r,a,o);var m=e.memoizedState;s!==d||f!==m||vn.current||Ko?(typeof h=="function"&&(Gm(e,n,h,r),m=e.memoizedState),(c=Ko||$1(e,n,c,r,f,m,u)||!1)?(l||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(r,m,u),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(r,m,u)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||s===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||s===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=m),a.props=r,a.state=m,a.context=u,r=c):(typeof a.componentDidUpdate!="function"||s===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||s===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),r=!1)}return Ym(t,e,n,r,i,o)}function Ym(t,e,n,r,o,i){qE(t,e);var a=(e.flags&128)!==0;if(!r&&!a)return o&&M1(e,n,!1),wo(t,e,i);r=e.stateNode,CP.current=e;var s=a&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&a?(e.child=js(e,t.child,null,i),e.child=js(e,null,s,i)):tn(t,e,s,i),e.memoizedState=r.state,o&&M1(e,n,!0),e.child}function XE(t){var e=t.stateNode;e.pendingContext?D1(t,e.pendingContext,e.pendingContext!==e.context):e.context&&D1(t,e.context,!1),Lg(t,e.containerInfo)}function Y1(t,e,n,r,o){return Bs(),Ag(o),e.flags|=256,tn(t,e,n,r),e.child}var Qm={dehydrated:null,treeContext:null,retryLane:0};function Jm(t){return{baseLanes:t,cachePool:null,transitions:null}}function YE(t,e,n){var r=e.pendingProps,o=tt.current,i=!1,a=(e.flags&128)!==0,s;if((s=a)||(s=t!==null&&t.memoizedState===null?!1:(o&2)!==0),s?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(o|=1),Ge(tt,o&1),t===null)return Vm(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=r.children,t=r.fallback,i?(r=e.mode,i=e.child,a={mode:"hidden",children:a},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=a):i=Xf(a,r,0,null),t=ua(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=Jm(n),e.memoizedState=Qm,t):Hg(e,a));if(o=t.memoizedState,o!==null&&(s=o.dehydrated,s!==null))return _P(t,e,a,r,s,o,n);if(i){i=r.fallback,a=e.mode,o=t.child,s=o.sibling;var u={mode:"hidden",children:r.children};return!(a&1)&&e.child!==o?(r=e.child,r.childLanes=0,r.pendingProps=u,e.deletions=null):(r=gi(o,u),r.subtreeFlags=o.subtreeFlags&14680064),s!==null?i=gi(s,i):(i=ua(i,a,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,a=t.child.memoizedState,a=a===null?Jm(n):{baseLanes:a.baseLanes|n,cachePool:null,transitions:a.transitions},i.memoizedState=a,i.childLanes=t.childLanes&~n,e.memoizedState=Qm,r}return i=t.child,t=i.sibling,r=gi(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Hg(t,e){return e=Xf({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Il(t,e,n,r){return r!==null&&Ag(r),js(e,t.child,null,n),t=Hg(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function _P(t,e,n,r,o,i,a){if(n)return e.flags&256?(e.flags&=-257,r=hp(Error(Z(422))),Il(t,e,a,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,o=e.mode,r=Xf({mode:"visible",children:r.children},o,0,null),i=ua(i,o,a,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&js(e,t.child,null,a),e.child.memoizedState=Jm(a),e.memoizedState=Qm,i);if(!(e.mode&1))return Il(t,e,a,null);if(o.data==="$!"){if(r=o.nextSibling&&o.nextSibling.dataset,r)var s=r.dgst;return r=s,i=Error(Z(419)),r=hp(i,r,void 0),Il(t,e,a,r)}if(s=(a&t.childLanes)!==0,mn||s){if(r=Nt,r!==null){switch(a&-a){case 4:o=2;break;case 16:o=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:o=32;break;case 536870912:o=268435456;break;default:o=0}o=o&(r.suspendedLanes|a)?0:o,o!==0&&o!==i.retryLane&&(i.retryLane=o,xo(t,o),pr(r,t,o,-1))}return Qg(),r=hp(Error(Z(421))),Il(t,e,a,r)}return o.data==="$?"?(e.flags|=128,e.child=t.child,e=LP.bind(null,t),o._reactRetry=e,null):(t=i.treeContext,In=hi(o.nextSibling),Pn=e,Ze=!0,ur=null,t!==null&&(jn[Un++]=lo,jn[Un++]=fo,jn[Un++]=da,lo=t.id,fo=t.overflow,da=e),e=Hg(e,r.children),e.flags|=4096,e)}function Q1(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Hm(t.return,e,n)}function pp(t,e,n,r,o){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:o}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=o)}function QE(t,e,n){var r=e.pendingProps,o=r.revealOrder,i=r.tail;if(tn(t,e,r.children,n),r=tt.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Q1(t,n,e);else if(t.tag===19)Q1(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Ge(tt,r),!(e.mode&1))e.memoizedState=null;else switch(o){case"forwards":for(n=e.child,o=null;n!==null;)t=n.alternate,t!==null&&Wd(t)===null&&(o=n),n=n.sibling;n=o,n===null?(o=e.child,e.child=null):(o=n.sibling,n.sibling=null),pp(e,!1,o,n,i);break;case"backwards":for(n=null,o=e.child,e.child=null;o!==null;){if(t=o.alternate,t!==null&&Wd(t)===null){e.child=o;break}t=o.sibling,o.sibling=n,n=o,o=t}pp(e,!0,n,null,i);break;case"together":pp(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function dd(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function wo(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),ha|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(Z(153));if(e.child!==null){for(t=e.child,n=gi(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=gi(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function SP(t,e,n){switch(e.tag){case 3:XE(e),Bs();break;case 5:CE(e);break;case 1:gn(e.type)&&Od(e);break;case 4:Lg(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,o=e.memoizedProps.value;Ge(Bd,r._currentValue),r._currentValue=o;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Ge(tt,tt.current&1),e.flags|=128,null):n&e.child.childLanes?YE(t,e,n):(Ge(tt,tt.current&1),t=wo(t,e,n),t!==null?t.sibling:null);Ge(tt,tt.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return QE(t,e,n);e.flags|=128}if(o=e.memoizedState,o!==null&&(o.rendering=null,o.tail=null,o.lastEffect=null),Ge(tt,tt.current),r)break;return null;case 22:case 23:return e.lanes=0,KE(t,e,n)}return wo(t,e,n)}var JE,Zm,ZE,eC;JE=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Zm=function(){};ZE=function(t,e,n,r){var o=t.memoizedProps;if(o!==r){t=e.stateNode,Ji(jr.current);var i=null;switch(n){case"input":o=bm(t,o),r=bm(t,r),i=[];break;case"select":o=it({},o,{value:void 0}),r=it({},r,{value:void 0}),i=[];break;case"textarea":o=_m(t,o),r=_m(t,r),i=[];break;default:typeof o.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Dd)}km(n,r);var a;n=null;for(c in o)if(!r.hasOwnProperty(c)&&o.hasOwnProperty(c)&&o[c]!=null)if(c==="style"){var s=o[c];for(a in s)s.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Xu.hasOwnProperty(c)?i||(i=[]):(i=i||[]).push(c,null));for(c in r){var u=r[c];if(s=o!=null?o[c]:void 0,r.hasOwnProperty(c)&&u!==s&&(u!=null||s!=null))if(c==="style")if(s){for(a in s)!s.hasOwnProperty(a)||u&&u.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in u)u.hasOwnProperty(a)&&s[a]!==u[a]&&(n||(n={}),n[a]=u[a])}else n||(i||(i=[]),i.push(c,n)),n=u;else c==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,s=s?s.__html:void 0,u!=null&&s!==u&&(i=i||[]).push(c,u)):c==="children"?typeof u!="string"&&typeof u!="number"||(i=i||[]).push(c,""+u):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Xu.hasOwnProperty(c)?(u!=null&&c==="onScroll"&&Xe("scroll",t),i||s===u||(i=[])):(i=i||[]).push(c,u))}n&&(i=i||[]).push("style",n);var c=i;(e.updateQueue=c)&&(e.flags|=4)}};eC=function(t,e,n,r){n!==r&&(e.flags|=4)};function yu(t,e){if(!Ze)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function zt(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var o=t.child;o!==null;)n|=o.lanes|o.childLanes,r|=o.subtreeFlags&14680064,r|=o.flags&14680064,o.return=t,o=o.sibling;else for(o=t.child;o!==null;)n|=o.lanes|o.childLanes,r|=o.subtreeFlags,r|=o.flags,o.return=t,o=o.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function kP(t,e,n){var r=e.pendingProps;switch(Ng(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return zt(e),null;case 1:return gn(e.type)&&Md(),zt(e),null;case 3:return r=e.stateNode,Us(),Qe(vn),Qe(Qt),jg(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Sl(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,ur!==null&&(sv(ur),ur=null))),Zm(t,e),zt(e),null;case 5:Bg(e);var o=Ji(sc.current);if(n=e.type,t!==null&&e.stateNode!=null)ZE(t,e,n,r,o),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(Z(166));return zt(e),null}if(t=Ji(jr.current),Sl(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[Pr]=e,r[ic]=i,t=(e.mode&1)!==0,n){case"dialog":Xe("cancel",r),Xe("close",r);break;case"iframe":case"object":case"embed":Xe("load",r);break;case"video":case"audio":for(o=0;o<Tu.length;o++)Xe(Tu[o],r);break;case"source":Xe("error",r);break;case"img":case"image":case"link":Xe("error",r),Xe("load",r);break;case"details":Xe("toggle",r);break;case"input":a1(r,i),Xe("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Xe("invalid",r);break;case"textarea":u1(r,i),Xe("invalid",r)}km(n,i),o=null;for(var a in i)if(i.hasOwnProperty(a)){var s=i[a];a==="children"?typeof s=="string"?r.textContent!==s&&(i.suppressHydrationWarning!==!0&&_l(r.textContent,s,t),o=["children",s]):typeof s=="number"&&r.textContent!==""+s&&(i.suppressHydrationWarning!==!0&&_l(r.textContent,s,t),o=["children",""+s]):Xu.hasOwnProperty(a)&&s!=null&&a==="onScroll"&&Xe("scroll",r)}switch(n){case"input":vl(r),s1(r,i,!0);break;case"textarea":vl(r),c1(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=Dd)}r=o,e.updateQueue=r,r!==null&&(e.flags|=4)}else{a=o.nodeType===9?o:o.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=R2(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=a.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=a.createElement(n,{is:r.is}):(t=a.createElement(n),n==="select"&&(a=t,r.multiple?a.multiple=!0:r.size&&(a.size=r.size))):t=a.createElementNS(t,n),t[Pr]=e,t[ic]=r,JE(t,e,!1,!1),e.stateNode=t;e:{switch(a=Im(n,r),n){case"dialog":Xe("cancel",t),Xe("close",t),o=r;break;case"iframe":case"object":case"embed":Xe("load",t),o=r;break;case"video":case"audio":for(o=0;o<Tu.length;o++)Xe(Tu[o],t);o=r;break;case"source":Xe("error",t),o=r;break;case"img":case"image":case"link":Xe("error",t),Xe("load",t),o=r;break;case"details":Xe("toggle",t),o=r;break;case"input":a1(t,r),o=bm(t,r),Xe("invalid",t);break;case"option":o=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},o=it({},r,{value:void 0}),Xe("invalid",t);break;case"textarea":u1(t,r),o=_m(t,r),Xe("invalid",t);break;default:o=r}km(n,o),s=o;for(i in s)if(s.hasOwnProperty(i)){var u=s[i];i==="style"?A2(t,u):i==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&T2(t,u)):i==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&Yu(t,u):typeof u=="number"&&Yu(t,""+u):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Xu.hasOwnProperty(i)?u!=null&&i==="onScroll"&&Xe("scroll",t):u!=null&&mg(t,i,u,a))}switch(n){case"input":vl(t),s1(t,r,!1);break;case"textarea":vl(t),c1(t);break;case"option":r.value!=null&&t.setAttribute("value",""+_i(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?ss(t,!!r.multiple,i,!1):r.defaultValue!=null&&ss(t,!!r.multiple,r.defaultValue,!0);break;default:typeof o.onClick=="function"&&(t.onclick=Dd)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return zt(e),null;case 6:if(t&&e.stateNode!=null)eC(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(Z(166));if(n=Ji(sc.current),Ji(jr.current),Sl(e)){if(r=e.stateNode,n=e.memoizedProps,r[Pr]=e,(i=r.nodeValue!==n)&&(t=Pn,t!==null))switch(t.tag){case 3:_l(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&_l(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Pr]=e,e.stateNode=r}return zt(e),null;case 13:if(Qe(tt),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Ze&&In!==null&&e.mode&1&&!(e.flags&128))yE(),Bs(),e.flags|=98560,i=!1;else if(i=Sl(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(Z(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(Z(317));i[Pr]=e}else Bs(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;zt(e),i=!1}else ur!==null&&(sv(ur),ur=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||tt.current&1?xt===0&&(xt=3):Qg())),e.updateQueue!==null&&(e.flags|=4),zt(e),null);case 4:return Us(),Zm(t,e),t===null&&rc(e.stateNode.containerInfo),zt(e),null;case 10:return Mg(e.type._context),zt(e),null;case 17:return gn(e.type)&&Md(),zt(e),null;case 19:if(Qe(tt),i=e.memoizedState,i===null)return zt(e),null;if(r=(e.flags&128)!==0,a=i.rendering,a===null)if(r)yu(i,!1);else{if(xt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(a=Wd(t),a!==null){for(e.flags|=128,yu(i,!1),r=a.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,a=i.alternate,a===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=a.childLanes,i.lanes=a.lanes,i.child=a.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=a.memoizedProps,i.memoizedState=a.memoizedState,i.updateQueue=a.updateQueue,i.type=a.type,t=a.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Ge(tt,tt.current&1|2),e.child}t=t.sibling}i.tail!==null&&lt()>$s&&(e.flags|=128,r=!0,yu(i,!1),e.lanes=4194304)}else{if(!r)if(t=Wd(a),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),yu(i,!0),i.tail===null&&i.tailMode==="hidden"&&!a.alternate&&!Ze)return zt(e),null}else 2*lt()-i.renderingStartTime>$s&&n!==1073741824&&(e.flags|=128,r=!0,yu(i,!1),e.lanes=4194304);i.isBackwards?(a.sibling=e.child,e.child=a):(n=i.last,n!==null?n.sibling=a:e.child=a,i.last=a)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=lt(),e.sibling=null,n=tt.current,Ge(tt,r?n&1|2:n&1),e):(zt(e),null);case 22:case 23:return Yg(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Cn&1073741824&&(zt(e),e.subtreeFlags&6&&(e.flags|=8192)):zt(e),null;case 24:return null;case 25:return null}throw Error(Z(156,e.tag))}function IP(t,e){switch(Ng(e),e.tag){case 1:return gn(e.type)&&Md(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Us(),Qe(vn),Qe(Qt),jg(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Bg(e),null;case 13:if(Qe(tt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(Z(340));Bs()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Qe(tt),null;case 4:return Us(),null;case 10:return Mg(e.type._context),null;case 22:case 23:return Yg(),null;case 24:return null;default:return null}}var Rl=!1,Gt=!1,RP=typeof WeakSet=="function"?WeakSet:Set,ue=null;function os(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){ct(t,e,r)}else n.current=null}function ev(t,e,n){try{n()}catch(r){ct(t,e,r)}}var J1=!1;function TP(t,e){if(Lm=Nd,t=iE(),Rg(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var o=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var a=0,s=-1,u=-1,c=0,l=0,d=t,f=null;t:for(;;){for(var h;d!==n||o!==0&&d.nodeType!==3||(s=a+o),d!==i||r!==0&&d.nodeType!==3||(u=a+r),d.nodeType===3&&(a+=d.nodeValue.length),(h=d.firstChild)!==null;)f=d,d=h;for(;;){if(d===t)break t;if(f===n&&++c===o&&(s=a),f===i&&++l===r&&(u=a),(h=d.nextSibling)!==null)break;d=f,f=d.parentNode}d=h}n=s===-1||u===-1?null:{start:s,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(Bm={focusedElem:t,selectionRange:n},Nd=!1,ue=e;ue!==null;)if(e=ue,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,ue=t;else for(;ue!==null;){e=ue;try{var m=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(m!==null){var p=m.memoizedProps,g=m.memoizedState,v=e.stateNode,y=v.getSnapshotBeforeUpdate(e.elementType===e.type?p:rr(e.type,p),g);v.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var x=e.stateNode.containerInfo;x.nodeType===1?x.textContent="":x.nodeType===9&&x.documentElement&&x.removeChild(x.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Z(163))}}catch(b){ct(e,e.return,b)}if(t=e.sibling,t!==null){t.return=e.return,ue=t;break}ue=e.return}return m=J1,J1=!1,m}function Uu(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var o=r=r.next;do{if((o.tag&t)===t){var i=o.destroy;o.destroy=void 0,i!==void 0&&ev(e,n,i)}o=o.next}while(o!==r)}}function Kf(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function tv(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function tC(t){var e=t.alternate;e!==null&&(t.alternate=null,tC(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Pr],delete e[ic],delete e[Wm],delete e[dP],delete e[fP])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function nC(t){return t.tag===5||t.tag===3||t.tag===4}function Z1(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||nC(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function nv(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Dd));else if(r!==4&&(t=t.child,t!==null))for(nv(t,e,n),t=t.sibling;t!==null;)nv(t,e,n),t=t.sibling}function rv(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(rv(t,e,n),t=t.sibling;t!==null;)rv(t,e,n),t=t.sibling}var Ot=null,sr=!1;function Bo(t,e,n){for(n=n.child;n!==null;)rC(t,e,n),n=n.sibling}function rC(t,e,n){if(Br&&typeof Br.onCommitFiberUnmount=="function")try{Br.onCommitFiberUnmount(jf,n)}catch{}switch(n.tag){case 5:Gt||os(n,e);case 6:var r=Ot,o=sr;Ot=null,Bo(t,e,n),Ot=r,sr=o,Ot!==null&&(sr?(t=Ot,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Ot.removeChild(n.stateNode));break;case 18:Ot!==null&&(sr?(t=Ot,n=n.stateNode,t.nodeType===8?sp(t.parentNode,n):t.nodeType===1&&sp(t,n),ec(t)):sp(Ot,n.stateNode));break;case 4:r=Ot,o=sr,Ot=n.stateNode.containerInfo,sr=!0,Bo(t,e,n),Ot=r,sr=o;break;case 0:case 11:case 14:case 15:if(!Gt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){o=r=r.next;do{var i=o,a=i.destroy;i=i.tag,a!==void 0&&(i&2||i&4)&&ev(n,e,a),o=o.next}while(o!==r)}Bo(t,e,n);break;case 1:if(!Gt&&(os(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(s){ct(n,e,s)}Bo(t,e,n);break;case 21:Bo(t,e,n);break;case 22:n.mode&1?(Gt=(r=Gt)||n.memoizedState!==null,Bo(t,e,n),Gt=r):Bo(t,e,n);break;default:Bo(t,e,n)}}function ex(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new RP),e.forEach(function(r){var o=BP.bind(null,t,r);n.has(r)||(n.add(r),r.then(o,o))})}}function tr(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var o=n[r];try{var i=t,a=e,s=a;e:for(;s!==null;){switch(s.tag){case 5:Ot=s.stateNode,sr=!1;break e;case 3:Ot=s.stateNode.containerInfo,sr=!0;break e;case 4:Ot=s.stateNode.containerInfo,sr=!0;break e}s=s.return}if(Ot===null)throw Error(Z(160));rC(i,a,o),Ot=null,sr=!1;var u=o.alternate;u!==null&&(u.return=null),o.return=null}catch(c){ct(o,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)oC(e,t),e=e.sibling}function oC(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(tr(e,t),_r(t),r&4){try{Uu(3,t,t.return),Kf(3,t)}catch(p){ct(t,t.return,p)}try{Uu(5,t,t.return)}catch(p){ct(t,t.return,p)}}break;case 1:tr(e,t),_r(t),r&512&&n!==null&&os(n,n.return);break;case 5:if(tr(e,t),_r(t),r&512&&n!==null&&os(n,n.return),t.flags&32){var o=t.stateNode;try{Yu(o,"")}catch(p){ct(t,t.return,p)}}if(r&4&&(o=t.stateNode,o!=null)){var i=t.memoizedProps,a=n!==null?n.memoizedProps:i,s=t.type,u=t.updateQueue;if(t.updateQueue=null,u!==null)try{s==="input"&&i.type==="radio"&&i.name!=null&&k2(o,i),Im(s,a);var c=Im(s,i);for(a=0;a<u.length;a+=2){var l=u[a],d=u[a+1];l==="style"?A2(o,d):l==="dangerouslySetInnerHTML"?T2(o,d):l==="children"?Yu(o,d):mg(o,l,d,c)}switch(s){case"input":Em(o,i);break;case"textarea":I2(o,i);break;case"select":var f=o._wrapperState.wasMultiple;o._wrapperState.wasMultiple=!!i.multiple;var h=i.value;h!=null?ss(o,!!i.multiple,h,!1):f!==!!i.multiple&&(i.defaultValue!=null?ss(o,!!i.multiple,i.defaultValue,!0):ss(o,!!i.multiple,i.multiple?[]:"",!1))}o[ic]=i}catch(p){ct(t,t.return,p)}}break;case 6:if(tr(e,t),_r(t),r&4){if(t.stateNode===null)throw Error(Z(162));o=t.stateNode,i=t.memoizedProps;try{o.nodeValue=i}catch(p){ct(t,t.return,p)}}break;case 3:if(tr(e,t),_r(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{ec(e.containerInfo)}catch(p){ct(t,t.return,p)}break;case 4:tr(e,t),_r(t);break;case 13:tr(e,t),_r(t),o=t.child,o.flags&8192&&(i=o.memoizedState!==null,o.stateNode.isHidden=i,!i||o.alternate!==null&&o.alternate.memoizedState!==null||(qg=lt())),r&4&&ex(t);break;case 22:if(l=n!==null&&n.memoizedState!==null,t.mode&1?(Gt=(c=Gt)||l,tr(e,t),Gt=c):tr(e,t),_r(t),r&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!l&&t.mode&1)for(ue=t,l=t.child;l!==null;){for(d=ue=l;ue!==null;){switch(f=ue,h=f.child,f.tag){case 0:case 11:case 14:case 15:Uu(4,f,f.return);break;case 1:os(f,f.return);var m=f.stateNode;if(typeof m.componentWillUnmount=="function"){r=f,n=f.return;try{e=r,m.props=e.memoizedProps,m.state=e.memoizedState,m.componentWillUnmount()}catch(p){ct(r,n,p)}}break;case 5:os(f,f.return);break;case 22:if(f.memoizedState!==null){nx(d);continue}}h!==null?(h.return=f,ue=h):nx(d)}l=l.sibling}e:for(l=null,d=t;;){if(d.tag===5){if(l===null){l=d;try{o=d.stateNode,c?(i=o.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(s=d.stateNode,u=d.memoizedProps.style,a=u!=null&&u.hasOwnProperty("display")?u.display:null,s.style.display=N2("display",a))}catch(p){ct(t,t.return,p)}}}else if(d.tag===6){if(l===null)try{d.stateNode.nodeValue=c?"":d.memoizedProps}catch(p){ct(t,t.return,p)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===t)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===t)break e;for(;d.sibling===null;){if(d.return===null||d.return===t)break e;l===d&&(l=null),d=d.return}l===d&&(l=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:tr(e,t),_r(t),r&4&&ex(t);break;case 21:break;default:tr(e,t),_r(t)}}function _r(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(nC(n)){var r=n;break e}n=n.return}throw Error(Z(160))}switch(r.tag){case 5:var o=r.stateNode;r.flags&32&&(Yu(o,""),r.flags&=-33);var i=Z1(t);rv(t,i,o);break;case 3:case 4:var a=r.stateNode.containerInfo,s=Z1(t);nv(t,s,a);break;default:throw Error(Z(161))}}catch(u){ct(t,t.return,u)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function NP(t,e,n){ue=t,iC(t)}function iC(t,e,n){for(var r=(t.mode&1)!==0;ue!==null;){var o=ue,i=o.child;if(o.tag===22&&r){var a=o.memoizedState!==null||Rl;if(!a){var s=o.alternate,u=s!==null&&s.memoizedState!==null||Gt;s=Rl;var c=Gt;if(Rl=a,(Gt=u)&&!c)for(ue=o;ue!==null;)a=ue,u=a.child,a.tag===22&&a.memoizedState!==null?rx(o):u!==null?(u.return=a,ue=u):rx(o);for(;i!==null;)ue=i,iC(i),i=i.sibling;ue=o,Rl=s,Gt=c}tx(t)}else o.subtreeFlags&8772&&i!==null?(i.return=o,ue=i):tx(t)}}function tx(t){for(;ue!==null;){var e=ue;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Gt||Kf(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Gt)if(n===null)r.componentDidMount();else{var o=e.elementType===e.type?n.memoizedProps:rr(e.type,n.memoizedProps);r.componentDidUpdate(o,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&j1(e,i,r);break;case 3:var a=e.updateQueue;if(a!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}j1(e,a,n)}break;case 5:var s=e.stateNode;if(n===null&&e.flags&4){n=s;var u=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var l=c.memoizedState;if(l!==null){var d=l.dehydrated;d!==null&&ec(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Z(163))}Gt||e.flags&512&&tv(e)}catch(f){ct(e,e.return,f)}}if(e===t){ue=null;break}if(n=e.sibling,n!==null){n.return=e.return,ue=n;break}ue=e.return}}function nx(t){for(;ue!==null;){var e=ue;if(e===t){ue=null;break}var n=e.sibling;if(n!==null){n.return=e.return,ue=n;break}ue=e.return}}function rx(t){for(;ue!==null;){var e=ue;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Kf(4,e)}catch(u){ct(e,n,u)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var o=e.return;try{r.componentDidMount()}catch(u){ct(e,o,u)}}var i=e.return;try{tv(e)}catch(u){ct(e,i,u)}break;case 5:var a=e.return;try{tv(e)}catch(u){ct(e,a,u)}}}catch(u){ct(e,e.return,u)}if(e===t){ue=null;break}var s=e.sibling;if(s!==null){s.return=e.return,ue=s;break}ue=e.return}}var AP=Math.ceil,Vd=So.ReactCurrentDispatcher,Gg=So.ReactCurrentOwner,Hn=So.ReactCurrentBatchConfig,Le=0,Nt=null,ft=null,jt=0,Cn=0,is=Ai(0),xt=0,dc=null,ha=0,qf=0,Kg=0,Wu=null,dn=null,qg=0,$s=1/0,io=null,Hd=!1,ov=null,mi=null,Tl=!1,ai=null,Gd=0,$u=0,iv=null,fd=-1,hd=0;function rn(){return Le&6?lt():fd!==-1?fd:fd=lt()}function vi(t){return t.mode&1?Le&2&&jt!==0?jt&-jt:pP.transition!==null?(hd===0&&(hd=z2()),hd):(t=ze,t!==0||(t=window.event,t=t===void 0?16:Y2(t.type)),t):1}function pr(t,e,n,r){if(50<$u)throw $u=0,iv=null,Error(Z(185));Fc(t,n,r),(!(Le&2)||t!==Nt)&&(t===Nt&&(!(Le&2)&&(qf|=n),xt===4&&Xo(t,jt)),yn(t,r),n===1&&Le===0&&!(e.mode&1)&&($s=lt()+500,Vf&&Pi()))}function yn(t,e){var n=t.callbackNode;pA(t,e);var r=Td(t,t===Nt?jt:0);if(r===0)n!==null&&f1(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&f1(n),e===1)t.tag===0?hP(ox.bind(null,t)):mE(ox.bind(null,t)),cP(function(){!(Le&6)&&Pi()}),n=null;else{switch(V2(r)){case 1:n=wg;break;case 4:n=W2;break;case 16:n=Rd;break;case 536870912:n=$2;break;default:n=Rd}n=hC(n,aC.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function aC(t,e){if(fd=-1,hd=0,Le&6)throw Error(Z(327));var n=t.callbackNode;if(fs()&&t.callbackNode!==n)return null;var r=Td(t,t===Nt?jt:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Kd(t,r);else{e=r;var o=Le;Le|=2;var i=uC();(Nt!==t||jt!==e)&&(io=null,$s=lt()+500,sa(t,e));do try{MP();break}catch(s){sC(t,s)}while(!0);Dg(),Vd.current=i,Le=o,ft!==null?e=0:(Nt=null,jt=0,e=xt)}if(e!==0){if(e===2&&(o=Pm(t),o!==0&&(r=o,e=av(t,o))),e===1)throw n=dc,sa(t,0),Xo(t,r),yn(t,lt()),n;if(e===6)Xo(t,r);else{if(o=t.current.alternate,!(r&30)&&!PP(o)&&(e=Kd(t,r),e===2&&(i=Pm(t),i!==0&&(r=i,e=av(t,i))),e===1))throw n=dc,sa(t,0),Xo(t,r),yn(t,lt()),n;switch(t.finishedWork=o,t.finishedLanes=r,e){case 0:case 1:throw Error(Z(345));case 2:zi(t,dn,io);break;case 3:if(Xo(t,r),(r&130023424)===r&&(e=qg+500-lt(),10<e)){if(Td(t,0)!==0)break;if(o=t.suspendedLanes,(o&r)!==r){rn(),t.pingedLanes|=t.suspendedLanes&o;break}t.timeoutHandle=Um(zi.bind(null,t,dn,io),e);break}zi(t,dn,io);break;case 4:if(Xo(t,r),(r&4194240)===r)break;for(e=t.eventTimes,o=-1;0<r;){var a=31-hr(r);i=1<<a,a=e[a],a>o&&(o=a),r&=~i}if(r=o,r=lt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*AP(r/1960))-r,10<r){t.timeoutHandle=Um(zi.bind(null,t,dn,io),r);break}zi(t,dn,io);break;case 5:zi(t,dn,io);break;default:throw Error(Z(329))}}}return yn(t,lt()),t.callbackNode===n?aC.bind(null,t):null}function av(t,e){var n=Wu;return t.current.memoizedState.isDehydrated&&(sa(t,e).flags|=256),t=Kd(t,e),t!==2&&(e=dn,dn=n,e!==null&&sv(e)),t}function sv(t){dn===null?dn=t:dn.push.apply(dn,t)}function PP(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var o=n[r],i=o.getSnapshot;o=o.value;try{if(!vr(i(),o))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Xo(t,e){for(e&=~Kg,e&=~qf,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-hr(e),r=1<<n;t[n]=-1,e&=~r}}function ox(t){if(Le&6)throw Error(Z(327));fs();var e=Td(t,0);if(!(e&1))return yn(t,lt()),null;var n=Kd(t,e);if(t.tag!==0&&n===2){var r=Pm(t);r!==0&&(e=r,n=av(t,r))}if(n===1)throw n=dc,sa(t,0),Xo(t,e),yn(t,lt()),n;if(n===6)throw Error(Z(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,zi(t,dn,io),yn(t,lt()),null}function Xg(t,e){var n=Le;Le|=1;try{return t(e)}finally{Le=n,Le===0&&($s=lt()+500,Vf&&Pi())}}function pa(t){ai!==null&&ai.tag===0&&!(Le&6)&&fs();var e=Le;Le|=1;var n=Hn.transition,r=ze;try{if(Hn.transition=null,ze=1,t)return t()}finally{ze=r,Hn.transition=n,Le=e,!(Le&6)&&Pi()}}function Yg(){Cn=is.current,Qe(is)}function sa(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,uP(n)),ft!==null)for(n=ft.return;n!==null;){var r=n;switch(Ng(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Md();break;case 3:Us(),Qe(vn),Qe(Qt),jg();break;case 5:Bg(r);break;case 4:Us();break;case 13:Qe(tt);break;case 19:Qe(tt);break;case 10:Mg(r.type._context);break;case 22:case 23:Yg()}n=n.return}if(Nt=t,ft=t=gi(t.current,null),jt=Cn=e,xt=0,dc=null,Kg=qf=ha=0,dn=Wu=null,Qi!==null){for(e=0;e<Qi.length;e++)if(n=Qi[e],r=n.interleaved,r!==null){n.interleaved=null;var o=r.next,i=n.pending;if(i!==null){var a=i.next;i.next=o,r.next=a}n.pending=r}Qi=null}return t}function sC(t,e){do{var n=ft;try{if(Dg(),cd.current=zd,$d){for(var r=ot.memoizedState;r!==null;){var o=r.queue;o!==null&&(o.pending=null),r=r.next}$d=!1}if(fa=0,Tt=yt=ot=null,ju=!1,uc=0,Gg.current=null,n===null||n.return===null){xt=1,dc=e,ft=null;break}e:{var i=t,a=n.return,s=n,u=e;if(e=jt,s.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var c=u,l=s,d=l.tag;if(!(l.mode&1)&&(d===0||d===11||d===15)){var f=l.alternate;f?(l.updateQueue=f.updateQueue,l.memoizedState=f.memoizedState,l.lanes=f.lanes):(l.updateQueue=null,l.memoizedState=null)}var h=H1(a);if(h!==null){h.flags&=-257,G1(h,a,s,i,e),h.mode&1&&V1(i,c,e),e=h,u=c;var m=e.updateQueue;if(m===null){var p=new Set;p.add(u),e.updateQueue=p}else m.add(u);break e}else{if(!(e&1)){V1(i,c,e),Qg();break e}u=Error(Z(426))}}else if(Ze&&s.mode&1){var g=H1(a);if(g!==null){!(g.flags&65536)&&(g.flags|=256),G1(g,a,s,i,e),Ag(Ws(u,s));break e}}i=u=Ws(u,s),xt!==4&&(xt=2),Wu===null?Wu=[i]:Wu.push(i),i=a;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var v=VE(i,u,e);B1(i,v);break e;case 1:s=u;var y=i.type,x=i.stateNode;if(!(i.flags&128)&&(typeof y.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(mi===null||!mi.has(x)))){i.flags|=65536,e&=-e,i.lanes|=e;var b=HE(i,s,e);B1(i,b);break e}}i=i.return}while(i!==null)}lC(n)}catch(E){e=E,ft===n&&n!==null&&(ft=n=n.return);continue}break}while(!0)}function uC(){var t=Vd.current;return Vd.current=zd,t===null?zd:t}function Qg(){(xt===0||xt===3||xt===2)&&(xt=4),Nt===null||!(ha&268435455)&&!(qf&268435455)||Xo(Nt,jt)}function Kd(t,e){var n=Le;Le|=2;var r=uC();(Nt!==t||jt!==e)&&(io=null,sa(t,e));do try{DP();break}catch(o){sC(t,o)}while(!0);if(Dg(),Le=n,Vd.current=r,ft!==null)throw Error(Z(261));return Nt=null,jt=0,xt}function DP(){for(;ft!==null;)cC(ft)}function MP(){for(;ft!==null&&!iA();)cC(ft)}function cC(t){var e=fC(t.alternate,t,Cn);t.memoizedProps=t.pendingProps,e===null?lC(t):ft=e,Gg.current=null}function lC(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=IP(n,e),n!==null){n.flags&=32767,ft=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{xt=6,ft=null;return}}else if(n=kP(n,e,Cn),n!==null){ft=n;return}if(e=e.sibling,e!==null){ft=e;return}ft=e=t}while(e!==null);xt===0&&(xt=5)}function zi(t,e,n){var r=ze,o=Hn.transition;try{Hn.transition=null,ze=1,OP(t,e,n,r)}finally{Hn.transition=o,ze=r}return null}function OP(t,e,n,r){do fs();while(ai!==null);if(Le&6)throw Error(Z(327));n=t.finishedWork;var o=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(Z(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(mA(t,i),t===Nt&&(ft=Nt=null,jt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Tl||(Tl=!0,hC(Rd,function(){return fs(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=Hn.transition,Hn.transition=null;var a=ze;ze=1;var s=Le;Le|=4,Gg.current=null,TP(t,n),oC(n,t),tP(Bm),Nd=!!Lm,Bm=Lm=null,t.current=n,NP(n),aA(),Le=s,ze=a,Hn.transition=i}else t.current=n;if(Tl&&(Tl=!1,ai=t,Gd=o),i=t.pendingLanes,i===0&&(mi=null),cA(n.stateNode),yn(t,lt()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)o=e[n],r(o.value,{componentStack:o.stack,digest:o.digest});if(Hd)throw Hd=!1,t=ov,ov=null,t;return Gd&1&&t.tag!==0&&fs(),i=t.pendingLanes,i&1?t===iv?$u++:($u=0,iv=t):$u=0,Pi(),null}function fs(){if(ai!==null){var t=V2(Gd),e=Hn.transition,n=ze;try{if(Hn.transition=null,ze=16>t?16:t,ai===null)var r=!1;else{if(t=ai,ai=null,Gd=0,Le&6)throw Error(Z(331));var o=Le;for(Le|=4,ue=t.current;ue!==null;){var i=ue,a=i.child;if(ue.flags&16){var s=i.deletions;if(s!==null){for(var u=0;u<s.length;u++){var c=s[u];for(ue=c;ue!==null;){var l=ue;switch(l.tag){case 0:case 11:case 15:Uu(8,l,i)}var d=l.child;if(d!==null)d.return=l,ue=d;else for(;ue!==null;){l=ue;var f=l.sibling,h=l.return;if(tC(l),l===c){ue=null;break}if(f!==null){f.return=h,ue=f;break}ue=h}}}var m=i.alternate;if(m!==null){var p=m.child;if(p!==null){m.child=null;do{var g=p.sibling;p.sibling=null,p=g}while(p!==null)}}ue=i}}if(i.subtreeFlags&2064&&a!==null)a.return=i,ue=a;else e:for(;ue!==null;){if(i=ue,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Uu(9,i,i.return)}var v=i.sibling;if(v!==null){v.return=i.return,ue=v;break e}ue=i.return}}var y=t.current;for(ue=y;ue!==null;){a=ue;var x=a.child;if(a.subtreeFlags&2064&&x!==null)x.return=a,ue=x;else e:for(a=y;ue!==null;){if(s=ue,s.flags&2048)try{switch(s.tag){case 0:case 11:case 15:Kf(9,s)}}catch(E){ct(s,s.return,E)}if(s===a){ue=null;break e}var b=s.sibling;if(b!==null){b.return=s.return,ue=b;break e}ue=s.return}}if(Le=o,Pi(),Br&&typeof Br.onPostCommitFiberRoot=="function")try{Br.onPostCommitFiberRoot(jf,t)}catch{}r=!0}return r}finally{ze=n,Hn.transition=e}}return!1}function ix(t,e,n){e=Ws(n,e),e=VE(t,e,1),t=pi(t,e,1),e=rn(),t!==null&&(Fc(t,1,e),yn(t,e))}function ct(t,e,n){if(t.tag===3)ix(t,t,n);else for(;e!==null;){if(e.tag===3){ix(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(mi===null||!mi.has(r))){t=Ws(n,t),t=HE(e,t,1),e=pi(e,t,1),t=rn(),e!==null&&(Fc(e,1,t),yn(e,t));break}}e=e.return}}function FP(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=rn(),t.pingedLanes|=t.suspendedLanes&n,Nt===t&&(jt&n)===n&&(xt===4||xt===3&&(jt&130023424)===jt&&500>lt()-qg?sa(t,0):Kg|=n),yn(t,e)}function dC(t,e){e===0&&(t.mode&1?(e=xl,xl<<=1,!(xl&130023424)&&(xl=4194304)):e=1);var n=rn();t=xo(t,e),t!==null&&(Fc(t,e,n),yn(t,n))}function LP(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),dC(t,n)}function BP(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,o=t.memoizedState;o!==null&&(n=o.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(Z(314))}r!==null&&r.delete(e),dC(t,n)}var fC;fC=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||vn.current)mn=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return mn=!1,SP(t,e,n);mn=!!(t.flags&131072)}else mn=!1,Ze&&e.flags&1048576&&vE(e,Ld,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;dd(t,e),t=e.pendingProps;var o=Ls(e,Qt.current);ds(e,n),o=Wg(null,e,r,t,o,n);var i=$g();return e.flags|=1,typeof o=="object"&&o!==null&&typeof o.render=="function"&&o.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,gn(r)?(i=!0,Od(e)):i=!1,e.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,Fg(e),o.updater=Gf,e.stateNode=o,o._reactInternals=e,Km(e,r,t,n),e=Ym(null,e,r,!0,i,n)):(e.tag=0,Ze&&i&&Tg(e),tn(null,e,o,n),e=e.child),e;case 16:r=e.elementType;e:{switch(dd(t,e),t=e.pendingProps,o=r._init,r=o(r._payload),e.type=r,o=e.tag=UP(r),t=rr(r,t),o){case 0:e=Xm(null,e,r,t,n);break e;case 1:e=X1(null,e,r,t,n);break e;case 11:e=K1(null,e,r,t,n);break e;case 14:e=q1(null,e,r,rr(r.type,t),n);break e}throw Error(Z(306,r,""))}return e;case 0:return r=e.type,o=e.pendingProps,o=e.elementType===r?o:rr(r,o),Xm(t,e,r,o,n);case 1:return r=e.type,o=e.pendingProps,o=e.elementType===r?o:rr(r,o),X1(t,e,r,o,n);case 3:e:{if(XE(e),t===null)throw Error(Z(387));r=e.pendingProps,i=e.memoizedState,o=i.element,EE(t,e),Ud(e,r,null,n);var a=e.memoizedState;if(r=a.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){o=Ws(Error(Z(423)),e),e=Y1(t,e,r,n,o);break e}else if(r!==o){o=Ws(Error(Z(424)),e),e=Y1(t,e,r,n,o);break e}else for(In=hi(e.stateNode.containerInfo.firstChild),Pn=e,Ze=!0,ur=null,n=wE(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Bs(),r===o){e=wo(t,e,n);break e}tn(t,e,r,n)}e=e.child}return e;case 5:return CE(e),t===null&&Vm(e),r=e.type,o=e.pendingProps,i=t!==null?t.memoizedProps:null,a=o.children,jm(r,o)?a=null:i!==null&&jm(r,i)&&(e.flags|=32),qE(t,e),tn(t,e,a,n),e.child;case 6:return t===null&&Vm(e),null;case 13:return YE(t,e,n);case 4:return Lg(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=js(e,null,r,n):tn(t,e,r,n),e.child;case 11:return r=e.type,o=e.pendingProps,o=e.elementType===r?o:rr(r,o),K1(t,e,r,o,n);case 7:return tn(t,e,e.pendingProps,n),e.child;case 8:return tn(t,e,e.pendingProps.children,n),e.child;case 12:return tn(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,o=e.pendingProps,i=e.memoizedProps,a=o.value,Ge(Bd,r._currentValue),r._currentValue=a,i!==null)if(vr(i.value,a)){if(i.children===o.children&&!vn.current){e=wo(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var s=i.dependencies;if(s!==null){a=i.child;for(var u=s.firstContext;u!==null;){if(u.context===r){if(i.tag===1){u=mo(-1,n&-n),u.tag=2;var c=i.updateQueue;if(c!==null){c=c.shared;var l=c.pending;l===null?u.next=u:(u.next=l.next,l.next=u),c.pending=u}}i.lanes|=n,u=i.alternate,u!==null&&(u.lanes|=n),Hm(i.return,n,e),s.lanes|=n;break}u=u.next}}else if(i.tag===10)a=i.type===e.type?null:i.child;else if(i.tag===18){if(a=i.return,a===null)throw Error(Z(341));a.lanes|=n,s=a.alternate,s!==null&&(s.lanes|=n),Hm(a,n,e),a=i.sibling}else a=i.child;if(a!==null)a.return=i;else for(a=i;a!==null;){if(a===e){a=null;break}if(i=a.sibling,i!==null){i.return=a.return,a=i;break}a=a.return}i=a}tn(t,e,o.children,n),e=e.child}return e;case 9:return o=e.type,r=e.pendingProps.children,ds(e,n),o=Kn(o),r=r(o),e.flags|=1,tn(t,e,r,n),e.child;case 14:return r=e.type,o=rr(r,e.pendingProps),o=rr(r.type,o),q1(t,e,r,o,n);case 15:return GE(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,o=e.pendingProps,o=e.elementType===r?o:rr(r,o),dd(t,e),e.tag=1,gn(r)?(t=!0,Od(e)):t=!1,ds(e,n),zE(e,r,o),Km(e,r,o,n),Ym(null,e,r,!0,t,n);case 19:return QE(t,e,n);case 22:return KE(t,e,n)}throw Error(Z(156,e.tag))};function hC(t,e){return U2(t,e)}function jP(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function zn(t,e,n,r){return new jP(t,e,n,r)}function Jg(t){return t=t.prototype,!(!t||!t.isReactComponent)}function UP(t){if(typeof t=="function")return Jg(t)?1:0;if(t!=null){if(t=t.$$typeof,t===gg)return 11;if(t===yg)return 14}return 2}function gi(t,e){var n=t.alternate;return n===null?(n=zn(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function pd(t,e,n,r,o,i){var a=2;if(r=t,typeof t=="function")Jg(t)&&(a=1);else if(typeof t=="string")a=5;else e:switch(t){case Xa:return ua(n.children,o,i,e);case vg:a=8,o|=8;break;case gm:return t=zn(12,n,e,o|2),t.elementType=gm,t.lanes=i,t;case ym:return t=zn(13,n,e,o),t.elementType=ym,t.lanes=i,t;case xm:return t=zn(19,n,e,o),t.elementType=xm,t.lanes=i,t;case C2:return Xf(n,o,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case b2:a=10;break e;case E2:a=9;break e;case gg:a=11;break e;case yg:a=14;break e;case Go:a=16,r=null;break e}throw Error(Z(130,t==null?t:typeof t,""))}return e=zn(a,n,e,o),e.elementType=t,e.type=r,e.lanes=i,e}function ua(t,e,n,r){return t=zn(7,t,r,e),t.lanes=n,t}function Xf(t,e,n,r){return t=zn(22,t,r,e),t.elementType=C2,t.lanes=n,t.stateNode={isHidden:!1},t}function mp(t,e,n){return t=zn(6,t,null,e),t.lanes=n,t}function vp(t,e,n){return e=zn(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function WP(t,e,n,r,o){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Yh(0),this.expirationTimes=Yh(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Yh(0),this.identifierPrefix=r,this.onRecoverableError=o,this.mutableSourceEagerHydrationData=null}function Zg(t,e,n,r,o,i,a,s,u){return t=new WP(t,e,n,s,u),e===1?(e=1,i===!0&&(e|=8)):e=0,i=zn(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Fg(i),t}function $P(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:qa,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function pC(t){if(!t)return Si;t=t._reactInternals;e:{if(Ea(t)!==t||t.tag!==1)throw Error(Z(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(gn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Z(171))}if(t.tag===1){var n=t.type;if(gn(n))return pE(t,n,e)}return e}function mC(t,e,n,r,o,i,a,s,u){return t=Zg(n,r,!0,t,o,i,a,s,u),t.context=pC(null),n=t.current,r=rn(),o=vi(n),i=mo(r,o),i.callback=e??null,pi(n,i,o),t.current.lanes=o,Fc(t,o,r),yn(t,r),t}function Yf(t,e,n,r){var o=e.current,i=rn(),a=vi(o);return n=pC(n),e.context===null?e.context=n:e.pendingContext=n,e=mo(i,a),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=pi(o,e,a),t!==null&&(pr(t,o,a,i),ud(t,o,a)),a}function qd(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function ax(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function ey(t,e){ax(t,e),(t=t.alternate)&&ax(t,e)}function zP(){return null}var vC=typeof reportError=="function"?reportError:function(t){console.error(t)};function ty(t){this._internalRoot=t}Qf.prototype.render=ty.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(Z(409));Yf(t,e,null,null)};Qf.prototype.unmount=ty.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;pa(function(){Yf(null,t,null,null)}),e[yo]=null}};function Qf(t){this._internalRoot=t}Qf.prototype.unstable_scheduleHydration=function(t){if(t){var e=K2();t={blockedOn:null,target:t,priority:e};for(var n=0;n<qo.length&&e!==0&&e<qo[n].priority;n++);qo.splice(n,0,t),n===0&&X2(t)}};function ny(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Jf(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function sx(){}function VP(t,e,n,r,o){if(o){if(typeof r=="function"){var i=r;r=function(){var c=qd(a);i.call(c)}}var a=mC(e,r,t,0,null,!1,!1,"",sx);return t._reactRootContainer=a,t[yo]=a.current,rc(t.nodeType===8?t.parentNode:t),pa(),a}for(;o=t.lastChild;)t.removeChild(o);if(typeof r=="function"){var s=r;r=function(){var c=qd(u);s.call(c)}}var u=Zg(t,0,!1,null,null,!1,!1,"",sx);return t._reactRootContainer=u,t[yo]=u.current,rc(t.nodeType===8?t.parentNode:t),pa(function(){Yf(e,u,n,r)}),u}function Zf(t,e,n,r,o){var i=n._reactRootContainer;if(i){var a=i;if(typeof o=="function"){var s=o;o=function(){var u=qd(a);s.call(u)}}Yf(e,a,t,o)}else a=VP(n,e,t,o,r);return qd(a)}H2=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Ru(e.pendingLanes);n!==0&&(bg(e,n|1),yn(e,lt()),!(Le&6)&&($s=lt()+500,Pi()))}break;case 13:pa(function(){var r=xo(t,1);if(r!==null){var o=rn();pr(r,t,1,o)}}),ey(t,1)}};Eg=function(t){if(t.tag===13){var e=xo(t,134217728);if(e!==null){var n=rn();pr(e,t,134217728,n)}ey(t,134217728)}};G2=function(t){if(t.tag===13){var e=vi(t),n=xo(t,e);if(n!==null){var r=rn();pr(n,t,e,r)}ey(t,e)}};K2=function(){return ze};q2=function(t,e){var n=ze;try{return ze=t,e()}finally{ze=n}};Tm=function(t,e,n){switch(e){case"input":if(Em(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var o=zf(r);if(!o)throw Error(Z(90));S2(r),Em(r,o)}}}break;case"textarea":I2(t,n);break;case"select":e=n.value,e!=null&&ss(t,!!n.multiple,e,!1)}};M2=Xg;O2=pa;var HP={usingClientEntryPoint:!1,Events:[Bc,Za,zf,P2,D2,Xg]},xu={findFiberByHostInstance:Yi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},GP={bundleType:xu.bundleType,version:xu.version,rendererPackageName:xu.rendererPackageName,rendererConfig:xu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:So.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=B2(t),t===null?null:t.stateNode},findFiberByHostInstance:xu.findFiberByHostInstance||zP,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Nl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Nl.isDisabled&&Nl.supportsFiber)try{jf=Nl.inject(GP),Br=Nl}catch{}}Fn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=HP;Fn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!ny(e))throw Error(Z(200));return $P(t,e,null,n)};Fn.createRoot=function(t,e){if(!ny(t))throw Error(Z(299));var n=!1,r="",o=vC;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(o=e.onRecoverableError)),e=Zg(t,1,!1,null,null,n,!1,r,o),t[yo]=e.current,rc(t.nodeType===8?t.parentNode:t),new ty(e)};Fn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(Z(188)):(t=Object.keys(t).join(","),Error(Z(268,t)));return t=B2(e),t=t===null?null:t.stateNode,t};Fn.flushSync=function(t){return pa(t)};Fn.hydrate=function(t,e,n){if(!Jf(e))throw Error(Z(200));return Zf(null,t,e,!0,n)};Fn.hydrateRoot=function(t,e,n){if(!ny(t))throw Error(Z(405));var r=n!=null&&n.hydratedSources||null,o=!1,i="",a=vC;if(n!=null&&(n.unstable_strictMode===!0&&(o=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(a=n.onRecoverableError)),e=mC(e,null,t,1,n??null,o,!1,i,a),t[yo]=e.current,rc(t),r)for(t=0;t<r.length;t++)n=r[t],o=n._getVersion,o=o(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,o]:e.mutableSourceEagerHydrationData.push(n,o);return new Qf(e)};Fn.render=function(t,e,n){if(!Jf(e))throw Error(Z(200));return Zf(null,t,e,!1,n)};Fn.unmountComponentAtNode=function(t){if(!Jf(t))throw Error(Z(40));return t._reactRootContainer?(pa(function(){Zf(null,null,t,!1,function(){t._reactRootContainer=null,t[yo]=null})}),!0):!1};Fn.unstable_batchedUpdates=Xg;Fn.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Jf(n))throw Error(Z(200));if(t==null||t._reactInternals===void 0)throw Error(Z(38));return Zf(t,e,n,!1,r)};Fn.version="18.3.1-next-f1338f8080-20240426";function gC(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(gC)}catch(t){console.error(t)}}gC(),g2.exports=Fn;var Uc=g2.exports;const yC=i2(Uc);var xC,ux=Uc;xC=ux.createRoot,ux.hydrateRoot;const KP=1,qP=1e6;let gp=0;function XP(){return gp=(gp+1)%Number.MAX_SAFE_INTEGER,gp.toString()}const yp=new Map,cx=t=>{if(yp.has(t))return;const e=setTimeout(()=>{yp.delete(t),zu({type:"REMOVE_TOAST",toastId:t})},qP);yp.set(t,e)},YP=(t,e)=>{switch(e.type){case"ADD_TOAST":return{...t,toasts:[e.toast,...t.toasts].slice(0,KP)};case"UPDATE_TOAST":return{...t,toasts:t.toasts.map(n=>n.id===e.toast.id?{...n,...e.toast}:n)};case"DISMISS_TOAST":{const{toastId:n}=e;return n?cx(n):t.toasts.forEach(r=>{cx(r.id)}),{...t,toasts:t.toasts.map(r=>r.id===n||n===void 0?{...r,open:!1}:r)}}case"REMOVE_TOAST":return e.toastId===void 0?{...t,toasts:[]}:{...t,toasts:t.toasts.filter(n=>n.id!==e.toastId)}}},md=[];let vd={toasts:[]};function zu(t){vd=YP(vd,t),md.forEach(e=>{e(vd)})}function QP({...t}){const e=XP(),n=o=>zu({type:"UPDATE_TOAST",toast:{...o,id:e}}),r=()=>zu({type:"DISMISS_TOAST",toastId:e});return zu({type:"ADD_TOAST",toast:{...t,id:e,open:!0,onOpenChange:o=>{o||r()}}}),{id:e,dismiss:r,update:n}}function ry(){const[t,e]=C.useState(vd);return C.useEffect(()=>(md.push(e),()=>{const n=md.indexOf(e);n>-1&&md.splice(n,1)}),[t]),{...t,toast:QP,dismiss:n=>zu({type:"DISMISS_TOAST",toastId:n})}}function ve(t,e,{checkForDefaultPrevented:n=!0}={}){return function(o){if(t==null||t(o),n===!1||!o.defaultPrevented)return e==null?void 0:e(o)}}function lx(t,e){if(typeof t=="function")return t(e);t!=null&&(t.current=e)}function eh(...t){return e=>{let n=!1;const r=t.map(o=>{const i=lx(o,e);return!n&&typeof i=="function"&&(n=!0),i});if(n)return()=>{for(let o=0;o<r.length;o++){const i=r[o];typeof i=="function"?i():lx(t[o],null)}}}}function Pt(...t){return C.useCallback(eh(...t),t)}function ko(t,e=[]){let n=[];function r(i,a){const s=C.createContext(a),u=n.length;n=[...n,a];const c=d=>{var v;const{scope:f,children:h,...m}=d,p=((v=f==null?void 0:f[t])==null?void 0:v[u])||s,g=C.useMemo(()=>m,Object.values(m));return w.jsx(p.Provider,{value:g,children:h})};c.displayName=i+"Provider";function l(d,f){var p;const h=((p=f==null?void 0:f[t])==null?void 0:p[u])||s,m=C.useContext(h);if(m)return m;if(a!==void 0)return a;throw new Error(`\`${d}\` must be used within \`${i}\``)}return[c,l]}const o=()=>{const i=n.map(a=>C.createContext(a));return function(s){const u=(s==null?void 0:s[t])||i;return C.useMemo(()=>({[`__scope${t}`]:{...s,[t]:u}}),[s,u])}};return o.scopeName=t,[r,JP(o,...e)]}function JP(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const r=t.map(o=>({useScope:o(),scopeName:o.scopeName}));return function(i){const a=r.reduce((s,{useScope:u,scopeName:c})=>{const d=u(i)[`__scope${c}`];return{...s,...d}},{});return C.useMemo(()=>({[`__scope${e.scopeName}`]:a}),[a])}};return n.scopeName=e.scopeName,n}function fc(t){const e=eD(t),n=C.forwardRef((r,o)=>{const{children:i,...a}=r,s=C.Children.toArray(i),u=s.find(nD);if(u){const c=u.props.children,l=s.map(d=>d===u?C.Children.count(c)>1?C.Children.only(null):C.isValidElement(c)?c.props.children:null:d);return w.jsx(e,{...a,ref:o,children:C.isValidElement(c)?C.cloneElement(c,void 0,l):null})}return w.jsx(e,{...a,ref:o,children:i})});return n.displayName=`${t}.Slot`,n}var ZP=fc("Slot");function eD(t){const e=C.forwardRef((n,r)=>{const{children:o,...i}=n;if(C.isValidElement(o)){const a=oD(o),s=rD(i,o.props);return o.type!==C.Fragment&&(s.ref=r?eh(r,a):a),C.cloneElement(o,s)}return C.Children.count(o)>1?C.Children.only(null):null});return e.displayName=`${t}.SlotClone`,e}var wC=Symbol("radix.slottable");function tD(t){const e=({children:n})=>w.jsx(w.Fragment,{children:n});return e.displayName=`${t}.Slottable`,e.__radixId=wC,e}function nD(t){return C.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===wC}function rD(t,e){const n={...e};for(const r in e){const o=t[r],i=e[r];/^on[A-Z]/.test(r)?o&&i?n[r]=(...s)=>{const u=i(...s);return o(...s),u}:o&&(n[r]=o):r==="style"?n[r]={...o,...i}:r==="className"&&(n[r]=[o,i].filter(Boolean).join(" "))}return{...t,...n}}function oD(t){var r,o;let e=(r=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(o=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:o.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}function oy(t){const e=t+"CollectionProvider",[n,r]=ko(e),[o,i]=n(e,{collectionRef:{current:null},itemMap:new Map}),a=p=>{const{scope:g,children:v}=p,y=ne.useRef(null),x=ne.useRef(new Map).current;return w.jsx(o,{scope:g,itemMap:x,collectionRef:y,children:v})};a.displayName=e;const s=t+"CollectionSlot",u=fc(s),c=ne.forwardRef((p,g)=>{const{scope:v,children:y}=p,x=i(s,v),b=Pt(g,x.collectionRef);return w.jsx(u,{ref:b,children:y})});c.displayName=s;const l=t+"CollectionItemSlot",d="data-radix-collection-item",f=fc(l),h=ne.forwardRef((p,g)=>{const{scope:v,children:y,...x}=p,b=ne.useRef(null),E=Pt(g,b),_=i(l,v);return ne.useEffect(()=>(_.itemMap.set(b,{ref:b,...x}),()=>void _.itemMap.delete(b))),w.jsx(f,{[d]:"",ref:E,children:y})});h.displayName=l;function m(p){const g=i(t+"CollectionConsumer",p);return ne.useCallback(()=>{const y=g.collectionRef.current;if(!y)return[];const x=Array.from(y.querySelectorAll(`[${d}]`));return Array.from(g.itemMap.values()).sort((_,S)=>x.indexOf(_.ref.current)-x.indexOf(S.ref.current))},[g.collectionRef,g.itemMap])}return[{Provider:a,Slot:c,ItemSlot:h},m,r]}var iD=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Ue=iD.reduce((t,e)=>{const n=fc(`Primitive.${e}`),r=C.forwardRef((o,i)=>{const{asChild:a,...s}=o,u=a?n:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),w.jsx(u,{...s,ref:i})});return r.displayName=`Primitive.${e}`,{...t,[e]:r}},{});function iy(t,e){t&&Uc.flushSync(()=>t.dispatchEvent(e))}function wn(t){const e=C.useRef(t);return C.useEffect(()=>{e.current=t}),C.useMemo(()=>(...n)=>{var r;return(r=e.current)==null?void 0:r.call(e,...n)},[])}function aD(t,e=globalThis==null?void 0:globalThis.document){const n=wn(t);C.useEffect(()=>{const r=o=>{o.key==="Escape"&&n(o)};return e.addEventListener("keydown",r,{capture:!0}),()=>e.removeEventListener("keydown",r,{capture:!0})},[n,e])}var sD="DismissableLayer",uv="dismissableLayer.update",uD="dismissableLayer.pointerDownOutside",cD="dismissableLayer.focusOutside",dx,bC=C.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),th=C.forwardRef((t,e)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:r,onPointerDownOutside:o,onFocusOutside:i,onInteractOutside:a,onDismiss:s,...u}=t,c=C.useContext(bC),[l,d]=C.useState(null),f=(l==null?void 0:l.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,h]=C.useState({}),m=Pt(e,S=>d(S)),p=Array.from(c.layers),[g]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),v=p.indexOf(g),y=l?p.indexOf(l):-1,x=c.layersWithOutsidePointerEventsDisabled.size>0,b=y>=v,E=dD(S=>{const k=S.target,R=[...c.branches].some(I=>I.contains(k));!b||R||(o==null||o(S),a==null||a(S),S.defaultPrevented||s==null||s())},f),_=fD(S=>{const k=S.target;[...c.branches].some(I=>I.contains(k))||(i==null||i(S),a==null||a(S),S.defaultPrevented||s==null||s())},f);return aD(S=>{y===c.layers.size-1&&(r==null||r(S),!S.defaultPrevented&&s&&(S.preventDefault(),s()))},f),C.useEffect(()=>{if(l)return n&&(c.layersWithOutsidePointerEventsDisabled.size===0&&(dx=f.body.style.pointerEvents,f.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(l)),c.layers.add(l),fx(),()=>{n&&c.layersWithOutsidePointerEventsDisabled.size===1&&(f.body.style.pointerEvents=dx)}},[l,f,n,c]),C.useEffect(()=>()=>{l&&(c.layers.delete(l),c.layersWithOutsidePointerEventsDisabled.delete(l),fx())},[l,c]),C.useEffect(()=>{const S=()=>h({});return document.addEventListener(uv,S),()=>document.removeEventListener(uv,S)},[]),w.jsx(Ue.div,{...u,ref:m,style:{pointerEvents:x?b?"auto":"none":void 0,...t.style},onFocusCapture:ve(t.onFocusCapture,_.onFocusCapture),onBlurCapture:ve(t.onBlurCapture,_.onBlurCapture),onPointerDownCapture:ve(t.onPointerDownCapture,E.onPointerDownCapture)})});th.displayName=sD;var lD="DismissableLayerBranch",EC=C.forwardRef((t,e)=>{const n=C.useContext(bC),r=C.useRef(null),o=Pt(e,r);return C.useEffect(()=>{const i=r.current;if(i)return n.branches.add(i),()=>{n.branches.delete(i)}},[n.branches]),w.jsx(Ue.div,{...t,ref:o})});EC.displayName=lD;function dD(t,e=globalThis==null?void 0:globalThis.document){const n=wn(t),r=C.useRef(!1),o=C.useRef(()=>{});return C.useEffect(()=>{const i=s=>{if(s.target&&!r.current){let u=function(){CC(uD,n,c,{discrete:!0})};const c={originalEvent:s};s.pointerType==="touch"?(e.removeEventListener("click",o.current),o.current=u,e.addEventListener("click",o.current,{once:!0})):u()}else e.removeEventListener("click",o.current);r.current=!1},a=window.setTimeout(()=>{e.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(a),e.removeEventListener("pointerdown",i),e.removeEventListener("click",o.current)}},[e,n]),{onPointerDownCapture:()=>r.current=!0}}function fD(t,e=globalThis==null?void 0:globalThis.document){const n=wn(t),r=C.useRef(!1);return C.useEffect(()=>{const o=i=>{i.target&&!r.current&&CC(cD,n,{originalEvent:i},{discrete:!1})};return e.addEventListener("focusin",o),()=>e.removeEventListener("focusin",o)},[e,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function fx(){const t=new CustomEvent(uv);document.dispatchEvent(t)}function CC(t,e,n,{discrete:r}){const o=n.originalEvent.target,i=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:n});e&&o.addEventListener(t,e,{once:!0}),r?iy(o,i):o.dispatchEvent(i)}var hD=th,pD=EC,Xn=globalThis!=null&&globalThis.document?C.useLayoutEffect:()=>{},mD="Portal",ay=C.forwardRef((t,e)=>{var s;const{container:n,...r}=t,[o,i]=C.useState(!1);Xn(()=>i(!0),[]);const a=n||o&&((s=globalThis==null?void 0:globalThis.document)==null?void 0:s.body);return a?yC.createPortal(w.jsx(Ue.div,{...r,ref:e}),a):null});ay.displayName=mD;function vD(t,e){return C.useReducer((n,r)=>e[n][r]??n,t)}var Di=t=>{const{present:e,children:n}=t,r=gD(e),o=typeof n=="function"?n({present:r.isPresent}):C.Children.only(n),i=Pt(r.ref,yD(o));return typeof n=="function"||r.isPresent?C.cloneElement(o,{ref:i}):null};Di.displayName="Presence";function gD(t){const[e,n]=C.useState(),r=C.useRef(null),o=C.useRef(t),i=C.useRef("none"),a=t?"mounted":"unmounted",[s,u]=vD(a,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return C.useEffect(()=>{const c=Al(r.current);i.current=s==="mounted"?c:"none"},[s]),Xn(()=>{const c=r.current,l=o.current;if(l!==t){const f=i.current,h=Al(c);t?u("MOUNT"):h==="none"||(c==null?void 0:c.display)==="none"?u("UNMOUNT"):u(l&&f!==h?"ANIMATION_OUT":"UNMOUNT"),o.current=t}},[t,u]),Xn(()=>{if(e){let c;const l=e.ownerDocument.defaultView??window,d=h=>{const p=Al(r.current).includes(h.animationName);if(h.target===e&&p&&(u("ANIMATION_END"),!o.current)){const g=e.style.animationFillMode;e.style.animationFillMode="forwards",c=l.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=g)})}},f=h=>{h.target===e&&(i.current=Al(r.current))};return e.addEventListener("animationstart",f),e.addEventListener("animationcancel",d),e.addEventListener("animationend",d),()=>{l.clearTimeout(c),e.removeEventListener("animationstart",f),e.removeEventListener("animationcancel",d),e.removeEventListener("animationend",d)}}else u("ANIMATION_END")},[e,u]),{isPresent:["mounted","unmountSuspended"].includes(s),ref:C.useCallback(c=>{r.current=c?getComputedStyle(c):null,n(c)},[])}}function Al(t){return(t==null?void 0:t.animationName)||"none"}function yD(t){var r,o;let e=(r=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(o=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:o.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}var xD=fg[" useInsertionEffect ".trim().toString()]||Xn;function nh({prop:t,defaultProp:e,onChange:n=()=>{},caller:r}){const[o,i,a]=wD({defaultProp:e,onChange:n}),s=t!==void 0,u=s?t:o;{const l=C.useRef(t!==void 0);C.useEffect(()=>{const d=l.current;d!==s&&console.warn(`${r} is changing from ${d?"controlled":"uncontrolled"} to ${s?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),l.current=s},[s,r])}const c=C.useCallback(l=>{var d;if(s){const f=bD(l)?l(t):l;f!==t&&((d=a.current)==null||d.call(a,f))}else i(l)},[s,t,i,a]);return[u,c]}function wD({defaultProp:t,onChange:e}){const[n,r]=C.useState(t),o=C.useRef(n),i=C.useRef(e);return xD(()=>{i.current=e},[e]),C.useEffect(()=>{var a;o.current!==n&&((a=i.current)==null||a.call(i,n),o.current=n)},[n,o]),[n,r,i]}function bD(t){return typeof t=="function"}var ED=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),CD="VisuallyHidden",rh=C.forwardRef((t,e)=>w.jsx(Ue.span,{...t,ref:e,style:{...ED,...t.style}}));rh.displayName=CD;var _D=rh,sy="ToastProvider",[uy,SD,kD]=oy("Toast"),[_C,$K]=ko("Toast",[kD]),[ID,oh]=_C(sy),SC=t=>{const{__scopeToast:e,label:n="Notification",duration:r=5e3,swipeDirection:o="right",swipeThreshold:i=50,children:a}=t,[s,u]=C.useState(null),[c,l]=C.useState(0),d=C.useRef(!1),f=C.useRef(!1);return n.trim()||console.error(`Invalid prop \`label\` supplied to \`${sy}\`. Expected non-empty \`string\`.`),w.jsx(uy.Provider,{scope:e,children:w.jsx(ID,{scope:e,label:n,duration:r,swipeDirection:o,swipeThreshold:i,toastCount:c,viewport:s,onViewportChange:u,onToastAdd:C.useCallback(()=>l(h=>h+1),[]),onToastRemove:C.useCallback(()=>l(h=>h-1),[]),isFocusedToastEscapeKeyDownRef:d,isClosePausedRef:f,children:a})})};SC.displayName=sy;var kC="ToastViewport",RD=["F8"],cv="toast.viewportPause",lv="toast.viewportResume",IC=C.forwardRef((t,e)=>{const{__scopeToast:n,hotkey:r=RD,label:o="Notifications ({hotkey})",...i}=t,a=oh(kC,n),s=SD(n),u=C.useRef(null),c=C.useRef(null),l=C.useRef(null),d=C.useRef(null),f=Pt(e,d,a.onViewportChange),h=r.join("+").replace(/Key/g,"").replace(/Digit/g,""),m=a.toastCount>0;C.useEffect(()=>{const g=v=>{var x;r.length!==0&&r.every(b=>v[b]||v.code===b)&&((x=d.current)==null||x.focus())};return document.addEventListener("keydown",g),()=>document.removeEventListener("keydown",g)},[r]),C.useEffect(()=>{const g=u.current,v=d.current;if(m&&g&&v){const y=()=>{if(!a.isClosePausedRef.current){const _=new CustomEvent(cv);v.dispatchEvent(_),a.isClosePausedRef.current=!0}},x=()=>{if(a.isClosePausedRef.current){const _=new CustomEvent(lv);v.dispatchEvent(_),a.isClosePausedRef.current=!1}},b=_=>{!g.contains(_.relatedTarget)&&x()},E=()=>{g.contains(document.activeElement)||x()};return g.addEventListener("focusin",y),g.addEventListener("focusout",b),g.addEventListener("pointermove",y),g.addEventListener("pointerleave",E),window.addEventListener("blur",y),window.addEventListener("focus",x),()=>{g.removeEventListener("focusin",y),g.removeEventListener("focusout",b),g.removeEventListener("pointermove",y),g.removeEventListener("pointerleave",E),window.removeEventListener("blur",y),window.removeEventListener("focus",x)}}},[m,a.isClosePausedRef]);const p=C.useCallback(({tabbingDirection:g})=>{const y=s().map(x=>{const b=x.ref.current,E=[b,...WD(b)];return g==="forwards"?E:E.reverse()});return(g==="forwards"?y.reverse():y).flat()},[s]);return C.useEffect(()=>{const g=d.current;if(g){const v=y=>{var E,_,S;const x=y.altKey||y.ctrlKey||y.metaKey;if(y.key==="Tab"&&!x){const k=document.activeElement,R=y.shiftKey;if(y.target===g&&R){(E=c.current)==null||E.focus();return}const A=p({tabbingDirection:R?"backwards":"forwards"}),W=A.findIndex(F=>F===k);xp(A.slice(W+1))?y.preventDefault():R?(_=c.current)==null||_.focus():(S=l.current)==null||S.focus()}};return g.addEventListener("keydown",v),()=>g.removeEventListener("keydown",v)}},[s,p]),w.jsxs(pD,{ref:u,role:"region","aria-label":o.replace("{hotkey}",h),tabIndex:-1,style:{pointerEvents:m?void 0:"none"},children:[m&&w.jsx(dv,{ref:c,onFocusFromOutsideViewport:()=>{const g=p({tabbingDirection:"forwards"});xp(g)}}),w.jsx(uy.Slot,{scope:n,children:w.jsx(Ue.ol,{tabIndex:-1,...i,ref:f})}),m&&w.jsx(dv,{ref:l,onFocusFromOutsideViewport:()=>{const g=p({tabbingDirection:"backwards"});xp(g)}})]})});IC.displayName=kC;var RC="ToastFocusProxy",dv=C.forwardRef((t,e)=>{const{__scopeToast:n,onFocusFromOutsideViewport:r,...o}=t,i=oh(RC,n);return w.jsx(rh,{"aria-hidden":!0,tabIndex:0,...o,ref:e,style:{position:"fixed"},onFocus:a=>{var c;const s=a.relatedTarget;!((c=i.viewport)!=null&&c.contains(s))&&r()}})});dv.displayName=RC;var Wc="Toast",TD="toast.swipeStart",ND="toast.swipeMove",AD="toast.swipeCancel",PD="toast.swipeEnd",TC=C.forwardRef((t,e)=>{const{forceMount:n,open:r,defaultOpen:o,onOpenChange:i,...a}=t,[s,u]=nh({prop:r,defaultProp:o??!0,onChange:i,caller:Wc});return w.jsx(Di,{present:n||s,children:w.jsx(OD,{open:s,...a,ref:e,onClose:()=>u(!1),onPause:wn(t.onPause),onResume:wn(t.onResume),onSwipeStart:ve(t.onSwipeStart,c=>{c.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:ve(t.onSwipeMove,c=>{const{x:l,y:d}=c.detail.delta;c.currentTarget.setAttribute("data-swipe","move"),c.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${l}px`),c.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${d}px`)}),onSwipeCancel:ve(t.onSwipeCancel,c=>{c.currentTarget.setAttribute("data-swipe","cancel"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),c.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),c.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:ve(t.onSwipeEnd,c=>{const{x:l,y:d}=c.detail.delta;c.currentTarget.setAttribute("data-swipe","end"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),c.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${l}px`),c.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${d}px`),u(!1)})})})});TC.displayName=Wc;var[DD,MD]=_C(Wc,{onClose(){}}),OD=C.forwardRef((t,e)=>{const{__scopeToast:n,type:r="foreground",duration:o,open:i,onClose:a,onEscapeKeyDown:s,onPause:u,onResume:c,onSwipeStart:l,onSwipeMove:d,onSwipeCancel:f,onSwipeEnd:h,...m}=t,p=oh(Wc,n),[g,v]=C.useState(null),y=Pt(e,F=>v(F)),x=C.useRef(null),b=C.useRef(null),E=o||p.duration,_=C.useRef(0),S=C.useRef(E),k=C.useRef(0),{onToastAdd:R,onToastRemove:I}=p,D=wn(()=>{var $;(g==null?void 0:g.contains(document.activeElement))&&(($=p.viewport)==null||$.focus()),a()}),A=C.useCallback(F=>{!F||F===1/0||(window.clearTimeout(k.current),_.current=new Date().getTime(),k.current=window.setTimeout(D,F))},[D]);C.useEffect(()=>{const F=p.viewport;if(F){const $=()=>{A(S.current),c==null||c()},j=()=>{const U=new Date().getTime()-_.current;S.current=S.current-U,window.clearTimeout(k.current),u==null||u()};return F.addEventListener(cv,j),F.addEventListener(lv,$),()=>{F.removeEventListener(cv,j),F.removeEventListener(lv,$)}}},[p.viewport,E,u,c,A]),C.useEffect(()=>{i&&!p.isClosePausedRef.current&&A(E)},[i,E,p.isClosePausedRef,A]),C.useEffect(()=>(R(),()=>I()),[R,I]);const W=C.useMemo(()=>g?FC(g):null,[g]);return p.viewport?w.jsxs(w.Fragment,{children:[W&&w.jsx(FD,{__scopeToast:n,role:"status","aria-live":r==="foreground"?"assertive":"polite","aria-atomic":!0,children:W}),w.jsx(DD,{scope:n,onClose:D,children:Uc.createPortal(w.jsx(uy.ItemSlot,{scope:n,children:w.jsx(hD,{asChild:!0,onEscapeKeyDown:ve(s,()=>{p.isFocusedToastEscapeKeyDownRef.current||D(),p.isFocusedToastEscapeKeyDownRef.current=!1}),children:w.jsx(Ue.li,{role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":i?"open":"closed","data-swipe-direction":p.swipeDirection,...m,ref:y,style:{userSelect:"none",touchAction:"none",...t.style},onKeyDown:ve(t.onKeyDown,F=>{F.key==="Escape"&&(s==null||s(F.nativeEvent),F.nativeEvent.defaultPrevented||(p.isFocusedToastEscapeKeyDownRef.current=!0,D()))}),onPointerDown:ve(t.onPointerDown,F=>{F.button===0&&(x.current={x:F.clientX,y:F.clientY})}),onPointerMove:ve(t.onPointerMove,F=>{if(!x.current)return;const $=F.clientX-x.current.x,j=F.clientY-x.current.y,U=!!b.current,M=["left","right"].includes(p.swipeDirection),P=["left","up"].includes(p.swipeDirection)?Math.min:Math.max,B=M?P(0,$):0,V=M?0:P(0,j),K=F.pointerType==="touch"?10:2,Q={x:B,y:V},te={originalEvent:F,delta:Q};U?(b.current=Q,Pl(ND,d,te,{discrete:!1})):hx(Q,p.swipeDirection,K)?(b.current=Q,Pl(TD,l,te,{discrete:!1}),F.target.setPointerCapture(F.pointerId)):(Math.abs($)>K||Math.abs(j)>K)&&(x.current=null)}),onPointerUp:ve(t.onPointerUp,F=>{const $=b.current,j=F.target;if(j.hasPointerCapture(F.pointerId)&&j.releasePointerCapture(F.pointerId),b.current=null,x.current=null,$){const U=F.currentTarget,M={originalEvent:F,delta:$};hx($,p.swipeDirection,p.swipeThreshold)?Pl(PD,h,M,{discrete:!0}):Pl(AD,f,M,{discrete:!0}),U.addEventListener("click",P=>P.preventDefault(),{once:!0})}})})})}),p.viewport)})]}):null}),FD=t=>{const{__scopeToast:e,children:n,...r}=t,o=oh(Wc,e),[i,a]=C.useState(!1),[s,u]=C.useState(!1);return jD(()=>a(!0)),C.useEffect(()=>{const c=window.setTimeout(()=>u(!0),1e3);return()=>window.clearTimeout(c)},[]),s?null:w.jsx(ay,{asChild:!0,children:w.jsx(rh,{...r,children:i&&w.jsxs(w.Fragment,{children:[o.label," ",n]})})})},LD="ToastTitle",NC=C.forwardRef((t,e)=>{const{__scopeToast:n,...r}=t;return w.jsx(Ue.div,{...r,ref:e})});NC.displayName=LD;var BD="ToastDescription",AC=C.forwardRef((t,e)=>{const{__scopeToast:n,...r}=t;return w.jsx(Ue.div,{...r,ref:e})});AC.displayName=BD;var PC="ToastAction",DC=C.forwardRef((t,e)=>{const{altText:n,...r}=t;return n.trim()?w.jsx(OC,{altText:n,asChild:!0,children:w.jsx(cy,{...r,ref:e})}):(console.error(`Invalid prop \`altText\` supplied to \`${PC}\`. Expected non-empty \`string\`.`),null)});DC.displayName=PC;var MC="ToastClose",cy=C.forwardRef((t,e)=>{const{__scopeToast:n,...r}=t,o=MD(MC,n);return w.jsx(OC,{asChild:!0,children:w.jsx(Ue.button,{type:"button",...r,ref:e,onClick:ve(t.onClick,o.onClose)})})});cy.displayName=MC;var OC=C.forwardRef((t,e)=>{const{__scopeToast:n,altText:r,...o}=t;return w.jsx(Ue.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":r||void 0,...o,ref:e})});function FC(t){const e=[];return Array.from(t.childNodes).forEach(r=>{if(r.nodeType===r.TEXT_NODE&&r.textContent&&e.push(r.textContent),UD(r)){const o=r.ariaHidden||r.hidden||r.style.display==="none",i=r.dataset.radixToastAnnounceExclude==="";if(!o)if(i){const a=r.dataset.radixToastAnnounceAlt;a&&e.push(a)}else e.push(...FC(r))}}),e}function Pl(t,e,n,{discrete:r}){const o=n.originalEvent.currentTarget,i=new CustomEvent(t,{bubbles:!0,cancelable:!0,detail:n});e&&o.addEventListener(t,e,{once:!0}),r?iy(o,i):o.dispatchEvent(i)}var hx=(t,e,n=0)=>{const r=Math.abs(t.x),o=Math.abs(t.y),i=r>o;return e==="left"||e==="right"?i&&r>n:!i&&o>n};function jD(t=()=>{}){const e=wn(t);Xn(()=>{let n=0,r=0;return n=window.requestAnimationFrame(()=>r=window.requestAnimationFrame(e)),()=>{window.cancelAnimationFrame(n),window.cancelAnimationFrame(r)}},[e])}function UD(t){return t.nodeType===t.ELEMENT_NODE}function WD(t){const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const o=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||o?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)e.push(n.currentNode);return e}function xp(t){const e=document.activeElement;return t.some(n=>n===e?!0:(n.focus(),document.activeElement!==e))}var $D=SC,LC=IC,BC=TC,jC=NC,UC=AC,WC=DC,$C=cy;function zC(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var o=t.length;for(e=0;e<o;e++)t[e]&&(n=zC(t[e]))&&(r&&(r+=" "),r+=n)}else for(n in t)t[n]&&(r&&(r+=" "),r+=n);return r}function VC(){for(var t,e,n=0,r="",o=arguments.length;n<o;n++)(t=arguments[n])&&(e=zC(t))&&(r&&(r+=" "),r+=e);return r}const px=t=>typeof t=="boolean"?`${t}`:t===0?"0":t,mx=VC,ih=(t,e)=>n=>{var r;if((e==null?void 0:e.variants)==null)return mx(t,n==null?void 0:n.class,n==null?void 0:n.className);const{variants:o,defaultVariants:i}=e,a=Object.keys(o).map(c=>{const l=n==null?void 0:n[c],d=i==null?void 0:i[c];if(l===null)return null;const f=px(l)||px(d);return o[c][f]}),s=n&&Object.entries(n).reduce((c,l)=>{let[d,f]=l;return f===void 0||(c[d]=f),c},{}),u=e==null||(r=e.compoundVariants)===null||r===void 0?void 0:r.reduce((c,l)=>{let{class:d,className:f,...h}=l;return Object.entries(h).every(m=>{let[p,g]=m;return Array.isArray(g)?g.includes({...i,...s}[p]):{...i,...s}[p]===g})?[...c,d,f]:c},[]);return mx(t,a,u,n==null?void 0:n.class,n==null?void 0:n.className)};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zD=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),HC=(...t)=>t.filter((e,n,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===n).join(" ").trim();/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var VD={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HD=C.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:o="",children:i,iconNode:a,...s},u)=>C.createElement("svg",{ref:u,...VD,width:e,height:e,stroke:t,strokeWidth:r?Number(n)*24/Number(e):n,className:HC("lucide",o),...s},[...a.map(([c,l])=>C.createElement(c,l)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ke=(t,e)=>{const n=C.forwardRef(({className:r,...o},i)=>C.createElement(HD,{ref:i,iconNode:e,className:HC(`lucide-${zD(t)}`,r),...o}));return n.displayName=`${t}`,n};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GD=ke("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vx=ke("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KD=ke("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qD=ke("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XD=ke("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YD=ke("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nu=ke("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GC=ke("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QD=ke("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JD=ke("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hc=ke("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZD=ke("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eM=ke("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tM=ke("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nM=ke("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gx=ke("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yx=ke("KeyRound",[["path",{d:"M2.586 17.414A2 2 0 0 0 2 18.828V21a1 1 0 0 0 1 1h3a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h1a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h.172a2 2 0 0 0 1.414-.586l.814-.814a6.5 6.5 0 1 0-4-4z",key:"1s6t7t"}],["circle",{cx:"16.5",cy:"7.5",r:".5",fill:"currentColor",key:"w0ekpg"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xx=ke("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wx=ke("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bx=ke("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ex=ke("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cx=ke("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ma=ke("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rM=ke("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xd=ke("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oM=ke("MicOff",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M18.89 13.23A7.12 7.12 0 0 0 19 12v-2",key:"80xlxr"}],["path",{d:"M5 10v2a7 7 0 0 0 12 5",key:"p2k8kg"}],["path",{d:"M15 9.34V5a3 3 0 0 0-5.68-1.33",key:"1gzdoj"}],["path",{d:"M9 9v3a3 3 0 0 0 5.12 2.12",key:"r2i35w"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yd=ke("Mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KC=ke("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _x=ke("Radio",[["path",{d:"M4.9 19.1C1 15.2 1 8.8 4.9 4.9",key:"1vaf9d"}],["path",{d:"M7.8 16.2c-2.3-2.3-2.3-6.1 0-8.5",key:"u1ii0m"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M16.2 7.8c2.3 2.3 2.3 6.1 0 8.5",key:"1j5fej"}],["path",{d:"M19.1 4.9C23 8.8 23 15.1 19.1 19",key:"10b0cb"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sx=ke("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iM=ke("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kx=ke("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zs=ke("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ix=ke("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qC=ke("Star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aM=ke("ThumbsDown",[["path",{d:"M17 14V2",key:"8ymqnk"}],["path",{d:"M9 18.12 10 14H4.17a2 2 0 0 1-1.92-2.56l2.33-8A2 2 0 0 1 6.5 2H20a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.76a2 2 0 0 0-1.79 1.11L12 22a3.13 3.13 0 0 1-3-3.88Z",key:"m61m77"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sM=ke("ThumbsUp",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2a3.13 3.13 0 0 1 3 3.88Z",key:"emmmcr"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uM=ke("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cM=ke("UserRound",[["circle",{cx:"12",cy:"8",r:"5",key:"1hypcn"}],["path",{d:"M20 21a8 8 0 0 0-16 0",key:"rfgkzh"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XC=ke("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lM=ke("Volume2",[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dM=ke("VolumeX",[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15",key:"1ewh16"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15",key:"5ykzw1"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pc=ke("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),ly="-",fM=t=>{const e=pM(t),{conflictingClassGroups:n,conflictingClassGroupModifiers:r}=t;return{getClassGroupId:a=>{const s=a.split(ly);return s[0]===""&&s.length!==1&&s.shift(),YC(s,e)||hM(a)},getConflictingClassGroupIds:(a,s)=>{const u=n[a]||[];return s&&r[a]?[...u,...r[a]]:u}}},YC=(t,e)=>{var a;if(t.length===0)return e.classGroupId;const n=t[0],r=e.nextPart.get(n),o=r?YC(t.slice(1),r):void 0;if(o)return o;if(e.validators.length===0)return;const i=t.join(ly);return(a=e.validators.find(({validator:s})=>s(i)))==null?void 0:a.classGroupId},Rx=/^\[(.+)\]$/,hM=t=>{if(Rx.test(t)){const e=Rx.exec(t)[1],n=e==null?void 0:e.substring(0,e.indexOf(":"));if(n)return"arbitrary.."+n}},pM=t=>{const{theme:e,prefix:n}=t,r={nextPart:new Map,validators:[]};return vM(Object.entries(t.classGroups),n).forEach(([i,a])=>{fv(a,r,i,e)}),r},fv=(t,e,n,r)=>{t.forEach(o=>{if(typeof o=="string"){const i=o===""?e:Tx(e,o);i.classGroupId=n;return}if(typeof o=="function"){if(mM(o)){fv(o(r),e,n,r);return}e.validators.push({validator:o,classGroupId:n});return}Object.entries(o).forEach(([i,a])=>{fv(a,Tx(e,i),n,r)})})},Tx=(t,e)=>{let n=t;return e.split(ly).forEach(r=>{n.nextPart.has(r)||n.nextPart.set(r,{nextPart:new Map,validators:[]}),n=n.nextPart.get(r)}),n},mM=t=>t.isThemeGetter,vM=(t,e)=>e?t.map(([n,r])=>{const o=r.map(i=>typeof i=="string"?e+i:typeof i=="object"?Object.fromEntries(Object.entries(i).map(([a,s])=>[e+a,s])):i);return[n,o]}):t,gM=t=>{if(t<1)return{get:()=>{},set:()=>{}};let e=0,n=new Map,r=new Map;const o=(i,a)=>{n.set(i,a),e++,e>t&&(e=0,r=n,n=new Map)};return{get(i){let a=n.get(i);if(a!==void 0)return a;if((a=r.get(i))!==void 0)return o(i,a),a},set(i,a){n.has(i)?n.set(i,a):o(i,a)}}},QC="!",yM=t=>{const{separator:e,experimentalParseClassName:n}=t,r=e.length===1,o=e[0],i=e.length,a=s=>{const u=[];let c=0,l=0,d;for(let g=0;g<s.length;g++){let v=s[g];if(c===0){if(v===o&&(r||s.slice(g,g+i)===e)){u.push(s.slice(l,g)),l=g+i;continue}if(v==="/"){d=g;continue}}v==="["?c++:v==="]"&&c--}const f=u.length===0?s:s.substring(l),h=f.startsWith(QC),m=h?f.substring(1):f,p=d&&d>l?d-l:void 0;return{modifiers:u,hasImportantModifier:h,baseClassName:m,maybePostfixModifierPosition:p}};return n?s=>n({className:s,parseClassName:a}):a},xM=t=>{if(t.length<=1)return t;const e=[];let n=[];return t.forEach(r=>{r[0]==="["?(e.push(...n.sort(),r),n=[]):n.push(r)}),e.push(...n.sort()),e},wM=t=>({cache:gM(t.cacheSize),parseClassName:yM(t),...fM(t)}),bM=/\s+/,EM=(t,e)=>{const{parseClassName:n,getClassGroupId:r,getConflictingClassGroupIds:o}=e,i=[],a=t.trim().split(bM);let s="";for(let u=a.length-1;u>=0;u-=1){const c=a[u],{modifiers:l,hasImportantModifier:d,baseClassName:f,maybePostfixModifierPosition:h}=n(c);let m=!!h,p=r(m?f.substring(0,h):f);if(!p){if(!m){s=c+(s.length>0?" "+s:s);continue}if(p=r(f),!p){s=c+(s.length>0?" "+s:s);continue}m=!1}const g=xM(l).join(":"),v=d?g+QC:g,y=v+p;if(i.includes(y))continue;i.push(y);const x=o(p,m);for(let b=0;b<x.length;++b){const E=x[b];i.push(v+E)}s=c+(s.length>0?" "+s:s)}return s};function CM(){let t=0,e,n,r="";for(;t<arguments.length;)(e=arguments[t++])&&(n=JC(e))&&(r&&(r+=" "),r+=n);return r}const JC=t=>{if(typeof t=="string")return t;let e,n="";for(let r=0;r<t.length;r++)t[r]&&(e=JC(t[r]))&&(n&&(n+=" "),n+=e);return n};function _M(t,...e){let n,r,o,i=a;function a(u){const c=e.reduce((l,d)=>d(l),t());return n=wM(c),r=n.cache.get,o=n.cache.set,i=s,s(u)}function s(u){const c=r(u);if(c)return c;const l=EM(u,n);return o(u,l),l}return function(){return i(CM.apply(null,arguments))}}const qe=t=>{const e=n=>n[t]||[];return e.isThemeGetter=!0,e},ZC=/^\[(?:([a-z-]+):)?(.+)\]$/i,SM=/^\d+\/\d+$/,kM=new Set(["px","full","screen"]),IM=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,RM=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,TM=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,NM=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,AM=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,to=t=>hs(t)||kM.has(t)||SM.test(t),jo=t=>iu(t,"length",jM),hs=t=>!!t&&!Number.isNaN(Number(t)),wp=t=>iu(t,"number",hs),wu=t=>!!t&&Number.isInteger(Number(t)),PM=t=>t.endsWith("%")&&hs(t.slice(0,-1)),Ie=t=>ZC.test(t),Uo=t=>IM.test(t),DM=new Set(["length","size","percentage"]),MM=t=>iu(t,DM,e_),OM=t=>iu(t,"position",e_),FM=new Set(["image","url"]),LM=t=>iu(t,FM,WM),BM=t=>iu(t,"",UM),bu=()=>!0,iu=(t,e,n)=>{const r=ZC.exec(t);return r?r[1]?typeof e=="string"?r[1]===e:e.has(r[1]):n(r[2]):!1},jM=t=>RM.test(t)&&!TM.test(t),e_=()=>!1,UM=t=>NM.test(t),WM=t=>AM.test(t),$M=()=>{const t=qe("colors"),e=qe("spacing"),n=qe("blur"),r=qe("brightness"),o=qe("borderColor"),i=qe("borderRadius"),a=qe("borderSpacing"),s=qe("borderWidth"),u=qe("contrast"),c=qe("grayscale"),l=qe("hueRotate"),d=qe("invert"),f=qe("gap"),h=qe("gradientColorStops"),m=qe("gradientColorStopPositions"),p=qe("inset"),g=qe("margin"),v=qe("opacity"),y=qe("padding"),x=qe("saturate"),b=qe("scale"),E=qe("sepia"),_=qe("skew"),S=qe("space"),k=qe("translate"),R=()=>["auto","contain","none"],I=()=>["auto","hidden","clip","visible","scroll"],D=()=>["auto",Ie,e],A=()=>[Ie,e],W=()=>["",to,jo],F=()=>["auto",hs,Ie],$=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],j=()=>["solid","dashed","dotted","double","none"],U=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],M=()=>["start","end","center","between","around","evenly","stretch"],P=()=>["","0",Ie],B=()=>["auto","avoid","all","avoid-page","page","left","right","column"],V=()=>[hs,Ie];return{cacheSize:500,separator:":",theme:{colors:[bu],spacing:[to,jo],blur:["none","",Uo,Ie],brightness:V(),borderColor:[t],borderRadius:["none","","full",Uo,Ie],borderSpacing:A(),borderWidth:W(),contrast:V(),grayscale:P(),hueRotate:V(),invert:P(),gap:A(),gradientColorStops:[t],gradientColorStopPositions:[PM,jo],inset:D(),margin:D(),opacity:V(),padding:A(),saturate:V(),scale:V(),sepia:P(),skew:V(),space:A(),translate:A()},classGroups:{aspect:[{aspect:["auto","square","video",Ie]}],container:["container"],columns:[{columns:[Uo]}],"break-after":[{"break-after":B()}],"break-before":[{"break-before":B()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...$(),Ie]}],overflow:[{overflow:I()}],"overflow-x":[{"overflow-x":I()}],"overflow-y":[{"overflow-y":I()}],overscroll:[{overscroll:R()}],"overscroll-x":[{"overscroll-x":R()}],"overscroll-y":[{"overscroll-y":R()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[p]}],"inset-x":[{"inset-x":[p]}],"inset-y":[{"inset-y":[p]}],start:[{start:[p]}],end:[{end:[p]}],top:[{top:[p]}],right:[{right:[p]}],bottom:[{bottom:[p]}],left:[{left:[p]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",wu,Ie]}],basis:[{basis:D()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Ie]}],grow:[{grow:P()}],shrink:[{shrink:P()}],order:[{order:["first","last","none",wu,Ie]}],"grid-cols":[{"grid-cols":[bu]}],"col-start-end":[{col:["auto",{span:["full",wu,Ie]},Ie]}],"col-start":[{"col-start":F()}],"col-end":[{"col-end":F()}],"grid-rows":[{"grid-rows":[bu]}],"row-start-end":[{row:["auto",{span:[wu,Ie]},Ie]}],"row-start":[{"row-start":F()}],"row-end":[{"row-end":F()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Ie]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Ie]}],gap:[{gap:[f]}],"gap-x":[{"gap-x":[f]}],"gap-y":[{"gap-y":[f]}],"justify-content":[{justify:["normal",...M()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...M(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...M(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[y]}],px:[{px:[y]}],py:[{py:[y]}],ps:[{ps:[y]}],pe:[{pe:[y]}],pt:[{pt:[y]}],pr:[{pr:[y]}],pb:[{pb:[y]}],pl:[{pl:[y]}],m:[{m:[g]}],mx:[{mx:[g]}],my:[{my:[g]}],ms:[{ms:[g]}],me:[{me:[g]}],mt:[{mt:[g]}],mr:[{mr:[g]}],mb:[{mb:[g]}],ml:[{ml:[g]}],"space-x":[{"space-x":[S]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[S]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",Ie,e]}],"min-w":[{"min-w":[Ie,e,"min","max","fit"]}],"max-w":[{"max-w":[Ie,e,"none","full","min","max","fit","prose",{screen:[Uo]},Uo]}],h:[{h:[Ie,e,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[Ie,e,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[Ie,e,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[Ie,e,"auto","min","max","fit"]}],"font-size":[{text:["base",Uo,jo]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",wp]}],"font-family":[{font:[bu]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",Ie]}],"line-clamp":[{"line-clamp":["none",hs,wp]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",to,Ie]}],"list-image":[{"list-image":["none",Ie]}],"list-style-type":[{list:["none","disc","decimal",Ie]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[t]}],"placeholder-opacity":[{"placeholder-opacity":[v]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[t]}],"text-opacity":[{"text-opacity":[v]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...j(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",to,jo]}],"underline-offset":[{"underline-offset":["auto",to,Ie]}],"text-decoration-color":[{decoration:[t]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:A()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Ie]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Ie]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[v]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...$(),OM]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",MM]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},LM]}],"bg-color":[{bg:[t]}],"gradient-from-pos":[{from:[m]}],"gradient-via-pos":[{via:[m]}],"gradient-to-pos":[{to:[m]}],"gradient-from":[{from:[h]}],"gradient-via":[{via:[h]}],"gradient-to":[{to:[h]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[s]}],"border-w-x":[{"border-x":[s]}],"border-w-y":[{"border-y":[s]}],"border-w-s":[{"border-s":[s]}],"border-w-e":[{"border-e":[s]}],"border-w-t":[{"border-t":[s]}],"border-w-r":[{"border-r":[s]}],"border-w-b":[{"border-b":[s]}],"border-w-l":[{"border-l":[s]}],"border-opacity":[{"border-opacity":[v]}],"border-style":[{border:[...j(),"hidden"]}],"divide-x":[{"divide-x":[s]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[s]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[v]}],"divide-style":[{divide:j()}],"border-color":[{border:[o]}],"border-color-x":[{"border-x":[o]}],"border-color-y":[{"border-y":[o]}],"border-color-s":[{"border-s":[o]}],"border-color-e":[{"border-e":[o]}],"border-color-t":[{"border-t":[o]}],"border-color-r":[{"border-r":[o]}],"border-color-b":[{"border-b":[o]}],"border-color-l":[{"border-l":[o]}],"divide-color":[{divide:[o]}],"outline-style":[{outline:["",...j()]}],"outline-offset":[{"outline-offset":[to,Ie]}],"outline-w":[{outline:[to,jo]}],"outline-color":[{outline:[t]}],"ring-w":[{ring:W()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[t]}],"ring-opacity":[{"ring-opacity":[v]}],"ring-offset-w":[{"ring-offset":[to,jo]}],"ring-offset-color":[{"ring-offset":[t]}],shadow:[{shadow:["","inner","none",Uo,BM]}],"shadow-color":[{shadow:[bu]}],opacity:[{opacity:[v]}],"mix-blend":[{"mix-blend":[...U(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":U()}],filter:[{filter:["","none"]}],blur:[{blur:[n]}],brightness:[{brightness:[r]}],contrast:[{contrast:[u]}],"drop-shadow":[{"drop-shadow":["","none",Uo,Ie]}],grayscale:[{grayscale:[c]}],"hue-rotate":[{"hue-rotate":[l]}],invert:[{invert:[d]}],saturate:[{saturate:[x]}],sepia:[{sepia:[E]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[n]}],"backdrop-brightness":[{"backdrop-brightness":[r]}],"backdrop-contrast":[{"backdrop-contrast":[u]}],"backdrop-grayscale":[{"backdrop-grayscale":[c]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[l]}],"backdrop-invert":[{"backdrop-invert":[d]}],"backdrop-opacity":[{"backdrop-opacity":[v]}],"backdrop-saturate":[{"backdrop-saturate":[x]}],"backdrop-sepia":[{"backdrop-sepia":[E]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[a]}],"border-spacing-x":[{"border-spacing-x":[a]}],"border-spacing-y":[{"border-spacing-y":[a]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Ie]}],duration:[{duration:V()}],ease:[{ease:["linear","in","out","in-out",Ie]}],delay:[{delay:V()}],animate:[{animate:["none","spin","ping","pulse","bounce",Ie]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[b]}],"scale-x":[{"scale-x":[b]}],"scale-y":[{"scale-y":[b]}],rotate:[{rotate:[wu,Ie]}],"translate-x":[{"translate-x":[k]}],"translate-y":[{"translate-y":[k]}],"skew-x":[{"skew-x":[_]}],"skew-y":[{"skew-y":[_]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Ie]}],accent:[{accent:["auto",t]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Ie]}],"caret-color":[{caret:[t]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":A()}],"scroll-mx":[{"scroll-mx":A()}],"scroll-my":[{"scroll-my":A()}],"scroll-ms":[{"scroll-ms":A()}],"scroll-me":[{"scroll-me":A()}],"scroll-mt":[{"scroll-mt":A()}],"scroll-mr":[{"scroll-mr":A()}],"scroll-mb":[{"scroll-mb":A()}],"scroll-ml":[{"scroll-ml":A()}],"scroll-p":[{"scroll-p":A()}],"scroll-px":[{"scroll-px":A()}],"scroll-py":[{"scroll-py":A()}],"scroll-ps":[{"scroll-ps":A()}],"scroll-pe":[{"scroll-pe":A()}],"scroll-pt":[{"scroll-pt":A()}],"scroll-pr":[{"scroll-pr":A()}],"scroll-pb":[{"scroll-pb":A()}],"scroll-pl":[{"scroll-pl":A()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Ie]}],fill:[{fill:[t,"none"]}],"stroke-w":[{stroke:[to,jo,wp]}],stroke:[{stroke:[t,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},zM=_M($M);function be(...t){return zM(VC(t))}const VM=$D,t_=C.forwardRef(({className:t,...e},n)=>w.jsx(LC,{ref:n,className:be("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",t),...e}));t_.displayName=LC.displayName;const HM=ih("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),n_=C.forwardRef(({className:t,variant:e,...n},r)=>w.jsx(BC,{ref:r,className:be(HM({variant:e}),t),...n}));n_.displayName=BC.displayName;const GM=C.forwardRef(({className:t,...e},n)=>w.jsx(WC,{ref:n,className:be("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors group-[.destructive]:border-muted/40 hover:bg-secondary group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 group-[.destructive]:focus:ring-destructive disabled:pointer-events-none disabled:opacity-50",t),...e}));GM.displayName=WC.displayName;const r_=C.forwardRef(({className:t,...e},n)=>w.jsx($C,{ref:n,className:be("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity group-hover:opacity-100 group-[.destructive]:text-red-300 hover:text-foreground group-[.destructive]:hover:text-red-50 focus:opacity-100 focus:outline-none focus:ring-2 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",t),"toast-close":"",...e,children:w.jsx(pc,{className:"h-4 w-4"})}));r_.displayName=$C.displayName;const o_=C.forwardRef(({className:t,...e},n)=>w.jsx(jC,{ref:n,className:be("text-sm font-semibold",t),...e}));o_.displayName=jC.displayName;const i_=C.forwardRef(({className:t,...e},n)=>w.jsx(UC,{ref:n,className:be("text-sm opacity-90",t),...e}));i_.displayName=UC.displayName;function KM(){const{toasts:t}=ry();return w.jsxs(VM,{children:[t.map(function({id:e,title:n,description:r,action:o,...i}){return w.jsxs(n_,{...i,children:[w.jsxs("div",{className:"grid gap-1",children:[n&&w.jsx(o_,{children:n}),r&&w.jsx(i_,{children:r})]}),o,w.jsx(r_,{})]},e)}),w.jsx(t_,{})]})}var Nx=["light","dark"],qM="(prefers-color-scheme: dark)",XM=C.createContext(void 0),YM={setTheme:t=>{},themes:[]},QM=()=>{var t;return(t=C.useContext(XM))!=null?t:YM};C.memo(({forcedTheme:t,storageKey:e,attribute:n,enableSystem:r,enableColorScheme:o,defaultTheme:i,value:a,attrs:s,nonce:u})=>{let c=i==="system",l=n==="class"?`var d=document.documentElement,c=d.classList;${`c.remove(${s.map(m=>`'${m}'`).join(",")})`};`:`var d=document.documentElement,n='${n}',s='setAttribute';`,d=o?Nx.includes(i)&&i?`if(e==='light'||e==='dark'||!e)d.style.colorScheme=e||'${i}'`:"if(e==='light'||e==='dark')d.style.colorScheme=e":"",f=(m,p=!1,g=!0)=>{let v=a?a[m]:m,y=p?m+"|| ''":`'${v}'`,x="";return o&&g&&!p&&Nx.includes(m)&&(x+=`d.style.colorScheme = '${m}';`),n==="class"?p||v?x+=`c.add(${y})`:x+="null":v&&(x+=`d[s](n,${y})`),x},h=t?`!function(){${l}${f(t)}}()`:r?`!function(){try{${l}var e=localStorage.getItem('${e}');if('system'===e||(!e&&${c})){var t='${qM}',m=window.matchMedia(t);if(m.media!==t||m.matches){${f("dark")}}else{${f("light")}}}else if(e){${a?`var x=${JSON.stringify(a)};`:""}${f(a?"x[e]":"e",!0)}}${c?"":"else{"+f(i,!1,!1)+"}"}${d}}catch(e){}}()`:`!function(){try{${l}var e=localStorage.getItem('${e}');if(e){${a?`var x=${JSON.stringify(a)};`:""}${f(a?"x[e]":"e",!0)}}else{${f(i,!1,!1)};}${d}}catch(t){}}();`;return C.createElement("script",{nonce:u,dangerouslySetInnerHTML:{__html:h}})});var JM=t=>{switch(t){case"success":return t3;case"info":return r3;case"warning":return n3;case"error":return o3;default:return null}},ZM=Array(12).fill(0),e3=({visible:t,className:e})=>ne.createElement("div",{className:["sonner-loading-wrapper",e].filter(Boolean).join(" "),"data-visible":t},ne.createElement("div",{className:"sonner-spinner"},ZM.map((n,r)=>ne.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${r}`})))),t3=ne.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},ne.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),n3=ne.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},ne.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),r3=ne.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},ne.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),o3=ne.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},ne.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),i3=ne.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},ne.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),ne.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),a3=()=>{let[t,e]=ne.useState(document.hidden);return ne.useEffect(()=>{let n=()=>{e(document.hidden)};return document.addEventListener("visibilitychange",n),()=>window.removeEventListener("visibilitychange",n)},[]),t},hv=1,s3=class{constructor(){this.subscribe=e=>(this.subscribers.push(e),()=>{let n=this.subscribers.indexOf(e);this.subscribers.splice(n,1)}),this.publish=e=>{this.subscribers.forEach(n=>n(e))},this.addToast=e=>{this.publish(e),this.toasts=[...this.toasts,e]},this.create=e=>{var n;let{message:r,...o}=e,i=typeof(e==null?void 0:e.id)=="number"||((n=e.id)==null?void 0:n.length)>0?e.id:hv++,a=this.toasts.find(u=>u.id===i),s=e.dismissible===void 0?!0:e.dismissible;return this.dismissedToasts.has(i)&&this.dismissedToasts.delete(i),a?this.toasts=this.toasts.map(u=>u.id===i?(this.publish({...u,...e,id:i,title:r}),{...u,...e,id:i,dismissible:s,title:r}):u):this.addToast({title:r,...o,dismissible:s,id:i}),i},this.dismiss=e=>(this.dismissedToasts.add(e),e||this.toasts.forEach(n=>{this.subscribers.forEach(r=>r({id:n.id,dismiss:!0}))}),this.subscribers.forEach(n=>n({id:e,dismiss:!0})),e),this.message=(e,n)=>this.create({...n,message:e}),this.error=(e,n)=>this.create({...n,message:e,type:"error"}),this.success=(e,n)=>this.create({...n,type:"success",message:e}),this.info=(e,n)=>this.create({...n,type:"info",message:e}),this.warning=(e,n)=>this.create({...n,type:"warning",message:e}),this.loading=(e,n)=>this.create({...n,type:"loading",message:e}),this.promise=(e,n)=>{if(!n)return;let r;n.loading!==void 0&&(r=this.create({...n,promise:e,type:"loading",message:n.loading,description:typeof n.description!="function"?n.description:void 0}));let o=e instanceof Promise?e:e(),i=r!==void 0,a,s=o.then(async c=>{if(a=["resolve",c],ne.isValidElement(c))i=!1,this.create({id:r,type:"default",message:c});else if(c3(c)&&!c.ok){i=!1;let l=typeof n.error=="function"?await n.error(`HTTP error! status: ${c.status}`):n.error,d=typeof n.description=="function"?await n.description(`HTTP error! status: ${c.status}`):n.description;this.create({id:r,type:"error",message:l,description:d})}else if(n.success!==void 0){i=!1;let l=typeof n.success=="function"?await n.success(c):n.success,d=typeof n.description=="function"?await n.description(c):n.description;this.create({id:r,type:"success",message:l,description:d})}}).catch(async c=>{if(a=["reject",c],n.error!==void 0){i=!1;let l=typeof n.error=="function"?await n.error(c):n.error,d=typeof n.description=="function"?await n.description(c):n.description;this.create({id:r,type:"error",message:l,description:d})}}).finally(()=>{var c;i&&(this.dismiss(r),r=void 0),(c=n.finally)==null||c.call(n)}),u=()=>new Promise((c,l)=>s.then(()=>a[0]==="reject"?l(a[1]):c(a[1])).catch(l));return typeof r!="string"&&typeof r!="number"?{unwrap:u}:Object.assign(r,{unwrap:u})},this.custom=(e,n)=>{let r=(n==null?void 0:n.id)||hv++;return this.create({jsx:e(r),id:r,...n}),r},this.getActiveToasts=()=>this.toasts.filter(e=>!this.dismissedToasts.has(e.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}},ln=new s3,u3=(t,e)=>{let n=(e==null?void 0:e.id)||hv++;return ln.addToast({title:t,...e,id:n}),n},c3=t=>t&&typeof t=="object"&&"ok"in t&&typeof t.ok=="boolean"&&"status"in t&&typeof t.status=="number",l3=u3,d3=()=>ln.toasts,f3=()=>ln.getActiveToasts();Object.assign(l3,{success:ln.success,info:ln.info,warning:ln.warning,error:ln.error,custom:ln.custom,message:ln.message,promise:ln.promise,dismiss:ln.dismiss,loading:ln.loading},{getHistory:d3,getToasts:f3});function h3(t,{insertAt:e}={}){if(typeof document>"u")return;let n=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",e==="top"&&n.firstChild?n.insertBefore(r,n.firstChild):n.appendChild(r),r.styleSheet?r.styleSheet.cssText=t:r.appendChild(document.createTextNode(t))}h3(`:where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999;transition:transform .4s ease}:where([data-sonner-toaster][data-lifted="true"]){transform:translateY(-10px)}@media (hover: none) and (pointer: coarse){:where([data-sonner-toaster][data-lifted="true"]){transform:none}}:where([data-sonner-toaster][data-x-position="right"]){right:var(--offset-right)}:where([data-sonner-toaster][data-x-position="left"]){left:var(--offset-left)}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:var(--offset-top)}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:var(--offset-bottom)}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast] [data-close-button]{background:var(--gray1)}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:-50%;right:-50%;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y, 0px)) translate(var(--swipe-amount-x, 0px));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-bg-hover: hsl(0, 0%, 12%);--normal-border: hsl(0, 0%, 20%);--normal-border-hover: hsl(0, 0%, 25%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}
`);function Dl(t){return t.label!==void 0}var p3=3,m3="32px",v3="16px",Ax=4e3,g3=356,y3=14,x3=20,w3=200;function nr(...t){return t.filter(Boolean).join(" ")}function b3(t){let[e,n]=t.split("-"),r=[];return e&&r.push(e),n&&r.push(n),r}var E3=t=>{var e,n,r,o,i,a,s,u,c,l,d;let{invert:f,toast:h,unstyled:m,interacting:p,setHeights:g,visibleToasts:v,heights:y,index:x,toasts:b,expanded:E,removeToast:_,defaultRichColors:S,closeButton:k,style:R,cancelButtonStyle:I,actionButtonStyle:D,className:A="",descriptionClassName:W="",duration:F,position:$,gap:j,loadingIcon:U,expandByDefault:M,classNames:P,icons:B,closeButtonAriaLabel:V="Close toast",pauseWhenPageIsHidden:K}=t,[Q,te]=ne.useState(null),[ae,X]=ne.useState(null),[J,ie]=ne.useState(!1),[oe,me]=ne.useState(!1),[ee,ye]=ne.useState(!1),[ge,Ne]=ne.useState(!1),[Me,Oe]=ne.useState(!1),[Mt,mt]=ne.useState(0),[et,Qn]=ne.useState(0),vt=ne.useRef(h.duration||F||Ax),Zt=ne.useRef(null),St=ne.useRef(null),Er=x===0,cn=x+1<=v,We=h.type,kt=h.dismissible!==!1,It=h.className||"",eo=h.descriptionClassName||"",Da=ne.useMemo(()=>y.findIndex(_e=>_e.toastId===h.id)||0,[y,h.id]),$h=ne.useMemo(()=>{var _e;return(_e=h.closeButton)!=null?_e:k},[h.closeButton,k]),fl=ne.useMemo(()=>h.duration||F||Ax,[h.duration,F]),ji=ne.useRef(0),Cr=ne.useRef(0),Ma=ne.useRef(0),Oa=ne.useRef(null),[vN,gN]=$.split("-"),Q0=ne.useMemo(()=>y.reduce((_e,Ve,Je)=>Je>=Da?_e:_e+Ve.height,0),[y,Da]),J0=a3(),yN=h.invert||f,zh=We==="loading";Cr.current=ne.useMemo(()=>Da*j+Q0,[Da,Q0]),ne.useEffect(()=>{vt.current=fl},[fl]),ne.useEffect(()=>{ie(!0)},[]),ne.useEffect(()=>{let _e=St.current;if(_e){let Ve=_e.getBoundingClientRect().height;return Qn(Ve),g(Je=>[{toastId:h.id,height:Ve,position:h.position},...Je]),()=>g(Je=>Je.filter(Jn=>Jn.toastId!==h.id))}},[g,h.id]),ne.useLayoutEffect(()=>{if(!J)return;let _e=St.current,Ve=_e.style.height;_e.style.height="auto";let Je=_e.getBoundingClientRect().height;_e.style.height=Ve,Qn(Je),g(Jn=>Jn.find(Zn=>Zn.toastId===h.id)?Jn.map(Zn=>Zn.toastId===h.id?{...Zn,height:Je}:Zn):[{toastId:h.id,height:Je,position:h.position},...Jn])},[J,h.title,h.description,g,h.id]);let Oo=ne.useCallback(()=>{me(!0),mt(Cr.current),g(_e=>_e.filter(Ve=>Ve.toastId!==h.id)),setTimeout(()=>{_(h)},w3)},[h,_,g,Cr]);ne.useEffect(()=>{if(h.promise&&We==="loading"||h.duration===1/0||h.type==="loading")return;let _e;return E||p||K&&J0?(()=>{if(Ma.current<ji.current){let Ve=new Date().getTime()-ji.current;vt.current=vt.current-Ve}Ma.current=new Date().getTime()})():vt.current!==1/0&&(ji.current=new Date().getTime(),_e=setTimeout(()=>{var Ve;(Ve=h.onAutoClose)==null||Ve.call(h,h),Oo()},vt.current)),()=>clearTimeout(_e)},[E,p,h,We,K,J0,Oo]),ne.useEffect(()=>{h.delete&&Oo()},[Oo,h.delete]);function xN(){var _e,Ve,Je;return B!=null&&B.loading?ne.createElement("div",{className:nr(P==null?void 0:P.loader,(_e=h==null?void 0:h.classNames)==null?void 0:_e.loader,"sonner-loader"),"data-visible":We==="loading"},B.loading):U?ne.createElement("div",{className:nr(P==null?void 0:P.loader,(Ve=h==null?void 0:h.classNames)==null?void 0:Ve.loader,"sonner-loader"),"data-visible":We==="loading"},U):ne.createElement(e3,{className:nr(P==null?void 0:P.loader,(Je=h==null?void 0:h.classNames)==null?void 0:Je.loader),visible:We==="loading"})}return ne.createElement("li",{tabIndex:0,ref:St,className:nr(A,It,P==null?void 0:P.toast,(e=h==null?void 0:h.classNames)==null?void 0:e.toast,P==null?void 0:P.default,P==null?void 0:P[We],(n=h==null?void 0:h.classNames)==null?void 0:n[We]),"data-sonner-toast":"","data-rich-colors":(r=h.richColors)!=null?r:S,"data-styled":!(h.jsx||h.unstyled||m),"data-mounted":J,"data-promise":!!h.promise,"data-swiped":Me,"data-removed":oe,"data-visible":cn,"data-y-position":vN,"data-x-position":gN,"data-index":x,"data-front":Er,"data-swiping":ee,"data-dismissible":kt,"data-type":We,"data-invert":yN,"data-swipe-out":ge,"data-swipe-direction":ae,"data-expanded":!!(E||M&&J),style:{"--index":x,"--toasts-before":x,"--z-index":b.length-x,"--offset":`${oe?Mt:Cr.current}px`,"--initial-height":M?"auto":`${et}px`,...R,...h.style},onDragEnd:()=>{ye(!1),te(null),Oa.current=null},onPointerDown:_e=>{zh||!kt||(Zt.current=new Date,mt(Cr.current),_e.target.setPointerCapture(_e.pointerId),_e.target.tagName!=="BUTTON"&&(ye(!0),Oa.current={x:_e.clientX,y:_e.clientY}))},onPointerUp:()=>{var _e,Ve,Je,Jn;if(ge||!kt)return;Oa.current=null;let Zn=Number(((_e=St.current)==null?void 0:_e.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),Fo=Number(((Ve=St.current)==null?void 0:Ve.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),Ui=new Date().getTime()-((Je=Zt.current)==null?void 0:Je.getTime()),er=Q==="x"?Zn:Fo,Lo=Math.abs(er)/Ui;if(Math.abs(er)>=x3||Lo>.11){mt(Cr.current),(Jn=h.onDismiss)==null||Jn.call(h,h),X(Q==="x"?Zn>0?"right":"left":Fo>0?"down":"up"),Oo(),Ne(!0),Oe(!1);return}ye(!1),te(null)},onPointerMove:_e=>{var Ve,Je,Jn,Zn;if(!Oa.current||!kt||((Ve=window.getSelection())==null?void 0:Ve.toString().length)>0)return;let Fo=_e.clientY-Oa.current.y,Ui=_e.clientX-Oa.current.x,er=(Je=t.swipeDirections)!=null?Je:b3($);!Q&&(Math.abs(Ui)>1||Math.abs(Fo)>1)&&te(Math.abs(Ui)>Math.abs(Fo)?"x":"y");let Lo={x:0,y:0};Q==="y"?(er.includes("top")||er.includes("bottom"))&&(er.includes("top")&&Fo<0||er.includes("bottom")&&Fo>0)&&(Lo.y=Fo):Q==="x"&&(er.includes("left")||er.includes("right"))&&(er.includes("left")&&Ui<0||er.includes("right")&&Ui>0)&&(Lo.x=Ui),(Math.abs(Lo.x)>0||Math.abs(Lo.y)>0)&&Oe(!0),(Jn=St.current)==null||Jn.style.setProperty("--swipe-amount-x",`${Lo.x}px`),(Zn=St.current)==null||Zn.style.setProperty("--swipe-amount-y",`${Lo.y}px`)}},$h&&!h.jsx?ne.createElement("button",{"aria-label":V,"data-disabled":zh,"data-close-button":!0,onClick:zh||!kt?()=>{}:()=>{var _e;Oo(),(_e=h.onDismiss)==null||_e.call(h,h)},className:nr(P==null?void 0:P.closeButton,(o=h==null?void 0:h.classNames)==null?void 0:o.closeButton)},(i=B==null?void 0:B.close)!=null?i:i3):null,h.jsx||C.isValidElement(h.title)?h.jsx?h.jsx:typeof h.title=="function"?h.title():h.title:ne.createElement(ne.Fragment,null,We||h.icon||h.promise?ne.createElement("div",{"data-icon":"",className:nr(P==null?void 0:P.icon,(a=h==null?void 0:h.classNames)==null?void 0:a.icon)},h.promise||h.type==="loading"&&!h.icon?h.icon||xN():null,h.type!=="loading"?h.icon||(B==null?void 0:B[We])||JM(We):null):null,ne.createElement("div",{"data-content":"",className:nr(P==null?void 0:P.content,(s=h==null?void 0:h.classNames)==null?void 0:s.content)},ne.createElement("div",{"data-title":"",className:nr(P==null?void 0:P.title,(u=h==null?void 0:h.classNames)==null?void 0:u.title)},typeof h.title=="function"?h.title():h.title),h.description?ne.createElement("div",{"data-description":"",className:nr(W,eo,P==null?void 0:P.description,(c=h==null?void 0:h.classNames)==null?void 0:c.description)},typeof h.description=="function"?h.description():h.description):null),C.isValidElement(h.cancel)?h.cancel:h.cancel&&Dl(h.cancel)?ne.createElement("button",{"data-button":!0,"data-cancel":!0,style:h.cancelButtonStyle||I,onClick:_e=>{var Ve,Je;Dl(h.cancel)&&kt&&((Je=(Ve=h.cancel).onClick)==null||Je.call(Ve,_e),Oo())},className:nr(P==null?void 0:P.cancelButton,(l=h==null?void 0:h.classNames)==null?void 0:l.cancelButton)},h.cancel.label):null,C.isValidElement(h.action)?h.action:h.action&&Dl(h.action)?ne.createElement("button",{"data-button":!0,"data-action":!0,style:h.actionButtonStyle||D,onClick:_e=>{var Ve,Je;Dl(h.action)&&((Je=(Ve=h.action).onClick)==null||Je.call(Ve,_e),!_e.defaultPrevented&&Oo())},className:nr(P==null?void 0:P.actionButton,(d=h==null?void 0:h.classNames)==null?void 0:d.actionButton)},h.action.label):null))};function Px(){if(typeof window>"u"||typeof document>"u")return"ltr";let t=document.documentElement.getAttribute("dir");return t==="auto"||!t?window.getComputedStyle(document.documentElement).direction:t}function C3(t,e){let n={};return[t,e].forEach((r,o)=>{let i=o===1,a=i?"--mobile-offset":"--offset",s=i?v3:m3;function u(c){["top","right","bottom","left"].forEach(l=>{n[`${a}-${l}`]=typeof c=="number"?`${c}px`:c})}typeof r=="number"||typeof r=="string"?u(r):typeof r=="object"?["top","right","bottom","left"].forEach(c=>{r[c]===void 0?n[`${a}-${c}`]=s:n[`${a}-${c}`]=typeof r[c]=="number"?`${r[c]}px`:r[c]}):u(s)}),n}var _3=C.forwardRef(function(t,e){let{invert:n,position:r="bottom-right",hotkey:o=["altKey","KeyT"],expand:i,closeButton:a,className:s,offset:u,mobileOffset:c,theme:l="light",richColors:d,duration:f,style:h,visibleToasts:m=p3,toastOptions:p,dir:g=Px(),gap:v=y3,loadingIcon:y,icons:x,containerAriaLabel:b="Notifications",pauseWhenPageIsHidden:E}=t,[_,S]=ne.useState([]),k=ne.useMemo(()=>Array.from(new Set([r].concat(_.filter(K=>K.position).map(K=>K.position)))),[_,r]),[R,I]=ne.useState([]),[D,A]=ne.useState(!1),[W,F]=ne.useState(!1),[$,j]=ne.useState(l!=="system"?l:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),U=ne.useRef(null),M=o.join("+").replace(/Key/g,"").replace(/Digit/g,""),P=ne.useRef(null),B=ne.useRef(!1),V=ne.useCallback(K=>{S(Q=>{var te;return(te=Q.find(ae=>ae.id===K.id))!=null&&te.delete||ln.dismiss(K.id),Q.filter(({id:ae})=>ae!==K.id)})},[]);return ne.useEffect(()=>ln.subscribe(K=>{if(K.dismiss){S(Q=>Q.map(te=>te.id===K.id?{...te,delete:!0}:te));return}setTimeout(()=>{yC.flushSync(()=>{S(Q=>{let te=Q.findIndex(ae=>ae.id===K.id);return te!==-1?[...Q.slice(0,te),{...Q[te],...K},...Q.slice(te+1)]:[K,...Q]})})})}),[]),ne.useEffect(()=>{if(l!=="system"){j(l);return}if(l==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?j("dark"):j("light")),typeof window>"u")return;let K=window.matchMedia("(prefers-color-scheme: dark)");try{K.addEventListener("change",({matches:Q})=>{j(Q?"dark":"light")})}catch{K.addListener(({matches:te})=>{try{j(te?"dark":"light")}catch(ae){console.error(ae)}})}},[l]),ne.useEffect(()=>{_.length<=1&&A(!1)},[_]),ne.useEffect(()=>{let K=Q=>{var te,ae;o.every(X=>Q[X]||Q.code===X)&&(A(!0),(te=U.current)==null||te.focus()),Q.code==="Escape"&&(document.activeElement===U.current||(ae=U.current)!=null&&ae.contains(document.activeElement))&&A(!1)};return document.addEventListener("keydown",K),()=>document.removeEventListener("keydown",K)},[o]),ne.useEffect(()=>{if(U.current)return()=>{P.current&&(P.current.focus({preventScroll:!0}),P.current=null,B.current=!1)}},[U.current]),ne.createElement("section",{ref:e,"aria-label":`${b} ${M}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},k.map((K,Q)=>{var te;let[ae,X]=K.split("-");return _.length?ne.createElement("ol",{key:K,dir:g==="auto"?Px():g,tabIndex:-1,ref:U,className:s,"data-sonner-toaster":!0,"data-theme":$,"data-y-position":ae,"data-lifted":D&&_.length>1&&!i,"data-x-position":X,style:{"--front-toast-height":`${((te=R[0])==null?void 0:te.height)||0}px`,"--width":`${g3}px`,"--gap":`${v}px`,...h,...C3(u,c)},onBlur:J=>{B.current&&!J.currentTarget.contains(J.relatedTarget)&&(B.current=!1,P.current&&(P.current.focus({preventScroll:!0}),P.current=null))},onFocus:J=>{J.target instanceof HTMLElement&&J.target.dataset.dismissible==="false"||B.current||(B.current=!0,P.current=J.relatedTarget)},onMouseEnter:()=>A(!0),onMouseMove:()=>A(!0),onMouseLeave:()=>{W||A(!1)},onDragEnd:()=>A(!1),onPointerDown:J=>{J.target instanceof HTMLElement&&J.target.dataset.dismissible==="false"||F(!0)},onPointerUp:()=>F(!1)},_.filter(J=>!J.position&&Q===0||J.position===K).map((J,ie)=>{var oe,me;return ne.createElement(E3,{key:J.id,icons:x,index:ie,toast:J,defaultRichColors:d,duration:(oe=p==null?void 0:p.duration)!=null?oe:f,className:p==null?void 0:p.className,descriptionClassName:p==null?void 0:p.descriptionClassName,invert:n,visibleToasts:m,closeButton:(me=p==null?void 0:p.closeButton)!=null?me:a,interacting:W,position:K,style:p==null?void 0:p.style,unstyled:p==null?void 0:p.unstyled,classNames:p==null?void 0:p.classNames,cancelButtonStyle:p==null?void 0:p.cancelButtonStyle,actionButtonStyle:p==null?void 0:p.actionButtonStyle,removeToast:V,toasts:_.filter(ee=>ee.position==J.position),heights:R.filter(ee=>ee.position==J.position),setHeights:I,expandByDefault:i,gap:v,loadingIcon:y,expanded:D,pauseWhenPageIsHidden:E,swipeDirections:t.swipeDirections})})):null}))});const S3=({...t})=>{const{theme:e="system"}=QM();return w.jsx(_3,{theme:e,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...t})};var k3=fg[" useId ".trim().toString()]||(()=>{}),I3=0;function Qd(t){const[e,n]=C.useState(k3());return Xn(()=>{t||n(r=>r??String(I3++))},[t]),t||(e?`radix-${e}`:"")}const R3=["top","right","bottom","left"],ki=Math.min,Sn=Math.max,Jd=Math.round,Ml=Math.floor,Ur=t=>({x:t,y:t}),T3={left:"right",right:"left",bottom:"top",top:"bottom"},N3={start:"end",end:"start"};function pv(t,e,n){return Sn(t,ki(e,n))}function bo(t,e){return typeof t=="function"?t(e):t}function Eo(t){return t.split("-")[0]}function au(t){return t.split("-")[1]}function dy(t){return t==="x"?"y":"x"}function fy(t){return t==="y"?"height":"width"}const A3=new Set(["top","bottom"]);function Fr(t){return A3.has(Eo(t))?"y":"x"}function hy(t){return dy(Fr(t))}function P3(t,e,n){n===void 0&&(n=!1);const r=au(t),o=hy(t),i=fy(o);let a=o==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return e.reference[i]>e.floating[i]&&(a=Zd(a)),[a,Zd(a)]}function D3(t){const e=Zd(t);return[mv(t),e,mv(e)]}function mv(t){return t.replace(/start|end/g,e=>N3[e])}const Dx=["left","right"],Mx=["right","left"],M3=["top","bottom"],O3=["bottom","top"];function F3(t,e,n){switch(t){case"top":case"bottom":return n?e?Mx:Dx:e?Dx:Mx;case"left":case"right":return e?M3:O3;default:return[]}}function L3(t,e,n,r){const o=au(t);let i=F3(Eo(t),n==="start",r);return o&&(i=i.map(a=>a+"-"+o),e&&(i=i.concat(i.map(mv)))),i}function Zd(t){return t.replace(/left|right|bottom|top/g,e=>T3[e])}function B3(t){return{top:0,right:0,bottom:0,left:0,...t}}function a_(t){return typeof t!="number"?B3(t):{top:t,right:t,bottom:t,left:t}}function ef(t){const{x:e,y:n,width:r,height:o}=t;return{width:r,height:o,top:n,left:e,right:e+r,bottom:n+o,x:e,y:n}}function Ox(t,e,n){let{reference:r,floating:o}=t;const i=Fr(e),a=hy(e),s=fy(a),u=Eo(e),c=i==="y",l=r.x+r.width/2-o.width/2,d=r.y+r.height/2-o.height/2,f=r[s]/2-o[s]/2;let h;switch(u){case"top":h={x:l,y:r.y-o.height};break;case"bottom":h={x:l,y:r.y+r.height};break;case"right":h={x:r.x+r.width,y:d};break;case"left":h={x:r.x-o.width,y:d};break;default:h={x:r.x,y:r.y}}switch(au(e)){case"start":h[a]-=f*(n&&c?-1:1);break;case"end":h[a]+=f*(n&&c?-1:1);break}return h}const j3=async(t,e,n)=>{const{placement:r="bottom",strategy:o="absolute",middleware:i=[],platform:a}=n,s=i.filter(Boolean),u=await(a.isRTL==null?void 0:a.isRTL(e));let c=await a.getElementRects({reference:t,floating:e,strategy:o}),{x:l,y:d}=Ox(c,r,u),f=r,h={},m=0;for(let p=0;p<s.length;p++){const{name:g,fn:v}=s[p],{x:y,y:x,data:b,reset:E}=await v({x:l,y:d,initialPlacement:r,placement:f,strategy:o,middlewareData:h,rects:c,platform:a,elements:{reference:t,floating:e}});l=y??l,d=x??d,h={...h,[g]:{...h[g],...b}},E&&m<=50&&(m++,typeof E=="object"&&(E.placement&&(f=E.placement),E.rects&&(c=E.rects===!0?await a.getElementRects({reference:t,floating:e,strategy:o}):E.rects),{x:l,y:d}=Ox(c,f,u)),p=-1)}return{x:l,y:d,placement:f,strategy:o,middlewareData:h}};async function mc(t,e){var n;e===void 0&&(e={});const{x:r,y:o,platform:i,rects:a,elements:s,strategy:u}=t,{boundary:c="clippingAncestors",rootBoundary:l="viewport",elementContext:d="floating",altBoundary:f=!1,padding:h=0}=bo(e,t),m=a_(h),g=s[f?d==="floating"?"reference":"floating":d],v=ef(await i.getClippingRect({element:(n=await(i.isElement==null?void 0:i.isElement(g)))==null||n?g:g.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(s.floating)),boundary:c,rootBoundary:l,strategy:u})),y=d==="floating"?{x:r,y:o,width:a.floating.width,height:a.floating.height}:a.reference,x=await(i.getOffsetParent==null?void 0:i.getOffsetParent(s.floating)),b=await(i.isElement==null?void 0:i.isElement(x))?await(i.getScale==null?void 0:i.getScale(x))||{x:1,y:1}:{x:1,y:1},E=ef(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:s,rect:y,offsetParent:x,strategy:u}):y);return{top:(v.top-E.top+m.top)/b.y,bottom:(E.bottom-v.bottom+m.bottom)/b.y,left:(v.left-E.left+m.left)/b.x,right:(E.right-v.right+m.right)/b.x}}const U3=t=>({name:"arrow",options:t,async fn(e){const{x:n,y:r,placement:o,rects:i,platform:a,elements:s,middlewareData:u}=e,{element:c,padding:l=0}=bo(t,e)||{};if(c==null)return{};const d=a_(l),f={x:n,y:r},h=hy(o),m=fy(h),p=await a.getDimensions(c),g=h==="y",v=g?"top":"left",y=g?"bottom":"right",x=g?"clientHeight":"clientWidth",b=i.reference[m]+i.reference[h]-f[h]-i.floating[m],E=f[h]-i.reference[h],_=await(a.getOffsetParent==null?void 0:a.getOffsetParent(c));let S=_?_[x]:0;(!S||!await(a.isElement==null?void 0:a.isElement(_)))&&(S=s.floating[x]||i.floating[m]);const k=b/2-E/2,R=S/2-p[m]/2-1,I=ki(d[v],R),D=ki(d[y],R),A=I,W=S-p[m]-D,F=S/2-p[m]/2+k,$=pv(A,F,W),j=!u.arrow&&au(o)!=null&&F!==$&&i.reference[m]/2-(F<A?I:D)-p[m]/2<0,U=j?F<A?F-A:F-W:0;return{[h]:f[h]+U,data:{[h]:$,centerOffset:F-$-U,...j&&{alignmentOffset:U}},reset:j}}}),W3=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var n,r;const{placement:o,middlewareData:i,rects:a,initialPlacement:s,platform:u,elements:c}=e,{mainAxis:l=!0,crossAxis:d=!0,fallbackPlacements:f,fallbackStrategy:h="bestFit",fallbackAxisSideDirection:m="none",flipAlignment:p=!0,...g}=bo(t,e);if((n=i.arrow)!=null&&n.alignmentOffset)return{};const v=Eo(o),y=Fr(s),x=Eo(s)===s,b=await(u.isRTL==null?void 0:u.isRTL(c.floating)),E=f||(x||!p?[Zd(s)]:D3(s)),_=m!=="none";!f&&_&&E.push(...L3(s,p,m,b));const S=[s,...E],k=await mc(e,g),R=[];let I=((r=i.flip)==null?void 0:r.overflows)||[];if(l&&R.push(k[v]),d){const F=P3(o,a,b);R.push(k[F[0]],k[F[1]])}if(I=[...I,{placement:o,overflows:R}],!R.every(F=>F<=0)){var D,A;const F=(((D=i.flip)==null?void 0:D.index)||0)+1,$=S[F];if($&&(!(d==="alignment"?y!==Fr($):!1)||I.every(M=>M.overflows[0]>0&&Fr(M.placement)===y)))return{data:{index:F,overflows:I},reset:{placement:$}};let j=(A=I.filter(U=>U.overflows[0]<=0).sort((U,M)=>U.overflows[1]-M.overflows[1])[0])==null?void 0:A.placement;if(!j)switch(h){case"bestFit":{var W;const U=(W=I.filter(M=>{if(_){const P=Fr(M.placement);return P===y||P==="y"}return!0}).map(M=>[M.placement,M.overflows.filter(P=>P>0).reduce((P,B)=>P+B,0)]).sort((M,P)=>M[1]-P[1])[0])==null?void 0:W[0];U&&(j=U);break}case"initialPlacement":j=s;break}if(o!==j)return{reset:{placement:j}}}return{}}}};function Fx(t,e){return{top:t.top-e.height,right:t.right-e.width,bottom:t.bottom-e.height,left:t.left-e.width}}function Lx(t){return R3.some(e=>t[e]>=0)}const $3=function(t){return t===void 0&&(t={}),{name:"hide",options:t,async fn(e){const{rects:n}=e,{strategy:r="referenceHidden",...o}=bo(t,e);switch(r){case"referenceHidden":{const i=await mc(e,{...o,elementContext:"reference"}),a=Fx(i,n.reference);return{data:{referenceHiddenOffsets:a,referenceHidden:Lx(a)}}}case"escaped":{const i=await mc(e,{...o,altBoundary:!0}),a=Fx(i,n.floating);return{data:{escapedOffsets:a,escaped:Lx(a)}}}default:return{}}}}},s_=new Set(["left","top"]);async function z3(t,e){const{placement:n,platform:r,elements:o}=t,i=await(r.isRTL==null?void 0:r.isRTL(o.floating)),a=Eo(n),s=au(n),u=Fr(n)==="y",c=s_.has(a)?-1:1,l=i&&u?-1:1,d=bo(e,t);let{mainAxis:f,crossAxis:h,alignmentAxis:m}=typeof d=="number"?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:d.mainAxis||0,crossAxis:d.crossAxis||0,alignmentAxis:d.alignmentAxis};return s&&typeof m=="number"&&(h=s==="end"?m*-1:m),u?{x:h*l,y:f*c}:{x:f*c,y:h*l}}const V3=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){var n,r;const{x:o,y:i,placement:a,middlewareData:s}=e,u=await z3(e,t);return a===((n=s.offset)==null?void 0:n.placement)&&(r=s.arrow)!=null&&r.alignmentOffset?{}:{x:o+u.x,y:i+u.y,data:{...u,placement:a}}}}},H3=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:n,y:r,placement:o}=e,{mainAxis:i=!0,crossAxis:a=!1,limiter:s={fn:g=>{let{x:v,y}=g;return{x:v,y}}},...u}=bo(t,e),c={x:n,y:r},l=await mc(e,u),d=Fr(Eo(o)),f=dy(d);let h=c[f],m=c[d];if(i){const g=f==="y"?"top":"left",v=f==="y"?"bottom":"right",y=h+l[g],x=h-l[v];h=pv(y,h,x)}if(a){const g=d==="y"?"top":"left",v=d==="y"?"bottom":"right",y=m+l[g],x=m-l[v];m=pv(y,m,x)}const p=s.fn({...e,[f]:h,[d]:m});return{...p,data:{x:p.x-n,y:p.y-r,enabled:{[f]:i,[d]:a}}}}}},G3=function(t){return t===void 0&&(t={}),{options:t,fn(e){const{x:n,y:r,placement:o,rects:i,middlewareData:a}=e,{offset:s=0,mainAxis:u=!0,crossAxis:c=!0}=bo(t,e),l={x:n,y:r},d=Fr(o),f=dy(d);let h=l[f],m=l[d];const p=bo(s,e),g=typeof p=="number"?{mainAxis:p,crossAxis:0}:{mainAxis:0,crossAxis:0,...p};if(u){const x=f==="y"?"height":"width",b=i.reference[f]-i.floating[x]+g.mainAxis,E=i.reference[f]+i.reference[x]-g.mainAxis;h<b?h=b:h>E&&(h=E)}if(c){var v,y;const x=f==="y"?"width":"height",b=s_.has(Eo(o)),E=i.reference[d]-i.floating[x]+(b&&((v=a.offset)==null?void 0:v[d])||0)+(b?0:g.crossAxis),_=i.reference[d]+i.reference[x]+(b?0:((y=a.offset)==null?void 0:y[d])||0)-(b?g.crossAxis:0);m<E?m=E:m>_&&(m=_)}return{[f]:h,[d]:m}}}},K3=function(t){return t===void 0&&(t={}),{name:"size",options:t,async fn(e){var n,r;const{placement:o,rects:i,platform:a,elements:s}=e,{apply:u=()=>{},...c}=bo(t,e),l=await mc(e,c),d=Eo(o),f=au(o),h=Fr(o)==="y",{width:m,height:p}=i.floating;let g,v;d==="top"||d==="bottom"?(g=d,v=f===(await(a.isRTL==null?void 0:a.isRTL(s.floating))?"start":"end")?"left":"right"):(v=d,g=f==="end"?"top":"bottom");const y=p-l.top-l.bottom,x=m-l.left-l.right,b=ki(p-l[g],y),E=ki(m-l[v],x),_=!e.middlewareData.shift;let S=b,k=E;if((n=e.middlewareData.shift)!=null&&n.enabled.x&&(k=x),(r=e.middlewareData.shift)!=null&&r.enabled.y&&(S=y),_&&!f){const I=Sn(l.left,0),D=Sn(l.right,0),A=Sn(l.top,0),W=Sn(l.bottom,0);h?k=m-2*(I!==0||D!==0?I+D:Sn(l.left,l.right)):S=p-2*(A!==0||W!==0?A+W:Sn(l.top,l.bottom))}await u({...e,availableWidth:k,availableHeight:S});const R=await a.getDimensions(s.floating);return m!==R.width||p!==R.height?{reset:{rects:!0}}:{}}}};function ah(){return typeof window<"u"}function su(t){return u_(t)?(t.nodeName||"").toLowerCase():"#document"}function Dn(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function qr(t){var e;return(e=(u_(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function u_(t){return ah()?t instanceof Node||t instanceof Dn(t).Node:!1}function gr(t){return ah()?t instanceof Element||t instanceof Dn(t).Element:!1}function Gr(t){return ah()?t instanceof HTMLElement||t instanceof Dn(t).HTMLElement:!1}function Bx(t){return!ah()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof Dn(t).ShadowRoot}const q3=new Set(["inline","contents"]);function $c(t){const{overflow:e,overflowX:n,overflowY:r,display:o}=yr(t);return/auto|scroll|overlay|hidden|clip/.test(e+r+n)&&!q3.has(o)}const X3=new Set(["table","td","th"]);function Y3(t){return X3.has(su(t))}const Q3=[":popover-open",":modal"];function sh(t){return Q3.some(e=>{try{return t.matches(e)}catch{return!1}})}const J3=["transform","translate","scale","rotate","perspective"],Z3=["transform","translate","scale","rotate","perspective","filter"],eO=["paint","layout","strict","content"];function py(t){const e=my(),n=gr(t)?yr(t):t;return J3.some(r=>n[r]?n[r]!=="none":!1)||(n.containerType?n.containerType!=="normal":!1)||!e&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!e&&(n.filter?n.filter!=="none":!1)||Z3.some(r=>(n.willChange||"").includes(r))||eO.some(r=>(n.contain||"").includes(r))}function tO(t){let e=Ii(t);for(;Gr(e)&&!Vs(e);){if(py(e))return e;if(sh(e))return null;e=Ii(e)}return null}function my(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const nO=new Set(["html","body","#document"]);function Vs(t){return nO.has(su(t))}function yr(t){return Dn(t).getComputedStyle(t)}function uh(t){return gr(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function Ii(t){if(su(t)==="html")return t;const e=t.assignedSlot||t.parentNode||Bx(t)&&t.host||qr(t);return Bx(e)?e.host:e}function c_(t){const e=Ii(t);return Vs(e)?t.ownerDocument?t.ownerDocument.body:t.body:Gr(e)&&$c(e)?e:c_(e)}function vc(t,e,n){var r;e===void 0&&(e=[]),n===void 0&&(n=!0);const o=c_(t),i=o===((r=t.ownerDocument)==null?void 0:r.body),a=Dn(o);if(i){const s=vv(a);return e.concat(a,a.visualViewport||[],$c(o)?o:[],s&&n?vc(s):[])}return e.concat(o,vc(o,[],n))}function vv(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function l_(t){const e=yr(t);let n=parseFloat(e.width)||0,r=parseFloat(e.height)||0;const o=Gr(t),i=o?t.offsetWidth:n,a=o?t.offsetHeight:r,s=Jd(n)!==i||Jd(r)!==a;return s&&(n=i,r=a),{width:n,height:r,$:s}}function vy(t){return gr(t)?t:t.contextElement}function ps(t){const e=vy(t);if(!Gr(e))return Ur(1);const n=e.getBoundingClientRect(),{width:r,height:o,$:i}=l_(e);let a=(i?Jd(n.width):n.width)/r,s=(i?Jd(n.height):n.height)/o;return(!a||!Number.isFinite(a))&&(a=1),(!s||!Number.isFinite(s))&&(s=1),{x:a,y:s}}const rO=Ur(0);function d_(t){const e=Dn(t);return!my()||!e.visualViewport?rO:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function oO(t,e,n){return e===void 0&&(e=!1),!n||e&&n!==Dn(t)?!1:e}function va(t,e,n,r){e===void 0&&(e=!1),n===void 0&&(n=!1);const o=t.getBoundingClientRect(),i=vy(t);let a=Ur(1);e&&(r?gr(r)&&(a=ps(r)):a=ps(t));const s=oO(i,n,r)?d_(i):Ur(0);let u=(o.left+s.x)/a.x,c=(o.top+s.y)/a.y,l=o.width/a.x,d=o.height/a.y;if(i){const f=Dn(i),h=r&&gr(r)?Dn(r):r;let m=f,p=vv(m);for(;p&&r&&h!==m;){const g=ps(p),v=p.getBoundingClientRect(),y=yr(p),x=v.left+(p.clientLeft+parseFloat(y.paddingLeft))*g.x,b=v.top+(p.clientTop+parseFloat(y.paddingTop))*g.y;u*=g.x,c*=g.y,l*=g.x,d*=g.y,u+=x,c+=b,m=Dn(p),p=vv(m)}}return ef({width:l,height:d,x:u,y:c})}function gy(t,e){const n=uh(t).scrollLeft;return e?e.left+n:va(qr(t)).left+n}function f_(t,e,n){n===void 0&&(n=!1);const r=t.getBoundingClientRect(),o=r.left+e.scrollLeft-(n?0:gy(t,r)),i=r.top+e.scrollTop;return{x:o,y:i}}function iO(t){let{elements:e,rect:n,offsetParent:r,strategy:o}=t;const i=o==="fixed",a=qr(r),s=e?sh(e.floating):!1;if(r===a||s&&i)return n;let u={scrollLeft:0,scrollTop:0},c=Ur(1);const l=Ur(0),d=Gr(r);if((d||!d&&!i)&&((su(r)!=="body"||$c(a))&&(u=uh(r)),Gr(r))){const h=va(r);c=ps(r),l.x=h.x+r.clientLeft,l.y=h.y+r.clientTop}const f=a&&!d&&!i?f_(a,u,!0):Ur(0);return{width:n.width*c.x,height:n.height*c.y,x:n.x*c.x-u.scrollLeft*c.x+l.x+f.x,y:n.y*c.y-u.scrollTop*c.y+l.y+f.y}}function aO(t){return Array.from(t.getClientRects())}function sO(t){const e=qr(t),n=uh(t),r=t.ownerDocument.body,o=Sn(e.scrollWidth,e.clientWidth,r.scrollWidth,r.clientWidth),i=Sn(e.scrollHeight,e.clientHeight,r.scrollHeight,r.clientHeight);let a=-n.scrollLeft+gy(t);const s=-n.scrollTop;return yr(r).direction==="rtl"&&(a+=Sn(e.clientWidth,r.clientWidth)-o),{width:o,height:i,x:a,y:s}}function uO(t,e){const n=Dn(t),r=qr(t),o=n.visualViewport;let i=r.clientWidth,a=r.clientHeight,s=0,u=0;if(o){i=o.width,a=o.height;const c=my();(!c||c&&e==="fixed")&&(s=o.offsetLeft,u=o.offsetTop)}return{width:i,height:a,x:s,y:u}}const cO=new Set(["absolute","fixed"]);function lO(t,e){const n=va(t,!0,e==="fixed"),r=n.top+t.clientTop,o=n.left+t.clientLeft,i=Gr(t)?ps(t):Ur(1),a=t.clientWidth*i.x,s=t.clientHeight*i.y,u=o*i.x,c=r*i.y;return{width:a,height:s,x:u,y:c}}function jx(t,e,n){let r;if(e==="viewport")r=uO(t,n);else if(e==="document")r=sO(qr(t));else if(gr(e))r=lO(e,n);else{const o=d_(t);r={x:e.x-o.x,y:e.y-o.y,width:e.width,height:e.height}}return ef(r)}function h_(t,e){const n=Ii(t);return n===e||!gr(n)||Vs(n)?!1:yr(n).position==="fixed"||h_(n,e)}function dO(t,e){const n=e.get(t);if(n)return n;let r=vc(t,[],!1).filter(s=>gr(s)&&su(s)!=="body"),o=null;const i=yr(t).position==="fixed";let a=i?Ii(t):t;for(;gr(a)&&!Vs(a);){const s=yr(a),u=py(a);!u&&s.position==="fixed"&&(o=null),(i?!u&&!o:!u&&s.position==="static"&&!!o&&cO.has(o.position)||$c(a)&&!u&&h_(t,a))?r=r.filter(l=>l!==a):o=s,a=Ii(a)}return e.set(t,r),r}function fO(t){let{element:e,boundary:n,rootBoundary:r,strategy:o}=t;const a=[...n==="clippingAncestors"?sh(e)?[]:dO(e,this._c):[].concat(n),r],s=a[0],u=a.reduce((c,l)=>{const d=jx(e,l,o);return c.top=Sn(d.top,c.top),c.right=ki(d.right,c.right),c.bottom=ki(d.bottom,c.bottom),c.left=Sn(d.left,c.left),c},jx(e,s,o));return{width:u.right-u.left,height:u.bottom-u.top,x:u.left,y:u.top}}function hO(t){const{width:e,height:n}=l_(t);return{width:e,height:n}}function pO(t,e,n){const r=Gr(e),o=qr(e),i=n==="fixed",a=va(t,!0,i,e);let s={scrollLeft:0,scrollTop:0};const u=Ur(0);function c(){u.x=gy(o)}if(r||!r&&!i)if((su(e)!=="body"||$c(o))&&(s=uh(e)),r){const h=va(e,!0,i,e);u.x=h.x+e.clientLeft,u.y=h.y+e.clientTop}else o&&c();i&&!r&&o&&c();const l=o&&!r&&!i?f_(o,s):Ur(0),d=a.left+s.scrollLeft-u.x-l.x,f=a.top+s.scrollTop-u.y-l.y;return{x:d,y:f,width:a.width,height:a.height}}function bp(t){return yr(t).position==="static"}function Ux(t,e){if(!Gr(t)||yr(t).position==="fixed")return null;if(e)return e(t);let n=t.offsetParent;return qr(t)===n&&(n=n.ownerDocument.body),n}function p_(t,e){const n=Dn(t);if(sh(t))return n;if(!Gr(t)){let o=Ii(t);for(;o&&!Vs(o);){if(gr(o)&&!bp(o))return o;o=Ii(o)}return n}let r=Ux(t,e);for(;r&&Y3(r)&&bp(r);)r=Ux(r,e);return r&&Vs(r)&&bp(r)&&!py(r)?n:r||tO(t)||n}const mO=async function(t){const e=this.getOffsetParent||p_,n=this.getDimensions,r=await n(t.floating);return{reference:pO(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function vO(t){return yr(t).direction==="rtl"}const gO={convertOffsetParentRelativeRectToViewportRelativeRect:iO,getDocumentElement:qr,getClippingRect:fO,getOffsetParent:p_,getElementRects:mO,getClientRects:aO,getDimensions:hO,getScale:ps,isElement:gr,isRTL:vO};function m_(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height}function yO(t,e){let n=null,r;const o=qr(t);function i(){var s;clearTimeout(r),(s=n)==null||s.disconnect(),n=null}function a(s,u){s===void 0&&(s=!1),u===void 0&&(u=1),i();const c=t.getBoundingClientRect(),{left:l,top:d,width:f,height:h}=c;if(s||e(),!f||!h)return;const m=Ml(d),p=Ml(o.clientWidth-(l+f)),g=Ml(o.clientHeight-(d+h)),v=Ml(l),x={rootMargin:-m+"px "+-p+"px "+-g+"px "+-v+"px",threshold:Sn(0,ki(1,u))||1};let b=!0;function E(_){const S=_[0].intersectionRatio;if(S!==u){if(!b)return a();S?a(!1,S):r=setTimeout(()=>{a(!1,1e-7)},1e3)}S===1&&!m_(c,t.getBoundingClientRect())&&a(),b=!1}try{n=new IntersectionObserver(E,{...x,root:o.ownerDocument})}catch{n=new IntersectionObserver(E,x)}n.observe(t)}return a(!0),i}function xO(t,e,n,r){r===void 0&&(r={});const{ancestorScroll:o=!0,ancestorResize:i=!0,elementResize:a=typeof ResizeObserver=="function",layoutShift:s=typeof IntersectionObserver=="function",animationFrame:u=!1}=r,c=vy(t),l=o||i?[...c?vc(c):[],...vc(e)]:[];l.forEach(v=>{o&&v.addEventListener("scroll",n,{passive:!0}),i&&v.addEventListener("resize",n)});const d=c&&s?yO(c,n):null;let f=-1,h=null;a&&(h=new ResizeObserver(v=>{let[y]=v;y&&y.target===c&&h&&(h.unobserve(e),cancelAnimationFrame(f),f=requestAnimationFrame(()=>{var x;(x=h)==null||x.observe(e)})),n()}),c&&!u&&h.observe(c),h.observe(e));let m,p=u?va(t):null;u&&g();function g(){const v=va(t);p&&!m_(p,v)&&n(),p=v,m=requestAnimationFrame(g)}return n(),()=>{var v;l.forEach(y=>{o&&y.removeEventListener("scroll",n),i&&y.removeEventListener("resize",n)}),d==null||d(),(v=h)==null||v.disconnect(),h=null,u&&cancelAnimationFrame(m)}}const wO=V3,bO=H3,EO=W3,CO=K3,_O=$3,Wx=U3,SO=G3,kO=(t,e,n)=>{const r=new Map,o={platform:gO,...n},i={...o.platform,_c:r};return j3(t,e,{...o,platform:i})};var IO=typeof document<"u",RO=function(){},gd=IO?C.useLayoutEffect:RO;function tf(t,e){if(t===e)return!0;if(typeof t!=typeof e)return!1;if(typeof t=="function"&&t.toString()===e.toString())return!0;let n,r,o;if(t&&e&&typeof t=="object"){if(Array.isArray(t)){if(n=t.length,n!==e.length)return!1;for(r=n;r--!==0;)if(!tf(t[r],e[r]))return!1;return!0}if(o=Object.keys(t),n=o.length,n!==Object.keys(e).length)return!1;for(r=n;r--!==0;)if(!{}.hasOwnProperty.call(e,o[r]))return!1;for(r=n;r--!==0;){const i=o[r];if(!(i==="_owner"&&t.$$typeof)&&!tf(t[i],e[i]))return!1}return!0}return t!==t&&e!==e}function v_(t){return typeof window>"u"?1:(t.ownerDocument.defaultView||window).devicePixelRatio||1}function $x(t,e){const n=v_(t);return Math.round(e*n)/n}function Ep(t){const e=C.useRef(t);return gd(()=>{e.current=t}),e}function TO(t){t===void 0&&(t={});const{placement:e="bottom",strategy:n="absolute",middleware:r=[],platform:o,elements:{reference:i,floating:a}={},transform:s=!0,whileElementsMounted:u,open:c}=t,[l,d]=C.useState({x:0,y:0,strategy:n,placement:e,middlewareData:{},isPositioned:!1}),[f,h]=C.useState(r);tf(f,r)||h(r);const[m,p]=C.useState(null),[g,v]=C.useState(null),y=C.useCallback(M=>{M!==_.current&&(_.current=M,p(M))},[]),x=C.useCallback(M=>{M!==S.current&&(S.current=M,v(M))},[]),b=i||m,E=a||g,_=C.useRef(null),S=C.useRef(null),k=C.useRef(l),R=u!=null,I=Ep(u),D=Ep(o),A=Ep(c),W=C.useCallback(()=>{if(!_.current||!S.current)return;const M={placement:e,strategy:n,middleware:f};D.current&&(M.platform=D.current),kO(_.current,S.current,M).then(P=>{const B={...P,isPositioned:A.current!==!1};F.current&&!tf(k.current,B)&&(k.current=B,Uc.flushSync(()=>{d(B)}))})},[f,e,n,D,A]);gd(()=>{c===!1&&k.current.isPositioned&&(k.current.isPositioned=!1,d(M=>({...M,isPositioned:!1})))},[c]);const F=C.useRef(!1);gd(()=>(F.current=!0,()=>{F.current=!1}),[]),gd(()=>{if(b&&(_.current=b),E&&(S.current=E),b&&E){if(I.current)return I.current(b,E,W);W()}},[b,E,W,I,R]);const $=C.useMemo(()=>({reference:_,floating:S,setReference:y,setFloating:x}),[y,x]),j=C.useMemo(()=>({reference:b,floating:E}),[b,E]),U=C.useMemo(()=>{const M={position:n,left:0,top:0};if(!j.floating)return M;const P=$x(j.floating,l.x),B=$x(j.floating,l.y);return s?{...M,transform:"translate("+P+"px, "+B+"px)",...v_(j.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:P,top:B}},[n,s,j.floating,l.x,l.y]);return C.useMemo(()=>({...l,update:W,refs:$,elements:j,floatingStyles:U}),[l,W,$,j,U])}const NO=t=>{function e(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:t,fn(n){const{element:r,padding:o}=typeof t=="function"?t(n):t;return r&&e(r)?r.current!=null?Wx({element:r.current,padding:o}).fn(n):{}:r?Wx({element:r,padding:o}).fn(n):{}}}},AO=(t,e)=>({...wO(t),options:[t,e]}),PO=(t,e)=>({...bO(t),options:[t,e]}),DO=(t,e)=>({...SO(t),options:[t,e]}),MO=(t,e)=>({...EO(t),options:[t,e]}),OO=(t,e)=>({...CO(t),options:[t,e]}),FO=(t,e)=>({..._O(t),options:[t,e]}),LO=(t,e)=>({...NO(t),options:[t,e]});var BO="Arrow",g_=C.forwardRef((t,e)=>{const{children:n,width:r=10,height:o=5,...i}=t;return w.jsx(Ue.svg,{...i,ref:e,width:r,height:o,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:t.asChild?n:w.jsx("polygon",{points:"0,0 30,0 15,10"})})});g_.displayName=BO;var jO=g_;function UO(t){const[e,n]=C.useState(void 0);return Xn(()=>{if(t){n({width:t.offsetWidth,height:t.offsetHeight});const r=new ResizeObserver(o=>{if(!Array.isArray(o)||!o.length)return;const i=o[0];let a,s;if("borderBoxSize"in i){const u=i.borderBoxSize,c=Array.isArray(u)?u[0]:u;a=c.inlineSize,s=c.blockSize}else a=t.offsetWidth,s=t.offsetHeight;n({width:a,height:s})});return r.observe(t,{box:"border-box"}),()=>r.unobserve(t)}else n(void 0)},[t]),e}var yy="Popper",[y_,ch]=ko(yy),[WO,x_]=y_(yy),w_=t=>{const{__scopePopper:e,children:n}=t,[r,o]=C.useState(null);return w.jsx(WO,{scope:e,anchor:r,onAnchorChange:o,children:n})};w_.displayName=yy;var b_="PopperAnchor",E_=C.forwardRef((t,e)=>{const{__scopePopper:n,virtualRef:r,...o}=t,i=x_(b_,n),a=C.useRef(null),s=Pt(e,a);return C.useEffect(()=>{i.onAnchorChange((r==null?void 0:r.current)||a.current)}),r?null:w.jsx(Ue.div,{...o,ref:s})});E_.displayName=b_;var xy="PopperContent",[$O,zO]=y_(xy),C_=C.forwardRef((t,e)=>{var J,ie,oe,me,ee,ye;const{__scopePopper:n,side:r="bottom",sideOffset:o=0,align:i="center",alignOffset:a=0,arrowPadding:s=0,avoidCollisions:u=!0,collisionBoundary:c=[],collisionPadding:l=0,sticky:d="partial",hideWhenDetached:f=!1,updatePositionStrategy:h="optimized",onPlaced:m,...p}=t,g=x_(xy,n),[v,y]=C.useState(null),x=Pt(e,ge=>y(ge)),[b,E]=C.useState(null),_=UO(b),S=(_==null?void 0:_.width)??0,k=(_==null?void 0:_.height)??0,R=r+(i!=="center"?"-"+i:""),I=typeof l=="number"?l:{top:0,right:0,bottom:0,left:0,...l},D=Array.isArray(c)?c:[c],A=D.length>0,W={padding:I,boundary:D.filter(HO),altBoundary:A},{refs:F,floatingStyles:$,placement:j,isPositioned:U,middlewareData:M}=TO({strategy:"fixed",placement:R,whileElementsMounted:(...ge)=>xO(...ge,{animationFrame:h==="always"}),elements:{reference:g.anchor},middleware:[AO({mainAxis:o+k,alignmentAxis:a}),u&&PO({mainAxis:!0,crossAxis:!1,limiter:d==="partial"?DO():void 0,...W}),u&&MO({...W}),OO({...W,apply:({elements:ge,rects:Ne,availableWidth:Me,availableHeight:Oe})=>{const{width:Mt,height:mt}=Ne.reference,et=ge.floating.style;et.setProperty("--radix-popper-available-width",`${Me}px`),et.setProperty("--radix-popper-available-height",`${Oe}px`),et.setProperty("--radix-popper-anchor-width",`${Mt}px`),et.setProperty("--radix-popper-anchor-height",`${mt}px`)}}),b&&LO({element:b,padding:s}),GO({arrowWidth:S,arrowHeight:k}),f&&FO({strategy:"referenceHidden",...W})]}),[P,B]=k_(j),V=wn(m);Xn(()=>{U&&(V==null||V())},[U,V]);const K=(J=M.arrow)==null?void 0:J.x,Q=(ie=M.arrow)==null?void 0:ie.y,te=((oe=M.arrow)==null?void 0:oe.centerOffset)!==0,[ae,X]=C.useState();return Xn(()=>{v&&X(window.getComputedStyle(v).zIndex)},[v]),w.jsx("div",{ref:F.setFloating,"data-radix-popper-content-wrapper":"",style:{...$,transform:U?$.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:ae,"--radix-popper-transform-origin":[(me=M.transformOrigin)==null?void 0:me.x,(ee=M.transformOrigin)==null?void 0:ee.y].join(" "),...((ye=M.hide)==null?void 0:ye.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:t.dir,children:w.jsx($O,{scope:n,placedSide:P,onArrowChange:E,arrowX:K,arrowY:Q,shouldHideArrow:te,children:w.jsx(Ue.div,{"data-side":P,"data-align":B,...p,ref:x,style:{...p.style,animation:U?void 0:"none"}})})})});C_.displayName=xy;var __="PopperArrow",VO={top:"bottom",right:"left",bottom:"top",left:"right"},S_=C.forwardRef(function(e,n){const{__scopePopper:r,...o}=e,i=zO(__,r),a=VO[i.placedSide];return w.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[a]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:w.jsx(jO,{...o,ref:n,style:{...o.style,display:"block"}})})});S_.displayName=__;function HO(t){return t!==null}var GO=t=>({name:"transformOrigin",options:t,fn(e){var g,v,y;const{placement:n,rects:r,middlewareData:o}=e,a=((g=o.arrow)==null?void 0:g.centerOffset)!==0,s=a?0:t.arrowWidth,u=a?0:t.arrowHeight,[c,l]=k_(n),d={start:"0%",center:"50%",end:"100%"}[l],f=(((v=o.arrow)==null?void 0:v.x)??0)+s/2,h=(((y=o.arrow)==null?void 0:y.y)??0)+u/2;let m="",p="";return c==="bottom"?(m=a?d:`${f}px`,p=`${-u}px`):c==="top"?(m=a?d:`${f}px`,p=`${r.floating.height+u}px`):c==="right"?(m=`${-u}px`,p=a?d:`${h}px`):c==="left"&&(m=`${r.floating.width+u}px`,p=a?d:`${h}px`),{data:{x:m,y:p}}}});function k_(t){const[e,n="center"]=t.split("-");return[e,n]}var KO=w_,I_=E_,R_=C_,T_=S_,[lh,VK]=ko("Tooltip",[ch]),wy=ch(),N_="TooltipProvider",qO=700,zx="tooltip.open",[XO,A_]=lh(N_),P_=t=>{const{__scopeTooltip:e,delayDuration:n=qO,skipDelayDuration:r=300,disableHoverableContent:o=!1,children:i}=t,a=C.useRef(!0),s=C.useRef(!1),u=C.useRef(0);return C.useEffect(()=>{const c=u.current;return()=>window.clearTimeout(c)},[]),w.jsx(XO,{scope:e,isOpenDelayedRef:a,delayDuration:n,onOpen:C.useCallback(()=>{window.clearTimeout(u.current),a.current=!1},[]),onClose:C.useCallback(()=>{window.clearTimeout(u.current),u.current=window.setTimeout(()=>a.current=!0,r)},[r]),isPointerInTransitRef:s,onPointerInTransitChange:C.useCallback(c=>{s.current=c},[]),disableHoverableContent:o,children:i})};P_.displayName=N_;var D_="Tooltip",[HK,dh]=lh(D_),gv="TooltipTrigger",YO=C.forwardRef((t,e)=>{const{__scopeTooltip:n,...r}=t,o=dh(gv,n),i=A_(gv,n),a=wy(n),s=C.useRef(null),u=Pt(e,s,o.onTriggerChange),c=C.useRef(!1),l=C.useRef(!1),d=C.useCallback(()=>c.current=!1,[]);return C.useEffect(()=>()=>document.removeEventListener("pointerup",d),[d]),w.jsx(I_,{asChild:!0,...a,children:w.jsx(Ue.button,{"aria-describedby":o.open?o.contentId:void 0,"data-state":o.stateAttribute,...r,ref:u,onPointerMove:ve(t.onPointerMove,f=>{f.pointerType!=="touch"&&!l.current&&!i.isPointerInTransitRef.current&&(o.onTriggerEnter(),l.current=!0)}),onPointerLeave:ve(t.onPointerLeave,()=>{o.onTriggerLeave(),l.current=!1}),onPointerDown:ve(t.onPointerDown,()=>{o.open&&o.onClose(),c.current=!0,document.addEventListener("pointerup",d,{once:!0})}),onFocus:ve(t.onFocus,()=>{c.current||o.onOpen()}),onBlur:ve(t.onBlur,o.onClose),onClick:ve(t.onClick,o.onClose)})})});YO.displayName=gv;var QO="TooltipPortal",[GK,JO]=lh(QO,{forceMount:void 0}),Hs="TooltipContent",M_=C.forwardRef((t,e)=>{const n=JO(Hs,t.__scopeTooltip),{forceMount:r=n.forceMount,side:o="top",...i}=t,a=dh(Hs,t.__scopeTooltip);return w.jsx(Di,{present:r||a.open,children:a.disableHoverableContent?w.jsx(O_,{side:o,...i,ref:e}):w.jsx(ZO,{side:o,...i,ref:e})})}),ZO=C.forwardRef((t,e)=>{const n=dh(Hs,t.__scopeTooltip),r=A_(Hs,t.__scopeTooltip),o=C.useRef(null),i=Pt(e,o),[a,s]=C.useState(null),{trigger:u,onClose:c}=n,l=o.current,{onPointerInTransitChange:d}=r,f=C.useCallback(()=>{s(null),d(!1)},[d]),h=C.useCallback((m,p)=>{const g=m.currentTarget,v={x:m.clientX,y:m.clientY},y=o4(v,g.getBoundingClientRect()),x=i4(v,y),b=a4(p.getBoundingClientRect()),E=u4([...x,...b]);s(E),d(!0)},[d]);return C.useEffect(()=>()=>f(),[f]),C.useEffect(()=>{if(u&&l){const m=g=>h(g,l),p=g=>h(g,u);return u.addEventListener("pointerleave",m),l.addEventListener("pointerleave",p),()=>{u.removeEventListener("pointerleave",m),l.removeEventListener("pointerleave",p)}}},[u,l,h,f]),C.useEffect(()=>{if(a){const m=p=>{const g=p.target,v={x:p.clientX,y:p.clientY},y=(u==null?void 0:u.contains(g))||(l==null?void 0:l.contains(g)),x=!s4(v,a);y?f():x&&(f(),c())};return document.addEventListener("pointermove",m),()=>document.removeEventListener("pointermove",m)}},[u,l,a,c,f]),w.jsx(O_,{...t,ref:i})}),[e4,t4]=lh(D_,{isInside:!1}),n4=tD("TooltipContent"),O_=C.forwardRef((t,e)=>{const{__scopeTooltip:n,children:r,"aria-label":o,onEscapeKeyDown:i,onPointerDownOutside:a,...s}=t,u=dh(Hs,n),c=wy(n),{onClose:l}=u;return C.useEffect(()=>(document.addEventListener(zx,l),()=>document.removeEventListener(zx,l)),[l]),C.useEffect(()=>{if(u.trigger){const d=f=>{const h=f.target;h!=null&&h.contains(u.trigger)&&l()};return window.addEventListener("scroll",d,{capture:!0}),()=>window.removeEventListener("scroll",d,{capture:!0})}},[u.trigger,l]),w.jsx(th,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:i,onPointerDownOutside:a,onFocusOutside:d=>d.preventDefault(),onDismiss:l,children:w.jsxs(R_,{"data-state":u.stateAttribute,...c,...s,ref:e,style:{...s.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[w.jsx(n4,{children:r}),w.jsx(e4,{scope:n,isInside:!0,children:w.jsx(_D,{id:u.contentId,role:"tooltip",children:o||r})})]})})});M_.displayName=Hs;var F_="TooltipArrow",r4=C.forwardRef((t,e)=>{const{__scopeTooltip:n,...r}=t,o=wy(n);return t4(F_,n).isInside?null:w.jsx(T_,{...o,...r,ref:e})});r4.displayName=F_;function o4(t,e){const n=Math.abs(e.top-t.y),r=Math.abs(e.bottom-t.y),o=Math.abs(e.right-t.x),i=Math.abs(e.left-t.x);switch(Math.min(n,r,o,i)){case i:return"left";case o:return"right";case n:return"top";case r:return"bottom";default:throw new Error("unreachable")}}function i4(t,e,n=5){const r=[];switch(e){case"top":r.push({x:t.x-n,y:t.y+n},{x:t.x+n,y:t.y+n});break;case"bottom":r.push({x:t.x-n,y:t.y-n},{x:t.x+n,y:t.y-n});break;case"left":r.push({x:t.x+n,y:t.y-n},{x:t.x+n,y:t.y+n});break;case"right":r.push({x:t.x-n,y:t.y-n},{x:t.x-n,y:t.y+n});break}return r}function a4(t){const{top:e,right:n,bottom:r,left:o}=t;return[{x:o,y:e},{x:n,y:e},{x:n,y:r},{x:o,y:r}]}function s4(t,e){const{x:n,y:r}=t;let o=!1;for(let i=0,a=e.length-1;i<e.length;a=i++){const s=e[i],u=e[a],c=s.x,l=s.y,d=u.x,f=u.y;l>r!=f>r&&n<(d-c)*(r-l)/(f-l)+c&&(o=!o)}return o}function u4(t){const e=t.slice();return e.sort((n,r)=>n.x<r.x?-1:n.x>r.x?1:n.y<r.y?-1:n.y>r.y?1:0),c4(e)}function c4(t){if(t.length<=1)return t.slice();const e=[];for(let r=0;r<t.length;r++){const o=t[r];for(;e.length>=2;){const i=e[e.length-1],a=e[e.length-2];if((i.x-a.x)*(o.y-a.y)>=(i.y-a.y)*(o.x-a.x))e.pop();else break}e.push(o)}e.pop();const n=[];for(let r=t.length-1;r>=0;r--){const o=t[r];for(;n.length>=2;){const i=n[n.length-1],a=n[n.length-2];if((i.x-a.x)*(o.y-a.y)>=(i.y-a.y)*(o.x-a.x))n.pop();else break}n.push(o)}return n.pop(),e.length===1&&n.length===1&&e[0].x===n[0].x&&e[0].y===n[0].y?e:e.concat(n)}var l4=P_,L_=M_;const d4=l4,f4=C.forwardRef(({className:t,sideOffset:e=4,...n},r)=>w.jsx(L_,{ref:r,sideOffset:e,className:be("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...n}));f4.displayName=L_.displayName;var fh=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(t){return this.listeners.add(t),this.onSubscribe(),()=>{this.listeners.delete(t),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},hh=typeof window>"u"||"Deno"in globalThis;function or(){}function h4(t,e){return typeof t=="function"?t(e):t}function p4(t){return typeof t=="number"&&t>=0&&t!==1/0}function m4(t,e){return Math.max(t+(e||0)-Date.now(),0)}function yv(t,e){return typeof t=="function"?t(e):t}function v4(t,e){return typeof t=="function"?t(e):t}function Vx(t,e){const{type:n="all",exact:r,fetchStatus:o,predicate:i,queryKey:a,stale:s}=t;if(a){if(r){if(e.queryHash!==by(a,e.options))return!1}else if(!yc(e.queryKey,a))return!1}if(n!=="all"){const u=e.isActive();if(n==="active"&&!u||n==="inactive"&&u)return!1}return!(typeof s=="boolean"&&e.isStale()!==s||o&&o!==e.state.fetchStatus||i&&!i(e))}function Hx(t,e){const{exact:n,status:r,predicate:o,mutationKey:i}=t;if(i){if(!e.options.mutationKey)return!1;if(n){if(gc(e.options.mutationKey)!==gc(i))return!1}else if(!yc(e.options.mutationKey,i))return!1}return!(r&&e.state.status!==r||o&&!o(e))}function by(t,e){return((e==null?void 0:e.queryKeyHashFn)||gc)(t)}function gc(t){return JSON.stringify(t,(e,n)=>xv(n)?Object.keys(n).sort().reduce((r,o)=>(r[o]=n[o],r),{}):n)}function yc(t,e){return t===e?!0:typeof t!=typeof e?!1:t&&e&&typeof t=="object"&&typeof e=="object"?Object.keys(e).every(n=>yc(t[n],e[n])):!1}function B_(t,e){if(t===e)return t;const n=Gx(t)&&Gx(e);if(n||xv(t)&&xv(e)){const r=n?t:Object.keys(t),o=r.length,i=n?e:Object.keys(e),a=i.length,s=n?[]:{},u=new Set(r);let c=0;for(let l=0;l<a;l++){const d=n?l:i[l];(!n&&u.has(d)||n)&&t[d]===void 0&&e[d]===void 0?(s[d]=void 0,c++):(s[d]=B_(t[d],e[d]),s[d]===t[d]&&t[d]!==void 0&&c++)}return o===a&&c===o?t:s}return e}function Gx(t){return Array.isArray(t)&&t.length===Object.keys(t).length}function xv(t){if(!Kx(t))return!1;const e=t.constructor;if(e===void 0)return!0;const n=e.prototype;return!(!Kx(n)||!n.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(t)!==Object.prototype)}function Kx(t){return Object.prototype.toString.call(t)==="[object Object]"}function g4(t){return new Promise(e=>{setTimeout(e,t)})}function y4(t,e,n){return typeof n.structuralSharing=="function"?n.structuralSharing(t,e):n.structuralSharing!==!1?B_(t,e):e}function x4(t,e,n=0){const r=[...t,e];return n&&r.length>n?r.slice(1):r}function w4(t,e,n=0){const r=[e,...t];return n&&r.length>n?r.slice(0,-1):r}var Ey=Symbol();function j_(t,e){return!t.queryFn&&(e!=null&&e.initialPromise)?()=>e.initialPromise:!t.queryFn||t.queryFn===Ey?()=>Promise.reject(new Error(`Missing queryFn: '${t.queryHash}'`)):t.queryFn}var ta,ei,Rs,Qb,b4=(Qb=class extends fh{constructor(){super();Be(this,ta);Be(this,ei);Be(this,Rs);Se(this,Rs,e=>{if(!hh&&window.addEventListener){const n=()=>e();return window.addEventListener("visibilitychange",n,!1),()=>{window.removeEventListener("visibilitychange",n)}}})}onSubscribe(){q(this,ei)||this.setEventListener(q(this,Rs))}onUnsubscribe(){var e;this.hasListeners()||((e=q(this,ei))==null||e.call(this),Se(this,ei,void 0))}setEventListener(e){var n;Se(this,Rs,e),(n=q(this,ei))==null||n.call(this),Se(this,ei,e(r=>{typeof r=="boolean"?this.setFocused(r):this.onFocus()}))}setFocused(e){q(this,ta)!==e&&(Se(this,ta,e),this.onFocus())}onFocus(){const e=this.isFocused();this.listeners.forEach(n=>{n(e)})}isFocused(){var e;return typeof q(this,ta)=="boolean"?q(this,ta):((e=globalThis.document)==null?void 0:e.visibilityState)!=="hidden"}},ta=new WeakMap,ei=new WeakMap,Rs=new WeakMap,Qb),U_=new b4,Ts,ti,Ns,Jb,E4=(Jb=class extends fh{constructor(){super();Be(this,Ts,!0);Be(this,ti);Be(this,Ns);Se(this,Ns,e=>{if(!hh&&window.addEventListener){const n=()=>e(!0),r=()=>e(!1);return window.addEventListener("online",n,!1),window.addEventListener("offline",r,!1),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",r)}}})}onSubscribe(){q(this,ti)||this.setEventListener(q(this,Ns))}onUnsubscribe(){var e;this.hasListeners()||((e=q(this,ti))==null||e.call(this),Se(this,ti,void 0))}setEventListener(e){var n;Se(this,Ns,e),(n=q(this,ti))==null||n.call(this),Se(this,ti,e(this.setOnline.bind(this)))}setOnline(e){q(this,Ts)!==e&&(Se(this,Ts,e),this.listeners.forEach(r=>{r(e)}))}isOnline(){return q(this,Ts)}},Ts=new WeakMap,ti=new WeakMap,Ns=new WeakMap,Jb),nf=new E4;function C4(){let t,e;const n=new Promise((o,i)=>{t=o,e=i});n.status="pending",n.catch(()=>{});function r(o){Object.assign(n,o),delete n.resolve,delete n.reject}return n.resolve=o=>{r({status:"fulfilled",value:o}),t(o)},n.reject=o=>{r({status:"rejected",reason:o}),e(o)},n}function _4(t){return Math.min(1e3*2**t,3e4)}function W_(t){return(t??"online")==="online"?nf.isOnline():!0}var $_=class extends Error{constructor(t){super("CancelledError"),this.revert=t==null?void 0:t.revert,this.silent=t==null?void 0:t.silent}};function Cp(t){return t instanceof $_}function z_(t){let e=!1,n=0,r=!1,o;const i=C4(),a=p=>{var g;r||(f(new $_(p)),(g=t.abort)==null||g.call(t))},s=()=>{e=!0},u=()=>{e=!1},c=()=>U_.isFocused()&&(t.networkMode==="always"||nf.isOnline())&&t.canRun(),l=()=>W_(t.networkMode)&&t.canRun(),d=p=>{var g;r||(r=!0,(g=t.onSuccess)==null||g.call(t,p),o==null||o(),i.resolve(p))},f=p=>{var g;r||(r=!0,(g=t.onError)==null||g.call(t,p),o==null||o(),i.reject(p))},h=()=>new Promise(p=>{var g;o=v=>{(r||c())&&p(v)},(g=t.onPause)==null||g.call(t)}).then(()=>{var p;o=void 0,r||(p=t.onContinue)==null||p.call(t)}),m=()=>{if(r)return;let p;const g=n===0?t.initialPromise:void 0;try{p=g??t.fn()}catch(v){p=Promise.reject(v)}Promise.resolve(p).then(d).catch(v=>{var _;if(r)return;const y=t.retry??(hh?0:3),x=t.retryDelay??_4,b=typeof x=="function"?x(n,v):x,E=y===!0||typeof y=="number"&&n<y||typeof y=="function"&&y(n,v);if(e||!E){f(v);return}n++,(_=t.onFail)==null||_.call(t,n,v),g4(b).then(()=>c()?void 0:h()).then(()=>{e?f(v):m()})})};return{promise:i,cancel:a,continue:()=>(o==null||o(),i),cancelRetry:s,continueRetry:u,canStart:l,start:()=>(l()?m():h().then(m),i)}}var S4=t=>setTimeout(t,0);function k4(){let t=[],e=0,n=s=>{s()},r=s=>{s()},o=S4;const i=s=>{e?t.push(s):o(()=>{n(s)})},a=()=>{const s=t;t=[],s.length&&o(()=>{r(()=>{s.forEach(u=>{n(u)})})})};return{batch:s=>{let u;e++;try{u=s()}finally{e--,e||a()}return u},batchCalls:s=>(...u)=>{i(()=>{s(...u)})},schedule:i,setNotifyFunction:s=>{n=s},setBatchNotifyFunction:s=>{r=s},setScheduler:s=>{o=s}}}var nn=k4(),na,Zb,V_=(Zb=class{constructor(){Be(this,na)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),p4(this.gcTime)&&Se(this,na,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(t){this.gcTime=Math.max(this.gcTime||0,t??(hh?1/0:5*60*1e3))}clearGcTimeout(){q(this,na)&&(clearTimeout(q(this,na)),Se(this,na,void 0))}},na=new WeakMap,Zb),As,ra,Bn,oa,Vt,Dc,ia,ir,ro,e2,I4=(e2=class extends V_{constructor(e){super();Be(this,ir);Be(this,As);Be(this,ra);Be(this,Bn);Be(this,oa);Be(this,Vt);Be(this,Dc);Be(this,ia);Se(this,ia,!1),Se(this,Dc,e.defaultOptions),this.setOptions(e.options),this.observers=[],Se(this,oa,e.client),Se(this,Bn,q(this,oa).getQueryCache()),this.queryKey=e.queryKey,this.queryHash=e.queryHash,Se(this,As,T4(this.options)),this.state=e.state??q(this,As),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var e;return(e=q(this,Vt))==null?void 0:e.promise}setOptions(e){this.options={...q(this,Dc),...e},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&q(this,Bn).remove(this)}setData(e,n){const r=y4(this.state.data,e,this.options);return Wt(this,ir,ro).call(this,{data:r,type:"success",dataUpdatedAt:n==null?void 0:n.updatedAt,manual:n==null?void 0:n.manual}),r}setState(e,n){Wt(this,ir,ro).call(this,{type:"setState",state:e,setStateOptions:n})}cancel(e){var r,o;const n=(r=q(this,Vt))==null?void 0:r.promise;return(o=q(this,Vt))==null||o.cancel(e),n?n.then(or).catch(or):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(q(this,As))}isActive(){return this.observers.some(e=>v4(e.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===Ey||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(e=>yv(e.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(e=>e.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(e=0){return this.state.data===void 0?!0:e==="static"?!1:this.state.isInvalidated?!0:!m4(this.state.dataUpdatedAt,e)}onFocus(){var n;const e=this.observers.find(r=>r.shouldFetchOnWindowFocus());e==null||e.refetch({cancelRefetch:!1}),(n=q(this,Vt))==null||n.continue()}onOnline(){var n;const e=this.observers.find(r=>r.shouldFetchOnReconnect());e==null||e.refetch({cancelRefetch:!1}),(n=q(this,Vt))==null||n.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),q(this,Bn).notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter(n=>n!==e),this.observers.length||(q(this,Vt)&&(q(this,ia)?q(this,Vt).cancel({revert:!0}):q(this,Vt).cancelRetry()),this.scheduleGc()),q(this,Bn).notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||Wt(this,ir,ro).call(this,{type:"invalidate"})}fetch(e,n){var c,l,d;if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&(n!=null&&n.cancelRefetch))this.cancel({silent:!0});else if(q(this,Vt))return q(this,Vt).continueRetry(),q(this,Vt).promise}if(e&&this.setOptions(e),!this.options.queryFn){const f=this.observers.find(h=>h.options.queryFn);f&&this.setOptions(f.options)}const r=new AbortController,o=f=>{Object.defineProperty(f,"signal",{enumerable:!0,get:()=>(Se(this,ia,!0),r.signal)})},i=()=>{const f=j_(this.options,n),m=(()=>{const p={client:q(this,oa),queryKey:this.queryKey,meta:this.meta};return o(p),p})();return Se(this,ia,!1),this.options.persister?this.options.persister(f,m,this):f(m)},s=(()=>{const f={fetchOptions:n,options:this.options,queryKey:this.queryKey,client:q(this,oa),state:this.state,fetchFn:i};return o(f),f})();(c=this.options.behavior)==null||c.onFetch(s,this),Se(this,ra,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((l=s.fetchOptions)==null?void 0:l.meta))&&Wt(this,ir,ro).call(this,{type:"fetch",meta:(d=s.fetchOptions)==null?void 0:d.meta});const u=f=>{var h,m,p,g;Cp(f)&&f.silent||Wt(this,ir,ro).call(this,{type:"error",error:f}),Cp(f)||((m=(h=q(this,Bn).config).onError)==null||m.call(h,f,this),(g=(p=q(this,Bn).config).onSettled)==null||g.call(p,this.state.data,f,this)),this.scheduleGc()};return Se(this,Vt,z_({initialPromise:n==null?void 0:n.initialPromise,fn:s.fetchFn,abort:r.abort.bind(r),onSuccess:f=>{var h,m,p,g;if(f===void 0){u(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(f)}catch(v){u(v);return}(m=(h=q(this,Bn).config).onSuccess)==null||m.call(h,f,this),(g=(p=q(this,Bn).config).onSettled)==null||g.call(p,f,this.state.error,this),this.scheduleGc()},onError:u,onFail:(f,h)=>{Wt(this,ir,ro).call(this,{type:"failed",failureCount:f,error:h})},onPause:()=>{Wt(this,ir,ro).call(this,{type:"pause"})},onContinue:()=>{Wt(this,ir,ro).call(this,{type:"continue"})},retry:s.options.retry,retryDelay:s.options.retryDelay,networkMode:s.options.networkMode,canRun:()=>!0})),q(this,Vt).start()}},As=new WeakMap,ra=new WeakMap,Bn=new WeakMap,oa=new WeakMap,Vt=new WeakMap,Dc=new WeakMap,ia=new WeakMap,ir=new WeakSet,ro=function(e){const n=r=>{switch(e.type){case"failed":return{...r,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...r,fetchStatus:"paused"};case"continue":return{...r,fetchStatus:"fetching"};case"fetch":return{...r,...R4(r.data,this.options),fetchMeta:e.meta??null};case"success":return Se(this,ra,void 0),{...r,data:e.data,dataUpdateCount:r.dataUpdateCount+1,dataUpdatedAt:e.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const o=e.error;return Cp(o)&&o.revert&&q(this,ra)?{...q(this,ra),fetchStatus:"idle"}:{...r,error:o,errorUpdateCount:r.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:r.fetchFailureCount+1,fetchFailureReason:o,fetchStatus:"idle",status:"error"};case"invalidate":return{...r,isInvalidated:!0};case"setState":return{...r,...e.state}}};this.state=n(this.state),nn.batch(()=>{this.observers.forEach(r=>{r.onQueryUpdate()}),q(this,Bn).notify({query:this,type:"updated",action:e})})},e2);function R4(t,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:W_(e.networkMode)?"fetching":"paused",...t===void 0&&{error:null,status:"pending"}}}function T4(t){const e=typeof t.initialData=="function"?t.initialData():t.initialData,n=e!==void 0,r=n?typeof t.initialDataUpdatedAt=="function"?t.initialDataUpdatedAt():t.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:n?r??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}var Rr,t2,N4=(t2=class extends fh{constructor(e={}){super();Be(this,Rr);this.config=e,Se(this,Rr,new Map)}build(e,n,r){const o=n.queryKey,i=n.queryHash??by(o,n);let a=this.get(i);return a||(a=new I4({client:e,queryKey:o,queryHash:i,options:e.defaultQueryOptions(n),state:r,defaultOptions:e.getQueryDefaults(o)}),this.add(a)),a}add(e){q(this,Rr).has(e.queryHash)||(q(this,Rr).set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){const n=q(this,Rr).get(e.queryHash);n&&(e.destroy(),n===e&&q(this,Rr).delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){nn.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}get(e){return q(this,Rr).get(e)}getAll(){return[...q(this,Rr).values()]}find(e){const n={exact:!0,...e};return this.getAll().find(r=>Vx(n,r))}findAll(e={}){const n=this.getAll();return Object.keys(e).length>0?n.filter(r=>Vx(e,r)):n}notify(e){nn.batch(()=>{this.listeners.forEach(n=>{n(e)})})}onFocus(){nn.batch(()=>{this.getAll().forEach(e=>{e.onFocus()})})}onOnline(){nn.batch(()=>{this.getAll().forEach(e=>{e.onOnline()})})}},Rr=new WeakMap,t2),Tr,en,aa,Nr,Vo,n2,A4=(n2=class extends V_{constructor(e){super();Be(this,Nr);Be(this,Tr);Be(this,en);Be(this,aa);this.mutationId=e.mutationId,Se(this,en,e.mutationCache),Se(this,Tr,[]),this.state=e.state||P4(),this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){q(this,Tr).includes(e)||(q(this,Tr).push(e),this.clearGcTimeout(),q(this,en).notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){Se(this,Tr,q(this,Tr).filter(n=>n!==e)),this.scheduleGc(),q(this,en).notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){q(this,Tr).length||(this.state.status==="pending"?this.scheduleGc():q(this,en).remove(this))}continue(){var e;return((e=q(this,aa))==null?void 0:e.continue())??this.execute(this.state.variables)}async execute(e){var i,a,s,u,c,l,d,f,h,m,p,g,v,y,x,b,E,_,S,k;const n=()=>{Wt(this,Nr,Vo).call(this,{type:"continue"})};Se(this,aa,z_({fn:()=>this.options.mutationFn?this.options.mutationFn(e):Promise.reject(new Error("No mutationFn found")),onFail:(R,I)=>{Wt(this,Nr,Vo).call(this,{type:"failed",failureCount:R,error:I})},onPause:()=>{Wt(this,Nr,Vo).call(this,{type:"pause"})},onContinue:n,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>q(this,en).canRun(this)}));const r=this.state.status==="pending",o=!q(this,aa).canStart();try{if(r)n();else{Wt(this,Nr,Vo).call(this,{type:"pending",variables:e,isPaused:o}),await((a=(i=q(this,en).config).onMutate)==null?void 0:a.call(i,e,this));const I=await((u=(s=this.options).onMutate)==null?void 0:u.call(s,e));I!==this.state.context&&Wt(this,Nr,Vo).call(this,{type:"pending",context:I,variables:e,isPaused:o})}const R=await q(this,aa).start();return await((l=(c=q(this,en).config).onSuccess)==null?void 0:l.call(c,R,e,this.state.context,this)),await((f=(d=this.options).onSuccess)==null?void 0:f.call(d,R,e,this.state.context)),await((m=(h=q(this,en).config).onSettled)==null?void 0:m.call(h,R,null,this.state.variables,this.state.context,this)),await((g=(p=this.options).onSettled)==null?void 0:g.call(p,R,null,e,this.state.context)),Wt(this,Nr,Vo).call(this,{type:"success",data:R}),R}catch(R){try{throw await((y=(v=q(this,en).config).onError)==null?void 0:y.call(v,R,e,this.state.context,this)),await((b=(x=this.options).onError)==null?void 0:b.call(x,R,e,this.state.context)),await((_=(E=q(this,en).config).onSettled)==null?void 0:_.call(E,void 0,R,this.state.variables,this.state.context,this)),await((k=(S=this.options).onSettled)==null?void 0:k.call(S,void 0,R,e,this.state.context)),R}finally{Wt(this,Nr,Vo).call(this,{type:"error",error:R})}}finally{q(this,en).runNext(this)}}},Tr=new WeakMap,en=new WeakMap,aa=new WeakMap,Nr=new WeakSet,Vo=function(e){const n=r=>{switch(e.type){case"failed":return{...r,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...r,isPaused:!0};case"continue":return{...r,isPaused:!1};case"pending":return{...r,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...r,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...r,data:void 0,error:e.error,failureCount:r.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}};this.state=n(this.state),nn.batch(()=>{q(this,Tr).forEach(r=>{r.onMutationUpdate(e)}),q(this,en).notify({mutation:this,type:"updated",action:e})})},n2);function P4(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var uo,ar,Mc,r2,D4=(r2=class extends fh{constructor(e={}){super();Be(this,uo);Be(this,ar);Be(this,Mc);this.config=e,Se(this,uo,new Set),Se(this,ar,new Map),Se(this,Mc,0)}build(e,n,r){const o=new A4({mutationCache:this,mutationId:++hl(this,Mc)._,options:e.defaultMutationOptions(n),state:r});return this.add(o),o}add(e){q(this,uo).add(e);const n=Ol(e);if(typeof n=="string"){const r=q(this,ar).get(n);r?r.push(e):q(this,ar).set(n,[e])}this.notify({type:"added",mutation:e})}remove(e){if(q(this,uo).delete(e)){const n=Ol(e);if(typeof n=="string"){const r=q(this,ar).get(n);if(r)if(r.length>1){const o=r.indexOf(e);o!==-1&&r.splice(o,1)}else r[0]===e&&q(this,ar).delete(n)}}this.notify({type:"removed",mutation:e})}canRun(e){const n=Ol(e);if(typeof n=="string"){const r=q(this,ar).get(n),o=r==null?void 0:r.find(i=>i.state.status==="pending");return!o||o===e}else return!0}runNext(e){var r;const n=Ol(e);if(typeof n=="string"){const o=(r=q(this,ar).get(n))==null?void 0:r.find(i=>i!==e&&i.state.isPaused);return(o==null?void 0:o.continue())??Promise.resolve()}else return Promise.resolve()}clear(){nn.batch(()=>{q(this,uo).forEach(e=>{this.notify({type:"removed",mutation:e})}),q(this,uo).clear(),q(this,ar).clear()})}getAll(){return Array.from(q(this,uo))}find(e){const n={exact:!0,...e};return this.getAll().find(r=>Hx(n,r))}findAll(e={}){return this.getAll().filter(n=>Hx(e,n))}notify(e){nn.batch(()=>{this.listeners.forEach(n=>{n(e)})})}resumePausedMutations(){const e=this.getAll().filter(n=>n.state.isPaused);return nn.batch(()=>Promise.all(e.map(n=>n.continue().catch(or))))}},uo=new WeakMap,ar=new WeakMap,Mc=new WeakMap,r2);function Ol(t){var e;return(e=t.options.scope)==null?void 0:e.id}function qx(t){return{onFetch:(e,n)=>{var l,d,f,h,m;const r=e.options,o=(f=(d=(l=e.fetchOptions)==null?void 0:l.meta)==null?void 0:d.fetchMore)==null?void 0:f.direction,i=((h=e.state.data)==null?void 0:h.pages)||[],a=((m=e.state.data)==null?void 0:m.pageParams)||[];let s={pages:[],pageParams:[]},u=0;const c=async()=>{let p=!1;const g=x=>{Object.defineProperty(x,"signal",{enumerable:!0,get:()=>(e.signal.aborted?p=!0:e.signal.addEventListener("abort",()=>{p=!0}),e.signal)})},v=j_(e.options,e.fetchOptions),y=async(x,b,E)=>{if(p)return Promise.reject();if(b==null&&x.pages.length)return Promise.resolve(x);const S=(()=>{const D={client:e.client,queryKey:e.queryKey,pageParam:b,direction:E?"backward":"forward",meta:e.options.meta};return g(D),D})(),k=await v(S),{maxPages:R}=e.options,I=E?w4:x4;return{pages:I(x.pages,k,R),pageParams:I(x.pageParams,b,R)}};if(o&&i.length){const x=o==="backward",b=x?M4:Xx,E={pages:i,pageParams:a},_=b(r,E);s=await y(E,_,x)}else{const x=t??i.length;do{const b=u===0?a[0]??r.initialPageParam:Xx(r,s);if(u>0&&b==null)break;s=await y(s,b),u++}while(u<x)}return s};e.options.persister?e.fetchFn=()=>{var p,g;return(g=(p=e.options).persister)==null?void 0:g.call(p,c,{client:e.client,queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},n)}:e.fetchFn=c}}}function Xx(t,{pages:e,pageParams:n}){const r=e.length-1;return e.length>0?t.getNextPageParam(e[r],e,n[r],n):void 0}function M4(t,{pages:e,pageParams:n}){var r;return e.length>0?(r=t.getPreviousPageParam)==null?void 0:r.call(t,e[0],e,n[0],n):void 0}var ut,ni,ri,Ps,Ds,oi,Ms,Os,o2,O4=(o2=class{constructor(t={}){Be(this,ut);Be(this,ni);Be(this,ri);Be(this,Ps);Be(this,Ds);Be(this,oi);Be(this,Ms);Be(this,Os);Se(this,ut,t.queryCache||new N4),Se(this,ni,t.mutationCache||new D4),Se(this,ri,t.defaultOptions||{}),Se(this,Ps,new Map),Se(this,Ds,new Map),Se(this,oi,0)}mount(){hl(this,oi)._++,q(this,oi)===1&&(Se(this,Ms,U_.subscribe(async t=>{t&&(await this.resumePausedMutations(),q(this,ut).onFocus())})),Se(this,Os,nf.subscribe(async t=>{t&&(await this.resumePausedMutations(),q(this,ut).onOnline())})))}unmount(){var t,e;hl(this,oi)._--,q(this,oi)===0&&((t=q(this,Ms))==null||t.call(this),Se(this,Ms,void 0),(e=q(this,Os))==null||e.call(this),Se(this,Os,void 0))}isFetching(t){return q(this,ut).findAll({...t,fetchStatus:"fetching"}).length}isMutating(t){return q(this,ni).findAll({...t,status:"pending"}).length}getQueryData(t){var n;const e=this.defaultQueryOptions({queryKey:t});return(n=q(this,ut).get(e.queryHash))==null?void 0:n.state.data}ensureQueryData(t){const e=this.defaultQueryOptions(t),n=q(this,ut).build(this,e),r=n.state.data;return r===void 0?this.fetchQuery(t):(t.revalidateIfStale&&n.isStaleByTime(yv(e.staleTime,n))&&this.prefetchQuery(e),Promise.resolve(r))}getQueriesData(t){return q(this,ut).findAll(t).map(({queryKey:e,state:n})=>{const r=n.data;return[e,r]})}setQueryData(t,e,n){const r=this.defaultQueryOptions({queryKey:t}),o=q(this,ut).get(r.queryHash),i=o==null?void 0:o.state.data,a=h4(e,i);if(a!==void 0)return q(this,ut).build(this,r).setData(a,{...n,manual:!0})}setQueriesData(t,e,n){return nn.batch(()=>q(this,ut).findAll(t).map(({queryKey:r})=>[r,this.setQueryData(r,e,n)]))}getQueryState(t){var n;const e=this.defaultQueryOptions({queryKey:t});return(n=q(this,ut).get(e.queryHash))==null?void 0:n.state}removeQueries(t){const e=q(this,ut);nn.batch(()=>{e.findAll(t).forEach(n=>{e.remove(n)})})}resetQueries(t,e){const n=q(this,ut);return nn.batch(()=>(n.findAll(t).forEach(r=>{r.reset()}),this.refetchQueries({type:"active",...t},e)))}cancelQueries(t,e={}){const n={revert:!0,...e},r=nn.batch(()=>q(this,ut).findAll(t).map(o=>o.cancel(n)));return Promise.all(r).then(or).catch(or)}invalidateQueries(t,e={}){return nn.batch(()=>(q(this,ut).findAll(t).forEach(n=>{n.invalidate()}),(t==null?void 0:t.refetchType)==="none"?Promise.resolve():this.refetchQueries({...t,type:(t==null?void 0:t.refetchType)??(t==null?void 0:t.type)??"active"},e)))}refetchQueries(t,e={}){const n={...e,cancelRefetch:e.cancelRefetch??!0},r=nn.batch(()=>q(this,ut).findAll(t).filter(o=>!o.isDisabled()&&!o.isStatic()).map(o=>{let i=o.fetch(void 0,n);return n.throwOnError||(i=i.catch(or)),o.state.fetchStatus==="paused"?Promise.resolve():i}));return Promise.all(r).then(or)}fetchQuery(t){const e=this.defaultQueryOptions(t);e.retry===void 0&&(e.retry=!1);const n=q(this,ut).build(this,e);return n.isStaleByTime(yv(e.staleTime,n))?n.fetch(e):Promise.resolve(n.state.data)}prefetchQuery(t){return this.fetchQuery(t).then(or).catch(or)}fetchInfiniteQuery(t){return t.behavior=qx(t.pages),this.fetchQuery(t)}prefetchInfiniteQuery(t){return this.fetchInfiniteQuery(t).then(or).catch(or)}ensureInfiniteQueryData(t){return t.behavior=qx(t.pages),this.ensureQueryData(t)}resumePausedMutations(){return nf.isOnline()?q(this,ni).resumePausedMutations():Promise.resolve()}getQueryCache(){return q(this,ut)}getMutationCache(){return q(this,ni)}getDefaultOptions(){return q(this,ri)}setDefaultOptions(t){Se(this,ri,t)}setQueryDefaults(t,e){q(this,Ps).set(gc(t),{queryKey:t,defaultOptions:e})}getQueryDefaults(t){const e=[...q(this,Ps).values()],n={};return e.forEach(r=>{yc(t,r.queryKey)&&Object.assign(n,r.defaultOptions)}),n}setMutationDefaults(t,e){q(this,Ds).set(gc(t),{mutationKey:t,defaultOptions:e})}getMutationDefaults(t){const e=[...q(this,Ds).values()],n={};return e.forEach(r=>{yc(t,r.mutationKey)&&Object.assign(n,r.defaultOptions)}),n}defaultQueryOptions(t){if(t._defaulted)return t;const e={...q(this,ri).queries,...this.getQueryDefaults(t.queryKey),...t,_defaulted:!0};return e.queryHash||(e.queryHash=by(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.queryFn===Ey&&(e.enabled=!1),e}defaultMutationOptions(t){return t!=null&&t._defaulted?t:{...q(this,ri).mutations,...(t==null?void 0:t.mutationKey)&&this.getMutationDefaults(t.mutationKey),...t,_defaulted:!0}}clear(){q(this,ut).clear(),q(this,ni).clear()}},ut=new WeakMap,ni=new WeakMap,ri=new WeakMap,Ps=new WeakMap,Ds=new WeakMap,oi=new WeakMap,Ms=new WeakMap,Os=new WeakMap,o2),F4=C.createContext(void 0),L4=({client:t,children:e})=>(C.useEffect(()=>(t.mount(),()=>{t.unmount()}),[t]),w.jsx(F4.Provider,{value:t,children:e}));/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function xc(){return xc=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},xc.apply(this,arguments)}var si;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(si||(si={}));const Yx="popstate";function B4(t){t===void 0&&(t={});function e(r,o){let{pathname:i,search:a,hash:s}=r.location;return wv("",{pathname:i,search:a,hash:s},o.state&&o.state.usr||null,o.state&&o.state.key||"default")}function n(r,o){return typeof o=="string"?o:rf(o)}return U4(e,n,null,t)}function pt(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function H_(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function j4(){return Math.random().toString(36).substr(2,8)}function Qx(t,e){return{usr:t.state,key:t.key,idx:e}}function wv(t,e,n,r){return n===void 0&&(n=null),xc({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?uu(e):e,{state:n,key:e&&e.key||r||j4()})}function rf(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function uu(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function U4(t,e,n,r){r===void 0&&(r={});let{window:o=document.defaultView,v5Compat:i=!1}=r,a=o.history,s=si.Pop,u=null,c=l();c==null&&(c=0,a.replaceState(xc({},a.state,{idx:c}),""));function l(){return(a.state||{idx:null}).idx}function d(){s=si.Pop;let g=l(),v=g==null?null:g-c;c=g,u&&u({action:s,location:p.location,delta:v})}function f(g,v){s=si.Push;let y=wv(p.location,g,v);c=l()+1;let x=Qx(y,c),b=p.createHref(y);try{a.pushState(x,"",b)}catch(E){if(E instanceof DOMException&&E.name==="DataCloneError")throw E;o.location.assign(b)}i&&u&&u({action:s,location:p.location,delta:1})}function h(g,v){s=si.Replace;let y=wv(p.location,g,v);c=l();let x=Qx(y,c),b=p.createHref(y);a.replaceState(x,"",b),i&&u&&u({action:s,location:p.location,delta:0})}function m(g){let v=o.location.origin!=="null"?o.location.origin:o.location.href,y=typeof g=="string"?g:rf(g);return y=y.replace(/ $/,"%20"),pt(v,"No window.location.(origin|href) available to create URL for href: "+y),new URL(y,v)}let p={get action(){return s},get location(){return t(o,a)},listen(g){if(u)throw new Error("A history only accepts one active listener");return o.addEventListener(Yx,d),u=g,()=>{o.removeEventListener(Yx,d),u=null}},createHref(g){return e(o,g)},createURL:m,encodeLocation(g){let v=m(g);return{pathname:v.pathname,search:v.search,hash:v.hash}},push:f,replace:h,go(g){return a.go(g)}};return p}var Jx;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(Jx||(Jx={}));function W4(t,e,n){return n===void 0&&(n="/"),$4(t,e,n,!1)}function $4(t,e,n,r){let o=typeof e=="string"?uu(e):e,i=Cy(o.pathname||"/",n);if(i==null)return null;let a=G_(t);z4(a);let s=null;for(let u=0;s==null&&u<a.length;++u){let c=eF(i);s=J4(a[u],c,r)}return s}function G_(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let o=(i,a,s)=>{let u={relativePath:s===void 0?i.path||"":s,caseSensitive:i.caseSensitive===!0,childrenIndex:a,route:i};u.relativePath.startsWith("/")&&(pt(u.relativePath.startsWith(r),'Absolute route path "'+u.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),u.relativePath=u.relativePath.slice(r.length));let c=yi([r,u.relativePath]),l=n.concat(u);i.children&&i.children.length>0&&(pt(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+c+'".')),G_(i.children,e,l,c)),!(i.path==null&&!i.index)&&e.push({path:c,score:Y4(c,i.index),routesMeta:l})};return t.forEach((i,a)=>{var s;if(i.path===""||!((s=i.path)!=null&&s.includes("?")))o(i,a);else for(let u of K_(i.path))o(i,a,u)}),e}function K_(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,o=n.endsWith("?"),i=n.replace(/\?$/,"");if(r.length===0)return o?[i,""]:[i];let a=K_(r.join("/")),s=[];return s.push(...a.map(u=>u===""?i:[i,u].join("/"))),o&&s.push(...a),s.map(u=>t.startsWith("/")&&u===""?"/":u)}function z4(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:Q4(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const V4=/^:[\w-]+$/,H4=3,G4=2,K4=1,q4=10,X4=-2,Zx=t=>t==="*";function Y4(t,e){let n=t.split("/"),r=n.length;return n.some(Zx)&&(r+=X4),e&&(r+=G4),n.filter(o=>!Zx(o)).reduce((o,i)=>o+(V4.test(i)?H4:i===""?K4:q4),r)}function Q4(t,e){return t.length===e.length&&t.slice(0,-1).every((r,o)=>r===e[o])?t[t.length-1]-e[e.length-1]:0}function J4(t,e,n){let{routesMeta:r}=t,o={},i="/",a=[];for(let s=0;s<r.length;++s){let u=r[s],c=s===r.length-1,l=i==="/"?e:e.slice(i.length)||"/",d=ew({path:u.relativePath,caseSensitive:u.caseSensitive,end:c},l),f=u.route;if(!d&&c&&n&&!r[r.length-1].route.index&&(d=ew({path:u.relativePath,caseSensitive:u.caseSensitive,end:!1},l)),!d)return null;Object.assign(o,d.params),a.push({params:o,pathname:yi([i,d.pathname]),pathnameBase:oF(yi([i,d.pathnameBase])),route:f}),d.pathnameBase!=="/"&&(i=yi([i,d.pathnameBase]))}return a}function ew(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=Z4(t.path,t.caseSensitive,t.end),o=e.match(n);if(!o)return null;let i=o[0],a=i.replace(/(.)\/+$/,"$1"),s=o.slice(1);return{params:r.reduce((c,l,d)=>{let{paramName:f,isOptional:h}=l;if(f==="*"){let p=s[d]||"";a=i.slice(0,i.length-p.length).replace(/(.)\/+$/,"$1")}const m=s[d];return h&&!m?c[f]=void 0:c[f]=(m||"").replace(/%2F/g,"/"),c},{}),pathname:i,pathnameBase:a,pattern:t}}function Z4(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),H_(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],o="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(a,s,u)=>(r.push({paramName:s,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),o+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?o+="\\/*$":t!==""&&t!=="/"&&(o+="(?:(?=\\/|$))"),[new RegExp(o,e?void 0:"i"),r]}function eF(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return H_(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function Cy(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function tF(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:o=""}=typeof t=="string"?uu(t):t;return{pathname:n?n.startsWith("/")?n:nF(n,e):e,search:iF(r),hash:aF(o)}}function nF(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(o=>{o===".."?n.length>1&&n.pop():o!=="."&&n.push(o)}),n.length>1?n.join("/"):"/"}function _p(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function rF(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function q_(t,e){let n=rF(t);return e?n.map((r,o)=>o===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function X_(t,e,n,r){r===void 0&&(r=!1);let o;typeof t=="string"?o=uu(t):(o=xc({},t),pt(!o.pathname||!o.pathname.includes("?"),_p("?","pathname","search",o)),pt(!o.pathname||!o.pathname.includes("#"),_p("#","pathname","hash",o)),pt(!o.search||!o.search.includes("#"),_p("#","search","hash",o)));let i=t===""||o.pathname==="",a=i?"/":o.pathname,s;if(a==null)s=n;else{let d=e.length-1;if(!r&&a.startsWith("..")){let f=a.split("/");for(;f[0]==="..";)f.shift(),d-=1;o.pathname=f.join("/")}s=d>=0?e[d]:"/"}let u=tF(o,s),c=a&&a!=="/"&&a.endsWith("/"),l=(i||a===".")&&n.endsWith("/");return!u.pathname.endsWith("/")&&(c||l)&&(u.pathname+="/"),u}const yi=t=>t.join("/").replace(/\/\/+/g,"/"),oF=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),iF=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,aF=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function sF(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const Y_=["post","put","patch","delete"];new Set(Y_);const uF=["get",...Y_];new Set(uF);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function wc(){return wc=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},wc.apply(this,arguments)}const _y=C.createContext(null),cF=C.createContext(null),Ca=C.createContext(null),ph=C.createContext(null),Mi=C.createContext({outlet:null,matches:[],isDataRoute:!1}),Q_=C.createContext(null);function lF(t,e){let{relative:n}=e===void 0?{}:e;zc()||pt(!1);let{basename:r,navigator:o}=C.useContext(Ca),{hash:i,pathname:a,search:s}=Z_(t,{relative:n}),u=a;return r!=="/"&&(u=a==="/"?r:yi([r,a])),o.createHref({pathname:u,search:s,hash:i})}function zc(){return C.useContext(ph)!=null}function _a(){return zc()||pt(!1),C.useContext(ph).location}function J_(t){C.useContext(Ca).static||C.useLayoutEffect(t)}function Vc(){let{isDataRoute:t}=C.useContext(Mi);return t?_F():dF()}function dF(){zc()||pt(!1);let t=C.useContext(_y),{basename:e,future:n,navigator:r}=C.useContext(Ca),{matches:o}=C.useContext(Mi),{pathname:i}=_a(),a=JSON.stringify(q_(o,n.v7_relativeSplatPath)),s=C.useRef(!1);return J_(()=>{s.current=!0}),C.useCallback(function(c,l){if(l===void 0&&(l={}),!s.current)return;if(typeof c=="number"){r.go(c);return}let d=X_(c,JSON.parse(a),i,l.relative==="path");t==null&&e!=="/"&&(d.pathname=d.pathname==="/"?e:yi([e,d.pathname])),(l.replace?r.replace:r.push)(d,l.state,l)},[e,r,a,i,t])}function fF(){let{matches:t}=C.useContext(Mi),e=t[t.length-1];return e?e.params:{}}function Z_(t,e){let{relative:n}=e===void 0?{}:e,{future:r}=C.useContext(Ca),{matches:o}=C.useContext(Mi),{pathname:i}=_a(),a=JSON.stringify(q_(o,r.v7_relativeSplatPath));return C.useMemo(()=>X_(t,JSON.parse(a),i,n==="path"),[t,a,i,n])}function hF(t,e){return pF(t,e)}function pF(t,e,n,r){zc()||pt(!1);let{navigator:o}=C.useContext(Ca),{matches:i}=C.useContext(Mi),a=i[i.length-1],s=a?a.params:{};a&&a.pathname;let u=a?a.pathnameBase:"/";a&&a.route;let c=_a(),l;if(e){var d;let g=typeof e=="string"?uu(e):e;u==="/"||(d=g.pathname)!=null&&d.startsWith(u)||pt(!1),l=g}else l=c;let f=l.pathname||"/",h=f;if(u!=="/"){let g=u.replace(/^\//,"").split("/");h="/"+f.replace(/^\//,"").split("/").slice(g.length).join("/")}let m=W4(t,{pathname:h}),p=xF(m&&m.map(g=>Object.assign({},g,{params:Object.assign({},s,g.params),pathname:yi([u,o.encodeLocation?o.encodeLocation(g.pathname).pathname:g.pathname]),pathnameBase:g.pathnameBase==="/"?u:yi([u,o.encodeLocation?o.encodeLocation(g.pathnameBase).pathname:g.pathnameBase])})),i,n,r);return e&&p?C.createElement(ph.Provider,{value:{location:wc({pathname:"/",search:"",hash:"",state:null,key:"default"},l),navigationType:si.Pop}},p):p}function mF(){let t=CF(),e=sF(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,o={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return C.createElement(C.Fragment,null,C.createElement("h2",null,"Unexpected Application Error!"),C.createElement("h3",{style:{fontStyle:"italic"}},e),n?C.createElement("pre",{style:o},n):null,null)}const vF=C.createElement(mF,null);class gF extends C.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?C.createElement(Mi.Provider,{value:this.props.routeContext},C.createElement(Q_.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function yF(t){let{routeContext:e,match:n,children:r}=t,o=C.useContext(_y);return o&&o.static&&o.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(o.staticContext._deepestRenderedBoundaryId=n.route.id),C.createElement(Mi.Provider,{value:e},r)}function xF(t,e,n,r){var o;if(e===void 0&&(e=[]),n===void 0&&(n=null),r===void 0&&(r=null),t==null){var i;if(!n)return null;if(n.errors)t=n.matches;else if((i=r)!=null&&i.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let a=t,s=(o=n)==null?void 0:o.errors;if(s!=null){let l=a.findIndex(d=>d.route.id&&(s==null?void 0:s[d.route.id])!==void 0);l>=0||pt(!1),a=a.slice(0,Math.min(a.length,l+1))}let u=!1,c=-1;if(n&&r&&r.v7_partialHydration)for(let l=0;l<a.length;l++){let d=a[l];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(c=l),d.route.id){let{loaderData:f,errors:h}=n,m=d.route.loader&&f[d.route.id]===void 0&&(!h||h[d.route.id]===void 0);if(d.route.lazy||m){u=!0,c>=0?a=a.slice(0,c+1):a=[a[0]];break}}}return a.reduceRight((l,d,f)=>{let h,m=!1,p=null,g=null;n&&(h=s&&d.route.id?s[d.route.id]:void 0,p=d.route.errorElement||vF,u&&(c<0&&f===0?(m=!0,g=null):c===f&&(m=!0,g=d.route.hydrateFallbackElement||null)));let v=e.concat(a.slice(0,f+1)),y=()=>{let x;return h?x=p:m?x=g:d.route.Component?x=C.createElement(d.route.Component,null):d.route.element?x=d.route.element:x=l,C.createElement(yF,{match:d,routeContext:{outlet:l,matches:v,isDataRoute:n!=null},children:x})};return n&&(d.route.ErrorBoundary||d.route.errorElement||f===0)?C.createElement(gF,{location:n.location,revalidation:n.revalidation,component:p,error:h,children:y(),routeContext:{outlet:null,matches:v,isDataRoute:!0}}):y()},null)}var eS=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(eS||{}),of=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(of||{});function wF(t){let e=C.useContext(_y);return e||pt(!1),e}function bF(t){let e=C.useContext(cF);return e||pt(!1),e}function EF(t){let e=C.useContext(Mi);return e||pt(!1),e}function tS(t){let e=EF(),n=e.matches[e.matches.length-1];return n.route.id||pt(!1),n.route.id}function CF(){var t;let e=C.useContext(Q_),n=bF(of.UseRouteError),r=tS(of.UseRouteError);return e!==void 0?e:(t=n.errors)==null?void 0:t[r]}function _F(){let{router:t}=wF(eS.UseNavigateStable),e=tS(of.UseNavigateStable),n=C.useRef(!1);return J_(()=>{n.current=!0}),C.useCallback(function(o,i){i===void 0&&(i={}),n.current&&(typeof o=="number"?t.navigate(o):t.navigate(o,wc({fromRouteId:e},i)))},[t,e])}function SF(t,e){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function Vi(t){pt(!1)}function kF(t){let{basename:e="/",children:n=null,location:r,navigationType:o=si.Pop,navigator:i,static:a=!1,future:s}=t;zc()&&pt(!1);let u=e.replace(/^\/*/,"/"),c=C.useMemo(()=>({basename:u,navigator:i,static:a,future:wc({v7_relativeSplatPath:!1},s)}),[u,s,i,a]);typeof r=="string"&&(r=uu(r));let{pathname:l="/",search:d="",hash:f="",state:h=null,key:m="default"}=r,p=C.useMemo(()=>{let g=Cy(l,u);return g==null?null:{location:{pathname:g,search:d,hash:f,state:h,key:m},navigationType:o}},[u,l,d,f,h,m,o]);return p==null?null:C.createElement(Ca.Provider,{value:c},C.createElement(ph.Provider,{children:n,value:p}))}function IF(t){let{children:e,location:n}=t;return hF(bv(e),n)}new Promise(()=>{});function bv(t,e){e===void 0&&(e=[]);let n=[];return C.Children.forEach(t,(r,o)=>{if(!C.isValidElement(r))return;let i=[...e,o];if(r.type===C.Fragment){n.push.apply(n,bv(r.props.children,i));return}r.type!==Vi&&pt(!1),!r.props.index||!r.props.children||pt(!1);let a={id:r.props.id||i.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(a.children=bv(r.props.children,i)),n.push(a)}),n}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ev(){return Ev=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Ev.apply(this,arguments)}function RF(t,e){if(t==null)return{};var n={},r=Object.keys(t),o,i;for(i=0;i<r.length;i++)o=r[i],!(e.indexOf(o)>=0)&&(n[o]=t[o]);return n}function TF(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function NF(t,e){return t.button===0&&(!e||e==="_self")&&!TF(t)}function Cv(t){return t===void 0&&(t=""),new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,n)=>{let r=t[n];return e.concat(Array.isArray(r)?r.map(o=>[n,o]):[[n,r]])},[]))}function AF(t,e){let n=Cv(t);return e&&e.forEach((r,o)=>{n.has(o)||e.getAll(o).forEach(i=>{n.append(o,i)})}),n}const PF=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],DF="6";try{window.__reactRouterVersion=DF}catch{}const MF="startTransition",tw=fg[MF];function OF(t){let{basename:e,children:n,future:r,window:o}=t,i=C.useRef();i.current==null&&(i.current=B4({window:o,v5Compat:!0}));let a=i.current,[s,u]=C.useState({action:a.action,location:a.location}),{v7_startTransition:c}=r||{},l=C.useCallback(d=>{c&&tw?tw(()=>u(d)):u(d)},[u,c]);return C.useLayoutEffect(()=>a.listen(l),[a,l]),C.useEffect(()=>SF(r),[r]),C.createElement(kF,{basename:e,children:n,location:s.location,navigationType:s.action,navigator:a,future:r})}const FF=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",LF=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,hn=C.forwardRef(function(e,n){let{onClick:r,relative:o,reloadDocument:i,replace:a,state:s,target:u,to:c,preventScrollReset:l,viewTransition:d}=e,f=RF(e,PF),{basename:h}=C.useContext(Ca),m,p=!1;if(typeof c=="string"&&LF.test(c)&&(m=c,FF))try{let x=new URL(window.location.href),b=c.startsWith("//")?new URL(x.protocol+c):new URL(c),E=Cy(b.pathname,h);b.origin===x.origin&&E!=null?c=E+b.search+b.hash:p=!0}catch{}let g=lF(c,{relative:o}),v=BF(c,{replace:a,state:s,target:u,preventScrollReset:l,relative:o,viewTransition:d});function y(x){r&&r(x),x.defaultPrevented||v(x)}return C.createElement("a",Ev({},f,{href:m||g,onClick:p||i?r:y,ref:n,target:u}))});var nw;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(nw||(nw={}));var rw;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(rw||(rw={}));function BF(t,e){let{target:n,replace:r,state:o,preventScrollReset:i,relative:a,viewTransition:s}=e===void 0?{}:e,u=Vc(),c=_a(),l=Z_(t,{relative:a});return C.useCallback(d=>{if(NF(d,n)){d.preventDefault();let f=r!==void 0?r:rf(c)===rf(l);u(t,{replace:f,state:o,preventScrollReset:i,relative:a,viewTransition:s})}},[c,u,l,r,o,n,t,i,a,s])}function Sy(t){let e=C.useRef(Cv(t)),n=C.useRef(!1),r=_a(),o=C.useMemo(()=>AF(r.search,n.current?null:e.current),[r.search]),i=Vc(),a=C.useCallback((s,u)=>{const c=Cv(typeof s=="function"?s(o):s);n.current=!0,i("?"+c,u)},[i,o]);return[o,a]}const jF=ih("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-lg text-sm font-medium ring-offset-background transition-all duration-300 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90 shadow-soft hover:shadow-card",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80 shadow-soft",ghost:"hover:bg-accent/10 hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline",hero:"bg-gradient-river text-primary-foreground font-semibold shadow-elevated hover:shadow-card hover:-translate-y-0.5 active:translate-y-0",heroOutline:"border-2 border-primary-foreground/80 text-primary-foreground bg-primary-foreground/10 backdrop-blur-sm hover:bg-primary-foreground/20 font-semibold",accent:"bg-accent text-accent-foreground hover:bg-accent/90 shadow-soft",sky:"bg-secondary text-secondary-foreground hover:bg-secondary/80 shadow-soft hover:shadow-card"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-12 rounded-xl px-8 text-base",xl:"h-14 rounded-xl px-10 text-lg",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),Ae=C.forwardRef(({className:t,variant:e,size:n,asChild:r=!1,...o},i)=>{const a=r?ZP:"button";return w.jsx(a,{className:be(jF({variant:e,size:n,className:t})),ref:i,...o})});Ae.displayName="Button";var UF=C.createContext(void 0);function ky(t){const e=C.useContext(UF);return t||e||"ltr"}var Sp=0;function WF(){C.useEffect(()=>{const t=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",t[0]??ow()),document.body.insertAdjacentElement("beforeend",t[1]??ow()),Sp++,()=>{Sp===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),Sp--}},[])}function ow(){const t=document.createElement("span");return t.setAttribute("data-radix-focus-guard",""),t.tabIndex=0,t.style.outline="none",t.style.opacity="0",t.style.position="fixed",t.style.pointerEvents="none",t}var kp="focusScope.autoFocusOnMount",Ip="focusScope.autoFocusOnUnmount",iw={bubbles:!1,cancelable:!0},$F="FocusScope",nS=C.forwardRef((t,e)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:o,onUnmountAutoFocus:i,...a}=t,[s,u]=C.useState(null),c=wn(o),l=wn(i),d=C.useRef(null),f=Pt(e,p=>u(p)),h=C.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;C.useEffect(()=>{if(r){let p=function(x){if(h.paused||!s)return;const b=x.target;s.contains(b)?d.current=b:Ho(d.current,{select:!0})},g=function(x){if(h.paused||!s)return;const b=x.relatedTarget;b!==null&&(s.contains(b)||Ho(d.current,{select:!0}))},v=function(x){if(document.activeElement===document.body)for(const E of x)E.removedNodes.length>0&&Ho(s)};document.addEventListener("focusin",p),document.addEventListener("focusout",g);const y=new MutationObserver(v);return s&&y.observe(s,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",p),document.removeEventListener("focusout",g),y.disconnect()}}},[r,s,h.paused]),C.useEffect(()=>{if(s){sw.add(h);const p=document.activeElement;if(!s.contains(p)){const v=new CustomEvent(kp,iw);s.addEventListener(kp,c),s.dispatchEvent(v),v.defaultPrevented||(zF(qF(rS(s)),{select:!0}),document.activeElement===p&&Ho(s))}return()=>{s.removeEventListener(kp,c),setTimeout(()=>{const v=new CustomEvent(Ip,iw);s.addEventListener(Ip,l),s.dispatchEvent(v),v.defaultPrevented||Ho(p??document.body,{select:!0}),s.removeEventListener(Ip,l),sw.remove(h)},0)}}},[s,c,l,h]);const m=C.useCallback(p=>{if(!n&&!r||h.paused)return;const g=p.key==="Tab"&&!p.altKey&&!p.ctrlKey&&!p.metaKey,v=document.activeElement;if(g&&v){const y=p.currentTarget,[x,b]=VF(y);x&&b?!p.shiftKey&&v===b?(p.preventDefault(),n&&Ho(x,{select:!0})):p.shiftKey&&v===x&&(p.preventDefault(),n&&Ho(b,{select:!0})):v===y&&p.preventDefault()}},[n,r,h.paused]);return w.jsx(Ue.div,{tabIndex:-1,...a,ref:f,onKeyDown:m})});nS.displayName=$F;function zF(t,{select:e=!1}={}){const n=document.activeElement;for(const r of t)if(Ho(r,{select:e}),document.activeElement!==n)return}function VF(t){const e=rS(t),n=aw(e,t),r=aw(e.reverse(),t);return[n,r]}function rS(t){const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const o=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||o?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)e.push(n.currentNode);return e}function aw(t,e){for(const n of t)if(!HF(n,{upTo:e}))return n}function HF(t,{upTo:e}){if(getComputedStyle(t).visibility==="hidden")return!0;for(;t;){if(e!==void 0&&t===e)return!1;if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1}function GF(t){return t instanceof HTMLInputElement&&"select"in t}function Ho(t,{select:e=!1}={}){if(t&&t.focus){const n=document.activeElement;t.focus({preventScroll:!0}),t!==n&&GF(t)&&e&&t.select()}}var sw=KF();function KF(){let t=[];return{add(e){const n=t[0];e!==n&&(n==null||n.pause()),t=uw(t,e),t.unshift(e)},remove(e){var n;t=uw(t,e),(n=t[0])==null||n.resume()}}}function uw(t,e){const n=[...t],r=n.indexOf(e);return r!==-1&&n.splice(r,1),n}function qF(t){return t.filter(e=>e.tagName!=="A")}var Rp="rovingFocusGroup.onEntryFocus",XF={bubbles:!1,cancelable:!0},Hc="RovingFocusGroup",[_v,oS,YF]=oy(Hc),[QF,mh]=ko(Hc,[YF]),[JF,ZF]=QF(Hc),iS=C.forwardRef((t,e)=>w.jsx(_v.Provider,{scope:t.__scopeRovingFocusGroup,children:w.jsx(_v.Slot,{scope:t.__scopeRovingFocusGroup,children:w.jsx(eL,{...t,ref:e})})}));iS.displayName=Hc;var eL=C.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:n,orientation:r,loop:o=!1,dir:i,currentTabStopId:a,defaultCurrentTabStopId:s,onCurrentTabStopIdChange:u,onEntryFocus:c,preventScrollOnEntryFocus:l=!1,...d}=t,f=C.useRef(null),h=Pt(e,f),m=ky(i),[p,g]=nh({prop:a,defaultProp:s??null,onChange:u,caller:Hc}),[v,y]=C.useState(!1),x=wn(c),b=oS(n),E=C.useRef(!1),[_,S]=C.useState(0);return C.useEffect(()=>{const k=f.current;if(k)return k.addEventListener(Rp,x),()=>k.removeEventListener(Rp,x)},[x]),w.jsx(JF,{scope:n,orientation:r,dir:m,loop:o,currentTabStopId:p,onItemFocus:C.useCallback(k=>g(k),[g]),onItemShiftTab:C.useCallback(()=>y(!0),[]),onFocusableItemAdd:C.useCallback(()=>S(k=>k+1),[]),onFocusableItemRemove:C.useCallback(()=>S(k=>k-1),[]),children:w.jsx(Ue.div,{tabIndex:v||_===0?-1:0,"data-orientation":r,...d,ref:h,style:{outline:"none",...t.style},onMouseDown:ve(t.onMouseDown,()=>{E.current=!0}),onFocus:ve(t.onFocus,k=>{const R=!E.current;if(k.target===k.currentTarget&&R&&!v){const I=new CustomEvent(Rp,XF);if(k.currentTarget.dispatchEvent(I),!I.defaultPrevented){const D=b().filter(j=>j.focusable),A=D.find(j=>j.active),W=D.find(j=>j.id===p),$=[A,W,...D].filter(Boolean).map(j=>j.ref.current);uS($,l)}}E.current=!1}),onBlur:ve(t.onBlur,()=>y(!1))})})}),aS="RovingFocusGroupItem",sS=C.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:n,focusable:r=!0,active:o=!1,tabStopId:i,children:a,...s}=t,u=Qd(),c=i||u,l=ZF(aS,n),d=l.currentTabStopId===c,f=oS(n),{onFocusableItemAdd:h,onFocusableItemRemove:m,currentTabStopId:p}=l;return C.useEffect(()=>{if(r)return h(),()=>m()},[r,h,m]),w.jsx(_v.ItemSlot,{scope:n,id:c,focusable:r,active:o,children:w.jsx(Ue.span,{tabIndex:d?0:-1,"data-orientation":l.orientation,...s,ref:e,onMouseDown:ve(t.onMouseDown,g=>{r?l.onItemFocus(c):g.preventDefault()}),onFocus:ve(t.onFocus,()=>l.onItemFocus(c)),onKeyDown:ve(t.onKeyDown,g=>{if(g.key==="Tab"&&g.shiftKey){l.onItemShiftTab();return}if(g.target!==g.currentTarget)return;const v=rL(g,l.orientation,l.dir);if(v!==void 0){if(g.metaKey||g.ctrlKey||g.altKey||g.shiftKey)return;g.preventDefault();let x=f().filter(b=>b.focusable).map(b=>b.ref.current);if(v==="last")x.reverse();else if(v==="prev"||v==="next"){v==="prev"&&x.reverse();const b=x.indexOf(g.currentTarget);x=l.loop?oL(x,b+1):x.slice(b+1)}setTimeout(()=>uS(x))}}),children:typeof a=="function"?a({isCurrentTabStop:d,hasTabStop:p!=null}):a})})});sS.displayName=aS;var tL={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function nL(t,e){return e!=="rtl"?t:t==="ArrowLeft"?"ArrowRight":t==="ArrowRight"?"ArrowLeft":t}function rL(t,e,n){const r=nL(t.key,n);if(!(e==="vertical"&&["ArrowLeft","ArrowRight"].includes(r))&&!(e==="horizontal"&&["ArrowUp","ArrowDown"].includes(r)))return tL[r]}function uS(t,e=!1){const n=document.activeElement;for(const r of t)if(r===n||(r.focus({preventScroll:e}),document.activeElement!==n))return}function oL(t,e){return t.map((n,r)=>t[(e+r)%t.length])}var cS=iS,lS=sS,iL=function(t){if(typeof document>"u")return null;var e=Array.isArray(t)?t[0]:t;return e.ownerDocument.body},La=new WeakMap,Fl=new WeakMap,Ll={},Tp=0,dS=function(t){return t&&(t.host||dS(t.parentNode))},aL=function(t,e){return e.map(function(n){if(t.contains(n))return n;var r=dS(n);return r&&t.contains(r)?r:(console.error("aria-hidden",n,"in not contained inside",t,". Doing nothing"),null)}).filter(function(n){return!!n})},sL=function(t,e,n,r){var o=aL(e,Array.isArray(t)?t:[t]);Ll[n]||(Ll[n]=new WeakMap);var i=Ll[n],a=[],s=new Set,u=new Set(o),c=function(d){!d||s.has(d)||(s.add(d),c(d.parentNode))};o.forEach(c);var l=function(d){!d||u.has(d)||Array.prototype.forEach.call(d.children,function(f){if(s.has(f))l(f);else try{var h=f.getAttribute(r),m=h!==null&&h!=="false",p=(La.get(f)||0)+1,g=(i.get(f)||0)+1;La.set(f,p),i.set(f,g),a.push(f),p===1&&m&&Fl.set(f,!0),g===1&&f.setAttribute(n,"true"),m||f.setAttribute(r,"true")}catch(v){console.error("aria-hidden: cannot operate on ",f,v)}})};return l(e),s.clear(),Tp++,function(){a.forEach(function(d){var f=La.get(d)-1,h=i.get(d)-1;La.set(d,f),i.set(d,h),f||(Fl.has(d)||d.removeAttribute(r),Fl.delete(d)),h||d.removeAttribute(n)}),Tp--,Tp||(La=new WeakMap,La=new WeakMap,Fl=new WeakMap,Ll={})}},uL=function(t,e,n){n===void 0&&(n="data-aria-hidden");var r=Array.from(Array.isArray(t)?t:[t]),o=iL(t);return o?(r.push.apply(r,Array.from(o.querySelectorAll("[aria-live]"))),sL(r,o,n,"aria-hidden")):function(){return null}},Dr=function(){return Dr=Object.assign||function(e){for(var n,r=1,o=arguments.length;r<o;r++){n=arguments[r];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Dr.apply(this,arguments)};function Gc(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n}function cL(t,e,n){if(n||arguments.length===2)for(var r=0,o=e.length,i;r<o;r++)(i||!(r in e))&&(i||(i=Array.prototype.slice.call(e,0,r)),i[r]=e[r]);return t.concat(i||Array.prototype.slice.call(e))}var yd="right-scroll-bar-position",xd="width-before-scroll-bar",lL="with-scroll-bars-hidden",dL="--removed-body-scroll-bar-size";function Np(t,e){return typeof t=="function"?t(e):t&&(t.current=e),t}function fL(t,e){var n=C.useState(function(){return{value:t,callback:e,facade:{get current(){return n.value},set current(r){var o=n.value;o!==r&&(n.value=r,n.callback(r,o))}}}})[0];return n.callback=e,n.facade}var hL=typeof window<"u"?C.useLayoutEffect:C.useEffect,cw=new WeakMap;function pL(t,e){var n=fL(null,function(r){return t.forEach(function(o){return Np(o,r)})});return hL(function(){var r=cw.get(n);if(r){var o=new Set(r),i=new Set(t),a=n.current;o.forEach(function(s){i.has(s)||Np(s,null)}),i.forEach(function(s){o.has(s)||Np(s,a)})}cw.set(n,t)},[t]),n}function mL(t){return t}function vL(t,e){e===void 0&&(e=mL);var n=[],r=!1,o={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:t},useMedium:function(i){var a=e(i,r);return n.push(a),function(){n=n.filter(function(s){return s!==a})}},assignSyncMedium:function(i){for(r=!0;n.length;){var a=n;n=[],a.forEach(i)}n={push:function(s){return i(s)},filter:function(){return n}}},assignMedium:function(i){r=!0;var a=[];if(n.length){var s=n;n=[],s.forEach(i),a=n}var u=function(){var l=a;a=[],l.forEach(i)},c=function(){return Promise.resolve().then(u)};c(),n={push:function(l){a.push(l),c()},filter:function(l){return a=a.filter(l),n}}}};return o}function gL(t){t===void 0&&(t={});var e=vL(null);return e.options=Dr({async:!0,ssr:!1},t),e}var fS=function(t){var e=t.sideCar,n=Gc(t,["sideCar"]);if(!e)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=e.read();if(!r)throw new Error("Sidecar medium not found");return C.createElement(r,Dr({},n))};fS.isSideCarExport=!0;function yL(t,e){return t.useMedium(e),fS}var hS=gL(),Ap=function(){},vh=C.forwardRef(function(t,e){var n=C.useRef(null),r=C.useState({onScrollCapture:Ap,onWheelCapture:Ap,onTouchMoveCapture:Ap}),o=r[0],i=r[1],a=t.forwardProps,s=t.children,u=t.className,c=t.removeScrollBar,l=t.enabled,d=t.shards,f=t.sideCar,h=t.noRelative,m=t.noIsolation,p=t.inert,g=t.allowPinchZoom,v=t.as,y=v===void 0?"div":v,x=t.gapMode,b=Gc(t,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),E=f,_=pL([n,e]),S=Dr(Dr({},b),o);return C.createElement(C.Fragment,null,l&&C.createElement(E,{sideCar:hS,removeScrollBar:c,shards:d,noRelative:h,noIsolation:m,inert:p,setCallbacks:i,allowPinchZoom:!!g,lockRef:n,gapMode:x}),a?C.cloneElement(C.Children.only(s),Dr(Dr({},S),{ref:_})):C.createElement(y,Dr({},S,{className:u,ref:_}),s))});vh.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};vh.classNames={fullWidth:xd,zeroRight:yd};var xL=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function wL(){if(!document)return null;var t=document.createElement("style");t.type="text/css";var e=xL();return e&&t.setAttribute("nonce",e),t}function bL(t,e){t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e))}function EL(t){var e=document.head||document.getElementsByTagName("head")[0];e.appendChild(t)}var CL=function(){var t=0,e=null;return{add:function(n){t==0&&(e=wL())&&(bL(e,n),EL(e)),t++},remove:function(){t--,!t&&e&&(e.parentNode&&e.parentNode.removeChild(e),e=null)}}},_L=function(){var t=CL();return function(e,n){C.useEffect(function(){return t.add(e),function(){t.remove()}},[e&&n])}},pS=function(){var t=_L(),e=function(n){var r=n.styles,o=n.dynamic;return t(r,o),null};return e},SL={left:0,top:0,right:0,gap:0},Pp=function(t){return parseInt(t||"",10)||0},kL=function(t){var e=window.getComputedStyle(document.body),n=e[t==="padding"?"paddingLeft":"marginLeft"],r=e[t==="padding"?"paddingTop":"marginTop"],o=e[t==="padding"?"paddingRight":"marginRight"];return[Pp(n),Pp(r),Pp(o)]},IL=function(t){if(t===void 0&&(t="margin"),typeof window>"u")return SL;var e=kL(t),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:e[0],top:e[1],right:e[2],gap:Math.max(0,r-n+e[2]-e[0])}},RL=pS(),ms="data-scroll-locked",TL=function(t,e,n,r){var o=t.left,i=t.top,a=t.right,s=t.gap;return n===void 0&&(n="margin"),`
  .`.concat(lL,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(s,"px ").concat(r,`;
  }
  body[`).concat(ms,`] {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([e&&"position: relative ".concat(r,";"),n==="margin"&&`
    padding-left: `.concat(o,`px;
    padding-top: `).concat(i,`px;
    padding-right: `).concat(a,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(s,"px ").concat(r,`;
    `),n==="padding"&&"padding-right: ".concat(s,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(yd,` {
    right: `).concat(s,"px ").concat(r,`;
  }
  
  .`).concat(xd,` {
    margin-right: `).concat(s,"px ").concat(r,`;
  }
  
  .`).concat(yd," .").concat(yd,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat(xd," .").concat(xd,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body[`).concat(ms,`] {
    `).concat(dL,": ").concat(s,`px;
  }
`)},lw=function(){var t=parseInt(document.body.getAttribute(ms)||"0",10);return isFinite(t)?t:0},NL=function(){C.useEffect(function(){return document.body.setAttribute(ms,(lw()+1).toString()),function(){var t=lw()-1;t<=0?document.body.removeAttribute(ms):document.body.setAttribute(ms,t.toString())}},[])},AL=function(t){var e=t.noRelative,n=t.noImportant,r=t.gapMode,o=r===void 0?"margin":r;NL();var i=C.useMemo(function(){return IL(o)},[o]);return C.createElement(RL,{styles:TL(i,!e,o,n?"":"!important")})},Sv=!1;if(typeof window<"u")try{var Bl=Object.defineProperty({},"passive",{get:function(){return Sv=!0,!0}});window.addEventListener("test",Bl,Bl),window.removeEventListener("test",Bl,Bl)}catch{Sv=!1}var Ba=Sv?{passive:!1}:!1,PL=function(t){return t.tagName==="TEXTAREA"},mS=function(t,e){if(!(t instanceof Element))return!1;var n=window.getComputedStyle(t);return n[e]!=="hidden"&&!(n.overflowY===n.overflowX&&!PL(t)&&n[e]==="visible")},DL=function(t){return mS(t,"overflowY")},ML=function(t){return mS(t,"overflowX")},dw=function(t,e){var n=e.ownerDocument,r=e;do{typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&(r=r.host);var o=vS(t,r);if(o){var i=gS(t,r),a=i[1],s=i[2];if(a>s)return!0}r=r.parentNode}while(r&&r!==n.body);return!1},OL=function(t){var e=t.scrollTop,n=t.scrollHeight,r=t.clientHeight;return[e,n,r]},FL=function(t){var e=t.scrollLeft,n=t.scrollWidth,r=t.clientWidth;return[e,n,r]},vS=function(t,e){return t==="v"?DL(e):ML(e)},gS=function(t,e){return t==="v"?OL(e):FL(e)},LL=function(t,e){return t==="h"&&e==="rtl"?-1:1},BL=function(t,e,n,r,o){var i=LL(t,window.getComputedStyle(e).direction),a=i*r,s=n.target,u=e.contains(s),c=!1,l=a>0,d=0,f=0;do{if(!s)break;var h=gS(t,s),m=h[0],p=h[1],g=h[2],v=p-g-i*m;(m||v)&&vS(t,s)&&(d+=v,f+=m);var y=s.parentNode;s=y&&y.nodeType===Node.DOCUMENT_FRAGMENT_NODE?y.host:y}while(!u&&s!==document.body||u&&(e.contains(s)||e===s));return(l&&(Math.abs(d)<1||!o)||!l&&(Math.abs(f)<1||!o))&&(c=!0),c},jl=function(t){return"changedTouches"in t?[t.changedTouches[0].clientX,t.changedTouches[0].clientY]:[0,0]},fw=function(t){return[t.deltaX,t.deltaY]},hw=function(t){return t&&"current"in t?t.current:t},jL=function(t,e){return t[0]===e[0]&&t[1]===e[1]},UL=function(t){return`
  .block-interactivity-`.concat(t,` {pointer-events: none;}
  .allow-interactivity-`).concat(t,` {pointer-events: all;}
`)},WL=0,ja=[];function $L(t){var e=C.useRef([]),n=C.useRef([0,0]),r=C.useRef(),o=C.useState(WL++)[0],i=C.useState(pS)[0],a=C.useRef(t);C.useEffect(function(){a.current=t},[t]),C.useEffect(function(){if(t.inert){document.body.classList.add("block-interactivity-".concat(o));var p=cL([t.lockRef.current],(t.shards||[]).map(hw),!0).filter(Boolean);return p.forEach(function(g){return g.classList.add("allow-interactivity-".concat(o))}),function(){document.body.classList.remove("block-interactivity-".concat(o)),p.forEach(function(g){return g.classList.remove("allow-interactivity-".concat(o))})}}},[t.inert,t.lockRef.current,t.shards]);var s=C.useCallback(function(p,g){if("touches"in p&&p.touches.length===2||p.type==="wheel"&&p.ctrlKey)return!a.current.allowPinchZoom;var v=jl(p),y=n.current,x="deltaX"in p?p.deltaX:y[0]-v[0],b="deltaY"in p?p.deltaY:y[1]-v[1],E,_=p.target,S=Math.abs(x)>Math.abs(b)?"h":"v";if("touches"in p&&S==="h"&&_.type==="range")return!1;var k=dw(S,_);if(!k)return!0;if(k?E=S:(E=S==="v"?"h":"v",k=dw(S,_)),!k)return!1;if(!r.current&&"changedTouches"in p&&(x||b)&&(r.current=E),!E)return!0;var R=r.current||E;return BL(R,g,p,R==="h"?x:b,!0)},[]),u=C.useCallback(function(p){var g=p;if(!(!ja.length||ja[ja.length-1]!==i)){var v="deltaY"in g?fw(g):jl(g),y=e.current.filter(function(E){return E.name===g.type&&(E.target===g.target||g.target===E.shadowParent)&&jL(E.delta,v)})[0];if(y&&y.should){g.cancelable&&g.preventDefault();return}if(!y){var x=(a.current.shards||[]).map(hw).filter(Boolean).filter(function(E){return E.contains(g.target)}),b=x.length>0?s(g,x[0]):!a.current.noIsolation;b&&g.cancelable&&g.preventDefault()}}},[]),c=C.useCallback(function(p,g,v,y){var x={name:p,delta:g,target:v,should:y,shadowParent:zL(v)};e.current.push(x),setTimeout(function(){e.current=e.current.filter(function(b){return b!==x})},1)},[]),l=C.useCallback(function(p){n.current=jl(p),r.current=void 0},[]),d=C.useCallback(function(p){c(p.type,fw(p),p.target,s(p,t.lockRef.current))},[]),f=C.useCallback(function(p){c(p.type,jl(p),p.target,s(p,t.lockRef.current))},[]);C.useEffect(function(){return ja.push(i),t.setCallbacks({onScrollCapture:d,onWheelCapture:d,onTouchMoveCapture:f}),document.addEventListener("wheel",u,Ba),document.addEventListener("touchmove",u,Ba),document.addEventListener("touchstart",l,Ba),function(){ja=ja.filter(function(p){return p!==i}),document.removeEventListener("wheel",u,Ba),document.removeEventListener("touchmove",u,Ba),document.removeEventListener("touchstart",l,Ba)}},[]);var h=t.removeScrollBar,m=t.inert;return C.createElement(C.Fragment,null,m?C.createElement(i,{styles:UL(o)}):null,h?C.createElement(AL,{noRelative:t.noRelative,gapMode:t.gapMode}):null)}function zL(t){for(var e=null;t!==null;)t instanceof ShadowRoot&&(e=t.host,t=t.host),t=t.parentNode;return e}const VL=yL(hS,$L);var yS=C.forwardRef(function(t,e){return C.createElement(vh,Dr({},t,{ref:e,sideCar:VL}))});yS.classNames=vh.classNames;var kv=["Enter"," "],HL=["ArrowDown","PageUp","Home"],xS=["ArrowUp","PageDown","End"],GL=[...HL,...xS],KL={ltr:[...kv,"ArrowRight"],rtl:[...kv,"ArrowLeft"]},qL={ltr:["ArrowLeft"],rtl:["ArrowRight"]},Kc="Menu",[bc,XL,YL]=oy(Kc),[Sa,wS]=ko(Kc,[YL,ch,mh]),gh=ch(),bS=mh(),[QL,ka]=Sa(Kc),[JL,qc]=Sa(Kc),ES=t=>{const{__scopeMenu:e,open:n=!1,children:r,dir:o,onOpenChange:i,modal:a=!0}=t,s=gh(e),[u,c]=C.useState(null),l=C.useRef(!1),d=wn(i),f=ky(o);return C.useEffect(()=>{const h=()=>{l.current=!0,document.addEventListener("pointerdown",m,{capture:!0,once:!0}),document.addEventListener("pointermove",m,{capture:!0,once:!0})},m=()=>l.current=!1;return document.addEventListener("keydown",h,{capture:!0}),()=>{document.removeEventListener("keydown",h,{capture:!0}),document.removeEventListener("pointerdown",m,{capture:!0}),document.removeEventListener("pointermove",m,{capture:!0})}},[]),w.jsx(KO,{...s,children:w.jsx(QL,{scope:e,open:n,onOpenChange:d,content:u,onContentChange:c,children:w.jsx(JL,{scope:e,onClose:C.useCallback(()=>d(!1),[d]),isUsingKeyboardRef:l,dir:f,modal:a,children:r})})})};ES.displayName=Kc;var ZL="MenuAnchor",Iy=C.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t,o=gh(n);return w.jsx(I_,{...o,...r,ref:e})});Iy.displayName=ZL;var Ry="MenuPortal",[eB,CS]=Sa(Ry,{forceMount:void 0}),_S=t=>{const{__scopeMenu:e,forceMount:n,children:r,container:o}=t,i=ka(Ry,e);return w.jsx(eB,{scope:e,forceMount:n,children:w.jsx(Di,{present:n||i.open,children:w.jsx(ay,{asChild:!0,container:o,children:r})})})};_S.displayName=Ry;var Gn="MenuContent",[tB,Ty]=Sa(Gn),SS=C.forwardRef((t,e)=>{const n=CS(Gn,t.__scopeMenu),{forceMount:r=n.forceMount,...o}=t,i=ka(Gn,t.__scopeMenu),a=qc(Gn,t.__scopeMenu);return w.jsx(bc.Provider,{scope:t.__scopeMenu,children:w.jsx(Di,{present:r||i.open,children:w.jsx(bc.Slot,{scope:t.__scopeMenu,children:a.modal?w.jsx(nB,{...o,ref:e}):w.jsx(rB,{...o,ref:e})})})})}),nB=C.forwardRef((t,e)=>{const n=ka(Gn,t.__scopeMenu),r=C.useRef(null),o=Pt(e,r);return C.useEffect(()=>{const i=r.current;if(i)return uL(i)},[]),w.jsx(Ny,{...t,ref:o,trapFocus:n.open,disableOutsidePointerEvents:n.open,disableOutsideScroll:!0,onFocusOutside:ve(t.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>n.onOpenChange(!1)})}),rB=C.forwardRef((t,e)=>{const n=ka(Gn,t.__scopeMenu);return w.jsx(Ny,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>n.onOpenChange(!1)})}),oB=fc("MenuContent.ScrollLock"),Ny=C.forwardRef((t,e)=>{const{__scopeMenu:n,loop:r=!1,trapFocus:o,onOpenAutoFocus:i,onCloseAutoFocus:a,disableOutsidePointerEvents:s,onEntryFocus:u,onEscapeKeyDown:c,onPointerDownOutside:l,onFocusOutside:d,onInteractOutside:f,onDismiss:h,disableOutsideScroll:m,...p}=t,g=ka(Gn,n),v=qc(Gn,n),y=gh(n),x=bS(n),b=XL(n),[E,_]=C.useState(null),S=C.useRef(null),k=Pt(e,S,g.onContentChange),R=C.useRef(0),I=C.useRef(""),D=C.useRef(0),A=C.useRef(null),W=C.useRef("right"),F=C.useRef(0),$=m?yS:C.Fragment,j=m?{as:oB,allowPinchZoom:!0}:void 0,U=P=>{var J,ie;const B=I.current+P,V=b().filter(oe=>!oe.disabled),K=document.activeElement,Q=(J=V.find(oe=>oe.ref.current===K))==null?void 0:J.textValue,te=V.map(oe=>oe.textValue),ae=vB(te,B,Q),X=(ie=V.find(oe=>oe.textValue===ae))==null?void 0:ie.ref.current;(function oe(me){I.current=me,window.clearTimeout(R.current),me!==""&&(R.current=window.setTimeout(()=>oe(""),1e3))})(B),X&&setTimeout(()=>X.focus())};C.useEffect(()=>()=>window.clearTimeout(R.current),[]),WF();const M=C.useCallback(P=>{var V,K;return W.current===((V=A.current)==null?void 0:V.side)&&yB(P,(K=A.current)==null?void 0:K.area)},[]);return w.jsx(tB,{scope:n,searchRef:I,onItemEnter:C.useCallback(P=>{M(P)&&P.preventDefault()},[M]),onItemLeave:C.useCallback(P=>{var B;M(P)||((B=S.current)==null||B.focus(),_(null))},[M]),onTriggerLeave:C.useCallback(P=>{M(P)&&P.preventDefault()},[M]),pointerGraceTimerRef:D,onPointerGraceIntentChange:C.useCallback(P=>{A.current=P},[]),children:w.jsx($,{...j,children:w.jsx(nS,{asChild:!0,trapped:o,onMountAutoFocus:ve(i,P=>{var B;P.preventDefault(),(B=S.current)==null||B.focus({preventScroll:!0})}),onUnmountAutoFocus:a,children:w.jsx(th,{asChild:!0,disableOutsidePointerEvents:s,onEscapeKeyDown:c,onPointerDownOutside:l,onFocusOutside:d,onInteractOutside:f,onDismiss:h,children:w.jsx(cS,{asChild:!0,...x,dir:v.dir,orientation:"vertical",loop:r,currentTabStopId:E,onCurrentTabStopIdChange:_,onEntryFocus:ve(u,P=>{v.isUsingKeyboardRef.current||P.preventDefault()}),preventScrollOnEntryFocus:!0,children:w.jsx(R_,{role:"menu","aria-orientation":"vertical","data-state":WS(g.open),"data-radix-menu-content":"",dir:v.dir,...y,...p,ref:k,style:{outline:"none",...p.style},onKeyDown:ve(p.onKeyDown,P=>{const V=P.target.closest("[data-radix-menu-content]")===P.currentTarget,K=P.ctrlKey||P.altKey||P.metaKey,Q=P.key.length===1;V&&(P.key==="Tab"&&P.preventDefault(),!K&&Q&&U(P.key));const te=S.current;if(P.target!==te||!GL.includes(P.key))return;P.preventDefault();const X=b().filter(J=>!J.disabled).map(J=>J.ref.current);xS.includes(P.key)&&X.reverse(),pB(X)}),onBlur:ve(t.onBlur,P=>{P.currentTarget.contains(P.target)||(window.clearTimeout(R.current),I.current="")}),onPointerMove:ve(t.onPointerMove,Ec(P=>{const B=P.target,V=F.current!==P.clientX;if(P.currentTarget.contains(B)&&V){const K=P.clientX>F.current?"right":"left";W.current=K,F.current=P.clientX}}))})})})})})})});SS.displayName=Gn;var iB="MenuGroup",Ay=C.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t;return w.jsx(Ue.div,{role:"group",...r,ref:e})});Ay.displayName=iB;var aB="MenuLabel",kS=C.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t;return w.jsx(Ue.div,{...r,ref:e})});kS.displayName=aB;var af="MenuItem",pw="menu.itemSelect",yh=C.forwardRef((t,e)=>{const{disabled:n=!1,onSelect:r,...o}=t,i=C.useRef(null),a=qc(af,t.__scopeMenu),s=Ty(af,t.__scopeMenu),u=Pt(e,i),c=C.useRef(!1),l=()=>{const d=i.current;if(!n&&d){const f=new CustomEvent(pw,{bubbles:!0,cancelable:!0});d.addEventListener(pw,h=>r==null?void 0:r(h),{once:!0}),iy(d,f),f.defaultPrevented?c.current=!1:a.onClose()}};return w.jsx(IS,{...o,ref:u,disabled:n,onClick:ve(t.onClick,l),onPointerDown:d=>{var f;(f=t.onPointerDown)==null||f.call(t,d),c.current=!0},onPointerUp:ve(t.onPointerUp,d=>{var f;c.current||(f=d.currentTarget)==null||f.click()}),onKeyDown:ve(t.onKeyDown,d=>{const f=s.searchRef.current!=="";n||f&&d.key===" "||kv.includes(d.key)&&(d.currentTarget.click(),d.preventDefault())})})});yh.displayName=af;var IS=C.forwardRef((t,e)=>{const{__scopeMenu:n,disabled:r=!1,textValue:o,...i}=t,a=Ty(af,n),s=bS(n),u=C.useRef(null),c=Pt(e,u),[l,d]=C.useState(!1),[f,h]=C.useState("");return C.useEffect(()=>{const m=u.current;m&&h((m.textContent??"").trim())},[i.children]),w.jsx(bc.ItemSlot,{scope:n,disabled:r,textValue:o??f,children:w.jsx(lS,{asChild:!0,...s,focusable:!r,children:w.jsx(Ue.div,{role:"menuitem","data-highlighted":l?"":void 0,"aria-disabled":r||void 0,"data-disabled":r?"":void 0,...i,ref:c,onPointerMove:ve(t.onPointerMove,Ec(m=>{r?a.onItemLeave(m):(a.onItemEnter(m),m.defaultPrevented||m.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:ve(t.onPointerLeave,Ec(m=>a.onItemLeave(m))),onFocus:ve(t.onFocus,()=>d(!0)),onBlur:ve(t.onBlur,()=>d(!1))})})})}),sB="MenuCheckboxItem",RS=C.forwardRef((t,e)=>{const{checked:n=!1,onCheckedChange:r,...o}=t;return w.jsx(DS,{scope:t.__scopeMenu,checked:n,children:w.jsx(yh,{role:"menuitemcheckbox","aria-checked":sf(n)?"mixed":n,...o,ref:e,"data-state":Dy(n),onSelect:ve(o.onSelect,()=>r==null?void 0:r(sf(n)?!0:!n),{checkForDefaultPrevented:!1})})})});RS.displayName=sB;var TS="MenuRadioGroup",[uB,cB]=Sa(TS,{value:void 0,onValueChange:()=>{}}),NS=C.forwardRef((t,e)=>{const{value:n,onValueChange:r,...o}=t,i=wn(r);return w.jsx(uB,{scope:t.__scopeMenu,value:n,onValueChange:i,children:w.jsx(Ay,{...o,ref:e})})});NS.displayName=TS;var AS="MenuRadioItem",PS=C.forwardRef((t,e)=>{const{value:n,...r}=t,o=cB(AS,t.__scopeMenu),i=n===o.value;return w.jsx(DS,{scope:t.__scopeMenu,checked:i,children:w.jsx(yh,{role:"menuitemradio","aria-checked":i,...r,ref:e,"data-state":Dy(i),onSelect:ve(r.onSelect,()=>{var a;return(a=o.onValueChange)==null?void 0:a.call(o,n)},{checkForDefaultPrevented:!1})})})});PS.displayName=AS;var Py="MenuItemIndicator",[DS,lB]=Sa(Py,{checked:!1}),MS=C.forwardRef((t,e)=>{const{__scopeMenu:n,forceMount:r,...o}=t,i=lB(Py,n);return w.jsx(Di,{present:r||sf(i.checked)||i.checked===!0,children:w.jsx(Ue.span,{...o,ref:e,"data-state":Dy(i.checked)})})});MS.displayName=Py;var dB="MenuSeparator",OS=C.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t;return w.jsx(Ue.div,{role:"separator","aria-orientation":"horizontal",...r,ref:e})});OS.displayName=dB;var fB="MenuArrow",FS=C.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t,o=gh(n);return w.jsx(T_,{...o,...r,ref:e})});FS.displayName=fB;var hB="MenuSub",[KK,LS]=Sa(hB),Au="MenuSubTrigger",BS=C.forwardRef((t,e)=>{const n=ka(Au,t.__scopeMenu),r=qc(Au,t.__scopeMenu),o=LS(Au,t.__scopeMenu),i=Ty(Au,t.__scopeMenu),a=C.useRef(null),{pointerGraceTimerRef:s,onPointerGraceIntentChange:u}=i,c={__scopeMenu:t.__scopeMenu},l=C.useCallback(()=>{a.current&&window.clearTimeout(a.current),a.current=null},[]);return C.useEffect(()=>l,[l]),C.useEffect(()=>{const d=s.current;return()=>{window.clearTimeout(d),u(null)}},[s,u]),w.jsx(Iy,{asChild:!0,...c,children:w.jsx(IS,{id:o.triggerId,"aria-haspopup":"menu","aria-expanded":n.open,"aria-controls":o.contentId,"data-state":WS(n.open),...t,ref:eh(e,o.onTriggerChange),onClick:d=>{var f;(f=t.onClick)==null||f.call(t,d),!(t.disabled||d.defaultPrevented)&&(d.currentTarget.focus(),n.open||n.onOpenChange(!0))},onPointerMove:ve(t.onPointerMove,Ec(d=>{i.onItemEnter(d),!d.defaultPrevented&&!t.disabled&&!n.open&&!a.current&&(i.onPointerGraceIntentChange(null),a.current=window.setTimeout(()=>{n.onOpenChange(!0),l()},100))})),onPointerLeave:ve(t.onPointerLeave,Ec(d=>{var h,m;l();const f=(h=n.content)==null?void 0:h.getBoundingClientRect();if(f){const p=(m=n.content)==null?void 0:m.dataset.side,g=p==="right",v=g?-5:5,y=f[g?"left":"right"],x=f[g?"right":"left"];i.onPointerGraceIntentChange({area:[{x:d.clientX+v,y:d.clientY},{x:y,y:f.top},{x,y:f.top},{x,y:f.bottom},{x:y,y:f.bottom}],side:p}),window.clearTimeout(s.current),s.current=window.setTimeout(()=>i.onPointerGraceIntentChange(null),300)}else{if(i.onTriggerLeave(d),d.defaultPrevented)return;i.onPointerGraceIntentChange(null)}})),onKeyDown:ve(t.onKeyDown,d=>{var h;const f=i.searchRef.current!=="";t.disabled||f&&d.key===" "||KL[r.dir].includes(d.key)&&(n.onOpenChange(!0),(h=n.content)==null||h.focus(),d.preventDefault())})})})});BS.displayName=Au;var jS="MenuSubContent",US=C.forwardRef((t,e)=>{const n=CS(Gn,t.__scopeMenu),{forceMount:r=n.forceMount,...o}=t,i=ka(Gn,t.__scopeMenu),a=qc(Gn,t.__scopeMenu),s=LS(jS,t.__scopeMenu),u=C.useRef(null),c=Pt(e,u);return w.jsx(bc.Provider,{scope:t.__scopeMenu,children:w.jsx(Di,{present:r||i.open,children:w.jsx(bc.Slot,{scope:t.__scopeMenu,children:w.jsx(Ny,{id:s.contentId,"aria-labelledby":s.triggerId,...o,ref:c,align:"start",side:a.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:l=>{var d;a.isUsingKeyboardRef.current&&((d=u.current)==null||d.focus()),l.preventDefault()},onCloseAutoFocus:l=>l.preventDefault(),onFocusOutside:ve(t.onFocusOutside,l=>{l.target!==s.trigger&&i.onOpenChange(!1)}),onEscapeKeyDown:ve(t.onEscapeKeyDown,l=>{a.onClose(),l.preventDefault()}),onKeyDown:ve(t.onKeyDown,l=>{var h;const d=l.currentTarget.contains(l.target),f=qL[a.dir].includes(l.key);d&&f&&(i.onOpenChange(!1),(h=s.trigger)==null||h.focus(),l.preventDefault())})})})})})});US.displayName=jS;function WS(t){return t?"open":"closed"}function sf(t){return t==="indeterminate"}function Dy(t){return sf(t)?"indeterminate":t?"checked":"unchecked"}function pB(t){const e=document.activeElement;for(const n of t)if(n===e||(n.focus(),document.activeElement!==e))return}function mB(t,e){return t.map((n,r)=>t[(e+r)%t.length])}function vB(t,e,n){const o=e.length>1&&Array.from(e).every(c=>c===e[0])?e[0]:e,i=n?t.indexOf(n):-1;let a=mB(t,Math.max(i,0));o.length===1&&(a=a.filter(c=>c!==n));const u=a.find(c=>c.toLowerCase().startsWith(o.toLowerCase()));return u!==n?u:void 0}function gB(t,e){const{x:n,y:r}=t;let o=!1;for(let i=0,a=e.length-1;i<e.length;a=i++){const s=e[i],u=e[a],c=s.x,l=s.y,d=u.x,f=u.y;l>r!=f>r&&n<(d-c)*(r-l)/(f-l)+c&&(o=!o)}return o}function yB(t,e){if(!e)return!1;const n={x:t.clientX,y:t.clientY};return gB(n,e)}function Ec(t){return e=>e.pointerType==="mouse"?t(e):void 0}var xB=ES,wB=Iy,bB=_S,EB=SS,CB=Ay,_B=kS,SB=yh,kB=RS,IB=NS,RB=PS,TB=MS,NB=OS,AB=FS,PB=BS,DB=US,xh="DropdownMenu",[MB,qK]=ko(xh,[wS]),un=wS(),[OB,$S]=MB(xh),zS=t=>{const{__scopeDropdownMenu:e,children:n,dir:r,open:o,defaultOpen:i,onOpenChange:a,modal:s=!0}=t,u=un(e),c=C.useRef(null),[l,d]=nh({prop:o,defaultProp:i??!1,onChange:a,caller:xh});return w.jsx(OB,{scope:e,triggerId:Qd(),triggerRef:c,contentId:Qd(),open:l,onOpenChange:d,onOpenToggle:C.useCallback(()=>d(f=>!f),[d]),modal:s,children:w.jsx(xB,{...u,open:l,onOpenChange:d,dir:r,modal:s,children:n})})};zS.displayName=xh;var VS="DropdownMenuTrigger",HS=C.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,disabled:r=!1,...o}=t,i=$S(VS,n),a=un(n);return w.jsx(wB,{asChild:!0,...a,children:w.jsx(Ue.button,{type:"button",id:i.triggerId,"aria-haspopup":"menu","aria-expanded":i.open,"aria-controls":i.open?i.contentId:void 0,"data-state":i.open?"open":"closed","data-disabled":r?"":void 0,disabled:r,...o,ref:eh(e,i.triggerRef),onPointerDown:ve(t.onPointerDown,s=>{!r&&s.button===0&&s.ctrlKey===!1&&(i.onOpenToggle(),i.open||s.preventDefault())}),onKeyDown:ve(t.onKeyDown,s=>{r||(["Enter"," "].includes(s.key)&&i.onOpenToggle(),s.key==="ArrowDown"&&i.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(s.key)&&s.preventDefault())})})})});HS.displayName=VS;var FB="DropdownMenuPortal",GS=t=>{const{__scopeDropdownMenu:e,...n}=t,r=un(e);return w.jsx(bB,{...r,...n})};GS.displayName=FB;var KS="DropdownMenuContent",qS=C.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,o=$S(KS,n),i=un(n),a=C.useRef(!1);return w.jsx(EB,{id:o.contentId,"aria-labelledby":o.triggerId,...i,...r,ref:e,onCloseAutoFocus:ve(t.onCloseAutoFocus,s=>{var u;a.current||(u=o.triggerRef.current)==null||u.focus(),a.current=!1,s.preventDefault()}),onInteractOutside:ve(t.onInteractOutside,s=>{const u=s.detail.originalEvent,c=u.button===0&&u.ctrlKey===!0,l=u.button===2||c;(!o.modal||l)&&(a.current=!0)}),style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});qS.displayName=KS;var LB="DropdownMenuGroup",BB=C.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,o=un(n);return w.jsx(CB,{...o,...r,ref:e})});BB.displayName=LB;var jB="DropdownMenuLabel",XS=C.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,o=un(n);return w.jsx(_B,{...o,...r,ref:e})});XS.displayName=jB;var UB="DropdownMenuItem",YS=C.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,o=un(n);return w.jsx(SB,{...o,...r,ref:e})});YS.displayName=UB;var WB="DropdownMenuCheckboxItem",QS=C.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,o=un(n);return w.jsx(kB,{...o,...r,ref:e})});QS.displayName=WB;var $B="DropdownMenuRadioGroup",zB=C.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,o=un(n);return w.jsx(IB,{...o,...r,ref:e})});zB.displayName=$B;var VB="DropdownMenuRadioItem",JS=C.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,o=un(n);return w.jsx(RB,{...o,...r,ref:e})});JS.displayName=VB;var HB="DropdownMenuItemIndicator",ZS=C.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,o=un(n);return w.jsx(TB,{...o,...r,ref:e})});ZS.displayName=HB;var GB="DropdownMenuSeparator",ek=C.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,o=un(n);return w.jsx(NB,{...o,...r,ref:e})});ek.displayName=GB;var KB="DropdownMenuArrow",qB=C.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,o=un(n);return w.jsx(AB,{...o,...r,ref:e})});qB.displayName=KB;var XB="DropdownMenuSubTrigger",tk=C.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,o=un(n);return w.jsx(PB,{...o,...r,ref:e})});tk.displayName=XB;var YB="DropdownMenuSubContent",nk=C.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,o=un(n);return w.jsx(DB,{...o,...r,ref:e,style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});nk.displayName=YB;var QB=zS,JB=HS,ZB=GS,rk=qS,ok=XS,ik=YS,ak=QS,sk=JS,uk=ZS,ck=ek,lk=tk,dk=nk;const ej=QB,tj=JB,nj=C.forwardRef(({className:t,inset:e,children:n,...r},o)=>w.jsxs(lk,{ref:o,className:be("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[state=open]:bg-accent focus:bg-accent",e&&"pl-8",t),...r,children:[n,w.jsx(XD,{className:"ml-auto h-4 w-4"})]}));nj.displayName=lk.displayName;const rj=C.forwardRef(({className:t,...e},n)=>w.jsx(dk,{ref:n,className:be("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...e}));rj.displayName=dk.displayName;const fk=C.forwardRef(({className:t,sideOffset:e=4,...n},r)=>w.jsx(ZB,{children:w.jsx(rk,{ref:r,sideOffset:e,className:be("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...n})}));fk.displayName=rk.displayName;const Iv=C.forwardRef(({className:t,inset:e,...n},r)=>w.jsx(ik,{ref:r,className:be("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",e&&"pl-8",t),...n}));Iv.displayName=ik.displayName;const oj=C.forwardRef(({className:t,children:e,checked:n,...r},o)=>w.jsxs(ak,{ref:o,className:be("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",t),checked:n,...r,children:[w.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:w.jsx(uk,{children:w.jsx(KD,{className:"h-4 w-4"})})}),e]}));oj.displayName=ak.displayName;const ij=C.forwardRef(({className:t,children:e,...n},r)=>w.jsxs(sk,{ref:r,className:be("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",t),...n,children:[w.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:w.jsx(uk,{children:w.jsx(JD,{className:"h-2 w-2 fill-current"})})}),e]}));ij.displayName=sk.displayName;const hk=C.forwardRef(({className:t,inset:e,...n},r)=>w.jsx(ok,{ref:r,className:be("px-2 py-1.5 text-sm font-semibold",e&&"pl-8",t),...n}));hk.displayName=ok.displayName;const pk=C.forwardRef(({className:t,...e},n)=>w.jsx(ck,{ref:n,className:be("-mx-1 my-1 h-px bg-muted",t),...e}));pk.displayName=ck.displayName;var mk={exports:{}},vk={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Gs=C;function aj(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var sj=typeof Object.is=="function"?Object.is:aj,uj=Gs.useState,cj=Gs.useEffect,lj=Gs.useLayoutEffect,dj=Gs.useDebugValue;function fj(t,e){var n=e(),r=uj({inst:{value:n,getSnapshot:e}}),o=r[0].inst,i=r[1];return lj(function(){o.value=n,o.getSnapshot=e,Dp(o)&&i({inst:o})},[t,n,e]),cj(function(){return Dp(o)&&i({inst:o}),t(function(){Dp(o)&&i({inst:o})})},[t]),dj(n),n}function Dp(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!sj(t,n)}catch{return!0}}function hj(t,e){return e()}var pj=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?hj:fj;vk.useSyncExternalStore=Gs.useSyncExternalStore!==void 0?Gs.useSyncExternalStore:pj;mk.exports=vk;var mj=mk.exports;function vj(){return mj.useSyncExternalStore(gj,()=>!0,()=>!1)}function gj(){return()=>{}}var My="Avatar",[yj,XK]=ko(My),[xj,gk]=yj(My),yk=C.forwardRef((t,e)=>{const{__scopeAvatar:n,...r}=t,[o,i]=C.useState("idle");return w.jsx(xj,{scope:n,imageLoadingStatus:o,onImageLoadingStatusChange:i,children:w.jsx(Ue.span,{...r,ref:e})})});yk.displayName=My;var xk="AvatarImage",wk=C.forwardRef((t,e)=>{const{__scopeAvatar:n,src:r,onLoadingStatusChange:o=()=>{},...i}=t,a=gk(xk,n),s=wj(r,i),u=wn(c=>{o(c),a.onImageLoadingStatusChange(c)});return Xn(()=>{s!=="idle"&&u(s)},[s,u]),s==="loaded"?w.jsx(Ue.img,{...i,ref:e,src:r}):null});wk.displayName=xk;var bk="AvatarFallback",Ek=C.forwardRef((t,e)=>{const{__scopeAvatar:n,delayMs:r,...o}=t,i=gk(bk,n),[a,s]=C.useState(r===void 0);return C.useEffect(()=>{if(r!==void 0){const u=window.setTimeout(()=>s(!0),r);return()=>window.clearTimeout(u)}},[r]),a&&i.imageLoadingStatus!=="loaded"?w.jsx(Ue.span,{...o,ref:e}):null});Ek.displayName=bk;function mw(t,e){return t?e?(t.src!==e&&(t.src=e),t.complete&&t.naturalWidth>0?"loaded":"loading"):"error":"idle"}function wj(t,{referrerPolicy:e,crossOrigin:n}){const r=vj(),o=C.useRef(null),i=r?(o.current||(o.current=new window.Image),o.current):null,[a,s]=C.useState(()=>mw(i,t));return Xn(()=>{s(mw(i,t))},[i,t]),Xn(()=>{const u=d=>()=>{s(d)};if(!i)return;const c=u("loaded"),l=u("error");return i.addEventListener("load",c),i.addEventListener("error",l),e&&(i.referrerPolicy=e),typeof n=="string"&&(i.crossOrigin=n),()=>{i.removeEventListener("load",c),i.removeEventListener("error",l)}},[i,n,e]),a}var Ck=yk,_k=wk,Sk=Ek;const kk=C.forwardRef(({className:t,...e},n)=>w.jsx(Ck,{ref:n,className:be("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",t),...e}));kk.displayName=Ck.displayName;const bj=C.forwardRef(({className:t,...e},n)=>w.jsx(_k,{ref:n,className:be("aspect-square h-full w-full",t),...e}));bj.displayName=_k.displayName;const Ik=C.forwardRef(({className:t,...e},n)=>w.jsx(Sk,{ref:n,className:be("flex h-full w-full items-center justify-center rounded-full bg-muted",t),...e}));Ik.displayName=Sk.displayName;const Ej=()=>{};var vw={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rk=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let o=t.charCodeAt(r);o<128?e[n++]=o:o<2048?(e[n++]=o>>6|192,e[n++]=o&63|128):(o&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(o=65536+((o&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=o>>18|240,e[n++]=o>>12&63|128,e[n++]=o>>6&63|128,e[n++]=o&63|128):(e[n++]=o>>12|224,e[n++]=o>>6&63|128,e[n++]=o&63|128)}return e},Cj=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const o=t[n++];if(o<128)e[r++]=String.fromCharCode(o);else if(o>191&&o<224){const i=t[n++];e[r++]=String.fromCharCode((o&31)<<6|i&63)}else if(o>239&&o<365){const i=t[n++],a=t[n++],s=t[n++],u=((o&7)<<18|(i&63)<<12|(a&63)<<6|s&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{const i=t[n++],a=t[n++];e[r++]=String.fromCharCode((o&15)<<12|(i&63)<<6|a&63)}}return e.join("")},Tk={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let o=0;o<t.length;o+=3){const i=t[o],a=o+1<t.length,s=a?t[o+1]:0,u=o+2<t.length,c=u?t[o+2]:0,l=i>>2,d=(i&3)<<4|s>>4;let f=(s&15)<<2|c>>6,h=c&63;u||(h=64,a||(f=64)),r.push(n[l],n[d],n[f],n[h])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(Rk(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):Cj(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let o=0;o<t.length;){const i=n[t.charAt(o++)],s=o<t.length?n[t.charAt(o)]:0;++o;const c=o<t.length?n[t.charAt(o)]:64;++o;const d=o<t.length?n[t.charAt(o)]:64;if(++o,i==null||s==null||c==null||d==null)throw new _j;const f=i<<2|s>>4;if(r.push(f),c!==64){const h=s<<4&240|c>>2;if(r.push(h),d!==64){const m=c<<6&192|d;r.push(m)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class _j extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Sj=function(t){const e=Rk(t);return Tk.encodeByteArray(e,!0)},Nk=function(t){return Sj(t).replace(/\./g,"")},Ak=function(t){try{return Tk.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kj(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ij=()=>kj().__FIREBASE_DEFAULTS__,Rj=()=>{if(typeof process>"u"||typeof vw>"u")return;const t=vw.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},Tj=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&Ak(t[1]);return e&&JSON.parse(e)},Oy=()=>{try{return Ej()||Ij()||Rj()||Tj()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},Nj=t=>{var e,n;return(n=(e=Oy())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},Pk=()=>{var t;return(t=Oy())===null||t===void 0?void 0:t.config},Dk=t=>{var e;return(e=Oy())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Aj{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wh(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Pj(t){return(await fetch(t,{credentials:"include"})).ok}const Vu={};function Dj(){const t={prod:[],emulator:[]};for(const e of Object.keys(Vu))Vu[e]?t.emulator.push(e):t.prod.push(e);return t}function Mj(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let gw=!1;function Oj(t,e){if(typeof window>"u"||typeof document>"u"||!wh(window.location.host)||Vu[t]===e||Vu[t]||gw)return;Vu[t]=e;function n(f){return`__firebase__banner__${f}`}const r="__firebase__banner",i=Dj().prod.length>0;function a(){const f=document.getElementById(r);f&&f.remove()}function s(f){f.style.display="flex",f.style.background="#7faaf0",f.style.position="fixed",f.style.bottom="5px",f.style.left="5px",f.style.padding=".5em",f.style.borderRadius="5px",f.style.alignItems="center"}function u(f,h){f.setAttribute("width","24"),f.setAttribute("id",h),f.setAttribute("height","24"),f.setAttribute("viewBox","0 0 24 24"),f.setAttribute("fill","none"),f.style.marginLeft="-6px"}function c(){const f=document.createElement("span");return f.style.cursor="pointer",f.style.marginLeft="16px",f.style.fontSize="24px",f.innerHTML=" &times;",f.onclick=()=>{gw=!0,a()},f}function l(f,h){f.setAttribute("id",h),f.innerText="Learn more",f.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",f.setAttribute("target","__blank"),f.style.paddingLeft="5px",f.style.textDecoration="underline"}function d(){const f=Mj(r),h=n("text"),m=document.getElementById(h)||document.createElement("span"),p=n("learnmore"),g=document.getElementById(p)||document.createElement("a"),v=n("preprendIcon"),y=document.getElementById(v)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(f.created){const x=f.element;s(x),l(g,p);const b=c();u(y,v),x.append(y,m,g,b),document.body.appendChild(x)}i?(m.innerText="Preview backend disconnected.",y.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(y.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,m.innerText="Preview backend running in this workspace."),m.setAttribute("id",h)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",d):d()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function on(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Fj(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(on())}function Lj(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Bj(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function jj(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Uj(){const t=on();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function Wj(){try{return typeof indexedDB=="object"}catch{return!1}}function $j(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",o=self.indexedDB.open(r);o.onsuccess=()=>{o.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},o.onupgradeneeded=()=>{n=!1},o.onerror=()=>{var i;e(((i=o.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zj="FirebaseError";class Io extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=zj,Object.setPrototypeOf(this,Io.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Xc.prototype.create)}}class Xc{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},o=`${this.service}/${e}`,i=this.errors[e],a=i?Vj(i,r):"Error",s=`${this.serviceName}: ${a} (${o}).`;return new Io(o,s,r)}}function Vj(t,e){return t.replace(Hj,(n,r)=>{const o=e[r];return o!=null?String(o):`<${r}?>`})}const Hj=/\{\$([^}]+)}/g;function Gj(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Ks(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const o of n){if(!r.includes(o))return!1;const i=t[o],a=e[o];if(yw(i)&&yw(a)){if(!Ks(i,a))return!1}else if(i!==a)return!1}for(const o of r)if(!n.includes(o))return!1;return!0}function yw(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yc(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(o=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(o))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Pu(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[o,i]=r.split("=");e[decodeURIComponent(o)]=decodeURIComponent(i)}}),e}function Du(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function Kj(t,e){const n=new qj(t,e);return n.subscribe.bind(n)}class qj{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let o;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");Xj(e,["next","error","complete"])?o=e:o={next:e,error:n,complete:r},o.next===void 0&&(o.next=Mp),o.error===void 0&&(o.error=Mp),o.complete===void 0&&(o.complete=Mp);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?o.error(this.finalError):o.complete()}catch{}}),this.observers.push(o),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Xj(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function Mp(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xr(t){return t&&t._delegate?t._delegate:t}class qs{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hi="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yj{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new Aj;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const o=this.getOrInitializeService({instanceIdentifier:n});o&&r.resolve(o)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),o=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(o)return null;throw i}else{if(o)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Jj(e))try{this.getOrInitializeService({instanceIdentifier:Hi})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:o});r.resolve(i)}catch{}}}}clearInstance(e=Hi){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Hi){return this.instances.has(e)}getOptions(e=Hi){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const o=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,a]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(i);r===s&&a.resolve(o)}return o}onInit(e,n){var r;const o=this.normalizeInstanceIdentifier(n),i=(r=this.onInitCallbacks.get(o))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(o,i);const a=this.instances.get(o);return a&&e(a,o),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const o of r)try{o(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:Qj(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Hi){return this.component?this.component.multipleInstances?e:Hi:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Qj(t){return t===Hi?void 0:t}function Jj(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zj{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new Yj(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var He;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(He||(He={}));const e5={debug:He.DEBUG,verbose:He.VERBOSE,info:He.INFO,warn:He.WARN,error:He.ERROR,silent:He.SILENT},t5=He.INFO,n5={[He.DEBUG]:"log",[He.VERBOSE]:"log",[He.INFO]:"info",[He.WARN]:"warn",[He.ERROR]:"error"},r5=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),o=n5[e];if(o)console[o](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Mk{constructor(e){this.name=e,this._logLevel=t5,this._logHandler=r5,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in He))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?e5[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,He.DEBUG,...e),this._logHandler(this,He.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,He.VERBOSE,...e),this._logHandler(this,He.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,He.INFO,...e),this._logHandler(this,He.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,He.WARN,...e),this._logHandler(this,He.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,He.ERROR,...e),this._logHandler(this,He.ERROR,...e)}}const o5=(t,e)=>e.some(n=>t instanceof n);let xw,ww;function i5(){return xw||(xw=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function a5(){return ww||(ww=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Ok=new WeakMap,Rv=new WeakMap,Fk=new WeakMap,Op=new WeakMap,Fy=new WeakMap;function s5(t){const e=new Promise((n,r)=>{const o=()=>{t.removeEventListener("success",i),t.removeEventListener("error",a)},i=()=>{n(xi(t.result)),o()},a=()=>{r(t.error),o()};t.addEventListener("success",i),t.addEventListener("error",a)});return e.then(n=>{n instanceof IDBCursor&&Ok.set(n,t)}).catch(()=>{}),Fy.set(e,t),e}function u5(t){if(Rv.has(t))return;const e=new Promise((n,r)=>{const o=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",a),t.removeEventListener("abort",a)},i=()=>{n(),o()},a=()=>{r(t.error||new DOMException("AbortError","AbortError")),o()};t.addEventListener("complete",i),t.addEventListener("error",a),t.addEventListener("abort",a)});Rv.set(t,e)}let Tv={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Rv.get(t);if(e==="objectStoreNames")return t.objectStoreNames||Fk.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return xi(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function c5(t){Tv=t(Tv)}function l5(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(Fp(this),e,...n);return Fk.set(r,e.sort?e.sort():[e]),xi(r)}:a5().includes(t)?function(...e){return t.apply(Fp(this),e),xi(Ok.get(this))}:function(...e){return xi(t.apply(Fp(this),e))}}function d5(t){return typeof t=="function"?l5(t):(t instanceof IDBTransaction&&u5(t),o5(t,i5())?new Proxy(t,Tv):t)}function xi(t){if(t instanceof IDBRequest)return s5(t);if(Op.has(t))return Op.get(t);const e=d5(t);return e!==t&&(Op.set(t,e),Fy.set(e,t)),e}const Fp=t=>Fy.get(t);function f5(t,e,{blocked:n,upgrade:r,blocking:o,terminated:i}={}){const a=indexedDB.open(t,e),s=xi(a);return r&&a.addEventListener("upgradeneeded",u=>{r(xi(a.result),u.oldVersion,u.newVersion,xi(a.transaction),u)}),n&&a.addEventListener("blocked",u=>n(u.oldVersion,u.newVersion,u)),s.then(u=>{i&&u.addEventListener("close",()=>i()),o&&u.addEventListener("versionchange",c=>o(c.oldVersion,c.newVersion,c))}).catch(()=>{}),s}const h5=["get","getKey","getAll","getAllKeys","count"],p5=["put","add","delete","clear"],Lp=new Map;function bw(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Lp.get(e))return Lp.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,o=p5.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(o||h5.includes(n)))return;const i=async function(a,...s){const u=this.transaction(a,o?"readwrite":"readonly");let c=u.store;return r&&(c=c.index(s.shift())),(await Promise.all([c[n](...s),o&&u.done]))[0]};return Lp.set(e,i),i}c5(t=>({...t,get:(e,n,r)=>bw(e,n)||t.get(e,n,r),has:(e,n)=>!!bw(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m5{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(v5(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function v5(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Nv="@firebase/app",Ew="0.13.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Co=new Mk("@firebase/app"),g5="@firebase/app-compat",y5="@firebase/analytics-compat",x5="@firebase/analytics",w5="@firebase/app-check-compat",b5="@firebase/app-check",E5="@firebase/auth",C5="@firebase/auth-compat",_5="@firebase/database",S5="@firebase/data-connect",k5="@firebase/database-compat",I5="@firebase/functions",R5="@firebase/functions-compat",T5="@firebase/installations",N5="@firebase/installations-compat",A5="@firebase/messaging",P5="@firebase/messaging-compat",D5="@firebase/performance",M5="@firebase/performance-compat",O5="@firebase/remote-config",F5="@firebase/remote-config-compat",L5="@firebase/storage",B5="@firebase/storage-compat",j5="@firebase/firestore",U5="@firebase/ai",W5="@firebase/firestore-compat",$5="firebase",z5="11.10.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Av="[DEFAULT]",V5={[Nv]:"fire-core",[g5]:"fire-core-compat",[x5]:"fire-analytics",[y5]:"fire-analytics-compat",[b5]:"fire-app-check",[w5]:"fire-app-check-compat",[E5]:"fire-auth",[C5]:"fire-auth-compat",[_5]:"fire-rtdb",[S5]:"fire-data-connect",[k5]:"fire-rtdb-compat",[I5]:"fire-fn",[R5]:"fire-fn-compat",[T5]:"fire-iid",[N5]:"fire-iid-compat",[A5]:"fire-fcm",[P5]:"fire-fcm-compat",[D5]:"fire-perf",[M5]:"fire-perf-compat",[O5]:"fire-rc",[F5]:"fire-rc-compat",[L5]:"fire-gcs",[B5]:"fire-gcs-compat",[j5]:"fire-fst",[W5]:"fire-fst-compat",[U5]:"fire-vertex","fire-js":"fire-js",[$5]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uf=new Map,H5=new Map,Pv=new Map;function Cw(t,e){try{t.container.addComponent(e)}catch(n){Co.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Cc(t){const e=t.name;if(Pv.has(e))return Co.debug(`There were multiple attempts to register component ${e}.`),!1;Pv.set(e,t);for(const n of uf.values())Cw(n,t);for(const n of H5.values())Cw(n,t);return!0}function Lk(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function lr(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G5={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},wi=new Xc("app","Firebase",G5);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K5{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new qs("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw wi.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qc=z5;function Bk(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:Av,automaticDataCollectionEnabled:!0},e),o=r.name;if(typeof o!="string"||!o)throw wi.create("bad-app-name",{appName:String(o)});if(n||(n=Pk()),!n)throw wi.create("no-options");const i=uf.get(o);if(i){if(Ks(n,i.options)&&Ks(r,i.config))return i;throw wi.create("duplicate-app",{appName:o})}const a=new Zj(o);for(const u of Pv.values())a.addComponent(u);const s=new K5(n,r,a);return uf.set(o,s),s}function q5(t=Av){const e=uf.get(t);if(!e&&t===Av&&Pk())return Bk();if(!e)throw wi.create("no-app",{appName:t});return e}function vs(t,e,n){var r;let o=(r=V5[t])!==null&&r!==void 0?r:t;n&&(o+=`-${n}`);const i=o.match(/\s|\//),a=e.match(/\s|\//);if(i||a){const s=[`Unable to register library "${o}" with version "${e}":`];i&&s.push(`library name "${o}" contains illegal characters (whitespace or "/")`),i&&a&&s.push("and"),a&&s.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Co.warn(s.join(" "));return}Cc(new qs(`${o}-version`,()=>({library:o,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X5="firebase-heartbeat-database",Y5=1,_c="firebase-heartbeat-store";let Bp=null;function jk(){return Bp||(Bp=f5(X5,Y5,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(_c)}catch(n){console.warn(n)}}}}).catch(t=>{throw wi.create("idb-open",{originalErrorMessage:t.message})})),Bp}async function Q5(t){try{const n=(await jk()).transaction(_c),r=await n.objectStore(_c).get(Uk(t));return await n.done,r}catch(e){if(e instanceof Io)Co.warn(e.message);else{const n=wi.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Co.warn(n.message)}}}async function _w(t,e){try{const r=(await jk()).transaction(_c,"readwrite");await r.objectStore(_c).put(e,Uk(t)),await r.done}catch(n){if(n instanceof Io)Co.warn(n.message);else{const r=wi.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Co.warn(r.message)}}}function Uk(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J5=1024,Z5=30;class e6{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new n6(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const o=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Sw();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(a=>a.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:o}),this._heartbeatsCache.heartbeats.length>Z5){const a=r6(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(a,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){Co.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=Sw(),{heartbeatsToSend:r,unsentEntries:o}=t6(this._heartbeatsCache.heartbeats),i=Nk(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,o.length>0?(this._heartbeatsCache.heartbeats=o,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return Co.warn(n),""}}}function Sw(){return new Date().toISOString().substring(0,10)}function t6(t,e=J5){const n=[];let r=t.slice();for(const o of t){const i=n.find(a=>a.agent===o.agent);if(i){if(i.dates.push(o.date),kw(n)>e){i.dates.pop();break}}else if(n.push({agent:o.agent,dates:[o.date]}),kw(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class n6{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Wj()?$j().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await Q5(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const o=await this.read();return _w(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:o.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const o=await this.read();return _w(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:o.lastSentHeartbeatDate,heartbeats:[...o.heartbeats,...e.heartbeats]})}else return}}function kw(t){return Nk(JSON.stringify({version:2,heartbeats:t})).length}function r6(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function o6(t){Cc(new qs("platform-logger",e=>new m5(e),"PRIVATE")),Cc(new qs("heartbeat",e=>new e6(e),"PRIVATE")),vs(Nv,Ew,t),vs(Nv,Ew,"esm2017"),vs("fire-js","")}o6("");function Wk(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const i6=Wk,$k=new Xc("auth","Firebase",Wk());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cf=new Mk("@firebase/auth");function a6(t,...e){cf.logLevel<=He.WARN&&cf.warn(`Auth (${Qc}): ${t}`,...e)}function wd(t,...e){cf.logLevel<=He.ERROR&&cf.error(`Auth (${Qc}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xr(t,...e){throw Ly(t,...e)}function Wr(t,...e){return Ly(t,...e)}function zk(t,e,n){const r=Object.assign(Object.assign({},i6()),{[e]:n});return new Xc("auth","Firebase",r).create(e,{appName:t.name})}function vo(t){return zk(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Ly(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return $k.create(t,...e)}function xe(t,e,...n){if(!t)throw Ly(e,...n)}function ho(t){const e="INTERNAL ASSERTION FAILED: "+t;throw wd(e),new Error(e)}function _o(t,e){t||ho(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dv(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function s6(){return Iw()==="http:"||Iw()==="https:"}function Iw(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function u6(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(s6()||Bj()||"connection"in navigator)?navigator.onLine:!0}function c6(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jc{constructor(e,n){this.shortDelay=e,this.longDelay=n,_o(n>e,"Short delay should be less than long delay!"),this.isMobile=Fj()||jj()}get(){return u6()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function By(t,e){_o(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vk{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;ho("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;ho("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;ho("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l6={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d6=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],f6=new Jc(3e4,6e4);function Oi(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function Ro(t,e,n,r,o={}){return Hk(t,o,async()=>{let i={},a={};r&&(e==="GET"?a=r:i={body:JSON.stringify(r)});const s=Yc(Object.assign({key:t.config.apiKey},a)).slice(1),u=await t._getAdditionalHeaders();u["Content-Type"]="application/json",t.languageCode&&(u["X-Firebase-Locale"]=t.languageCode);const c=Object.assign({method:e,headers:u},i);return Lj()||(c.referrerPolicy="no-referrer"),t.emulatorConfig&&wh(t.emulatorConfig.host)&&(c.credentials="include"),Vk.fetch()(await Gk(t,t.config.apiHost,n,s),c)})}async function Hk(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},l6),e);try{const o=new p6(t),i=await Promise.race([n(),o.promise]);o.clearNetworkTimeout();const a=await i.json();if("needConfirmation"in a)throw Ul(t,"account-exists-with-different-credential",a);if(i.ok&&!("errorMessage"in a))return a;{const s=i.ok?a.errorMessage:a.error.message,[u,c]=s.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw Ul(t,"credential-already-in-use",a);if(u==="EMAIL_EXISTS")throw Ul(t,"email-already-in-use",a);if(u==="USER_DISABLED")throw Ul(t,"user-disabled",a);const l=r[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw zk(t,l,c);xr(t,l)}}catch(o){if(o instanceof Io)throw o;xr(t,"network-request-failed",{message:String(o)})}}async function Zc(t,e,n,r,o={}){const i=await Ro(t,e,n,r,o);return"mfaPendingCredential"in i&&xr(t,"multi-factor-auth-required",{_serverResponse:i}),i}async function Gk(t,e,n,r){const o=`${e}${n}?${r}`,i=t,a=i.config.emulator?By(t.config,o):`${t.config.apiScheme}://${o}`;return d6.includes(n)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(a).toString():a}function h6(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class p6{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(Wr(this.auth,"network-request-failed")),f6.get())})}}function Ul(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const o=Wr(t,e,r);return o.customData._tokenResponse=n,o}function Rw(t){return t!==void 0&&t.enterprise!==void 0}class m6{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return h6(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function v6(t,e){return Ro(t,"GET","/v2/recaptchaConfig",Oi(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function g6(t,e){return Ro(t,"POST","/v1/accounts:delete",e)}async function lf(t,e){return Ro(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hu(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function y6(t,e=!1){const n=Xr(t),r=await n.getIdToken(e),o=jy(r);xe(o&&o.exp&&o.auth_time&&o.iat,n.auth,"internal-error");const i=typeof o.firebase=="object"?o.firebase:void 0,a=i==null?void 0:i.sign_in_provider;return{claims:o,token:r,authTime:Hu(jp(o.auth_time)),issuedAtTime:Hu(jp(o.iat)),expirationTime:Hu(jp(o.exp)),signInProvider:a||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function jp(t){return Number(t)*1e3}function jy(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return wd("JWT malformed, contained fewer than 3 sections"),null;try{const o=Ak(n);return o?JSON.parse(o):(wd("Failed to decode base64 JWT payload"),null)}catch(o){return wd("Caught error parsing JWT payload as JSON",o==null?void 0:o.toString()),null}}function Tw(t){const e=jy(t);return xe(e,"internal-error"),xe(typeof e.exp<"u","internal-error"),xe(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Xs(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof Io&&x6(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function x6({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w6{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const o=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,o)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mv{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Hu(this.lastLoginAt),this.creationTime=Hu(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function df(t){var e;const n=t.auth,r=await t.getIdToken(),o=await Xs(t,lf(n,{idToken:r}));xe(o==null?void 0:o.users.length,n,"internal-error");const i=o.users[0];t._notifyReloadListener(i);const a=!((e=i.providerUserInfo)===null||e===void 0)&&e.length?Kk(i.providerUserInfo):[],s=E6(t.providerData,a),u=t.isAnonymous,c=!(t.email&&i.passwordHash)&&!(s!=null&&s.length),l=u?c:!1,d={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new Mv(i.createdAt,i.lastLoginAt),isAnonymous:l};Object.assign(t,d)}async function b6(t){const e=Xr(t);await df(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function E6(t,e){return[...t.filter(r=>!e.some(o=>o.providerId===r.providerId)),...e]}function Kk(t){return t.map(e=>{var{providerId:n}=e,r=Gc(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function C6(t,e){const n=await Hk(t,{},async()=>{const r=Yc({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:o,apiKey:i}=t.config,a=await Gk(t,o,"/v1/token",`key=${i}`),s=await t._getAdditionalHeaders();s["Content-Type"]="application/x-www-form-urlencoded";const u={method:"POST",headers:s,body:r};return t.emulatorConfig&&wh(t.emulatorConfig.host)&&(u.credentials="include"),Vk.fetch()(a,u)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function _6(t,e){return Ro(t,"POST","/v2/accounts:revokeToken",Oi(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gs{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){xe(e.idToken,"internal-error"),xe(typeof e.idToken<"u","internal-error"),xe(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Tw(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){xe(e.length!==0,"internal-error");const n=Tw(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(xe(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:o,expiresIn:i}=await C6(e,n);this.updateTokensAndExpiration(r,o,Number(i))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:o,expirationTime:i}=n,a=new gs;return r&&(xe(typeof r=="string","internal-error",{appName:e}),a.refreshToken=r),o&&(xe(typeof o=="string","internal-error",{appName:e}),a.accessToken=o),i&&(xe(typeof i=="number","internal-error",{appName:e}),a.expirationTime=i),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new gs,this.toJSON())}_performRefresh(){return ho("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wo(t,e){xe(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class dr{constructor(e){var{uid:n,auth:r,stsTokenManager:o}=e,i=Gc(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new w6(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=o,this.accessToken=o.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new Mv(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const n=await Xs(this,this.stsTokenManager.getToken(this.auth,e));return xe(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return y6(this,e)}reload(){return b6(this)}_assign(e){this!==e&&(xe(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new dr(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){xe(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await df(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(lr(this.auth.app))return Promise.reject(vo(this.auth));const e=await this.getIdToken();return await Xs(this,g6(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,o,i,a,s,u,c,l;const d=(r=n.displayName)!==null&&r!==void 0?r:void 0,f=(o=n.email)!==null&&o!==void 0?o:void 0,h=(i=n.phoneNumber)!==null&&i!==void 0?i:void 0,m=(a=n.photoURL)!==null&&a!==void 0?a:void 0,p=(s=n.tenantId)!==null&&s!==void 0?s:void 0,g=(u=n._redirectEventId)!==null&&u!==void 0?u:void 0,v=(c=n.createdAt)!==null&&c!==void 0?c:void 0,y=(l=n.lastLoginAt)!==null&&l!==void 0?l:void 0,{uid:x,emailVerified:b,isAnonymous:E,providerData:_,stsTokenManager:S}=n;xe(x&&S,e,"internal-error");const k=gs.fromJSON(this.name,S);xe(typeof x=="string",e,"internal-error"),Wo(d,e.name),Wo(f,e.name),xe(typeof b=="boolean",e,"internal-error"),xe(typeof E=="boolean",e,"internal-error"),Wo(h,e.name),Wo(m,e.name),Wo(p,e.name),Wo(g,e.name),Wo(v,e.name),Wo(y,e.name);const R=new dr({uid:x,auth:e,email:f,emailVerified:b,displayName:d,isAnonymous:E,photoURL:m,phoneNumber:h,tenantId:p,stsTokenManager:k,createdAt:v,lastLoginAt:y});return _&&Array.isArray(_)&&(R.providerData=_.map(I=>Object.assign({},I))),g&&(R._redirectEventId=g),R}static async _fromIdTokenResponse(e,n,r=!1){const o=new gs;o.updateFromServerResponse(n);const i=new dr({uid:n.localId,auth:e,stsTokenManager:o,isAnonymous:r});return await df(i),i}static async _fromGetAccountInfoResponse(e,n,r){const o=n.users[0];xe(o.localId!==void 0,"internal-error");const i=o.providerUserInfo!==void 0?Kk(o.providerUserInfo):[],a=!(o.email&&o.passwordHash)&&!(i!=null&&i.length),s=new gs;s.updateFromIdToken(r);const u=new dr({uid:o.localId,auth:e,stsTokenManager:s,isAnonymous:a}),c={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:i,metadata:new Mv(o.createdAt,o.lastLoginAt),isAnonymous:!(o.email&&o.passwordHash)&&!(i!=null&&i.length)};return Object.assign(u,c),u}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nw=new Map;function po(t){_o(t instanceof Function,"Expected a class definition");let e=Nw.get(t);return e?(_o(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,Nw.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qk{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}qk.type="NONE";const Aw=qk;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bd(t,e,n){return`firebase:${t}:${e}:${n}`}class ys{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:o,name:i}=this.auth;this.fullUserKey=bd(this.userKey,o.apiKey,i),this.fullPersistenceKey=bd("persistence",o.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await lf(this.auth,{idToken:e}).catch(()=>{});return n?dr._fromGetAccountInfoResponse(this.auth,n,e):null}return dr._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new ys(po(Aw),e,r);const o=(await Promise.all(n.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let i=o[0]||po(Aw);const a=bd(r,e.config.apiKey,e.name);let s=null;for(const c of n)try{const l=await c._get(a);if(l){let d;if(typeof l=="string"){const f=await lf(e,{idToken:l}).catch(()=>{});if(!f)break;d=await dr._fromGetAccountInfoResponse(e,f,l)}else d=dr._fromJSON(e,l);c!==i&&(s=d),i=c;break}}catch{}const u=o.filter(c=>c._shouldAllowMigration);return!i._shouldAllowMigration||!u.length?new ys(i,e,r):(i=u[0],s&&await i._set(a,s.toJSON()),await Promise.all(n.map(async c=>{if(c!==i)try{await c._remove(a)}catch{}})),new ys(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pw(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Jk(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Xk(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(eI(e))return"Blackberry";if(tI(e))return"Webos";if(Yk(e))return"Safari";if((e.includes("chrome/")||Qk(e))&&!e.includes("edge/"))return"Chrome";if(Zk(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function Xk(t=on()){return/firefox\//i.test(t)}function Yk(t=on()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Qk(t=on()){return/crios\//i.test(t)}function Jk(t=on()){return/iemobile/i.test(t)}function Zk(t=on()){return/android/i.test(t)}function eI(t=on()){return/blackberry/i.test(t)}function tI(t=on()){return/webos/i.test(t)}function Uy(t=on()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function S6(t=on()){var e;return Uy(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function k6(){return Uj()&&document.documentMode===10}function nI(t=on()){return Uy(t)||Zk(t)||tI(t)||eI(t)||/windows phone/i.test(t)||Jk(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rI(t,e=[]){let n;switch(t){case"Browser":n=Pw(on());break;case"Worker":n=`${Pw(on())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Qc}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I6{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=i=>new Promise((a,s)=>{try{const u=e(i);a(u)}catch(u){s(u)}});r.onAbort=n,this.queue.push(r);const o=this.queue.length-1;return()=>{this.queue[o]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const o of n)try{o()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function R6(t,e={}){return Ro(t,"GET","/v2/passwordPolicy",Oi(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T6=6;class N6{constructor(e){var n,r,o,i;const a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=a.minPasswordLength)!==null&&n!==void 0?n:T6,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(o=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&o!==void 0?o:"",this.forceUpgradeOnSignin=(i=e.forceUpgradeOnSignin)!==null&&i!==void 0?i:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,o,i,a,s;const u={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,u),this.validatePasswordCharacterOptions(e,u),u.isValid&&(u.isValid=(n=u.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),u.isValid&&(u.isValid=(r=u.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),u.isValid&&(u.isValid=(o=u.containsLowercaseLetter)!==null&&o!==void 0?o:!0),u.isValid&&(u.isValid=(i=u.containsUppercaseLetter)!==null&&i!==void 0?i:!0),u.isValid&&(u.isValid=(a=u.containsNumericCharacter)!==null&&a!==void 0?a:!0),u.isValid&&(u.isValid=(s=u.containsNonAlphanumericCharacter)!==null&&s!==void 0?s:!0),u}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,o=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),o&&(n.meetsMaxPasswordLength=e.length<=o)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let o=0;o<e.length;o++)r=e.charAt(o),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,o,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=o)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A6{constructor(e,n,r,o){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=o,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Dw(this),this.idTokenSubscription=new Dw(this),this.beforeStateQueue=new I6(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=$k,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=o.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=po(n)),this._initializationPromise=this.queue(async()=>{var r,o,i;if(!this._deleted&&(this.persistenceManager=await ys.create(this,e),(r=this._resolvePersistenceManagerAvailable)===null||r===void 0||r.call(this),!this._deleted)){if(!((o=this._popupRedirectResolver)===null||o===void 0)&&o._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await lf(this,{idToken:e}),r=await dr._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var n;if(lr(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(s=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(s,s))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let o=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,s=o==null?void 0:o._redirectEventId,u=await this.tryRedirectSignIn(e);(!a||a===s)&&(u!=null&&u.user)&&(o=u.user,i=!0)}if(!o)return this.directlySetCurrentUser(null);if(!o._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(o)}catch(a){o=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return o?this.reloadAndSetCurrentUserOrClear(o):this.directlySetCurrentUser(null)}return xe(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===o._redirectEventId?this.directlySetCurrentUser(o):this.reloadAndSetCurrentUserOrClear(o)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await df(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=c6()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(lr(this.app))return Promise.reject(vo(this));const n=e?Xr(e):null;return n&&xe(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&xe(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return lr(this.app)?Promise.reject(vo(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return lr(this.app)?Promise.reject(vo(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(po(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await R6(this),n=new N6(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Xc("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await _6(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&po(e)||this._popupRedirectResolver;xe(n,this,"argument-error"),this.redirectPersistenceManager=await ys.create(this,[po(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,o){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n);let a=!1;const s=this._isInitialized?Promise.resolve():this._initializationPromise;if(xe(s,this,"internal-error"),s.then(()=>{a||i(this.currentUser)}),typeof n=="function"){const u=e.addObserver(n,r,o);return()=>{a=!0,u()}}else{const u=e.addObserver(n);return()=>{a=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return xe(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=rI(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const o=await this._getAppCheckToken();return o&&(n["X-Firebase-AppCheck"]=o),n}async _getAppCheckToken(){var e;if(lr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&a6(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function Ia(t){return Xr(t)}class Dw{constructor(e){this.auth=e,this.observer=null,this.addObserver=Kj(n=>this.observer=n)}get next(){return xe(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let bh={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function P6(t){bh=t}function oI(t){return bh.loadJS(t)}function D6(){return bh.recaptchaEnterpriseScript}function M6(){return bh.gapiScript}function O6(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class F6{constructor(){this.enterprise=new L6}ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class L6{ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}const B6="recaptcha-enterprise",iI="NO_RECAPTCHA";class j6{constructor(e){this.type=B6,this.auth=Ia(e)}async verify(e="verify",n=!1){async function r(i){if(!n){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(a,s)=>{v6(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(u=>{if(u.recaptchaKey===void 0)s(new Error("recaptcha Enterprise site key undefined"));else{const c=new m6(u);return i.tenantId==null?i._agentRecaptchaConfig=c:i._tenantRecaptchaConfigs[i.tenantId]=c,a(c.siteKey)}}).catch(u=>{s(u)})})}function o(i,a,s){const u=window.grecaptcha;Rw(u)?u.enterprise.ready(()=>{u.enterprise.execute(i,{action:e}).then(c=>{a(c)}).catch(()=>{a(iI)})}):s(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new F6().execute("siteKey",{action:"verify"}):new Promise((i,a)=>{r(this.auth).then(s=>{if(!n&&Rw(window.grecaptcha))o(s,i,a);else{if(typeof window>"u"){a(new Error("RecaptchaVerifier is only supported in browser"));return}let u=D6();u.length!==0&&(u+=s),oI(u).then(()=>{o(s,i,a)}).catch(c=>{a(c)})}}).catch(s=>{a(s)})})}}async function Mw(t,e,n,r=!1,o=!1){const i=new j6(t);let a;if(o)a=iI;else try{a=await i.verify(n)}catch{a=await i.verify(n,!0)}const s=Object.assign({},e);if(n==="mfaSmsEnrollment"||n==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in s){const u=s.phoneEnrollmentInfo.phoneNumber,c=s.phoneEnrollmentInfo.recaptchaToken;Object.assign(s,{phoneEnrollmentInfo:{phoneNumber:u,recaptchaToken:c,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in s){const u=s.phoneSignInInfo.recaptchaToken;Object.assign(s,{phoneSignInInfo:{recaptchaToken:u,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return s}return r?Object.assign(s,{captchaResp:a}):Object.assign(s,{captchaResponse:a}),Object.assign(s,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(s,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),s}async function Ov(t,e,n,r,o){var i;if(!((i=t._getRecaptchaConfig())===null||i===void 0)&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const a=await Mw(t,e,n,n==="getOobCode");return r(t,a)}else return r(t,e).catch(async a=>{if(a.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const s=await Mw(t,e,n,n==="getOobCode");return r(t,s)}else return Promise.reject(a)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function U6(t,e){const n=Lk(t,"auth");if(n.isInitialized()){const o=n.getImmediate(),i=n.getOptions();if(Ks(i,e??{}))return o;xr(o,"already-initialized")}return n.initialize({options:e})}function W6(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(po);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function $6(t,e,n){const r=Ia(t);xe(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const o=!1,i=aI(e),{host:a,port:s}=z6(e),u=s===null?"":`:${s}`,c={url:`${i}//${a}${u}/`},l=Object.freeze({host:a,port:s,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:o})});if(!r._canInitEmulator){xe(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),xe(Ks(c,r.config.emulator)&&Ks(l,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=c,r.emulatorConfig=l,r.settings.appVerificationDisabledForTesting=!0,wh(a)?(Pj(`${i}//${a}${u}`),Oj("Auth",!0)):V6()}function aI(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function z6(t){const e=aI(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",o=/^(\[[^\]]+\])(:|$)/.exec(r);if(o){const i=o[1];return{host:i,port:Ow(r.substr(i.length+1))}}else{const[i,a]=r.split(":");return{host:i,port:Ow(a)}}}function Ow(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function V6(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wy{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return ho("not implemented")}_getIdTokenResponse(e){return ho("not implemented")}_linkToIdToken(e,n){return ho("not implemented")}_getReauthenticationResolver(e){return ho("not implemented")}}async function H6(t,e){return Ro(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function G6(t,e){return Zc(t,"POST","/v1/accounts:signInWithPassword",Oi(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function K6(t,e){return Zc(t,"POST","/v1/accounts:signInWithEmailLink",Oi(t,e))}async function q6(t,e){return Zc(t,"POST","/v1/accounts:signInWithEmailLink",Oi(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sc extends Wy{constructor(e,n,r,o=null){super("password",r),this._email=e,this._password=n,this._tenantId=o}static _fromEmailAndPassword(e,n){return new Sc(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new Sc(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Ov(e,n,"signInWithPassword",G6);case"emailLink":return K6(e,{email:this._email,oobCode:this._password});default:xr(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Ov(e,r,"signUpPassword",H6);case"emailLink":return q6(e,{idToken:n,email:this._email,oobCode:this._password});default:xr(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xs(t,e){return Zc(t,"POST","/v1/accounts:signInWithIdp",Oi(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X6="http://localhost";class ga extends Wy{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new ga(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):xr("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:o}=n,i=Gc(n,["providerId","signInMethod"]);if(!r||!o)return null;const a=new ga(r,o);return a.idToken=i.idToken||void 0,a.accessToken=i.accessToken||void 0,a.secret=i.secret,a.nonce=i.nonce,a.pendingToken=i.pendingToken||null,a}_getIdTokenResponse(e){const n=this.buildRequest();return xs(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,xs(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,xs(e,n)}buildRequest(){const e={requestUri:X6,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Yc(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Y6(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function Q6(t){const e=Pu(Du(t)).link,n=e?Pu(Du(e)).deep_link_id:null,r=Pu(Du(t)).deep_link_id;return(r?Pu(Du(r)).link:null)||r||n||e||t}class $y{constructor(e){var n,r,o,i,a,s;const u=Pu(Du(e)),c=(n=u.apiKey)!==null&&n!==void 0?n:null,l=(r=u.oobCode)!==null&&r!==void 0?r:null,d=Y6((o=u.mode)!==null&&o!==void 0?o:null);xe(c&&l&&d,"argument-error"),this.apiKey=c,this.operation=d,this.code=l,this.continueUrl=(i=u.continueUrl)!==null&&i!==void 0?i:null,this.languageCode=(a=u.lang)!==null&&a!==void 0?a:null,this.tenantId=(s=u.tenantId)!==null&&s!==void 0?s:null}static parseLink(e){const n=Q6(e);try{return new $y(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cu{constructor(){this.providerId=cu.PROVIDER_ID}static credential(e,n){return Sc._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=$y.parseLink(n);return xe(r,"argument-error"),Sc._fromEmailAndCode(e,r.code,r.tenantId)}}cu.PROVIDER_ID="password";cu.EMAIL_PASSWORD_SIGN_IN_METHOD="password";cu.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sI{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class el extends sI{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yo extends el{constructor(){super("facebook.com")}static credential(e){return ga._fromParams({providerId:Yo.PROVIDER_ID,signInMethod:Yo.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Yo.credentialFromTaggedObject(e)}static credentialFromError(e){return Yo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Yo.credential(e.oauthAccessToken)}catch{return null}}}Yo.FACEBOOK_SIGN_IN_METHOD="facebook.com";Yo.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qo extends el{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return ga._fromParams({providerId:Qo.PROVIDER_ID,signInMethod:Qo.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Qo.credentialFromTaggedObject(e)}static credentialFromError(e){return Qo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return Qo.credential(n,r)}catch{return null}}}Qo.GOOGLE_SIGN_IN_METHOD="google.com";Qo.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jo extends el{constructor(){super("github.com")}static credential(e){return ga._fromParams({providerId:Jo.PROVIDER_ID,signInMethod:Jo.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Jo.credentialFromTaggedObject(e)}static credentialFromError(e){return Jo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Jo.credential(e.oauthAccessToken)}catch{return null}}}Jo.GITHUB_SIGN_IN_METHOD="github.com";Jo.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zo extends el{constructor(){super("twitter.com")}static credential(e,n){return ga._fromParams({providerId:Zo.PROVIDER_ID,signInMethod:Zo.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Zo.credentialFromTaggedObject(e)}static credentialFromError(e){return Zo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return Zo.credential(n,r)}catch{return null}}}Zo.TWITTER_SIGN_IN_METHOD="twitter.com";Zo.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function J6(t,e){return Zc(t,"POST","/v1/accounts:signUp",Oi(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ya{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,o=!1){const i=await dr._fromIdTokenResponse(e,r,o),a=Fw(r);return new ya({user:i,providerId:a,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const o=Fw(r);return new ya({user:e,providerId:o,_tokenResponse:r,operationType:n})}}function Fw(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ff extends Io{constructor(e,n,r,o){var i;super(n.code,n.message),this.operationType=r,this.user=o,Object.setPrototypeOf(this,ff.prototype),this.customData={appName:e.name,tenantId:(i=e.tenantId)!==null&&i!==void 0?i:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,o){return new ff(e,n,r,o)}}function uI(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?ff._fromErrorAndOperation(t,i,e,r):i})}async function Z6(t,e,n=!1){const r=await Xs(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return ya._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function e8(t,e,n=!1){const{auth:r}=t;if(lr(r.app))return Promise.reject(vo(r));const o="reauthenticate";try{const i=await Xs(t,uI(r,o,e,t),n);xe(i.idToken,r,"internal-error");const a=jy(i.idToken);xe(a,r,"internal-error");const{sub:s}=a;return xe(t.uid===s,r,"user-mismatch"),ya._forOperation(t,o,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&xr(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cI(t,e,n=!1){if(lr(t.app))return Promise.reject(vo(t));const r="signIn",o=await uI(t,r,e),i=await ya._fromIdTokenResponse(t,r,o);return n||await t._updateCurrentUser(i.user),i}async function t8(t,e){return cI(Ia(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function lI(t){const e=Ia(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function n8(t,e,n){if(lr(t.app))return Promise.reject(vo(t));const r=Ia(t),a=await Ov(r,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",J6).catch(u=>{throw u.code==="auth/password-does-not-meet-requirements"&&lI(t),u}),s=await ya._fromIdTokenResponse(r,"signIn",a);return await r._updateCurrentUser(s.user),s}function r8(t,e,n){return lr(t.app)?Promise.reject(vo(t)):t8(Xr(t),cu.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&lI(t),r})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function o8(t,e){return Ro(t,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function i8(t,{displayName:e,photoURL:n}){if(e===void 0&&n===void 0)return;const r=Xr(t),i={idToken:await r.getIdToken(),displayName:e,photoUrl:n,returnSecureToken:!0},a=await Xs(r,o8(r.auth,i));r.displayName=a.displayName||null,r.photoURL=a.photoUrl||null;const s=r.providerData.find(({providerId:u})=>u==="password");s&&(s.displayName=r.displayName,s.photoURL=r.photoURL),await r._updateTokensIfNecessary(a)}function a8(t,e,n,r){return Xr(t).onIdTokenChanged(e,n,r)}function s8(t,e,n){return Xr(t).beforeAuthStateChanged(e,n)}function u8(t,e,n,r){return Xr(t).onAuthStateChanged(e,n,r)}function c8(t){return Xr(t).signOut()}const hf="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dI{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(hf,"1"),this.storage.removeItem(hf),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l8=1e3,d8=10;class fI extends dI{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=nI(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),o=this.localCache[n];r!==o&&e(n,o,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((a,s,u)=>{this.notifyListeners(a,u)});return}const r=e.key;n?this.detachListener():this.stopPolling();const o=()=>{const a=this.storage.getItem(r);!n&&this.localCache[r]===a||this.notifyListeners(r,a)},i=this.storage.getItem(r);k6()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(o,d8):o()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const o of Array.from(r))o(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},l8)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}fI.type="LOCAL";const f8=fI;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hI extends dI{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}hI.type="SESSION";const pI=hI;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function h8(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eh{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(o=>o.isListeningto(e));if(n)return n;const r=new Eh(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:o,data:i}=n.data,a=this.handlersMap[o];if(!(a!=null&&a.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:o});const s=Array.from(a).map(async c=>c(n.origin,i)),u=await h8(s);n.ports[0].postMessage({status:"done",eventId:r,eventType:o,response:u})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Eh.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zy(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p8{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const o=typeof MessageChannel<"u"?new MessageChannel:null;if(!o)throw new Error("connection_unavailable");let i,a;return new Promise((s,u)=>{const c=zy("",20);o.port1.start();const l=setTimeout(()=>{u(new Error("unsupported_event"))},r);a={messageChannel:o,onMessage(d){const f=d;if(f.data.eventId===c)switch(f.data.status){case"ack":clearTimeout(l),i=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),s(f.data.response);break;default:clearTimeout(l),clearTimeout(i),u(new Error("invalid_response"));break}}},this.handlers.add(a),o.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:c,data:n},[o.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $r(){return window}function m8(t){$r().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mI(){return typeof $r().WorkerGlobalScope<"u"&&typeof $r().importScripts=="function"}async function v8(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function g8(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function y8(){return mI()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vI="firebaseLocalStorageDb",x8=1,pf="firebaseLocalStorage",gI="fbase_key";class tl{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function Ch(t,e){return t.transaction([pf],e?"readwrite":"readonly").objectStore(pf)}function w8(){const t=indexedDB.deleteDatabase(vI);return new tl(t).toPromise()}function Fv(){const t=indexedDB.open(vI,x8);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(pf,{keyPath:gI})}catch(o){n(o)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(pf)?e(r):(r.close(),await w8(),e(await Fv()))})})}async function Lw(t,e,n){const r=Ch(t,!0).put({[gI]:e,value:n});return new tl(r).toPromise()}async function b8(t,e){const n=Ch(t,!1).get(e),r=await new tl(n).toPromise();return r===void 0?null:r.value}function Bw(t,e){const n=Ch(t,!0).delete(e);return new tl(n).toPromise()}const E8=800,C8=3;class yI{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Fv(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>C8)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return mI()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Eh._getInstance(y8()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await v8(),!this.activeServiceWorker)return;this.sender=new p8(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((n=r[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||g8()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Fv();return await Lw(e,hf,"1"),await Bw(e,hf),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>Lw(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>b8(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>Bw(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(o=>{const i=Ch(o,!1).getAll();return new tl(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:o,value:i}of e)r.add(o),JSON.stringify(this.localCache[o])!==JSON.stringify(i)&&(this.notifyListeners(o,i),n.push(o));for(const o of Object.keys(this.localCache))this.localCache[o]&&!r.has(o)&&(this.notifyListeners(o,null),n.push(o));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const o of Array.from(r))o(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),E8)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}yI.type="LOCAL";const _8=yI;new Jc(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function S8(t,e){return e?po(e):(xe(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vy extends Wy{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return xs(e,this._buildIdpRequest())}_linkToIdToken(e,n){return xs(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return xs(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function k8(t){return cI(t.auth,new Vy(t),t.bypassAuthState)}function I8(t){const{auth:e,user:n}=t;return xe(n,e,"internal-error"),e8(n,new Vy(t),t.bypassAuthState)}async function R8(t){const{auth:e,user:n}=t;return xe(n,e,"internal-error"),Z6(n,new Vy(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xI{constructor(e,n,r,o,i=!1){this.auth=e,this.resolver=r,this.user=o,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:o,tenantId:i,error:a,type:s}=e;if(a){this.reject(a);return}const u={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:o||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(s)(u))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return k8;case"linkViaPopup":case"linkViaRedirect":return R8;case"reauthViaPopup":case"reauthViaRedirect":return I8;default:xr(this.auth,"internal-error")}}resolve(e){_o(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){_o(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T8=new Jc(2e3,1e4);class as extends xI{constructor(e,n,r,o,i){super(e,n,o,i),this.provider=r,this.authWindow=null,this.pollId=null,as.currentPopupAction&&as.currentPopupAction.cancel(),as.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return xe(e,this.auth,"internal-error"),e}async onExecution(){_o(this.filter.length===1,"Popup operations only handle one event");const e=zy();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Wr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Wr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,as.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Wr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,T8.get())};e()}}as.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N8="pendingRedirect",Ed=new Map;class A8 extends xI{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=Ed.get(this.auth._key());if(!e){try{const r=await P8(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}Ed.set(this.auth._key(),e)}return this.bypassAuthState||Ed.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function P8(t,e){const n=O8(e),r=M8(t);if(!await r._isAvailable())return!1;const o=await r._get(n)==="true";return await r._remove(n),o}function D8(t,e){Ed.set(t._key(),e)}function M8(t){return po(t._redirectPersistence)}function O8(t){return bd(N8,t.config.apiKey,t.name)}async function F8(t,e,n=!1){if(lr(t.app))return Promise.reject(vo(t));const r=Ia(t),o=S8(r,e),a=await new A8(r,o,n).execute();return a&&!n&&(delete a.user._redirectEventId,await r._persistUserIfCurrent(a.user),await r._setRedirectUser(null,e)),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L8=10*60*1e3;class B8{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!j8(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!wI(e)){const o=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(Wr(this.auth,o))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=L8&&this.cachedEventUids.clear(),this.cachedEventUids.has(jw(e))}saveEventToCache(e){this.cachedEventUids.add(jw(e)),this.lastProcessedEventTime=Date.now()}}function jw(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function wI({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function j8(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return wI(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function U8(t,e={}){return Ro(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W8=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,$8=/^https?/;async function z8(t){if(t.config.emulator)return;const{authorizedDomains:e}=await U8(t);for(const n of e)try{if(V8(n))return}catch{}xr(t,"unauthorized-domain")}function V8(t){const e=Dv(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const a=new URL(t);return a.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&a.hostname===r}if(!$8.test(n))return!1;if(W8.test(t))return r===t;const o=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+o+"|"+o+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H8=new Jc(3e4,6e4);function Uw(){const t=$r().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function G8(t){return new Promise((e,n)=>{var r,o,i;function a(){Uw(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Uw(),n(Wr(t,"network-request-failed"))},timeout:H8.get()})}if(!((o=(r=$r().gapi)===null||r===void 0?void 0:r.iframes)===null||o===void 0)&&o.Iframe)e(gapi.iframes.getContext());else if(!((i=$r().gapi)===null||i===void 0)&&i.load)a();else{const s=O6("iframefcb");return $r()[s]=()=>{gapi.load?a():n(Wr(t,"network-request-failed"))},oI(`${M6()}?onload=${s}`).catch(u=>n(u))}}).catch(e=>{throw Cd=null,e})}let Cd=null;function K8(t){return Cd=Cd||G8(t),Cd}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q8=new Jc(5e3,15e3),X8="__/auth/iframe",Y8="emulator/auth/iframe",Q8={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},J8=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Z8(t){const e=t.config;xe(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?By(e,Y8):`https://${t.config.authDomain}/${X8}`,r={apiKey:e.apiKey,appName:t.name,v:Qc},o=J8.get(t.config.apiHost);o&&(r.eid=o);const i=t._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${Yc(r).slice(1)}`}async function eU(t){const e=await K8(t),n=$r().gapi;return xe(n,t,"internal-error"),e.open({where:document.body,url:Z8(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Q8,dontclear:!0},r=>new Promise(async(o,i)=>{await r.restyle({setHideOnLeave:!1});const a=Wr(t,"network-request-failed"),s=$r().setTimeout(()=>{i(a)},q8.get());function u(){$r().clearTimeout(s),o(r)}r.ping(u).then(u,()=>{i(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tU={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},nU=500,rU=600,oU="_blank",iU="http://localhost";class Ww{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function aU(t,e,n,r=nU,o=rU){const i=Math.max((window.screen.availHeight-o)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString();let s="";const u=Object.assign(Object.assign({},tU),{width:r.toString(),height:o.toString(),top:i,left:a}),c=on().toLowerCase();n&&(s=Qk(c)?oU:n),Xk(c)&&(e=e||iU,u.scrollbars="yes");const l=Object.entries(u).reduce((f,[h,m])=>`${f}${h}=${m},`,"");if(S6(c)&&s!=="_self")return sU(e||"",s),new Ww(null);const d=window.open(e||"",s,l);xe(d,t,"popup-blocked");try{d.focus()}catch{}return new Ww(d)}function sU(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uU="__/auth/handler",cU="emulator/auth/handler",lU=encodeURIComponent("fac");async function $w(t,e,n,r,o,i){xe(t.config.authDomain,t,"auth-domain-config-required"),xe(t.config.apiKey,t,"invalid-api-key");const a={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:Qc,eventId:o};if(e instanceof sI){e.setDefaultLanguage(t.languageCode),a.providerId=e.providerId||"",Gj(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[l,d]of Object.entries({}))a[l]=d}if(e instanceof el){const l=e.getScopes().filter(d=>d!=="");l.length>0&&(a.scopes=l.join(","))}t.tenantId&&(a.tid=t.tenantId);const s=a;for(const l of Object.keys(s))s[l]===void 0&&delete s[l];const u=await t._getAppCheckToken(),c=u?`#${lU}=${encodeURIComponent(u)}`:"";return`${dU(t)}?${Yc(s).slice(1)}${c}`}function dU({config:t}){return t.emulator?By(t,cU):`https://${t.authDomain}/${uU}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Up="webStorageSupport";class fU{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=pI,this._completeRedirectFn=F8,this._overrideRedirectResult=D8}async _openPopup(e,n,r,o){var i;_o((i=this.eventManagers[e._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const a=await $w(e,n,r,Dv(),o);return aU(e,a,zy())}async _openRedirect(e,n,r,o){await this._originValidation(e);const i=await $w(e,n,r,Dv(),o);return m8(i),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:o,promise:i}=this.eventManagers[n];return o?Promise.resolve(o):(_o(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await eU(e),r=new B8(e);return n.register("authEvent",o=>(xe(o==null?void 0:o.authEvent,e,"invalid-auth-event"),{status:r.onEvent(o.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Up,{type:Up},o=>{var i;const a=(i=o==null?void 0:o[0])===null||i===void 0?void 0:i[Up];a!==void 0&&n(!!a),xr(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=z8(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return nI()||Yk()||Uy()}}const hU=fU;var zw="@firebase/auth",Vw="1.10.8";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pU{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){xe(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mU(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function vU(t){Cc(new qs("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),o=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:a,authDomain:s}=r.options;xe(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});const u={apiKey:a,authDomain:s,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:rI(t)},c=new A6(r,o,i,u);return W6(c,n),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),Cc(new qs("auth-internal",e=>{const n=Ia(e.getProvider("auth").getImmediate());return(r=>new pU(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),vs(zw,Vw,mU(t)),vs(zw,Vw,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gU=5*60,yU=Dk("authIdTokenMaxAge")||gU;let Hw=null;const xU=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>yU)return;const o=n==null?void 0:n.token;Hw!==o&&(Hw=o,await fetch(t,{method:o?"POST":"DELETE",headers:o?{Authorization:`Bearer ${o}`}:{}}))};function wU(t=q5()){const e=Lk(t,"auth");if(e.isInitialized())return e.getImmediate();const n=U6(t,{popupRedirectResolver:hU,persistence:[_8,f8,pI]}),r=Dk("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const a=xU(i.toString());s8(n,a,()=>a(n.currentUser)),a8(n,s=>a(s))}}const o=Nj("auth");return o&&$6(n,`http://${o}`),n}function bU(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}P6({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=o=>{const i=Wr("internal-error");i.customData=o,n(i)},r.type="text/javascript",r.charset="UTF-8",bU().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});vU("Browser");var EU="firebase",CU="11.10.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */vs(EU,CU,"app");const _U={apiKey:"",authDomain:"",projectId:"",storageBucket:"",messagingSenderId:"",appId:""},SU=Bk(_U),Wl=wU(SU),bI=C.createContext(void 0),Gw=t=>{if(t instanceof Io){const e=t.code;if(e==="auth/invalid-credential"||e==="auth/invalid-email"||e==="auth/user-not-found")return"";if(e==="auth/email-already-in-use")return"";if(e==="auth/weak-password")return" 6 ";if(e==="auth/too-many-requests")return" "}return" "},kU=({children:t})=>{const[e,n]=C.useState(null),[r,o]=C.useState(!0),[i,a]=C.useState(!1),[s,u]=C.useState(null);C.useEffect(()=>u8(Wl,p=>{n(p),o(!1)}),[]);const c=async(m,p)=>{a(!0),u(null);try{await r8(Wl,m,p)}catch(g){throw u(Gw(g)),g}finally{a(!1)}},l=async({email:m,password:p,displayName:g})=>{a(!0),u(null);try{const v=await n8(Wl,m,p);g&&await i8(v.user,{displayName:g})}catch(v){throw u(Gw(v)),v}finally{a(!1)}},d=async()=>{u(null),await c8(Wl)},f=()=>u(null),h=C.useMemo(()=>({user:e,initializing:r,authLoading:i,authError:s,signIn:c,signUp:l,signOutUser:d,resetAuthError:f}),[e,r,i,s]);return w.jsx(bI.Provider,{value:h,children:t})},EI=()=>{const t=C.useContext(bI);if(!t)throw new Error("useAuth must be used within an AuthProvider");return t},IU="/assets/%E0%B8%99%E0%B9%89%E0%B8%AD%E0%B8%87%E0%B8%9B%E0%B8%A5%E0%B8%B2%E0%B8%97%E0%B8%B9-elIqDDwR.png";/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var CI=function(t,e){return(CI=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)r.hasOwnProperty(o)&&(n[o]=r[o])})(t,e)};function wr(t,e){function n(){this.constructor=t}CI(t,e),t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}function ce(t,e,n,r){return new(n||(n=Promise))(function(o,i){function a(c){try{u(r.next(c))}catch(l){i(l)}}function s(c){try{u(r.throw(c))}catch(l){i(l)}}function u(c){c.done?o(c.value):new n(function(l){l(c.value)}).then(a,s)}u((r=r.apply(t,[])).next())})}function le(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function s(u){return function(c){return function(l){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&l[0]?r.return:l[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,l[1])).done)return o;switch(r=0,o&&(l=[2&l[0],o.value]),l[0]){case 0:case 1:o=l;break;case 4:return a.label++,{value:l[1],done:!1};case 5:a.label++,r=l[1],l=[0];continue;case 7:l=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(l[0]===6||l[0]===2)){a=0;continue}if(l[0]===3&&(!o||l[1]>o[0]&&l[1]<o[3])){a.label=l[1];break}if(l[0]===6&&a.label<o[1]){a.label=o[1],o=l;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(l);break}o[2]&&a.ops.pop(),a.trys.pop();continue}l=e.call(t,a)}catch(d){l=[6,d],r=0}finally{n=o=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([u,c])}}}var RU=function(){function t(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.populateURLFlags()}return t.prototype.setPlatform=function(e,n){this.platform!=null&&console.warn("Platform "+this.platformName+" has already been set. Overwriting the platform with "+n+"."),this.platformName=e,this.platform=n},t.prototype.registerFlag=function(e,n,r){if(this.flagRegistry[e]={evaluationFn:n,setHook:r},this.urlFlags[e]!=null){var o=this.urlFlags[e];console.warn("Setting feature override from URL "+e+": "+o+"."),this.set(e,o)}},t.prototype.get=function(e){return e in this.flags?this.flags[e]:(this.flags[e]=this.evaluateFlag(e),this.flags[e])},t.prototype.getNumber=function(e){return this.get(e)},t.prototype.getBool=function(e){return this.get(e)},t.prototype.getFlags=function(){return this.flags},Object.defineProperty(t.prototype,"features",{get:function(){return this.flags},enumerable:!0,configurable:!0}),t.prototype.set=function(e,n){if(this.flagRegistry[e]==null)throw new Error("Cannot set flag "+e+" as it has not been registered.");this.flags[e]=n,this.flagRegistry[e].setHook!=null&&this.flagRegistry[e].setHook(n)},t.prototype.evaluateFlag=function(e){if(this.flagRegistry[e]==null)throw new Error("Cannot evaluate flag '"+e+"': no evaluation function found.");return this.flagRegistry[e].evaluationFn()},t.prototype.setFlags=function(e){this.flags=Object.assign({},e)},t.prototype.reset=function(){this.flags={},this.urlFlags={},this.populateURLFlags()},t.prototype.populateURLFlags=function(){var e=this;if(this.global!==void 0&&this.global.location!==void 0&&this.global.location.search!==void 0){var n,r,o=(n=this.global.location.search,r={},n.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,function(i){for(var a=[],s=1;s<arguments.length;s++)a[s-1]=arguments[s];return TU(r,a[0],a[1]),a.join("=")}),r);"tfjsflags"in o&&o.tfjsflags.split(",").forEach(function(i){var a=i.split(":"),s=a[0],u=a[1];e.urlFlags[s]=function(c,l){if((l=l.toLowerCase())==="true"||l==="false")return l==="true";if(""+ +l===l)return+l;throw new Error("Could not parse value flag value "+l+" for flag "+c+".")}(s,u)})}},t}();function TU(t,e,n){t[decodeURIComponent(e)]=decodeURIComponent(n||"")}function G(){return _I}var _I=null,mf=new Map,Lv=new Map;function SI(t,e){var n=II(t,e);return mf.get(n)}function NU(t){return Lv.get(t)}function Kw(t){for(var e=mf.entries(),n=[];;){var r=e.next(),o=r.done,i=r.value;if(o)break;var a=i[0],s=i[1];a.split("_")[0]===t&&n.push(s)}return n}function kI(t){var e=t.kernelName,n=t.backendName,r=II(e,n);if(mf.has(r))throw new Error("The kernel '"+e+"' for backend '"+n+"' is already registered");mf.set(r,t)}function AU(t){var e=t.kernelName;Lv.has(e)&&console.warn("Overriding the gradient for '"+e+"'"),Lv.set(e,t)}function II(t,e){return e+"_"+t}function Bv(t,e,n){return Math.max(t,Math.min(e,n))}function RI(t){return t%2==0?t:t+1}function PU(t){for(var e=0,n=0;n<t.length;n++)e+=t[n];return e}function N(t,e){if(!t)throw new Error(typeof e=="string"?e:e())}function $e(t,e,n){n===void 0&&(n=""),N(At(t,e),function(){return n+" Shapes "+t+" and "+e+" must match"})}function lu(t){N(t!=null,function(){return"The input to the tensor constructor must be a non-null value."})}function Ys(t,e,n){if(e===void 0&&(e=[]),n===void 0&&(n=!1),e==null&&(e=[]),Array.isArray(t)||zr(t)&&!n)for(var r=0;r<t.length;++r)Ys(t[r],e,n);else e.push(t);return e}function de(t){if(t.length===0)return 1;for(var e=t[0],n=1;n<t.length;n++)e*=t[n];return e}function At(t,e){if(t===e)return!0;if(t==null||e==null||t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function dt(t){return t%1==0}function DU(t){if(Math.tanh!=null)return Math.tanh(t);if(t===1/0)return 1;if(t===-1/0)return-1;var e=Math.exp(2*t);return(e-1)/(e+1)}function jv(t){var e=Math.ceil(Math.sqrt(t));return[e,Math.ceil(t/e)]}function ws(t,e){return e<=t.length?t:t+" ".repeat(e-t.length)}function qw(t,e,n){return e===void 0&&(e=function(r){return 0}),new Promise(function(r,o){var i=0,a=function(){if(t())r();else{i++;var s=e(i);n!=null&&i>=n?o():setTimeout(a,s)}};a()})}function MU(t,e){for(var n=1,r=-1,o=0;o<t.length;++o)if(t[o]>=0)n*=t[o];else if(t[o]===-1){if(r!==-1)throw Error("Shapes can only have 1 implicit size. Found -1 at dim "+r+" and dim "+o);r=o}else if(t[o]<0)throw Error("Shapes can not be < 0. Found "+t[o]+" at dim "+o);if(r===-1){if(e>0&&e!==n)throw Error("Size("+e+") must match the product of shape "+t);return t}if(n===0)throw Error("Cannot infer the missing size in ["+t+"] when there are 0 elements");if(e%n!=0)throw Error("The implicit shape can't be a fractional number. Got "+e+" / "+n);var i=t.slice();return i[r]=e/n,i}function _t(t,e){var n=e.length;return N((t=t==null?e.map(function(r,o){return o}):[].concat(t)).every(function(r){return r>=-n&&r<n}),function(){return"All values in axis param must be in range [-"+n+", "+n+") but got axis "+t}),N(t.every(function(r){return dt(r)}),function(){return"All values in axis param must be integers but got axis "+t}),t.map(function(r){return r<0?n+r:r})}function Xi(t,e){for(var n=[],r=[],o=e!=null&&Array.isArray(e)&&e.length===0,i=e==null||o?null:_t(e,t).sort(),a=0,s=0;s<t.length;++s){if(i!=null){if(i[a]===s&&t[s]!==1)throw new Error("Can't squeeze axis "+s+" since its dim '"+t[s]+"' is not 1");(i[a]==null||i[a]>s)&&t[s]===1&&(n.push(t[s]),r.push(s)),i[a]<=s&&a++}t[s]!==1&&(n.push(t[s]),r.push(s))}return{newShape:n,keptDims:r}}function kc(t,e){var n=null;if(t==null||t==="float32")n=new Float32Array(e);else if(t==="int32")n=new Int32Array(e);else{if(t!=="bool")throw new Error("Unknown data type "+t);n=new Uint8Array(e)}return n}function vf(t,e){var n=null;if(t==null||t==="float32")n=new Float32Array(e);else if(t==="int32")n=new Int32Array(e);else if(t==="bool")n=new Uint8Array(e);else{if(t!=="string")throw new Error("Unknown data type "+t);n=new Array(e)}return n}function OU(t,e){for(var n=0;n<t.length;n++){var r=t[n];if(isNaN(r)||!isFinite(r))throw Error("A tensor of type "+e+" being uploaded contains "+r+".")}}function FU(t){return t==="bool"||t==="complex64"||t==="float32"||t==="int32"||t==="string"}function LU(t,e){return e!=="complex64"&&(e!=="float32"||t==="complex64")&&(e!=="int32"||t==="float32"||t==="complex64")&&(e!=="bool"||t!=="bool")}function zr(t){return t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array}function TI(t){if(t==="float32"||t==="int32")return 4;if(t==="complex64")return 8;if(t==="bool")return 1;throw new Error("Unknown dtype "+t)}function BU(t){if(t==null)return 0;var e=0;return t.forEach(function(n){return e+=n.length}),e}function Hy(t){return typeof t=="string"||t instanceof String}function jU(t){return typeof t=="boolean"}function UU(t){return typeof t=="number"}function nl(t){return Array.isArray(t)?nl(t[0]):t instanceof Float32Array?"float32":t instanceof Int32Array||t instanceof Uint8Array?"int32":UU(t)?"float32":Hy(t)?"string":jU(t)?"bool":"float32"}function Uv(t){return!!(t&&t.constructor&&t.call&&t.apply)}function Wv(t,e){for(var n=e;n<t;++n)if(t%n==0)return n;return t}function Vr(t){var e=t.length;if(e<2)return[];var n=new Array(e-1);n[e-2]=t[e-1];for(var r=e-3;r>=0;--r)n[r]=n[r+1]*t[r+1];return n}function NI(t,e,n){if(e==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(t)&&(t=Ys(t)),n&&OU(t,e),function(i,a){return i instanceof Float32Array&&a==="float32"||i instanceof Int32Array&&a==="int32"||i instanceof Uint8Array&&a==="bool"}(t,e))return t;if(e==null||e==="float32"||e==="complex64")return new Float32Array(t);if(e==="int32")return new Int32Array(t);if(e==="bool"){for(var r=new Uint8Array(t.length),o=0;o<r.length;++o)Math.round(t[o])!==0&&(r[o]=1);return r}throw new Error("Unknown data type "+e)}function Xw(t,e){if(t.length===0)return e[0];var n=t.reduce(function(r,o){return r*o});if(n===0)return[];if(n!==e.length)throw new Error("["+t+"] does not match the input size.");return function r(o,i,a){var s=new Array;if(i.length===1)for(var u=i[0],c=0;c<u;c++)s[c]=a[o+c];else{u=i[0];var l=i.slice(1),d=l.reduce(function(f,h){return f*h});for(c=0;c<u;c++)s[c]=r(o+c*d,l,a)}return s}(0,t,e)}function AI(t,e){for(var n=rl(t,e),r=0;r<n.length;r++)n[r]=1;return n}function rl(t,e){if(e==null||e==="float32"||e==="complex64")return new Float32Array(t);if(e==="int32")return new Int32Array(t);if(e==="bool")return new Uint8Array(t);throw new Error("Unknown data type "+e)}function Ar(){return G().platform.now()}function PI(t){t.forEach(function(e){N(Number.isInteger(e)&&e>=0,function(){return"Tensor must have a shape comprised of positive integers but got shape ["+t+"]."})})}function WU(t,e){return e===void 0&&(e="utf-8"),e=e||"utf-8",G().platform.encode(t,e)}function gf(t,e){return e===void 0&&(e="utf-8"),e=e||"utf-8",G().platform.decode(t,e)}function Yw(t,e,n){if(e===0)return 0;if(e===1)return t[0];for(var r=t[t.length-1],o=0;o<t.length-1;++o)r+=n[o]*t[o];return r}function $U(t,e,n){if(e===0)return[];if(e===1)return[t];for(var r=new Array(e),o=0;o<r.length-1;++o)r[o]=Math.floor(t/n[o]),t-=r[o]*n[o];return r[r.length-1]=t,r}var zU=function(){function t(e,n){this.backendTimer=e,this.logger=n,n==null&&(this.logger=new VU)}return t.prototype.profileKernel=function(e,n,r){var o,i=this,a=this.backendTimer.time(function(){o=r()});return o.forEach(function(s){s.data().then(function(u){(function(c,l,d){if(l!=="float32")return!1;for(var f=0;f<c.length;f++){var h=c[f];if(isNaN(h)||!isFinite(h))return console.warn("Found "+h+" in the result of '"+d+"'"),!0}})(u,s.dtype,e),a.then(function(c){var l="";c.getExtraProfileInfo!=null&&(l=c.getExtraProfileInfo()),i.logger.logKernelProfile(e,s,u,c.kernelMs,n,l)})})}),o},t}(),VU=function(){function t(){}return t.prototype.logKernelProfile=function(e,n,r,o,i,a){var s=typeof o=="number"?ws(o+"ms",9):o.error,u=ws(e,25),c=n.rank,l=n.size,d=ws(n.shape.toString(),14),f="";for(var h in i){var m=i[h].shape||n.shape,p=m.length;f+=h+": "+p+"D "+(p>0?m:"")+" "}console.log("%c"+u+"	%c"+s+"	%c"+c+"D "+d+"	%c"+l+"	%c"+f+"	%c"+a,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")},t}(),Qw=20,Eu=3,Wp=7;function HU(t,e,n,r){var o=Vr(e),i=function(c,l,d,f){var h=de(l),m=f[f.length-1],p=new Array(m).fill(0),g=l.length,v=d==="complex64"?_u(c):c;if(g>1)for(var y=0;y<h/m;y++)for(var x=y*m,b=0;b<m;b++)p[b]=Math.max(p[b],Cu(v[x+b],0,d).length);return p}(t,e,n,o),a=e.length,s=function c(l,d,f,h,m,p){p===void 0&&(p=!0);var g=f==="complex64"?2:1,v=d[0],y=d.length;if(y===0)return f==="complex64"?[Cu(_u(l)[0],0,f)]:f==="bool"?[DI(l[0])]:[l[0].toString()];if(y===1){if(v>Qw){var x=Eu*g,b=Array.from(l.slice(0,x)),E=Array.from(l.slice((v-Eu)*g,v*g));return f==="complex64"&&(b=_u(b),E=_u(E)),["["+b.map(function($,j){return Cu($,m[j],f)}).join(", ")+", ..., "+E.map(function($,j){return Cu($,m[v-Eu+j],f)}).join(", ")+"]"]}return["["+(f==="complex64"?_u(l):Array.from(l)).map(function($,j){return Cu($,m[j],f)}).join(", ")+"]"]}var _=d.slice(1),S=h.slice(1),k=h[0]*g,R=[];if(v>Qw){for(var I=0;I<Eu;I++){var D=(A=I*k)+k;R.push.apply(R,c(l.slice(A,D),_,f,S,m,!1))}for(R.push("..."),I=v-Eu;I<v;I++)D=(A=I*k)+k,R.push.apply(R,c(l.slice(A,D),_,f,S,m,I===v-1))}else for(I=0;I<v;I++){var A;D=(A=I*k)+k,R.push.apply(R,c(l.slice(A,D),_,f,S,m,I===v-1))}var W=y===2?",":"";for(R[0]="["+R[0]+W,I=1;I<R.length-1;I++)R[I]=" "+R[I]+W;var F=`,
`;for(I=2;I<y;I++)F+=`
`;return R[R.length-1]=" "+R[R.length-1]+"]"+(p?"":F),R}(t,e,n,o,i),u=["Tensor"];return r&&(u.push("  dtype: "+n),u.push("  rank: "+a),u.push("  shape: ["+e+"]"),u.push("  values:")),u.push(s.map(function(c){return"    "+c}).join(`
`)),u.join(`
`)}function Cu(t,e,n){return ws(Array.isArray(t)?parseFloat(t[0].toFixed(Wp))+" + "+parseFloat(t[1].toFixed(Wp))+"j":Hy(t)?"'"+t+"'":n==="bool"?DI(t):parseFloat(t.toFixed(Wp)).toString(),e)}function DI(t){return t===0?"false":"true"}function _u(t){for(var e=[],n=0;n<t.length;n+=2)e.push([t[n],t[n+1]]);return e}var Ic=function(){function t(e,n,r){var o=this;if(this.dtype=n,this.shape=e.slice(),this.size=de(e),r!=null){var i=r.length;N(i===this.size,function(){return"Length of values '"+i+"' does not match the size inferred by the shape '"+o.size+"'."})}if(n==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||vf(n,this.size),this.strides=Vr(e)}return t.prototype.set=function(e){for(var n=this,r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];r.length===0&&(r=[0]),N(r.length===this.rank,function(){return"The number of provided coordinates ("+r.length+") must match the rank ("+n.rank+")"});var i=this.locToIndex(r);this.values[i]=e},t.prototype.get=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];e.length===0&&(e=[0]);for(var r=0,o=0,i=e;o<i.length;o++){var a=i[o];if(a<0||a>=this.shape[r]){var s="Requested out of range element at "+e+".   Buffer shape="+this.shape;throw new Error(s)}r++}for(var u=e[e.length-1],c=0;c<e.length-1;++c)u+=this.strides[c]*e[c];return this.values[u]},t.prototype.locToIndex=function(e){if(this.rank===0)return 0;if(this.rank===1)return e[0];for(var n=e[e.length-1],r=0;r<e.length-1;++r)n+=this.strides[r]*e[r];return n},t.prototype.indexToLoc=function(e){if(this.rank===0)return[];if(this.rank===1)return[e];for(var n=new Array(this.shape.length),r=0;r<n.length-1;++r)n[r]=Math.floor(e/this.strides[r]),e-=n[r]*this.strides[r];return n[n.length-1]=e,n},Object.defineProperty(t.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),t.prototype.toTensor=function(){return Mr().makeTensor(this.values,this.shape,this.dtype)},t}(),Mr=null,H=null,MI=null,nt=function(){function t(e,n,r,o){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=n||"float32",this.size=de(e),this.strides=Vr(e),this.dataId=r,this.id=o,this.rankType=this.rank<5?this.rank.toString():"higher"}return t.prototype.flatten=function(){return this.throwIfDisposed(),this.as1D()},t.prototype.asScalar=function(){return this.throwIfDisposed(),N(this.size===1,function(){return"The array must have only 1 element."}),this.reshape([])},t.prototype.as1D=function(){return this.throwIfDisposed(),this.reshape([this.size])},t.prototype.as2D=function(e,n){return this.throwIfDisposed(),this.reshape([e,n])},t.prototype.as3D=function(e,n,r){return this.throwIfDisposed(),this.reshape([e,n,r])},t.prototype.as4D=function(e,n,r,o){return this.throwIfDisposed(),this.reshape([e,n,r,o])},t.prototype.as5D=function(e,n,r,o,i){return this.throwIfDisposed(),this.reshape([e,n,r,o,i])},t.prototype.asType=function(e){return this.throwIfDisposed(),H.cast(this,e)},Object.defineProperty(t.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),t.prototype.buffer=function(){return ce(this,void 0,void 0,function(){var e;return le(this,function(n){switch(n.label){case 0:return[4,this.data()];case 1:return e=n.sent(),[2,H.buffer(this.shape,this.dtype,e)]}})})},t.prototype.bufferSync=function(){return H.buffer(this.shape,this.dtype,this.dataSync())},t.prototype.array=function(){return ce(this,void 0,void 0,function(){var e;return le(this,function(n){switch(n.label){case 0:return[4,this.data()];case 1:return e=n.sent(),[2,Xw(this.shape,e)]}})})},t.prototype.arraySync=function(){return Xw(this.shape,this.dataSync())},t.prototype.data=function(){return ce(this,void 0,void 0,function(){var e,n;return le(this,function(r){switch(r.label){case 0:return this.throwIfDisposed(),e=Mr().read(this.dataId),this.dtype!=="string"?[3,2]:[4,e];case 1:n=r.sent();try{return[2,n.map(function(o){return gf(o)})]}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}r.label=2;case 2:return[2,e]}})})},t.prototype.dataSync=function(){this.throwIfDisposed();var e=Mr().readSync(this.dataId);if(this.dtype==="string")try{return e.map(function(n){return gf(n)})}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e},t.prototype.bytes=function(){return ce(this,void 0,void 0,function(){var e;return le(this,function(n){switch(n.label){case 0:return this.throwIfDisposed(),[4,Mr().read(this.dataId)];case 1:return e=n.sent(),this.dtype==="string"?[2,e]:[2,new Uint8Array(e.buffer)]}})})},t.prototype.dispose=function(){this.isDisposed||(Mr().disposeTensor(this),this.isDisposedInternal=!0)},Object.defineProperty(t.prototype,"isDisposed",{get:function(){return this.isDisposedInternal},enumerable:!0,configurable:!0}),t.prototype.throwIfDisposed=function(){if(this.isDisposed)throw new Error("Tensor is disposed.")},t.prototype.toFloat=function(){return this.asType("float32")},t.prototype.toInt=function(){return this.asType("int32")},t.prototype.toBool=function(){return this.asType("bool")},t.prototype.print=function(e){return e===void 0&&(e=!1),H.print(this,e)},t.prototype.reshape=function(e){return this.throwIfDisposed(),H.reshape(this,e)},t.prototype.reshapeAs=function(e){return this.throwIfDisposed(),this.reshape(e.shape)},t.prototype.expandDims=function(e){return e===void 0&&(e=0),H.expandDims(this,e)},t.prototype.cumsum=function(e,n,r){return e===void 0&&(e=0),n===void 0&&(n=!1),r===void 0&&(r=!1),H.cumsum(this,e,n,r)},t.prototype.squeeze=function(e){return this.throwIfDisposed(),H.squeeze(this,e)},t.prototype.clone=function(){return this.throwIfDisposed(),H.clone(this)},t.prototype.oneHot=function(e,n,r){return this.throwIfDisposed(),H.oneHot(this,e,n,r)},t.prototype.toString=function(e){return e===void 0&&(e=!1),HU(this.dataSync(),this.shape,this.dtype,e)},t.prototype.tile=function(e){return this.throwIfDisposed(),H.tile(this,e)},t.prototype.gather=function(e,n){return n===void 0&&(n=0),this.throwIfDisposed(),H.gather(this,e,n)},t.prototype.matMul=function(e,n,r){return n===void 0&&(n=!1),r===void 0&&(r=!1),this.throwIfDisposed(),H.matMul(this,e,n,r)},t.prototype.dot=function(e){return this.throwIfDisposed(),H.dot(this,e)},t.prototype.norm=function(e,n,r){return e===void 0&&(e="euclidean"),n===void 0&&(n=null),r===void 0&&(r=!1),this.throwIfDisposed(),H.norm(this,e,n,r)},t.prototype.slice=function(e,n){return this.throwIfDisposed(),H.slice(this,e,n)},t.prototype.reverse=function(e){return this.throwIfDisposed(),H.reverse(this,e)},t.prototype.concat=function(e,n){return n===void 0&&(n=0),this.throwIfDisposed(),e instanceof t&&(e=[e]),H.concat([this].concat(e),n)},t.prototype.split=function(e,n){return n===void 0&&(n=0),this.throwIfDisposed(),H.split(this,e,n)},t.prototype.stack=function(e,n){return n===void 0&&(n=0),H.stack([this,e],n)},t.prototype.unstack=function(e){return e===void 0&&(e=0),H.unstack(this,e)},t.prototype.pad=function(e,n){return n===void 0&&(n=0),H.pad(this,e,n)},t.prototype.batchNormalization=function(e,n,r,o,i){return r===void 0&&(r=.001),MI("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon"),this.batchNorm(e,n,i,o,r)},t.prototype.batchNorm=function(e,n,r,o,i){return i===void 0&&(i=.001),this.throwIfDisposed(),H.batchNorm(this,e,n,r,o,i)},t.prototype.all=function(e,n){return e===void 0&&(e=null),n===void 0&&(n=!1),this.throwIfDisposed(),H.all(this,e,n)},t.prototype.any=function(e,n){return e===void 0&&(e=null),n===void 0&&(n=!1),this.throwIfDisposed(),H.any(this,e,n)},t.prototype.logSumExp=function(e,n){return e===void 0&&(e=null),n===void 0&&(n=!1),this.throwIfDisposed(),H.logSumExp(this,e,n)},t.prototype.sum=function(e,n){return e===void 0&&(e=null),n===void 0&&(n=!1),this.throwIfDisposed(),H.sum(this,e,n)},t.prototype.prod=function(e,n){return e===void 0&&(e=null),n===void 0&&(n=!1),this.throwIfDisposed(),H.prod(this,e,n)},t.prototype.mean=function(e,n){return e===void 0&&(e=null),n===void 0&&(n=!1),this.throwIfDisposed(),H.mean(this,e,n)},t.prototype.min=function(e,n){return e===void 0&&(e=null),n===void 0&&(n=!1),this.throwIfDisposed(),H.min(this,e,n)},t.prototype.max=function(e,n){return e===void 0&&(e=null),n===void 0&&(n=!1),this.throwIfDisposed(),H.max(this,e,n)},t.prototype.argMin=function(e){return e===void 0&&(e=null),this.throwIfDisposed(),H.argMin(this,e)},t.prototype.argMax=function(e){return e===void 0&&(e=null),this.throwIfDisposed(),H.argMax(this,e)},t.prototype.cast=function(e){return this.throwIfDisposed(),H.cast(this,e)},t.prototype.add=function(e){return this.throwIfDisposed(),H.add(this,e)},t.prototype.addStrict=function(e){return this.throwIfDisposed(),H.addStrict(this,e)},t.prototype.atan2=function(e){return this.throwIfDisposed(),H.atan2(this,e)},t.prototype.sub=function(e){return this.throwIfDisposed(),H.sub(this,e)},t.prototype.subStrict=function(e){return this.throwIfDisposed(),H.subStrict(this,e)},t.prototype.pow=function(e){return this.throwIfDisposed(),H.pow(this,e)},t.prototype.powStrict=function(e){return this.throwIfDisposed(),H.powStrict(this,e)},t.prototype.mul=function(e){return this.throwIfDisposed(),H.mul(this,e)},t.prototype.mulStrict=function(e){return this.throwIfDisposed(),H.mulStrict(this,e)},t.prototype.div=function(e){return this.throwIfDisposed(),H.div(this,e)},t.prototype.divNoNan=function(e){return this.throwIfDisposed(),H.divNoNan(this,e)},t.prototype.floorDiv=function(e){return this.throwIfDisposed(),H.floorDiv(this,e)},t.prototype.divStrict=function(e){return this.throwIfDisposed(),H.divStrict(this,e)},t.prototype.minimum=function(e){return this.throwIfDisposed(),H.minimum(this,e)},t.prototype.minimumStrict=function(e){return this.throwIfDisposed(),H.minimumStrict(this,e)},t.prototype.maximum=function(e){return this.throwIfDisposed(),H.maximum(this,e)},t.prototype.maximumStrict=function(e){return this.throwIfDisposed(),H.maximumStrict(this,e)},t.prototype.mod=function(e){return this.throwIfDisposed(),H.mod(this,e)},t.prototype.modStrict=function(e){return this.throwIfDisposed(),H.modStrict(this,e)},t.prototype.squaredDifferenceStrict=function(e){return this.throwIfDisposed(),H.squaredDifferenceStrict(this,e)},t.prototype.transpose=function(e){return this.throwIfDisposed(),H.transpose(this,e)},t.prototype.notEqual=function(e){return this.throwIfDisposed(),H.notEqual(this,e)},t.prototype.notEqualStrict=function(e){return this.throwIfDisposed(),H.notEqualStrict(this,e)},t.prototype.less=function(e){return this.throwIfDisposed(),H.less(this,e)},t.prototype.lessStrict=function(e){return this.throwIfDisposed(),H.lessStrict(this,e)},t.prototype.equal=function(e){return this.throwIfDisposed(),H.equal(this,e)},t.prototype.equalStrict=function(e){return this.throwIfDisposed(),H.equalStrict(this,e)},t.prototype.lessEqual=function(e){return this.throwIfDisposed(),H.lessEqual(this,e)},t.prototype.lessEqualStrict=function(e){return this.throwIfDisposed(),H.lessEqualStrict(this,e)},t.prototype.greater=function(e){return this.throwIfDisposed(),H.greater(this,e)},t.prototype.greaterStrict=function(e){return this.throwIfDisposed(),H.greaterStrict(this,e)},t.prototype.greaterEqual=function(e){return this.throwIfDisposed(),H.greaterEqual(this,e)},t.prototype.greaterEqualStrict=function(e){return this.throwIfDisposed(),H.greaterEqualStrict(this,e)},t.prototype.logicalAnd=function(e){return this.throwIfDisposed(),H.logicalAnd(this,e)},t.prototype.logicalOr=function(e){return this.throwIfDisposed(),H.logicalOr(this,e)},t.prototype.logicalNot=function(){return this.throwIfDisposed(),H.logicalNot(this)},t.prototype.logicalXor=function(e){return this.throwIfDisposed(),H.logicalXor(this,e)},t.prototype.where=function(e,n){return this.throwIfDisposed(),H.where(e,this,n)},t.prototype.neg=function(){return this.throwIfDisposed(),H.neg(this)},t.prototype.ceil=function(){return this.throwIfDisposed(),H.ceil(this)},t.prototype.floor=function(){return this.throwIfDisposed(),H.floor(this)},t.prototype.sign=function(){return this.throwIfDisposed(),H.sign(this)},t.prototype.isNaN=function(){return this.throwIfDisposed(),H.isNaN(this)},t.prototype.isInf=function(){return this.throwIfDisposed(),H.isInf(this)},t.prototype.isFinite=function(){return this.throwIfDisposed(),H.isFinite(this)},t.prototype.exp=function(){return this.throwIfDisposed(),H.exp(this)},t.prototype.expm1=function(){return this.throwIfDisposed(),H.expm1(this)},t.prototype.log=function(){return this.throwIfDisposed(),H.log(this)},t.prototype.log1p=function(){return this.throwIfDisposed(),H.log1p(this)},t.prototype.sqrt=function(){return this.throwIfDisposed(),H.sqrt(this)},t.prototype.rsqrt=function(){return this.throwIfDisposed(),H.rsqrt(this)},t.prototype.square=function(){return this.throwIfDisposed(),H.square(this)},t.prototype.reciprocal=function(){return this.throwIfDisposed(),H.reciprocal(this)},t.prototype.abs=function(){return this.throwIfDisposed(),H.abs(this)},t.prototype.clipByValue=function(e,n){return this.throwIfDisposed(),H.clipByValue(this,e,n)},t.prototype.relu=function(){return this.throwIfDisposed(),H.relu(this)},t.prototype.relu6=function(){return this.throwIfDisposed(),H.relu6(this)},t.prototype.elu=function(){return this.throwIfDisposed(),H.elu(this)},t.prototype.selu=function(){return this.throwIfDisposed(),H.selu(this)},t.prototype.leakyRelu=function(e){return e===void 0&&(e=.2),this.throwIfDisposed(),H.leakyRelu(this,e)},t.prototype.prelu=function(e){return this.throwIfDisposed(),H.prelu(this,e)},t.prototype.sigmoid=function(){return this.throwIfDisposed(),H.sigmoid(this)},t.prototype.logSigmoid=function(){return this.throwIfDisposed(),H.logSigmoid(this)},t.prototype.softplus=function(){return this.throwIfDisposed(),H.softplus(this)},t.prototype.zerosLike=function(){return this.throwIfDisposed(),H.zerosLike(this)},t.prototype.onesLike=function(){return this.throwIfDisposed(),H.onesLike(this)},t.prototype.sin=function(){return this.throwIfDisposed(),H.sin(this)},t.prototype.cos=function(){return this.throwIfDisposed(),H.cos(this)},t.prototype.tan=function(){return this.throwIfDisposed(),H.tan(this)},t.prototype.asin=function(){return this.throwIfDisposed(),H.asin(this)},t.prototype.acos=function(){return this.throwIfDisposed(),H.acos(this)},t.prototype.atan=function(){return this.throwIfDisposed(),H.atan(this)},t.prototype.sinh=function(){return this.throwIfDisposed(),H.sinh(this)},t.prototype.cosh=function(){return this.throwIfDisposed(),H.cosh(this)},t.prototype.tanh=function(){return this.throwIfDisposed(),H.tanh(this)},t.prototype.asinh=function(){return this.throwIfDisposed(),H.asinh(this)},t.prototype.acosh=function(){return this.throwIfDisposed(),H.acosh(this)},t.prototype.atanh=function(){return this.throwIfDisposed(),H.atanh(this)},t.prototype.erf=function(){return this.throwIfDisposed(),H.erf(this)},t.prototype.round=function(){return this.throwIfDisposed(),H.round(this)},t.prototype.step=function(e){return e===void 0&&(e=0),this.throwIfDisposed(),H.step(this,e)},t.prototype.softmax=function(e){return e===void 0&&(e=-1),this.throwIfDisposed(),H.softmax(this,e)},t.prototype.logSoftmax=function(e){return e===void 0&&(e=-1),this.throwIfDisposed(),H.logSoftmax(this,e)},t.prototype.resizeBilinear=function(e,n){return n===void 0&&(n=!1),this.throwIfDisposed(),H.image.resizeBilinear(this,e,n)},t.prototype.resizeNearestNeighbor=function(e,n){return n===void 0&&(n=!1),this.throwIfDisposed(),H.image.resizeNearestNeighbor(this,e,n)},t.prototype.conv1d=function(e,n,r,o,i,a){return o===void 0&&(o="NWC"),i===void 0&&(i=1),this.throwIfDisposed(),H.conv1d(this,e,n,r,o,i,a)},t.prototype.conv2d=function(e,n,r,o,i,a){return o===void 0&&(o="NHWC"),i===void 0&&(i=[1,1]),this.throwIfDisposed(),H.conv2d(this,e,n,r,o,i,a)},t.prototype.conv2dTranspose=function(e,n,r,o,i){return this.throwIfDisposed(),H.conv2dTranspose(this,e,n,r,o,i)},t.prototype.depthwiseConv2D=function(e,n,r,o,i,a){return o===void 0&&(o="NHWC"),i===void 0&&(i=[1,1]),this.throwIfDisposed(),H.depthwiseConv2d(this,e,n,r,o,i,a)},t.prototype.separableConv2d=function(e,n,r,o,i,a){return i===void 0&&(i=[1,1]),a===void 0&&(a="NHWC"),this.throwIfDisposed(),H.separableConv2d(this,e,n,r,o,i,a)},t.prototype.avgPool=function(e,n,r,o){return this.throwIfDisposed(),H.avgPool(this,e,n,r,o)},t.prototype.maxPool=function(e,n,r,o){return this.throwIfDisposed(),H.maxPool(this,e,n,r,o)},t.prototype.localResponseNormalization=function(e,n,r,o){return e===void 0&&(e=5),n===void 0&&(n=1),r===void 0&&(r=1),o===void 0&&(o=.5),H.localResponseNormalization(this,e,n,r,o)},t.prototype.pool=function(e,n,r,o,i){return this.throwIfDisposed(),H.pool(this,e,n,r,o,i)},t.prototype.variable=function(e,n,r){return e===void 0&&(e=!0),this.throwIfDisposed(),Mr().makeVariable(this,e,n,r)},t.prototype.unsortedSegmentSum=function(e,n){return this.throwIfDisposed(),H.unsortedSegmentSum(this,e,n)},t.prototype.batchToSpaceND=function(e,n){return this.throwIfDisposed(),H.batchToSpaceND(this,e,n)},t.prototype.spaceToBatchND=function(e,n){return this.throwIfDisposed(),H.spaceToBatchND(this,e,n)},t.prototype.topk=function(e,n){return e===void 0&&(e=1),n===void 0&&(n=!0),this.throwIfDisposed(),H.topk(this,e,n)},t.prototype.stridedSlice=function(e,n,r,o,i,a,s,u){return o===void 0&&(o=0),i===void 0&&(i=0),a===void 0&&(a=0),s===void 0&&(s=0),u===void 0&&(u=0),this.throwIfDisposed(),H.stridedSlice(this,e,n,r,o,i,a,s,u)},t.prototype.depthToSpace=function(e,n){return this.throwIfDisposed(),H.depthToSpace(this,e,n)},t.prototype.fft=function(){return this.throwIfDisposed(),H.spectral.fft(this)},t.prototype.ifft=function(){return this.throwIfDisposed(),H.spectral.ifft(this)},t.prototype.rfft=function(){return this.throwIfDisposed(),H.spectral.rfft(this)},t.prototype.irfft=function(){return this.throwIfDisposed(),H.spectral.irfft(this)},t}();Object.defineProperty(nt,Symbol.hasInstance,{value:function(t){return!!t&&t.dataId!=null&&t.shape!=null&&t.dtype!=null}});var Jw,$v,zv,Vv,Hv,Qs=function(t){function e(n,r,o,i){var a=t.call(this,n.shape,n.dtype,n.dataId,i)||this;return a.trainable=r,a.name=o,a}return wr(e,t),e.prototype.assign=function(n){if(n.dtype!==this.dtype)throw new Error("dtype of the new value ("+n.dtype+") and previous value ("+this.dtype+") must match");if(!At(n.shape,this.shape))throw new Error("shape of the new value ("+n.shape+") and previous value ("+this.shape+") must match");Mr().disposeTensor(this),this.dataId=n.dataId,Mr().incRef(this,null)},e.prototype.dispose=function(){Mr().disposeVariable(this),this.isDisposedInternal=!0},e}(nt);Object.defineProperty(Qs,Symbol.hasInstance,{value:function(t){return t instanceof nt&&t.assign!=null&&t.assign instanceof Function}}),function(t){t.R0="R0",t.R1="R1",t.R2="R2",t.R3="R3",t.R4="R4",t.R5="R5",t.R6="R6"}(Jw||(Jw={})),function(t){t.float32="float32",t.int32="int32",t.bool="int32",t.complex64="complex64"}($v||($v={})),function(t){t.float32="float32",t.int32="int32",t.bool="bool",t.complex64="complex64"}(zv||(zv={})),function(t){t.float32="float32",t.int32="float32",t.bool="float32",t.complex64="complex64"}(Vv||(Vv={})),function(t){t.float32="complex64",t.int32="complex64",t.bool="complex64",t.complex64="complex64"}(Hv||(Hv={}));var GU={float32:Vv,int32:$v,bool:zv,complex64:Hv};function Lt(t,e){if(t==="string"||e==="string"){if(t==="string"&&e==="string")return"string";throw new Error("Can not upcast "+t+" with "+e)}return GU[t][e]}function $p(t){return Lt(t,"int32")}function at(t,e){if(t.dtype===e.dtype)return[t,e];var n=Lt(t.dtype,e.dtype);return[t.cast(n),e.cast(n)]}function KU(t,e){N(t.dtype===e.dtype,function(){return"The dtypes of the first("+t.dtype+") and second("+e.dtype+") input must match"})}function OI(t){var e=[];return function n(r,o,i){if(r!=null){if(r instanceof nt)return void o.push(r);if(a=r,!(!Array.isArray(a)&&typeof a!="object")){var a,s=r;for(var u in s){var c=s[u];i.has(c)||(i.add(c),n(c,o,i))}}}}(t,e,new Set),e}var zp,Zw=function(){function t(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null}}return t.prototype.dispose=function(){for(var e in this.registeredVariables)this.registeredVariables[e].dispose()},t}(),qU=function(){function t(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new Zw}return t.prototype.ready=function(){return ce(this,void 0,void 0,function(){var e,n,r;return le(this,function(o){switch(o.label){case 0:if(this.pendingBackendInit!=null)return[2,this.pendingBackendInit.then(function(){})];if(this.backendInstance!=null)return[2];e=this.getSortedBackends(),n=0,o.label=1;case 1:return n<e.length?(r=e[n],[4,this.initializeBackend(r).success]):[3,5];case 2:return o.sent()?[4,this.setBackend(r)]:[3,4];case 3:return o.sent(),[2];case 4:return n++,[3,1];case 5:throw new Error("Could not initialize any backends, all backend initializations failed.")}})})},Object.defineProperty(t.prototype,"backend",{get:function(){if(this.pendingBackendInit!=null)throw new Error("Backend '"+this.backendName+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");if(this.backendInstance==null){var e=this.initializeBackendsAndReturnBest(),n=e.name;if(e.asyncInit)throw new Error("The highest priority backend '"+n+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");this.setBackend(n)}return this.backendInstance},enumerable:!0,configurable:!0}),t.prototype.backendNames=function(){return Object.keys(this.registryFactory)},t.prototype.findBackend=function(e){return!(e in this.registry)&&(!(e in this.registryFactory)||this.initializeBackend(e).asyncInit)?null:this.registry[e]},t.prototype.findBackendFactory=function(e){return e in this.registryFactory?this.registryFactory[e].factory:null},t.prototype.registerBackend=function(e,n,r){return r===void 0&&(r=1),e in this.registryFactory?(console.warn(e+" backend was already registered. Reusing existing backend factory."),!1):(this.registryFactory[e]={factory:n,priority:r},!0)},t.prototype.setBackend=function(e){return ce(this,void 0,void 0,function(){var n,r,o;return le(this,function(i){switch(i.label){case 0:if(this.registryFactory[e]==null)throw new Error("Backend name '"+e+"' not found in registry");return this.backendName=e,this.registry[e]!=null?[3,4]:(this.backendInstance=null,n=this.initializeBackend(e),r=n.success,n.asyncInit?[4,r]:[3,2]);case 1:return o=i.sent(),[3,3];case 2:o=r,i.label=3;case 3:if(!o)return[2,!1];i.label=4;case 4:return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new zU(this.backendInstance),[2,!0]}})})},t.prototype.setupRegisteredKernels=function(){var e=this;Kw(this.backendName).forEach(function(n){n.setupFunc!=null&&n.setupFunc(e.backendInstance)})},t.prototype.disposeRegisteredKernels=function(e){var n=this;Kw(e).forEach(function(r){r.disposeFunc!=null&&r.disposeFunc(n.registry[e])})},t.prototype.initializeBackend=function(e){var n=this,r=this.registryFactory[e];if(r==null)throw new Error("Cannot initialize backend "+e+", no registration found.");try{var o=r.factory();if(Promise.resolve(o)===o){var i=++this.pendingBackendInitId,a=o.then(function(s){return!(i<n.pendingBackendInitId)&&(n.registry[e]=s,n.pendingBackendInit=null,!0)}).catch(function(s){return!(i<n.pendingBackendInitId)&&(n.pendingBackendInit=null,console.warn("Initialization of backend "+e+" failed"),console.warn(s.stack||s.message),!1)});return this.pendingBackendInit=a,{success:a,asyncInit:!0}}return this.registry[e]=o,{success:!0,asyncInit:!1}}catch(s){return console.warn("Initialization of backend "+e+" failed"),console.warn(s.stack||s.message),{success:!1,asyncInit:!1}}},t.prototype.removeBackend=function(e){if(!(e in this.registryFactory))throw new Error(e+" backend not found in registry");this.backendName===e&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)},t.prototype.getSortedBackends=function(){var e=this;if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort(function(n,r){return e.registryFactory[r].priority-e.registryFactory[n].priority})},t.prototype.initializeBackendsAndReturnBest=function(){for(var e=this.getSortedBackends(),n=0;n<e.length;n++){var r=e[n],o=this.initializeBackend(r),i=o.success,a=o.asyncInit;if(a||i)return{name:r,asyncInit:a}}throw new Error("Could not initialize any backends, all backend initializations failed.")},t.prototype.moveData=function(e,n){var r=this.state.tensorInfo.get(n),o=r.backend,i=this.readSync(n);o.disposeData(n),r.backend=e,e.move(n,i,r.shape,r.dtype),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++},t.prototype.tidy=function(e,n){var r,o=this,i=null;if(n==null){if(typeof e!="function")throw new Error("Please provide a function to tidy()");n=e}else{if(typeof e!="string"&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof n!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");i=e}return this.scopedRun(function(){return o.startScope(i)},function(){return o.endScope(r)},function(){return(r=n())instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),r})},t.prototype.scopedRun=function(e,n,r){e();try{var o=r();return n(),o}catch(i){throw n(),i}},t.prototype.nextTensorId=function(){return t.nextTensorId++},t.prototype.nextVariableId=function(){return t.nextVariableId++},t.prototype.clone=function(e){var n=this.makeTensorFromDataId(e.dataId,e.shape,e.dtype),r={x:e};return this.addTapeNode(this.state.activeScope.name,r,[n],function(o){return{x:function(){return o.toFloat()}}},[]),n},t.prototype.runKernel=function(e,n,r,o,i){return this.runKernelFunc(null,n,null,e,r,o,i)},t.prototype.shouldCheckForMemLeaks=function(){return this.ENV.getBool("IS_TEST")},t.prototype.checkKernelForMemLeak=function(e,n,r){var o=this.backend.numDataIds(),i=0;r.forEach(function(u){i+=u.dtype==="complex64"?3:1});var a=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],s=o-n-i-a;if(s>0)throw new Error("Backend '"+this.backendName+"' has an internal memory leak ("+s+" data ids) after running '"+e+"'")},t.prototype.runKernelFunc=function(e,n,r,o,i,a,s){var u,c=this;a===void 0&&(a=[]),s===void 0&&(s=[]);var l=[],d=this.isTapeOn();o==null&&(o=this.state.activeScope!=null?this.state.activeScope.name:"");var f,h=function(y){d&&(l=y.map(function(x){return c.keep(c.clone(x))}))},m=this.state.numBytes,p=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);var g,v=SI(o,this.backendName);return f=v!=null?function(){var y=c.backend.numDataIds();g=v.kernelFunc({inputs:n,attrs:i,backend:c.backend});var x=Array.isArray(g)?g:[g];c.shouldCheckForMemLeaks()&&c.checkKernelForMemLeak(o,y,x);var b=x.map(function(_){var S=_.dataId,k=_.shape,R=_.dtype;return c.makeTensorFromDataId(S,k,R)}),E=b.filter(function(_,S){return s[S]});return h((a||[]).slice().concat(E)),b}:function(){var y=c.backend.numDataIds();g=c.tidy(function(){return e(c.backend,h)});var x=Array.isArray(g)?g:[g];return c.shouldCheckForMemLeaks()&&c.checkKernelForMemLeak(o,y,x),x},this.scopedRun(function(){return c.state.kernelDepth++},function(){return c.state.kernelDepth--},function(){u=c.ENV.getBool("DEBUG")?c.profiler.profileKernel(o,n,function(){return f()}):f()}),d&&this.addTapeNode(o,n,u,r,l),this.state.profiling&&this.state.activeProfile.kernels.push({name:o,bytesAdded:this.state.numBytes-m,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-p,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(n).map(function(y){return n[y].shape}),outputShapes:u.map(function(y){return y.shape})}),Array.isArray(g)?u:u[0]},t.prototype.makeTensor=function(e,n,r,o){if(e==null)throw new Error("Values passed to engine.makeTensor() are null");r=r||"float32",o=o||this.backend;var i=e;r==="string"&&Hy(e[0])&&(i=e.map(function(l){return WU(l)}));var a=o.write(i,n,r),s=new nt(n,r,a,this.nextTensorId());if(this.incRef(s,o),r==="string"){var u=this.state.tensorInfo.get(a),c=BU(i);this.state.numBytes+=c-u.bytes,u.bytes=c}return s},t.prototype.makeTensorFromDataId=function(e,n,r,o){var i=new nt(n,r=r||"float32",e,this.nextTensorId());return this.incRef(i,o),i},t.prototype.makeVariable=function(e,n,r,o){n===void 0&&(n=!0),r=r||this.nextVariableId().toString(),o!=null&&o!==e.dtype&&(e=e.asType(o));var i=new Qs(e,n,r,this.nextTensorId());if(this.state.registeredVariables[i.name]!=null)throw new Error("Variable with name "+i.name+" was already registered");return this.state.registeredVariables[i.name]=i,this.incRef(i,this.backend),i},t.prototype.incRef=function(e,n){var r=this.state.tensorInfo.has(e.dataId)?this.state.tensorInfo.get(e.dataId).refCount:0;if(this.state.numTensors++,e.dtype==="string"&&this.state.numStringTensors++,r===0){this.state.numDataBuffers++;var o=0;e.dtype!=="complex64"&&e.dtype!=="string"&&(o=e.size*TI(e.dtype)),this.state.tensorInfo.set(e.dataId,{backend:n||this.backend,dtype:e.dtype,shape:e.shape,bytes:o,refCount:0}),this.state.numBytes+=o}this.state.tensorInfo.get(e.dataId).refCount++,e instanceof Qs||this.track(e)},t.prototype.disposeTensor=function(e){if(this.state.tensorInfo.has(e.dataId)){this.state.numTensors--,e.dtype==="string"&&this.state.numStringTensors--;var n=this.state.tensorInfo.get(e.dataId);n.refCount<=1?(e.dtype!=="complex64"&&(this.state.numBytes-=n.bytes),this.state.numDataBuffers--,n.backend.disposeData(e.dataId),this.state.tensorInfo.delete(e.dataId)):this.state.tensorInfo.get(e.dataId).refCount--}},t.prototype.disposeVariables=function(){for(var e in this.state.registeredVariables){var n=this.state.registeredVariables[e];this.disposeVariable(n)}},t.prototype.disposeVariable=function(e){this.disposeTensor(e),this.state.registeredVariables[e.name]!=null&&delete this.state.registeredVariables[e.name]},t.prototype.memory=function(){var e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,e.reasons==null&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e},t.prototype.profile=function(e){return ce(this,void 0,void 0,function(){var n,r;return le(this,function(o){return this.state.profiling=!0,n=this.state.numBytes,r=this.state.numTensors,this.state.activeProfile.kernels=[],this.state.activeProfile.result=e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max.apply(Math,this.state.activeProfile.kernels.map(function(i){return i.totalBytesSnapshot})),this.state.activeProfile.newBytes=this.state.numBytes-n,this.state.activeProfile.newTensors=this.state.numTensors-r,[2,this.state.activeProfile]})})},t.prototype.isTapeOn=function(){return this.state.gradientDepth>0&&this.state.kernelDepth===0},t.prototype.addTapeNode=function(e,n,r,o,i){var a=this,s={id:this.state.nextTapeNodeId++,kernelName:e,inputs:n,outputs:r,saved:i},u=NU(e);u!=null&&(o=u.gradFunc),o!=null&&(s.gradient=function(c){return c=c.map(function(l,d){if(l==null){var f=r[d],h=rl(f.size,f.dtype);return a.makeTensor(h,f.shape,f.dtype)}return l}),o(c.length>1?c:c[0],i)}),this.state.activeTape.push(s)},t.prototype.keep=function(e){return e.kept=!0,e},t.prototype.startTape=function(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++},t.prototype.endTape=function(){this.state.gradientDepth--},t.prototype.startScope=function(e){var n={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(n.name=e),this.state.scopeStack.push(n),this.state.activeScope=n},t.prototype.endScope=function(e){for(var n=this,r=OI(e),o=new Set(r.map(function(u){return u.id})),i=0;i<this.state.activeScope.track.length;i++){var a=this.state.activeScope.track[i];a.kept||o.has(a.id)||a.dispose()}var s=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],r.forEach(function(u){u.kept||u.scopeId!==s.id||n.track(u)})},t.prototype.gradients=function(e,n,r,o){var i=this;if(o===void 0&&(o=!1),N(n.length>0,function(){return"gradients() received an empty list of xs."}),r!=null&&r.dtype!=="float32")throw new Error("dy must have 'float32' dtype, but has '"+r.dtype+"'");var a=this.scopedRun(function(){return i.startTape()},function(){return i.endTape()},function(){return i.tidy("forward",e)});N(a instanceof nt,function(){return"The result y returned by f() must be a tensor."});var s=function(u,c,l){for(var d={},f={},h=0;h<c.length;h++)d[c[h].id]=!0;for(h=0;h<u.length;h++){var m=(_=u[h]).inputs;for(var p in m){for(var g=m[p],v=!1,y=0;y<c.length;y++)if(d[g.id]){_.outputs.forEach(function(I){return d[I.id]=!0}),v=!0,f[_.id]=!0;break}if(v)break}}var x={};x[l.id]=!0;var b={};for(h=u.length-1;h>=0;h--)for(m=(_=u[h]).inputs,y=0;y<_.outputs.length;y++)if(x[_.outputs[y].id]){for(var p in m)x[m[p].id]=!0,b[_.id]=!0;break}var E=[];for(h=0;h<u.length;h++){var _;if(f[(_=u[h]).id]&&b[_.id]){var S={};for(var p in _.inputs){var k=_.inputs[p];d[k.id]&&(S[p]=k)}var R=Object.assign({},_);R.inputs=S,R.outputs=_.outputs,E.push(R)}}return E}(this.state.activeTape,n,a);if(!o&&s.length===0&&n.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",function(){var u,c,l={};l[a.id]=r??(u=a.shape,c=AI(de(u),"float32"),L.makeTensor(c,u,"float32")),function(f,h,m){for(var p=function(v){var y=h[v],x=[];if(y.outputs.forEach(function(S){var k=f[S.id];k!=null?x.push(k):x.push(null)}),y.gradient==null)throw new Error("Cannot compute gradient: gradient function not found for "+y.kernelName+".");var b=y.gradient(x),E=function(S){if(!(S in b))throw new Error("Cannot backprop through input "+S+". Available gradients found: "+Object.keys(b)+".");var k=m(function(){return b[S]()});if(k.dtype!=="float32")throw new Error("Error in gradient for op "+y.kernelName+". The gradient of input "+S+" must have 'float32' dtype, but has '"+k.dtype+"'");var R=y.inputs[S];if(!At(k.shape,R.shape))throw new Error("Error in gradient for op "+y.kernelName+". The gradient of input '"+S+"' has shape '"+k.shape+"', which does not match the shape of the input '"+R.shape+"'");if(f[R.id]==null)f[R.id]=k;else{var I=f[R.id];f[R.id]=I.add(k),I.dispose()}};for(var _ in y.inputs)E(_)},g=h.length-1;g>=0;g--)p(g)}(l,s,function(f){return i.tidy(f)});var d=n.map(function(f){return l[f.id]});return i.state.gradientDepth===0&&(i.state.activeTape.forEach(function(f){for(var h=0,m=f.saved;h<m.length;h++)m[h].dispose()}),i.state.activeTape=null),{value:a,grads:d}})},t.prototype.customGrad=function(e){var n=this;return N(Uv(e),function(){return"The f passed in customGrad(f) must be a function."}),function(){for(var r,o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];N(o.every(function(s){return s instanceof nt}),function(){return"The args passed in customGrad(f)(x1, x2,...) must all be tensors"});var a={};return o.forEach(function(s,u){a[u]=s}),n.runKernelFunc(function(s,u){return N((r=e.apply(void 0,o.concat([u]))).value instanceof nt,function(){return"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"}),N(Uv(r.gradFunc),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."}),r.value},a,function(s,u){var c=r.gradFunc(s,u),l=Array.isArray(c)?c:[c];N(l.length===o.length,function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."}),N(l.every(function(f){return f instanceof nt}),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."});var d={};return l.forEach(function(f,h){d[h]=function(){return f}}),d})}},t.prototype.readSync=function(e){return this.state.tensorInfo.get(e).backend.readSync(e)},t.prototype.read=function(e){return this.state.tensorInfo.get(e).backend.read(e)},t.prototype.time=function(e){return ce(this,void 0,void 0,function(){var n,r;return le(this,function(o){switch(o.label){case 0:return n=Ar(),[4,this.backend.time(e)];case 1:return(r=o.sent()).wallMs=Ar()-n,[2,r]}})})},t.prototype.track=function(e){return this.state.activeScope!=null&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e},Object.defineProperty(t.prototype,"registeredVariables",{get:function(){return this.state.registeredVariables},enumerable:!0,configurable:!0}),t.prototype.reset=function(){for(var e in this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new Zw,this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null},t.nextTensorId=0,t.nextVariableId=0,t}(),L=function(){var t=function(){if(zp==null){var n=void 0;if(typeof window<"u")n=window;else if(typeof global<"u")n=global;else if(typeof process<"u")n=process;else{if(typeof self>"u")throw new Error("Could not find a global object");n=self}zp=n}return zp}();if(t._tfengine==null){var e=new RU(t);t._tfengine=new qU(e)}return function(n){_I=n}(t._tfengine.ENV),Mr=function(){return t._tfengine},t._tfengine}();function FI(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}var no=G();no.registerFlag("DEBUG",function(){return!1},function(t){t&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")}),no.registerFlag("IS_BROWSER",function(){return FI()}),no.registerFlag("IS_NODE",function(){return typeof process<"u"&&process.versions!==void 0&&process.versions.node!==void 0}),no.registerFlag("IS_CHROME",function(){return typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)}),no.registerFlag("PROD",function(){return!1}),no.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",function(){return no.getBool("DEBUG")}),no.registerFlag("DEPRECATION_WARNINGS_ENABLED",function(){return!0}),no.registerFlag("IS_TEST",function(){return!1});var Rc,Rn,kn,Gi={},Vp={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function XU(t,e){Gi[t]=e}function Yr(t){t in Gi||(Gi[t]=function(n){if(n!==1&&n!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");var r=function(o){if(typeof OffscreenCanvas<"u"&&o===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}(n);return r.addEventListener("webglcontextlost",function(o){o.preventDefault(),delete Gi[n]},!1),n===1?r.getContext("webgl",Vp)||r.getContext("experimental-webgl",Vp):r.getContext("webgl2",Vp)}(t));var e=Gi[t];return e.isContextLost()?(delete Gi[t],Yr(t)):(e.disable(e.DEPTH_TEST),e.disable(e.STENCIL_TEST),e.disable(e.BLEND),e.disable(e.DITHER),e.disable(e.POLYGON_OFFSET_FILL),e.disable(e.SAMPLE_COVERAGE),e.enable(e.SCISSOR_TEST),e.enable(e.CULL_FACE),e.cullFace(e.BACK),Gi[t])}function _h(t,e){return[e,t]}function Gu(t){var e=de(t);return jv(Math.ceil(e/4))}function ol(t,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(t/2))]}function Gy(t,e){var n,r,o,i,a,s,u,c,l,d=t;return G().getNumber("WEBGL_VERSION")===2?(n=d.R32F,r=d.R16F,o=d.RGBA16F,i=d.RGBA32F,a=d.RED,s=4,u=1,c=d.HALF_FLOAT,l=d.FLOAT):(n=t.RGBA,r=t.RGBA,o=t.RGBA,i=d.RGBA,a=t.RGBA,s=4,u=4,c=e!=null?e.HALF_FLOAT_OES:null,l=t.FLOAT),{internalFormatFloat:n,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:o,internalFormatPackedFloat:i,textureFormatFloat:a,downloadTextureFormat:t.RGBA,downloadUnpackNumChannels:s,defaultNumChannels:u,textureTypeHalfFloat:c,textureTypeFloat:l}}function fe(t,e,n){var r=n();return e&&function(o){var i=o.getError();if(i!==o.NO_ERROR)throw new Error("WebGL Error: "+ZU(o,i))}(t),r}(function(t){t[t.DENSE=0]="DENSE",t[t.SHARED_BATCH=1]="SHARED_BATCH"})(Rc||(Rc={})),function(t){t[t.RENDER=0]="RENDER",t[t.UPLOAD=1]="UPLOAD",t[t.PIXELS=2]="PIXELS",t[t.DOWNLOAD=3]="DOWNLOAD"}(Rn||(Rn={})),function(t){t[t.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",t[t.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",t[t.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",t[t.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",t[t.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(kn||(kn={}));var YU=596e-10,QU=65504;function JU(t){return!!(G().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||t===0||YU<Math.abs(t)&&Math.abs(t)<QU)}function ZU(t,e){switch(e){case t.NO_ERROR:return"NO_ERROR";case t.INVALID_ENUM:return"INVALID_ENUM";case t.INVALID_VALUE:return"INVALID_VALUE";case t.INVALID_OPERATION:return"INVALID_OPERATION";case t.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case t.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case t.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code "+e}}function $l(t,e,n){return To(t,e,function(){return t.getExtension(n)},'Extension "'+n+'" not supported on this browser.')}function eW(t,e,n){var r=To(t,e,function(){return t.createShader(t.VERTEX_SHADER)},"Unable to create vertex WebGLShader.");if(fe(t,e,function(){return t.shaderSource(r,n)}),fe(t,e,function(){return t.compileShader(r)}),t.getShaderParameter(r,t.COMPILE_STATUS)===!1)throw console.log(t.getShaderInfoLog(r)),new Error("Failed to compile vertex shader.");return r}function tW(t,e,n){var r=To(t,e,function(){return t.createShader(t.FRAGMENT_SHADER)},"Unable to create fragment WebGLShader.");if(fe(t,e,function(){return t.shaderSource(r,n)}),fe(t,e,function(){return t.compileShader(r)}),t.getShaderParameter(r,t.COMPILE_STATUS)===!1)throw function(o,i){var a=nW.exec(i);if(a==null)return console.log("Couldn't parse line number in error: "+i),void console.log(o);for(var s=+a[1],u=o.split(`
`),c=u.length.toString().length+2,l=u.map(function(g,v){return ws((v+1).toString(),c)+g}),d=0,f=0;f<l.length;f++)d=Math.max(l[f].length,d);var h=l.slice(0,s-1),m=l.slice(s-1,s),p=l.slice(s);console.log(h.join(`
`)),console.log(i.split(`
`)[0]),console.log("%c "+ws(m[0],d),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(p.join(`
`))}(n,t.getShaderInfoLog(r)),new Error("Failed to compile fragment shader.");return r}var Hp,Gp,nW=/ERROR: [0-9]+:([0-9]+):/g;function rW(t,e){return To(t,e,function(){return t.createProgram()},"Unable to create WebGLProgram.")}function oW(t,e,n){if(fe(t,e,function(){return t.linkProgram(n)}),t.getProgramParameter(n,t.LINK_STATUS)===!1)throw console.log(t.getProgramInfoLog(n)),new Error("Failed to link vertex and fragment shaders.")}function Kp(t,e,n){if(fe(t,e,function(){return t.validateProgram(n)}),t.getProgramParameter(n,t.VALIDATE_STATUS)===!1)throw console.log(t.getProgramInfoLog(n)),new Error("Shader program validation failed.")}function iW(t,e,n){var r=To(t,e,function(){return t.createBuffer()},"Unable to create WebGLBuffer");return fe(t,e,function(){return t.bindBuffer(t.ARRAY_BUFFER,r)}),fe(t,e,function(){return t.bufferData(t.ARRAY_BUFFER,n,t.STATIC_DRAW)}),r}function aW(t,e,n){var r=To(t,e,function(){return t.createBuffer()},"Unable to create WebGLBuffer");return fe(t,e,function(){return t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,r)}),fe(t,e,function(){return t.bufferData(t.ELEMENT_ARRAY_BUFFER,n,t.STATIC_DRAW)}),r}function sW(t,e){return To(t,e,function(){return t.createTexture()},"Unable to create WebGLTexture.")}function uW(t,e){var n=G().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t<=0||e<=0){var r="["+t+"x"+e+"]";throw new Error("Requested texture size "+r+" is invalid.")}if(t>n||e>n)throw r="["+t+"x"+e+"]",new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU "+("["+n+"x"+n+"]")+".")}function cW(t,e){return To(t,e,function(){return t.createFramebuffer()},"Unable to create WebGLFramebuffer.")}function eb(t,e,n,r,o,i,a,s){var u=t.getAttribLocation(n,r);return u!==-1&&(fe(t,e,function(){return t.bindBuffer(t.ARRAY_BUFFER,o)}),fe(t,e,function(){return t.vertexAttribPointer(u,i,t.FLOAT,!1,a,s)}),fe(t,e,function(){return t.enableVertexAttribArray(u)}),!0)}function lW(t,e,n,r){mW(t,r),fe(t,e,function(){return t.activeTexture(t.TEXTURE0+r)}),fe(t,e,function(){return t.bindTexture(t.TEXTURE_2D,n)})}function dW(t,e,n,r){return To(t,e,function(){return t.getUniformLocation(n,r)},'uniform "'+r+'" not present in program.')}function fW(t,e,n){return t.getUniformLocation(e,n)}function hW(t,e,n,r,o,i){fe(t,e,function(){return lW(t,e,r,i)}),fe(t,e,function(){return t.uniform1i(o,i)})}function qp(t,e,n,r){fe(t,e,function(){return t.bindFramebuffer(t.FRAMEBUFFER,r)}),fe(t,e,function(){return t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0)})}function tb(t,e,n){fe(t,e,function(){return t.bindFramebuffer(t.FRAMEBUFFER,n)}),fe(t,e,function(){return t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,null,0)})}function zl(t){var e=t.checkFramebufferStatus(t.FRAMEBUFFER);if(e!==t.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+pW(t,e))}function pW(t,e){switch(e){case t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case t.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error "+e}}function To(t,e,n,r){var o=fe(t,e,function(){return n()});if(o==null)throw new Error(r);return o}function mW(t,e){var n=t.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=e+t.TEXTURE0;if(r<t.TEXTURE0||r>n)throw new Error("textureUnit must be in "+("[gl.TEXTURE0, gl.TEXTURE"+n+"]")+".")}function yf(t,e){return e===void 0&&(e=2),de(t.slice(0,t.length-e))}function xf(t){if(t.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[t.length>1?t[t.length-2]:1,t[t.length-1]]}function Xp(t){var e=[1,1,1];return t.length===0||t.length===1&&t[0]===1||(e=[yf(t)].concat(xf(t))),e}function vW(t,e){var n;e===void 0&&(e=!1);var r=G().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e&&(r*=2,(t=t.map(function(c,l){return l>=t.length-2?RI(t[l]):t[l]})).length===1&&(t=[2,t[0]])),t.length!==2){var o=Xi(t);t=o.newShape}var i=de(t);if(t.length<=1&&i<=r)return[1,i];if(t.length===2&&t[0]<=r&&t[1]<=r)return t;if(t.length===3&&t[0]*t[1]<=r&&t[2]<=r)return[t[0]*t[1],t[2]];if(t.length===3&&t[0]<=r&&t[1]*t[2]<=r)return[t[0],t[1]*t[2]];if(t.length===4&&t[0]*t[1]*t[2]<=r&&t[3]<=r)return[t[0]*t[1]*t[2],t[3]];if(t.length===4&&t[0]<=r&&t[1]*t[2]*t[3]<=r)return[t[0],t[1]*t[2]*t[3]];if(e){var a=yf(t),s=2,u=2;return t.length&&(s=(n=xf(t))[0],u=n[1]),jv(i=a*(s/2)*(u/2)).map(function(c){return 2*c})}return jv(i)}function Vl(t){return t%2==0}function Hl(t,e){if(At(t=t.slice(-2),e=e.slice(-2))||!t.length||!e.length||t[0]===0||t[1]===0||e[0]===0||e[1]===0)return!0;if(t.length!==e.length){var n=t.slice(-1)[0],r=e.slice(-1)[0];if(n===r||Vl(n)&&Vl(r)&&(t[0]===1||e[0]===1))return!0}return t[1]===e[1]&&Vl(t[0])&&Vl(e[0])}function gW(t){if(Hp==null){var e=Yr(t);Hp=e.getParameter(e.MAX_TEXTURE_SIZE)}return Hp}function yW(t){if(Gp==null){var e=Yr(t);Gp=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,Gp)}function xW(t){if(t===0)return 0;var e=Yr(t);return Vn(e,"EXT_disjoint_timer_query_webgl2")&&t===2?2:Vn(e,"EXT_disjoint_timer_query")?1:0}function Vn(t,e){return t.getExtension(e)!=null}function nb(t){try{if(Yr(t)!=null)return!0}catch{return!1}return!1}function wW(t){if(t===0)return!1;var e=Yr(t);if(t===1){if(!Vn(e,"OES_texture_float"))return!1}else if(!Vn(e,"EXT_color_buffer_float"))return!1;return Gv(e)}function bW(t){if(t===0)return!1;var e=Yr(t);if(t!==1){if(Vn(e,"EXT_color_buffer_float"))return Gv(e);if(Vn(e,"EXT_color_buffer_half_float")){var n=e.getExtension("EXT_color_buffer_half_float");return function(r,o){var i=Gy(r,o),a=r.createTexture();r.bindTexture(r.TEXTURE_2D,a),r.texImage2D(r.TEXTURE_2D,0,i.internalFormatHalfFloat,1,1,0,i.textureFormatFloat,i.textureTypeHalfFloat,null);var s=r.createFramebuffer();r.bindFramebuffer(r.FRAMEBUFFER,s),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,a,0);var u=r.checkFramebufferStatus(r.FRAMEBUFFER)===r.FRAMEBUFFER_COMPLETE;return r.bindTexture(r.TEXTURE_2D,null),r.bindFramebuffer(r.FRAMEBUFFER,null),r.deleteTexture(a),r.deleteFramebuffer(s),u}(e,n)}return!1}return!!Vn(e,"OES_texture_float")&&!!Vn(e,"WEBGL_color_buffer_float")&&Gv(e)}function Gv(t){var e=Gy(t),n=t.createTexture();t.bindTexture(t.TEXTURE_2D,n),t.texImage2D(t.TEXTURE_2D,0,e.internalFormatFloat,1,1,0,e.textureFormatFloat,e.textureTypeFloat,null);var r=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,r),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0);var o=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(n),t.deleteFramebuffer(r),o}function EW(t){return t===2&&Yr(t).fenceSync!=null}var we=G();function LI(t){G().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(t+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function se(t,e){return L.tidy(t,e)}function xn(t){OI(t).forEach(function(e){return e.dispose()})}function CW(t){return L.keep(t)}function wf(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];G().getBool("IS_TEST")||console.warn.apply(console,t)}function Fi(t,e){var n=t;if(zr(t))return e==="string"?[]:[t.length];if(!Array.isArray(t))return[];for(var r=[];Array.isArray(n)||zr(n)&&e!=="string";)r.push(n.length),n=n[0];return Array.isArray(t)&&G().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&function o(i,a,s){if(s=s||[],!Array.isArray(i)&&!zr(i))return void N(a.length===0,function(){return"Element arr["+s.join("][")+"] is a primitive, but should be an array/TypedArray of "+a[0]+" elements"});N(a.length>0,function(){return"Element arr["+s.join("][")+"] should be a primitive, but is an array of "+i.length+" elements"}),N(i.length===a[0],function(){return"Element arr["+s.join("][")+"] should have "+a[0]+" elements, but has "+i.length+" elements"});for(var u=a.slice(1),c=0;c<i.length;++c)o(i[c],u,s.concat(c))}(t,r,[]),r}function rb(t,e,n,r){if(t!=null&&(t!=="numeric"&&t!==e||t==="numeric"&&e==="string"))throw new Error("Argument '"+n+"' passed to '"+r+"' must be "+t+" tensor, but got "+e+" tensor")}function T(t,e,n,r){if(r===void 0&&(r="numeric"),t instanceof nt)return rb(r,t.dtype,e,n),t;var o=nl(t);if(o!=="string"&&["bool","int32","float32"].indexOf(r)>=0&&(o=r),rb(r,o,e,n),t==null||!zr(t)&&!Array.isArray(t)&&typeof t!="number"&&typeof t!="boolean"&&typeof t!="string"){var i=t==null?"null":t.constructor.name;throw new Error("Argument '"+e+"' passed to '"+n+"' must be a Tensor or TensorLike, but got '"+i+"'")}var a=Fi(t,o);zr(t)||Array.isArray(t)||(t=[t]);var s=o!=="string"?NI(t,o,G().getBool("DEBUG")):Ys(t,[],!0);return L.makeTensor(s,a,o)}function bf(t,e,n,r){if(r===void 0&&(r="numeric"),!Array.isArray(t))throw new Error("Argument "+e+" passed to "+n+" must be a `Tensor[]` or `TensorLike[]`");return t.map(function(o,i){return T(o,e+"["+i+"]",n)},r)}function BI(t,e){for(var n=0;n<t.length;++n)if(t[t.length-n-1]!==e-1-n)return!1;return!0}function _W(t,e,n){for(var r=t.length+e.length,o=[],i=0,a=0,s=0;s<r;s++)n.indexOf(s)===-1?o.push(t[i++]):o.push(e[a++]);return o}function Ht(t,e){for(var n=[],r=t.length,o=0;o<r;o++)e.indexOf(o)===-1&&n.push(t[o]);return[n,e.map(function(i){return t[i]})]}function bn(t,e){return _W(t,e.map(function(n){return 1}),e)}function _n(t,e,n){N(BI(e,n),function(){return t+" supports only inner-most axes for now. Got axes "+e+" and rank-"+n+" input."})}function Qr(t,e){if(BI(t,e))return null;for(var n=[],r=0;r<e;++r)t.indexOf(r)===-1&&n.push(r);return t.forEach(function(o){return n.push(o)}),n}function Ky(t){return t.map(function(e,n){return[n,e]}).sort(function(e,n){return e[1]-n[1]}).map(function(e){return e[0]})}function Jr(t,e){for(var n=[],r=e-t;r<e;++r)n.push(r);return n}function SW(t,e){var n=t[0].length;t.forEach(function(o,i){N(o.length===n,function(){return"Error in concat"+n+"D: rank of tensors["+i+"] must be the same as the rank of the rest ("+n+")"})}),N(e>=0&&e<n,function(){return"Error in concat"+n+"D: axis must be between 0 and "+(n-1)+"."});var r=t[0];t.forEach(function(o,i){for(var a=0;a<n;a++)N(a===e||o[a]===r[a],function(){return"Error in concat"+n+"D: Shape of tensors["+i+"] ("+o+") does not match the shape of the rest ("+r+") along the non-concatenated axis "+i+"."})})}function Js(t,e){for(var n=t[0].slice(),r=1;r<t.length;r++)n[e]+=t[r][e];return n}function O(t){var e=Object.keys(t);if(e.length!==1)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+e.length+" keys.");var n=e[0],r=t[n];n.endsWith("_")&&(n=n.substring(0,n.length-1));var o=function(){for(var i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];L.startScope(n);try{var s=r.apply(void 0,i);return s instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),L.endScope(s),s}catch(u){throw L.endScope(null),u}};return Object.defineProperty(o,"name",{value:n,configurable:!0}),o}we.registerFlag("HAS_WEBGL",function(){return we.getNumber("WEBGL_VERSION")>0}),we.registerFlag("WEBGL_VERSION",function(){return nb(2)?2:nb(1)?1:0}),we.registerFlag("WEBGL_BUFFER_SUPPORTED",function(){return we.get("WEBGL_VERSION")===2}),we.registerFlag("WEBGL_CPU_FORWARD",function(){return!0}),we.registerFlag("WEBGL_FORCE_F16_TEXTURES",function(){return!1}),we.registerFlag("WEBGL_PACK",function(){return we.getBool("HAS_WEBGL")}),we.registerFlag("WEBGL_PACK_NORMALIZATION",function(){return we.getBool("WEBGL_PACK")}),we.registerFlag("WEBGL_PACK_CLIP",function(){return we.getBool("WEBGL_PACK")}),we.registerFlag("WEBGL_PACK_DEPTHWISECONV",function(){return!1}),we.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",function(){return we.getBool("WEBGL_PACK")}),we.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",function(){return we.getBool("WEBGL_PACK")}),we.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",function(){return we.getBool("WEBGL_PACK")}),we.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",function(){return we.getBool("WEBGL_PACK")}),we.registerFlag("WEBGL_PACK_REDUCE",function(){return we.getBool("WEBGL_PACK")}),we.registerFlag("WEBGL_LAZILY_UNPACK",function(){return we.getBool("WEBGL_PACK")}),we.registerFlag("WEBGL_CONV_IM2COL",function(){return we.getBool("WEBGL_PACK")}),we.registerFlag("WEBGL_MAX_TEXTURE_SIZE",function(){return gW(we.getNumber("WEBGL_VERSION"))}),we.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",function(){return yW(we.getNumber("WEBGL_VERSION"))}),we.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",function(){var t=we.getNumber("WEBGL_VERSION");return t===0?0:xW(t)}),we.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",function(){return we.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&(t=navigator.userAgent||navigator.vendor||window.opera,!(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))));var t}),we.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",function(){return wW(we.getNumber("WEBGL_VERSION"))}),we.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",function(){return!we.getBool("WEBGL_FORCE_F16_TEXTURES")&&we.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")}),we.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",function(){return bW(we.getNumber("WEBGL_VERSION"))}),we.registerFlag("WEBGL_FENCE_API_ENABLED",function(){return EW(we.getNumber("WEBGL_VERSION"))}),we.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",function(){return we.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0}),MI=LI;var Ft=O({complex_:function(t,e){var n=T(t,"real","complex"),r=T(e,"imag","complex");return $e(n.shape,r.shape,"real and imag shapes, "+n.shape+" and "+r.shape+", must match in call to tf.complex()."),L.runKernelFunc(function(o){return o.complex(n,r)},{$real:n,$imag:r})}}),$n=O({real_:function(t){var e=T(t,"input","real");return L.runKernelFunc(function(n){return n.real(e)},{$input:e})}}),Or=O({imag_:function(t){var e=T(t,"input","imag");return L.runKernelFunc(function(n){return n.imag(e)},{$input:e})}});function Bt(t,e,n){return Li(t,e,Fi(t,n),n)}function Li(t,e,n,r){if(r==null&&(r=nl(t)),r==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!zr(t)&&!Array.isArray(t)&&typeof t!="number"&&typeof t!="boolean"&&typeof t!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(e!=null){PI(e);var o=de(e),i=de(n);N(o===i,function(){return"Based on the provided shape, ["+e+"], the tensor should have "+o+" values but has "+i});for(var a=0;a<n.length;++a){var s=n[a],u=a!==n.length-1||s!==de(e.slice(a));N(n[a]===e[a]||!u,function(){return"Error creating a new Tensor. Inferred shape ("+n+") does not match the provided shape ("+e+"). "})}}return zr(t)||Array.isArray(t)||(t=[t]),e=e||n,t=r!=="string"?NI(t,r,G().getBool("DEBUG")):Ys(t,[],!0),L.makeTensor(t,e,r)}function re(t,e){if((zr(t)&&e!=="string"||Array.isArray(t))&&e!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(e==="string"&&zr(t)&&!(t instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return Li(t,[],[],e)}function ht(t,e){lu(t);var n=Fi(t,e);if(n.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return Li(t,null,n,e)}function bi(t,e,n){if(lu(t),e!=null&&e.length!==2)throw new Error("tensor2d() requires shape to have two numbers");var r=Fi(t,n);if(r.length!==2&&r.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return Li(t,e,r,n)}function qy(t,e,n){if(lu(t),e!=null&&e.length!==3)throw new Error("tensor3d() requires shape to have three numbers");var r=Fi(t,n);if(r.length!==3&&r.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return Li(t,e,r,n)}function fn(t,e,n){if(lu(t),e!=null&&e.length!==4)throw new Error("tensor4d() requires shape to have four numbers");var r=Fi(t,n);if(r.length!==4&&r.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return Li(t,e,r,n)}function kW(t,e,n){if(lu(t),e!=null&&e.length!==5)throw new Error("tensor5d() requires shape to have five numbers");var r=Fi(t,n);if(r.length!==5&&r.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return Li(t,e,r,n)}function IW(t,e,n){if(lu(t),e!=null&&e.length!==6)throw new Error("tensor6d() requires shape to have six numbers");var r=Fi(t,n);if(r.length!==6&&r.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return Li(t,e=e||r,r,n)}function RW(t,e,n,r){return e===void 0&&(e=!0),L.makeVariable(t,e,n,r)}function du(t,e){if(e===void 0&&(e="float32"),e==="complex64"){var n=du(t,"float32"),r=Ye(t,"float32");return Ft(n,r)}var o=AI(de(t),e);return L.makeTensor(o,t,e)}function Ye(t,e){if(e===void 0&&(e="float32"),e==="complex64"){var n=Ye(t,"float32"),r=Ye(t,"float32");return Ft(n,r)}var o=rl(de(t),e);return L.makeTensor(o,t,e)}function Hr(t,e,n){return L.runKernelFunc(function(r){return r.fill(t,e,n)},{})}function TW(t,e,n){if(n<=0)throw new Error("The number of values should be positive.");return L.runKernelFunc(function(r){return r.linspace(t,e,n)},{})}function Ef(t,e,n,r){if(n===void 0&&(n=1),r===void 0&&(r="float32"),n===0)throw new Error("Cannot have a step of zero");if(t===e||t<e&&n<0||e<t&&n>1)return Ye([0],r);var o=rl(Math.abs(Math.ceil((e-t)/n)),r);e<t&&n===1&&(n=-1),o[0]=t;for(var i=1;i<o.length;i++)o[i]=o[i-1]+n;return ht(o,r)}var jI=O({onesLike_:function(t){var e=T(t,"x","onesLike");if(e.dtype==="complex64"){var n=jI($n(e)),r=Fe(Or(e));return Ft(n,r)}return L.runKernelFunc(function(o){return o.onesLike(e)},{$x:e},function(o,i){return{$x:function(){return Fe(o)}}})}}),Fe=O({zerosLike_:function(t){var e=T(t,"x","zerosLike");return L.runKernelFunc(function(n){return n.zerosLike(e)},{$x:e},function(n,r){return{$x:function(){return Fe(n)}}})}}),wt=O({concat_:function(t,e){e===void 0&&(e=0),N(t.length>=1,function(){return"Pass at least one tensor to concat"});var n=bf(t,"tensors","concat");n[0].dtype==="complex64"&&n.forEach(function(s){if(s.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype `+s.dtype+". ")}),e=_t(e,n[0].shape)[0];var r=Js(n.map(function(s){return s.shape}),e);if(de(r)===0)return Bt([],r);if((n=n.filter(function(s){return s.size>0})).length===1)return n[0];var o=n.map(function(s){return s.shape});SW(o,e);var i=n,a={axis:e};return L.runKernelFunc(function(s){return s.concat(n,e)},i,function(s){var u=o.map(function(c){return c[e]});return Xy(s,u,e).map(function(c){return function(){return c}})},"Concat",a)}}),NW=O({concat1d_:function(t){return wt(t,0)}}),AW=O({concat2d_:function(t,e){return wt(t,e)}}),PW=O({concat3d_:function(t,e){return wt(t,e)}}),DW=O({concat4d_:function(t,e){return wt(t,e)}}),Xy=O({split_:function(t,e,n){n===void 0&&(n=0);var r,o=T(t,"x","split");return n=_t(n,o.shape)[0],typeof e=="number"?(N(o.shape[n]%e==0,function(){return"Number of splits must evenly divide the axis."}),r=new Array(e).fill(o.shape[n]/e)):(N(o.shape[n]===e.reduce(function(i,a){return i+a}),function(){return"The sum of sizes must match the size of the axis dimension."}),r=e),L.runKernelFunc(function(i){return i.split(o,r,n)},{$x:o},function(i){return{$x:function(){return wt(i,n)}}})}});function Ra(t,e){return t(e={exports:{}},e.exports),e.exports}var MW=Ra(function(t){(function(e,n,r){function o(s){var u,c=this,l=(u=4022871197,function(d){d=d.toString();for(var f=0;f<d.length;f++){var h=.02519603282416938*(u+=d.charCodeAt(f));h-=u=h>>>0,u=(h*=u)>>>0,u+=4294967296*(h-=u)}return 23283064365386963e-26*(u>>>0)});c.next=function(){var d=2091639*c.s0+23283064365386963e-26*c.c;return c.s0=c.s1,c.s1=c.s2,c.s2=d-(c.c=0|d)},c.c=1,c.s0=l(" "),c.s1=l(" "),c.s2=l(" "),c.s0-=l(s),c.s0<0&&(c.s0+=1),c.s1-=l(s),c.s1<0&&(c.s1+=1),c.s2-=l(s),c.s2<0&&(c.s2+=1),l=null}function i(s,u){return u.c=s.c,u.s0=s.s0,u.s1=s.s1,u.s2=s.s2,u}function a(s,u){var c=new o(s),l=u&&u.state,d=c.next;return d.int32=function(){return 4294967296*c.next()|0},d.double=function(){return d()+11102230246251565e-32*(2097152*d()|0)},d.quick=d,l&&(typeof l=="object"&&i(l,c),d.state=function(){return i(c,{})}),d}n&&n.exports?n.exports=a:this.alea=a})(0,t)}),OW=Ra(function(t){(function(e,n,r){function o(s){var u=this,c="";u.x=0,u.y=0,u.z=0,u.w=0,u.next=function(){var d=u.x^u.x<<11;return u.x=u.y,u.y=u.z,u.z=u.w,u.w^=u.w>>>19^d^d>>>8},s===(0|s)?u.x=s:c+=s;for(var l=0;l<c.length+64;l++)u.x^=0|c.charCodeAt(l),u.next()}function i(s,u){return u.x=s.x,u.y=s.y,u.z=s.z,u.w=s.w,u}function a(s,u){var c=new o(s),l=u&&u.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var f=((c.next()>>>11)+(c.next()>>>0)/4294967296)/2097152;while(f===0);return f},d.int32=c.next,d.quick=d,l&&(typeof l=="object"&&i(l,c),d.state=function(){return i(c,{})}),d}n&&n.exports?n.exports=a:this.xor128=a})(0,t)}),FW=Ra(function(t){(function(e,n,r){function o(s){var u=this,c="";u.next=function(){var d=u.x^u.x>>>2;return u.x=u.y,u.y=u.z,u.z=u.w,u.w=u.v,(u.d=u.d+362437|0)+(u.v=u.v^u.v<<4^d^d<<1)|0},u.x=0,u.y=0,u.z=0,u.w=0,u.v=0,s===(0|s)?u.x=s:c+=s;for(var l=0;l<c.length+64;l++)u.x^=0|c.charCodeAt(l),l==c.length&&(u.d=u.x<<10^u.x>>>4),u.next()}function i(s,u){return u.x=s.x,u.y=s.y,u.z=s.z,u.w=s.w,u.v=s.v,u.d=s.d,u}function a(s,u){var c=new o(s),l=u&&u.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var f=((c.next()>>>11)+(c.next()>>>0)/4294967296)/2097152;while(f===0);return f},d.int32=c.next,d.quick=d,l&&(typeof l=="object"&&i(l,c),d.state=function(){return i(c,{})}),d}n&&n.exports?n.exports=a:this.xorwow=a})(0,t)}),LW=Ra(function(t){(function(e,n,r){function o(s){var u=this;u.next=function(){var c,l,d=u.x,f=u.i;return c=d[f],l=(c^=c>>>7)^c<<24,l^=(c=d[f+1&7])^c>>>10,l^=(c=d[f+3&7])^c>>>3,l^=(c=d[f+4&7])^c<<7,c=d[f+7&7],l^=(c^=c<<13)^c<<9,d[f]=l,u.i=f+1&7,l},function(c,l){var d,f=[];if(l===(0|l))f[0]=l;else for(l=""+l,d=0;d<l.length;++d)f[7&d]=f[7&d]<<15^l.charCodeAt(d)+f[d+1&7]<<13;for(;f.length<8;)f.push(0);for(d=0;d<8&&f[d]===0;++d);for(d==8?f[7]=-1:f[d],c.x=f,c.i=0,d=256;d>0;--d)c.next()}(u,s)}function i(s,u){return u.x=s.x.slice(),u.i=s.i,u}function a(s,u){s==null&&(s=+new Date);var c=new o(s),l=u&&u.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var f=((c.next()>>>11)+(c.next()>>>0)/4294967296)/2097152;while(f===0);return f},d.int32=c.next,d.quick=d,l&&(l.x&&i(l,c),d.state=function(){return i(c,{})}),d}n&&n.exports?n.exports=a:this.xorshift7=a})(0,t)}),BW=Ra(function(t){(function(e,n,r){function o(s){var u=this;u.next=function(){var c,l,d=u.w,f=u.X,h=u.i;return u.w=d=d+1640531527|0,l=f[h+34&127],c=f[h=h+1&127],l^=l<<13,c^=c<<17,l^=l>>>15,c^=c>>>12,l=f[h]=l^c,u.i=h,l+(d^d>>>16)|0},function(c,l){var d,f,h,m,p,g=[],v=128;for(l===(0|l)?(f=l,l=null):(l+="\0",f=0,v=Math.max(v,l.length)),h=0,m=-32;m<v;++m)l&&(f^=l.charCodeAt((m+32)%l.length)),m===0&&(p=f),f^=f<<10,f^=f>>>15,f^=f<<4,f^=f>>>13,m>=0&&(p=p+1640531527|0,h=(d=g[127&m]^=f+p)==0?h+1:0);for(h>=128&&(g[127&(l&&l.length||0)]=-1),h=127,m=512;m>0;--m)f=g[h+34&127],d=g[h=h+1&127],f^=f<<13,d^=d<<17,f^=f>>>15,d^=d>>>12,g[h]=f^d;c.w=p,c.X=g,c.i=h}(u,s)}function i(s,u){return u.i=s.i,u.w=s.w,u.X=s.X.slice(),u}function a(s,u){s==null&&(s=+new Date);var c=new o(s),l=u&&u.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var f=((c.next()>>>11)+(c.next()>>>0)/4294967296)/2097152;while(f===0);return f},d.int32=c.next,d.quick=d,l&&(l.X&&i(l,c),d.state=function(){return i(c,{})}),d}n&&n.exports?n.exports=a:this.xor4096=a})(0,t)}),jW=Ra(function(t){(function(e,n,r){function o(s){var u=this,c="";u.next=function(){var d=u.b,f=u.c,h=u.d,m=u.a;return d=d<<25^d>>>7^f,f=f-h|0,h=h<<24^h>>>8^m,m=m-d|0,u.b=d=d<<20^d>>>12^f,u.c=f=f-h|0,u.d=h<<16^f>>>16^m,u.a=m-d|0},u.a=0,u.b=0,u.c=-1640531527,u.d=1367130551,s===Math.floor(s)?(u.a=s/4294967296|0,u.b=0|s):c+=s;for(var l=0;l<c.length+20;l++)u.b^=0|c.charCodeAt(l),u.next()}function i(s,u){return u.a=s.a,u.b=s.b,u.c=s.c,u.d=s.d,u}function a(s,u){var c=new o(s),l=u&&u.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var f=((c.next()>>>11)+(c.next()>>>0)/4294967296)/2097152;while(f===0);return f},d.int32=c.next,d.quick=d,l&&(typeof l=="object"&&i(l,c),d.state=function(){return i(c,{})}),d}n&&n.exports?n.exports=a:this.tychei=a})(0,t)}),Ki=Ra(function(t){(function(e,n){var r,o=this,i=256,a=6,s="random",u=n.pow(i,a),c=n.pow(2,52),l=2*c,d=i-1;function f(v,y,x){var b=[],E=p(function k(R,I){var D,A=[],W=typeof R;if(I&&W=="object")for(D in R)try{A.push(k(R[D],I-1))}catch{}return A.length?A:W=="string"?R:R+"\0"}((y=y==1?{entropy:!0}:y||{}).entropy?[v,g(e)]:v??function(){try{var k;return r&&(k=r.randomBytes)?k=k(i):(k=new Uint8Array(i),(o.crypto||o.msCrypto).getRandomValues(k)),g(k)}catch{var R=o.navigator,I=R&&R.plugins;return[+new Date,o,I,o.screen,g(e)]}}(),3),b),_=new h(b),S=function(){for(var k=_.g(a),R=u,I=0;k<c;)k=(k+I)*i,R*=i,I=_.g(1);for(;k>=l;)k/=2,R/=2,I>>>=1;return(k+I)/R};return S.int32=function(){return 0|_.g(4)},S.quick=function(){return _.g(4)/4294967296},S.double=S,p(g(_.S),e),(y.pass||x||function(k,R,I,D){return D&&(D.S&&m(D,_),k.state=function(){return m(_,{})}),I?(n[s]=k,R):k})(S,E,"global"in y?y.global:this==n,y.state)}function h(v){var y,x=v.length,b=this,E=0,_=b.i=b.j=0,S=b.S=[];for(x||(v=[x++]);E<i;)S[E]=E++;for(E=0;E<i;E++)S[E]=S[_=d&_+v[E%x]+(y=S[E])],S[_]=y;(b.g=function(k){for(var R,I=0,D=b.i,A=b.j,W=b.S;k--;)R=W[D=d&D+1],I=I*i+W[d&(W[D]=W[A=d&A+R])+(W[A]=R)];return b.i=D,b.j=A,I})(i)}function m(v,y){return y.i=v.i,y.j=v.j,y.S=v.S.slice(),y}function p(v,y){for(var x,b=v+"",E=0;E<b.length;)y[d&E]=d&(x^=19*y[d&E])+b.charCodeAt(E++);return g(y)}function g(v){return String.fromCharCode.apply(0,v)}if(n["seed"+s]=f,p(n.random(),e),t.exports){t.exports=f;try{r=require("crypto")}catch{}}})([],Math)});Ki.alea=MW,Ki.xor128=OW,Ki.xorwow=FW,Ki.xorshift7=LW,Ki.xor4096=BW,Ki.tychei=jW;var Sh=Ki.alea,Yy=function(){function t(e,n,r,o,i){this.mean=e,this.stdDev=n,this.dtype=r,this.nextVal=NaN,this.truncated=o,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);var a=i||Math.random();this.random=Sh(a.toString())}return t.prototype.nextValue=function(){if(!isNaN(this.nextVal)){var e=this.nextVal;return this.nextVal=NaN,e}for(var n,r,o=!1;!o;){var i=void 0,a=void 0,s=void 0;do s=(i=2*this.random()-1)*i+(a=2*this.random()-1)*a;while(s>=1||s===0);var u=Math.sqrt(-2*Math.log(s)/s);n=this.mean+this.stdDev*i*u,r=this.mean+this.stdDev*a*u,this.truncated&&!this.isValidTruncated(n)||(o=!0)}return this.truncated&&!this.isValidTruncated(r)||(this.nextVal=this.convertValue(r)),this.convertValue(n)},t.prototype.convertValue=function(e){return this.dtype==null||this.dtype==="float32"?e:Math.round(e)},t.prototype.isValidTruncated=function(e){return e<=this.upper&&e>=this.lower},t}(),UW=function(){function t(e,n,r,o){this.alpha=e,this.beta=1/n,this.dtype=r;var i=o||Math.random();this.randu=Sh(i.toString()),this.randn=new Yy(0,1,r,!1,this.randu()),this.d=e<1?e+2/3:e-1/3,this.c=1/Math.sqrt(9*this.d)}return t.prototype.nextValue=function(){for(var e,n,r,o,i,a;;){do o=this.randn.nextValue(),a=1+this.c*o;while(a<=0);if(a*=a*a,n=1-.331*(e=o*o)*e,r=.5*e+this.d*(1-a+Math.log(a)),(i=this.randu())<n||Math.log(i)<r)break}return a=1/this.beta*this.d*a,this.alpha<1&&(a*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(a)},t.prototype.convertValue=function(e){return this.dtype==="float32"?e:Math.round(e)},t}(),WW=function(){function t(e,n,r,o){var i=this;if(e===void 0&&(e=0),n===void 0&&(n=1),this.canReturnFloat=function(){return i.dtype==null||i.dtype==="float32"},this.min=e,this.range=n-e,this.dtype=r,o==null&&(o=Math.random()),typeof o=="number"&&(o=o.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between "+e+" - "+n+" <= 1 and dtype is not float");this.random=Sh(o)}return t.prototype.convertValue=function(e){return this.canReturnFloat()?e:Math.round(e)},t.prototype.nextValue=function(){return this.convertValue(this.min+this.range*this.random())},t}();function Ce(t,e,n){return e===void 0&&(e="float32"),e=e||"float32",PI(t),new Ic(t,e,n)}function $W(t,e){e===void 0&&(e=!1),console.log(t.toString(e))}var UI=O({batchToSpaceND_:function(t,e,n){var r=T(t,"x","batchToSpaceND"),o=e.reduce(function(i,a){return i*a});return N(r.rank>=1+e.length,function(){return"input rank is "+r.rank+" but should be > than blockShape.length "+e.length}),N(n.length===e.length,function(){return"crops.length is "+n.length+" but should be equal to blockShape.length  "+e.length}),N(r.shape[0]%o==0,function(){return"input tensor batch is "+r.shape[0]+" but is not divisible by the product of the elements of blockShape "+e.join(" * ")+" === "+o}),L.runKernelFunc(function(i){return i.batchToSpaceND(r,e,n)},{$x:r},function(i){return{$x:function(){return i.spaceToBatchND(e,n)}}})}}),zW=O({broadcastTo_:function(t,e){var n=T(t,"broadcastTo","x"),r=n.shape;if(e.some(function(u){return!(u>0)||u%1!=0}))throw new Error("broadcastTo(): Invalid broadcast shape ["+e+"].");if(e.length<n.rank)throw new Error("broadcastTo(): shape.length="+e.length+" < input.rank="+n.rank+".");if(e.length>n.rank){for(var o=n.shape.slice();o.length<e.length;)o.unshift(1);n=n.reshape(o)}for(var i=Array.from(e),a=e.length-1;a>=0;a--)if(n.shape[a]===e[a])i[a]=1;else if(n.shape[a]!==1)throw new Error("broadcastTo(): ["+r+"] cannot be broadcast to ["+e+"].");var s=i.map(function(u,c){return u>1?c:-1}).filter(function(u){return u>=0});return s.length===0?n.clone():L.runKernelFunc(function(u){return u.tile(n,i)},{input:n},function(u){return{input:function(){return u.sum(s,!0)}}})}}),VW=O({cast_:function(t,e){var n=T(t,"x","cast");if(!FU(e))throw new Error("Failed to cast to unknown dtype "+e);if(e==="string"&&n.dtype!=="string"||e!=="string"&&n.dtype==="string")throw new Error("Only strings can be casted to strings");var r={dtype:e};return L.runKernelFunc(function(o){return o.cast(n,e)},{x:n},function(o){return{x:function(){return o.clone()}}},"Cast",r)}}),HW=O({clone_:function(t){var e=T(t,"x","clone",null);return L.runKernelFunc(function(){return L.makeTensorFromDataId(e.dataId,e.shape,e.dtype)},{$x:e},function(n){return{$x:function(){return n.toFloat()}}})}}),GW=O({cumsum_:function(t,e,n,r){e===void 0&&(e=0),n===void 0&&(n=!1),r===void 0&&(r=!1);var o=T(t,"x","cumsum"),i=Qr([e|=0],o.rank),a=o;i!=null&&(a=o.transpose(i));var s=Jr(1,o.rank)[0],u=L.runKernelFunc(function(c){return c.cumsum(a,s,n,r)},{permutedX:a},function(c){return{permutedX:function(){return c.cumsum(e,n,!r)}}});return i!=null&&(u=u.transpose(i)),u}}),KW=O({depthToSpace_:function(t,e,n){n===void 0&&(n="NHWC");var r=T(t,"x","depthToSpace"),o=n==="NHWC"?r.shape[1]:r.shape[2],i=n==="NHWC"?r.shape[2]:r.shape[3],a=n==="NHWC"?r.shape[3]:r.shape[1];return N(o*e>=0,function(){return`Negative dimension size caused by overflow when multiplying
      `+o+" and "+e+`  for depthToSpace with input shape
      `+r.shape}),N(i*e>=0,function(){return`Negative dimension size caused by overflow when multiplying
      `+i+" and "+e+` for depthToSpace with input shape
          `+r.shape}),N(a%(e*e)==0,function(){return"Dimension size must be evenly divisible by "+e*e+" but is "+a+" for depthToSpace with input shape "+r.shape}),L.runKernelFunc(function(s){return s.depthToSpace(r,e,n)},{$x:r})}}),Wn=O({expandDims_:function(t,e){e===void 0&&(e=0);var n=T(t,"x","expandDims",null);N(e<=n.rank,function(){return"Axis must be <= rank of the tensor"});var r=n.shape.slice();return e<0&&(N(-(n.rank+1)<=e,function(){return"Axis must be in the interval ["+-(n.rank+1)+", "+n.rank+"]"}),e=n.rank+e+1),r.splice(e,0,1),fr(n,r)}}),WI=O({eye_:function(t,e,n,r){r===void 0&&(r="float32"),e==null&&(e=t);for(var o=Ce([t,e],r),i=t<=e?t:e,a=0;a<i;++a)o.set(1,a,a);var s=o.toTensor().as2D(t,e);if(n==null)return s;if(n.length===1)return bs(Wn(s,0),[n[0],1,1]);if(n.length===2)return bs(Wn(Wn(s,0),0),[n[0],n[1],1,1]);if(n.length===3)return bs(Wn(Wn(Wn(s,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error("eye() currently supports only 1D and 2D batchShapes, but received "+n.length+"D.")}}),qW=O({multinomial_:function(t,e,n,r){r===void 0&&(r=!1);var o=T(t,"logits","multinomial"),i=o.size,a=o.rank;if(i<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+i+".");if(a>2)throw new Error("Rank of probabilities must be 1 or 2, but is "+a);n=n||Math.random();var s=a===1?o.as2D(1,-1):o,u=L.runKernelFunc(function(c){return c.multinomial(s,r,e,n)},{logits2D:s});return a===1?u.as1D():u}}),Kv=O({oneHot_:function(t,e,n,r){if(n===void 0&&(n=1),r===void 0&&(r=0),e<2)throw new Error("Error in oneHot: depth must be >=2, but it is "+e);var o=T(t,"indices","oneHot","int32"),i=o.shape.concat([e]);return o=o.flatten(),L.runKernelFunc(function(a){return a.oneHot(o,e,n,r)},{$indices:o},function(a){return{$indices:function(){return Ye(o.shape,"float32")}}}).reshape(i)}}),Ta=O({pad_:function(t,e,n){n===void 0&&(n=0);var r=T(t,"x","pad");if(r.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");var o={paddings:e,constantValue:n};return L.runKernelFunc(function(i){return i.pad(r,e,n)},{x:r},function(i){var a=e.map(function(s){return s[0]});return{x:function(){return i.slice(a,r.shape)}}},"PadV2",o)}}),XW=O({pad1d_:function(t,e,n){return n===void 0&&(n=0),N(e.length===2,function(){return"Invalid number of paddings. Must be length of 2."}),Ta(t,[e],n)}}),YW=O({pad2d_:function(t,e,n){return n===void 0&&(n=0),N(e.length===2&&e[0].length===2&&e[1].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),Ta(t,e,n)}}),QW=O({pad3d_:function(t,e,n){return n===void 0&&(n=0),N(e.length===3&&e[0].length===2&&e[1].length===2&&e[2].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),Ta(t,e,n)}}),JW=O({pad4d_:function(t,e,n){return n===void 0&&(n=0),N(e.length===4&&e[0].length===2&&e[1].length===2&&e[2].length===2&&e[3].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),Ta(t,e,n)}}),ZW=O({rand_:function(t,e,n){var r=de(t),o=null;if(n==null||n==="float32")o=new Float32Array(r);else if(n==="int32")o=new Int32Array(r);else{if(n!=="bool")throw new Error("Unknown data type "+n);o=new Uint8Array(r)}for(var i=0;i<r;i++)o[i]=e();return L.makeTensor(o,t,n)}}),e$=O({randomNormal_:function(t,e,n,r,o){if(e===void 0&&(e=0),n===void 0&&(n=1),r!=null&&r==="bool")throw new Error("Unsupported data type "+r);for(var i=new Yy(e,n,r,!1,o),a=Ce(t,r),s=0;s<a.values.length;s++)a.values[s]=i.nextValue();return a.toTensor()}}),t$=O({randomGamma_:function(t,e,n,r,o){if(n===void 0&&(n=1),r===void 0&&(r="float32"),n==null&&(n=1),r==null&&(r="float32"),r!=="float32"&&r!=="int32")throw new Error("Unsupported data type "+r);for(var i=new UW(e,n,r,o),a=Ce(t,r),s=0;s<a.values.length;s++)a.values[s]=i.nextValue();return a.toTensor()}}),$I=O({randomUniform_:function(t,e,n,r,o){e===void 0&&(e=0),n===void 0&&(n=1),r===void 0&&(r="float32");for(var i=Ce(t,r),a=new WW(e,n,null,o),s=0;s<i.values.length;s++)i.values[s]=a.nextValue();return i.toTensor()}}),fr=O({reshape_:function(t,e){var n=T(t,"x","reshape",null);e=MU(e,n.size),N(n.size===de(e),function(){return"new shape and old shape must have the same number of elements."});var r={shape:e};return L.runKernelFunc(function(o){return o.reshape(n,e)},{x:n},function(o){return{x:function(){return o.reshape(n.shape)}}},"Reshape",r)}}),zI=O({spaceToBatchND_:function(t,e,n){var r=T(t,"x","spaceToBatchND");return N(r.rank>=1+e.length,function(){return"input rank "+r.rank+" should be > than [blockShape] "+e.length}),N(n.length===e.length,function(){return"paddings.shape[0] "+n.length+" must be equal to [blockShape] "+e.length}),N(r.shape.reduce(function(o,i,a){return a>0&&a<=e.length?o&&(i+n[a-1][0]+n[a-1][1])%e[a-1]==0:o},!0),function(){return"input spatial dimensions "+r.shape.slice(1)+" with paddings "+n.toString()+" must be divisible by blockShapes "+e.toString()}),L.runKernelFunc(function(o){return o.spaceToBatchND(r,e,n)},{$x:r},function(o){return{$x:function(){return o.batchToSpaceND(e,n)}}})}}),VI=O({squeeze_:function(t,e){var n=T(t,"x","squeeze");return fr(n,Xi(n.shape,e).newShape)}}),Mn=O({stack_:function(t,e){e===void 0&&(e=0);var n=bf(t,"tensors","stack");if(N(n.length>=1,function(){return"Pass at least one tensor to tf.stack"}),n.length===1)return n[0].expandDims(e);var r=n[0].rank,o=n[0].shape,i=n[0].dtype;N(e<=r,function(){return"Axis must be <= rank of the tensor"}),n.forEach(function(s){$e(o,s.shape,"All tensors passed to stack must have matching shapes")}),n.forEach(function(s){N(i===s.dtype,function(){return"All tensors passed to stack must have matching dtypes"})});var a=n.map(function(s){return s.expandDims(e)});return wt(a,e)}}),bs=O({tile_:function(t,e){var n=T(t,"x","tile",null);N(n.rank===e.length,function(){return"Error in transpose: rank of input "+n.rank+" must match length of reps "+e+"."});var r=[n],o={reps:e};return L.runKernelFunc(function(i,a){var s=i.tile(n,e);return a([n]),s},{x:n},function(i,a){var s=a[0];return{x:function(){var u=Fe(s);if(s.rank===1)for(var c=0;c<e[0];++c)u=u.add(i.slice([c*s.shape[0]],[s.shape[0]]));else if(s.rank===2)for(c=0;c<e[0];++c)for(var l=0;l<e[1];++l)u=u.add(i.slice([c*s.shape[0],l*s.shape[1]],[s.shape[0],s.shape[1]]));else if(s.rank===3)for(c=0;c<e[0];++c)for(l=0;l<e[1];++l)for(var d=0;d<e[2];++d)u=u.add(i.slice([c*s.shape[0],l*s.shape[1],d*s.shape[2]],[s.shape[0],s.shape[1],s.shape[2]]));else{if(s.rank!==4)throw new Error("Gradient for tile operation is not implemented for rank-"+s.rank+" tensors yet.");for(c=0;c<e[0];++c)for(l=0;l<e[1];++l)for(d=0;d<e[2];++d)for(var f=0;f<e[3];++f)u=u.add(i.slice([c*s.shape[0],l*s.shape[1],d*s.shape[2],f*s.shape[3]],[s.shape[0],s.shape[1],s.shape[2],s.shape[3]]))}return u}}},"Tile",o,r)}}),n$=O({truncatedNormal_:function(t,e,n,r,o){if(e===void 0&&(e=0),n===void 0&&(n=1),r!=null&&r==="bool")throw new Error("Unsupported data type "+r);for(var i=new Yy(e,n,r,!0,o),a=Ce(t,r),s=0;s<a.values.length;s++)a.values[s]=i.nextValue();return a.toTensor()}}),bt=O({unstack_:function(t,e){e===void 0&&(e=0),e=e||0;var n=T(t,"x","unstack");N(e>=-n.shape.length&&e<n.shape.length,function(){return"Axis = "+e+" is not in [-"+n.shape.length+", "+n.shape.length+")"}),e<0&&(e+=n.shape.length);var r={axis:e};return L.runKernelFunc(function(o){return o.unstack(n,e)},{x:n},function(o){return{x:function(){return Mn(o,e)}}},"Unpack",r)}}),r$=function(t,e){return ce(this,void 0,void 0,function(){var n,r,o,i,a,s,u,c,l,d;return le(this,function(f){switch(f.label){case 0:return n=T(t,"x","setdiff1d"),r=T(e,"y","setdiff1d"),N(n.dtype===r.dtype,function(){return"x and y should have the same dtype, but got x ("+n.dtype+") and y ("+r.dtype+")."}),N(n.rank===1,function(){return"x should be 1D tensor, but got x ("+n.shape+")."}),N(r.rank===1,function(){return"y should be 1D tensor, but got y ("+r.shape+")."}),[4,n.data()];case 1:return o=f.sent(),[4,r.data()];case 2:for(i=f.sent(),a=new Set(i),s=0,l=0;l<o.length;l++)a.has(o[l])||s++;for(u=new Ic([s],n.dtype),c=new Ic([s],"int32"),l=0,d=0;l<o.length;l++)a.has(o[l])||(u.values[d]=o[l],c.values[d]=l,d++);return[2,[u.toTensor(),c.toTensor()]]}})})};function Cf(t,e,n,r){r===void 0&&(r=!0);var o=[];if(r)(o=o.concat(e.slice(0))).push(t[0]/n),o=o.concat(t.slice(1));else{o=o.concat(t[0]);for(var i=e.length,a=0;a<i;++a)o=o.concat([t[a+1]/e[a],e[a]]);o=o.concat(t.slice(i+1))}return o}function _f(t,e,n){n===void 0&&(n=!0);var r=[];if(n){r.push(e);for(var o=e+1;o<t;++o)o<=2*e?(r.push(o),r.push(o-(e+1))):r.push(o)}else{var i=[],a=[];for(o=1;o<t;++o)o>=2*e+1||o%2==1?a.push(o):i.push(o);r.push.apply(r,i),r.push(0),r.push.apply(r,a)}return r}function Sf(t,e,n,r){r===void 0&&(r=!0);var o=[];r?o.push(t[0]/n):o.push(t[0]*n);for(var i=1;i<t.length;++i)i<=e.length?r?o.push(e[i-1]*t[i]):o.push(t[i]/e[i-1]):o.push(t[i]);return o}function HI(t,e){for(var n=[0],r=0;r<e;++r)n.push(t[r][0]);return n}function GI(t,e,n){for(var r=t.slice(0,1),o=0;o<n;++o)r.push(t[o+1]-e[o][0]-e[o][1]);return r}function KI(t,e){if(t.rank<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher, but the rank was "+t.rank+".");if(e.rank<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher, but the rank was "+e.rank+".");if(e.dtype!=="int32")throw new Error("tf.gatherND() expects the indices to be int32 type, but the dtype was "+e.dtype+".");if(e.shape[e.rank-1]>t.rank)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+e.shape[e.rank-1]+" vs. "+t.rank);if(t.size===0)throw new Error("Requested more than 0 entries, but input is empty. Input shape: "+t.shape+".");for(var n=e.shape,r=n[n.length-1],o=1,i=0;i<n.length-1;++i)o*=n[i];var a=t.shape,s=n.slice();s.pop();var u=1;for(i=r;i<t.rank;++i)u*=a[i],s.push(a[i]);var c=Vr(t.shape).map(function(l){return l/u}).concat([1]).slice(0,r);return[s,o,u,c]}var qI=30;function Yp(t){return t<=qI?t:Wv(t,Math.floor(Math.sqrt(t)))}function o$(t,e,n){var r=e.rank>1?e.shape[e.rank-1]:1,o=e.rank>1?e.rank-1:1,i="Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: "+n.shape+", indices.shape: "+e.shape+", shape: "+t+", sliceDim: "+r+", and batchDim: "+o+".";if(n.rank<o)throw new Error(i+" update.rank < "+o+". ");if(t.length<r+(n.rank-o))throw new Error(i+" Output shape length < "+(r+(n.rank-o)));if(n.rank!==o+t.length-r)throw new Error(i+" update.rank != "+(o+t.length-r));for(var a=0;a<o;++a)if(n.shape[a]!==e.shape[a])throw new Error(i+" updates.shape["+a+"] ("+n.shape[a]+") != indices.shape["+a+"] ("+e.shape[a]+").");for(a=0;a<n.rank-o;++a)if(n.shape[a+o]!==t[a+r])throw new Error(i+" updates.shape["+(a+o)+"] ("+n.shape[a+o]+") != shape["+(a+o)+"] ("+t[a+o]+")")}function i$(t,e,n){if(e.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher, but the rank was "+e.rank+".");if(t.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher, but the rank was "+t.rank+".");if(e.dtype!=="int32")throw new Error("The dtype of 'indices' should be int32, but got dtype: "+e.dtype);if(n.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: "+n);if(n.length===0){if(e.size===0)throw new Error("Indices specified for empty output. indices shape: "+e.shape);if(t.size===0)throw new Error("Updates specified for empty output. updates shape: "+t.shape)}o$(n,e,t)}function kf(t,e,n){for(var r=e.shape.length,o=r>1?e.shape[r-1]:1,i=n.length,a=1,s=o;s<i;++s)a*=n[s];var u=o<1?1:o;return{sliceRank:o,numUpdates:de(e.shape)/u,sliceSize:a,strides:Vr(n.slice(0,o)).concat([1]),outputSize:de(n)}}function a$(t,e,n){N(t.rank===e.length,function(){return"Error in slice"+t.rank+"D: Length of begin "+e+" must match the rank of the array ("+t.rank+")."}),N(t.rank===n.length,function(){return"Error in slice"+t.rank+"D: Length of size "+n+" must match the rank of the array ("+t.rank+")."});for(var r=function(i){N(e[i]+n[i]<=t.shape[i],function(){return"Error in slice"+t.rank+"D: begin["+i+"] + size["+i+"] ("+(e[i]+n[i])+") would overflow input.shape["+i+"] ("+t.shape[i]+")"})},o=0;o<t.rank;++o)r(o)}function ob(t){for(var e=[],n=0;t>0;)1&t&&e.push(n),t/=2,n++;return e}function Qy(t,e,n){for(var r=[],o=0;o<t.length;o++)r[o]=Math.ceil((e[o]-t[o])/n[o]);return r}function s$(t,e,n,r,o){var i=e[o],a=n[o]||1;(t&1<<o||i==null)&&(i=a>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);var s=r[o];return i<0&&(i+=s),i=Bv(0,i,s-1)}function u$(t,e,n,r,o){var i=e[o],a=n[o]||1;(t&1<<o||i==null)&&(i=a>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);var s=r[o];return i<0&&(i+=s),i=a>0?Bv(0,i,s):Bv(-1,i,s-1)}function XI(t,e,n){for(var r=n.length,o=0;o<n.length;o++)if(n[o]>1){r=o;break}for(o=r+1;o<n.length;o++)if(e[o]>0||n[o]!==t[o])return!1;return!0}function YI(t,e){for(var n=t.length>0?t[t.length-1]:1,r=0;r<t.length-1;r++)n+=t[r]*e[r];return n}function c$(t,e){N(Uv(t),function(){return"The f passed in variableGrads(f) must be a function"}),N(e==null||Array.isArray(e)&&e.every(function(l){return l instanceof Qs}),function(){return"The varList passed in variableGrads(f, varList) must be an array of variables"});var n=e!=null;if(!n)for(var r in e=[],L.registeredVariables)e.push(L.registeredVariables[r]);var o=n?e.filter(function(l){return!l.trainable}):null,i=e.length;N((e=e.filter(function(l){return l.trainable})).length>0,function(){return"variableGrads() expects at least one of the input variables to be trainable, but none of the "+i+" variables is trainable."});var a=L.gradients(t,e,null,!0),s=a.value,u=a.grads;N(u.some(function(l){return l!=null}),function(){return"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."}),N(s.rank===0,function(){return"The f passed in variableGrads(f) must return a scalar, but it returned a rank-"+s.rank+" tensor"});var c={};return e.forEach(function(l,d){u[d]!=null&&(c[l.name]=u[d])}),o!=null&&o.forEach(function(l){return c[l.name]=null}),{value:s,grads:c}}function kh(t){return L.customGrad(t)}var No=O({softmax_:function(t,e){e===void 0&&(e=-1);var n=T(t,"logits","softmax","float32");if(e===-1&&(e=n.rank-1),e!==n.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. Logits was rank "+n.rank+" and dim was "+e);return L.runKernelFunc(function(r,o){var i=r.softmax(n,e);return o([i]),i},{logits:n},function(r,o){var i=o[0],a=r.mul(i);return{logits:function(){return a.sub(a.sum([e],!0).mul(i))}}},"Softmax",{dim:e},[],[!0])}}),l$=O({logSoftmax_:function(t,e){e===void 0&&(e=-1);var n=T(t,"logits","logSoftmax");if(e===-1&&(e=n.rank-1),e!==n.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. Logits was rank "+n.rank+" and axis was "+e);return kh(function(r,o){var i=r.max(e,!0),a=r.sub(i),s=a.toFloat().sub(a.exp().sum(e,!0).log());return o([s]),{value:s,gradFunc:function(u,c){var l=c[0].exp();return u.sub(u.sum(e,!0).mul(l))}}})(n)}}),QI=function(){function t(e,n){this.backend=e,this.dataMover=n,this.data=new WeakMap,this.dataIdsCount=0}return t.prototype.get=function(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)},t.prototype.set=function(e,n){this.dataIdsCount++,this.data.set(e,n)},t.prototype.has=function(e){return this.data.has(e)},t.prototype.delete=function(e){return this.dataIdsCount--,this.data.delete(e)},t.prototype.numDataIds=function(){return this.dataIdsCount},t}(),JI=function(){function t(){}return t.prototype.time=function(e){return z("time")},t.prototype.read=function(e){return z("read")},t.prototype.readSync=function(e){return z("readSync")},t.prototype.numDataIds=function(){return z("numDataIds")},t.prototype.disposeData=function(e){return z("disposeData")},t.prototype.write=function(e,n,r){return z("write")},t.prototype.move=function(e,n,r,o){return z("move")},t.prototype.memory=function(){return z("memory")},t.prototype.floatPrecision=function(){return z("floatPrecision")},t.prototype.epsilon=function(){return this.floatPrecision()===32?1e-7:1e-4},t.prototype.batchMatMul=function(e,n,r,o){return z("batchMatMul")},t.prototype.fusedBatchMatMul=function(e){return e.a,e.b,e.transposeA,e.transposeB,e.bias,e.activation,e.preluActivationWeights,z("fusedBatchMatMul")},t.prototype.slice=function(e,n,r){return z("slice")},t.prototype.stridedSlice=function(e,n,r,o){return z("stridedSlice")},t.prototype.unstack=function(e,n){return z("unstack")},t.prototype.reverse=function(e,n){return z("reverse")},t.prototype.concat=function(e,n){return z("concat")},t.prototype.neg=function(e){return z("neg")},t.prototype.add=function(e,n){return z("add")},t.prototype.addN=function(e){return z("addN")},t.prototype.subtract=function(e,n){return z("subtract")},t.prototype.multiply=function(e,n){return z("multiply")},t.prototype.realDivide=function(e,n){return z("realDivide")},t.prototype.floorDiv=function(e,n){return z("floorDiv")},t.prototype.sum=function(e,n){return z("sum")},t.prototype.prod=function(e,n){return z("prod")},t.prototype.unsortedSegmentSum=function(e,n,r){return z("unsortedSegmentSum")},t.prototype.argMin=function(e,n){return z("argMin")},t.prototype.argMax=function(e,n){return z("argMax")},t.prototype.equal=function(e,n){return z("equal")},t.prototype.notEqual=function(e,n){return z("notEqual")},t.prototype.less=function(e,n){return z("less")},t.prototype.lessEqual=function(e,n){return z("lessEqual")},t.prototype.greater=function(e,n){return z("greater")},t.prototype.greaterEqual=function(e,n){return z("greaterEqual")},t.prototype.logicalNot=function(e){return z("logicalNot")},t.prototype.logicalAnd=function(e,n){return z("logicalAnd")},t.prototype.logicalOr=function(e,n){return z("logicalOr")},t.prototype.where=function(e){return z("where")},t.prototype.select=function(e,n,r){return z("select")},t.prototype.topk=function(e,n,r){return z("topk")},t.prototype.min=function(e,n){return z("min")},t.prototype.minimum=function(e,n){return z("minimum")},t.prototype.mod=function(e,n){return z("mod")},t.prototype.max=function(e,n){return z("max")},t.prototype.maximum=function(e,n){return z("maximum")},t.prototype.all=function(e,n){return z("all")},t.prototype.any=function(e,n){return z("any")},t.prototype.squaredDifference=function(e,n){return z("squaredDifference")},t.prototype.ceil=function(e){return z("ceil")},t.prototype.floor=function(e){return z("floor")},t.prototype.round=function(e){return z("round")},t.prototype.sign=function(e){return z("sign")},t.prototype.isNaN=function(e){return z("isNaN")},t.prototype.isInf=function(e){return z("isInf")},t.prototype.isFinite=function(e){return z("isFinite")},t.prototype.pow=function(e,n){return z("pow")},t.prototype.exp=function(e){return z("exp")},t.prototype.expm1=function(e){return z("expm1")},t.prototype.softmax=function(e,n){return z("softmax")},t.prototype.log=function(e){return z("log")},t.prototype.log1p=function(e){return z("log1p")},t.prototype.sqrt=function(e){return z("sqrt")},t.prototype.rsqrt=function(e){return z("rsqrt")},t.prototype.square=function(e){return z("square")},t.prototype.reciprocal=function(e){return z("reciprocal")},t.prototype.relu=function(e){return z("relu")},t.prototype.relu6=function(e){return z("relu6")},t.prototype.prelu=function(e,n){return z("prelu")},t.prototype.elu=function(e){return z("elu")},t.prototype.eluDer=function(e,n){return z("eluDer")},t.prototype.selu=function(e){return z("selu")},t.prototype.int=function(e){return z("int")},t.prototype.clip=function(e,n,r){return z("clip")},t.prototype.abs=function(e){return z("abs")},t.prototype.complexAbs=function(e){return z("complexAbs")},t.prototype.sigmoid=function(e){return z("sigmoid")},t.prototype.softplus=function(e){return z("softplus")},t.prototype.sin=function(e){return z("sin")},t.prototype.cos=function(e){return z("cos")},t.prototype.tan=function(e){return z("tan")},t.prototype.asin=function(e){return z("asin")},t.prototype.acos=function(e){return z("acos")},t.prototype.atan=function(e){return z("atan")},t.prototype.atan2=function(e,n){return z("atan2")},t.prototype.sinh=function(e){return z("sinh")},t.prototype.cosh=function(e){return z("cosh")},t.prototype.tanh=function(e){return z("tanh")},t.prototype.asinh=function(e){return z("asinh")},t.prototype.acosh=function(e){return z("acosh")},t.prototype.atanh=function(e){return z("atanh")},t.prototype.erf=function(e){return z("erf")},t.prototype.step=function(e,n){return z("step")},t.prototype.fusedConv2d=function(e){return e.input,e.filter,e.convInfo,e.bias,e.activation,e.preluActivationWeights,z("fusedConv2d")},t.prototype.conv2d=function(e,n,r){return z("conv2d")},t.prototype.conv2dDerInput=function(e,n,r){return z("conv2dDerInput")},t.prototype.conv2dDerFilter=function(e,n,r){return z("conv2dDerFilter")},t.prototype.fusedDepthwiseConv2D=function(e){return e.input,e.filter,e.convInfo,e.bias,e.activation,e.preluActivationWeights,z("fusedDepthwiseConv2D")},t.prototype.depthwiseConv2D=function(e,n,r){return z("depthwiseConv2D")},t.prototype.depthwiseConv2DDerInput=function(e,n,r){return z("depthwiseConv2DDerInput")},t.prototype.depthwiseConv2DDerFilter=function(e,n,r){return z("depthwiseConv2DDerFilter")},t.prototype.conv3d=function(e,n,r){return z("conv3d")},t.prototype.conv3dDerInput=function(e,n,r){return z("conv3dDerInput")},t.prototype.conv3dDerFilter=function(e,n,r){return z("conv3dDerFilter")},t.prototype.maxPool=function(e,n){return z("maxPool")},t.prototype.maxPoolBackprop=function(e,n,r,o){return z("maxPoolBackprop")},t.prototype.avgPool=function(e,n){return z("avgPool")},t.prototype.avgPoolBackprop=function(e,n,r){return z("avgPoolBackprop")},t.prototype.avgPool3d=function(e,n){return z("avgPool3d")},t.prototype.avgPool3dBackprop=function(e,n,r){return z("avgPool3dBackprop")},t.prototype.maxPool3d=function(e,n){return z("maxPool3d")},t.prototype.maxPool3dBackprop=function(e,n,r,o){return z("maxPool3dBackprop")},t.prototype.reshape=function(e,n){return z("reshape")},t.prototype.cast=function(e,n){return z("cast")},t.prototype.tile=function(e,n){return z("tile")},t.prototype.pad=function(e,n,r){return z("pad")},t.prototype.transpose=function(e,n){return z("transpose")},t.prototype.gather=function(e,n,r){return z("gather")},t.prototype.gatherND=function(e,n){return z("gatherND")},t.prototype.scatterND=function(e,n,r){return z("scatterND")},t.prototype.batchToSpaceND=function(e,n,r){return z("batchToSpaceND")},t.prototype.spaceToBatchND=function(e,n,r){return z("spaceToBatchND")},t.prototype.resizeBilinear=function(e,n,r,o){return z("resizeBilinear")},t.prototype.resizeBilinearBackprop=function(e,n,r){return z("resizeBilinearBackprop")},t.prototype.resizeNearestNeighbor=function(e,n,r,o){return z("resizeNearestNeighbor")},t.prototype.resizeNearestNeighborBackprop=function(e,n,r){return z("resizeNearestNeighborBackprop")},t.prototype.batchNormalization=function(e,n,r,o,i,a){return z("batchNormalization")},t.prototype.localResponseNormalization4D=function(e,n,r,o,i){return z("localResponseNormalization4D")},t.prototype.LRNGrad=function(e,n,r,o,i,a,s){return z("LRNGrad")},t.prototype.multinomial=function(e,n,r,o){return z("multinomial")},t.prototype.oneHot=function(e,n,r,o){return z("oneHot")},t.prototype.cumsum=function(e,n,r,o){return z("cumsum")},t.prototype.nonMaxSuppression=function(e,n,r,o,i){return z("nonMaxSuppression")},t.prototype.fft=function(e){return z("fft")},t.prototype.ifft=function(e){return z("ifft")},t.prototype.complex=function(e,n){return z("complex")},t.prototype.real=function(e){return z("real")},t.prototype.imag=function(e){return z("imag")},t.prototype.cropAndResize=function(e,n,r,o,i,a){return z("cropAndResize")},t.prototype.depthToSpace=function(e,n,r){return z("depthToSpace")},t.prototype.split=function(e,n,r){return z("split")},t.prototype.sparseToDense=function(e,n,r,o){return z("sparseToDense")},t.prototype.diag=function(e){return z("diag")},t.prototype.fill=function(e,n,r){return z("fill")},t.prototype.onesLike=function(e){return z("onesLike")},t.prototype.zerosLike=function(e){return z("zerosLike")},t.prototype.linspace=function(e,n,r){return z("linspace")},t.prototype.dispose=function(){return z("dispose")},t}();function z(t){throw new Error("'"+t+"' not yet implemented or not found in the registry. Did you forget to import the kernel?")}function ui(t,e){for(var n=t.length,r=[],o=0;o<n;o++){var i=n-1-o,a=t[i]||1;(e[e.length-1-o]||1)>1&&a===1&&r.unshift(i)}return r}function Et(t,e){for(var n=[],r=0;r<e.length;r++){var o=t[t.length-r-1],i=e.length-r-1,a=e[i];(o==null||o===1&&a>1)&&n.unshift(i)}return n}function Pe(t,e){for(var n=[],r=Math.max(t.length,e.length),o=0;o<r;o++){var i=t[t.length-o-1];i==null&&(i=1);var a=e[e.length-o-1];if(a==null&&(a=1),i===1)n.unshift(a);else if(a===1)n.unshift(i);else{if(i!==a)throw Error("Operands could not be broadcast together with shapes "+t+" and "+e+".");n.unshift(i)}}return n}function Tc(t,e,n,r,o,i,a){a===void 0&&(a="channelsLast");var s,u=Tf(e),c=u[0],l=u[1];if(a==="channelsLast")s=[c,l,t[3],t[3]];else{if(a!=="channelsFirst")throw new Error("Unknown dataFormat "+a);s=[c,l,t[1],t[1]]}return Na(t,s,n,r,o,i,!1,a)}function If(t,e,n,r,o,i,a){a===void 0&&(a="NDHWC");var s,u,c=qv(e),l=c[0],d=c[1],f=c[2];if(a==="NDHWC")u="channelsLast",s=[l,d,f,t[4],t[4]];else{if(a!=="NCDHW")throw new Error("Unknown dataFormat "+a);u="channelsFirst",s=[l,d,f,t[1],t[1]]}return Rf(t,s,n,r,o,!1,u,i)}function Na(t,e,n,r,o,i,a,s){a===void 0&&(a=!1),s===void 0&&(s="channelsLast");var u=[-1,-1,-1,-1],c=u[0],l=u[1],d=u[2],f=u[3];if(s==="channelsLast")c=t[0],l=t[1],d=t[2],f=t[3];else{if(s!=="channelsFirst")throw new Error("Unknown dataFormat "+s);c=t[0],f=t[1],l=t[2],d=t[3]}var h,m=e[0],p=e[1],g=e[3],v=Tf(n),y=v[0],x=v[1],b=Tf(r),E=b[0],_=b[1],S=Es(m,E),k=Es(p,_),R=function(F,$,j,U,M,P,B,V){var K,Q,te;if(typeof F=="number"){K={top:F,bottom:F,left:F,right:F,type:F===0?"VALID":"NUMBER"};var ae=function(ee,ye,ge,Ne,Me){Ne==null&&(Ne=ZI(ee,ye,ge));var Oe=ee[0],Mt=ee[1],mt=Ku((Oe-ye+2*Ne)/ge+1,Me);N(dt(mt),function(){return"The output # of rows ("+mt+") must be an integer. Change the stride and/or zero pad parameters"});var et=Ku((Mt-ye+2*Ne)/ge+1,Me);return N(dt(et),function(){return"The output # of columns ("+et+") must be an integer. Change the stride and/or zero pad parameters"}),[mt,et]}([$,j],P,U,F,V);Q=ae[0],te=ae[1]}else if(F==="same"){Q=Math.ceil($/U),te=Math.ceil(j/M);var X=Math.max(0,(Q-1)*U+P-$),J=Math.max(0,(te-1)*M+B-j),ie=Math.floor(X/2),oe=X-ie,me=Math.floor(J/2);K={top:ie,bottom:oe,left:me,right:J-me,type:"SAME"}}else{if(F!=="valid")throw Error("Unknown padding parameter: "+F);K={top:0,bottom:0,left:0,right:0,type:"VALID"},Q=Math.ceil(($-P+1)/U),te=Math.ceil((j-B+1)/M)}return{padInfo:K,outHeight:Q,outWidth:te}}(o,l,d,y,x,S,k,i),I=R.padInfo,D=R.outHeight,A=R.outWidth,W=a?g*f:g;return s==="channelsFirst"?h=[c,W,D,A]:s==="channelsLast"&&(h=[c,D,A,W]),{batchSize:c,dataFormat:s,inHeight:l,inWidth:d,inChannels:f,outHeight:D,outWidth:A,outChannels:W,padInfo:I,strideHeight:y,strideWidth:x,filterHeight:m,filterWidth:p,effectiveFilterHeight:S,effectiveFilterWidth:k,dilationHeight:E,dilationWidth:_,inShape:t,outShape:h,filterShape:e}}function Rf(t,e,n,r,o,i,a,s){i===void 0&&(i=!1),a===void 0&&(a="channelsLast");var u=[-1,-1,-1,-1,-1],c=u[0],l=u[1],d=u[2],f=u[3],h=u[4];if(a==="channelsLast")c=t[0],l=t[1],d=t[2],f=t[3],h=t[4];else{if(a!=="channelsFirst")throw new Error("Unknown dataFormat "+a);c=t[0],h=t[1],l=t[2],d=t[3],f=t[4]}var m,p=e[0],g=e[1],v=e[2],y=e[4],x=qv(n),b=x[0],E=x[1],_=x[2],S=qv(r),k=S[0],R=S[1],I=S[2],D=Es(p,k),A=Es(g,R),W=Es(v,I),F=function(B,V,K,Q,te,ae,X,J,ie,oe,me){var ee,ye,ge,Ne;if(typeof B=="number"){ee={top:B,bottom:B,left:B,right:B,front:B,back:B,type:B===0?"VALID":"NUMBER"};var Me=function(Er,cn,We,kt,It,eo){It==null&&(It=ZI(Er,cn,kt));var Da=Er[0],$h=Er[1],fl=Er[2],ji=Ku((Da-cn+2*It)/kt+1,eo);N(dt(ji),function(){return"The output # of depths ("+ji+") must be an integer. Change the stride and/or zero pad parameters"});var Cr=Ku(($h-cn+2*It)/kt+1,eo);N(dt(Cr),function(){return"The output # of rows ("+Cr+") must be an integer. Change the stride and/or zero pad parameters"});var Ma=Ku((fl-cn+2*It)/kt+1,eo);return N(dt(Ma),function(){return"The output # of columns ("+Ma+") must be an integer. Change the stride and/or zero pad parameters"}),[ji,Cr,Ma,We]}([V,K,Q,1],J,1,te,B,me);ye=Me[0],ge=Me[1],Ne=Me[2]}else if(B==="same"){ye=Math.ceil(V/te),ge=Math.ceil(K/ae),Ne=Math.ceil(Q/X);var Oe=(ye-1)*te+J-V,Mt=(ge-1)*ae+ie-K,mt=(Ne-1)*X+oe-Q,et=Math.floor(Oe/2),Qn=Oe-et,vt=Math.floor(Mt/2),Zt=Mt-vt,St=Math.floor(mt/2);ee={top:vt,bottom:Zt,left:St,right:mt-St,front:et,back:Qn,type:"SAME"}}else{if(B!=="valid")throw Error("Unknown padding parameter: "+B);ee={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},ye=Math.ceil((V-J+1)/te),ge=Math.ceil((K-ie+1)/ae),Ne=Math.ceil((Q-oe+1)/X)}return{padInfo:ee,outDepth:ye,outHeight:ge,outWidth:Ne}}(o,l,d,f,b,E,_,D,A,W,s),$=F.padInfo,j=F.outDepth,U=F.outHeight,M=F.outWidth,P=i?y*h:y;return a==="channelsFirst"?m=[c,P,j,U,M]:a==="channelsLast"&&(m=[c,j,U,M,P]),{batchSize:c,dataFormat:a,inDepth:l,inHeight:d,inWidth:f,inChannels:h,outDepth:j,outHeight:U,outWidth:M,outChannels:P,padInfo:$,strideDepth:b,strideHeight:E,strideWidth:_,filterDepth:p,filterHeight:g,filterWidth:v,effectiveFilterDepth:D,effectiveFilterHeight:A,effectiveFilterWidth:W,dilationDepth:k,dilationHeight:R,dilationWidth:I,inShape:t,outShape:m,filterShape:e}}function ZI(t,e,n,r){r===void 0&&(r=1);var o=Es(e,r);return Math.floor((t[0]*(n-1)-n+o)/2)}function Tf(t){return typeof t=="number"?[t,t,t]:t.length===2?[t[0],t[1],1]:t}function qv(t){return typeof t=="number"?[t,t,t]:t}function Es(t,e){return e<=1?t:t+(t-1)*(e-1)}function Ku(t,e){if(!e)return t;switch(e){case"round":return Math.round(t);case"ceil":return Math.ceil(t);case"floor":return Math.floor(t);default:throw new Error("Unknown roundingMode "+e)}}function Zs(t){var e=Tf(t),n=e[0],r=e[1],o=e[2];return n===1&&r===1&&o===1}function En(t,e){return Zs(t)||Zs(e)}function Jy(t){if(t==="NHWC")return"channelsLast";if(t==="NCHW")return"channelsFirst";throw new Error("Unknown dataFormat "+t)}function eR(t,e,n){if(e==="complex64"){if(t.dtype==="complex64")return t.clone();var r=Ye(t.shape),o=t.toFloat(),i=n.complex(o,r);return r.dispose(),o.dispose(),i}if(!LU(t.dtype,e))return L.makeTensorFromDataId(t.dataId,t.shape,e);if(t.dtype==="complex64"){var a=n.real(t);return i=a.cast(e),a.dispose(),i}if(e==="int32")return n.int(t);if(e==="bool"){var s=re(0,t.dtype);return i=n.notEqual(t,s),s.dispose(),i}throw new Error("Error in Cast: failed to cast "+t.dtype+" to "+e)}function Xv(t,e){return L.makeTensorFromDataId(t.dataId,e,t.dtype)}function tR(t,e,n){var r=(e-t)/(n-1),o=rl(n,"float32");o[0]=t;for(var i=1;i<o.length;i++)o[i]=o[i-1]+r;return ht(o,"float32")}function Yv(t,e){if(t.length!==e.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+t.length+", imag: "+e.length+".");for(var n=new Float32Array(2*t.length),r=0;r<n.length;r+=2)n[r]=t[r/2],n[r+1]=e[r/2];return n}function ib(t,e){return{real:t[2*e],imag:t[2*e+1]}}function d$(t,e,n,r){t[2*r]=e,t[2*r+1]=n}function f$(t,e,n){var r=(n?2:-2)*Math.PI*(t/e);return{real:Math.cos(r),imag:Math.sin(r)}}function h$(t,e,n){var r=function(i,a,s){return function(u,c,l){for(var d=0,f=u.length,h=0,m=!1;d<f;){var p=l(c,u[h=d+(f-d>>>1)]);p>0?d=h+1:(f=h,m=!p)}return m?d:-d-1}(i,a,s||p$)}(t,e,n),o=r<0?-(r+1):r;t.splice(o,0,e)}function p$(t,e){return t>e?1:t<e?-1:0}function Zy(t,e,n,r,o){return nR(t,e,n,r,o,0).selectedIndices}function e0(t,e,n,r,o,i){var a=nR(t,e,n,r,o,i);return a.numValidOutputs.dispose(),{selectedIndices:a.selectedIndices,selectedScores:a.selectedScores}}function nR(t,e,n,r,o,i,a,s){s===void 0&&(s=!1);for(var u=Array.from(e).map(function(b,E){return{score:b,boxIndex:E,suppressBeginIndex:0}}).filter(function(b){return b.score>o}).sort(ab),c=i>0?-.5/i:0,l=[],d=[];l.length<n&&u.length>0;){var f=u.pop(),h=f.score,m=f.boxIndex,p=f.suppressBeginIndex;if(h<o)break;for(var g=!1,v=l.length-1;v>=p;--v){var y=m$(t,m,l[v]);if(y>=r){g=!0;break}if(f.score=f.score*v$(r,c,y),f.score<=o)break}f.suppressBeginIndex=l.length,g||(f.score===h?(l.push(m),d.push(f.score)):f.score>o&&h$(u,f,ab))}var x=l.length;return s&&(l.fill(0,x),d.fill(0,x)),{selectedIndices:ht(l,"int32"),selectedScores:ht(d,"float32"),numValidOutputs:re(x,"int32")}}function m$(t,e,n){var r=t.subarray(4*e,4*e+4),o=t.subarray(4*n,4*n+4),i=Math.min(r[0],r[2]),a=Math.min(r[1],r[3]),s=Math.max(r[0],r[2]),u=Math.max(r[1],r[3]),c=Math.min(o[0],o[2]),l=Math.min(o[1],o[3]),d=Math.max(o[0],o[2]),f=Math.max(o[1],o[3]),h=(s-i)*(u-a),m=(d-c)*(f-l);if(h<=0||m<=0)return 0;var p=Math.max(i,c),g=Math.max(a,l),v=Math.min(s,d),y=Math.min(u,f),x=Math.max(v-p,0)*Math.max(y-g,0);return x/(h+m-x)}function v$(t,e,n){var r=Math.exp(e*n*n);return n<=t?r:0}function ab(t,e){return t.score-e.score||t.score===e.score&&e.boxIndex-t.boxIndex}function rR(t,e,n){var r=new Array(t.rank).fill(0),o=t.shape.slice();return e.map(function(i){o[n]=i;var a=t.slice(r,o);return r[n]+=i,a})}function oR(t,e){for(var n=new Array(t.rank),r=0;r<n.length;r++)n[r]=t.shape[r]*e[r];var o=Ce(n,t.dtype);for(r=0;r<o.values.length;++r){for(var i=o.indexToLoc(r),a=new Array(t.rank),s=0;s<a.length;s++)a[s]=i[s]%t.shape[s];var u=t.locToIndex(a);o.values[r]=t.values[u]}return o.toTensor()}function iR(t,e,n,r,o){for(var i=e[e.length-1],a=[t.length/i,i],s=a[0],u=a[1],c=kc(n,s*r),l=kc("int32",s*r),d=0;d<s;d++){for(var f=d*u,h=t.subarray(f,f+u),m=[],p=0;p<h.length;p++)m.push({value:h[p],index:p});m.sort(function(b,E){return E.value-b.value});var g=d*r,v=c.subarray(g,g+r),y=l.subarray(g,g+r);for(p=0;p<r;p++)v[p]=m[p].value,y[p]=m[p].index}var x=e.slice();return x[x.length-1]=r,[Bt(c,x,n),Bt(l,x,"int32")]}function t0(t,e){for(var n=[],r=0;r<e.length;r++)e[r]&&n.push(r);var o=Ce(t,"int32"),i=Ce([n.length,t.length],"int32");for(r=0;r<n.length;r++){var a=o.indexToLoc(n[r]),s=r*t.length;i.values.set(a,s)}return i.toTensor()}var g$=function(t,e){this.outputShape=[],this.outputShape=t,this.variableNames=e.map(function(o,i){return"T"+i});var n=[];this.variableNames.forEach(function(o){n.push("float v"+o+" = get"+o+"AtOutCoords();")});var r=this.variableNames.map(function(o){return"v"+o}).join(" + ");this.userCode=`
      void main() {
        `+n.join(`
        `)+`

        float result = `+r+`;
        setOutput(result);
      }
    `},y$=function(t,e){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.variableNames=e.map(function(o,i){return"T"+i});var n=[];this.variableNames.forEach(function(o){n.push("vec4 v"+o+" = get"+o+"AtOutCoords();")});var r=this.variableNames.map(function(o){return"v"+o}).join(" + ");this.userCode=`
      void main() {
        `+n.join(`
        `)+`

        vec4 result = `+r+`;
        setOutput(result);
      }
    `},x$=function(t,e,n){this.variableNames=["A"];var r=t.windowSize,o=t.batchSize,i=t.inSize,a=Math.ceil(i/r);n||this.variableNames.push("bestIndicesA"),this.outputShape=[o,a];var s=e==="max"?">":"<",u=n?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * `+r+`;

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < `+r+`; i++) {
          int inIdx = `+u+`;
          float candidate = getA(batch, inIdx);
          if (candidate `+s+` bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `};function aR(t,e){return["x","y","z","w","u","v"].slice(0,e).map(function(n){return t+"."+n})}function pn(t,e){return e===1?[t]:aR(t,e)}function qt(){var t,e,n,r,o,i,a,s,u,c;return G().getNumber("WEBGL_VERSION")===2?(t="#version 300 es",e="in",n="out",r="in",o="texture",i="outputColor",a="out vec4 outputColor;",s=`
      bool isnan_custom(float val) {
        return (val > 0.0 || val < 0.0) ? false : val != 0.0;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `,u="",c=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(t="",e="attribute",n="varying",r="varying",o="texture2D",i="gl_FragColor",a="",s=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,u=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,c=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:t,attribute:e,varyingVs:n,varyingFs:r,texture2D:o,output:i,defineOutput:a,defineSpecialNaN:s,defineSpecialInf:u,defineRound:c}}function Zi(t,e,n){n===void 0&&(n="index");var r=Vr(e);return r.map(function(o,i){return"int "+t[i]+" = "+n+" / "+o+"; "+(i===r.length-1?"int "+t[i+1]+" = "+n+" - "+t[i]+" * "+o:"index -= "+t[i]+" * "+o)+";"}).join("")}function n0(t){var e=Vr(t).map(function(n){return n.toString()});return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * `+e[0]+" + coords.y * "+e[1]+` + coords.z;
  }
`}var sR=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;function w$(t,e,n,r){var o=[];t.forEach(function(h){var m=de(h.shapeInfo.logicalShape);h.shapeInfo.isUniform?o.push("uniform float "+h.name+(m>1?"["+m+"]":"")+";"):(o.push("uniform sampler2D "+h.name+";"),o.push("uniform int offset"+h.name+";"))});var i,a,s=o.join(`
`),u=t.map(function(h){return function(m,p,g){g===void 0&&(g=!1);var v="";v+=g?uR(m):Va(m);var y=m.shapeInfo.logicalShape,x=p.logicalShape;return y.length<=x.length&&(v+=g?function(b,E){var _,S=b.name,k=S.charAt(0).toUpperCase()+S.slice(1),R="get"+k+"AtOutCoords",I=b.shapeInfo.logicalShape.length,D=E.logicalShape.length,A=ui(b.shapeInfo.logicalShape,E.logicalShape),W=Ke(D),F=D-I,$=["x","y","z","w","u","v"];_=I===0?"":D<2&&A.length>=1?"coords = 0;":A.map(function(K){return"coords."+$[K+F]+" = 0;"}).join(`
`);var j="";j=D<2&&I>0?"coords":b.shapeInfo.logicalShape.map(function(K,Q){return"coords."+$[Q+F]}).join(", ");var U="return outputValue;",M=de(b.shapeInfo.logicalShape)===1,P=de(E.logicalShape)===1;if(I!==1||M||P){if(M&&!P)U=D===1?`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:`
        return vec4(outputValue.x);
      `;else if(A.length){var B=I-2,V=I-1;A.indexOf(B)>-1&&A.indexOf(V)>-1?U="return vec4(outputValue.x);":A.indexOf(B)>-1?U="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":A.indexOf(V)>-1&&(U="return vec4(outputValue.xx, outputValue.zz);")}}else U=`
      return vec4(outputValue.xy, outputValue.xy);
    `;return`
    vec4 `+R+`() {
      `+W+` coords = getOutputCoords();
      `+_+`
      vec4 outputValue = get`+k+"("+j+`);
      `+U+`
    }
  `}(m,p):function(b,E){var _=b.name,S=_.charAt(0).toUpperCase()+_.slice(1),k="get"+S+"AtOutCoords",R=E.texShape,I=b.shapeInfo.texShape,D=b.shapeInfo.logicalShape.length,A=E.logicalShape.length;if(!b.shapeInfo.isUniform&&D===A&&b.shapeInfo.flatOffset==null&&At(I,R))return`
      float `+k+`() {
        return sampleTexture(`+_+`, resultUV);
      }
    `;var W,F=Ke(A),$=ui(b.shapeInfo.logicalShape,E.logicalShape),j=A-D,U=["x","y","z","w","u","v"];W=D===0?"":A<2&&$.length>=1?"coords = 0;":$.map(function(P){return"coords."+U[P+j]+" = 0;"}).join(`
`);var M="";return M=A<2&&D>0?"coords":b.shapeInfo.logicalShape.map(function(P,B){return"coords."+U[B+j]}).join(", "),`
    float `+k+`() {
      `+F+` coords = getOutputCoords();
      `+W+`
      return get`+S+"("+M+`);
    }
  `}(m,p)),v}(h,e,r)}).join(`
`),c=e.texShape,l=qt(),d=function(h){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return `+h.texture2D+`(textureSampler, uv).r;
    }
  `}(l),f=function(h){return h.version+`
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    `+h.varyingFs+` vec2 resultUV;
    `+h.defineOutput+`
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    `+h.defineSpecialNaN+`
    `+h.defineSpecialInf+`
    `+h.defineRound+`

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    `+b$+`
    `+E$+`
    `+C$+`
  `}(l);return e.isPacked?(i=function(h,m){switch(h.length){case 0:return`
    int getOutputCoords() {
      return 0;
    }
  `;case 1:return function(b,E){var _=[Math.ceil(E[0]/2),Math.ceil(E[1]/2)];return _[0]===1?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * `+_[1]+`.0);
      }
    `:_[1]===1?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * `+_[0]+`.0);
      }
    `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+_[0]+", "+_[1]+`));
      return 2 * (resTexRC.x * `+_[1]+` + resTexRC.y);
    }
  `}(0,m);case 2:return function(b,E){var _=[Math.ceil(E[0]/2),Math.ceil(E[1]/2)];if(At(b,E))return`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(`+_[0]+", "+_[1]+`));
      }
    `;var S=Math.ceil(b[1]/2);return`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+_[0]+", "+_[1]+`));

      int index = resTexRC.x * `+_[1]+` + resTexRC.y;
      int r = 2 * (index / `+S+`);
      int c = imod(index, `+S+`) * 2;

      return ivec2(r, c);
    }
  `}(h,m);case 3:return p=h,g=m,v=[Math.ceil(g[0]/2),Math.ceil(g[1]/2)],y=Math.ceil(p[2]/2),x=y*Math.ceil(p[1]/2),`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+v[0]+", "+v[1]+`));
      int index = resTexRC.x * `+v[1]+` + resTexRC.y;

      int b = index / `+x+`;
      index -= b * `+x+`;

      int r = 2 * (index / `+y+`);
      int c = imod(index, `+y+`) * 2;

      return ivec3(b, r, c);
    }
  `;default:return function(b,E){for(var _=[Math.ceil(E[0]/2),Math.ceil(E[1]/2)],S=Math.ceil(b[b.length-1]/2),k=S*Math.ceil(b[b.length-2]/2),R=k,I="",D="b, r, c",A=2;A<b.length-1;A++)R*=b[b.length-A-1],I=`
      int b`+A+" = index / "+R+`;
      index -= b`+A+" * "+R+`;
    `+I,D="b"+A+", "+D;return`
    ivec`+b.length+` getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+_[0]+", "+_[1]+`));
      int index = resTexRC.x * `+_[1]+` + resTexRC.y;

      `+I+`

      int b = index / `+k+`;
      index -= b * `+k+`;

      int r = 2 * (index / `+S+`);
      int c = imod(index, `+S+`) * 2;

      return ivec`+b.length+"("+D+`);
    }
  `}(h,m)}var p,g,v,y,x}(e.logicalShape,c),a=function(h){return`
    void setOutput(vec4 val) {
      `+h.output+` = val;
    }
  `}(l)):(i=function(h,m){switch(h.length){case 0:return`
    int getOutputCoords() {
      return 0;
    }
  `;case 1:return function(v,y){return y[0]===1?`
      int getOutputCoords() {
        return int(resultUV.x * `+y[1]+`.0);
      }
    `:y[1]===1?`
      int getOutputCoords() {
        return int(resultUV.y * `+y[0]+`.0);
      }
    `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+y[0]+", "+y[1]+`));
      return resTexRC.x * `+y[1]+` + resTexRC.y;
    }
  `}(0,m);case 2:return function(v,y){return At(v,y)?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(`+y[0]+", "+y[1]+`));
      }
    `:v[1]===1?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(`+y[0]+", "+y[1]+`));
        int index = resTexRC.x * `+y[1]+` + resTexRC.y;
        return ivec2(index, 0);
      }
    `:v[0]===1?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(`+y[0]+", "+y[1]+`));
        int index = resTexRC.x * `+y[1]+` + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+y[0]+", "+y[1]+`));
      int index = resTexRC.x * `+y[1]+` + resTexRC.y;
      int r = index / `+v[1]+`;
      int c = index - r * `+v[1]+`;
      return ivec2(r, c);
    }
  `}(h,m);case 3:return p=m,g=Zi(["r","c","d"],h),`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+p[0]+", "+p[1]+`));
      int index = resTexRC.x * `+p[1]+` + resTexRC.y;
      `+g+`
      return ivec3(r, c, d);
    }
  `;case 4:return function(v,y){var x=Zi(["r","c","d","d2"],v);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(`+y[0]+", "+y[1]+`));
      int index = resTexRC.x * `+y[1]+` + resTexRC.y;
      `+x+`
      return ivec4(r, c, d, d2);
    }
  `}(h,m);case 5:return function(v,y){var x=Zi(["r","c","d","d2","d3"],v);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(`+y[0]+`,
                             `+y[1]+`));

      int index = resTexRC.x * `+y[1]+` + resTexRC.y;

      `+x+`

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}(h,m);case 6:return function(v,y){var x=Zi(["r","c","d","d2","d3","d4"],v);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(`+y[0]+", "+y[1]+`));
      int index = resTexRC.x * `+y[1]+` + resTexRC.y;

      `+x+`

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}(h,m);default:throw new Error(h.length+"-D output sampling is not yet supported")}var p,g}(e.logicalShape,c),a=function(h){return`
    void setOutput(float val) {
      `+h.output+` = vec4(val, 0, 0, 0);
    }
  `}(l)),r&&(f+=_$),[f,d,a,s,i,u,n].join(`
`)}function Va(t){var e=t.shapeInfo.logicalShape;switch(e.length){case 0:return function(n){var r=n.name,o="get"+r.charAt(0).toUpperCase()+r.slice(1);if(n.shapeInfo.isUniform)return"float "+o+"() {return "+r+";}";var i=n.shapeInfo.texShape,a=i[0],s=i[1];if(a===1&&s===1)return`
      float `+o+`() {
        return sampleTexture(`+r+`, halfCR);
      }
    `;var u=n.shapeInfo.texShape,c=u[0],l=u[1],d=Wi(r);return`
    float `+o+`() {
      vec2 uv = uvFromFlat(`+c+", "+l+", "+d+`);
      return sampleTexture(`+r+`, uv);
    }
  `}(t);case 1:return function(n){var r=n.name,o="get"+r.charAt(0).toUpperCase()+r.slice(1);if(n.shapeInfo.isUniform)return`
      float `+o+`(int index) {
        `+Ua(n)+`
      }
    `;var i=n.shapeInfo.texShape,a=i[0],s=i[1];if(s===1&&a===1)return`
      float `+o+`(int index) {
        return sampleTexture(`+r+`, halfCR);
      }
    `;var u=Wi(r);return s===1?`
      float `+o+`(int index) {
        vec2 uv = vec2(0.5, (float(index + `+u+") + 0.5) / "+a+`.0);
        return sampleTexture(`+r+`, uv);
      }
    `:a===1?`
      float `+o+`(int index) {
        vec2 uv = vec2((float(index + `+u+") + 0.5) / "+s+`.0, 0.5);
        return sampleTexture(`+r+`, uv);
      }
    `:`
    float `+o+`(int index) {
      vec2 uv = uvFromFlat(`+a+", "+s+", index + "+u+`);
      return sampleTexture(`+r+`, uv);
    }
  `}(t);case 2:return function(n){var r=n.shapeInfo.logicalShape,o=n.name,i="get"+o.charAt(0).toUpperCase()+o.slice(1),a=n.shapeInfo.texShape;if(a!=null&&At(r,a)){var s=a[0],u=a[1];return`
    float `+i+`(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(`+u+".0, "+s+`.0);
      return sampleTexture(`+o+`, uv);
    }
  `}var c=Xi(r),l=c.newShape,d=c.keptDims,f=l;if(f.length<r.length){var h=Ha(n,f);return`
      `+Va(h)+`
      float `+i+`(int row, int col) {
        return `+i+"("+Ga(["row","col"],d)+`);
      }
    `}if(n.shapeInfo.isUniform)return`
      float `+i+`(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(`+r[1]+`, 1)));
        `+Ua(n)+`
      }
    `;var m=a[0],p=a[1],g=Wi(o);return p===1?`
    float `+i+`(int row, int col) {
      float index = dot(vec3(row, col, `+g+"), vec3("+r[1]+`, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / `+m+`.0);
      return sampleTexture(`+o+`, uv);
    }
  `:m===1?`
    float `+i+`(int row, int col) {
      float index = dot(vec3(row, col, `+g+"), vec3("+r[1]+`, 1, 1));
      vec2 uv = vec2((index + 0.5) / `+p+`.0, 0.5);
      return sampleTexture(`+o+`, uv);
    }
  `:`
  float `+i+`(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * `+r[1]+" + col + "+g+`;
    vec2 uv = uvFromFlat(`+m+", "+p+`, index);
    return sampleTexture(`+o+`, uv);
  }
`}(t);case 3:return function(n){var r=n.shapeInfo.logicalShape,o=n.name,i="get"+o.charAt(0).toUpperCase()+o.slice(1),a=r[1]*r[2],s=r[2],u=Xi(r),c=u.newShape,l=u.keptDims,d=c;if(d.length<r.length){var f=Ha(n,d);return`
        `+Va(f)+`
        float `+i+`(int row, int col, int depth) {
          return `+i+"("+Ga(["row","col","depth"],l)+`);
        }
      `}if(n.shapeInfo.isUniform)return`
      float `+i+`(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(`+a+", "+s+`, 1)));
        `+Ua(n)+`
      }
    `;var h=n.shapeInfo.texShape,m=h[0],p=h[1],g=n.shapeInfo.flatOffset;if(p===a&&g==null)return`
        float `+i+`(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(`+s+`, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(`+p+".0, "+m+`.0);
          return sampleTexture(`+o+`, uv);
        }
      `;if(p===s&&g==null)return`
    float `+i+`(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(`+r[1]+`, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+p+".0, "+m+`.0);
      return sampleTexture(`+o+`, uv);
    }
  `;var v=Wi(o);return`
      float `+i+`(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * `+a+" + col * "+s+" + depth + "+v+`;
        vec2 uv = uvFromFlat(`+m+", "+p+`, index);
        return sampleTexture(`+o+`, uv);
      }
  `}(t);case 4:return function(n){var r=n.shapeInfo.logicalShape,o=n.name,i="get"+o.charAt(0).toUpperCase()+o.slice(1),a=r[3],s=r[2]*a,u=r[1]*s,c=Xi(r),l=c.newShape,d=c.keptDims;if(l.length<r.length){var f=Ha(n,l);return`
      `+Va(f)+`
      float `+i+`(int row, int col, int depth, int depth2) {
        return `+i+"("+Ga(["row","col","depth","depth2"],d)+`);
      }
    `}if(n.shapeInfo.isUniform)return`
      float `+i+`(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(`+u+", "+s+", "+a+`, 1)));
        `+Ua(n)+`
      }
    `;var h=n.shapeInfo.flatOffset,m=n.shapeInfo.texShape,p=m[0],g=m[1];if(g===u&&h==null)return`
      float `+i+`(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(`+s+", "+a+`, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+g+".0, "+p+`.0);
        return sampleTexture(`+o+`, uv);
      }
    `;if(g===a&&h==null)return`
      float `+i+`(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(`+r[1]*r[2]+", "+r[2]+`, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+g+".0, "+p+`.0);
        return sampleTexture(`+o+`, uv);
      }
    `;var v=Wi(o);return`
    float `+i+`(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+u+" + col * "+s+` +
          depth * `+a+` + depth2;
      vec2 uv = uvFromFlat(`+p+", "+g+", index + "+v+`);
      return sampleTexture(`+o+`, uv);
    }
  `}(t);case 5:return function(n){var r=n.shapeInfo.logicalShape,o=n.name,i="get"+o.charAt(0).toUpperCase()+o.slice(1),a=r[4],s=r[3]*a,u=r[2]*s,c=r[1]*u,l=Xi(r),d=l.newShape,f=l.keptDims;if(d.length<r.length){var h=Ha(n,d);return`
      `+Va(h)+`
      float `+i+`(int row, int col, int depth, int depth2, int depth3) {
        return `+i+"("+Ga(["row","col","depth","depth2","depth3"],f)+`);
      }
    `}if(n.shapeInfo.isUniform)return`
      float `+i+`(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(`+c+", "+u+", "+s+", "+a+`)) +
          depth3;
        `+Ua(n)+`
      }
    `;var m=n.shapeInfo.flatOffset,p=n.shapeInfo.texShape,g=p[0],v=p[1];if(v===c&&m==null)return`
      float `+i+`(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(`+u+", "+s+", "+a+`, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+v+".0, "+g+`.0);
        return sampleTexture(`+o+`, uv);
      }
    `;if(v===a&&m==null)return`
      float `+i+`(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(`+r[1]*r[2]*r[3]+`,
               `+r[2]*r[3]+", "+r[3]+`, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+v+".0, "+g+`.0);
        return sampleTexture(`+o+`, uv);
      }
    `;var y=Wi(o);return`
    float `+i+`(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+c+" + col * "+u+" + depth * "+s+` +
          depth2 * `+a+" + depth3 + "+y+`;
      vec2 uv = uvFromFlat(`+g+", "+v+`, index);
      return sampleTexture(`+o+`, uv);
    }
  `}(t);case 6:return function(n){var r=n.shapeInfo.logicalShape,o=n.name,i="get"+o.charAt(0).toUpperCase()+o.slice(1),a=Xi(r),s=a.newShape,u=a.keptDims;if(s.length<r.length){var c=Ha(n,s);return`
      `+Va(c)+`
      float `+i+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return `+i+"("+Ga(["row","col","depth","depth2","depth3","depth4"],u)+`);
      }
    `}var l=r[5],d=r[4]*l,f=r[3]*d,h=r[2]*f,m=r[1]*h;if(n.shapeInfo.isUniform)return`
      float `+i+`(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(`+m+", "+h+", "+f+", "+d+`)) +
          dot(
            vec2(depth3, depth4),
            vec2(`+l+`, 1)));
        `+Ua(n)+`
      }
    `;var p=n.shapeInfo.flatOffset,g=n.shapeInfo.texShape,v=g[0],y=g[1];if(y===m&&p==null)return`
      float `+i+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(`+h+", "+f+", "+d+", "+l+`)) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+y+".0, "+v+`.0);
        return sampleTexture(`+o+`, uv);
      }
    `;if(y===l&&p==null)return`
      float `+i+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(`+r[1]*r[2]*r[3]*r[4]+`,
               `+r[2]*r[3]*r[4]+`,
               `+r[3]*r[4]+`,
               `+r[4]+`)) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+y+".0, "+v+`.0);
        return sampleTexture(`+o+`, uv);
      }
    `;var x=Wi(o);return`
    float `+i+`(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+m+" + col * "+h+" + depth * "+f+` +
          depth2 * `+d+" + depth3 * "+l+" + depth4 + "+x+`;
      vec2 uv = uvFromFlat(`+v+", "+y+`, index);
      return sampleTexture(`+o+`, uv);
    }
  `}(t);default:throw new Error(e.length+"-D input sampling is not yet supported")}}function uR(t){var e,n,r;switch(t.shapeInfo.logicalShape.length){case 0:return e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1),r=qt(),`
    vec4 `+n+`() {
      return `+r.texture2D+"("+e+`, halfCR);
    }
  `;case 1:return function(o){var i=o.name,a="get"+i.charAt(0).toUpperCase()+i.slice(1),s=o.shapeInfo.texShape,u=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)],c=qt();return`
    vec4 `+a+`(int index) {
      vec2 uv = packedUVfrom1D(
        `+u[0]+", "+u[1]+`, index);
      return `+c.texture2D+"("+i+`, uv);
    }
  `}(t);case 2:return function(o){var i=o.shapeInfo.logicalShape,a=o.name,s="get"+a.charAt(0).toUpperCase()+a.slice(1),u=o.shapeInfo.texShape,c=u[0],l=u[1],d=qt();if(u!=null&&At(i,u))return`
      vec4 `+s+`(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(`+l+".0, "+c+`.0);

        return `+d.texture2D+"("+a+`, uv);
      }
    `;var f=[Math.ceil(u[0]/2),Math.ceil(u[1]/2)],h=Math.ceil(i[1]/2);return`
    vec4 `+s+`(int row, int col) {
      vec2 uv = packedUVfrom2D(`+h+", "+f[0]+", "+f[1]+`, row, col);
      return `+d.texture2D+"("+a+`, uv);
    }
  `}(t);case 3:return function(o){var i=o.shapeInfo.logicalShape,a=o.name,s="get"+a.charAt(0).toUpperCase()+a.slice(1),u=o.shapeInfo.texShape,c=[Math.ceil(u[0]/2),Math.ceil(u[1]/2)];if(i[0]===1){var l=i.slice(1),d=Ha(o,l);return`
        `+uR(d)+`
        vec4 `+s+`(int b, int row, int col) {
          return `+s+"("+Ga(["b","row","col"],[1,2])+`);
        }
      `}var f=c[0],h=c[1],m=Math.ceil(i[2]/2),p=m*Math.ceil(i[1]/2),g=qt();return`
    vec4 `+s+`(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        `+f+", "+h+", "+p+", "+m+`, b, row, col);
      return `+g.texture2D+"("+a+`, uv);
    }
  `}(t);default:return function(o){for(var i=o.shapeInfo.logicalShape,a=i.length,s=o.name,u="get"+s.charAt(0).toUpperCase()+s.slice(1),c=o.shapeInfo.texShape,l=[Math.ceil(c[0]/2),Math.ceil(c[1]/2)],d=l[0],f=l[1],h=Math.ceil(i[a-1]/2),m=h*Math.ceil(i[a-2]/2),p="int b, int row, int col",g="b * "+m+" + (row / 2) * "+h+" + (col / 2)",v=2;v<a-1;v++)p="int b"+v+", "+p,m*=i[a-v-1],g="b"+v+" * "+m+" + "+g;var y=qt();return`
    vec4 `+u+"("+p+`) {
      int index = `+g+`;
      int texR = index / `+f+`;
      int texC = index - texR * `+f+`;
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+f+", "+d+`);
      return `+y.texture2D+"("+s+`, uv);
    }
  `}(t)}}var b$=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,E$=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,C$=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,_$=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function Wi(t){return"offset"+t}function Ua(t){var e=t.name,n=de(t.shapeInfo.logicalShape);return n<2?"return "+e+";":`
    for (int i = 0; i < `+n+`; i++) {
      if (i == index) {
        return `+e+`[i];
      }
    }
  `}function Ke(t){if(t<=1)return"int";if(t===2)return"ivec2";if(t===3)return"ivec3";if(t===4)return"ivec4";if(t===5)return"ivec5";if(t===6)return"ivec6";throw Error("GPU for rank "+t+" is not yet supported")}function Ha(t,e){var n=JSON.parse(JSON.stringify(t));return n.shapeInfo.logicalShape=e,n}function Ga(t,e){return e.map(function(n){return t[n]}).join(", ")}var S$=function(t,e,n,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,N(t.length>2,function(){return"Packed arg"+(n.charAt(0).toUpperCase()+n.slice(1))+" supports only inputs with rank above 2."});var o=t[t.length-1],i=Math.ceil(o/e);this.outputShape=t.slice(0,-1),i>1&&this.outputShape.push(i),r||this.variableNames.push("bestIndicesA");var a,s,u=this.outputShape,c=u.length,l=Ke(c),d=pn("coords",c);if(i===1){var f=Ke(s=c+1);a=`
        `+f+" sourceLocR = "+f+"("+d.join()+`, 0);
        ++`+d[c-1]+`;
        `+f+" sourceLocG = "+f+"("+d.join()+`, 0);
        ++`+d[c-2]+`;
        `+f+" sourceLocA = "+f+"("+d.join()+`, 0);
        --`+d[c-1]+`;
        `+f+" sourceLocB = "+f+"("+d.join()+`, 0);
        --`+d[c-2]+";"}else s=c,a=`
        `+l+` sourceLocR = coords;
        ++`+d[c-1]+`;
        `+l+` sourceLocG = coords;
        ++`+d[c-2]+`;
        `+l+` sourceLocA = coords;
        --`+d[c-1]+`;
        `+l+` sourceLocB = coords;
        --`+d[c-2]+";";var h=["x","y","z","w","u","v"].slice(0,s),m="."+h[s-1],p=h.map(function(k){return"int "+k}),g=pn("sourceLocR",s-1).concat("inIdx.r"),v=pn("sourceLocG",s-1).concat("inIdx.g"),y=pn("sourceLocB",s-1).concat("inIdx.b"),x=pn("sourceLocA",s-1).concat("inIdx.a"),b=n==="max"?"greaterThan":"lessThan",E=r?"":`
          inIdx = round(vec4(getBestIndicesAChannel(`+g.join()+`),
                             getBestIndicesAChannel(`+v.join()+`),
                             getBestIndicesAChannel(`+y.join()+`),
                             getBestIndicesAChannel(`+x.join()+")));",_=`vec4(
            getAChannel(`+g.join()+`),
            hasNextCol ? getAChannel(`+v.join()+`) : 0.,
            hasNextRow ? getAChannel(`+y.join()+`) : 0.,
            hasNextRow && hasNextCol ? getAChannel(`+x.join()+") : 0.)",S=r?"":`
      float getBestIndicesAChannel(`+p.join()+`) {
        return getChannel(getBestIndicesA(`+h.join()+`),
                                          vec2(`+h.slice(-2).join()+`));
      }`;this.userCode=`
      float getAChannel(`+p.join()+`) {
        return getChannel(getA(`+h.join()+`),
                               vec2(`+h.slice(-2).join()+`));
      }
      `+S+`
      void main() {
        `+l+` coords = getOutputCoords();
        bool hasNextCol = `+d[c-1]+" < "+(u[c-1]-1)+`;
        bool hasNextRow = `+d[c-2]+" < "+(u[c-2]-1)+`;
        `+a+`
        ivec4 srcIdx = ivec4(sourceLocR`+m+", sourceLocG"+m+`,
          sourceLocB`+m+", sourceLocA"+m+") * "+e+`;
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = `+_+`;

        for (int i = 0; i < `+e+`; i++) {
          inIdx = srcIdx;
          `+E+`
          vec4 candidate = `+_+`;
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(`+b+`(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `},k$=function(t){this.variableNames=["dy"],this.outputShape=t.inShape;var e=t.filterHeight,n=t.filterWidth,r=t.strideHeight,o=t.strideWidth,i=t.dilationHeight,a=t.dilationWidth,s=t.effectiveFilterHeight,u=t.effectiveFilterWidth,c=s-1-t.padInfo.top,l=u-1-t.padInfo.left,d=1/(e*n);this.userCode=`
      const ivec2 pads = ivec2(`+c+", "+l+`);
      const float avgMultiplier = float(`+d+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+s+`;
            wR += `+i+`) {
          float dyR = float(dyRCorner + wR) / `+r+`.0;

          if (dyR < 0.0 || dyR >= `+t.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < `+u+`;
            wC+= `+a+`) {
            float dyC = float(dyCCorner + wC) / `+o+`.0;

            if (dyC < 0.0 || dyC >= `+t.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `},I$=function(t){this.variableNames=["dy"],this.outputShape=t.inShape;var e=t.filterDepth,n=t.filterHeight,r=t.filterWidth,o=t.strideDepth,i=t.strideHeight,a=t.strideWidth,s=t.dilationDepth,u=t.dilationHeight,c=t.dilationWidth,l=t.effectiveFilterDepth,d=t.effectiveFilterHeight,f=t.effectiveFilterWidth,h=l-1-t.padInfo.front,m=d-1-t.padInfo.top,p=f-1-t.padInfo.left,g=1/(e*n*r);this.userCode=`
      const ivec3 pads = ivec3(`+h+", "+m+", "+p+`);
      const float avgMultiplier = float(`+g+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < `+l+`;
            wD += `+s+`) {
          float dyD = float(dyDCorner + wD) / `+o+`.0;

          if (dyD < 0.0 || dyD >= `+t.outDepth+`.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < `+d+`;
              wR += `+u+`) {
            float dyR = float(dyRCorner + wR) / `+i+`.0;

            if (dyR < 0.0 || dyR >= `+t.outHeight+`.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < `+f+`;
                wC += `+c+`) {
              float dyC = float(dyCCorner + wC) / `+a+`.0;

              if (dyC < 0.0 || dyC >= `+t.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `},R$=function(t,e,n,r,o,i){this.outputShape=[],this.variableNames=["x","mean","variance"],Pe(t,e),Pe(t,n);var a="0.0";r!=null&&(Pe(t,r),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");var s="1.0";o!=null&&(Pe(t,o),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=t,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = `+a+`;
        float scale = `+s+`;
        float inv = scale * inversesqrt(variance + float(`+i+`));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `},T$=function(t,e,n,r,o,i){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],Pe(t,e),Pe(t,n);var a="vec4(0.0)";r!=null&&(Pe(t,r),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");var s="vec4(1.0)";o!=null&&(Pe(t,o),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=t,this.userCode=`
      void main() {
        vec4 offset = `+a+`;
        vec4 scale = `+s+`;

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(`+i+`));

        setOutput((x - mean) * inv + offset);
      }
    `},N$="return areal * breal - aimag * bimag;",A$="return areal * bimag + aimag * breal;",sb=function(t,e,n){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=Pe(e,n),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        `+t+`
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `},Qp="return a + b;",Jp="return a - b;",ub="return a * b;",cR="return (a < 0.) ? b * a : a;",st=function(t,e,n){this.variableNames=["A","B"],this.outputShape=Pe(e,n),this.userCode=`
      float binaryOperation(float a, float b) {
        `+t+`
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `},lR=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`,oo=function(t,e,n,r){r===void 0&&(r=!1),this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=Pe(e,n);var o=this.outputShape.length,i="";if(r)if(o===0||de(this.outputShape)===1)i=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(i=`
          `+Ke(o)+` coords = getOutputCoords();
        `,o===1)i+=`
            result.y = (coords + 1) >= `+this.outputShape[0]+` ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{var a=pn("coords",o);i+=`
            bool nextRowOutOfBounds =
              (`+a[o-2]+" + 1) >= "+this.outputShape[o-2]+`;
            bool nextColOutOfBounds =
              (`+a[o-1]+" + 1) >= "+this.outputShape[o-1]+`;
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        `+t+`
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        `+i+`

        setOutput(result);
      }
    `},P$=function(){function t(e){this.variableNames=["A"],this.outputShape=e,this.userCode=`
      uniform float minVal;
      uniform float maxVal;

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}return t.prototype.getCustomSetupFunc=function(e,n){var r=this;return function(o,i){r.minLoc==null&&(r.minLoc=o.getUniformLocationNoThrow(i,"minVal"),r.maxLoc=o.getUniformLocationNoThrow(i,"maxVal")),o.gl.uniform1f(r.minLoc,e),o.gl.uniform1f(r.maxLoc,n)}},t}(),D$=function(){function t(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.userCode=`
      uniform float minVal;
      uniform float maxVal;

      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}return t.prototype.getCustomSetupFunc=function(e,n){var r=this;return function(o,i){r.minLoc==null&&(r.minLoc=o.getUniformLocationNoThrow(i,"minVal"),r.maxLoc=o.getUniformLocationNoThrow(i,"maxVal")),o.gl.uniform1f(r.minLoc,e),o.gl.uniform1f(r.maxLoc,n)}},t}(),M$=function(t){this.variableNames=["real","imag"],this.outputShape=t,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `},O$=function(t){this.outputShape=[],this.outputShape=Js(t,1),this.variableNames=t.map(function(s,u){return"T"+u});var e=new Array(t.length-1);e[0]=t[0][1];for(var n=1;n<e.length;n++)e[n]=e[n-1]+t[n][1];var r=["if (yC < "+e[0]+") setOutput(getT0(yR, yC));"];for(n=1;n<e.length;n++){var o=e[n-1];r.push("else if (yC < "+e[n]+") setOutput(getT"+n+"(yR, yC-"+o+"));")}var i=e.length,a=e[e.length-1];r.push("else setOutput(getT"+i+"(yR, yC-"+a+"));"),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        `+r.join(`
        `)+`
      }
    `},F$=function(t,e){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=Js(t,e);var n=this.outputShape,r=n.length,o=Ke(r),i=pn("coords",r),a=["x","y","z","w","u","v"].slice(0,r);this.variableNames=t.map(function(g,v){return"T"+v});var s=new Array(t.length-1);s[0]=t[0][e];for(var u=1;u<s.length;u++)s[u]=s[u-1]+t[u][e];var c=a[e],l=a.slice(-2),d=a.join(),f="if ("+c+" < "+s[0]+`) {
        return getChannel(
            getT0(`+d+"), vec2("+l.join()+`));
        }`;for(u=1;u<s.length;u++){var h=s[u-1];f+=`
        if (`+c+" < "+s[u]+"  && "+c+" >= "+s[u-1]+`) {
          return getChannel(
            getT`+u+"("+Gl(a,c,h)+`),
            vec2(`+Gl(l,c,h)+`));
        }`}var m=s.length,p=s[s.length-1];f+=`
        return getChannel(
          getT`+m+"("+Gl(a,c,p)+`),
          vec2(`+Gl(l,c,p)+"));",this.userCode=`
      float getValue(`+a.map(function(g){return"int "+g})+`) {
        `+f+`
      }

      void main() {
        `+o+` coords = getOutputCoords();
        vec4 result = vec4(getValue(`+i+`), 0., 0., 0.);

        `+i[r-1]+" = "+i[r-1]+` + 1;
        if (`+i[r-1]+" < "+n[r-1]+`) {
          result.g = getValue(`+i+`);
        }

        `+i[r-2]+" = "+i[r-2]+` + 1;
        if (`+i[r-2]+" < "+n[r-2]+`) {
          result.a = getValue(`+i+`);
        }

        `+i[r-1]+" = "+i[r-1]+` - 1;
        if (`+i[r-2]+" < "+n[r-2]+` &&
            `+i[r-1]+" < "+n[r-1]+`) {
          result.b = getValue(`+i+`);
        }
        setOutput(result);
      }
    `};function Gl(t,e,n){var r=t.indexOf(e);return t.map(function(o,i){return i===r?o+" - "+n:o}).join()}var L$=function(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;var e=t.strideHeight,n=t.strideWidth,r=t.padInfo.top,o=t.padInfo.left,i=t.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < `+t.batchSize+`; b++) {
          for (int yR = 0; yR < `+t.outHeight+`; yR++) {
            int xR = wR + yR * `+e+" - "+r+`;

            if (xR < 0 || xR >= `+t.inHeight+`) {
              continue;
            }

            for (int yC = 0; yC < `+t.outWidth+`; yC++) {
              int xC = wC + yC * `+n+" - "+o+`;

              if (xC < 0 || xC >= `+t.inWidth+`) {
                continue;
              }

              if (`+i+`) {
                float dyValue = getDy(b, yR, yC, d2);
                float xValue = getX(b, xR, xC, d1);
                dotProd += (xValue * dyValue);
              } else {
                float dyValue = getDy(b, d2, yR, yC);
                float xValue = getX(b, d1, xR, xC);
                dotProd += (xValue * dyValue);
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `},B$=function(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;var e=t.filterHeight,n=t.filterWidth,r=t.strideHeight,o=t.strideWidth,i=t.dataFormat==="channelsLast",a=e-1-t.padInfo.top,s=n-1-t.padInfo.left,u=i?1:2,c=i?2:3,l=i?3:1;this.userCode=`
      const ivec2 pads = ivec2(`+a+", "+s+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[`+l+`];

        ivec2 dyCorner = ivec2(coords[`+u+"], coords["+c+`]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+e+`; wR++) {
          float dyR = float(dyRCorner + wR) / `+r+`.0;

          if (dyR < 0.0 || dyR >= `+t.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = `+e+` - 1 - wR;

          for (int wC = 0; wC < `+n+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+o+`.0;

            if (dyC < 0.0 || dyC >= `+t.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = `+n+` - 1 - wC;

            for (int d2 = 0; d2 < `+t.outChannels+`; d2++) {

              if (`+i+`) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `},j$=function(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;var e=t.strideDepth,n=t.strideHeight,r=t.strideWidth,o=t.padInfo.front,i=t.padInfo.top,a=t.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < `+t.batchSize+`; b++) {
          for (int yF = 0; yF < `+t.outDepth+`; yF++) {
            int xF = wF + yF * `+e+" - "+o+`;

            if (xF < 0 || xF >= `+t.inDepth+`) {
              continue;
            }

            for (int yR = 0; yR < `+t.outHeight+`; yR++) {
              int xR = wR + yR * `+n+" - "+i+`;

              if (xR < 0 || xR >= `+t.inHeight+`) {
                continue;
              }

              for (int yC = 0; yC < `+t.outWidth+`; yC++) {
                int xC = wC + yC * `+r+" - "+a+`;

                if (xC < 0 || xC >= `+t.inWidth+`) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},U$=function(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;var e=t.filterDepth,n=t.filterHeight,r=t.filterWidth,o=t.strideDepth,i=t.strideHeight,a=t.strideWidth,s=e-1-t.padInfo.front,u=n-1-t.padInfo.top,c=r-1-t.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(`+s+", "+u+", "+c+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < `+e+`; wF++) {
          float dyF = float(dyFCorner + wF) / `+o+`.0;

          if (dyF < 0.0 || dyF >= `+t.outDepth+`.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = `+e+` - 1 - wF;

          for (int wR = 0; wR < `+n+`; wR++) {
            float dyR = float(dyRCorner + wR) / `+i+`.0;

            if (dyR < 0.0 || dyR >= `+t.outHeight+`.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = `+n+` - 1 - wR;

            for (int wC = 0; wC < `+r+`; wC++) {
              float dyC = float(dyCCorner + wC) / `+a+`.0;

              if (dyC < 0.0 || dyC >= `+t.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = `+r+` - 1 - wC;

              for (int d2 = 0; d2 < `+t.outChannels+`; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},W$=function(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;var e=t.strideHeight,n=t.strideWidth,r=t.padInfo.top,o=t.padInfo.left,i=t.outChannels/t.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * `+i+` + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < `+t.batchSize+`; b++) {
          for (int yR = 0; yR < `+t.outHeight+`; yR++) {
            int xR = wR + yR * `+e+" - "+r+`;

            if (xR < 0 || xR >= `+t.inHeight+`) {
              continue;
            }

            for (int yC = 0; yC < `+t.outWidth+`; yC++) {
              int xC = wC + yC * `+n+" - "+o+`;

              if (xC < 0 || xC >= `+t.inWidth+`) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `},$$=function(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;var e=t.filterHeight,n=t.filterWidth,r=t.strideHeight,o=t.strideWidth,i=e-1-t.padInfo.top,a=n-1-t.padInfo.left,s=t.outChannels/t.inChannels;this.userCode=`
      const ivec2 pads = ivec2(`+i+", "+a+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < `+e+`; wR++) {
          float dyR = float(dyRCorner + wR) / `+r+`.0;

          if (dyR < 0.0 || dyR >= `+t.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = `+e+` - 1 - wR;

          for (int wC = 0; wC < `+n+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+o+`.0;

            if (dyC < 0.0 || dyC >= `+t.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = `+n+` - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < `+s+`; dm++) {
              int d2 = d1 * `+s+` + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `},cb=function(t,e,n,r){e===void 0&&(e=!1),n===void 0&&(n=null),r===void 0&&(r=!1),this.variableNames=["x","W"],this.outputShape=t.outShape;var o=t.padInfo.top,i=t.padInfo.left,a=t.strideHeight,s=t.strideWidth,u=t.dilationHeight,c=t.dilationWidth,l=t.filterHeight,d=t.filterWidth,f=4*Math.floor(t.inChannels/4),h=t.inChannels%4,m=t.dataFormat==="channelsLast",p=m?1:2,g=m?2:3,v=m?3:1,y="",x="";n&&(y=r?`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          `+n+`
        }`:`
          float activation(float x) {
            `+n+`
          }
        `,x="result = activation(result);");var b=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+y+`

      const ivec2 strides = ivec2(`+a+", "+s+`);
      const ivec2 pads = ivec2(`+o+", "+i+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[`+v+`];

        ivec2 xRCCorner =
            ivec2(coords[`+p+"], coords["+g+`]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+l+`; wR++) {
          int xR = xRCorner + wR * `+u+`;

          if (xR < 0 || xR >= `+t.inHeight+`) {
            continue;
          }

          for (int wC = 0; wC < `+d+`; wC++) {
            int xC = xCCorner + wC * `+c+`;

            if (xC < 0 || xC >= `+t.inWidth+`) {
              continue;
            }

            for (int d1 = 0; d1 < `+f+`; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (`+m+`) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (`+(h===1)+`) {

              if (`+m+`) {
                dotProd +=
                    getX(batch, xR, xC, `+f+`) *
                    getW(wR, wC, `+f+`, d2);
              } else {
                dotProd +=
                    getX(batch, `+f+`, xR, xC) *
                    getW(wR, wC, `+f+`, d2);
              }

            } else if (`+(h===2)+`) {
              vec2 wValues = vec2(
                getW(wR, wC, `+f+`, d2),
                getW(wR, wC, `+f+` + 1, d2)
              );

              if (`+m+`) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, `+f+`),
                  getX(batch, xR, xC, `+f+` + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, `+f+`, xR, xC),
                  getX(batch, `+f+` + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (`+(h===3)+`) {
              vec3 wValues = vec3(
                getW(wR, wC, `+f+`, d2),
                getW(wR, wC, `+f+` + 1, d2),
                getW(wR, wC, `+f+` + 2, d2)
              );

              if (`+m+`) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, `+f+`),
                  getX(batch, xR, xC, `+f+` + 1),
                  getX(batch, xR, xC, `+f+` + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, `+f+`, xR, xC),
                  getX(batch, `+f+` + 1, xR, xC),
                  getX(batch, `+f+` + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        `+b+`
        `+x+`
        setOutput(result);
      }
    `},z$=function(t){this.variableNames=["x","W"],this.outputShape=t.outShape;var e=t.padInfo.front,n=t.padInfo.top,r=t.padInfo.left,o=t.strideDepth,i=t.strideHeight,a=t.strideWidth,s=t.dilationDepth,u=t.dilationHeight,c=t.dilationWidth,l=t.filterDepth,d=t.filterHeight,f=t.filterWidth,h=4*Math.floor(t.inChannels/4),m=t.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(`+o+", "+i+", "+a+`);
      const ivec3 pads = ivec3(`+e+", "+n+", "+r+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < `+l+`; wF++) {
          int xF = xFCorner + wF * `+s+`;

          if (xF < 0 || xF >= `+t.inDepth+`) {
            continue;
          }

          for (int wR = 0; wR < `+d+`; wR++) {
            int xR = xRCorner + wR * `+u+`;

            if (xR < 0 || xR >= `+t.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+f+`; wC++) {
              int xC = xCCorner + wC * `+c+`;

              if (xC < 0 || xC >= `+t.inWidth+`) {
                continue;
              }

              for (int d1 = 0; d1 < `+h+`; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (`+(m===1)+`) {
                dotProd +=
                  getX(batch, xF, xR, xC, `+h+`) *
                  getW(wF, wR, wC, `+h+`, d2);
              } else if (`+(m===2)+`) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, `+h+`),
                  getX(batch, xF, xR, xC, `+h+` + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, `+h+`, d2),
                  getW(wF, wR, wC, `+h+` + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (`+(m===3)+`) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, `+h+`),
                  getX(batch, xF, xR, xC, `+h+` + 1),
                  getX(batch, xF, xR, xC, `+h+` + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, `+h+`, d2),
                  getW(wF, wR, wC, `+h+` + 1, d2),
                  getW(wF, wR, wC, `+h+` + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},lb=function(t,e,n,r){e===void 0&&(e=!1),n===void 0&&(n=null),r===void 0&&(r=!1),this.variableNames=["x","W"],this.outputShape=t.outShape;var o=t.inHeight,i=t.inWidth,a=t.padInfo.top,s=t.padInfo.left,u=t.strideHeight,c=t.strideWidth,l=t.dilationHeight,d=t.dilationWidth,f=t.filterHeight,h=t.filterWidth,m=t.outChannels/t.inChannels,p="",g="";n&&(p=r?`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          `+n+`
        }`:`
          float activation(float x) {
            `+n+`
          }
        `,g="result = activation(result);");var v=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+p+`

      const ivec2 strides = ivec2(`+u+", "+c+`);
      const ivec2 pads = ivec2(`+a+", "+s+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / `+m+`;
        int q = d2 - d1 * `+m+`;

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < `+f+`; wR++) {
          int xR = xRCorner + wR * `+l+`;

          if (xR < 0 || xR >= `+o+`) {
            continue;
          }

          for (int wC = 0; wC < `+h+`; wC++) {
            int xC = xCCorner + wC * `+d+`;

            if (xC < 0 || xC >= `+i+`) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        `+v+`
        `+g+`
        setOutput(result);
      }
    `},db=function(t,e,n,r){e===void 0&&(e=!1),n===void 0&&(n=null),r===void 0&&(r=!1),this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.outShape;for(var o=t.inHeight,i=t.inWidth,a=t.padInfo.top,s=t.padInfo.left,u=t.strideHeight,c=t.strideWidth,l=t.dilationHeight,d=t.dilationWidth,f=t.filterHeight,h=t.filterWidth,m=h,p="int xR; int xC; int xCOffset;",g=0;g<f;g++)for(var v=0;v<h;v++)p+=`
          vec4 xTexelR`+g+"C"+2*v+` = vec4(0.);
          vec4 wR`+g+"C"+v+` = vec4(0.);
          vec4 xR`+g+"C"+v+" = vec4(0.);";for(g=0;g<f;g++)for(var y=0;y<m;y++){if(p+=`
          xR = xRCorner + `+g*l+`;
          xC = xCCorner + `+(v=2*y)*d+`;
        `,c===1){if(v<h&&(p+=s%2==1?`
                xCOffset = xC + 1;
                if(xR >= 0 && xR < `+o+" && xCOffset >= 0 && xCOffset < "+i+`) {
                  xTexelR`+g+"C"+v+` = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if(xCOffset + 1 >= `+i+`) {
                    xTexelR`+g+"C"+v+`.zw = vec2(0.);
                  }
                } else {
                  xTexelR`+g+"C"+v+` = vec4(0.);
                }

                xCOffset = xC + 1 - 2;
                if(xR >= 0 && xR < `+o+" && xCOffset >= 0 && xCOffset < "+i+`) {
                  vec4 previous = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if(xCOffset + 1 >= `+i+`) {
                    previous.zw = vec2(0.);
                  }

                  xR`+g+"C"+v+" = vec4(previous.zw, xTexelR"+g+"C"+v+`.xy);
                } else {
                  xR`+g+"C"+v+" = vec4(0, 0, xTexelR"+g+"C"+v+`.xy);
                }
              `:`
                if(xR >= 0 && xR < `+o+" && xC >= 0 && xC < "+i+`) {
                  xTexelR`+g+"C"+v+` = getX(batch, xR, xC, d1);
                } else {
                  xTexelR`+g+"C"+v+` = vec4(0.);
                }

                xR`+g+"C"+v+" = xTexelR"+g+"C"+v+`;
              `,v+1<h)){var x=s%2==0?RI(d):d;d%2==0&&s%2==1||d%2!=0&&s%2!=1?(p+=`
                  xCOffset = xC + `+s%2+" + "+x+`;

                  if(xR >= 0 && xR < `+o+` &&
                    xCOffset >= 0 && xCOffset < `+i+`) {
                    xTexelR`+g+"C"+(v+2)+` = getX(batch, xR, xCOffset, d1);
                  }
                `,d>1&&(p+=`
                    xCOffset -= 2;
                    if(xR >= 0 && xR < `+o+` &&
                      xCOffset >= 0 && xCOffset < `+i+`) {
                      xTexelR`+g+"C"+v+` = getX(batch, xR, xCOffset, d1);
                    } else {
                      xTexelR`+g+"C"+v+` = vec4(0.);
                    }
                  `),p+=`
                  xR`+g+"C"+(v+1)+` = vec4(
                    xTexelR`+g+"C"+v+".zw, xTexelR"+g+"C"+(v+2)+`.xy);
                `):p+=`
                  xCOffset = xC + `+x+`;

                  if(xR >= 0 && xR < `+o+` &&
                    xCOffset >= 0 && xCOffset < `+i+`) {
                    xTexelR`+g+"C"+(v+2)+` = getX(batch, xR, xCOffset, d1);
                  }

                  xR`+g+"C"+(v+1)+" = xTexelR"+g+"C"+(v+2)+`;
                `}}else v<h&&(p+=`
              if(xR >= 0 && xR < `+o+`) {
            `,s%2==1?(p+=`
                xCOffset = xC + 1 - `+c+`;
                if(xCOffset >= 0 && xCOffset < `+i+`) {
                  xTexelR`+g+"C"+v+` = getX(batch, xR, xCOffset, d1);
                } else {
                  xTexelR`+g+"C"+v+` = vec4(0.);
                }

                if(xC + 1 >= 0 && xC + 1 < `+i+`) {
                  xTexelR`+g+"C"+(v+2)+` = getX(batch, xR, xC + 1, d1);
                } else {
                  xTexelR`+g+"C"+(v+2)+` = vec4(0.);
                }

                xR`+g+"C"+v+` = vec4(
                  xTexelR`+g+"C"+v+".zw, xTexelR"+g+"C"+(v+2)+`.zw);
              `,v+1<h&&(p+=`
                  vec4 final = vec4(0.);
                  xCOffset = xC + 1 + `+c+`;
                  if(xCOffset >= 0 && xCOffset < `+i+`) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xR`+g+"C"+(v+1)+" = vec4(xTexelR"+g+"C"+(v+2)+`.xy, final.xy);
                `)):(p+=`
                if(xC >= 0 && xC < `+i+`) {
                  xTexelR`+g+"C"+v+` = getX(batch, xR, xC, d1);
                } else {
                  xTexelR`+g+"C"+v+` = vec4(0.);
                }

                xCOffset = xC + `+c+`;
                if(xCOffset >= 0 && xCOffset < `+i+`) {
                  xTexelR`+g+"C"+(v+2)+` = getX(batch, xR, xCOffset, d1);
                } else {
                  xTexelR`+g+"C"+(v+2)+` = vec4(0.);
                }

                xR`+g+"C"+v+` = vec4(
                  xTexelR`+g+"C"+v+".xy, xTexelR"+g+"C"+(v+2)+`.xy);
              `,v+1<h&&(p+=`
                  xR`+g+"C"+(v+1)+` = vec4(
                    xTexelR`+g+"C"+v+".zw, xTexelR"+g+"C"+(v+2)+`.zw);
                `)),p+="}");v<h&&(p+=`
            vec4 wTexelR`+g+"C"+v+" = getW("+g+", "+v+`, d1, q);
            wR`+g+"C"+v+" = vec4(wTexelR"+g+"C"+v+".xz, wTexelR"+g+"C"+v+`.xz);
          `,v+1<h&&(p+=`
              vec4 wTexelR`+g+"C"+(v+1)+" = getW("+g+", "+(v+1)+`, d1, q);
              wR`+g+"C"+(v+1)+` =
                vec4(wTexelR`+g+"C"+(v+1)+".xz, wTexelR"+g+"C"+(v+1)+".xz);"))}for(g=0;g<f;g++)for(v=0;v<h;v++)p+="dotProd += xR"+g+"C"+v+" * wR"+g+"C"+v+";";var b="",E="";n&&(b=r?`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          `+n+`
        }`:`vec4 activation(vec4 x) {
          `+n+`
        }`,E="result = activation(result);");var _=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+b+`

      const ivec2 strides = ivec2(`+u+", "+c+`);
      const ivec2 pads = ivec2(`+a+", "+s+`);

      void main() {

        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2;
        int q = 0;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        vec4 dotProd = vec4(0.);

        `+p+`

        vec4 result = dotProd;
        `+_+`
        `+E+`
        setOutput(result);
      }
    `},V$=function(t,e,n,r,o){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];var i=t[0],a=t[1],s=t[2],u=t[3],c=e[0],l=n[0],d=n[1];this.outputShape=[c,l,d,u];var f=r==="bilinear"?1:0,h=[a-1+".0",s-1+".0"],m=h[0],p=h[1],g=l>1?[""+(a-1)/(l-1),"(y2-y1) * height_ratio","y1*"+m+" + float(y)*(height_scale)"]:["0.0","0.0","0.5 * (y1+y2) * "+m],v=g[0],y=g[1],x=g[2],b=d>1?[""+(s-1)/(d-1),"(x2-x1) * width_ratio","x1*"+p+" + float(x)*(width_scale)"]:["0.0","0.0","0.5 * (x1+x2) * "+p],E=b[0],_=b[1],S=b[2];this.userCode=`
      const float height_ratio = float(`+v+`);
      const float width_ratio = float(`+E+`);
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= `+i+`) {
          return;
        }

        float height_scale = `+y+`;
        float width_scale = `+_+`;

        float in_y = `+x+`;
        if( in_y < 0.0 || in_y > `+m+` ) {
          setOutput(float(`+o+`));
          return;
        }
        float in_x = `+S+`;
        if( in_x < 0.0 || in_x > `+p+` ) {
          setOutput(float(`+o+`));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(`+f+` == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `},H$=function(t,e,n){this.variableNames=["x"],this.outputShape=t;var r=t.length,o=t[t.length-1],i=n?"<":">";this.userCode=`
      int getIndex(int i) {
        `+(n?"return "+o+" -i - 1;":"return i;")+`
      }

      void main() {
        `+Ke(r)+` coords = getOutputCoords();
        int end = `+fb(r,"coords")+`;
        float val = 0.0;
        for (int i = `+o+` - 1; i >= 0; i -= 1) {
          int idx = getIndex(i);
          if (idx `+i+` end) {
            continue;
          }
          if (idx == end && `+e+`) {
            continue;
          }
          `+fb(r,"coords")+` = idx;
          val += getX(`+function(a,s){if(a===1)return""+s;if(a===2)return s+".x, "+s+".y";if(a===3)return s+".x, "+s+".y, "+s+".z";if(a===4)return s+".x, "+s+".y, "+s+".z, "+s+".w";throw Error("Cumulative sum for rank "+a+" is not yet supported")}(r,"coords")+`);
        }
        setOutput(val);
      }
    `};function fb(t,e){if(t===1)return""+e;if(t===2)return e+".y";if(t===3)return e+".z";if(t===4)return e+".w";throw Error("Cumulative sum for rank "+t+" is not yet supported")}var G$=function(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=Rc.DENSE;var e=Gu(t),n=qt();this.outputShape=t,this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        `+Zi(["r","c","d"],t)+`
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx *
          vec2(`+e[0]+", "+e[1]+`));
        int index = 4 * (resTexRC.x * `+e[1]+` + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        `+n.output+` = result;
      }
    `},K$=function(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=Rc.DENSE;var e=Gu(t),n=qt();this.outputShape=t,this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        `+Zi(["r","c","d"],t)+`
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx *
          vec2(`+e[0]+", "+e[1]+`));
        int index = 4 * (resTexRC.x * `+e[1]+` + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        `+n.output+` = result;
      }
    `},q$=function(){function t(e,n,r){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=n,this.dataFormat=r,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = `+this.getHeightCoordString()+`;
      int w = `+this.getWidthCoordString()+`;
      int d = `+this.getDepthCoordString()+`;

      int in_h = h / `+n+`;
      int offset_h = imod(h, `+n+`);
      int in_w = w / `+n+`;
      int offset_w = imod(w, `+n+`);
      int offset_d = (offset_h * `+n+` + offset_w) *
        `+this.getOutputDepthSize()+`;
      int in_d = d + offset_d;

      float result = `+this.getInputSamplingString()+`;
      setOutput(result);
    }
  `}return t.prototype.getHeightCoordString=function(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"},t.prototype.getWidthCoordString=function(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"},t.prototype.getDepthCoordString=function(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"},t.prototype.getOutputDepthSize=function(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]},t.prototype.getInputSamplingString=function(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"},t}(),X$=function(t){this.variableNames=["X"],this.outputShape=[t,t],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `},Y$=function(t){this.variableNames=["A"],this.outTexUsage=Rn.DOWNLOAD;var e=qt();this.outputShape=t,this.userCode=`
      `+sR+`

      void main() {
        float x = getAAtOutCoords();
        `+e.output+` = encode_float(x);
      }
    `},Q$=function(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=Rn.DOWNLOAD;var e=qt();this.outputShape=t,this.userCode=`
      `+sR+`

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        `+e.output+` = encode_float(x);
      }
    `},J$=function(t,e,n){n===void 0&&(n=!1),this.variableNames=["A"];var r=qt(),o=e[0],i=e[1];this.outputShape=t;var a="result";n&&(a="floor(result * 255. + 0.5)"),this.userCode=`
      `+n0(t)+`

      void main() {
        ivec3 coords = getOutputCoords();

        int flatIndex = getFlatIndex(coords);
        int offset = imod(flatIndex, 4);

        flatIndex = idiv(flatIndex, 4, 1.);
        
        int r = flatIndex / `+i+`;
        int c = imod(flatIndex, `+i+`);
        vec2 uv = (vec2(c, r) + halfCR) / vec2(`+i+".0, "+o+`.0);
        vec4 values = `+r.texture2D+`(A, uv);

        float result;

        if(offset == 0) {
          result = values[0];
        } else if(offset == 1) {
          result = values[1];
        } else if(offset == 2) {
          result = values[2];
        } else {
          result = values[3];
        }

        `+r.output+" = vec4("+a+`, 0., 0., 0.);
      }
    `},Z$=function(t,e,n){n===void 0&&(n=!1),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var r=qt(),o=e[0],i=e[1];this.outputShape=t;var a="",s="result";n&&(s="floor(result * 255. + 0.5)");for(var u=0;u<=1;u++)for(var c=0;c<=1;c++){var l=2*u+c;a+=`
          localCoords = coords;
          if(localCoords[2] + `+c+" < "+t[2]+`) {
            localCoords[2] += `+c+`;
            if(localCoords[1] + `+u+" < "+t[1]+`) {
              localCoords[1] += `+u+`;

              flatIndex = getFlatIndex(localCoords);
              offset = imod(flatIndex, 4);

              flatIndex = idiv(flatIndex, 4, 1.);

              r = flatIndex / `+i+`;
              c = imod(flatIndex, `+i+`);
              uv = (vec2(c, r) + halfCR) / vec2(`+i+".0, "+o+`.0);
              values = `+r.texture2D+`(A, uv);

              if(offset == 0) {
                result[`+l+`] = values[0];
              } else if(offset == 1) {
                result[`+l+`] = values[1];
              } else if(offset == 2) {
                result[`+l+`] = values[2];
              } else {
                result[`+l+`] = values[3];
              }
            }
          }
        `}this.userCode=`
      `+n0(t)+`

      void main() {
        ivec3 coords = getOutputCoords();

        vec4 result = vec4(0.);
        int flatIndex, r, c, offset;
        ivec3 localCoords;
        vec2 uv;
        vec4 values;

        `+a+`

        `+r.output+" = "+s+`;
      }
    `},ez="return real * expR - imag * expI;",tz="return real * expI + imag * expR;",hb=function(t,e,n){this.variableNames=["real","imag"];var r=e[1];this.outputShape=e;var o=n?"2.0 * "+Math.PI:"-2.0 * "+Math.PI,i=n?r+".0":"1.0";this.userCode=`
      const float exponentMultiplier = `+o+`;

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        `+t+`
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(`+r+`);
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < `+r+`; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / `+i+`;
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `},nz=function(){function t(e,n){this.outputShape=[],this.variableNames=["x"],this.outputShape=e,this.userCode=`
      uniform float value;
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}return t.prototype.getCustomSetupFunc=function(e){var n=this;return function(r,o){n.valueLoc==null&&(n.valueLoc=r.getUniformLocationNoThrow(o,"value")),r.gl.uniform1f(n.valueLoc,e)}},t}(),rz=function(t,e,n){this.variableNames=["A","indices"];var r=t.slice();r[n]=e,this.outputShape=r,this.rank=r.length;var o=Ke(this.rank),i=function(a,s){var u=a.length;if(u>4)throw Error("Gather for rank "+u+" is not yet supported");if(u===1)return"int(getIndices(resRC))";for(var c=["resRC.x","resRC.y","resRC.z","resRC.w"],l=[],d=0;d<a.length;d++)d===s?l.push("int(getIndices("+c[d]+"))"):l.push(""+c[d]);return l.join()}(t,n);this.userCode=`
      void main() {
        `+o+` resRC = getOutputCoords();
        setOutput(getA(`+i+`));
      }
    `},oz=function(t,e,n){this.sliceDim=t,this.strides=e,this.variableNames=["x","indices"],this.outputShape=n;var r=Ke(e.length),o=Ke(n.length),i=this.sliceDim>1?"strides[j]":"strides";this.userCode=`
        `+r+" strides = "+r+"("+this.strides+`);
         void main() {
          `+o+` coords = getOutputCoords();
          int flattenIndex = 0;
          for (int j = 0; j < `+this.sliceDim+`; j++) {
            int index = round(getIndices(coords[0], j));
            flattenIndex += index * `+i+`;
          }
          setOutput(getX(flattenIndex, coords[1]));
        }
      `};function iz(t,e){var n=qt();return eW(t,e,n.version+`
    precision highp float;
    `+n.attribute+` vec3 clipSpacePos;
    `+n.attribute+` vec2 uv;
    `+n.varyingVs+` vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`)}function az(t,e){return iW(t,e,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function sz(t,e){return aW(t,e,new Uint16Array([0,1,2,2,1,3]))}function il(t,e,n,r,o,i,a){uW(n,r);var s=sW(t,e),u=t.TEXTURE_2D;return fe(t,e,function(){return t.bindTexture(u,s)}),fe(t,e,function(){return t.texParameteri(u,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE)}),fe(t,e,function(){return t.texParameteri(u,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)}),fe(t,e,function(){return t.texParameteri(u,t.TEXTURE_MIN_FILTER,t.NEAREST)}),fe(t,e,function(){return t.texParameteri(u,t.TEXTURE_MAG_FILTER,t.NEAREST)}),fe(t,e,function(){return t.texImage2D(u,0,o,n,r,0,i,a,null)}),fe(t,e,function(){return t.bindTexture(t.TEXTURE_2D,null)}),s}function uz(t,e,n,r,o){var i=_h(n,r);return il(t,e,i[0],i[1],o.internalFormatFloat,o.textureFormatFloat,t.FLOAT)}function cz(t,e,n,r,o){var i=_h(n,r);return il(t,e,i[0],i[1],o.internalFormatHalfFloat,o.textureFormatFloat,o.textureTypeHalfFloat)}function lz(t,e,n,r,o){var i=_h(n,r);return il(t,e,i[0],i[1],t.RGBA,t.RGBA,t.UNSIGNED_BYTE)}function dz(t,e,n,r,o){var i=ol(n,r);return il(t,e,i[0],i[1],o.internalFormatPackedFloat,t.RGBA,t.FLOAT)}function fz(t,e,n,r,o){var i=ol(n,r);return il(t,e,i[0],i[1],o.internalFormatPackedHalfFloat,t.RGBA,o.textureTypeHalfFloat)}function hz(t,e,n,r){return fe(t,e,function(){return t.bindBuffer(t.ARRAY_BUFFER,r)}),eb(t,e,n,"clipSpacePos",r,3,20,0)&&eb(t,e,n,"uv",r,2,20,12)}function pz(t,e,n,r,o,i,a){var s,u,c;fe(t,e,function(){return t.bindTexture(t.TEXTURE_2D,n)}),i instanceof Uint8Array?(s=new Uint8Array(r*o*4),u=t.UNSIGNED_BYTE,c=t.RGBA):(s=new Float32Array(r*o*4),u=t.FLOAT,c=a.internalFormatPackedFloat),s.set(i),fe(t,e,function(){return t.texImage2D(t.TEXTURE_2D,0,c,r,o,0,t.RGBA,u,s)}),fe(t,e,function(){return t.bindTexture(t.TEXTURE_2D,null)})}function mz(t,e,n,r){fe(t,e,function(){return t.bindTexture(t.TEXTURE_2D,n)}),r.data instanceof Uint8Array?fe(t,e,function(){return t.texImage2D(t.TEXTURE_2D,0,t.RGBA,r.width,r.height,0,t.RGBA,t.UNSIGNED_BYTE,r.data)}):fe(t,e,function(){return t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,r)}),fe(t,e,function(){return t.bindTexture(t.TEXTURE_2D,null)})}function vz(t,e,n,r,o){var i=t.createBuffer();fe(t,e,function(){return t.bindBuffer(t.PIXEL_PACK_BUFFER,i)});var a=16*n*r;return fe(t,e,function(){return t.bufferData(t.PIXEL_PACK_BUFFER,a,t.STREAM_READ)}),fe(t,e,function(){return t.readPixels(0,0,r,n,t.RGBA,t.FLOAT,0)}),fe(t,e,function(){return t.bindBuffer(t.PIXEL_PACK_BUFFER,null)}),i}function gz(t,e,n){var r=t,o=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,e),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,o),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),o}function yz(t,e,n,r,o){var i=_h(n,r),a=i[0],s=i[1],u=new Uint8Array(n*r*4);return fe(t,e,function(){return t.readPixels(0,0,a,s,o.downloadTextureFormat,t.UNSIGNED_BYTE,u)}),new Float32Array(u.buffer)}function xz(t,e,n,r,o,i,a,s){var u=t,c=new Float32Array(function(l,d){var f=ol(l,d);return f[0]*f[1]*4}(i,a));return u.bindBuffer(u.PIXEL_PACK_BUFFER,e),u.getBufferSubData(u.PIXEL_PACK_BUFFER,0,c),u.bindBuffer(u.PIXEL_PACK_BUFFER,null),c}function wz(t,e,n,r){var o=new Float32Array(n*r*4);return fe(t,e,function(){return t.readPixels(0,0,r,n,t.RGBA,t.FLOAT,o)}),o}var bz=function(){function t(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];var n=G().getNumber("WEBGL_VERSION");e!=null?(this.gl=e,XU(n,e)):this.gl=Yr(n);var r="WEBGL_color_buffer_float";if(G().getNumber("WEBGL_VERSION")===1){if(this.textureFloatExtension=$l(this.gl,this.debug,"OES_texture_float"),Vn(this.gl,"OES_texture_half_float"))this.textureHalfFloatExtension=$l(this.gl,this.debug,"OES_texture_half_float");else if(G().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(r),Vn(this.gl,"EXT_color_buffer_half_float"))this.colorBufferHalfFloatExtension=$l(this.gl,this.debug,"EXT_color_buffer_half_float");else if(G().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(r="EXT_color_buffer_float",Vn(this.gl,r))this.colorBufferFloatExtension=this.gl.getExtension(r);else{if(!Vn(this.gl,"EXT_color_buffer_half_float"))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension("EXT_color_buffer_half_float")}this.vertexBuffer=az(this.gl,this.debug),this.indexBuffer=sz(this.gl,this.debug),this.framebuffer=cW(this.gl,this.debug),this.textureConfig=Gy(this.gl,this.textureHalfFloatExtension)}return Object.defineProperty(t.prototype,"debug",{get:function(){return G().getBool("DEBUG")},enumerable:!0,configurable:!0}),t.prototype.dispose=function(){var e=this;if(!this.disposed){this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");var n=this.gl;fe(n,this.debug,function(){return n.finish()}),fe(n,this.debug,function(){return n.bindFramebuffer(n.FRAMEBUFFER,null)}),fe(n,this.debug,function(){return n.deleteFramebuffer(e.framebuffer)}),fe(n,this.debug,function(){return n.bindBuffer(n.ARRAY_BUFFER,null)}),fe(n,this.debug,function(){return n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,null)}),fe(n,this.debug,function(){return n.deleteBuffer(e.indexBuffer)}),this.disposed=!0}},t.prototype.createFloat32MatrixTexture=function(e,n){return this.throwIfDisposed(),uz(this.gl,this.debug,e,n,this.textureConfig)},t.prototype.createFloat16MatrixTexture=function(e,n){return this.throwIfDisposed(),cz(this.gl,this.debug,e,n,this.textureConfig)},t.prototype.createUnsignedBytesMatrixTexture=function(e,n){return this.throwIfDisposed(),lz(this.gl,this.debug,e,n,this.textureConfig)},t.prototype.uploadPixelDataToTexture=function(e,n){this.throwIfDisposed(),mz(this.gl,this.debug,e,n)},t.prototype.uploadDenseMatrixToTexture=function(e,n,r,o){this.throwIfDisposed(),pz(this.gl,this.debug,e,n,r,o,this.textureConfig)},t.prototype.createFloat16PackedMatrixTexture=function(e,n){return this.throwIfDisposed(),fz(this.gl,this.debug,e,n,this.textureConfig)},t.prototype.createPackedMatrixTexture=function(e,n){return this.throwIfDisposed(),dz(this.gl,this.debug,e,n,this.textureConfig)},t.prototype.deleteMatrixTexture=function(e){var n=this;this.throwIfDisposed(),this.outputTexture===e&&(tb(this.gl,this.debug,this.framebuffer),this.outputTexture=null),fe(this.gl,this.debug,function(){return n.gl.deleteTexture(e)})},t.prototype.downloadByteEncodedFloatMatrixFromOutputTexture=function(e,n,r){var o=this;return this.downloadMatrixDriver(e,function(){return yz(o.gl,o.debug,n,r,o.textureConfig)})},t.prototype.downloadPackedMatrixFromBuffer=function(e,n,r,o,i,a){return xz(this.gl,e,0,0,0,i,a,this.textureConfig)},t.prototype.downloadFloat32MatrixFromBuffer=function(e,n){return gz(this.gl,e,n)},t.prototype.createBufferFromTexture=function(e,n,r){this.bindTextureToFrameBuffer(e);var o=vz(this.gl,this.debug,n,r,this.textureConfig);return this.unbindTextureToFrameBuffer(),o},t.prototype.createAndWaitForFence=function(){var e=this.createFence(this.gl);return this.pollFence(e)},t.prototype.createFence=function(e){var n,r,o=this;if(G().getBool("WEBGL_FENCE_API_ENABLED")){var i=e,a=i.fenceSync(i.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),r=function(){var s=i.clientWaitSync(a,0,0);return s===i.ALREADY_SIGNALED||s===i.CONDITION_SATISFIED},n=a}else G().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(n=this.beginQuery(),this.endQuery(),r=function(){return o.isQueryAvailable(n,G().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}):r=function(){return!0};return{query:n,isFencePassed:r}},t.prototype.downloadMatrixFromPackedTexture=function(e,n,r){var o=this;return this.downloadMatrixDriver(e,function(){return wz(o.gl,o.debug,n,r)})},t.prototype.createProgram=function(e){this.throwIfDisposed();var n=this.gl,r=tW(n,this.debug,e),o=iz(n,this.debug),i=rW(n,this.debug);return fe(n,this.debug,function(){return n.attachShader(i,o)}),fe(n,this.debug,function(){return n.attachShader(i,r)}),oW(n,this.debug,i),this.debug&&Kp(n,this.debug,i),this.vertexAttrsAreBound||(this.setProgram(i),this.vertexAttrsAreBound=hz(n,this.debug,this.program,this.vertexBuffer)),i},t.prototype.deleteProgram=function(e){var n=this;this.throwIfDisposed(),e===this.program&&(this.program=null),e!=null&&fe(this.gl,this.debug,function(){return n.gl.deleteProgram(e)})},t.prototype.setProgram=function(e){var n=this;this.throwIfDisposed(),this.program=e,this.program!=null&&this.debug&&Kp(this.gl,this.debug,this.program),fe(this.gl,this.debug,function(){return n.gl.useProgram(e)})},t.prototype.getUniformLocation=function(e,n,r){return r===void 0&&(r=!0),this.throwIfDisposed(),r?dW(this.gl,this.debug,e,n):fW(this.gl,e,n)},t.prototype.getAttributeLocation=function(e,n){var r=this;return this.throwIfDisposed(),fe(this.gl,this.debug,function(){return r.gl.getAttribLocation(e,n)})},t.prototype.getUniformLocationNoThrow=function(e,n){return this.throwIfDisposed(),this.gl.getUniformLocation(e,n)},t.prototype.setInputMatrixTexture=function(e,n,r){this.throwIfDisposed(),this.throwIfNoProgram(),hW(this.gl,this.debug,this.program,e,n,r)},t.prototype.setOutputMatrixTexture=function(e,n,r){this.setOutputMatrixTextureDriver(e,r,n)},t.prototype.setOutputPackedMatrixTexture=function(e,n,r){this.throwIfDisposed();var o=ol(n,r),i=o[0],a=o[1];this.setOutputMatrixTextureDriver(e,i,a)},t.prototype.setOutputMatrixWriteRegion=function(e,n,r,o){this.setOutputMatrixWriteRegionDriver(r,e,o,n)},t.prototype.setOutputPackedMatrixWriteRegion=function(e,n,r,o){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")},t.prototype.debugValidate=function(){this.program!=null&&Kp(this.gl,this.debug,this.program),zl(this.gl)},t.prototype.executeProgram=function(){this.throwIfDisposed(),this.throwIfNoProgram();var e=this.gl;this.debug&&this.debugValidate(),fe(e,this.debug,function(){return e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0)})},t.prototype.blockUntilAllProgramsCompleted=function(){var e=this;this.throwIfDisposed(),fe(this.gl,this.debug,function(){return e.gl.finish()})},t.prototype.getQueryTimerExtension=function(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=$l(this.gl,this.debug,G().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension},t.prototype.getQueryTimerExtensionWebGL2=function(){return this.getQueryTimerExtension()},t.prototype.getQueryTimerExtensionWebGL1=function(){return this.getQueryTimerExtension()},t.prototype.beginQuery=function(){if(G().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){var e=this.gl,n=this.getQueryTimerExtensionWebGL2(),r=e.createQuery();return e.beginQuery(n.TIME_ELAPSED_EXT,r),r}var o=this.getQueryTimerExtensionWebGL1(),i=o.createQueryEXT();return o.beginQueryEXT(o.TIME_ELAPSED_EXT,i),i},t.prototype.endQuery=function(){if(G().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")!==2){var e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}else{var n=this.gl,r=this.getQueryTimerExtensionWebGL2();n.endQuery(r.TIME_ELAPSED_EXT)}},t.prototype.waitForQueryAndGetTime=function(e){return ce(this,void 0,void 0,function(){var n=this;return le(this,function(r){switch(r.label){case 0:return[4,qw(function(){return n.disposed||n.isQueryAvailable(e,G().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))})];case 1:return r.sent(),[2,this.getQueryTime(e,G().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))]}})})},t.prototype.getQueryTime=function(e,n){if(n===0)return null;if(n===2){var r=this.gl;return r.getQueryParameter(e,r.QUERY_RESULT)/1e6}var o=this.getQueryTimerExtensionWebGL1();return o.getQueryObjectEXT(e,o.QUERY_RESULT_EXT)/1e6},t.prototype.isQueryAvailable=function(e,n){if(n===0)return!0;if(n===2){var r=this.gl,o=this.getQueryTimerExtensionWebGL2(),i=r.getQueryParameter(e,r.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(o.GPU_DISJOINT_EXT)),i&&!this.disjoint}return i=(o=this.getQueryTimerExtensionWebGL1()).getQueryObjectEXT(e,o.QUERY_RESULT_AVAILABLE_EXT),this.disjoint==null&&(this.disjoint=this.gl.getParameter(o.GPU_DISJOINT_EXT)),i&&!this.disjoint},t.prototype.pollFence=function(e){var n=this;return new Promise(function(r){n.addItemToPoll(function(){return e.isFencePassed()},function(){return r()})})},t.prototype.pollItems=function(){for(var e=function(r){for(var o=0;o<r.length&&r[o]();++o);return o-1}(this.itemsToPoll.map(function(r){return r.isDoneFn})),n=0;n<=e;++n)(0,this.itemsToPoll[n].resolveFn)();this.itemsToPoll=this.itemsToPoll.slice(e+1)},t.prototype.addItemToPoll=function(e,n){var r=this;this.itemsToPoll.push({isDoneFn:e,resolveFn:n}),this.itemsToPoll.length>1||qw(function(){return r.pollItems(),r.itemsToPoll.length===0})},t.prototype.bindTextureToFrameBuffer=function(e){this.throwIfDisposed(),qp(this.gl,this.debug,e,this.framebuffer),this.debug&&zl(this.gl)},t.prototype.unbindTextureToFrameBuffer=function(){this.outputTexture!=null?(qp(this.gl,this.debug,this.outputTexture,this.framebuffer),this.debug&&zl(this.gl)):tb(this.gl,this.debug,this.framebuffer)},t.prototype.downloadMatrixDriver=function(e,n){this.bindTextureToFrameBuffer(e);var r=n();return this.unbindTextureToFrameBuffer(),r},t.prototype.setOutputMatrixTextureDriver=function(e,n,r){this.throwIfDisposed();var o=this.gl;qp(o,this.debug,e,this.framebuffer),this.debug&&zl(o),this.outputTexture=e,fe(o,this.debug,function(){return o.viewport(0,0,n,r)}),fe(o,this.debug,function(){return o.scissor(0,0,n,r)})},t.prototype.setOutputMatrixWriteRegionDriver=function(e,n,r,o){var i=this;this.throwIfDisposed(),fe(this.gl,this.debug,function(){return i.gl.scissor(e,n,r,o)})},t.prototype.throwIfDisposed=function(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")},t.prototype.throwIfNoProgram=function(){if(this.program==null)throw new Error("No GPU program is currently set.")},t}();function pb(t,e){if(t.length!==e.length)throw Error("Binary was compiled with "+t.length+" inputs, but was executed with "+e.length+" inputs");t.forEach(function(n,r){var o=n.logicalShape,i=e[r],a=i.shape;if(!At(o,a))throw Error("Binary was compiled with different shapes than the current args. Shapes "+o+" and "+a+" must match");if(!n.isUniform||!i.isUniform){var s=n.texShape,u=i.isUniform?null:i.texData.texShape;if(!At(s,u))throw Error("Binary was compiled with different texture shapes than the current args. Shape "+s+" and "+u+" must match")}})}var Ez=function(t,e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;for(var r=n.filterWidth,o=n.inChannels,i=n.strideWidth,a=n.strideHeight,s=n.padInfo,u=n.outWidth,c=n.dilationWidth,l=n.dilationHeight,d=n.dataFormat,f=s.left,h=s.top,m=o*r,p=qt(),g=d==="channelsLast",v=g?0:1,y=g?1:2,x="",b=0;b<=1;b++)for(var E=0;E<=1;E++)x+=`
          blockIndex = rc.y + `+E+`;
          pos = rc.x + `+b+`;

          if(blockIndex < `+t[1]+" && pos < "+t[0]+`) {
            offsetY = int(blockIndex / (`+u+")) * "+a+" - "+h+`;
            d0 = offsetY + `+l+" * (pos / "+m+`);

            if(d0 < `+e[v]+` && d0 >= 0) {

              offsetX = int(mod(float(blockIndex), `+u+".) * "+i+". - "+f+`.);
              d1 = offsetX + `+c+" * (int(mod(float(pos), "+m+".) / "+o+`.));

              if(d1 < `+e[y]+` && d1 >= 0) {

                ch = int(mod(float(pos), `+o+`.));

                if (`+g+`) {
                  innerDims = vec2(d1, ch);
                  result[`+(2*b+E)+`] = getChannel(
                    getA(d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[`+(2*b+E)+`] = getChannel(
                    getA(ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec2 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        `+x+`

        `+p.output+` = result;
      }
    `},Cz=function(t,e,n,r,o){this.variableNames=["x"],this.outputShape=[];var i,a=e,s=t[3]-1;this.outputShape=t;var u="float("+n+") + float("+r+") * sum";i=o===.5?"inversesqrt("+u+")":o===1?"1.0/("+u+")":"exp(log("+u+") * float(-"+o+"));",this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -`+a+"; j <= "+a+`; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  `+s+`) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * `+i+`;
        setOutput(val);
      }
    `},_z=function(t,e,n,r,o){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=t,this.depth=t[3],this.depthRadius=e,this.bias=n,this.alpha=r,this.beta=o,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < `+this.depth+`; ++d) {
          int depthBegin = int(max(0.0, float(d - `+e+`)));
          int depthEnd = int(min(float(`+this.depth+`),
              float(d + `+e+` + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = `+this.depth+`;

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(`+r+") * norm + float("+n+`);

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(`+r+`)
                * float(`+o+`)
                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * `+o+`);
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `},Sz=function(t,e,n,r,o){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;var i,a=e,s=t[3]-1;this.outputShape=t;var u="float("+n+") + float("+r+") * sum";i=o===.5?"inversesqrt("+u+")":o===1?"1.0/("+u+")":"exp(log("+u+") * float(-"+o+"));",this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < `+this.outputShape[3]+`;
        bool hasNextRow = c < `+this.outputShape[2]+`;

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - `+a+`;
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - `+a+"; j <= "+a+`; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(`+s+`));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * `+i+`;
        setOutput(result);
      }
    `},kz=function(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;var e=t.strideHeight,n=t.strideWidth,r=t.dilationHeight,o=t.effectiveFilterHeight,i=t.effectiveFilterWidth,a=o-1-t.padInfo.top,s=i-1-t.padInfo.left,u=o*i-1;this.userCode=`
      const ivec2 pads = ivec2(`+a+", "+s+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+o+`;
          wR += `+r+`) {
          float dyR = float(dyRCorner + wR) / `+e+`.0;

          if (dyR < 0.0 || dyR >= `+t.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < `+i+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+n+`.0;

            if (dyC < 0.0 || dyC >= `+t.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = `+u+` - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * `+i+` + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `},Iz=function(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;var e=t.strideDepth,n=t.strideHeight,r=t.strideWidth,o=t.dilationDepth,i=t.dilationHeight,a=t.dilationWidth,s=t.effectiveFilterDepth,u=t.effectiveFilterHeight,c=t.effectiveFilterWidth,l=s-1-t.padInfo.front,d=u-1-t.padInfo.top,f=c-1-t.padInfo.left,h=s*u*c-1;this.userCode=`
      const ivec3 pads = ivec3(`+l+", "+d+", "+f+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < `+s+`;
           wD += `+o+`) {
          float dyD = float(dyDCorner + wD) / `+e+`.0;

          if (dyD < 0.0 || dyD >= `+t.outDepth+`.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < `+u+`;
              wR += `+i+`) {
            float dyR = float(dyRCorner + wR) / `+n+`.0;

            if (dyR < 0.0 || dyR >= `+t.outHeight+`.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < `+c+`;
                wC += `+a+`) {
              float dyC = float(dyCCorner + wC) / `+r+`.0;

              if (dyC < 0.0 || dyC >= `+t.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = `+h+` -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * `+u+" * "+c+` +
                  wR * `+c+` + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `},Zp=function(t,e,n,r,o,i,a){n===void 0&&(n=!1),r===void 0&&(r=!1),o===void 0&&(o=!1),i===void 0&&(i=null),a===void 0&&(a=!1),this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e;var s=n?t[1]:t[2],u=Math.ceil(s/2),c=n?"i * 2, rc.y":"rc.y, i * 2",l=r?"rc.z, i * 2":"i * 2, rc.z",d=n?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],f=r?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],h="",m="";i&&(h=a?`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          `+i+`
        }`:`vec4 activation(vec4 x) {
          `+i+`
        }`,m="result = activation(result);");var p=o?"result += getBiasAtOutCoords();":"";o&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+h+`

      const float sharedDimension = `+u+`.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        for (int i = 0; i < `+u+`; i++) {
          vec4 a = getMatrixA(rc.x, `+c+`);
          vec4 b = getMatrixB(rc.x, `+l+`);

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (`+d[0]+" * "+f[0]+`);
          result += (`+d[1]+" * "+f[1]+`);
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        `+p+`

        `+m+`

        setOutput(result);
      }
    `},Rz=function(){function t(e,n,r){this.variableNames=["probs"],this.outputShape=[e,r],this.userCode=`
      uniform float seed;

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < `+(n-1)+`; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(`+(n-1)+`));
      }
    `}return t.prototype.getCustomSetupFunc=function(e){var n=this;return function(r,o){n.seedLoc==null&&(n.seedLoc=r.getUniformLocation(o,"seed")),r.gl.uniform1f(n.seedLoc,e)}},t}(),Tz=function(t,e,n,r){this.variableNames=["indices"],this.outputShape=[t,e],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(`+r+"), float("+n+`),
                      float(index == coords.y)));
      }
    `},Nz=function(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=t;var e=t.length;if(e===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{var n=pn("rc",e),r=Ke(e),o=function(s,u,c){if(s===1)return"rc > "+u[0];for(var l="",d=s-2;d<s;d++)l+=c[d]+" >= "+u[d],d<s-1&&(l+="||");return l}(e,t,n),i=function(s,u,c,l){if(s===1)return"";var d=l.slice(-2);return`
    int r = `+d[0]+`;
    int c = `+d[1]+`;
    int rp1 = r + 1;
    int cp1 = c + 1;

    bool cEdge = cp1 >= `+u+`;
    bool rEdge = rp1 >= `+c+`;
  `}(e,t[t.length-1],t[t.length-2],n),a=function(s,u){var c=s.length,l=function(d,f){for(var h=[],m=0;m<=1;m++)for(var p=0;p<=1;p++){for(var g=(m===0?"r":"rp1")+", "+(p===0?"c":"cp1"),v=2;v<d;v++)g=f[f.length-1-v]+","+g;h.push(g)}return h}(c,u);return c===1?`getA(rc),
            rc + 1 >= `+s[0]+` ? 0. : getA(rc + 1),
            0, 0`:"getA("+l[0]+`),
          cEdge ? 0. : getA(`+l[1]+`),
          rEdge ? 0. : getA(`+l[2]+`),
          rEdge || cEdge ? 0. : getA(`+l[3]+")"}(t,n);this.userCode=`
        void main() {
          `+r+` rc = getOutputCoords();

          if(`+o+`) {
            setOutput(vec4(0));
          } else {
            `+i+`

            setOutput(vec4(`+a+`));
          }
        }
      `}},Az=function(t,e,n){this.variableNames=["x"],this.outputShape=e.map(function(u,c){return u[0]+t[c]+u[1]});var r=t.length,o=Ke(r),i=e.map(function(u){return u[0]}).join(","),a=e.map(function(u,c){return u[0]+t[c]}).join(","),s=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);this.userCode=r!==1?`
      `+o+" start = "+o+"("+i+`);
      `+o+" end = "+o+"("+a+`);

      void main() {
        `+o+` outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(float(`+n+`));
        } else {
          `+o+` coords = outC - start;
          setOutput(getX(`+s+`));
        }
      }
    `:`
        int start = `+i+`;
        int end = `+a+`;

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(float(`+n+`));
          } else {
            setOutput(getX(outC - start));
          }
        }
      `},Pz=function(t,e,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e.map(function(g,v){return g[0]+t[v]+g[1]});for(var r=t.length,o=Ke(r),i=e.map(function(g){return g[0]}).join(","),a=e.map(function(g,v){return g[0]+t[v]}).join(","),s=pn("rc",r),u=pn("source",r),c=s[r-1]+" < "+this.outputShape[r-1],l=r===1?"source":"vec2("+u.slice(-2).join()+")",d=[o+" rc = outputLoc;",s[r-1]+` += 1;
       if(`+c+`) {
      `,r===1?"":`}
       rc = outputLoc;
       `+s[r-2]+` += 1;
       if(`+s[r-2]+" < "+this.outputShape[r-2]+") {",r===1?"":"  "+s[r-1]+` += 1;
         if(`+c+") {"],f=r===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",h="",m=0,p=r===1?2:4;m<p;m++)h+=`
        `+d[m]+`
        if (`+f+`) {
          result[`+m+"] = float("+n+`);
        } else {
          `+o+` source = rc - start;
          result[`+m+"] = getChannel(getX("+u.join()+"), "+l+`);
        }
      `;h+=r===1?"} ":"}}",this.userCode=`
      const `+o+" start = "+o+"("+i+`);
      const `+o+" end = "+o+"("+a+`);

      void main() {
        `+o+` outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        `+h+`
        setOutput(result);
      }
    `},em=function(t,e,n){if(this.variableNames=["x"],e==="avg"&&n)throw new Error("Cannot compute positions for average pool.");var r=t.filterWidth,o=t.strideHeight,i=t.strideWidth,a=t.dilationHeight,s=t.dilationWidth,u=t.effectiveFilterHeight,c=t.effectiveFilterWidth,l=t.padInfo.top,d=t.padInfo.left;this.outputShape=t.outShape;var f=e==="avg",h="0.0";if(f||(h="-1.0 / 1e-20"),n)this.userCode=`
        const ivec2 strides = ivec2(`+o+", "+i+`);
        const ivec2 pads = ivec2(`+l+", "+d+`);

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < `+u+`;
              wR += `+a+`) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= `+t.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+c+`;
                wC += `+s+`) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= `+t.inWidth+`) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value >= currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = wR * `+c+` + wC;
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;else{var m=e+"("+e+"("+e+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";e==="avg"&&(m="avgValue / count");var p=4*Math.floor(r/4),g=r%4,v=`
      if (`+f+`) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = max(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(`+o+", "+i+`);
      const ivec2 pads = ivec2(`+l+", "+d+`);
      const float initializationValue = `+h+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= `+t.inWidth+`) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(`+h+`);
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < `+u+`;
            wR += `+a+`) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= `+t.inHeight+`) {
            continue;
          }

          for (int wC = 0; wC < `+p+`; wC += 4) {
            int xC = xCCorner + wC * `+s+`;

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+s+`, d),
              getValue(batch, xR, xC + 2 * `+s+`, d),
              getValue(batch, xR, xC + 3 * `+s+`, d)
            );

            `+v+`
          }

          int xC = xCCorner + `+p+`;
          if (`+(g===1)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            `+v+`
          } else if (`+(g===2)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+s+`, d),
              initializationValue,
              initializationValue
            );

            `+v+`
          } else if (`+(g===3)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+s+`, d),
              getValue(batch, xR, xC + 2 * `+s+`, d),
              initializationValue
            );

            `+v+`
          }
        }
        setOutput(`+m+`);
      }
    `}},tm=function(t,e,n){if(this.variableNames=["x"],e==="avg"&&n)throw new Error("Cannot compute positions for average pool.");var r=t.filterWidth,o=t.strideDepth,i=t.strideHeight,a=t.strideWidth,s=t.dilationDepth,u=t.dilationHeight,c=t.dilationWidth,l=t.effectiveFilterDepth,d=t.effectiveFilterHeight,f=t.effectiveFilterWidth,h=t.padInfo.front,m=t.padInfo.top,p=t.padInfo.left;this.outputShape=t.outShape;var g=e==="avg",v="0.0";if(g||(v="-1.0 / 1e-20"),n)this.userCode=`
        const ivec3 strides =
            ivec3(`+o+", "+i+", "+a+`);
        const ivec3 pads = ivec3(`+h+", "+m+", "+p+`);

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < `+l+`;
              wD += `+s+`) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= `+t.inDepth+`) {
              continue;
            }

            for (int wR = 0; wR < `+d+`;
                wR += `+u+`) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= `+t.inHeight+`) {
                continue;
              }

              for (int wC = 0; wC < `+f+`;
                  wC += `+c+`) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= `+t.inWidth+`) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value >= currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition =
                      wD * `+d+" * "+f+` +
                      wR * `+f+` + wC;;
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;else{var y=e+"("+e+"("+e+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";e==="avg"&&(y="avgValue / count");var x=4*Math.floor(r/4),b=r%4,E=`
      if (`+g+`) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = max(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(`+o+", "+i+", "+a+`);
      const ivec3 pads = ivec3(`+h+", "+m+", "+p+`);
      const float initializationValue = `+v+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= `+t.inWidth+`) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(`+v+`);
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < `+l+`;
            wD += `+s+`) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= `+t.inDepth+`) {
            continue;
          }

          for (int wR = 0; wR < `+d+`;
            wR += `+u+`) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= `+t.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+x+`; wC += 4) {
              int xC = xCCorner + wC * `+c+`;

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+c+`, ch),
                getValue(batch, xD, xR, xC + 2 * `+c+`, ch),
                getValue(batch, xD, xR, xC + 3 * `+c+`, ch)
              );

              `+E+`
            }

            int xC = xCCorner + `+x+`;
            if (`+(b===1)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              `+E+`
            } else if (`+(b===2)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+c+`, ch),
                initializationValue,
                initializationValue
              );

              `+E+`
            } else if (`+(b===3)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+c+`, ch),
                getValue(batch, xD, xR, xC + 2 * `+c+`, ch),
                initializationValue
              );

              `+E+`
            }
          }
          setOutput(`+y+`);
        }
      }
    `}},Dz=function(t,e){this.variableNames=["x"];var n=t.windowSize,r=t.batchSize,o=t.inSize,i=Math.ceil(o/n);this.outputShape=[r,i];var a="0.0",s="";e==="prod"?a="1.0":e==="min"?(a="1.0 / 1e-20",s="min"):e==="max"&&(a="-1.0 / 1e-20",s="max");var u=e+"("+e+"("+e+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";e==="sum"?u="sumValue":e==="prod"?u="prodValue":e==="all"?u="allValue":e==="any"&&(u="anyValue");var c=4*Math.floor(n/4),l=n%4,d=`
      if (`+(e==="sum")+`) {
        sumValue += dot(values, ones);
      } else if (`+(e==="prod")+`) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = `+s+`(values, minMaxValue);
      }
    `,f="vec4";e==="all"?(a="1.0",d=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,f="bvec4"):e==="any"&&(a="0.0",d=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,f="bvec4");var h="";o%n>0&&(h=`
        if (inIdx < 0 || inIdx >= `+o+`) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = `+a+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        `+h+`
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * `+n+`;

        vec4 minMaxValue = vec4(`+a+`);
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < `+c+`; i += 4) {
          int inIdx = inOffset + i;
          `+f+" values = "+f+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          `+d+`
        }

        int inIdx = inOffset + `+c+`;
        if (`+(l===1)+`) {
          `+f+" values = "+f+`(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          `+d+`
        } else if (`+(l===2)+`) {
          `+f+" values = "+f+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          `+d+`
        } else if (`+(l===3)+`) {
          `+f+" values = "+f+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          `+d+`
        }
        setOutput(`+u+`);
      }
    `},Mz=function(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;for(var n="",r=0;r<4;r++){var o="thisRC = rc;";r%2==1&&(o+="thisRC.z += 1;"),r>1&&(o+="thisRC.y += 1;"),n+=`
        `+o+`
        `+(r>0?"if(thisRC.y < rows && thisRC.z < cols){":"")+`
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[`+r+`] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        `+(r>0?"}":"")+`
      `}this.userCode=`
      
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      `+Zi(["r","c","d"],e)+`
      return ivec3(r, c, d);
    }
  
      `+n0(t)+`

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = `+t[1]+`;
        int cols = `+t[2]+`;

        `+n+`

        setOutput(result);
      }
    `},Oz=function(t,e,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=e.shape;var r=e.shape,o=r[1],i=r[2],a=t.shape,s=a[1],u=a[2],c=[n&&s>1?o-1:o,n&&u>1?i-1:i],l=[n&&s>1?s-1:s,n&&u>1?u-1:u],d=c[0]/l[0],f=c[1]/l[1],h=1/d,m=1/f,p=2*Math.ceil(h)+2,g=2*Math.ceil(m)+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(`+d+`);
        const float widthScale = float(`+f+`);

        const float invHeightScale = float(`+h+`);
        const float invWidthScale = float(`+m+`);

        const int winHeight = int(`+p+`);
        const int winWidth = int(`+g+`);

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= `+s+`) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= `+u+`) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), `+(o-1)+`.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), `+(i-1)+`.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `},Fz=function(t,e,n,r){this.variableNames=["A"],this.outputShape=[];var o=t[0],i=t[1],a=t[2],s=t[3];this.outputShape=[o,e,n,s];var u=[r&&e>1?i-1:i,r&&n>1?a-1:a],c=[r&&e>1?e-1:e,r&&n>1?n-1:n];this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          `+u[0]/c[0]+`,
          `+u[1]/c[1]+`);
      const vec2 inputShapeRC = vec2(`+i+".0, "+a+`.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(sourceFracIndexRC);
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `},Lz=function(t,e,n,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];var o=t[0],i=t[1],a=t[2],s=t[3];this.outputShape=[o,e,n,s];var u=[r&&e>1?i-1:i,r&&n>1?a-1:a],c=[r&&e>1?e-1:e,r&&n>1?n-1:n];this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          `+u[0]/c[0]+`,
          `+u[1]/c[1]+`,
          `+u[1]/c[1]+`);
      const vec3 inputShapeRC = vec3(`+i+".0, "+a+`.0,
                                     `+a+`.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = vec3(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(sourceFracIndexRC);
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < `+(s-1)+`;
        bool hasNextRow = coords.z < `+(n-1)+`;

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `},Bz=function(t,e,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=e.shape;var r=e.shape,o=r[1],i=r[2],a=t.shape,s=a[1],u=a[2],c=[n&&s>1?o-1:o,n&&u>1?i-1:i],l=[n&&s>1?s-1:s,n&&u>1?u-1:u],d=c[0]/l[0],f=c[1]/l[1],h=1/d,m=1/f,p=2*Math.ceil(h)+2,g=2*Math.ceil(m)+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(`+d+`);
        const float widthScale = float(`+f+`);

        const float invHeightScale = float(`+h+`);
        const float invWidthScale = float(`+m+`);

        const int winHeight = int(`+p+`);
        const int winWidth = int(`+g+`);

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= `+s+`) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= `+u+`) {
              continue;
            }

            float sourceFracRow =
              float(`+c[0]+`) *
                (float(dyR) / float(`+l[0]+`));

            float sourceFracCol =
                float(`+c[1]+`) *
                  (float(dyC) / float(`+l[1]+`));

            int sourceNearestRow = int(min(
                float(int(`+o+`) - 1),
                `+n+` ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(`+i+`) - 1),
                `+n+` ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `},jz=function(t,e,n,r){this.variableNames=["A"],this.outputShape=[];var o=t[0],i=t[1],a=t[2],s=t[3];this.outputShape=[o,e,n,s];var u=[r&&e>1?i-1:i,r&&n>1?a-1:a],c=[r&&e>1?e-1:e,r&&n>1?n-1:n],l=r?"0.5":"0.0";this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          `+u[0]/c[0]+`,
          `+u[1]/c[1]+`);
      const vec2 inputShapeRC = vec2(`+i+".0, "+a+`.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + `+l+`)));

        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `},Uz=function(t,e){this.variableNames=["x"];var n=t.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-"+n+" tensor is not yet supported");if(this.outputShape=t,n!==1){var r=t.map(function(i,a){return function(s){return e.indexOf(s)!==-1&&t[s]!==1?t[s]+" - coords["+s+"] - 1":"coords["+s+"]"}(a)}).join(","),o=Ke(n);this.userCode=`
      void main() {
        `+o+` coords = getOutputCoords();
        setOutput(getX(`+r+`));
      }
    `}else this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(`+t[0]+` - coord - 1));
        }
      `},Wz=function(t,e){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;var n=t.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-"+n+" tensor is not yet supported");this.outputShape=t;var r=pn("rc",n),o=r[n-1]+" + 1 < "+this.outputShape[n-1],i=r[n-2]+" + 1 < "+this.outputShape[n-2],a=Ke(n);function s(u){var c=t.map(function(l,d){return function(f,h){return e.indexOf(f)!==-1&&t[f]!==1?t[f]+" - "+h[f]+" - 1":""+h[f]}(d,u)});return"getChannel(getX("+c.join(",")+"), vec2("+c.slice(-2).join(",")+"))"}this.userCode=n===1?`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(`+t[0]+` - rc - 1),
            `+t[0]+` - rc - 1);
          if(`+o+`){
              result.g = getChannel(getX(`+t[0]+` - (rc  + 1) - 1),
                `+t[0]+` - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:`
        void main() {
          `+a+` rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = `+function(u){return s(u)}(r.slice())+`;
          if(`+o+`){
            result.g = `+function(u){return u[n-1]="("+u[n-1]+" + 1)",s(u)}(r.slice())+`;
          }
          if(`+i+`) {
            result.b = `+function(u){return u[n-2]="("+u[n-2]+" + 1)",s(u)}(r.slice())+`;
            if(`+o+`) {
              result.a = `+function(u){return u[n-1]="("+u[n-1]+" + 1)",u[n-2]="("+u[n-2]+" + 1)",s(u)}(r.slice())+`;
            }
          }
          setOutput(result);
        }
    `},mb=function(t,e,n,r,o,i,a){this.variableNames=["updates","indices","defaultValue"],this.outputShape=i;var s=Ke(o.length),u=Ke(i.length),c="";n===1?c="i":n===2&&(c="i, j");var l="getIndices("+c+")",d="";r===1?d="i":r===2&&(d="i, coords[1]");var f="getUpdates("+d+")",h=e>1?"strides[j]":"strides";this.userCode=`
        `+s+" strides = "+s+"("+o+`);

        void main() {
          `+u+` coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < `+t+`; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < `+e+`; j++) {
              int index = round(`+l+`);
              flattenedIndex += index * `+h+`;
            }
            if (flattenedIndex == coords[0]) {
              sum += `+f+`;
              found = true;
            }
          }
          setOutput(mix(getDefaultValue(), sum, float(found)));
        }
      `},$z=function(t,e){this.variableNames=["x","segmentIds"];var n=t.windowSize,r=t.batchSize,o=t.inSize,i=t.numSegments,a=i*Math.ceil(o/n);this.outputShape=[r,a];var s=4*Math.floor(n/4),u=n%4,c=`
        sumValue += dot(values, segFilter);
    `,l="";o%n>0&&(l=`
        if (inIdx < 0 || inIdx >= `+o+`) {
          return initializationValue;
        }
      `);var d="";o%n>0&&(d=`
        if (inIdx < 0 || inIdx >= `+o+`) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = 0.0;

      float getValue(int batch, int inIdx) {
        `+l+`
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        `+d+`
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          `+i+")) * float("+n+`));
        int currentSeg = int(mod(float(outIdx), float(`+i+`)));

        float sumValue = 0.0;

        for (int i = 0; i < `+s+`; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          `+c+`
        }

        int inIdx = inOffset + `+s+`;
        if (`+(u===1)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          `+c+`
        } else if (`+(u===2)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          `+c+`
        } else if (`+(u===3)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          `+c+`
        }
        setOutput(sumValue);
      }
    `},zz=function(t,e,n){var r,o;if(this.variableNames=["c","a","b"],this.outputShape=e,n>4)throw Error("Where for rank "+n+" is not yet supported");if(n===1)o="resRC",r="resRC";else{for(var i=["resRC.x","resRC.y","resRC.z","resRC.w"],a=[],s=[],u=0;u<e.length;u++)s.push(""+i[u]),u<t&&a.push(""+i[u]);r=a.join(),o=s.join()}var c=Ke(n);this.userCode=`
      void main() {
        `+c+` resRC = getOutputCoords();
        float cVal = getC(`+r+`);
        if (cVal >= 1.0) {
          setOutput(getA(`+o+`));
        } else {
          setOutput(getB(`+o+`));
        }
      }
    `},Vz=function(){function t(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;var n,r=Ke(this.rank),o="uniform int start["+this.rank+"];",i=function(a){if(a===1)return"sourceLoc";if(a<=6)return nm.slice(0,a).map(function(s){return"sourceLoc."+s}).join(",");throw Error("Slicing for rank "+a+" is not yet supported")}(this.rank);n=`
        `+r+` sourceLoc;
        `+r+` coords = getOutputCoords();
        `+e.map(function(a,s){return"sourceLoc."+nm[s]+" = start["+s+"] + coords."+nm[s]+";"}).join(`
`)+`
      `,this.userCode=`
      `+o+`
      void main() {
        `+n+`
        setOutput(getSource(`+i+`));
      }
    `}return t.prototype.getCustomSetupFunc=function(e){var n=this;if(e.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+e.length+")");return function(r,o){n.startLoc==null&&(n.startLoc=r.getUniformLocationNoThrow(o,"start"),n.startLoc==null)||r.gl.uniform1iv(n.startLoc,e)}},t}(),nm=["x","y","z","w","u","v"],Hz=function(){function t(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length;var n=Ke(this.rank),r=pn("coords",this.rank),o=pn("sourceLoc",this.rank),i=this.rank===1?"sourceLoc":"vec2("+o.slice(-2).join()+")",a="getChannel(getSource("+o.join()+"), "+i+")",s=`
      result.x = `+a+`;
      if (++`+r[this.rank-1]+" < "+e[this.rank-1]+`) {
        ++`+o[this.rank-1]+`;
        result.y = `+a+`;
        --`+o[this.rank-1]+`;
      }
    `,u=this.rank===1?"":`
      --`+r[this.rank-1]+`;
      if (++`+r[this.rank-2]+" < "+e[this.rank-2]+`) {
        ++`+o[this.rank-2]+`;
        result.z = `+a+`;
        if (++`+r[this.rank-1]+" < "+e[this.rank-1]+`) {
          ++`+o[this.rank-1]+`;
          result.w = `+a+`;
        }
      }
    `,c=this.rank<=4?`sourceLoc = coords +
            `+n+"("+e.map(function(l,d){return"start["+d+"]"}).join()+");":e.map(function(l,d){return o[d]+" = "+r[d]+" + start["+d+"];"}).join(`
`);this.userCode=`
      uniform int start[`+this.rank+`];
      void main() {
        `+n+` coords = getOutputCoords();
        `+n+` sourceLoc;
        `+c+`
        vec4 result = vec4(0.);
        `+s+`
        `+u+`
        setOutput(result);
      }
    `}return t.prototype.getCustomSetupFunc=function(e){var n=this;if(e.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+e.length+")");return function(r,o){n.startLoc==null&&(n.startLoc=r.getUniformLocationNoThrow(o,"start"),n.startLoc==null)||r.gl.uniform1iv(n.startLoc,e)}},t}(),Gz=function(t,e,n){this.variableNames=["x"],this.outputShape=n;var r=n.length,o=Ke(n.length),i=Ke(n.length),a="";if(r===1)a="coords * strides + begin";else{var s=0;a=n.map(function(u,c){return s++,n.length===1?"coords * strides["+c+"] + begin["+c+"]":"coords["+(s-1)+"] * strides["+c+"] + begin["+c+"]"}).join(",")}this.userCode=`
      `+o+" begin = "+o+"("+t+`);
      `+o+" strides = "+o+"("+e+`);

      void main() {
        `+i+` coords = getOutputCoords();
        setOutput(getX(`+a+`));
      }
    `},Kz=function(){function t(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}return t.prototype.acquireTexture=function(e,n,r){var o,i=vb(n,r),a=gb(e,i,r);if(a in this.freeTextures||(this.freeTextures[a]=[]),a in this.usedTextures||(this.usedTextures[a]=[]),this.freeTextures[a].length>0){this.numFreeTextures--,this.numUsedTextures++,this.log();var s=this.freeTextures[a].shift();return this.usedTextures[a].push(s),s}return this.numUsedTextures++,this.log(),i===kn.PACKED_2X2_FLOAT32?o=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):i===kn.PACKED_2X2_FLOAT16?o=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):i===kn.UNPACKED_FLOAT32?o=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):i===kn.UNPACKED_FLOAT16?o=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):i===kn.PACKED_4X1_UNSIGNED_BYTE&&(o=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[a].push(o),o},t.prototype.releaseTexture=function(e,n,r,o){if(this.freeTextures!=null){var i=gb(n,vb(r,o),o);i in this.freeTextures||(this.freeTextures[i]=[]),this.freeTextures[i].push(e),this.numFreeTextures++,this.numUsedTextures--;var a=this.usedTextures[i],s=a.indexOf(e);if(s<0)throw new Error("Cannot release a texture that was never provided by this texture manager");a.splice(s,1),this.log()}},t.prototype.log=function(){if(this.logEnabled){var e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",this.numFreeTextures+" / "+this.numUsedTextures,"("+e+")")}},t.prototype.getNumUsedTextures=function(){return this.numUsedTextures},t.prototype.getNumFreeTextures=function(){return this.numFreeTextures},t.prototype.dispose=function(){var e=this;if(this.freeTextures!=null){for(var n in this.freeTextures)this.freeTextures[n].forEach(function(r){e.gpgpu.deleteMatrixTexture(r)});for(var n in this.usedTextures)this.usedTextures[n].forEach(function(o){e.gpgpu.deleteMatrixTexture(o)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0}},t}();function vb(t,e){if(t===Rn.UPLOAD)return kn.PACKED_2X2_FLOAT32;if(t===Rn.RENDER||t==null)return function(n){return G().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?n?kn.PACKED_2X2_FLOAT32:kn.UNPACKED_FLOAT32:n?kn.PACKED_2X2_FLOAT16:kn.UNPACKED_FLOAT16}(e);if(t===Rn.DOWNLOAD||t===Rn.PIXELS)return kn.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type "+t)}function gb(t,e,n){return t[0]+"_"+t[1]+"_"+e+"_"+n}var qz=function(t,e){this.variableNames=["A"];for(var n=new Array(t.length),r=0;r<n.length;r++)n[r]=t[r]*e[r];this.outputShape=n,this.rank=n.length;var o=Ke(this.rank),i=function(a){var s=a.length;if(s>5)throw Error("Tile for rank "+s+" is not yet supported");if(s===1)return"imod(resRC, "+a[0]+")";for(var u=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],c=[],l=0;l<a.length;l++)c.push("imod("+u[l]+", "+a[l]+")");return c.join()}(t);this.userCode=`
      void main() {
        `+o+` resRC = getOutputCoords();
        setOutput(getA(`+i+`));
      }
    `},Xz=function(t,e){this.variableNames=["A"];for(var n=new Array(t.length),r=0;r<n.length;r++)n[r]=t[e[r]];this.outputShape=n,this.rank=n.length;var o=Ke(this.rank),i=function(a){var s=a.length;if(s>6)throw Error("Transpose for rank "+s+" is not yet supported");for(var u=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],c=new Array(s),l=0;l<a.length;l++)c[a[l]]=u[l];return c.join()}(e);this.userCode=`
    void main() {
      `+o+` resRC = getOutputCoords();
      setOutput(getA(`+i+`));
    }
    `},Yz=function(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;for(var n=new Array(t.length),r=0;r<n.length;r++)n[r]=t[e[r]];if(this.outputShape=n,this.rank=n.length,this.rank>6)throw Error("Packed transpose for rank "+this.rank+" is not yet supported.");var o=Ke(this.rank),i=aR("rc",this.rank),a=new Array(this.rank);for(r=0;r<e.length;r++)a[e[r]]=i[r];var s="vec2("+a.slice(-2).join()+")",u="++"+i[this.rank-1]+" < "+n[this.rank-1],c="getChannel(getA("+a.join()+"), "+s+")";this.userCode=`
    void main() {
      `+o+` rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = `+c+`;
      if(`+u+`) {
        result[1] = `+c+`;
      }
      --`+i[this.rank-1]+`;
      if(++`+i[this.rank-2]+" < "+n[this.rank-2]+`) {
        result[2] = `+c+`;
        if(`+u+`) {
          result[3] = `+c+`;
        }
      }
      setOutput(result);
    }
    `},r0=1.7580993408473768,o0=1.0507009873554805,Re=function(t,e){this.variableNames=["A"],this.outputShape=t,this.userCode=`
      float unaryOperation(float x) {
        `+e+`
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `},br="if (isnan(x)) return x;",Qz="return x;",yb="return abs(x);",dR=br+`
  return (x < 0.0) ? 0.0 : x;
`,fR=br+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,hR="return (x >= 0.0) ? x : (exp(x) - 1.0);",Jz=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = `+r0+`;
  float scale = `+o0+`;
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,xb="return -x;",wb="return ceil(x);",bb="return floor(x);",Eb="return exp(x);",Cb="return exp(x) - 1.0;",Zz=br+`
  return sin(x);
`,eV=br+`
  return cos(x);
`,tV=br+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,nV=br+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,rV=br+`
  return atan(x);
`,oV=br+"return log(x + sqrt(x * x + 1.0));",iV=br+`
  if (x < 1.0) return NAN;
  return log(x + sqrt(x * x - 1.0));`,aV=br+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
  return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,Kl="return x;",sV="return x;",pR=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,mR=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,vR=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,Su=function(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.userCode=`
      vec4 unaryOperation(vec4 x) {
        `+e+`
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `},uV=function(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=t;var e=t.length,n=pn("rc",e),r=Ke(e),o=function(s,u){if(s===1)return"rc";for(var c="",l=0;l<s;l++)c+=u[l],l<s-1&&(c+=",");return c}(e,n),i=n.slice(-2),a=e<=1?"rc":"vec2("+i.join(",")+")";this.userCode=`
      void main() {
        `+r+` rc = getOutputCoords();
        vec4 packedInput = getA(`+o+`);

        setOutput(getChannel(packedInput, `+a+`));
      }
    `},ql={};function Xl(t,e){if(e===void 0&&(e=!1),t==="linear")return e?sV:Qz;if(t==="relu")return e?pR:dR;if(t==="elu")return e?vR:hR;if(t==="relu6")return e?mR:fR;if(t==="prelu")return e?lR:cR;throw new Error("Activation "+t+" has not been implemented for the WebGL backend.")}var cV=600,lV=function(t){function e(n){var r,o=t.call(this)||this;if(o.pendingRead=new WeakMap,o.pendingDisposal=new WeakSet,o.dataRefCount=new WeakMap,o.numBytesInGPU=0,o.uploadWaitMs=0,o.downloadWaitMs=0,o.warnedAboutMemory=!1,o.pendingDeletes=0,o.disposed=!1,!G().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if(n==null){var i=Yr(G().getNumber("WEBGL_VERSION"));o.binaryCache=((r=G().getNumber("WEBGL_VERSION"))in ql||(ql[r]={}),ql[r]),o.gpgpu=new bz(i),o.canvas=i.canvas,o.gpgpuCreatedLocally=!0}else o.gpgpu=n,o.binaryCache={},o.gpgpuCreatedLocally=!1,o.canvas=n.gl.canvas;return o.textureManager=new Kz(o.gpgpu),o.numMBBeforeWarning=G().global.screen==null?1024:G().global.screen.height*G().global.screen.width*window.devicePixelRatio*cV/1024/1024,o.texData=new QI(o,L),o}return wr(e,t),e.prototype.numDataIds=function(){return this.texData.numDataIds()+(this.cpuBackend?this.cpuBackend.numDataIds():0)-this.pendingDeletes},e.prototype.write=function(n,r,o){if(G().getBool("DEBUG")&&this.checkNumericalProblems(n),o==="complex64"&&n!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");var i={};return this.texData.set(i,{shape:r,dtype:o,values:n,usage:Rn.UPLOAD}),i},e.prototype.move=function(n,r,o,i){if(G().getBool("DEBUG")&&this.checkNumericalProblems(r),i==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(n,{shape:o,dtype:i,values:r,usage:Rn.UPLOAD})},e.prototype.readSync=function(n){var r=this.texData.get(n),o=r.values,i=r.dtype,a=r.complexTensors,s=r.slice,u=r.shape,c=r.isPacked;if(s!=null){var l=void 0;l=c?new Su(u,Kl):new Re(u,Kl);var d=this.runWebGLProgram(l,[{dataId:n,shape:u,dtype:i}],i),f=this.readSync(d.dataId);return this.disposeData(d.dataId),f}if(o!=null)return this.convertAndCacheOnCPU(n);if(i==="string")return o;var h,m,p=this.activeTimers!=null;return p&&(h=Ar()),i==="complex64"?m=Yv(a.real.dataSync(),a.imag.dataSync()):m=this.getValuesFromTexture(n),p&&(this.downloadWaitMs+=Ar()-h),this.convertAndCacheOnCPU(n,m)},e.prototype.read=function(n){return ce(this,void 0,void 0,function(){var r,o,i,a,s,u,c,l,d,f,h,m,p,g,v,y,x,b,E,_,S,k;return le(this,function(R){switch(R.label){case 0:if(this.pendingRead.has(n))return r=this.pendingRead.get(n),[2,new Promise(function(I){return r.push(I)})];if(o=this.texData.get(n),i=o.values,a=o.shape,s=o.slice,u=o.dtype,c=o.complexTensors,l=o.isPacked,s!=null)return d=void 0,d=l?new Su(a,Kl):new Re(a,Kl),f=this.runWebGLProgram(d,[{dataId:n,shape:a,dtype:u}],u),h=this.read(f.dataId),this.disposeData(f.dataId),[2,h];if(i!=null)return[2,this.convertAndCacheOnCPU(n)];if(!G().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&G().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");return m=null,u!=="complex64"&&G().get("WEBGL_BUFFER_SUPPORTED")&&(p=this.decode(n),g=this.texData.get(p.dataId),m=(k=this.gpgpu).createBufferFromTexture.apply(k,[g.texture].concat(Gu(a)))),this.pendingRead.set(n,[]),u==="complex64"?[3,2]:[4,this.gpgpu.createAndWaitForFence()];case 1:R.sent(),R.label=2;case 2:return u!=="complex64"?[3,4]:[4,Promise.all([c.real.data(),c.imag.data()])];case 3:return y=R.sent(),x=y[0],b=y[1],v=Yv(x,b),[3,5];case 4:m==null?v=this.getValuesFromTexture(n):(E=de(a),v=this.gpgpu.downloadFloat32MatrixFromBuffer(m,E)),R.label=5;case 5:return p!=null&&this.disposeData(p.dataId),_=this.convertAndCacheOnCPU(n,v),S=this.pendingRead.get(n),this.pendingRead.delete(n),S.forEach(function(I){return I(_)}),this.pendingDisposal.has(n)&&(this.pendingDisposal.delete(n),this.disposeData(n),this.pendingDeletes--),[2,_]}})})},e.prototype.checkNumericalProblems=function(n){if(n!=null)for(var r=0;r<n.length;r++){var o=n[r];if(!JU(o))throw G().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error("The value "+o+" cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'"):Error("The value "+o+" cannot be represented on this device.")}},e.prototype.getValuesFromTexture=function(n){var r,o=this.texData.get(n),i=o.shape,a=o.dtype,s=o.isPacked,u=de(i);if(G().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){var c=this.decode(n),l=this.texData.get(c.dataId),d=(r=this.gpgpu).downloadMatrixFromPackedTexture.apply(r,[l.texture].concat(Gu(i))).subarray(0,u);return this.disposeData(c.dataId),d}var f=G().getBool("WEBGL_PACK")&&s===!0,h=f?Xp(i):i,m=f?new Q$(h):new Y$(h),p=this.runWebGLProgram(m,[{shape:h,dtype:a,dataId:n}],"float32"),g=this.texData.get(p.dataId),v=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(g.texture,g.texShape[0],g.texShape[1]).subarray(0,u);return this.disposeData(p.dataId),v},e.prototype.time=function(n){return ce(this,void 0,void 0,function(){var r,o,i,a,s,u,c;return le(this,function(l){switch(l.label){case 0:return r=this.activeTimers,o=[],i=!1,this.programTimersStack==null?(this.programTimersStack=o,i=!0):this.activeTimers.push(o),this.activeTimers=o,n(),a=Ys(this.activeTimers.map(function(d){return d.query})).filter(function(d){return d!=null}),s=Ys(this.activeTimers.map(function(d){return d.name})).filter(function(d){return d!=null}),this.activeTimers=r,i&&(this.programTimersStack=null),u={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null},G().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[4,Promise.all(a)]:[3,2];case 1:return c=l.sent(),u.kernelMs=PU(c),u.getExtraProfileInfo=function(){return c.map(function(d,f){return{name:s[f],ms:d}}).map(function(d){return d.name+": "+d.ms}).join(", ")},[3,3];case 2:u.kernelMs={error:"WebGL query timers are not supported in this environment."},l.label=3;case 3:return this.uploadWaitMs=0,this.downloadWaitMs=0,[2,u]}})})},e.prototype.memory=function(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU}},e.prototype.startTimer=function(){return G().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:Ar(),endMs:null}},e.prototype.endTimer=function(n){return G().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),n):(n.endMs=Ar(),n)},e.prototype.getQueryTime=function(n){return ce(this,void 0,void 0,function(){var r;return le(this,function(o){return G().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[2,this.gpgpu.waitForQueryAndGetTime(n)]:[2,(r=n).endMs-r.startMs]})})},e.prototype.disposeData=function(n){if(!this.pendingDisposal.has(n)){if(this.pendingRead.has(n))return this.pendingDisposal.add(n),void this.pendingDeletes++;if(this.texData.has(n)){this.releaseGPUData(n);var r=this.texData.get(n).complexTensors;r!=null&&(r.real.dispose(),r.imag.dispose()),this.texData.delete(n)}}},e.prototype.releaseGPUData=function(n){var r=this.texData.get(n),o=r.texture,i=r.dtype,a=r.texShape,s=r.usage,u=r.isPacked,c=r.slice,l=c&&c.origDataId||n,d=this.dataRefCount.get(l);d>1?this.dataRefCount.set(l,d-1):(this.dataRefCount.delete(l),o!=null&&(this.numBytesInGPU-=this.computeBytes(a,i),this.textureManager.releaseTexture(o,a,s,u)));var f=this.texData.get(n);f.texture=null,f.texShape=null,f.isPacked=!1,f.slice=null},e.prototype.getTexture=function(n){return this.uploadToGPU(n),this.texData.get(n).texture},e.prototype.getDataInfo=function(n){return this.texData.get(n)},e.prototype.getCPUBackend=function(){return G().getBool("WEBGL_CPU_FORWARD")?(this.cpuBackend==null&&(this.cpuBackend=L.findBackend("cpu")),this.cpuBackend):null},e.prototype.shouldExecuteOnCPU=function(n,r){var o=this;return r===void 0&&(r=128),this.getCPUBackend()!=null&&n.every(function(i){return o.texData.get(i.dataId).texture==null&&i.size<r})},e.prototype.getGPGPUContext=function(){return this.gpgpu},e.prototype.complex=function(n,r){var o=this.makeOutput(n.shape,"complex64");return this.texData.get(o.dataId).complexTensors={real:L.keep(n.clone()),imag:L.keep(r.clone())},o},e.prototype.real=function(n){return this.texData.get(n.dataId).complexTensors.real.clone()},e.prototype.imag=function(n){return this.texData.get(n.dataId).complexTensors.imag.clone()},e.prototype.slice=function(n,r,o){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.slice(n,r,o);if(de(o)===0)return Bt([],o,n.dtype);var i=this.texData.get(n.dataId).isPacked,a=XI(n.shape,r,o);if(i||!a){var s=G().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Hz(o):new Vz(o),u=s.getCustomSetupFunc(r);return this.compileAndRun(s,[n],null,u)}return this.uploadToGPU(n.dataId),this.shallowSlice(n,r,o)},e.prototype.shallowSlice=function(n,r,o){var i=this.texData.get(n.dataId),a=this.makeOutput(o,n.dtype),s=this.texData.get(a.dataId);Object.assign(s,i),s.shape=o,s.dtype=n.dtype;var u=YI(r,n.strides);i.slice&&(u+=i.slice.flatOffset),s.slice={flatOffset:u,origDataId:i.slice&&i.slice.origDataId||n.dataId};var c=this.dataRefCount.get(s.slice.origDataId)||1;return this.dataRefCount.set(s.slice.origDataId,c+1),a},e.prototype.stridedSlice=function(n,r,o,i){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.stridedSlice(n,r,o,i);var a=Qy(r,o,i);if(a.some(function(u){return u===0}))return Bt([],a);var s=new Gz(r,i,a);return this.compileAndRun(s,[n])},e.prototype.reverse=function(n,r){var o=G().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Wz(n.shape,r):new Uz(n.shape,r);return this.compileAndRun(o,[n])},e.prototype.concat=function(n,r){if(n[0].dtype==="complex64"){var o=n.map(function(h){return $n(h)}),i=n.map(function(h){return Or(h)});return Ft(this.concat(o,r),this.concat(i,r))}if(this.shouldExecuteOnCPU(n))return this.cpuBackend.concat(n,r);if(n.length===1)return n[0];if(n.length>G().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){var a=Math.floor(n.length/2),s=this.concat(n.slice(0,a),r),u=this.concat(n.slice(a),r);return this.concat([s,u],r)}if(G().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&n[0].rank>1){var c=new F$(n.map(function(h){return h.shape}),r);return this.compileAndRun(c,n)}var l=Js(n.map(function(h){return h.shape}),r),d=n.map(function(h){return h.as2D(-1,de(h.shape.slice(r)))}),f=new O$(d.map(function(h){return h.shape}));return this.compileAndRun(f,d).reshape(l)},e.prototype.neg=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.neg(n);if(G().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,xb,n.dtype);var r=new Re(n.shape,xb);return this.compileAndRun(r,[n])},e.prototype.batchMatMul=function(n,r,o,i){var a=o?n.shape[2]:n.shape[1],s=i?r.shape[1]:r.shape[2],u=o?n.shape[1]:n.shape[2],c=n.shape[0];if((a===1||s===1)&&u>1e3){o&&(n=n.transpose([0,2,1])),i&&(r=r.transpose([0,2,1]));var l=s===1?n:n.as3D(c,u,1),d=s===1?2:1,f=s===1?r.as3D(c,1,u):r;return this.multiply(l,f).sum(d,!0)}var h=Lt(n.dtype,r.dtype),m=new Zp(n.shape,[c,a,s],o,i);return this.compileAndRun(m,[n,r],h)},e.prototype.fusedBatchMatMul=function(n){var r=n.a,o=n.b,i=n.transposeA,a=n.transposeB,s=n.bias,u=n.activation,c=n.preluActivationWeights,l=i?r.shape[2]:r.shape[1],d=a?o.shape[1]:o.shape[2],f=r.shape[0],h=Lt(r.dtype,o.dtype),m=s!=null,p=c!=null,g=u?Xl(u,!0):null,v=new Zp(r.shape,[f,l,d],i,a,m,g,p),y=[r,o];return s&&y.push(s),c&&y.push(c),this.compileAndRun(v,y,h)},e.prototype.multiply=function(n,r){if(n.dtype==="complex64"){var o=this.texData.get(n.dataId),i=this.texData.get(r.dataId),a=new sb(N$,n.shape,r.shape),s=new sb(A$,n.shape,r.shape),u=[this.makeComplexComponentTensorInfo(n,o.complexTensors.real),this.makeComplexComponentTensorInfo(n,o.complexTensors.imag),this.makeComplexComponentTensorInfo(r,i.complexTensors.real),this.makeComplexComponentTensorInfo(r,i.complexTensors.imag)],c=this.compileAndRun(a,u),l=this.compileAndRun(s,u),d=this.complex(c,l);return c.dispose(),l.dispose(),d}if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.multiply(n,r);if(G().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,ub,n.dtype);var f=new st(ub,n.shape,r.shape);return this.compileAndRun(f,[n,r],n.dtype)},e.prototype.batchNormalization=function(n,r,o,i,a,s){var u=[n,r,o],c=null;s!=null&&(c=s.shape,u.push(s));var l=null;if(a!=null&&(l=a.shape,u.push(a)),G().getBool("WEBGL_PACK_NORMALIZATION")){var d=new T$(n.shape,r.shape,o.shape,c,l,i);return this.compileAndRun(d,u)}var f=new R$(n.shape,r.shape,o.shape,c,l,i);return this.compileAndRun(f,u)},e.prototype.localResponseNormalization4D=function(n,r,o,i,a){var s=G().getBool("WEBGL_PACK_NORMALIZATION")?new Sz(n.shape,r,o,i,a):new Cz(n.shape,r,o,i,a);return this.compileAndRun(s,[n])},e.prototype.LRNGrad=function(n,r,o,i,a,s,u){var c=new _z(r.shape,i,a,s,u);return this.compileAndRun(c,[r,o,n])},e.prototype.tile=function(n,r){if(n.dtype==="string"){var o=this.readSync(n.dataId).map(function(a){return gf(a)});return oR(Ce(n.shape,n.dtype,o),r)}var i=new qz(n.shape,r);return this.compileAndRun(i,[n])},e.prototype.pad=function(n,r,o){var i=G().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Pz(n.shape,r,o):new Az(n.shape,r,o);return this.compileAndRun(i,[n])},e.prototype.transpose=function(n,r){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.transpose(n,r);var o=G().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Yz(n.shape,r):new Xz(n.shape,r);return this.compileAndRun(o,[n])},e.prototype.gather=function(n,r,o){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.gather(n,r,o);var i=new rz(n.shape,r.size,o);return this.compileAndRun(i,[n,r])},e.prototype.batchToSpaceND=function(n,r,o){N(n.rank<=4,function(){return"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"});var i=r.reduce(function(d,f){return d*f}),a=Cf(n.shape,r,i),s=_f(a.length,r.length),u=Sf(n.shape,r,i),c=HI(o,r.length),l=GI(u,o,r.length);return n.reshape(a).transpose(s).reshape(u).slice(c,l)},e.prototype.spaceToBatchND=function(n,r,o){N(n.rank<=4,function(){return"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"});var i=r.reduce(function(f,h){return f*h}),a=[[0,0]];a.push.apply(a,o);for(var s=1+r.length;s<n.shape.length;++s)a.push([0,0]);var u=n.pad(a),c=Cf(u.shape,r,i,!1),l=_f(c.length,r.length,!1),d=Sf(u.shape,r,i,!1);return u.reshape(c).transpose(l).reshape(d)},e.prototype.reduce=function(n,r,o){var i=n.shape[0],a=n.shape[1],s=Yp(a),u=new Dz({windowSize:s,inSize:a,batchSize:i},r),c=this.compileAndRun(u,[n],o);return c.shape[1]===1?c:this.reduce(c,r,o)},e.prototype.argReduce=function(n,r,o){o===void 0&&(o=null);var i=n.shape[0],a=n.shape[1];o!=null&&(i=o.shape[0],a=o.shape[1]);var s=Yp(a),u=new x$({windowSize:s,inSize:a,batchSize:i},r,o==null),c=[n];o!=null&&c.push(o);var l=this.compileAndRun(u,c,"int32");return l.shape[1]===1?l:this.argReduce(n,r,l)},e.prototype.argReducePacked=function(n,r,o){o===void 0&&(o=null);var i=o!=null?o.shape:n.shape,a=Yp(i[i.length-1]),s=new S$(i,a,r,o==null),u=o==null?[n]:[n,o],c=this.compileAndRun(s,u,"int32");return c.rank===n.rank?this.argReducePacked(n,r,c):c},e.prototype.sum=function(n,r){_n("sum",r,n.rank);var o=Ht(n.shape,r),i=o[0],a=de(o[1]),s=n.as2D(-1,a),u=$p(n.dtype);return this.reduce(s,"sum",u).reshape(i)},e.prototype.prod=function(n,r){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.prod(n,r);var o=Ht(n.shape,r),i=o[0],a=de(o[1]),s=n.as2D(-1,a),u=$p(n.dtype);return this.reduce(s,"prod",u).reshape(i)},e.prototype.unsortedSegmentSum=function(n,r,o){var i=0,a=Qr([i],n.rank),s=n;a!=null&&(s=n.transpose(a),i=Jr(1,n.rank)[0]);var u=function(h,m,p){for(var g=[],v=h.length,y=0;y<v;y++)y!==m?g.push(h[y]):g.push(p);return g}(s.shape,i,o),c=de([s.shape[i]]),l=s.as2D(-1,c),d=$p(n.dtype),f=this.segOpCompute(l,"unsortedSegmentSum",r,d,o).reshape(u);return a!=null&&(f=f.transpose(Ky(a))),f},e.prototype.segOpCompute=function(n,r,o,i,a){var s=n.shape[0],u=n.shape[1],c=function(f,h){var m,p=!1;for(f<=qI?(m=f,p=!0):m=Wv(f,Math.floor(Math.sqrt(f)));!p;)m>h||m===f?p=!0:m=Wv(f,m+1);return m}(u,a),l=new $z({windowSize:c,inSize:u,batchSize:s,numSegments:a}),d=this.compileAndRun(l,[n,o],i);return d.shape[1]===a?d:(o=Ef(0,a).tile([u/c]),this.segOpCompute(d,r,o,i,a))},e.prototype.argMinMaxReduce=function(n,r,o){var i=[r];if(_n("arg"+o.charAt(0).toUpperCase()+o.slice(1),i,n.rank),!G().getBool("WEBGL_PACK_REDUCE")||n.rank<=2){var a=Ht(n.shape,i),s=a[0],u=de(a[1]),c=n.as2D(-1,u);return this.argReduce(c,o).reshape(s)}return this.argReducePacked(n,o)},e.prototype.argMin=function(n,r){return this.argMinMaxReduce(n,r,"min")},e.prototype.argMax=function(n,r){return this.argMinMaxReduce(n,r,"max")},e.prototype.cumsum=function(n,r,o,i){if(r!==n.rank-1)throw new Error("WebGL cumsum shader expects an inner-most axis="+(n.rank-1)+" but got axis="+r);var a=new H$(n.shape,o,i);return this.compileAndRun(a,[n])},e.prototype.equal=function(n,r){if(G().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(equal(a, b));
`,"bool");var o=new st("return float(a == b);",n.shape,r.shape);return this.compileAndRun(o,[n,r],"bool")},e.prototype.notEqual=function(n,r){if(G().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(notEqual(a, b));
`,"bool");var o=new st("return float(a != b);",n.shape,r.shape);return this.compileAndRun(o,[n,r],"bool")},e.prototype.less=function(n,r){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.less(n,r);if(G().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(lessThan(a, b));
`,"bool");var o=new st("return float(a < b);",n.shape,r.shape);return this.compileAndRun(o,[n,r],"bool")},e.prototype.lessEqual=function(n,r){if(G().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(lessThanEqual(a, b));
`,"bool");var o=new st("return float(a <= b);",n.shape,r.shape);return this.compileAndRun(o,[n,r],"bool")},e.prototype.greater=function(n,r){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.greater(n,r);if(G().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(greaterThan(a, b));
`,"bool");var o=new st("return float(a > b);",n.shape,r.shape);return this.compileAndRun(o,[n,r],"bool")},e.prototype.greaterEqual=function(n,r){if(G().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(greaterThanEqual(a, b));
`,"bool");var o=new st("return float(a >= b);",n.shape,r.shape);return this.compileAndRun(o,[n,r],"bool")},e.prototype.logicalNot=function(n){var r=new Re(n.shape,"return float(!(x >= 1.0));");return this.compileAndRun(r,[n])},e.prototype.logicalAnd=function(n,r){if(G().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,"bool");var o=new st("return float(a >= 1.0 && b >= 1.0);",n.shape,r.shape);return this.compileAndRun(o,[n,r],"bool")},e.prototype.logicalOr=function(n,r){if(G().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,"bool");var o=new st("return float(a >= 1.0 || b >= 1.0);",n.shape,r.shape);return this.compileAndRun(o,[n,r],"bool")},e.prototype.select=function(n,r,o){var i=new zz(n.rank,r.shape,r.rank);return this.compileAndRun(i,[n,r,o],Lt(r.dtype,o.dtype))},e.prototype.where=function(n){wf("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");var r=n.dataSync();return t0(n.shape,r)},e.prototype.topk=function(n,r,o){return iR(n.dataSync(),n.shape,n.dtype,r)},e.prototype.min=function(n,r){_n("min",r,n.rank);var o=Ht(n.shape,r),i=o[0],a=de(o[1]),s=n.as2D(-1,a);return this.reduce(s,"min",s.dtype).reshape(i)},e.prototype.minimum=function(n,r){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.minimum(n,r);var o=G().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new oo(`
  vec4 result = vec4(min(a, b));
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new st(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return min(a, b);
`,n.shape,r.shape);return this.compileAndRun(o,[n,r])},e.prototype.mod=function(n,r){var o=G().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new oo(`
  vec4 result = mod(a, b);
  vec4 isNaN = vec4(equal(b, vec4(0.0)));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new st(`if (b == 0.0) return NAN;
  return mod(a, b);`,n.shape,r.shape);return this.compileAndRun(o,[n,r])},e.prototype.max=function(n,r){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.max(n,r);_n("max",r,n.rank);var o=Ht(n.shape,r),i=o[0],a=de(o[1]),s=n.as2D(-1,a);return this.reduce(s,"max",s.dtype).reshape(i)},e.prototype.maximum=function(n,r){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.maximum(n,r);var o=G().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new oo(`
  vec4 result = vec4(max(a, b));
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new st(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return max(a, b);
`,n.shape,r.shape);return this.compileAndRun(o,[n,r])},e.prototype.all=function(n,r){_n("all",r,n.rank);var o=Ht(n.shape,r),i=o[0],a=de(o[1]),s=n.as2D(-1,a);return this.reduce(s,"all",s.dtype).reshape(i)},e.prototype.any=function(n,r){_n("any",r,n.rank);var o=Ht(n.shape,r),i=o[0],a=de(o[1]),s=n.as2D(-1,a);return this.reduce(s,"any",s.dtype).reshape(i)},e.prototype.realDivide=function(n,r){if(G().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,"float32",!0);var o=new st(`
if (a == b) {
  return 1.0;
};
return a / b;`,n.shape,r.shape);return this.compileAndRun(o,[n,r],"float32")},e.prototype.floorDiv=function(n,r){if(G().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,"int32");var o=new st(`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,n.shape,r.shape);return this.compileAndRun(o,[n,r],"int32")},e.prototype.add=function(n,r){if(n.dtype==="complex64"&&r.dtype==="complex64")return this.complexSeparableBinaryOp(n,r,Qp);if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.add(n,r);var o=Lt(n.dtype,r.dtype);if(G().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,Qp,o);var i=new st(Qp,n.shape,r.shape);return this.compileAndRun(i,[n,r],o)},e.prototype.packedUnaryOp=function(n,r,o){var i=new Su(n.shape,r);return this.compileAndRun(i,[n],o)},e.prototype.packedBinaryOp=function(n,r,o,i,a){a===void 0&&(a=!1);var s=new oo(o,n.shape,r.shape,a);return this.compileAndRun(s,[n,r],i)},e.prototype.complexSeparableBinaryOp=function(n,r,o){var i=this,a=this.texData.get(n.dataId),s=this.texData.get(r.dataId),u=[[a.complexTensors.real,s.complexTensors.real],[a.complexTensors.imag,s.complexTensors.imag]].map(function(f){var h=f[0],m=f[1],p=i.makeComplexComponentTensorInfo(n,h),g=i.makeComplexComponentTensorInfo(r,m),v=new st(o,n.shape,r.shape);return i.compileAndRun(v,[p,g],Lt(h.dtype,m.dtype))}),c=u[0],l=u[1],d=this.complex(c,l);return c.dispose(),l.dispose(),d},e.prototype.makeComplexComponentTensorInfo=function(n,r){return{dataId:r.dataId,dtype:r.dtype,shape:n.shape}},e.prototype.addN=function(n){if(n.length===1)return n[0];if(n.length>G().get("WEBGL_MAX_TEXTURES_IN_SHADER")){var r=Math.floor(n.length/2),o=this.addN(n.slice(0,r)),i=this.addN(n.slice(r));return this.addN([o,i])}var a=n.map(function(c){return c.dtype}).reduce(function(c,l){return Lt(c,l)}),s=n.map(function(c){return c.shape}),u=G().getBool("WEBGL_PACK")?new y$(n[0].shape,s):new g$(n[0].shape,s);return this.compileAndRun(u,n,a)},e.prototype.subtract=function(n,r){if(n.dtype==="complex64"&&r.dtype==="complex64")return this.complexSeparableBinaryOp(n,r,Jp);if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.subtract(n,r);var o=Lt(n.dtype,r.dtype);if(G().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,Jp,n.dtype);var i=new st(Jp,n.shape,r.shape);return this.compileAndRun(i,[n,r],o)},e.prototype.pow=function(n,r){var o=G().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new oo(`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  vec4 isNaN = vec4(lessThan(a, vec4(0.0))) * vec4(lessThan(floor(b), b));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new st(`
if(a < 0.0 && floor(b) < b){
  return NAN;
}
if (b == 0.0) {
  return 1.0;
}
return (round(mod(b, 2.0)) != 1) ?
    pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,n.shape,r.shape),i=Lt(n.dtype,r.dtype);return this.compileAndRun(o,[n,r],i)},e.prototype.ceil=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.ceil(n);if(G().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,wb,n.dtype);var r=new Re(n.shape,wb);return this.compileAndRun(r,[n])},e.prototype.floor=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.floor(n);if(G().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,bb,n.dtype);var r=new Re(n.shape,bb);return this.compileAndRun(r,[n])},e.prototype.sign=function(n){var r=new Re(n.shape,`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`);return this.compileAndRun(r,[n])},e.prototype.isNaN=function(n){var r=new Re(n.shape,"return float(isnan(x));");return this.compileAndRun(r,[n],"bool")},e.prototype.isInf=function(n){var r=new Re(n.shape,"return float(isinf(x));");return this.compileAndRun(r,[n],"bool")},e.prototype.isFinite=function(n){var r=new Re(n.shape,"return float(!isnan(x) && !isinf(x));");return this.compileAndRun(r,[n],"bool")},e.prototype.round=function(n){var r=new Re(n.shape,`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`);return this.compileAndRun(r,[n])},e.prototype.exp=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.exp(n);if(G().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,Eb,n.dtype);var r=new Re(n.shape,Eb);return this.compileAndRun(r,[n])},e.prototype.expm1=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.expm1(n);if(G().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,Cb,n.dtype);var r=new Re(n.shape,Cb);return this.compileAndRun(r,[n])},e.prototype.softmax=function(n,r){var o=_t([r],n.shape),i=this.max(n,o),a=bn(i.shape,o),s=this.subtract(n,i.reshape(a)),u=this.exp(s),c=this.sum(u,o).reshape(a);return this.realDivide(u,c)},e.prototype.log=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.log(n);if(G().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,`
  vec4 result = log(x);
  vec4 isNaN = vec4(lessThan(x, vec4(0.0)));
  result.r = isNaN.r == 1.0 ? NAN : result.r;
  result.g = isNaN.g == 1.0 ? NAN : result.g;
  result.b = isNaN.b == 1.0 ? NAN : result.b;
  result.a = isNaN.a == 1.0 ? NAN : result.a;

  return result;
`,n.dtype);var r=new Re(n.shape,`if (x < 0.0) return NAN;
  return log(x);`);return this.compileAndRun(r,[n])},e.prototype.log1p=function(n){var r=new Re(n.shape,"return log(1.0 + x);");return this.compileAndRun(r,[n])},e.prototype.sqrt=function(n){var r=new Re(n.shape,"return sqrt(x);");return this.compileAndRun(r,[n])},e.prototype.rsqrt=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.rsqrt(n);var r=new Re(n.shape,"return inversesqrt(x);");return this.compileAndRun(r,[n])},e.prototype.reciprocal=function(n){var r=new Re(n.shape,"return 1.0 / x;");return this.compileAndRun(r,[n])},e.prototype.relu=function(n){var r;return r=G().getBool("WEBGL_PACK")?new Su(n.shape,pR):new Re(n.shape,dR),this.compileAndRun(r,[n])},e.prototype.relu6=function(n){var r;return r=G().getBool("WEBGL_PACK")?new Su(n.shape,mR):new Re(n.shape,fR),this.compileAndRun(r,[n])},e.prototype.prelu=function(n,r){var o=G().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new oo(lR,n.shape,r.shape):new st(cR,n.shape,r.shape);return this.compileAndRun(o,[n,r])},e.prototype.elu=function(n){if(G().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,vR,n.dtype);var r=new Re(n.shape,hR);return this.compileAndRun(r,[n])},e.prototype.eluDer=function(n,r){var o=G().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new oo(`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,n.shape,r.shape):new st("return (b >= 1.0) ? a : a * (b + 1.0);",n.shape,r.shape);return this.compileAndRun(o,[n,r])},e.prototype.selu=function(n){var r=new Re(n.shape,Jz);return this.compileAndRun(r,[n])},e.prototype.int=function(n){var r=new Re(n.shape,"return float(int(x));");return this.compileAndRun(r,[n],"int32")},e.prototype.clip=function(n,r,o){var i,a=(i=G().getBool("WEBGL_PACK_CLIP")?new D$(n.shape):new P$(n.shape)).getCustomSetupFunc(r,o);return this.compileAndRun(i,[n],null,a)},e.prototype.abs=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.abs(n);if(G().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,yb,n.dtype);var r=new Re(n.shape,yb);return this.compileAndRun(r,[n])},e.prototype.complexAbs=function(n){var r=this.texData.get(n.dataId),o=new M$(n.shape),i=[this.makeComplexComponentTensorInfo(n,r.complexTensors.real),this.makeComplexComponentTensorInfo(n,r.complexTensors.imag)];return this.compileAndRun(o,i)},e.prototype.sigmoid=function(n){var r=new Re(n.shape,"return 1.0 / (1.0 + exp(-1.0 * x));");return this.compileAndRun(r,[n])},e.prototype.softplus=function(n){var r=new Re(n.shape,`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`);return this.compileAndRun(r,[n])},e.prototype.sin=function(n){var r=new Re(n.shape,Zz);return this.compileAndRun(r,[n])},e.prototype.cos=function(n){var r=new Re(n.shape,eV);return this.compileAndRun(r,[n])},e.prototype.tan=function(n){var r=new Re(n.shape,"return tan(x);");return this.compileAndRun(r,[n])},e.prototype.asin=function(n){var r=new Re(n.shape,tV);return this.compileAndRun(r,[n])},e.prototype.acos=function(n){var r=new Re(n.shape,nV);return this.compileAndRun(r,[n])},e.prototype.atan=function(n){var r=new Re(n.shape,rV);return this.compileAndRun(r,[n])},e.prototype.atan2=function(n,r){var o=G().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new oo(`
  vec4 result = atan(a, b);
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new st(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return atan(a, b);
`,n.shape,r.shape);return this.compileAndRun(o,[n,r])},e.prototype.sinh=function(n){var r=new Re(n.shape,`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`);return this.compileAndRun(r,[n])},e.prototype.cosh=function(n){var r=new Re(n.shape,`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`);return this.compileAndRun(r,[n])},e.prototype.tanh=function(n){var r=new Re(n.shape,`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`);return this.compileAndRun(r,[n])},e.prototype.asinh=function(n){var r=new Re(n.shape,oV);return this.compileAndRun(r,[n])},e.prototype.acosh=function(n){var r=new Re(n.shape,iV);return this.compileAndRun(r,[n])},e.prototype.atanh=function(n){var r=new Re(n.shape,aV);return this.compileAndRun(r,[n])},e.prototype.erf=function(n){var r=new Re(n.shape,`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = 0.3275911;
  float a1 = 0.254829592;
  float a2 = -0.284496736;
  float a3 = 1.421413741;
  float a4 = -1.453152027;
  float a5 = 1.061405429;

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`);return this.compileAndRun(r,[n])},e.prototype.step=function(n,r){var o=new Re(n.shape,function(i){return i===void 0&&(i=0),br+`
    return x > 0.0 ? 1.0 : float(`+i+`);
  `}(r));return this.compileAndRun(o,[n])},e.prototype.conv2dByMatMul=function(n,r,o,i,a,s){var u=n.shape,c=this.texData.get(n.dataId),l=o.inChannels,d=u[0]*u[1]*u[2],f=o.outChannels,h=o.dataFormat==="channelsLast",m=(d===1||f===1)&&l>1e3,p=u[2]%2!=0&&!!c.isPacked;if(m||!G().getBool("WEBGL_LAZILY_UNPACK")||!G().getBool("WEBGL_PACK_BINARY_OPERATIONS")||!p){var g=h?u[0]*u[1]*u[2]:u[0]*u[2]*u[3],v=this.reshape(n,[1,g,o.inChannels]),y=this.reshape(r,[1,o.inChannels,o.outChannels]);return this.reshape(this.fusedBatchMatMul({a:v,b:y,transposeA:!1,transposeB:!1,bias:i,activation:a,preluActivationWeights:s}),o.outShape)}var x=h?u[0]*u[1]*(u[2]+1):u[0]*u[2]*(u[3]+1),b={dataId:n.dataId,shape:[1,x,o.inChannels],dtype:n.dtype},E=c.shape;c.shape=c.shape.slice(),c.shape[c.shape.length-2]++,N(Hl(c.shape,b.shape),function(){return"packed reshape "+c.shape+" to "+b.shape+" isn't free"});var _=this.reshape(r,[1,o.inChannels,o.outChannels]),S=this.fusedBatchMatMul({a:b,b:_,transposeA:!1,transposeB:!1,bias:i,activation:a,preluActivationWeights:s}),k=this.texData.get(S.dataId);return N(k.isPacked,function(){return"batchMatMul result is expected to be packed"}),c.shape=E,k.shape=o.outShape,L.makeTensorFromDataId(S.dataId,o.outShape,S.dtype)},e.prototype.conv2dWithIm2Row=function(n,r,o,i,a,s){var u=o.filterWidth,c=o.filterHeight,l=o.inChannels,d=o.outWidth,f=o.outHeight,h=o.dataFormat==="channelsLast",m=u*c*l,p=f*d,g=[m,p],v=n.squeeze([0]),y=r.reshape([1,m,-1]),x=new Ez(g,v.shape,o),b=this.compileAndRun(x,[v]).reshape([1,g[0],g[1]]),E=i!=null,_=s!=null,S=a?Xl(a,!0):null,k=new Zp(b.shape,[1,p,o.outChannels],!0,!1,E,S,_),R=[b,y];i&&R.push(i),_&&R.push(s);var I=this.compileAndRun(k,R);return h?I.reshape([1,f,d,o.outChannels]):I.reshape([1,o.outChannels,f,d])},e.prototype.fusedConv2d=function(n){var r=n.input,o=n.filter,i=n.convInfo,a=n.bias,s=n.activation,u=n.preluActivationWeights;if(i.filterHeight===1&&i.filterWidth===1&&i.dilationHeight===1&&i.dilationWidth===1&&i.strideHeight===1&&i.strideWidth===1&&(i.padInfo.type==="SAME"||i.padInfo.type==="VALID"))return this.conv2dByMatMul(r,o,i,a,s,u);if(G().getBool("WEBGL_CONV_IM2COL")&&r.shape[0]===1)return this.conv2dWithIm2Row(r,o,i,a,s,u);var c=a!=null,l=u!=null,d=s?Xl(s,!1):null,f=new cb(i,c,d,l),h=[r,o];return a&&h.push(a),u&&h.push(u),this.compileAndRun(f,h)},e.prototype.conv2d=function(n,r,o){if(o.filterHeight===1&&o.filterWidth===1&&o.dilationHeight===1&&o.dilationWidth===1&&o.strideHeight===1&&o.strideWidth===1&&(o.padInfo.type==="SAME"||o.padInfo.type==="VALID"))return this.conv2dByMatMul(n,r,o);if(G().getBool("WEBGL_CONV_IM2COL")&&n.shape[0]===1)return this.conv2dWithIm2Row(n,r,o);var i=new cb(o);return this.compileAndRun(i,[n,r])},e.prototype.conv2dDerInput=function(n,r,o){var i=new B$(o);return this.compileAndRun(i,[n,r])},e.prototype.conv2dDerFilter=function(n,r,o){var i=new L$(o);return this.compileAndRun(i,[n,r])},e.prototype.fusedDepthwiseConv2D=function(n){var r,o=n.input,i=n.filter,a=n.convInfo,s=n.bias,u=n.activation,c=n.preluActivationWeights,l=G().getBool("WEBGL_PACK_DEPTHWISECONV")&&a.strideWidth<=2&&a.outChannels/a.inChannels==1,d=u?Xl(u,l):null,f=[o,i],h=s!=null,m=c!=null;return h&&f.push(s),m&&f.push(c),l?(r=new db(a,h,d,m),this.compileAndRun(r,f)):(r=new lb(a,h,d,m),this.compileAndRun(r,f))},e.prototype.depthwiseConv2D=function(n,r,o){var i;return G().getBool("WEBGL_PACK_DEPTHWISECONV")&&o.strideWidth<=2&&o.outChannels/o.inChannels==1?(i=new db(o),this.compileAndRun(i,[n,r])):(i=new lb(o),this.compileAndRun(i,[n,r]))},e.prototype.depthwiseConv2DDerInput=function(n,r,o){var i=new $$(o);return this.compileAndRun(i,[n,r])},e.prototype.depthwiseConv2DDerFilter=function(n,r,o){var i=new W$(o);return this.compileAndRun(i,[n,r])},e.prototype.conv3d=function(n,r,o){var i=new z$(o);return this.compileAndRun(i,[n,r])},e.prototype.conv3dDerInput=function(n,r,o){var i=new U$(o);return this.compileAndRun(i,[n,r])},e.prototype.conv3dDerFilter=function(n,r,o){var i=new j$(o);return this.compileAndRun(i,[n,r])},e.prototype.maxPool=function(n,r){var o=new em(r,"max",!1);return this.compileAndRun(o,[n])},e.prototype.avgPool=function(n,r){var o=new em(r,"avg",!1);return this.compileAndRun(o,[n],"float32")},e.prototype.maxPoolBackprop=function(n,r,o,i){var a=new em(i,"max",!0),s=this.compileAndRun(a,[r]),u=new kz(i),c=this.compileAndRun(u,[n,s],r.dtype);return s.dispose(),c},e.prototype.avgPoolBackprop=function(n,r,o){var i=new k$(o);return this.compileAndRun(i,[n],r.dtype)},e.prototype.cast=function(n,r){return eR(n,r,this)},e.prototype.unstack=function(n,r){for(var o=n.shape[r],i=new Array(n.rank-1),a=0,s=0;s<n.rank;s++)s!==r&&(i[a++]=n.shape[s]);var u=new Array(n.rank).fill(0),c=n.shape.slice();c[r]=1;var l=new Array(o);for(s=0;s<l.length;s++)u[r]=s,l[s]=this.slice(n,u,c).reshape(i);return l},e.prototype.avgPool3d=function(n,r){var o=new tm(r,"avg",!1);return this.compileAndRun(o,[n],"float32")},e.prototype.avgPool3dBackprop=function(n,r,o){var i=new I$(o);return this.compileAndRun(i,[n],r.dtype)},e.prototype.maxPool3d=function(n,r){var o=new tm(r,"max",!1);return this.compileAndRun(o,[n],"float32")},e.prototype.maxPool3dBackprop=function(n,r,o,i){var a=new tm(i,"max",!0),s=this.compileAndRun(a,[r]),u=new Iz(i),c=this.compileAndRun(u,[n,s],r.dtype);return s.dispose(),c},e.prototype.reshape=function(n,r){var o=this.texData.get(n.dataId);if(o.isPacked&&!Hl(n.shape,r)&&(o.texture===null||!Hl(o.shape,r))){var i=this.packedReshape(n,r);return L.makeTensorFromDataId(i.dataId,i.shape,i.dtype)}return Xv(n,r)},e.prototype.resizeBilinear=function(n,r,o,i){var a=G().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new Lz(n.shape,r,o,i):new Fz(n.shape,r,o,i);return this.compileAndRun(a,[n],"float32")},e.prototype.resizeBilinearBackprop=function(n,r,o){var i=new Oz(n,r,o);return this.compileAndRun(i,[n])},e.prototype.resizeNearestNeighbor=function(n,r,o,i){var a=new jz(n.shape,r,o,i);return this.compileAndRun(a,[n])},e.prototype.resizeNearestNeighborBackprop=function(n,r,o){var i=new Bz(n,r,o);return this.compileAndRun(i,[n])},e.prototype.multinomial=function(n,r,o,i){var a=r?n:No(n),s=a.shape[0],u=a.shape[1],c=new Rz(s,u,o),l=c.getCustomSetupFunc(i);return this.compileAndRun(c,[a],"int32",l)},e.prototype.oneHot=function(n,r,o,i){var a=new Tz(n.size,r,o,i);return this.compileAndRun(a,[n])},e.prototype.diag=function(n){var r=new X$(n.size);return this.compileAndRun(r,[n])},e.prototype.nonMaxSuppression=function(n,r,o,i,a){return wf("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead"),Zy(n.dataSync(),r.dataSync(),o,i,a)},e.prototype.cropAndResize=function(n,r,o,i,a,s){var u=new V$(n.shape,r.shape,i,a,s);return this.compileAndRun(u,[n,r,o],"float32")},e.prototype.depthToSpace=function(n,r,o){N(r>1,function(){return"blockSize should be > 1 for depthToSpace, but was: "+r});var i=n.shape[0],a=o==="NHWC"?n.shape[1]:n.shape[2],s=o==="NHWC"?n.shape[2]:n.shape[3],u=o==="NHWC"?n.shape[3]:n.shape[1],c=a*r,l=s*r,d=u/(r*r),f=new q$(o==="NHWC"?[i,c,l,d]:[i,d,c,l],r,o);return this.compileAndRun(f,[n])},e.prototype.split=function(n,r,o){return rR(n,r,o)},e.prototype.scatterND=function(n,r,o){var i=kf(0,n,o),a=i.sliceRank,s=i.numUpdates,u=i.sliceSize,c=i.strides,l=i.outputSize,d=[l/u,u],f=n.reshape([s,a]),h=r.reshape([s,u]);if(l===0)return Xv(Bt([]),o);var m=re(0),p=new mb(s,a,f.rank,h.rank,c,d);return this.compileAndRun(p,[h,f,m]).reshape(o)},e.prototype.sparseToDense=function(n,r,o,i){var a=kf(0,n,o),s=a.sliceRank,u=a.numUpdates,c=a.strides,l=a.outputSize,d=new mb(u,s,n.rank,r.rank,c,[l,1]);return this.compileAndRun(d,[r,n,i]).reshape(o)},e.prototype.fft=function(n){return this.fftImpl(n,!1)},e.prototype.ifft=function(n){return this.fftImpl(n,!0)},e.prototype.fftImpl=function(n,r){var o=this.texData.get(n.dataId),i=new hb(ez,n.shape,r),a=new hb(tz,n.shape,r),s=[this.makeComplexComponentTensorInfo(n,o.complexTensors.real),this.makeComplexComponentTensorInfo(n,o.complexTensors.imag)],u=this.compileAndRun(i,s),c=this.compileAndRun(a,s),l=this.complex(u,c).as2D(n.shape[0],n.shape[1]);return u.dispose(),c.dispose(),l},e.prototype.gatherND=function(n,r){var o=r.shape,i=o[o.length-1],a=KI(n,r),s=a[0],u=a[1],c=a[2],l=a[3],d=r.reshape([u,i]),f=n.reshape([n.size/c,c]),h=new oz(i,l,[u,c]);return this.compileAndRun(h,[f,d]).reshape(s)},e.prototype.fill=function(n,r,o){if((o=o||nl(r))==="string"){var i=vf(o,de(n));return i.fill(r),L.makeTensor(i,n,o,this)}var a=new nz(n,r),s=a.getCustomSetupFunc(r);return this.compileAndRun(a,[],o,s)},e.prototype.onesLike=function(n){if(n.dtype==="string")throw new Error("onesLike is not supported under string dtype");return this.fill(n.shape,1,n.dtype)},e.prototype.zerosLike=function(n){return this.fill(n.shape,n.dtype==="string"?"":0,n.dtype)},e.prototype.linspace=function(n,r,o){return tR(n,r,o)},e.prototype.makeTensorInfo=function(n,r){var o=this.write(null,n,r);return this.texData.get(o).usage=null,{dataId:o,shape:n,dtype:r}},e.prototype.makeOutput=function(n,r){var o=this.makeTensorInfo(n,r).dataId;return L.makeTensorFromDataId(o,n,r,this)},e.prototype.unpackTensor=function(n){var r=new uV(n.shape);return this.runWebGLProgram(r,[n],n.dtype)},e.prototype.packTensor=function(n){var r=new Nz(n.shape);return this.runWebGLProgram(r,[n],n.dtype,null,!0)},e.prototype.packedReshape=function(n,r){var o=[yf(n.shape)].concat(xf(n.shape)),i={dtype:n.dtype,shape:o,dataId:n.dataId},a=[yf(r)].concat(xf(r)),s=new Mz(a,o),u=this.runWebGLProgram(s,[i],n.dtype,null,!0);return{dataId:u.dataId,shape:r,dtype:u.dtype}},e.prototype.decode=function(n){var r,o=this.texData.get(n),i=o.isPacked,a=o.shape,s=o.dtype,u=Xp(a);return r=i?new K$(u):new G$(u),{dtype:s,shape:a,dataId:this.runWebGLProgram(r,[{shape:u,dtype:s,dataId:n}],s,null,!0).dataId}},e.prototype.runWebGLProgram=function(n,r,o,i,a){var s=this;a===void 0&&(a=!1);var u=this.makeTensorInfo(n.outputShape,o),c=this.texData.get(u.dataId);if(n.packedOutput&&(c.isPacked=!0),n.outPackingScheme===Rc.DENSE){var l=Gu(n.outputShape);c.texShape=l.map(function(x){return 2*x})}if(n.outTexUsage!=null&&(c.usage=n.outTexUsage),de(u.shape)===0)return c.values=kc(u.dtype,0),u;var d=[],f=r.map(function(x){if(x.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");var b=s.texData.get(x.dataId);if(b.texture==null){if(!n.packedInputs&&de(x.shape)<=G().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:x.shape,texData:null,isUniform:!0,uniformValues:b.values};n.packedInputs&&(b.isPacked=!0,b.shape=x.shape)}else if(!!b.isPacked!=!!n.packedInputs)x=b.isPacked?s.unpackTensor(x):s.packTensor(x),d.push(x),b=s.texData.get(x.dataId);else if(b.isPacked&&!Hl(b.shape,x.shape)){var E=x,_=x.shape;x.shape=b.shape,x=s.packedReshape(x,_),d.push(x),b=s.texData.get(x.dataId),E.shape=_}return s.uploadToGPU(x.dataId),{shape:x.shape,texData:b,isUniform:!1}});this.uploadToGPU(u.dataId);var h,m={shape:u.shape,texData:c,isUniform:!1},p=function(x,b,E){var _="";b.concat(E).forEach(function(R){var I=R.texData!=null&&R.texData.slice!=null&&R.texData.slice.flatOffset>0,D=R.isUniform?"uniform":R.texData.texShape;_+=R.shape+"_"+D+"_"+I});var S=x.userCode,k=x.constructor.name;return k+="_"+_+"_"+S}(n,f,m),g=this.getAndSaveBinary(p,function(){return function(x,b,E,_){var S=b.userCode,k=E.map(function(M,P){var B={logicalShape:M.shape,texShape:M.isUniform?null:M.texData.texShape,isUniform:M.isUniform,isPacked:!M.isUniform&&M.texData.isPacked,flatOffset:null};return M.texData!=null&&M.texData.slice!=null&&M.texData.slice.flatOffset>0&&(B.flatOffset=M.texData.slice.flatOffset),{name:b.variableNames[P],shapeInfo:B}}),R=k.map(function(M){return M.shapeInfo}),I={logicalShape:_.shape,texShape:_.texData.texShape,isUniform:!1,isPacked:_.texData.isPacked,flatOffset:null},D=w$(k,I,S,b.packedInputs),A=x.createProgram(D),W=null,F=x.getUniformLocation(A,"NAN",!1);G().getNumber("WEBGL_VERSION")===1&&(W=x.getUniformLocation(A,"INFINITY",!1));for(var $={},j=0;j<b.variableNames.length;j++){var U=b.variableNames[j];$[U]=x.getUniformLocation(A,U,!1),$["offset"+U]=x.getUniformLocation(A,"offset"+U,!1)}return{program:b,source:D,webGLProgram:A,uniformLocations:$,inShapeInfos:R,outShapeInfo:I,infLoc:W,nanLoc:F}}(s.gpgpu,n,f,m)}),v=this.activeTimers!=null;if(v&&(h=this.startTimer()),function(x,b,E,_,S){pb(b.inShapeInfos,E),pb([b.outShapeInfo],[_]);var k=_.texData.texture,R=_.texData.texShape;_.texData.isPacked?x.setOutputPackedMatrixTexture(k,R[0],R[1]):x.setOutputMatrixTexture(k,R[0],R[1]),x.setProgram(b.webGLProgram),G().getNumber("WEBGL_VERSION")===1&&b.infLoc!==null&&x.gl.uniform1f(b.infLoc,1/0),b.nanLoc!==null&&x.gl.uniform1f(b.nanLoc,NaN),E.forEach(function(I,D){var A=b.program.variableNames[D],W=b.uniformLocations[A],F=b.uniformLocations["offset"+A];if(W!=null)if(I.isUniform)if(de(I.shape)<2)x.gl.uniform1f(W,I.uniformValues[0]);else{var $=I.uniformValues;$ instanceof Float32Array||($=new Float32Array($)),x.gl.uniform1fv(W,$)}else I.texData.slice!=null&&F!=null&&x.gl.uniform1i(F,I.texData.slice.flatOffset),x.setInputMatrixTexture(I.texData.texture,W,D)}),S!=null&&S(x,b.webGLProgram),x.executeProgram()}(this.gpgpu,g,f,m,i),d.forEach(function(x){return s.disposeData(x.dataId)}),v&&(h=this.endTimer(h),this.activeTimers.push({name:n.constructor.name,query:this.getQueryTime(h)})),!G().getBool("WEBGL_LAZILY_UNPACK")&&c.isPacked&&a===!1){var y=this.unpackTensor(u);return this.disposeData(u.dataId),y}return u},e.prototype.compileAndRun=function(n,r,o,i,a){a===void 0&&(a=!1),o=o||r[0].dtype;var s=this.runWebGLProgram(n,r,o,i,a);return L.makeTensorFromDataId(s.dataId,s.shape,s.dtype)},e.prototype.getAndSaveBinary=function(n,r){return n in this.binaryCache||(this.binaryCache[n]=r()),this.binaryCache[n]},e.prototype.getTextureManager=function(){return this.textureManager},e.prototype.dispose=function(){var n=this;this.disposed||(G().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(function(r){n.gpgpu.deleteProgram(n.binaryCache[r].webGLProgram),delete n.binaryCache[r]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)},e.prototype.floatPrecision=function(){var n=this;return this.floatPrecisionValue==null&&(this.floatPrecisionValue=se(function(){if(!G().get("WEBGL_RENDER_FLOAT32_ENABLED")){var r=G().getBool("DEBUG");G().set("DEBUG",!1);var o=n.abs(re(1e-8)).dataSync()[0];if(G().set("DEBUG",r),o>0)return 32}return 16})),this.floatPrecisionValue},e.prototype.epsilon=function(){return this.floatPrecision()===32?1e-7:1e-4},e.prototype.uploadToGPU=function(n){var r,o=this.texData.get(n),i=o.shape,a=o.dtype,s=o.values,u=o.texture,c=o.usage,l=o.isPacked;if(u==null){var d,f=this.activeTimers!=null;f&&(d=Ar());var h=o.texShape;if(h==null&&(h=vW(i,l),o.texShape=h),s!=null){var m=Xp(i),p=void 0,g=h[1],v=h[0],y=s instanceof Uint8Array;l?(g=(r=ol(h[0],h[1]))[0],v=r[1],p=new Z$(m,[v,g],y)):p=new J$(m,[v,g],y);var x=this.makeTensorInfo([v,g],a);this.texData.get(x.dataId).usage=y?Rn.PIXELS:Rn.UPLOAD,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(x.dataId),g,v,s);var b=this.runWebGLProgram(p,[x],a,null,!0),E=this.texData.get(b.dataId);o.texture=E.texture,o.texShape=E.texShape,o.isPacked=E.isPacked,o.usage=E.usage,this.disposeData(x.dataId),this.texData.delete(b.dataId),o.values=null,f&&(this.uploadWaitMs+=Ar()-d)}else{var _=this.acquireTexture(h,c,a,l);o.texture=_}}},e.prototype.convertAndCacheOnCPU=function(n,r){var o=this.texData.get(n),i=o.dtype;return this.releaseGPUData(n),r!=null&&(o.values=function(a,s){if(s==="float32"||s==="complex64")return a;if(s==="int32"||s==="bool"){for(var u=s==="int32"?new Int32Array(a.length):new Uint8Array(a.length),c=0;c<u.length;++c)u[c]=Math.round(a[c]);return u}throw new Error("Unknown dtype "+s)}(r,i)),o.values},e.prototype.acquireTexture=function(n,r,o,i){if(this.numBytesInGPU+=this.computeBytes(n,o),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){var a=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: "+a+" MB, most likely due to a memory leak")}return this.textureManager.acquireTexture(n,r,i)},e.prototype.computeBytes=function(n,r){return n[0]*n[1]*TI(r)},e}(JI);FI()&&L.registerBackend("webgl",function(){return new lV},2);var dV=O({square_:function(t){var e=T(t,"x","square"),n=[e];return L.runKernelFunc(function(r,o){return o([e]),r.square(e)},{x:e},null,"Square",{},n,[])}}),Nc="SquaredDifference",gR=O({squaredDifference_:function(t,e){var n,r=T(t,"a","squaredDifference"),o=T(e,"b","squaredDifference");n=at(r,o),r=n[0],o=n[1],Pe(r.shape,o.shape);var i={a:r,b:o},a=[r,o];return L.runKernelFunc(function(s,u){var c=s.squaredDifference(r,o);return u([r,o]),c},i,function(s,u){var c=u[0],l=u[1],d=re(2);return{a:function(){return s.mul(c.sub(l).mul(d))},b:function(){return s.mul(l.sub(c).mul(d))}}},Nc,{},a,[])}}),fV=O({abs_:function(t){var e=T(t,"x","abs");return e.dtype==="complex64"?L.runKernelFunc(function(n){return n.complexAbs(e)},{$x:e}):L.runKernelFunc(function(n,r){var o=n.abs(e);return r([e]),o},{x:e},function(n,r){var o=r[0];return{x:function(){return n.mul(o.toFloat().step(-1))}}},"Abs")}}),hV=O({acos_:function(t){var e=T(t,"x","acos");return L.runKernelFunc(function(n,r){var o=n.acos(e);return r([e]),o},{$x:e},function(n,r){var o=r[0];return{$x:function(){return n.divStrict(re(1).sub(o.toFloat().square()).sqrt()).neg()}}})}}),pV=O({acosh_:function(t){var e=T(t,"x","acosh");return L.runKernelFunc(function(n,r){var o=n.acosh(e);return r([e]),o},{$x:e},function(n,r){var o=r[0];return{$x:function(){return n.divStrict(o.toFloat().square().sub(1).sqrt())}}})}}),mV=O({asin_:function(t){var e=T(t,"x","asin");return L.runKernelFunc(function(n,r){var o=n.asin(e);return r([e]),o},{$x:e},function(n,r){var o=r[0];return{$x:function(){return n.divStrict(re(1).sub(o.toFloat().square()).sqrt())}}})}}),vV=O({asinh_:function(t){var e=T(t,"x","asinh");return L.runKernelFunc(function(n,r){var o=n.asinh(e);return r([e]),o},{$x:e},function(n,r){var o=r[0];return{$x:function(){return n.divStrict(re(1).add(o.toFloat().square()).sqrt())}}})}}),gV=O({atan_:function(t){var e=T(t,"x","atan");return L.runKernelFunc(function(n,r){var o=n.atan(e);return r([e]),o},{$x:e},function(n,r){var o=r[0];return{$x:function(){return n.div(o.toFloat().square().add(1))}}})}}),yV=O({atanh_:function(t){var e=T(t,"x","atanh");return L.runKernelFunc(function(n,r){var o=n.atanh(e);return r([e]),o},{$x:e},function(n,r){var o=r[0];return{$x:function(){return n.div(re(1).sub(o.toFloat().square()))}}})}}),xV=O({ceil_:function(t){var e=T(t,"x","ceil");return L.runKernelFunc(function(n){return n.ceil(e)},{$x:e},function(n){return{$x:function(){return Fe(n)}}})}}),i0=O({clipByValue_:function(t,e,n){var r=T(t,"x","clipByValue");N(e<=n,function(){return"Error in clip: min ("+e+") must be less than or equal to max ("+n+")."});var o=[r],i={min:e,max:n};return L.runKernelFunc(function(a,s){var u=a.clip(r,e,n);return s([r]),u},{x:r},function(a,s){var u=s[0];return{x:function(){return a.where(u.greaterEqual(e).logicalAnd(u.lessEqual(n)),Fe(a))}}},"ClipByValue",i,o)}}),wV=O({cos_:function(t){var e=T(t,"x","cos"),n=[e];return L.runKernelFunc(function(r,o){var i=r.cos(e);return o([e]),i},{x:e},function(r,o){var i=o[0];return{x:function(){return i.toFloat().sin().neg().mul(r)}}},"Cos",{},n)}}),bV=O({cosh_:function(t){var e=T(t,"x","cosh");return L.runKernelFunc(function(n,r){var o=n.cosh(e);return r([e]),o},{$x:e},function(n,r){var o=r[0];return{$x:function(){return o.toFloat().sinh().mulStrict(n)}}})}}),EV=O({erf_:function(t){var e=T(t,"x","erf");return N(e.dtype==="int32"||e.dtype==="float32",function(){return"Input dtype must be `int32` or `float32`."}),e.dtype==="int32"&&(e=e.toFloat()),L.runKernelFunc(function(n,r){var o=n.erf(e);return r([e]),o},{$x:e},function(n,r){var o=r[0];return{$x:function(){return n.mul(o.square().neg().exp().mul(2/Math.sqrt(Math.PI)))}}})}}),Qv=O({exp_:function(t){var e=T(t,"x","exp");return L.runKernelFunc(function(n,r){var o=n.exp(e);return r([o]),o},{x:e},function(n,r){return{x:function(){return n.mulStrict(r[0])}}},"Exp",{},[],[!0])}}),CV=O({expm1_:function(t){var e=T(t,"x","expm1");return L.runKernelFunc(function(n,r){var o=n.expm1(e);return r([e]),o},{$x:e},function(n,r){var o=r[0];return{$x:function(){return n.mul(o.exp())}}})}}),_V=O({floor_:function(t){var e=T(t,"x","floor");return L.runKernelFunc(function(n){return n.floor(e)},{$x:e},function(n){return{$x:function(){return Fe(n)}}})}}),SV=O({log_:function(t){var e=T(t,"x","log"),n=[e];return L.runKernelFunc(function(r,o){var i=r.log(e);return o([e]),i},{x:e},function(r,o){var i=o[0];return{x:function(){return r.div(i.toFloat())}}},"Log",{},n)}}),kV=O({log1p_:function(t){var e=T(t,"x","log1p");return L.runKernelFunc(function(n,r){var o=n.log1p(e);return r([e]),o},{$x:e},function(n,r){var o=r[0];return{$x:function(){return n.div(o.add(1))}}})}}),IV=O({logSigmoid_:function(t){var e=T(t,"x","logSigmoid");return L.runKernelFunc(function(n,r){var o=n.softplus(e.neg()).neg();return r([e]),o},{$x:e},function(n,r){var o=r[0];return{$x:function(){return n.mul(o.neg().sigmoid())}}})}}),Nf=O({neg_:function(t){var e=T(t,"x","neg"),n=[e];return L.runKernelFunc(function(r){return r.neg(e)},{x:e},function(r){return{x:function(){return r.neg()}}},"Neg",{},n)}}),RV=O({reciprocal_:function(t){var e=T(t,"x","reciprocal");return L.runKernelFunc(function(n,r){var o=n.reciprocal(e);return r([e]),o},{$x:e},function(n,r){var o=r[0];return{$x:function(){return n.div(o.square().neg())}}})}}),TV=O({round_:function(t){var e=T(t,"x","round");return L.runKernelFunc(function(n){return n.round(e)},{$x:e},function(n){return{$x:function(){return Fe(n)}}})}}),yR=O({rsqrt_:function(t){var e=T(t,"x","rsqrt"),n=[e];return L.runKernelFunc(function(r,o){var i=r.rsqrt(e);return o([e]),i},{x:e},function(r,o){var i=o[0];return{x:function(){return r.div(i.pow(1.5).mul(2)).neg()}}},"Rsqrt",{},n)}}),xR=O({sigmoid_:function(t){var e=T(t,"x","sigmoid");return L.runKernelFunc(function(n,r){var o=n.sigmoid(e);return r([o]),o},{x:e},function(n,r){var o=r[0];return{x:function(){return n.mul(o.mul(re(1).sub(o)))}}},"Sigmoid")}}),NV=O({sign_:function(t){var e=T(t,"x","sign");return L.runKernelFunc(function(n){return n.sign(e)},{$x:e},function(n){return{$x:function(){return Fe(n)}}})}}),AV=O({isNaN_:function(t){var e=T(t,"x","isNaN");return L.runKernelFunc(function(n){return n.isNaN(e)},{$x:e},function(n){return{$x:function(){return Fe(n)}}})}}),PV=O({isInf_:function(t){var e=T(t,"x","isInf");return L.runKernelFunc(function(n){return n.isInf(e)},{$x:e},function(n){return{$x:function(){return Fe(n)}}})}}),DV=O({isFinite_:function(t){var e=T(t,"x","isFinite");return L.runKernelFunc(function(n){return n.isFinite(e)},{$x:e},function(n){return{$x:function(){return Fe(n)}}})}}),MV=O({sin_:function(t){var e=T(t,"x","sin"),n=[e];return L.runKernelFunc(function(r,o){var i=r.sin(e);return o([e]),i},{x:e},function(r,o){var i=o[0];return{x:function(){return i.toFloat().cos().mul(r)}}},"Sin",{},n)}}),OV=O({sinh_:function(t){var e=T(t,"x","sinh");return L.runKernelFunc(function(n,r){var o=n.sinh(e);return r([e]),o},{$x:e},function(n,r){var o=r[0];return{$x:function(){return o.toFloat().cosh().mulStrict(n)}}})}}),FV=O({softplus_:function(t){var e=T(t,"x","softplus");return L.runKernelFunc(function(n,r){var o=n.softplus(e);return r([e]),o},{$x:e},function(n,r){var o=r[0];return{$x:function(){return n.mul(o.sigmoid())}}})}}),LV=O({sqrt_:function(t){var e=T(t,"x","sqrt");return L.runKernelFunc(function(n,r){var o=n.sqrt(e);return r([e]),o},{$x:e},function(n,r){var o=r[0];return{$x:function(){return n.div(o.toFloat().sqrt().mul(2))}}})}}),BV=O({step_:function(t,e){e===void 0&&(e=0);var n=T(t,"x","step");return L.runKernelFunc(function(r){return r.step(n,e)},{$x:n},function(r){return{$x:function(){return Fe(r)}}})}}),jV=O({tan_:function(t){var e=T(t,"x","tan");return L.runKernelFunc(function(n,r){var o=n.tan(e);return r([e]),o},{$x:e},function(n,r){var o=r[0];return{$x:function(){return n.div(o.cos().square())}}})}}),UV=O({tanh_:function(t){var e=T(t,"x","tanh");return L.runKernelFunc(function(n,r){var o=n.tanh(e);return r([o]),o},{x:e},function(n,r){var o=r[0];return{x:function(){return re(1).sub(o.square()).mulStrict(n)}}},"Tanh",{},null,[!0])}});function wR(t,e,n,r,o,i){var a,s,u=T(t,"x","batchNorm"),c=T(e,"mean","batchNorm"),l=T(n,"variance","batchNorm");return o!=null&&(a=T(o,"scale","batchNorm")),r!=null&&(s=T(r,"offset","batchNorm")),N(u.rank===2,function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+u.rank+"."}),N(c.rank===2||c.rank===1,function(){return"Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank "+c.rank+"."}),N(l.rank===2||l.rank===1,function(){return"Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank "+l.rank+"."}),a!=null&&N(a.rank===2||a.rank===1,function(){return"Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank "+a.rank+"."}),s!=null&&N(s.rank===2||s.rank===1,function(){return"Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank "+s.rank+"."}),al(u,c,l,s,a,i)}function bR(t,e,n,r,o,i){var a,s,u=T(t,"x","batchNorm"),c=T(e,"mean","batchNorm"),l=T(n,"variance","batchNorm");return o!=null&&(a=T(o,"scale","batchNorm")),r!=null&&(s=T(r,"offset","batchNorm")),N(u.rank===3,function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+u.rank+"."}),N(c.rank===3||c.rank===1,function(){return"Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank "+c.rank+"."}),N(l.rank===3||l.rank===1,function(){return"Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank "+l.rank+"."}),a!=null&&N(a.rank===3||a.rank===1,function(){return"Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank "+a.rank+"."}),s!=null&&N(s.rank===3||s.rank===1,function(){return"Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank "+s.rank+"."}),al(u,c,l,s,a,i)}function ER(t,e,n,r,o,i){var a,s,u=T(t,"x","batchNorm"),c=T(e,"mean","batchNorm"),l=T(n,"variance","batchNorm");return o!=null&&(a=T(o,"scale","batchNorm")),r!=null&&(s=T(r,"offset","batchNorm")),N(u.rank===4,function(){return"Error in batchNorm4D: x must be rank 4 but got rank "+u.rank+"."}),N(c.rank===4||c.rank===1,function(){return"Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank "+c.rank+"."}),N(l.rank===4||l.rank===1,function(){return"Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank "+l.rank+"."}),a!=null&&N(a.rank===4||a.rank===1,function(){return"Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank "+a.rank+"."}),s!=null&&N(s.rank===4||s.rank===1,function(){return"Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank "+s.rank+"."}),al(u,c,l,s,a,i)}function al(t,e,n,r,o,i){i==null&&(i=.001);var a,s,u,c=T(t,"x","batchNorm"),l=T(e,"mean","batchNorm"),d=T(n,"variance","batchNorm");o!=null&&(a=T(o,"scale","batchNorm")),r!=null&&(s=T(r,"offset","batchNorm")),N(l.rank===d.rank,function(){return"Batch normalization gradient requires mean and variance to have equal ranks."}),N(s==null||l.rank===s.rank,function(){return"Batch normalization gradient requires mean and offset to have equal ranks."}),N(a==null||l.rank===a.rank,function(){return"Batch normalization gradient requires mean and scale to have equal ranks."}),u=c.rank===0||c.rank===1?c.as4D(1,1,1,c.size):c.rank===2?c.as4D(1,1,c.shape[0],c.shape[1]):c.rank===3?c.as4D(1,c.shape[0],c.shape[1],c.shape[2]):c;var f=[c,l,d,a];return L.runKernelFunc(function(h,m){var p=h.batchNormalization(u,Yl(l),Yl(d),i,Yl(a),Yl(s));return m([c,l,d,a]),p},{x:c,mean:l,variance:d,scale:a,offset:s},function(h,m){var p=m,g=p[0],v=p[1],y=p[2],x=p[3],b=x??re(1),E=Et(v.shape,u.shape),_=[];if(v.rank===1){for(var S=0;S<u.shape.length-1;++S)_.push(u.shape[S]);_.push(1)}var k=g.sub(v),R=h.mul(b),I=yR(y.add(re(i))),D=I.mul(I).mul(I).mul(re(-.5));return{x:function(){return v.rank===1?h.mul(bs(I.as4D(1,1,1,v.shape[0]),_)).mul(b).reshape(g.shape):h.mul(I).mul(b).reshape(g.shape)},mean:function(){var A=I.mul(re(-1)).mul(R);return v.rank===1&&(A=A.sum(E)),A.reshape(v.shape)},variance:function(){var A=D.mul(k).mul(R);return v.rank===1&&(A=A.sum(E)),A.reshape(v.shape)},scale:function(){var A=k.mul(I),W=h.mul(A);return v.rank===1&&(W=W.sum(E)),W.reshape(v.shape)},offset:function(){var A=h;return v.rank===1&&(A=A.sum(E)),A.reshape(v.shape)}}},"BatchNormalization",{varianceEpsilon:i},f).reshape(c.shape)}function Yl(t){return t==null?null:t.rank===0?t.as1D():t.rank===1?t:t.rank===2?t.as4D(1,1,t.shape[0],t.shape[1]):t.rank===3?t.as4D(1,t.shape[0],t.shape[1],t.shape[2]):t}function Ih(){LI("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon")}var WV=O({batchNormalization2d_:function(t,e,n,r,o,i){return r===void 0&&(r=.001),Ih(),wR(t,e,n,i,o,r)}}),$V=O({batchNormalization3d_:function(t,e,n,r,o,i){return r===void 0&&(r=.001),Ih(),bR(t,e,n,i,o,r)}}),zV=O({batchNormalization4d_:function(t,e,n,r,o,i){return r===void 0&&(r=.001),Ih(),ER(t,e,n,i,o,r)}}),VV=O({batchNormalization_:function(t,e,n,r,o,i){return r===void 0&&(r=.001),Ih(),al(t,e,n,i,o,r)}}),CR=O({batchNorm_:al}),HV=O({batchNorm2d_:wR}),GV=O({batchNorm3d_:bR}),KV=O({batchNorm4d_:ER}),Rh=O({logicalAnd_:function(t,e){var n=T(t,"a","logicalAnd","bool"),r=T(e,"b","logicalAnd","bool");return Pe(n.shape,r.shape),L.runKernelFunc(function(o){return o.logicalAnd(n,r)},{a:n,b:r},null,"LogicalAnd")}}),qV=O({logicalNot_:function(t){var e=T(t,"x","logicalNot","bool");return L.runKernelFunc(function(n){return n.logicalNot(e)},{$x:e})}}),_R=O({logicalOr_:function(t,e){var n=T(t,"a","logicalOr","bool"),r=T(e,"b","logicalOr","bool");return Pe(n.shape,r.shape),L.runKernelFunc(function(o){return o.logicalOr(n,r)},{$a:n,$b:r})}}),XV=O({logicalXor_:function(t,e){var n=T(t,"a","logicalXor","bool"),r=T(e,"b","logicalXor","bool");return Pe(n.shape,r.shape),_R(t,e).logicalAnd(Rh(t,e).logicalNot())}}),xa=O({where_:function(t,e,n){var r=T(e,"a","where"),o=T(n,"b","where"),i=T(t,"condition","where","bool");return $e(r.shape,o.shape,"Error in where: "),i.rank===1?N(i.shape[0]===r.shape[0],function(){return"The first dimension of `a` must match the size of `condition`."}):$e(i.shape,o.shape,"Error in where: "),L.runKernelFunc(function(a,s){var u=a.select(i,r,o);return s([i]),u},{$condition:i,$a:r,$b:o},function(a,s){var u=s[0];return{$condition:function(){return Fe(u).toFloat()},$a:function(){return a.mul(u.cast(a.dtype))},$b:function(){return a.mul(u.logicalNot().cast(a.dtype))}}})}}),SR=function(t){return ce(this,void 0,void 0,function(){var e,n,r;return le(this,function(o){switch(o.label){case 0:return[4,(e=T(t,"condition","whereAsync","bool")).data()];case 1:return n=o.sent(),r=t0(e.shape,n),t!==e&&e.dispose(),[2,r]}})})},Te=O({add_:function(t,e){var n,r=T(t,"a","add"),o=T(e,"b","add");n=at(r,o),r=n[0],o=n[1];var i=Pe(r.shape,o.shape);return L.runKernelFunc(function(a){return a.add(r,o)},{a:r,b:o},function(a){return{a:function(){var s=a,u=Et(r.shape,i);return u.length>0&&(s=s.sum(u)),s.reshape(r.shape)},b:function(){var s=a,u=Et(o.shape,i);return u.length>0&&(s=s.sum(u)),s.reshape(o.shape)}}},"Add")}}),YV=O({addN_:function(t){N(Array.isArray(t),function(){return"The argument passed to tf.addN() must be a list of tensors"}),N(t.length>=1,function(){return"Must pass at least one tensor to tf.addN(), but got "+t.length});var e=t.map(function(o,i){return T(o,"tensors"+i,"addN")}),n=e[0];e.forEach(function(o){if(o.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),e.forEach(function(o){if(!At(o.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});var r=e;return L.runKernelFunc(function(o){return o.addN(e)},r,function(o){var i={};return e.forEach(function(a,s){i[s]=function(){return o.clone()}}),i},"AddN")}}),QV=O({addStrict_:function(t,e){var n=T(t,"a","addStrict"),r=T(e,"b","addStrict");return $e(n.shape,r.shape,"Error in addStrict: "),n.add(r)}}),JV=O({atan2_:function(t,e){var n,r=T(t,"a","atan2"),o=T(e,"b","atan2");n=at(r,o),r=n[0],o=n[1];var i=Pe(r.shape,o.shape);return L.runKernelFunc(function(a,s){var u=a.atan2(r,o);return s([r,o]),u},{$a:r,$b:o},function(a,s){var u=s[0],c=s[1];return{$a:function(){var l=Te(u.square(),c.square()),d=a.mul(c.div(l)),f=Et(u.shape,i);return f.length>0&&(d=d.sum(f)),d.reshape(u.shape)},$b:function(){var l=Te(u.square(),c.square()),d=Nf(a.mul(u.div(l))),f=Et(c.shape,i);return f.length>0&&(d=d.sum(f)),d.reshape(c.shape)}}})}}),cr=O({div_:function(t,e){var n,r=T(t,"a","div"),o=T(e,"b","div");if(n=at(r,o),r=n[0],o=n[1],r.dtype==="int32"&&o.dtype==="int32")return kR(r,o);var i=Pe(r.shape,o.shape);return L.runKernelFunc(function(a,s){var u=a.realDivide(r,o);return s([r,o]),u},{a:r,b:o},function(a,s){var u=s[0],c=s[1];return{a:function(){var l=a.div(c.toFloat()),d=Et(u.shape,i);return d.length>0?l.sum(d).reshape(u.shape):l},b:function(){var l=a.mul(u.toFloat()),d=Et(c.shape,i);d.length>0&&(l=l.sum(d).reshape(c.shape));var f=c.square();return l.div(f.toFloat()).neg()}}},"Div")}}),ZV=O({divNoNan_:function(t,e){var n,r=T(t,"a","div"),o=T(e,"b","div");r=(n=at(r,o))[0],o=n[1];var i=cr(r,o),a=Fe(i),s=o.equal(a);return xa(s,a,i)}}),eH=O({divStrict_:function(t,e){var n=T(t,"a","div"),r=T(e,"b","div");return $e(n.shape,r.shape,"Error in divideStrict: "),n.div(r)}}),kR=O({floorDiv_:function(t,e){var n,r=T(t,"a","floorDiv"),o=T(e,"b","floorDiv");n=at(r,o),r=n[0],o=n[1];var i=Pe(r.shape,o.shape);return L.runKernelFunc(function(a,s){var u=a.floorDiv(r,o);return s([r,o]),u},{a:r,b:o},function(a,s){var u=s[0],c=s[1];return{a:function(){var l=a.div(c.toFloat()),d=Et(u.shape,i);return d.length>0?l.sum(d).reshape(u.shape):l},b:function(){var l=a.mul(u.toFloat()),d=Et(c.shape,i);d.length>0&&(l=l.sum(d).reshape(c.shape));var f=c.square();return l.div(f.toFloat()).neg()}}},"FloorDiv")}}),a0=O({maximum_:function(t,e){var n,r=T(t,"a","maximum"),o=T(e,"b","maximum");return n=at(r,o),r=n[0],o=n[1],r.dtype==="bool"&&(r=r.toInt(),o=o.toInt()),Pe(r.shape,o.shape),L.runKernelFunc(function(i,a){var s=i.maximum(r,o);return a([r,o]),s},{a:r,b:o},function(i,a){var s=a[0],u=a[1];return{a:function(){return i.mul(s.greaterEqual(u).toFloat())},b:function(){return i.mul(s.less(u).toFloat())}}},"Maximum")}}),tH=O({maximumStrict_:function(t,e){var n=T(t,"a","maximumStrict"),r=T(e,"b","maximumStrict");return $e(n.shape,r.shape,"Error in maximumStrict: "),n.maximum(r)}}),IR=O({minimum_:function(t,e){var n,r=T(t,"a","minimum"),o=T(e,"b","minimum");return n=at(r,o),r=n[0],o=n[1],r.dtype==="bool"&&(r=r.toInt(),o=o.toInt()),Pe(r.shape,o.shape),L.runKernelFunc(function(i,a){var s=i.minimum(r,o);return a([r,o]),s},{a:r,b:o},function(i,a){var s=a[0],u=a[1];return{a:function(){return i.mul(s.lessEqual(u).toFloat())},b:function(){return i.mul(s.greater(u).toFloat())}}},"Minimum")}}),nH=O({minimumStrict_:function(t,e){var n=T(t,"a","minimumStrict"),r=T(e,"b","minimumStrict");return $e(n.shape,r.shape,"Error in minimumStrict: "),n.minimum(r)}}),rH=O({mod_:function(t,e){var n,r=T(t,"a","mod"),o=T(e,"b","mod");n=at(r,o),r=n[0],o=n[1];var i=Pe(r.shape,o.shape);return L.runKernelFunc(function(a,s){var u=a.mod(r,o);return s([r,o]),u},{$a:r,$b:o},function(a,s){var u=s[0],c=s[1];return{$a:function(){var l=Et(u.shape,i);return l.length>0?a.sum(l).reshape(u.shape):a},$b:function(){var l=a.mul(u.div(c).floor().neg()),d=Et(c.shape,i);return d.length>0?l.sum(d).reshape(c.shape):l}}})}}),oH=O({modStrict_:function(t,e){var n=T(t,"a","modStrict"),r=T(e,"b","modStrict");return $e(n.shape,r.shape,"Error in modStrict: "),n.mod(r)}}),Yt=O({mul_:function(t,e){var n,r=T(t,"a","mul"),o=T(e,"b","mul");n=at(r,o),r=n[0],o=n[1];var i=Pe(r.shape,o.shape);return L.runKernelFunc(function(a,s){var u=a.multiply(r,o);return s([r,o]),u},{a:r,b:o},function(a,s){var u=s[0],c=s[1];return{a:function(){var l=a.mul(c.toFloat()),d=Et(u.shape,i);return d.length>0?l.sum(d).reshape(u.shape):l},b:function(){var l=a.mul(u.toFloat()),d=Et(c.shape,i);return d.length>0?l.sum(d).reshape(c.shape):l}}},"Mul")}}),iH=O({mulStrict_:function(t,e){var n=T(t,"a","mul"),r=T(e,"b","mul");return $e(n.shape,r.shape,"Error in multiplyStrict: "),n.mul(r)}}),Af=O({pow_:function(t,e){var n,r=T(t,"base","pow"),o=T(e,"exp","pow");n=at(r,o),r=n[0],o=n[1];var i=Pe(r.shape,o.shape),a=[r,o];return L.runKernelFunc(function(s,u){var c=s.pow(r,o);return u([r,o,c]),c},{a:r,b:o},function(s,u){var c=u[0],l=u[1],d=u[2];return{a:function(){var f=l.toFloat(),h=s.mul(f.mul(c.pow(f.sub(re(1))))),m=Et(c.shape,i);return m.length>0&&(h=h.sum(m)),h.reshape(c.shape)},b:function(){var f=c.greater(0),h=c.log().where(f,Fe(c)),m=s.mul(d.mul(h)),p=Et(l.shape,i);return p.length>0&&(m=m.sum(p)),m.reshape(l.shape)}}},"Pow",{},a,[!0])}}),aH=O({powStrict_:function(t,e){return $e(t.shape,e.shape,"Error in powStrict: "),t.pow(e)}}),sH=O({squaredDifferenceStrict_:function(t,e){var n=T(t,"a","squaredDifferenceStrict"),r=T(e,"b","squaredDifferenceStrict");return $e(n.shape,r.shape,"Error in squaredDifferenceStrict: "),n.squaredDifference(r)}}),Ct=O({sub_:function(t,e){var n,r=T(t,"a","sub"),o=T(e,"b","sub");n=at(r,o),r=n[0],o=n[1];var i=Pe(r.shape,o.shape);return L.runKernelFunc(function(a){return a.subtract(r,o)},{a:r,b:o},function(a){return{a:function(){var s=a,u=Et(r.shape,i);return u.length>0&&(s=s.sum(u)),s.reshape(r.shape)},b:function(){var s=a,u=Et(o.shape,i);return u.length>0&&(s=s.sum(u)),s.neg().reshape(o.shape)}}},"Sub")}}),uH=O({subStrict_:function(t,e){var n=T(t,"a","subStrict"),r=T(e,"b","subStrict");return $e(n.shape,r.shape,"Error in subStrict: "),n.sub(r)}}),RR=O({equal_:function(t,e){var n,r=T(t,"a","equal"),o=T(e,"b","equal");return n=at(r,o),r=n[0],o=n[1],Pe(r.shape,o.shape),L.runKernelFunc(function(i){return i.equal(r,o)},{$a:r,$b:o})}}),cH=O({equalStrict_:function(t,e){var n=T(t,"a","equalStrict"),r=T(e,"b","equalStrict");return $e(n.shape,r.shape,"Error in equalStrict: "),n.equal(r)}}),lH=O({greater_:function(t,e){var n,r=T(t,"a","greater"),o=T(e,"b","greater");return n=at(r,o),r=n[0],o=n[1],Pe(r.shape,o.shape),L.runKernelFunc(function(i){return i.greater(r,o)},{a:r,b:o},null,"Greater")}}),TR=O({greaterEqual_:function(t,e){var n,r=T(t,"a","greaterEqual"),o=T(e,"b","greaterEqual");return n=at(r,o),r=n[0],o=n[1],Pe(r.shape,o.shape),L.runKernelFunc(function(i,a){var s=i.greaterEqual(r,o);return a([r,o]),s},{a:r,b:o},function(i,a){var s=a[0],u=a[1];return{a:function(){return Fe(s)},b:function(){return Fe(u)}}},"GreaterEqual")}}),dH=O({greaterEqualStrict_:function(t,e){var n=T(t,"a","greaterEqualStrict"),r=T(e,"b","greaterEqualStrict");return $e(n.shape,r.shape,"Error in greaterEqualStrict: "),n.greaterEqual(r)}}),fH=O({greaterStrict_:function(t,e){var n=T(t,"a","greaterStrict"),r=T(e,"b","greaterStrict");return $e(n.shape,r.shape,"Error in greaterStrict: "),n.greater(r)}}),hH=O({less_:function(t,e){var n,r=T(t,"a","less"),o=T(e,"b","less");return n=at(r,o),r=n[0],o=n[1],Pe(r.shape,o.shape),L.runKernelFunc(function(i){return i.less(r,o)},{a:r,b:o},null,"Less")}}),pH=O({lessEqual_:function(t,e){var n,r=T(t,"a","lessEqual"),o=T(e,"b","lessEqual");return n=at(r,o),r=n[0],o=n[1],Pe(r.shape,o.shape),L.runKernelFunc(function(i,a){var s=i.lessEqual(r,o);return a([r,o]),s},{a:r,b:o},null,"LessEqual")}}),mH=O({lessEqualStrict_:function(t,e){var n=T(t,"a","lessEqualStrict"),r=T(e,"b","lessEqualStrict");return $e(n.shape,r.shape,"Error in lessEqualStrict: "),n.lessEqual(r)}}),vH=O({lessStrict_:function(t,e){var n=T(t,"a","lessStrict"),r=T(e,"b","lessStrict");return $e(n.shape,r.shape,"Error in lessStrict: "),n.less(r)}}),gH=O({notEqual_:function(t,e){var n,r=T(t,"a","notEqual"),o=T(e,"b","notEqual");return n=at(r,o),r=n[0],o=n[1],Pe(r.shape,o.shape),L.runKernelFunc(function(i){return i.notEqual(r,o)},{a:r,b:o},null,"NotEqual")}}),yH=O({notEqualStrict_:function(t,e){var n=T(t,"a","notEqualStrict"),r=T(e,"b","notEqualStrict");return $e(n.shape,r.shape,"Error in notEqualStrict: "),n.notEqual(r)}});function _b(t,e){for(var n=[],r=t;r<e;++r)n.push(r);return n}function Sb(t){for(var e=[],n=0;n<t.length;++n)for(var r=0;r<t[n].length;++r)e.push(t[n][r]);return e}var s0=O({gather_:function(t,e,n){n===void 0&&(n=0);var r=T(t,"x","gather"),o=T(e,"indices","gather","int32");n=_t(n,r.shape)[0];var i=function(a,s,u){for(var c=a.shape[u],l=[],d=1,f=1,h=0;h<u;h++)l.push(a.shape[h]),d*=a.shape[h];for(h=0;h<s.rank;h++)l.push(s.shape[h]);for(h=u+1;h<a.rank;h++)l.push(a.shape[h]),f*=a.shape[h];return{batchSize:d,sliceSize:f,dimSize:c,outputShape:l}}(r,o,n);return L.runKernelFunc(function(a,s){var u=a.gather(r,o.flatten(),n);return s([o]),u},{x:r,indices:o},function(a,s){var u=s[0];return{x:function(){var c=r.shape,l=u.size,d=c.slice(0,n),f=d.length,h=c.slice(n,c.length).slice(1),m=h.length,p=_b(0,f),g=_b(f+1,f+1+m),v=Sb([d,[l],h]),y=a.reshape(v),x=u.reshape([l]),b=Sb([[f],p,g]),E=y.transpose(b),_=NR(E,x,r.shape[n]),S=Ky(b);return _=_.transpose(S)},indices:function(){return u}}},"Gather",{axis:n}).reshape(i.outputShape)}}),NR=O({unsortedSegmentSum_:function(t,e,n){var r=T(t,"x","unsortedSegmentSum"),o=T(e,"segmentIds","unsortedSegmentSum","int32");return N(dt(n),function(){return"numSegments must be of dtype int"}),L.runKernelFunc(function(i,a){var s=i.unsortedSegmentSum(r,o,n);return a([o]),s},{$x:r},function(i,a){var s=a[0];return{$x:function(){return function(u,c){for(var l=a0(c,Fe(c)),d=s0(u,l),f=TR(c,re(0,"int32")),h=d.rank-f.rank,m=0;m<h;++m)f=Wn(f,m+1);f=Rh(f,du(d.shape,"bool"));var p=Fe(d);return xa(f,d,p)}(i,s)}}})}}),xH=function(t,e,n){return ce(this,void 0,void 0,function(){var r,o,i,a,s,u,c,l,d,f,h,m,p;return le(this,function(g){switch(g.label){case 0:for(r=T(t,"tensor","boolMask"),o=T(e,"mask","boolMask","bool"),i=n??0,a=o.rank,s=r.shape,N(a>0,function(){return"mask cannot be scalar"}),$e(s.slice(i,i+a),o.shape,"mask's shape must match the first K dimensions of tensor's shape,"),u=1,c=i;c<i+a;c++)u*=s[c];return l=s.slice(0,i).concat([u],s.slice(i+a)),d=r.reshape(l),f=o.reshape([-1]),[4,SR(f)];case 1:return h=g.sent(),m=h.squeeze([1]),p=s0(d,m,i),t!==r&&r.dispose(),e!==o&&o.dispose(),m.dispose(),d.dispose(),f.dispose(),h.dispose(),[2,p]}})})};function AR(t,e,n,r,o,i,a){i===void 0&&(i="NHWC"),N(t.length===e.rank,function(){return"Length of inShape ("+t.length+") and rank of dy ("+e.rank+") must match"});var s=t,u=e,c=!1;e.rank===3&&(c=!0,u=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]),s=[1,t[0],t[1],t[2]]),N(s.length===4,function(){return"Error in conv2dDerInput: inShape must be length 4, but got length "+s.length+"."}),N(u.rank===4,function(){return"Error in conv2dDerInput: dy must be rank 4, but got rank "+u.rank}),N(n.rank===4,function(){return"Error in conv2dDerInput: filter must be rank 4, but got rank "+n.rank});var l=i==="NHWC"?s[3]:s[1],d=i==="NHWC"?u.shape[3]:u.shape[1];N(l===n.shape[2],function(){return"Error in conv2dDerInput: depth of input ("+l+") must match input depth for filter "+n.shape[2]+"."}),N(d===n.shape[3],function(){return"Error in conv2dDerInput: depth of output ("+d+") must match output depth for filter "+n.shape[3]+"."}),a!=null&&N(dt(o),function(){return"Error in conv2dDerInput: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+o+"."});var f=Jy(i),h=Na(s,n.shape,r,1,o,a,!1,f),m=L.runKernelFunc(function(p,g){var v=p.conv2dDerInput(u,n,h);return g([n,u]),v},{dy4D:u,filter:n},function(p,g){var v=g[0],y=g[1];return{dy4D:function(){return Yn(p,v,r,o,i,1,a)},filter:function(){return u0(p,y,v.shape,r,o,i,a)}}});return c?m.as3D(m.shape[1],m.shape[2],m.shape[3]):m}function rm(t){var e=function(i){return typeof i=="number"?[i,i,i]:i.length===2?[i[0],i[1],1]:i}(t),n=e[0],r=e[1],o=e[2];return n===1&&r===1&&o===1}function PR(t,e,n,r,o){N(t.length===e.rank,function(){return"Length of inShape ("+t.length+") and rank of dy ("+e.rank+") must match"});var i=t,a=e,s=!1;e.rank===4&&(s=!0,a=e.as5D(1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]),i=[1,t[0],t[1],t[2],t[3]]);var u=i[4],c=a.shape[4];N(i.length===5,function(){return"Error in conv3dDerInput: inShape must be length 5, but got length "+i.length+"."}),N(a.rank===5,function(){return"Error in conv3dDerInput: dy must be rank 5, but got rank "+a.rank}),N(n.rank===5,function(){return"Error in conv3dDerInput: filter must be rank 5, but got rank "+n.rank}),N(u===n.shape[3],function(){return"Error in conv3dDerInput: depth of input ("+u+") must match input depth for filter "+n.shape[3]+"."}),N(c===n.shape[4],function(){return"Error in conv3dDerInput: depth of output ("+c+") must match output depth for filter "+n.shape[4]+"."});var l=Rf(i,n.shape,r,1,o),d=L.runKernelFunc(function(f){return f.conv3dDerInput(a,n,l)},{dy5D:a});return s?d.as4D(d.shape[1],d.shape[2],d.shape[3],d.shape[4]):d}var wH=O({conv1d_:function(t,e,n,r,o,i,a){o===void 0&&(o="NWC"),i===void 0&&(i=1);var s=T(t,"x","conv1d"),u=T(e,"filter","conv1d"),c=s,l=!1;s.rank===2&&(l=!0,c=s.as3D(1,s.shape[0],s.shape[1])),N(c.rank===3,function(){return"Error in conv1d: input must be rank 3, but got rank "+c.rank+"."}),N(u.rank===3,function(){return"Error in conv1d: filter must be rank 3, but got rank "+u.rank+"."}),a!=null&&N(dt(r),function(){return"Error in conv1d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+r+"."}),N(c.shape[2]===u.shape[1],function(){return"Error in conv1d: depth of input ("+c.shape[2]+") must match input depth for filter "+u.shape[1]+"."}),N(En(n,i),function(){return"Error in conv1D: Either stride or dilation must be 1. Got stride "+n+" and dilation '"+i+"'"}),N(o==="NWC",function(){return"Error in conv1d: got dataFormat of "+o+" but only NWC is currently supported."});var d=u.as4D(1,u.shape[0],u.shape[1],u.shape[2]),f=c.as4D(c.shape[0],1,c.shape[1],c.shape[2]),h=Yn(f,d,[1,n],r,"NHWC",[1,i],a);return l?h.as2D(h.shape[2],h.shape[3]):h.as3D(h.shape[0],h.shape[2],h.shape[3])}}),Yn=O({conv2d_:function(t,e,n,r,o,i,a){o===void 0&&(o="NHWC"),i===void 0&&(i=[1,1]);var s=T(t,"x","conv2d"),u=T(e,"filter","conv2d"),c=s,l=!1;s.rank===3&&(l=!0,c=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),N(c.rank===4,function(){return"Error in conv2d: input must be rank 4, but got rank "+c.rank+"."}),N(u.rank===4,function(){return"Error in conv2d: filter must be rank 4, but got rank "+u.rank+"."}),a!=null&&N(dt(r),function(){return"Error in conv2d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+r+"."});var d=o==="NHWC"?c.shape[3]:c.shape[1];N(d===u.shape[2],function(){return"Error in conv2d: depth of input ("+d+") must match input depth for filter "+u.shape[2]+"."}),N(En(n,i),function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+i+"'"});var f=Jy(o),h=Na(c.shape,u.shape,n,i,r,a,!1,f),m=[u,c],p=L.runKernelFunc(function(g,v){var y=g.conv2d(c,u,h);return v([u,c]),y},{x:c,filter:u},function(g,v){var y=v,x=y[0],b=y[1];return N(Zs(i),function(){return"Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+i+"'"}),{x:function(){return DR(b.shape,g,x,n,r,o)},filter:function(){return u0(b,g,x.shape,n,r,o)}}},"Conv2D",h,m);return l?p.as3D(p.shape[1],p.shape[2],p.shape[3]):p}}),bH=O({conv3d_:function(t,e,n,r,o,i){o===void 0&&(o="NDHWC"),i===void 0&&(i=[1,1,1]);var a=T(t,"x","conv3d"),s=T(e,"filter","conv3d"),u=a,c=!1;a.rank===4&&(c=!0,u=a.as5D(1,a.shape[0],a.shape[1],a.shape[2],a.shape[3])),N(u.rank===5,function(){return"Error in conv3d: input must be rank 5, but got rank "+u.rank+"."}),N(s.rank===5,function(){return"Error in conv3d: filter must be rank 5, but got rank "+s.rank+"."}),N(u.shape[4]===s.shape[3],function(){return"Error in conv3d: depth of input ("+u.shape[4]+") must match input depth for filter "+s.shape[3]+"."}),N(function(f,h){return rm(f)||rm(h)}(n,i),function(){return"Error in conv3D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+i+"'"}),N(o==="NDHWC",function(){return"Error in conv3d: got dataFormat of "+o+" but only NDHWC is currently supported."});var l=Rf(u.shape,s.shape,n,i,r),d=L.runKernelFunc(function(f,h){var m=f.conv3d(u,s,l);return h([u,s]),m},{x:u,$filter:s},function(f,h){N(rm(i),function(){return"Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+i+"'"});var m=h[0],p=h[1];return{x:function(){return PR(m.shape,f,p,n,r)},$filter:function(){return function(g,v,y,x,b){var E=g;g.rank===4&&(E=g.as5D(1,g.shape[0],g.shape[1],g.shape[2],g.shape[3]));var _=v;_.rank===4&&(_=v.as5D(1,v.shape[0],v.shape[1],v.shape[2],v.shape[3])),N(E.rank===5,function(){return"Error in conv3dDerFilter: input must be rank 5, but got shape "+E.shape+"."}),N(_.rank===5,function(){return"Error in conv3dDerFilter: dy must be rank 5, but got shape "+_.shape+"."}),N(y.length===5,function(){return"Error in conv3dDerFilter: filterShape must be length 5, but got "+y+"."}),N(E.shape[4]===y[3],function(){return"Error in conv3dDerFilter: depth of input "+E.shape[4]+") must match input depth in filter ("+y[3]+"."}),N(_.shape[4]===y[4],function(){return"Error in conv3dDerFilter: depth of dy ("+_.shape[4]+") must match output depth for filter ("+y[4]+")."});var S=Rf(E.shape,y,x,1,b);return L.runKernelFunc(function(k){return k.conv3dDerFilter(E,_,S)},{x5D:E,dy5D:_})}(m,f,p.shape,n,r)}}});return c?d.as4D(d.shape[1],d.shape[2],d.shape[3],d.shape[4]):d}}),u0=O({conv2dDerFilter_:function(t,e,n,r,o,i,a){i===void 0&&(i="NHWC");var s=t;t.rank===3&&(s=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]));var u=e;u.rank===3&&(u=e.as4D(1,e.shape[0],e.shape[1],e.shape[2])),N(s.rank===4,function(){return"Error in conv2dDerFilter: input must be rank 4, but got shape "+s.shape+"."}),N(u.rank===4,function(){return"Error in conv2dDerFilter: dy must be rank 4, but got shape "+u.shape+"."}),N(n.length===4,function(){return"Error in conv2dDerFilter: filterShape must be length 4, but got "+n+"."});var c=i==="NHWC"?s.shape[3]:s.shape[1],l=i==="NHWC"?u.shape[3]:u.shape[1];N(c===n[2],function(){return"Error in conv2dDerFilter: depth of input "+c+") must match input depth in filter ("+n[2]+"."}),N(l===n[3],function(){return"Error in conv2dDerFilter: depth of dy ("+l+") must match output depth for filter ("+n[3]+")."}),a!=null&&N(dt(o),function(){return"Error in conv2dDerFilter: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+o+"."});var d=Jy(i),f=Na(s.shape,n,r,1,o,a,!1,d);return L.runKernelFunc(function(h){return h.conv2dDerFilter(s,u,f)},{x4D:s,dy4D:u})}}),DR=O({conv2dDerInput_:AR}),Th=O({depthwiseConv2d_:function(t,e,n,r,o,i,a){i===void 0&&(i=[1,1]);var s=T(t,"x","depthwiseConv2d"),u=T(e,"filter","depthwiseConv2d"),c=s,l=!1;s.rank===3&&(l=!0,c=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),N(c.rank===4,function(){return"Error in depthwiseConv2d: input must be rank 4, but got rank "+c.rank+"."}),N(u.rank===4,function(){return"Error in depthwiseConv2d: filter must be rank 4, but got rank "+u.rank+"."}),N(c.shape[3]===u.shape[2],function(){return"Error in depthwiseConv2d: number of input channels ("+c.shape[3]+") must match the inChannels dimension in filter "+u.shape[2]+"."}),i==null&&(i=[1,1]),N(En(n,i),function(){return"Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+i+"'"}),a!=null&&N(dt(r),function(){return"Error in depthwiseConv2d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+r+"."});var d=Na(c.shape,u.shape,n,i,r,a,!0),f=[c,u],h=L.runKernelFunc(function(m,p){var g=m.depthwiseConv2D(c,u,d);return p([c,u]),g},{x:c,filter:u},function(m,p){N(Zs(i),function(){return"Error in gradient of depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+i+"'"});var g=p[0],v=p[1];return{x:function(){return MR(g.shape,m,v,d)},filter:function(){return OR(g,m,v.shape,d)}}},"DepthwiseConv2dNative",d,f);return l?h.as3D(h.shape[1],h.shape[2],h.shape[3]):h}}),MR=O({depthwiseConv2dDerInput_:function(t,e,n,r){var o=e,i=!1;e.rank===3&&(i=!0,o=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var a=L.runKernelFunc(function(s){return s.depthwiseConv2DDerInput(o,n,r)},{dy4D:o});return i?a.as3D(a.shape[1],a.shape[2],a.shape[3]):a}}),OR=O({depthwiseConv2dDerFilter_:function(t,e,n,r){var o=t;t.rank===3&&(o=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]));var i=e;return i.rank===3&&(i=e.as4D(1,e.shape[0],e.shape[1],e.shape[2])),L.runKernelFunc(function(a){return a.depthwiseConv2DDerFilter(o,i,r)},{x4D:o,dy4D:i})}}),c0=O({separableConv2d_:function(t,e,n,r,o,i,a){i===void 0&&(i=[1,1]),a===void 0&&(a="NHWC");var s=T(t,"x","separableConv2d"),u=T(e,"depthwiseFilter","separableConv2d"),c=T(n,"pointwiseFilter","separableConv2d"),l=s,d=!1;if(s.rank===3&&(d=!0,l=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),a==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");N(l.rank===4,function(){return"Error in separableConv2d: input must be rank 4, but got rank "+l.rank+"."}),N(u.rank===4,function(){return"Error in separableConv2d: depthwise filter must be rank 4, but got rank "+u.rank+"."}),N(c.rank===4,function(){return"Error in separableConv2d: pointwise filter must be rank 4, but got rank "+u.rank+"."}),N(c.shape[0]===1,function(){return"Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got "+c.shape[0]+"."}),N(c.shape[1]===1,function(){return"Error in separableConv2d: the second dimension of pointwise filter must be 1, but got "+c.shape[1]+"."});var f=u.shape[2],h=u.shape[3];N(c.shape[2]===f*h,function(){return"Error in separableConv2d: the third dimension of pointwise filter must be "+f*h+", but got "+c.shape[2]+"."});var m=Th(l,u,r,o,a,i),p=Yn(m,c,1,"valid",a);return d?p.as3D(p.shape[1],p.shape[2],p.shape[3]):p}}),EH=O({conv2dTranspose_:function(t,e,n,r,o,i){return AR(n,T(t,"x","conv2dTranspose"),T(e,"filter","conv2dTranspose"),r,o,"NHWC",i)}}),CH=O({conv3dTranspose_:function(t,e,n,r,o){return PR(n,T(t,"x","conv3dTranspose"),T(e,"filter","conv3dTranspose"),r,o)}}),Nh=O({matMul_:function(t,e,n,r){var o;n===void 0&&(n=!1),r===void 0&&(r=!1);var i=T(t,"a","matMul"),a=T(e,"b","matMul");o=at(i,a),i=o[0],a=o[1];var s=n?i.shape[i.rank-2]:i.shape[i.rank-1],u=r?a.shape[a.rank-1]:a.shape[a.rank-2],c=n?i.shape[i.rank-1]:i.shape[i.rank-2],l=r?a.shape[a.rank-2]:a.shape[a.rank-1],d=i.shape.slice(0,-2),f=a.shape.slice(0,-2),h=de(d),m=de(f);N(i.rank>=2&&a.rank>=2&&i.rank===a.rank,function(){return"Error in matMul: inputs must have the same rank of at least 2, got ranks "+i.rank+" and "+a.rank+"."}),N(At(d,f),function(){return"Error in matMul: outer dimensions ("+d+") and ("+f+") of Tensors with shapes "+i.shape+" and "+a.shape+" must match."}),N(s===u,function(){return"Error in matMul: inner shapes ("+s+") and ("+u+") of Tensors with shapes "+i.shape+" and "+a.shape+" and transposeA="+n+" and transposeB="+r+" must match."});var p=i.shape.slice(0,-2).concat([c,l]),g=n?i.as3D(h,s,c):i.as3D(h,c,s),v=r?a.as3D(m,l,u):a.as3D(m,u,l),y={transposeA:n,transposeB:r};return L.runKernelFunc(function(x,b){var E=x.batchMatMul(g,v,n,r);return b([g,v]),E},{a:g,b:v},function(x,b){var E=b,_=E[0],S=E[1];return n||r?!n&&r?{a:function(){return x.matMul(S,!1,!1)},b:function(){return x.matMul(_,!0,!1)}}:n&&!r?{a:function(){return S.matMul(x,!1,!0)},b:function(){return _.matMul(x,!1,!1)}}:{a:function(){return S.matMul(x,!0,!0)},b:function(){return x.matMul(_,!0,!0)}}:{a:function(){return x.matMul(S,!1,!0)},b:function(){return _.matMul(x,!0,!1)}}},"BatchMatMul",y).reshape(p)}}),_H=O({dot_:function(t,e){var n=T(t,"t1","dot"),r=T(e,"t2","dot");N(!(n.rank!==1&&n.rank!==2||r.rank!==1&&r.rank!==2),function(){return"Error in dot: inputs must all be rank 1 or 2, but got ranks "+n.rank+" and "+r.rank+"."});var o=n.rank===1?n.size:n.shape[1],i=r.rank===1?r.size:r.shape[0];return N(o===i,function(){return"Error in dot: inner dimensions of inputs must match, but got "+o+" and "+i+"."}),n.rank===1&&r.rank===1?n.as2D(1,-1).matMul(r.as2D(-1,1)).asScalar():n.rank===1&&r.rank===2?n.as2D(1,-1).matMul(r.as2D(r.shape[0],r.shape[1])).as1D():n.rank===2&&r.rank===1?n.matMul(r.as2D(-1,1)).as1D():n.matMul(r.as2D(r.shape[0],r.shape[1]))}}),SH=O({outerProduct_:function(t,e){var n=T(t,"v1","outerProduct"),r=T(e,"v2","outerProduct");return N(n.rank===1&&r.rank===1,function(){return"Error in outerProduct: inputs must be rank 1, but got ranks "+n.rank+" and "+r.rank+"."}),n.as2D(-1,1).matMul(r.as2D(1,-1))}}),sl=O({reverse_:function(t,e){var n=T(t,"x","reverse");if(n.rank===0)return n.clone();var r=_t(e,n.shape);return L.runKernelFunc(function(o){return o.reverse(n,r)},{$x:n},function(o){return{$x:function(){return o.reverse(r)}}}).reshapeAs(n)}}),kH=O({reverse1d_:function(t){var e=T(t,"x","reverse");return N(e.rank===1,function(){return"Error in reverse1D: x must be rank 1 but got rank "+e.rank+"."}),sl(e,0)}}),IH=O({reverse2d_:function(t,e){var n=T(t,"x","reverse");return N(n.rank===2,function(){return"Error in reverse2D: x must be rank 2 but got rank "+n.rank+"."}),sl(n,e)}}),RH=O({reverse3d_:function(t,e){var n=T(t,"x","reverse");return N(n.rank===3,function(){return"Error in reverse3D: x must be rank 3 but got rank "+n.rank+"."}),sl(n,e)}}),TH=O({reverse4d_:function(t,e){var n=T(t,"x","reverse");return N(n.rank===4,function(){return"Error in reverse4D: x must be rank 4 but got rank "+n.rank+"."}),sl(n,e)}});function FR(t,e,n,r,o,i){var a=T(t,"x","maxPool"),s=a,u=!1;a.rank===3&&(u=!0,s=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),N(s.rank===4,function(){return"Error in maxPool: input must be rank 4 but got rank "+s.rank+"."}),N(En(n,r),function(){return"Error in maxPool: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+r+"'"}),i!=null&&N(dt(o),function(){return"Error in maxPool: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+o+"."});var c=Tc(s.shape,e,n,r,o,i);if(c.filterWidth===1&&c.filterHeight===1&&At(c.inShape,c.outShape))return a.clone();var l=[s],d=L.runKernelFunc(function(f,h){var m=f.maxPool(s,c);return h([s,m]),m},{x:s},function(f,h){var m=h[0],p=h[1];return{x:function(){return function(g,v,y,x,b,E,_,S){var k=T(g,"dy","maxPoolBackprop"),R=T(v,"input","maxPoolBackprop"),I=T(y,"output","maxPoolBackprop");N(R.rank===k.rank,function(){return"Rank of input ("+R.rank+") does not match rank of dy ("+k.rank+")"}),N(En(b,E),function(){return"Error in maxPoolBackProp: Either strides or dilations must be 1. Got strides "+b+" and dilations '"+E+"'"}),N(k.rank===4,function(){return"Error in maxPoolBackprop: dy must be rank 4 but got rank "+k.rank+"."}),N(R.rank===4,function(){return"Error in maxPoolBackprop: input must be rank 4 but got rank "+R.rank+"."});var D=Tc(R.shape,x,b,E,_,S);return L.runKernelFunc(function(A){return A.maxPoolBackprop(k,R,I,D)},{$dy:k,$input:R})}(f,m,p,e,n,r,o)}}},"MaxPool",c,l);return u?d.as3D(d.shape[1],d.shape[2],d.shape[3]):d}function LR(t,e,n,r,o,i){var a=T(t,"x","avgPool","float32");N(En(n,r),function(){return"Error in avgPool: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+r+"'"});var s=a,u=!1;a.rank===3&&(u=!0,s=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),N(s.rank===4,function(){return"Error in avgPool: x must be rank 4 but got rank "+s.rank+"."}),i!=null&&N(dt(o),function(){return"Error in avgPool: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+o+"."});var c=Tc(s.shape,e,n,r,o,i);if(c.filterWidth===1&&c.filterHeight===1&&At(c.inShape,c.outShape))return a.clone();var l=L.runKernelFunc(function(d){return d.avgPool(s,c)},{x:s},function(d){return{x:function(){return function(f,h,m,p,g,v){var y=T(f,"dy","avgPoolBackprop"),x=T(h,"input","avgPoolBackprop");N(x.rank===y.rank,function(){return"Rank of input ("+x.rank+") does not match rank of dy ("+y.rank+")"}),N(En(p,g),function(){return"Error in avgPoolBackprop: Either strides or dilations must be 1. Got strides "+p+" and dilations '"+g+"'"});var b=x,E=y,_=!1;x.rank===3&&(_=!0,b=x.as4D(1,x.shape[0],x.shape[1],x.shape[2]),E=y.as4D(1,y.shape[0],y.shape[1],y.shape[2])),N(E.rank===4,function(){return"Error in avgPoolBackprop: dy must be rank 4 but got rank "+E.rank+"."}),N(b.rank===4,function(){return"Error in avgPoolBackprop: input must be rank 4 but got rank "+b.rank+"."});var S=Tc(b.shape,m,p,g,v),k=L.runKernelFunc(function(R){return R.avgPoolBackprop(E,b,S)},{dy4D:E,input4D:b});return _?k.as3D(k.shape[1],k.shape[2],k.shape[3]):k}(d,s,e,n,r,o)}}},"AvgPool",c);return l=l.cast(a.dtype),u?l.as3D(l.shape[1],l.shape[2],l.shape[3]):l}var Rt=O({maxPool_:function(t,e,n,r,o){return FR(t,e,n,1,r,o)}}),ul=O({avgPool_:function(t,e,n,r,o){return LR(t,e,n,1,r,o)}}),NH=O({pool_:function(t,e,n,r,o,i){o==null&&(o=[1,1]),i==null&&(i=1),r===0&&(r="valid");var a=T(t,"x","maxPool"),s=a,u=!1;a.rank===3&&(u=!0,s=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),N(En(i,o),function(){return"Error in pool: Either strides or dilations must be 1. Got strides "+i+" and dilations '"+o+"'"});var c,l=Tc(s.shape,e,i,o,r),d=[l.dilationHeight,l.dilationWidth];c=r==="same"?function(b,E){var _=b.map(function(R,I){return R+(R-1)*(E[I]-1)}).map(function(R){return R-1}),S=_.map(function(R){return Math.floor(R/2)}),k=_.map(function(R,I){return R-S[I]});return _.map(function(R,I){return[S[I],k[I]]})}([l.filterHeight,l.filterWidth],d):[[0,0],[0,0]];var f=d[0]===1&&d[1]===1,h=function(b,E,_){var S=_.map(function(F){return F[0]}),k=_.map(function(F){return F[1]}),R=b.concat(S,k),I=E.map(function(F,$){return(F-R[$]%F)%F}),D=k.map(function(F,$){return F+I[$]}),A=E.map(function(F,$){return[S[$],D[$]]}),W=E.map(function(F,$){return[0,I[$]]});return[A,W]}([l.inHeight,l.inWidth],d,c),m=h[0],p=h[1],g=f?r:"valid",v=f?s:zI(s,d,m),y=(n==="avg"?function(){return LR(v,e,i,1,g)}:function(){return FR(v,e,i,1,g)})(),x=f?y:UI(y,d,p);return u?x.as3D(x.shape[1],x.shape[2],x.shape[3]):x}}),AH=O({maxPool3d_:function(t,e,n,r,o,i,a){i===void 0&&(i="NDHWC");var s=T(t,"x","maxPool3d"),u=s,c=!1;s.rank===4&&(c=!0,u=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),a==null&&(a=[1,1,1]),N(u.rank===5,function(){return"Error in maxPool3d: x must be rank 5 but got rank "+u.rank+"."}),N(i==="NDHWC",function(){return"Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of "+i}),N(En(n,a),function(){return"Error in maxPool3d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+a+"'"}),o!=null&&N(dt(r),function(){return"Error in maxPool3d: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+r+"."});var l=If(u.shape,e,n,a,r,o,i),d=L.runKernelFunc(function(f,h){var m=f.maxPool3d(u,l);return h([u,m]),m},{x:u},function(f,h){var m=h[0],p=h[1];return{x:function(){return function(g,v,y,x,b,E,_,S){var k=T(g,"dy","maxPool3dBackprop"),R=T(v,"input","maxPool3dBackprop"),I=T(y,"output","maxPool3dBackprop"),D=k,A=R,W=I,F=!1;R.rank===4&&(F=!0,D=k.as5D(1,k.shape[0],k.shape[1],k.shape[2],k.shape[3]),A=R.as5D(1,R.shape[0],R.shape[1],R.shape[2],R.shape[3]),W=I.as5D(1,I.shape[0],I.shape[1],I.shape[2],I.shape[3])),N(D.rank===5,function(){return"Error in maxPool3dBackprop: dy must be rank 5 but got rank "+D.rank+"."}),N(A.rank===5,function(){return"Error in maxPool3dBackprop: input must be rank 5 but got rank "+A.rank+"."}),N(W.rank===5,function(){return"Error in maxPool3dBackprop: output must be rank 5 but got rank "+W.rank+"."}),E==null&&(E=[1,1,1]),N(En(b,E),function(){return"Error in maxPool3dBackprop: Either strides or dilations must be 1. Got strides "+b+" and dilations '"+E+"'"}),S!=null&&N(dt(_),function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+S+" but got pad "+_+"."});var $=If(A.shape,x,b,E,_,S),j=L.runKernelFunc(function(U){return U.maxPool3dBackprop(D,A,W,$)},{dy5D:D,input5D:A});return F?j.as4D(j.shape[1],j.shape[2],j.shape[3],j.shape[4]):j}(f,m,p,e,n,a,r,o)}}});return c?d.as4D(d.shape[1],d.shape[2],d.shape[3],d.shape[4]):d}}),PH=O({avgPool3d_:function(t,e,n,r,o,i,a){i===void 0&&(i="NDHWC");var s=T(t,"x","avgPool3d","float32"),u=s,c=!1;s.rank===4&&(c=!0,u=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),a==null&&(a=[1,1,1]),N(u.rank===5,function(){return"Error in avgPool3d: x must be rank 5 but got rank "+u.rank+"."}),N(i==="NDHWC",function(){return"Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of "+i}),N(En(n,a),function(){return"Error in avgPool3d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+a+"'"}),o!=null&&N(dt(r),function(){return"Error in avgPool3d: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+r+"."});var l=If(u.shape,e,n,a,r,o,i),d=L.runKernelFunc(function(f){return f.avgPool3d(u,l)},{x:u},function(f){return{x:function(){return function(h,m,p,g,v,y,x){var b=T(h,"dy","avgPool3dBackprop"),E=T(m,"input","avgPool3dBackprop"),_=b,S=E,k=!1;E.rank===4&&(k=!0,_=b.as5D(1,b.shape[0],b.shape[1],b.shape[2],b.shape[3]),S=E.as5D(1,E.shape[0],E.shape[1],E.shape[2],E.shape[3])),N(_.rank===5,function(){return"Error in avgPool3dBackprop: dy must be rank 5 but got rank "+_.rank+"."}),N(S.rank===5,function(){return"Error in avgPool3dBackprop: input must be rank 5 but got rank "+S.rank+"."}),v==null&&(v=[1,1,1]),N(En(g,v),function(){return"Error in avgPool3dBackprop: Either strides or dilations must be 1. Got strides "+g+" and dilations '"+v+"'"}),x!=null&&N(dt(y),function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+x+" but got pad "+y+"."});var R=If(S.shape,p,g,v,y,x),I=L.runKernelFunc(function(D){return D.avgPool3dBackprop(_,S,R)},{dy5D:_,input5D:S});return k?I.as4D(I.shape[1],I.shape[2],I.shape[3],I.shape[4]):I}(f,u,e,n,a,r,o)}}});return d=d.cast(u.dtype),c?d.as4D(d.shape[1],d.shape[2],d.shape[3],d.shape[4]):d}}),Kr=O({slice_:function(t,e,n){var r,o,i=T(t,"x","slice");if(i.rank===0)throw new Error("Slicing scalar is not possible");(r=typeof e=="number"?[e].concat(new Array(i.rank-1).fill(0)):e.length<i.rank?e.concat(new Array(i.rank-e.length).fill(0)):e.slice()).forEach(function(u){N(u!==-1,function(){return"slice() does not support negative begin indexing."})}),o=(o=n==null?new Array(i.rank).fill(-1):typeof n=="number"?[n].concat(new Array(i.rank-1).fill(-1)):n.length<i.rank?n.concat(new Array(i.rank-n.length).fill(-1)):n).map(function(u,c){return u>=0?u:(N(u===-1,function(){return"Negative size values should be exactly -1 but got "+u+" for the slice() size at index "+c+"."}),i.shape[c]-r[c])}),a$(i,r,o);var a=i.shape,s={begin:r,size:o};return L.runKernelFunc(function(u){return u.slice(i,r,o)},{x:i},function(u){for(var c=[],l=0;l<u.rank;l++)c.push([r[l],a[l]-r[l]-o[l]]);return{x:function(){return u.pad(c)}}},"Slice",s)}}),DH=O({slice1d_:function(t,e,n){var r=T(t,"x","slice1d");return N(r.rank===1,function(){return"slice1d expects a rank-1 tensor, but got a rank-"+r.rank+" tensor"}),Kr(r,[e],[n])}}),MH=O({slice2d_:function(t,e,n){var r=T(t,"x","slice2d");return N(r.rank===2,function(){return"slice2d expects a rank-2 tensor, but got a rank-"+r.rank+" tensor"}),Kr(r,e,n)}}),BR=O({slice3d_:function(t,e,n){var r=T(t,"x","slice3d");return N(r.rank===3,function(){return"slice3d expects a rank-3 tensor, but got a rank-"+r.rank+" tensor"}),Kr(r,e,n)}}),OH=O({slice4d_:function(t,e,n){var r=T(t,"x","slice4d");return N(r.rank===4,function(){return"slice4d expects a rank-4 tensor, but got a rank-"+r.rank+" tensor"}),Kr(r,e,n)}});function jR(t,e,n,r,o){return e.rank<n.rank&&(e=e.reshape(bn(e.shape,r))),t.rank<n.rank&&(t=t.reshape(bn(t.shape,r))),{x:function(){var i=t.mul(n.equal(e).cast(t.dtype));return o==null?i:i.transpose(o)}}}var FH=O({all_:function(t,e,n){e===void 0&&(e=null),n===void 0&&(n=!1);var r=T(t,"x","all","bool"),o=_t(e,r.shape),i=o,a=Qr(i,r.rank);a!=null&&(r=r.transpose(a),i=Jr(i.length,r.rank));var s=L.runKernelFunc(function(c){return c.all(r,i)},{$x:r});if(n){var u=bn(s.shape,o);return s.reshape(u)}return s}}),LH=O({any_:function(t,e,n){e===void 0&&(e=null),n===void 0&&(n=!1);var r=T(t,"x","any","bool"),o=_t(e,r.shape),i=o,a=Qr(i,r.rank);a!=null&&(r=r.transpose(a),i=Jr(i.length,r.rank));var s=L.runKernelFunc(function(c){return c.any(r,i)},{$x:r});if(n){var u=bn(s.shape,o);return s.reshape(u)}return s}}),BH=O({argMax_:function(t,e){e===void 0&&(e=0);var n=T(t,"x","argMax");e==null&&(e=0);var r=_t(e,n.shape),o=Qr(r,n.rank);o!=null&&(n=n.transpose(o),r=Jr(r.length,n.rank));var i={axis:r[0]},a=[n];return L.runKernelFunc(function(s,u){var c=s.argMax(n,r[0]);return u([n]),c},{x:n},function(s,u){var c=u[0];return{x:function(){return Fe(c)}}},"ArgMax",i,a)}}),jH=O({argMin_:function(t,e){e===void 0&&(e=0);var n=T(t,"x","argMin");e==null&&(e=0);var r=_t(e,n.shape),o=Qr(r,n.rank);return o!=null&&(n=n.transpose(o),r=Jr(r.length,n.rank)),L.runKernelFunc(function(i,a){var s=i.argMin(n,r[0]);return a([n]),s},{$x:n},function(i,a){var s=a[0];return{$x:function(){return Fe(s)}}})}}),UH=O({logSumExp_:function(t,e,n){e===void 0&&(e=null),n===void 0&&(n=!1);var r=T(t,"x","logSumExp"),o=_t(e,r.shape),i=r.max(o,!0),a=r.sub(i).exp().sum(o).log(),s=i.reshape(a.shape).add(a);if(n){var u=bn(s.shape,o);return s.reshape(u)}return s}}),Ah=O({max_:function(t,e,n){e===void 0&&(e=null),n===void 0&&(n=!1);var r=T(t,"x","max"),o=r,i=_t(e,r.shape),a=i,s=Qr(a,r.rank);s!=null&&(r=r.transpose(s),a=Jr(a.length,r.rank));var u=[r],c=L.runKernelFunc(function(d,f){var h=d.max(r,a);return f([o,h]),h},{x:r},function(d,f){return jR(d,f[1],f[0],i,s)},"Max",{axes:a},u,[!0]);if(n){var l=bn(c.shape,i);c=c.reshape(l)}return c}}),WH=O({mean_:function(t,e,n){e===void 0&&(e=null),n===void 0&&(n=!1);var r=T(t,"x","mean"),o=_t(e,r.shape),i=de(Ht(r.shape,o)[1]);return kh(function(a){var s=re(i);return{value:(s.dtype===a.dtype?a:a.cast(s.dtype)).div(s).sum(e,n),gradFunc:function(u){var c=a.shape.slice();return o.forEach(function(l){c[l]=1}),u.reshape(c).mul(du(a.shape,"float32")).div(i)}}})(r)}}),$H=O({min_:function(t,e,n){e===void 0&&(e=null),n===void 0&&(n=!1);var r=T(t,"x","min"),o=r,i=_t(e,r.shape),a=i,s=Qr(a,r.rank);s!=null&&(r=r.transpose(s),a=Jr(a.length,r.rank));var u=[r],c=L.runKernelFunc(function(d,f){var h=d.min(r,a);return f([o,h]),h},{x:r},function(d,f){return jR(d,f[1],f[0],i,s)},"Min",{axes:a},u,[!0]);if(n){var l=bn(c.shape,i);c=c.reshape(l)}return c}}),zH=O({moments_:function(t,e,n){e===void 0&&(e=null),n===void 0&&(n=!1);var r=_t(e,(t=T(t,"x","moments")).shape),o=t.mean(r,n),i=o.shape;n||(i=bn(o.shape,r));var a=t.toFloat().sub(o.reshape(i)).square();return{mean:o,variance:a.mean(r,n)}}}),UR=O({sum_:function(t,e,n){e===void 0&&(e=null),n===void 0&&(n=!1);var r=T(t,"x","sum");r.dtype==="bool"&&(r=r.toInt());var o=_t(e,r.shape);return kh(function(i){var a=Qr(o,i.rank),s=o,u=i;a!=null&&(u=i.transpose(a),s=Jr(s.length,i.rank));var c=function(h){var m=i.shape.slice();return o.forEach(function(p){m[p]=1}),h.reshape(m).mul(du(i.shape,"float32"))},l={axes:s},d=L.runKernelFunc(function(h){return h.sum(u,s)},{x:u},function(h){return{x:function(){return c(h)}}},"Sum",l);if(n){var f=bn(d.shape,o);d=d.reshape(f)}return{value:d,gradFunc:c}})(r)}}),VH=O({prod_:function(t,e,n){e===void 0&&(e=null),n===void 0&&(n=!1);var r=T(t,"x","prod");r.dtype==="bool"&&(r=r.toInt());var o=_t(e,r.shape),i=Qr(o,r.rank),a=o,s=r;i!=null&&(s=r.transpose(i),a=Jr(a.length,r.rank));var u=L.runKernelFunc(function(l){return l.prod(s,a)},{permutedX:s});if(n){var c=bn(u.shape,o);u=u.reshape(c)}return u}}),WR=O({elu_:function(t){var e=T(t,"x","elu");return L.runKernelFunc(function(n,r){var o=n.elu(e);return r([o]),o},{$x:e},function(n,r){var o=r[0];return{$x:function(){return L.runKernelFunc(function(i){return i.eluDer(n,o)},{dy:n,y:o})}}})}}),HH=O({leakyRelu_:function(t,e){e===void 0&&(e=.2);var n=T(t,"x","leakyRelu");return a0(re(e).mul(n),n)}}),$R=O({prelu_:function(t,e){var n=T(t,"x","prelu"),r=T(e,"alpha","prelu");return L.runKernelFunc(function(o,i){var a=o.prelu(n,r);return i([n,r]),a},{x:n,alpha:r},function(o,i){var a=i[0],s=i[1],u=a.greater(0);return{x:function(){return xa(u,o,o.mul(s))},alpha:function(){var c=xa(u,Fe(o),o.mul(a)),l=Et(s.shape,o.shape);return l.length>0&&(c=c.sum(l)),c.reshape(s.shape)}}},"Prelu")}}),rt=O({relu_:function(t){var e=T(t,"x","relu");return e.dtype==="bool"?e.toInt():L.runKernelFunc(function(n,r){var o=n.relu(e);return r([e]),o},{x:e},function(n,r){var o=r[0];return{x:function(){return n.mulStrict(o.step().toFloat())}}},"Relu")}}),zR=O({relu6_:function(t){var e=T(t,"x","relu6");return e.dtype==="bool"?e.toInt():L.runKernelFunc(function(n,r){var o=n.relu6(e);return r([e]),o},{x:e},function(n,r){var o=r[0],i=o.lessEqual(6).mul(o.step());return{x:function(){return n.mulStrict(i.toFloat())}}},"Relu6")}}),GH=O({selu_:function(t){var e=T(t,"x","selu");return L.runKernelFunc(function(n,r){var o=n.selu(e);return r([e]),o},{$x:e},function(n,r){var o=r[0];return{$x:function(){var i=o.greater(re(0)),a=re(r0),s=re(o0),u=n.mul(s),c=n.mul(a).mul(o.toFloat().exp());return xa(i,u,c)}}})}}),Ri=O({transpose_:function(t,e){var n=T(t,"x","transpose");if(e==null&&(e=n.shape.map(function(o,i){return i}).reverse()),N(n.rank===e.length,function(){return"Error in transpose: rank of input "+n.rank+" must match length of perm "+e+"."}),e.forEach(function(o){N(o>=0&&o<n.rank,function(){return"All entries in 'perm' must be between 0 and "+(n.rank-1)+" but got "+e})}),n.rank<=1)return n.clone();var r={perm:e};return L.runKernelFunc(function(o){return o.transpose(n,e)},{x:n},function(o){var i=Ky(e);return{x:function(){return o.transpose(i)}}},"Transpose",r)}}),KH=O({localResponseNormalization_:function(t,e,n,r,o){e===void 0&&(e=5),n===void 0&&(n=1),r===void 0&&(r=1),o===void 0&&(o=.5);var i=T(t,"x","localResponseNormalization");N(i.rank===4||i.rank===3,function(){return`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank `+i.rank+"."}),N(dt(e),function(){return"Error in localResponseNormalization: depthRadius must be an integer but got depthRadius "+e+"."});var a=i,s=!1;i.rank===3&&(s=!0,a=i.as4D(1,i.shape[0],i.shape[1],i.shape[2]));var u=L.runKernelFunc(function(c,l){var d=c.localResponseNormalization4D(a,e,n,r,o);return l([a,d]),d},{x4D:a},function(c,l){var d=l[0],f=l[1];return{x4D:function(){return L.runKernelFunc(function(h){return h.LRNGrad(c,d,f,e,n,r,o)},{})}}});return s?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),VR=O({norm_:function(t,e,n,r){e===void 0&&(e="euclidean"),n===void 0&&(n=null),r===void 0&&(r=!1);var o=function s(u,c,l){if(l===void 0&&(l=null),u.rank===0)return u.abs();if(u.rank!==1&&l===null)return s(u.reshape([-1]),c,l);if(u.rank===1||typeof l=="number"||Array.isArray(l)&&l.length===1){if(c===1)return u.abs().sum(l);if(c===1/0)return u.abs().max(l);if(c===-1/0)return u.abs().min(l);if(c==="euclidean"||c===2)return u.abs().pow(re(2,"int32")).sum(l).sqrt();throw new Error("Error in norm: invalid ord value: "+c)}if(Array.isArray(l)&&l.length===2){if(c===1)return u.abs().sum(l[0]).max(l[1]-1);if(c===1/0)return u.abs().sum(l[1]).max(l[0]);if(c===-1/0)return u.abs().sum(l[1]).min(l[0]);if(c==="fro"||c==="euclidean")return u.square().sum(l).sqrt();throw new Error("Error in norm: invalid ord value: "+c)}throw new Error("Error in norm: invalid axis: "+l)}(t=T(t,"x","norm"),e,n),i=o.shape;if(r){var a=_t(n,t.shape);i=bn(o.shape,a)}return o.reshape(i)}}),qH=O({basicLSTMCell_:function(t,e,n,r,o,i){var a=T(t,"forgetBias","basicLSTMCell"),s=T(e,"lstmKernel","basicLSTMCell"),u=T(n,"lstmBias","basicLSTMCell"),c=T(r,"data","basicLSTMCell"),l=T(o,"c","basicLSTMCell"),d=T(i,"h","basicLSTMCell"),f=c.concat(d,1).matMul(s).add(u),h=f.shape[0],m=f.shape[1]/4,p=[h,m],g=f.slice([0,0],p),v=f.slice([0,m],p),y=f.slice([0,2*m],p),x=f.slice([0,3*m],p),b=g.sigmoid().mulStrict(v.tanh()).addStrict(l.mulStrict(a.add(y).sigmoid())),E=b.tanh().mulStrict(x.sigmoid());return[b,E]}}),XH=O({multiRNNCell_:function(t,e,n,r){for(var o=T(e,"data","multiRNNCell"),i=bf(n,"c","multiRNNCell"),a=bf(r,"h","multiRNNCell"),s=o,u=[],c=0;c<t.length;c++){var l=t[c](s,i[c],a[c]);u.push(l[0]),u.push(l[1]),s=l[1]}var d=[],f=[];for(c=0;c<u.length;c+=2)d.push(u[c]),f.push(u[c+1]);return[d,f]}}),YH=O({movingAverage_:function(t,e,n,r,o){o===void 0&&(o=!0);var i=T(t,"v","movingAverage"),a=T(e,"x","movingAverage"),s=T(n,"decay","movingAverage");KU(i,a),N(At(i.shape,a.shape),function(){return"Shape mismatch in v and x"});var u=re(1),c=u.sub(s),l=a.sub(i).mul(c);if(o){N(r!=null,function(){return"When using zeroDebias: true, step is required."});var d=T(r,"step","movingAverage");l=l.div(u.sub(Af(s,d)))}return i.add(l)}}),QH=O({stridedSlice_:function(t,e,n,r,o,i,a,s,u){if(o===void 0&&(o=0),i===void 0&&(i=0),a===void 0&&(a=0),s===void 0&&(s=0),u===void 0&&(u=0),r==null&&(r=new Array(e.length)),a!==0)throw new Error("ellipsis mask is not yet supported");var c=T(t,"x","stridedSlice"),l=ob(s),d=c.shape.slice();l.forEach(function(g){e[g]=0,n[g]=1,d.splice(g,0,1)}),c=c.reshape(d);for(var f=0;f<c.rank;f++)e[f]=s$(o,e,r,c.shape,f),n[f]=u$(i,n,r,c.shape,f),r[f]=r[f]||1;var h=ob(u);h.forEach(function(g){n[g]=e[g]+1,r[g]=1});var m=Qy(e,n,r),p=m.filter(function(g,v){return h.indexOf(v)===-1});return r.every(function(g){return g===1})?Kr(c,e,m).reshape(p):L.runKernelFunc(function(g){return g.stridedSlice(c,e,n,r)},{$x:c}).reshape(p)}}),JH=O({topk_:function(t,e,n){e===void 0&&(e=1),n===void 0&&(n=!0);var r=T(t,"x","topk");if(r.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");var o=r.shape[r.shape.length-1];if(e>o)throw new Error("'k' passed to topk() must be <= the last dimension ("+o+") but got "+e);var i=L.runKernelFunc(function(a){return a.topk(r,e,n)},{$x:r});return{values:i[0],indices:i[1]}}}),ZH=O({scatterND_:function(t,e,n){var r=T(t,"indices","scatterND","int32"),o=T(e,"updates","scatterND");return i$(o,r,n),L.runKernelFunc(function(i){return i.scatterND(r,o,n)},{indices:r,updates:o},null,"ScatterNd",{shape:n})}}),l0=O({fft_:function(t){N(t.dtype==="complex64",function(){return"The dtype for tf.spectral.fft() must be complex64 but got "+t.dtype+"."});var e=t.shape[t.shape.length-1],n=t.size/e,r=t.as2D(n,e);return L.runKernelFunc(function(o){return o.fft(r)},{input:t}).reshape(t.shape)}}),Pf=O({ifft_:function(t){N(t.dtype==="complex64",function(){return"The dtype for tf.spectral.ifft() must be complex64 but got "+t.dtype+"."});var e=t.shape[t.shape.length-1],n=t.size/e,r=t.as2D(n,e);return L.runKernelFunc(function(o){return o.ifft(r)},{input:t}).reshape(t.shape)}}),d0=O({rfft_:function(t,e){N(t.dtype==="float32",function(){return"The dtype for rfft() must be real value but got "+t.dtype});var n,r=t.shape[t.shape.length-1],o=t.size/r;if(e!=null&&e<r){var i=t.shape.map(function(v){return 0}),a=t.shape.map(function(v){return v});a[t.shape.length-1]=e,n=t.slice(i,a),r=e}else if(e!=null&&e>r){var s=t.shape.map(function(v){return v});s[t.shape.length-1]=e-r,n=t.concat(Ye(s),t.shape.length-1),r=e}else n=t;var u=n.zerosLike(),c=Ft(n,u).as2D(o,r),l=l0(c),d=Math.floor(r/2)+1,f=$n(l),h=Or(l),m=f.split([d,r-d],f.shape.length-1),p=h.split([d,r-d],h.shape.length-1),g=n.shape.slice();return g[n.shape.length-1]=d,Ft(m[0],p[0]).reshape(g)}}),HR=O({irfft_:function(t){var e=t.shape[t.shape.length-1],n=t.size/e;if(e<=2){var r=t.as2D(n,e),o=Pf(r);return $n(o)}var i=[n,2*(e-1)],a=$n(t).as2D(n,e),s=Or(t).as2D(n,e),u=a.slice([0,1],[n,e-2]).reverse(1),c=s.slice([0,1],[n,e-2]).reverse(1).mul(re(-1)),l=a.concat(u,1),d=s.concat(c,1);return r=Ft(l,d).as2D(i[0],i[1]),o=Pf(r),$n(o)}}),e7=Object.freeze({fft:l0,ifft:Pf,rfft:d0,irfft:HR}),t7=O({sparseToDense_:function(t,e,n,r){r===void 0&&(r=0);var o=T(t,"sparseIndices","sparseToDense","int32"),i=T(e,"sparseValues","sparseToDense"),a=T(r,"defaultValue","sparseToDense",i.dtype);return function(s,u,c,l){if(s.dtype!=="int32")throw new Error("tf.sparseToDense() expects the indices to be int32 type, but the dtype was "+s.dtype+".");if(s.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix, but got shape "+s.shape+".");var d=s.rank>0?s.shape[0]:1,f=s.rank>1?s.shape[1]:1;if(c.length!==f)throw new Error("outputShape has incorrect number of elements:, "+c.length+", should be: "+f+".");var h=u.size;if(u.rank!==0&&(u.rank!==1||h!==d))throw new Error("sparseValues has incorrect shape "+u.shape+", should be [] or ["+d+"]");if(u.dtype!==l.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}(o,i,n,a),L.runKernelFunc(function(s){return s.sparseToDense(o,i,n,a)},{$sparseIndices:o,$sparseValues:i,$defaultValue:a})}}),n7=O({gatherND_:function(t,e){var n=T(e,"indices","gatherND","int32"),r=T(t,"x","gatherND");return L.runKernelFunc(function(o){return o.gatherND(r,n)},{x:r,indices:n},null,"GatherNd")}}),r7=O({diag_:function(t){var e=T(t,"x","diag").flatten(),n=t.shape.concat(t.shape);return L.runKernelFunc(function(r){return r.diag(e)},{$x:e}).reshape(n)}}),o7=O({dropout_:function(t,e,n,r){var o=T(t,"x","dropout");if(N(o.dtype==="float32",function(){return"x has to be a floating point tensor since it's going to be scaled, but got a "+o.dtype+" tensor instead."}),N(e>=0&&e<1,function(){return"rate must be a float in the range [0, 1), but got "+e+"."}),e===0)return t instanceof nt?o.clone():o;var i=function(u,c){if(c==null)return u.shape.slice();if(At(u.shape,c))return c;if(u.shape.length===c.length){for(var l=[],d=0;d<u.shape.length;d++)c[d]==null&&u.shape[d]!=null?l.push(u.shape[d]):l.push(c[d]);return l}return c}(o,n),a=1-e,s=$I(i,0,1,"float32",r).add(a).floor().div(a);return o.mul(s)}});function GR(t,e,n){for(var r=1-t%2,o=new Float32Array(t),i=0;i<t;++i){var a=2*Math.PI*i/(t+r-1);o[i]=e-n*Math.cos(a)}return ht(o,"float32")}var f0=O({hannWindow_:function(t){return GR(t,.5,.5)}}),KR=O({hammingWindow_:function(t){return GR(t,.54,.46)}}),h0=O({frame_:function(t,e,n,r,o){r===void 0&&(r=!1),o===void 0&&(o=0);for(var i=0,a=[];i+e<=t.size;)a.push(Kr(t,i,e)),i+=n;if(r)for(;i<t.size;){var s=i+e-t.size,u=wt([Kr(t,i,e-s),Hr([s],o)]);a.push(u),i+=n}return a.length===0?bi([],[0,e]):wt(a).as2D(a.length,e)}}),qR=O({stft_:function(t,e,n,r,o){var i;o===void 0&&(o=f0),r==null&&(i=e,r=Math.floor(Math.pow(2,Math.ceil(Math.log(i)/Math.log(2)))));for(var a=h0(t,e,n),s=Yt(a,o(e)),u=[],c=0;c<a.shape[0];c++)u.push(d0(s.slice([c,0],[1,e]),r));return wt(u)}}),i7=Object.freeze({hannWindow:f0,hammingWindow:KR,frame:h0,stft:qR}),Xt,a7=function(t,e,n){return n===void 0&&(n=1),ce(this,void 0,void 0,function(){var r,o,i,a,s,u,c,l,d,f,h,m,p,g;return le(this,function(v){switch(v.label){case 0:return r=T(t,"predictions","inTopK"),o=T(e,"targets","inTopK"),N(r.rank>1,function(){return"inTopK() expects the predictions to be of rank 2 or higher, but got "+r.rank}),N(r.rank-1===o.rank,function(){return"predictions rank should be 1 larger than targets rank, but got predictions rank "+r.rank+" and targets rank "+o.rank}),$e(r.shape.slice(0,r.shape.length-1),o.shape,"predictions's shape should be align with the targets' shape, except the last dimension."),i=r.shape[r.shape.length-1],N(n>0&&n<=i,function(){return"'k' passed to inTopK() must be > 0 && <= the predictions last dimension ("+i+"), but got "+n}),[4,r.data()];case 1:return a=v.sent(),[4,o.data()];case 2:for(s=v.sent(),u=[a.length/i,i],l=u[1],d=kc("bool",c=u[0]),f=0;f<c;f++){for(h=f*l,m=a.subarray(h,h+l),p=[],g=0;g<m.length;g++)p.push({value:m[g],index:g});for(p.sort(function(y,x){return x.value-y.value}),d[f]=0,g=0;g<n;g++)if(p[g].index===s[f]){d[f]=1;break}}return t!==r&&r.dispose(),e!==o&&o.dispose(),[2,Bt(d,o.shape,"bool")]}})})};(function(t){t[t.NONE=0]="NONE",t[t.MEAN=1]="MEAN",t[t.SUM=2]="SUM",t[t.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(Xt||(Xt={}));var s7=O({absoluteDifference_:function(t,e,n,r){r===void 0&&(r=Xt.SUM_BY_NONZERO_WEIGHTS);var o=T(t,"labels","absoluteDifference"),i=T(e,"predictions","absoluteDifference"),a=null;n!=null&&(a=T(n,"weights","absoluteDifference")),$e(o.shape,i.shape,"Error in absoluteDifference: ");var s=o.sub(i).abs();return Ao(s,a,r)}}),Ao=O({computeWeightedLoss_:function(t,e,n){n===void 0&&(n=Xt.SUM_BY_NONZERO_WEIGHTS);var r=T(t,"losses","computeWeightedLoss"),o=null;e!=null&&(o=T(e,"weights","computeWeightedLoss"));var i=o==null?r:r.mul(o);if(n===Xt.NONE)return i;if(n===Xt.SUM)return i.sum();if(n===Xt.MEAN){if(o==null)return i.mean();var a=r.size/o.size,s=i.sum().div(o.sum());return a>1?s.div(re(a)):s}if(n===Xt.SUM_BY_NONZERO_WEIGHTS){if(o==null)return i.sum().div(re(r.size));var u=o.mul(du(r.shape)).notEqual(re(0)).sum().toFloat();return i.sum().div(u)}throw Error("Unknown reduction: "+n)}}),u7=O({cosineDistance_:function(t,e,n,r,o){o===void 0&&(o=Xt.SUM_BY_NONZERO_WEIGHTS);var i=T(t,"labels","cosineDistance"),a=T(e,"predictions","cosineDistance"),s=null;r!=null&&(s=T(r,"weights","cosineDistance")),$e(i.shape,a.shape,"Error in cosineDistance: ");var u=re(1).sub(i.mul(a).sum(n,!0));return Ao(u,s,o)}}),c7=O({hingeLoss_:function(t,e,n,r){r===void 0&&(r=Xt.SUM_BY_NONZERO_WEIGHTS);var o=T(t,"labels","hingeLoss"),i=T(e,"predictions","hingeLoss"),a=null;n!=null&&(a=T(n,"weights","hingeLoss")),$e(o.shape,i.shape,"Error in hingeLoss: ");var s=re(1);o=re(2).mul(o).sub(s);var u=s.sub(o.mul(i)).relu();return Ao(u,a,r)}}),l7=O({huberLoss_:function(t,e,n,r,o){r===void 0&&(r=1),o===void 0&&(o=Xt.SUM_BY_NONZERO_WEIGHTS);var i=T(t,"labels","huberLoss"),a=T(e,"predictions","huberLoss"),s=null;n!=null&&(s=T(n,"weights","huberLoss")),$e(i.shape,a.shape,"Error in huberLoss: ");var u=re(r),c=a.sub(i).abs(),l=IR(c,u),d=c.sub(l),f=re(.5).mul(l.square()).add(u.mul(d));return Ao(f,s,o)}}),d7=O({logLoss_:function(t,e,n,r,o){r===void 0&&(r=1e-7),o===void 0&&(o=Xt.SUM_BY_NONZERO_WEIGHTS);var i=T(t,"labels","logLoss"),a=T(e,"predictions","logLoss"),s=null;n!=null&&(s=T(n,"weights","logLoss")),$e(i.shape,a.shape,"Error in logLoss: ");var u=re(1),c=re(r),l=i.mul(a.add(c).log()).neg().sub(u.sub(i).mul(u.sub(a).add(c).log()));return Ao(l,s,o)}}),f7=O({meanSquaredError_:function(t,e,n,r){r===void 0&&(r=Xt.SUM_BY_NONZERO_WEIGHTS);var o=T(t,"labels","meanSquaredError"),i=T(e,"predictions","meanSquaredError"),a=null;n!=null&&(a=T(n,"weights","meanSquaredError")),$e(o.shape,i.shape,"Error in meanSquaredError: ");var s=o.squaredDifference(i);return Ao(s,a,r)}}),h7=O({sigmoidCrossEntropy_:function(t,e,n,r,o){r===void 0&&(r=0),o===void 0&&(o=Xt.SUM_BY_NONZERO_WEIGHTS);var i=T(t,"multiClassLabels","sigmoidCrossEntropy"),a=T(e,"logits","sigmoidCrossEntropy"),s=null;if(n!=null&&(s=T(n,"weights","sigmoidCrossEntropy")),$e(i.shape,a.shape,"Error in sigmoidCrossEntropy: "),r>0){var u=re(r),c=re(1),l=re(.5);i=i.mul(c.sub(u)).add(l.mul(u))}var d=function(f,h){var m=T(f,"labels","sigmoidCrossEntropyWithLogits"),p=T(h,"logits","sigmoidCrossEntropyWithLogits");$e(m.shape,p.shape,"Error in sigmoidCrossEntropyWithLogits: ");var g=p.relu(),v=p.mul(m),y=p.abs().neg().exp().log1p();return g.sub(v).add(y)}(i,a);return Ao(d,s,o)}}),p7=O({softmaxCrossEntropy_:function(t,e,n,r,o){r===void 0&&(r=0),o===void 0&&(o=Xt.SUM_BY_NONZERO_WEIGHTS);var i=T(t,"onehotLabels","softmaxCrossEntropy"),a=T(e,"logits","softmaxCrossEntropy"),s=null;if(n!=null&&(s=T(n,"weights","softmaxCrossEntropy")),$e(i.shape,a.shape,"Error in softmaxCrossEntropy: "),r>0){var u=re(r),c=re(1),l=re(i.shape[1]);i=i.mul(c.sub(u)).add(u.div(l))}var d=function(f,h,m){if(m===void 0&&(m=-1),m===-1&&(m=h.rank-1),m!==h.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank "+h.rank+" and dim was "+m);return kh(function(p,g,v){var y=g.logSumExp([m],!0),x=g.toFloat().sub(y);return v([p,x]),{value:x.mul(p).neg().sum([m]),gradFunc:function(b,E){var _=E[0],S=E[1],k=bn(b.shape,[m]);return[b.reshape(k).mul(_.toFloat().sub(S.exp())),b.reshape(k).mul(S.exp().sub(_.toFloat()))]}}})(f,h)}(i,a);return Ao(d,s,o)}}),m7=Object.freeze({get Reduction(){return Xt},absoluteDifference:s7,computeWeightedLoss:Ao,cosineDistance:u7,hingeLoss:c7,huberLoss:l7,logLoss:d7,meanSquaredError:f7,sigmoidCrossEntropy:h7,softmaxCrossEntropy:p7});function kb(t,e){return e===void 0&&(e=!1),L.tidy(function(){if(t.shape.length!==2)throw new Error("qr2d() requires a 2D Tensor, but got a "+t.shape.length+"D Tensor.");for(var n=t.shape[0],r=t.shape[1],o=WI(n),i=t.clone(),a=bi([[1]],[1,1]),s=a.clone(),u=n>=r?r:n,c=function(d){var f,h=i,m=s,p=o;f=L.tidy(function(){var g=i.slice([d,d],[n-d,1]),v=g.norm(),y=i.slice([d,d],[1,1]),x=bi([[-1]]).where(y.greater(0),bi([[1]])),b=y.sub(x.mul(v)),E=g.div(b);s=E.shape[0]===1?a.clone():a.concat(E.slice([1,0],[E.shape[0]-1,E.shape[1]]),0);var _=x.matMul(b).div(v).neg(),S=i.slice([d,0],[n-d,r]),k=_.mul(s);if(d===0)i=S.sub(k.matMul(s.transpose().matMul(S)));else{var R=S.sub(k.matMul(s.transpose().matMul(S)));i=i.slice([0,0],[d,r]).concat(R,0)}var I=o.slice([0,d],[n,o.shape[1]-d]);if(d===0)o=I.sub(I.matMul(s).matMul(k.transpose()));else{var D=I.sub(I.matMul(s).matMul(k.transpose()));o=o.slice([0,0],[n,d]).concat(D,1)}return[s,i,o]}),s=f[0],i=f[1],o=f[2],xn([h,m,p])},l=0;l<u;++l)c(l);return!e&&n>r&&(o=o.slice([0,0],[n,r]),i=i.slice([0,0],[r,r])),[o,i]})}var v7=O({bandPart_:function(t,e,n){if(e%1!=0)throw new Error("bandPart(): numLower must be an integer, got "+e+".");if(n%1!=0)throw new Error("bandPart(): numUpper must be an integer, got "+n+".");var r=T(t,"a","bandPart");if(r.rank<2)throw new Error("bandPart(): Rank must be at least 2, got "+r.rank+".");var o=r.shape,i=r.shape.slice(-2),a=i[0],s=i[1];if(!(e<=a))throw new Error("bandPart(): numLower ("+e+") must not be greater than the number of rows ("+a+").");if(!(n<=s))throw new Error("bandPart(): numUpper ("+n+") must not be greater than the number of columns ("+s+").");e<0&&(e=a),n<0&&(n=s);var u=Ef(0,a,1,"int32").reshape([-1,1]),c=Ef(0,s,1,"int32"),l=Ct(u,c),d=Rh(l.lessEqual(re(+e,"int32")),l.greaterEqual(re(-n,"int32"))),f=Ye([a,s],r.dtype);return Mn(bt(r.reshape([-1,a,s])).map(function(h){return xa(d,h,f)})).reshape(o)}}),g7=O({gramSchmidt_:function(t){var e;if(Array.isArray(t)){e=!1,N(t!=null&&t.length>0,function(){return"Gram-Schmidt process: input must not be null, undefined, or empty"});for(var n=t[0].shape[0],r=function(u){N(t[u].shape[0]===n,function(){return"Gram-Schmidt: Non-unique lengths found in the input vectors: ("+t[u].shape[0]+" vs. "+n+")"})},o=1;o<t.length;++o)r(o)}else e=!0,t=Xy(t,t.shape[0],0).map(function(u){return VI(u,[0])});N(t.length<=t[0].shape[0],function(){return"Gram-Schmidt: Number of vectors ("+t.length+") exceeds number of dimensions ("+t[0].shape[0]+")."});var i=[],a=t,s=function(u){i.push(L.tidy(function(){var c=a[u];if(u>0)for(var l=0;l<u;++l){var d=UR(i[l].mulStrict(c)).mul(i[l]);c=c.sub(d)}return c.div(VR(c,"euclidean"))}))};for(o=0;o<t.length;++o)s(o);return e?Mn(i,0):i}}),y7=O({qr_:function(t,e){if(e===void 0&&(e=!1),t.rank<2)throw new Error("qr() requires input tensor to have a rank >= 2, but got rank "+t.rank);if(t.rank===2)return kb(t,e);var n=t.shape.slice(0,t.shape.length-2).reduce(function(a,s){return a*s}),r=bt(t.reshape([n,t.shape[t.shape.length-2],t.shape[t.shape.length-1]]),0),o=[],i=[];return r.forEach(function(a){var s=kb(a,e),u=s[0],c=s[1];o.push(u),i.push(c)}),[Mn(o,0).reshape(t.shape),Mn(i,0).reshape(t.shape)]}}),x7=Object.freeze({bandPart:v7,gramSchmidt:g7,qr:y7});function Ph(t,e,n,r,o,i){r==null&&(r=.5),o==null&&(o=Number.NEGATIVE_INFINITY),i==null&&(i=0);var a=t.shape[0];return n=Math.min(n,a),N(0<=r&&r<=1,function(){return"iouThreshold must be in [0, 1], but was '"+r+"'"}),N(t.rank===2,function(){return"boxes must be a 2D tensor, but was of rank '"+t.rank+"'"}),N(t.shape[1]===4,function(){return"boxes must have 4 columns, but 2nd dimension was "+t.shape[1]}),N(e.rank===1,function(){return"scores must be a 1D tensor"}),N(e.shape[0]===a,function(){return"scores has incompatible shape with boxes. Expected "+a+", but was "+e.shape[0]}),N(0<=i&&i<=1,function(){return"softNmsSigma must be in [0, 1], but was '"+i+"'"}),{maxOutputSize:n,iouThreshold:r,scoreThreshold:o,softNmsSigma:i}}var w7=O({resizeBilinear_:function(t,e,n){n===void 0&&(n=!1);var r=T(t,"images","resizeBilinear");N(r.rank===3||r.rank===4,function(){return"Error in resizeBilinear: x must be rank 3 or 4, but got rank "+r.rank+"."}),N(e.length===2,function(){return"Error in resizeBilinear: new shape must 2D, but got shape "+e+"."});var o=r,i=!1;r.rank===3&&(i=!0,o=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var a=e[0],s=e[1],u=L.runKernelFunc(function(c,l){return l([o]),c.resizeBilinear(o,a,s,n)},{x:o},function(c,l){return{x:function(){return L.runKernelFunc(function(d){return d.resizeBilinearBackprop(c,l[0],n)},{})}}},"ResizeBilinear",{alignCorners:n,newHeight:a,newWidth:s});return i?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),b7=O({resizeNearestNeighbor_:function(t,e,n){n===void 0&&(n=!1);var r=T(t,"images","resizeNearestNeighbor");N(r.rank===3||r.rank===4,function(){return"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank "+r.rank+"."}),N(e.length===2,function(){return"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+e+"."}),N(r.dtype==="float32"||r.dtype==="int32",function(){return"`images` must have `int32` or `float32` as dtype"});var o=r,i=!1;r.rank===3&&(i=!0,o=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var a=e[0],s=e[1],u=L.runKernelFunc(function(c,l){return l([o]),c.resizeNearestNeighbor(o,a,s,n)},{batchImages:o},function(c,l){return{batchImages:function(){return L.runKernelFunc(function(d){return d.resizeNearestNeighborBackprop(c,l[0],n)},{})}}});return i?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),E7=O({nonMaxSuppression_:function(t,e,n,r,o){r===void 0&&(r=.5),o===void 0&&(o=Number.NEGATIVE_INFINITY);var i=T(t,"boxes","nonMaxSuppression"),a=T(e,"scores","nonMaxSuppression"),s=Ph(i,a,n,r,o);n=s.maxOutputSize,r=s.iouThreshold,o=s.scoreThreshold;var u={maxOutputSize:n,iouThreshold:r,scoreThreshold:o};return L.runKernelFunc(function(c){return c.nonMaxSuppression(i,a,n,r,o)},{boxes:i,scores:a},null,"NonMaxSuppressionV3",u)}}),C7=function(t,e,n,r,o){return r===void 0&&(r=.5),o===void 0&&(o=Number.NEGATIVE_INFINITY),ce(this,void 0,void 0,function(){var i,a,s,u,c,l,d;return le(this,function(f){switch(f.label){case 0:return i=T(t,"boxes","nonMaxSuppressionAsync"),a=T(e,"scores","nonMaxSuppressionAsync"),s=Ph(i,a,n,r,o),n=s.maxOutputSize,r=s.iouThreshold,o=s.scoreThreshold,[4,Promise.all([i.data(),a.data()])];case 1:return u=f.sent(),c=u[0],l=u[1],d=Zy(c,l,n,r,o),i!==t&&i.dispose(),a!==e&&a.dispose(),[2,d]}})})},_7=O({nonMaxSuppressionWithScore_:function(t,e,n,r,o,i){r===void 0&&(r=.5),o===void 0&&(o=Number.NEGATIVE_INFINITY),i===void 0&&(i=0);var a=T(t,"boxes","nonMaxSuppression"),s=T(e,"scores","nonMaxSuppression"),u=Ph(a,s,n,r,o,i),c={maxOutputSize:n=u.maxOutputSize,iouThreshold:r=u.iouThreshold,scoreThreshold:o=u.scoreThreshold,softNmsSigma:i=u.softNmsSigma},l=L.runKernel("NonMaxSuppressionV5",{boxes:a,scores:s},c);return{selectedIndices:l[0],selectedScores:l[1]}}}),S7=function(t,e,n,r,o,i){return r===void 0&&(r=.5),o===void 0&&(o=Number.NEGATIVE_INFINITY),i===void 0&&(i=0),ce(this,void 0,void 0,function(){var a,s,u,c,l,d,f;return le(this,function(h){switch(h.label){case 0:return a=T(t,"boxes","nonMaxSuppressionAsync"),s=T(e,"scores","nonMaxSuppressionAsync"),u=Ph(a,s,n,r,o,i),n=u.maxOutputSize,r=u.iouThreshold,o=u.scoreThreshold,i=u.softNmsSigma,[4,Promise.all([a.data(),s.data()])];case 1:return c=h.sent(),l=c[0],d=c[1],f=e0(l,d,n,r,o,i),a!==t&&a.dispose(),s!==e&&s.dispose(),[2,f]}})})},k7=O({cropAndResize_:function(t,e,n,r,o,i){var a=T(t,"image","cropAndResize"),s=T(e,"boxes","cropAndResize","float32"),u=T(n,"boxInd","cropAndResize","int32");o=o||"bilinear",i=i||0;var c=s.shape[0];return N(a.rank===4,function(){return"Error in cropAndResize: image must be rank 4,but got rank "+a.rank+"."}),N(s.rank===2&&s.shape[1]===4,function(){return"Error in cropAndResize: boxes must be have size ["+c+",4] but had shape "+s.shape+"."}),N(u.rank===1&&u.shape[0]===c,function(){return"Error in cropAndResize: boxInd must be have size ["+c+"] but had shape "+s.shape+"."}),N(r.length===2,function(){return"Error in cropAndResize: cropSize must be of length 2, but got length "+r.length+"."}),N(r[0]>=1&&r[1]>=1,function(){return"cropSize must be atleast [1,1], but was "+r}),N(o==="bilinear"||o==="nearest",function(){return"method must be bilinear or nearest, but was "+o}),L.runKernelFunc(function(l,d){return l.cropAndResize(a,s,u,r,o,i)},{images:a,boxes:s,boxInd:u},null,"CropAndResize",{method:o,extrapolationValue:i,cropSize:r})}}),p0=Object.freeze({resizeBilinear:w7,resizeNearestNeighbor:b7,nonMaxSuppression:E7,nonMaxSuppressionAsync:C7,nonMaxSuppressionWithScore:_7,nonMaxSuppressionWithScoreAsync:S7,cropAndResize:k7}),m0=function(t,e){return!(t>0)||e==="linear"},v0=function(t,e,n){if(n==null||n==="linear")return t;if(n==="relu")return t.mul(e.step());throw new Error("Gradient for activation "+n+" has not been implemented yet.")},g0=function(t,e){var n=e,r=Et(t.shape,e.shape);return r.length>0&&(n=n.sum(r)),n.reshape(t.shape)},y0=function(t,e,n){if(e==="linear")return t;if(e==="relu")return rt(t);if(e==="elu")return WR(t);if(e==="relu6")return zR(t);if(e==="prelu")return $R(t,n);throw new Error("Unknown fused activation "+e+".")},I7=O({fusedMatMul_:function(t){var e,n=t.a,r=t.b,o=t.transposeA,i=o!==void 0&&o,a=t.transposeB,s=a!==void 0&&a,u=t.bias,c=t.activation,l=c===void 0?"linear":c,d=t.preluActivationWeights;if(m0(L.state.gradientDepth,l)===!1){var f=Nh(n,r,i,s);return u!=null&&(f=Te(f,u)),y0(f,l,d)}var h=T(n,"a","fused matMul"),m=T(r,"b","fused matMul");e=at(h,m),h=e[0],m=e[1];var p=i?h.shape[h.rank-2]:h.shape[h.rank-1],g=s?m.shape[m.rank-1]:m.shape[m.rank-2],v=i?h.shape[h.rank-1]:h.shape[h.rank-2],y=s?m.shape[m.rank-2]:m.shape[m.rank-1],x=h.shape.slice(0,-2),b=m.shape.slice(0,-2),E=de(x),_=de(b);N(h.rank>=2&&m.rank>=2&&h.rank===m.rank,function(){return"Error in fused matMul: inputs must have the same rank of at least 2, got ranks "+h.rank+" and "+m.rank+"."}),N(At(x,b),function(){return"Error in fused matMul: outer dimensions ("+x+") and ("+b+") of Tensors with shapes "+h.shape+" and "+m.shape+" must match."}),N(p===g,function(){return"Error in fused matMul: inner shapes ("+p+") and ("+g+") of Tensors with shapes "+h.shape+" and "+m.shape+" and transposeA="+i+" and transposeB="+s+" must match."});var S,k,R=h.shape.slice(0,-2).concat([v,y]),I=i?h.as3D(E,p,v):h.as3D(E,v,p),D=s?m.as3D(_,y,g):m.as3D(_,g,y);u!=null&&Pe(R,(S=at(S=T(u,"bias","fused matMul"),h)[0]).shape),d!=null&&(k=T(d,"prelu weights","fused matMul"));var A={a:I,b:D};u!=null&&(A.bias=S),d!=null&&(A.preluActivationWeights=k);var W=[I,D];return L.runKernelFunc(function(F,$){var j=F.fusedBatchMatMul({a:I,b:D,transposeA:i,transposeB:s,bias:S,activation:l,preluActivationWeights:k});return $([I,D,j]),j},A,function(F,$){var j=$[0],U=$[1],M=$[2],P=v0(F,M,l),B={};return u!=null&&(B={bias:function(){return g0(S,P)}}),Object.assign(i||s?!i&&s?{a:function(){return P.matMul(U,!1,!1)},b:function(){return P.matMul(j,!0,!1)}}:i&&!s?{a:function(){return U.matMul(P,!1,!0)},b:function(){return j.matMul(P,!1,!1)}}:{a:function(){return U.matMul(P,!0,!0)},b:function(){return P.matMul(j,!0,!0)}}:{a:function(){return P.matMul(U,!1,!0)},b:function(){return j.matMul(P,!0,!1)}},B)},"_FusedMatMul",{transposeA:i,transposeB:s,activation:l},W,[!0]).reshape(R)}}),R7=O({fusedConv2d_:function(t){var e=t.x,n=t.filter,r=t.strides,o=t.pad,i=t.dataFormat,a=i===void 0?"NHWC":i,s=t.dilations,u=s===void 0?[1,1]:s,c=t.dimRoundingMode,l=t.bias,d=t.activation,f=d===void 0?"linear":d,h=t.preluActivationWeights;if(f=f||"linear",m0(L.state.gradientDepth,f)===!1){var m=Yn(e,n,r,o,a,u,c);return l!=null&&(m=Te(m,l)),y0(m,f,h)}var p=T(e,"x","conv2d"),g=T(n,"filter","conv2d"),v=p,y=!1;p.rank===3&&(y=!0,v=p.as4D(1,p.shape[0],p.shape[1],p.shape[2])),N(v.rank===4,function(){return"Error in fused conv2d: input must be rank 4, but got rank "+v.rank+"."}),N(g.rank===4,function(){return"Error in fused conv2d: filter must be rank 4, but got rank "+g.rank+"."}),c!=null&&N(dt(o),function(){return"Error in fused conv2d: pad must be an integer when using, dimRoundingMode "+c+" but got pad "+o+"."}),N(v.shape[3]===g.shape[2],function(){return"Error in conv2d: depth of input ("+v.shape[3]+") must match input depth for filter "+g.shape[2]+"."}),N(En(r,u),function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+u+"'"}),N(a==="NHWC",function(){return"Error in conv2d: got dataFormat of "+a+" but only NHWC is currently supported."});var x,b,E=Na(v.shape,g.shape,r,u,o,c);l!=null&&(x=at(x=T(l,"bias","fused conv2d"),p)[0],Pe(E.outShape,x.shape)),h!=null&&(b=T(h,"prelu weights","fused conv2d"));var _={x:v,filter:g};l!=null&&(_.bias=x),h!=null&&(_.preluActivationWeights=b);var S=[g,v],k=L.runKernelFunc(function(R,I){var D=R.fusedConv2d({input:v,filter:g,convInfo:E,bias:x,activation:f,preluActivationWeights:b});return I([g,v,D]),D},_,function(R,I){var D=I,A=D[0],W=D[1],F=D[2],$=v0(R,F,f);N(Zs(u),function(){return"Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+u+"'"});var j={};return l!=null&&(j={bias:function(){return g0(x,$)}}),Object.assign({x:function(){return DR(W.shape,$,A,r,o)},filter:function(){return u0(W,$,A.shape,r,o)}},j)},"FusedConv2D",{convInfo:E,activation:f},S,[!0]);return y?k.as3D(k.shape[1],k.shape[2],k.shape[3]):k}}),T7=O({fusedDepthwiseConv2d_:function(t){var e=t.x,n=t.filter,r=t.strides,o=t.pad,i=t.dataFormat,a=i===void 0?"NHWC":i,s=t.dilations,u=s===void 0?[1,1]:s,c=t.dimRoundingMode,l=t.bias,d=t.activation,f=d===void 0?"linear":d,h=t.preluActivationWeights;if(m0(L.state.gradientDepth,f)===!1){var m=Th(e,n,r,o,a,u,c);return l!=null&&(m=Te(m,l)),y0(m,f,h)}var p=T(e,"x","depthwiseConv2d"),g=T(n,"filter","depthwiseConv2d"),v=p,y=!1;p.rank===3&&(y=!0,v=p.as4D(1,p.shape[0],p.shape[1],p.shape[2])),N(v.rank===4,function(){return"Error in fused depthwiseConv2d: input must be rank 4, but got rank "+v.rank+"."}),N(g.rank===4,function(){return"Error in fused depthwiseConv2d: filter must be rank 4, but got rank "+g.rank+"."}),N(v.shape[3]===g.shape[2],function(){return"Error in fused depthwiseConv2d: number of input channels ("+v.shape[3]+") must match the inChannels dimension in filter "+g.shape[2]+"."}),u==null&&(u=[1,1]),N(En(r,u),function(){return"Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+u+"'"}),c!=null&&N(dt(o),function(){return"Error in fused depthwiseConv2d: pad must be an integer when using dimRoundingMode "+c+" but got pad "+o+"."});var x,b,E=Na(v.shape,g.shape,r,u,o,c,!0);l!=null&&(x=at(x=T(l,"bias","fused conv2d"),p)[0],Pe(E.outShape,x.shape)),h!=null&&(b=T(h,"prelu weights","fused depthwiseConv2d"));var _={x:v,filter:g};l!=null&&(_.bias=x),h!=null&&(_.preluActivationWeights=b);var S=[g,v],k=L.runKernelFunc(function(R,I){var D=R.fusedDepthwiseConv2D({input:v,filter:g,convInfo:E,bias:x,activation:f,preluActivationWeights:b});return I([g,v,D]),D},_,function(R,I){N(Zs(u),function(){return"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+u+"'"});var D=I[0],A=I[1],W=I[2],F=v0(R,W,f),$={};return l!=null&&($={bias:function(){return g0(x,F)}}),Object.assign({x:function(){return MR(A.shape,F,D,E)},filter:function(){return OR(A,F,D.shape,E)}},$)},"FusedDepthwiseConv2D",{convInfo:E,activation:f},S,[!0]);return y?k.as3D(k.shape[1],k.shape[2],k.shape[3]):k}}),N7=Object.freeze({matMul:I7,conv2d:R7,depthwiseConv2d:T7}),A7=Object.freeze({image:p0,linalg:x7,losses:m7,spectral:e7,fused:N7,signal:i7,square:dV,squaredDifference:gR,conv1d:wH,conv2d:Yn,conv3d:bH,depthwiseConv2d:Th,separableConv2d:c0,conv2dTranspose:EH,conv3dTranspose:CH,op:O,batchNormalization2d:WV,batchNormalization3d:$V,batchNormalization4d:zV,batchNormalization:VV,batchNorm:CR,batchNorm2d:HV,batchNorm3d:GV,batchNorm4d:KV,booleanMaskAsync:xH,complex:Ft,real:$n,imag:Or,concat:wt,concat1d:NW,concat2d:AW,concat3d:PW,concat4d:DW,split:Xy,matMul:Nh,dot:_H,outerProduct:SH,reverse:sl,reverse1d:kH,reverse2d:IH,reverse3d:RH,reverse4d:TH,maxPool:Rt,avgPool:ul,pool:NH,maxPool3d:AH,avgPool3d:PH,slice:Kr,slice1d:DH,slice2d:MH,slice3d:BR,slice4d:OH,abs:fV,acos:hV,acosh:pV,asin:mV,asinh:vV,atan:gV,atanh:yV,ceil:xV,clipByValue:i0,cos:wV,cosh:bV,erf:EV,exp:Qv,expm1:CV,floor:_V,log:SV,log1p:kV,logSigmoid:IV,neg:Nf,reciprocal:RV,round:TV,rsqrt:yR,sigmoid:xR,sign:NV,isNaN:AV,isInf:PV,isFinite:DV,sin:MV,sinh:OV,softplus:FV,sqrt:LV,step:BV,tan:jV,tanh:UV,all:FH,any:LH,argMax:BH,argMin:jH,logSumExp:UH,max:Ah,mean:WH,min:$H,moments:zH,sum:UR,prod:VH,equal:RR,equalStrict:cH,greater:lH,greaterEqual:TR,greaterEqualStrict:dH,greaterStrict:fH,less:hH,lessEqual:pH,lessEqualStrict:mH,lessStrict:vH,notEqual:gH,notEqualStrict:yH,add:Te,addN:YV,addStrict:QV,atan2:JV,div:cr,divNoNan:ZV,divStrict:eH,floorDiv:kR,maximum:a0,maximumStrict:tH,minimum:IR,minimumStrict:nH,mod:rH,modStrict:oH,mul:Yt,mulStrict:iH,pow:Af,powStrict:aH,squaredDifferenceStrict:sH,sub:Ct,subStrict:uH,elu:WR,leakyRelu:HH,prelu:$R,relu:rt,relu6:zR,selu:GH,logicalAnd:Rh,logicalNot:qV,logicalOr:_R,logicalXor:XV,where:xa,whereAsync:SR,buffer:Ce,print:$W,batchToSpaceND:UI,broadcastTo:zW,cast:VW,clone:HW,cumsum:GW,depthToSpace:KW,expandDims:Wn,eye:WI,multinomial:qW,oneHot:Kv,pad:Ta,pad1d:XW,pad2d:YW,pad3d:QW,pad4d:JW,rand:ZW,randomNormal:e$,randomGamma:t$,randomUniform:$I,reshape:fr,spaceToBatchND:zI,squeeze:VI,stack:Mn,tile:bs,truncatedNormal:n$,unstack:bt,setdiff1dAsync:r$,fill:Hr,linspace:TW,ones:du,range:Ef,scalar:re,tensor:Bt,tensor1d:ht,tensor2d:bi,tensor3d:qy,tensor4d:fn,tensor5d:kW,tensor6d:IW,variable:RW,zeros:Ye,onesLike:jI,zerosLike:Fe,transpose:Ri,softmax:No,logSoftmax:l$,localResponseNormalization:KH,norm:VR,gather:s0,unsortedSegmentSum:NR,basicLSTMCell:qH,multiRNNCell:XH,movingAverage:YH,stridedSlice:QH,topk:JH,scatterND:ZH,fft:l0,ifft:Pf,rfft:d0,irfft:HR,sparseToDense:t7,gatherND:n7,diag:r7,dropout:o7,hannWindow:f0,hammingWindow:KR,frame:h0,stft:qR,inTopKAsync:a7});function Y(t,e){Array.isArray(t)||(t=[t]),t.forEach(function(n){n!=null&&N(n.dtype!=="complex64",function(){return e+" does not support complex64 tensors."})})}function om(t,e,n,r){if(n==="linear")return t.linear(e);if(n==="relu")return t.relu(e);if(n==="elu")return t.elu(e);if(n==="relu6")return t.relu6(e);if(n==="prelu")return t.prelu(e,r);throw new Error("Activation "+n+" has not been implemented for the CPU backend.")}var P7=function(t){function e(){var n=t.call(this)||this;return n.blockSize=48,n.firstUse=!0,n.data=new QI(n,L),n}return wr(e,t),e.prototype.write=function(n,r,o){this.firstUse&&(this.firstUse=!1,G().get("IS_NODE")&&wf(`
============================
Hi there . Looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, which binds to TensorFlow C++, by running npm i @tensorflow/tfjs-node, or npm i @tensorflow/tfjs-node-gpu if you have CUDA. Then call require('@tensorflow/tfjs-node'); (-gpu suffix for CUDA) at the start of your program. Visit https://github.com/tensorflow/tfjs-node for more details.
============================`));var i={};return this.data.set(i,{values:n,dtype:o}),i},e.prototype.move=function(n,r,o,i){this.data.set(n,{values:r,dtype:i})},e.prototype.numDataIds=function(){return this.data.numDataIds()},e.prototype.read=function(n){return ce(this,void 0,void 0,function(){return le(this,function(r){return[2,this.readSync(n)]})})},e.prototype.readSync=function(n){var r=this.data.get(n),o=r.dtype,i=r.complexTensors;return o==="complex64"?Yv(this.readSync(i.real.dataId),this.readSync(i.imag.dataId)):this.data.get(n).values},e.prototype.bufferSync=function(n){var r=this.readSync(n.dataId),o=r;if(n.dtype==="string")try{o=r.map(function(i){return gf(i)})}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return Ce(n.shape,n.dtype,o)},e.prototype.makeOutput=function(n,r,o){var i=this.write(n,r,o);return L.makeTensorFromDataId(i,r,o,this)},e.prototype.disposeData=function(n){if(this.data.has(n)){var r=this.data.get(n).complexTensors;r!=null&&(r.real.dispose(),r.imag.dispose()),this.data.delete(n)}},e.prototype.time=function(n){return ce(this,void 0,void 0,function(){var r;return le(this,function(o){return r=Ar(),n(),[2,{kernelMs:Ar()-r}]})})},e.prototype.memory=function(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}},e.prototype.complex=function(n,r){var o=this.makeOutput(null,n.shape,"complex64");return this.data.get(o.dataId).complexTensors={real:L.keep(n.clone()),imag:L.keep(r.clone())},o},e.prototype.real=function(n){return this.data.get(n.dataId).complexTensors.real.clone()},e.prototype.imag=function(n){return this.data.get(n.dataId).complexTensors.imag.clone()},e.prototype.slice=function(n,r,o){if(Y(n,"slice"),XI(n.shape,r,o)){var i=YI(r,n.strides),a=de(o);return Bt(this.readSync(n.dataId).subarray(i,i+a),o,n.dtype)}for(var s=Ce(o,n.dtype),u=this.bufferSync(n),c=0;c<s.size;++c){var l=s.indexToLoc(c).map(function(d,f){return d+r[f]});s.values[c]=u.get.apply(u,l)}return s.toTensor()},e.prototype.stridedSlice=function(n,r,o,i){Y(n,"stridedSlice");var a=Qy(r,o,i);if(a.some(function(h){return h===0}))return Bt([],a);for(var s=Ce(a,n.dtype),u=this.bufferSync(n),c=0;c<s.size;c++){for(var l=s.indexToLoc(c),d=new Array(l.length),f=0;f<d.length;f++)d[f]=l[f]*i[f]+r[f];s.set.apply(s,[u.get.apply(u,d)].concat(l))}return s.toTensor()},e.prototype.diag=function(n){for(var r=this.readSync(n.dataId),o=Ce([n.size,n.size],n.dtype),i=o.values,a=0;a<r.length;a++)i[a*n.size+a]=r[a];return o.toTensor()},e.prototype.unstack=function(n,r){for(var o=n.shape[r],i=new Array(n.rank-1),a=0,s=0;s<n.rank;s++)s!==r&&(i[a++]=n.shape[s]);var u=new Array(n.rank).fill(0),c=n.shape.slice();c[r]=1;var l=new Array(o);for(s=0;s<l.length;s++)u[r]=s,l[s]=this.slice(n,u,c).reshape(i);return l},e.prototype.reverse=function(n,r){Y(n,"reverse");for(var o=Ce(n.shape,n.dtype),i=this.bufferSync(n),a=function(u){var c=o.indexToLoc(u),l=c.slice();r.forEach(function(d){return l[d]=n.shape[d]-1-l[d]}),o.set.apply(o,[i.get.apply(i,l)].concat(c))},s=0;s<o.size;s++)a(s);return o.toTensor()},e.prototype.concat=function(n,r){var o=this;if(n[0].dtype==="complex64"){var i=n.map(function(h){return $n(h)}),a=n.map(function(h){return Or(h)});return Ft(this.concat(i,r),this.concat(a,r))}var s=n.map(function(h){var m=de(h.shape.slice(r));return h.as2D(-1,m)}),u=Js(s.map(function(h){return h.shape}),1),c=Ce(u,n[0].dtype).values;if(s[0].shape[0]===1){var l=0;s.forEach(function(h){c.set(o.readSync(h.dataId),l),l+=h.size})}else{var d=0;s.forEach(function(h){for(var m=o.readSync(h.dataId),p=0,g=0;g<h.shape[0];++g)for(var v=g*u[1]+d,y=0;y<h.shape[1];++y)c[v+y]=m[p++];d+=h.shape[1]})}var f=Js(n.map(function(h){return h.shape}),r);return Bt(c,f,n[0].dtype)},e.prototype.neg=function(n){return Y(n,"neg"),this.multiply(re(-1),n)},e.prototype.add=function(n,r){return n.dtype==="complex64"||r.dtype==="complex64"?this.broadcastedBinaryComplexOp(n.cast("complex64"),r.cast("complex64"),function(o,i,a,s){return{real:o+a,imag:i+s}}):this.broadcastedBinaryOp(n,r,Lt(n.dtype,r.dtype),function(o,i){return o+i})},e.prototype.addN=function(n){var r=this;Y(n,"addN");for(var o=n.map(function(l){return r.readSync(l.dataId)}),i=Ce(n[0].shape,n[0].dtype),a=i.values,s=0;s<n.length;s++)for(var u=o[s],c=0;c<a.length;c++)a[c]+=u[c];return i.toTensor()},e.prototype.softmax=function(n,r){var o=_t([r],n.shape),i=this.max(n,o),a=bn(i.shape,o),s=this.subtract(n,i.reshape(a)),u=this.exp(s),c=this.sum(u,o).reshape(a);return this.realDivide(u,c)},e.prototype.subtract=function(n,r){return n.dtype==="complex64"||r.dtype==="complex64"?this.broadcastedBinaryComplexOp(n.cast("complex64"),r.cast("complex64"),function(o,i,a,s){return{real:o-a,imag:i-s}}):this.broadcastedBinaryOp(n,r,Lt(n.dtype,r.dtype),function(o,i){return o-i})},e.prototype.pow=function(n,r){return Y([n,r],"pow"),this.broadcastedBinaryOp(n,r,n.dtype,function(o,i){return Math.pow(o,i)})},e.prototype.batchMatMul=function(n,r,o,i){Y([n,r],"matMul");for(var a=o?n.shape[1]:n.shape[2],s=o?n.shape[2]:n.shape[1],u=i?r.shape[1]:r.shape[2],c=n.shape[0],l=this.readSync(n.dataId),d=this.readSync(r.dataId),f=o?[n.strides[0],1,n.strides[1]]:[n.strides[0],n.strides[1],1],h=f[0],m=f[1],p=f[2],g=i?[1,r.strides[1],r.strides[0]]:[r.strides[1],1,r.strides[0]],v=g[0],y=g[1],x=g[2],b=s*u,E=Ce([c,s,u],n.dtype),_=E.values,S=this.blockSize,k=0;k<c;k++)for(var R=0;R<s;R+=S)for(var I=0;I<u;I+=S)for(var D=0;D<a;D+=S)for(var A=Math.min(R+S,s),W=Math.min(I+S,u),F=Math.min(D+S,a),$=R;$<A;$++)for(var j=I;j<W;j++){for(var U=0,M=D;M<F;M++)U+=l[k*h+$*m+M*p]*d[M*v+j*y+k*x];_[k*b+($*u+j)]+=U}return E.toTensor()},e.prototype.fusedBatchMatMul=function(n){var r=n.a,o=n.b,i=n.transposeA,a=n.transposeB,s=n.bias,u=n.activation,c=n.preluActivationWeights,l=this.batchMatMul(r,o,i,a);return s&&(l=this.add(l,s)),u&&(l=om(this,l,u,c)),l},e.prototype.multiply=function(n,r){return n.dtype==="complex64"||r.dtype==="complex64"?this.broadcastedBinaryComplexOp(n.cast("complex64"),r.cast("complex64"),function(o,i,a,s){return{real:o*a-i*s,imag:o*s+i*a}}):this.broadcastedBinaryOp(n,r,Lt(n.dtype,r.dtype),function(o,i){return o*i})},e.prototype.realDivide=function(n,r){return Y([n,r],"realDivide"),this.broadcastedBinaryOp(n,r,"float32",function(o,i){return o/i})},e.prototype.floorDiv=function(n,r){return Y([n,r],"floorDiv"),this.broadcastedBinaryOp(n,r,"int32",function(o,i){return Math.floor(o/i)})},e.prototype.sum=function(n,r){Y(n,"sum"),_n("sum",r,n.rank);for(var o=Ht(n.shape,r),i=o[0],a=o[1],s=Ye(i,Lt(n.dtype,"int32")),u=de(a),c=this.readSync(s.dataId),l=this.readSync(n.dataId),d=0;d<c.length;++d){for(var f=d*u,h=0,m=0;m<u;++m)h+=l[f+m];c[d]=h}return s},e.prototype.prod=function(n,r){Y(n,"sum");for(var o=Ht(n.shape,r),i=o[0],a=o[1],s=Ye(i,Lt(n.dtype,"int32")),u=de(a),c=this.readSync(s.dataId),l=this.readSync(n.dataId),d=0;d<c.length;++d){for(var f=d*u,h=1,m=0;m<u;++m)h*=l[f+m];c[d]=h}return s},e.prototype.unsortedSegmentSum=function(n,r,o){Y(n,"unsortedSegmentSum");for(var i=[],a=n.rank-r.rank,s=0;s<a;++s)r=r.expandDims(s+1);for(s=0;s<o;++s){var u=re(s,"int32"),c=RR(u,r).asType("float32").mul(n).sum(0);i.push(c)}return Mn(i)},e.prototype.argMin=function(n,r){Y(n,"argMin");var o=[r];_n("argMin",o,n.rank);for(var i=Ht(n.shape,o),a=i[0],s=i[1],u=Ye(a,"int32"),c=de(s),l=this.readSync(u.dataId),d=this.readSync(n.dataId),f=0;f<l.length;++f){for(var h=f*c,m=d[h],p=0,g=0;g<c;++g){var v=d[h+g];v<m&&(m=v,p=g)}l[f]=p}return u},e.prototype.argMax=function(n,r){Y(n,"argMax");var o=[r];_n("argMax",o,n.rank);for(var i=Ht(n.shape,o),a=i[0],s=i[1],u=Ye(a,"int32"),c=de(s),l=this.readSync(u.dataId),d=this.readSync(n.dataId),f=0;f<l.length;++f){for(var h=f*c,m=d[h],p=0,g=0;g<c;++g){var v=d[h+g];v>m&&(m=v,p=g)}l[f]=p}return u},e.prototype.cumsum=function(n,r,o,i){if(Y(n,"cumsum"),r!==n.rank-1)throw new Error("backend.cumsum in CPU expects an inner-most axis="+(n.rank-1)+" but got axis="+r);for(var a=Lt(n.dtype,"int32"),s=Ye(n.shape,a),u=this.readSync(s.dataId),c=this.readSync(n.dataId),l=n.shape[n.rank-1],d=i?function(g,v){return g+l-v-1}:function(g,v){return g+v},f=0;f<c.length;f+=l)for(var h=0;h<l;h++){var m=d(f,h);if(h===0)u[m]=o?0:c[m];else{var p=d(f,h-1);u[m]=o?c[p]+u[p]:c[m]+u[p]}}return s},e.prototype.equal=function(n,r){return Y([n,r],"equal"),this.broadcastedBinaryOp(n,r,"bool",function(o,i){return o===i?1:0})},e.prototype.notEqual=function(n,r){return Y([n,r],"notEqual"),this.broadcastedBinaryOp(n,r,"bool",function(o,i){return o!==i?1:0})},e.prototype.less=function(n,r){return Y([n,r],"less"),this.broadcastedBinaryOp(n,r,"bool",function(o,i){return o<i?1:0})},e.prototype.lessEqual=function(n,r){return Y([n,r],"lessEqual"),this.broadcastedBinaryOp(n,r,"bool",function(o,i){return o<=i?1:0})},e.prototype.greater=function(n,r){return Y([n,r],"greater"),this.broadcastedBinaryOp(n,r,"bool",function(o,i){return o>i?1:0})},e.prototype.greaterEqual=function(n,r){return Y([n,r],"greaterEqual"),this.broadcastedBinaryOp(n,r,"bool",function(o,i){return o>=i?1:0})},e.prototype.logicalNot=function(n){Y(n,"logicalNot");for(var r=this.readSync(n.dataId),o=new Uint8Array(r.length),i=0;i<r.length;++i)o[i]=r[i]?0:1;return this.makeOutput(o,n.shape,"bool")},e.prototype.logicalAnd=function(n,r){return Y([n,r],"logicalAnd"),this.broadcastedBinaryOp(n,r,"bool",function(o,i){return o&&i})},e.prototype.logicalOr=function(n,r){return Y([n,r],"logicalOr"),this.broadcastedBinaryOp(n,r,"bool",function(o,i){return o||i})},e.prototype.select=function(n,r,o){Y([n,r,o],"select");for(var i=this.readSync(n.dataId),a=this.readSync(r.dataId),s=this.readSync(o.dataId),u=Ye(r.shape,Lt(r.dtype,o.dtype)),c=this.readSync(u.dataId),l=0,d=n.rank===0||n.rank>1||r.rank===1?1:de(r.shape.slice(1)),f=0;f<i.length;f++)for(var h=0;h<d;h++)i[f]===1?c[l++]=a[f]:c[l++]=s[f];return u},e.prototype.where=function(n){Y([n],"where");var r=this.readSync(n.dataId);return t0(n.shape,r)},e.prototype.topk=function(n,r,o){return Y(n,"topk"),iR(this.readSync(n.dataId),n.shape,n.dtype,r)},e.prototype.min=function(n,r){Y(n,"min"),_n("min",r,n.rank);for(var o=Ht(n.shape,r),i=o[0],a=o[1],s=Ye(i,n.dtype),u=de(a),c=this.readSync(s.dataId),l=this.readSync(n.dataId),d=0;d<c.length;++d){for(var f=d*u,h=l[f],m=0;m<u;++m){var p=l[f+m];p<h&&(h=p)}c[d]=h}return s},e.prototype.minimum=function(n,r){return Y([n,r],"minimum"),this.broadcastedBinaryOp(n,r,n.dtype,function(o,i){return Math.min(o,i)})},e.prototype.mod=function(n,r){return Y([n,r],"mod"),this.broadcastedBinaryOp(n,r,n.dtype,function(o,i){var a=o%i;return o<0&&i<0||o>=0&&i>=0?a:(a+i)%i})},e.prototype.max=function(n,r){Y(n,"max"),_n("max",r,n.rank);for(var o=Ht(n.shape,r),i=o[0],a=o[1],s=Ye(i,n.dtype),u=de(a),c=this.readSync(s.dataId),l=this.readSync(n.dataId),d=0;d<c.length;++d){for(var f=d*u,h=l[f],m=0;m<u;++m){var p=l[f+m];p>h&&(h=p)}c[d]=h}return s},e.prototype.maximum=function(n,r){return Y([n,r],"maximum"),this.broadcastedBinaryOp(n,r,n.dtype,function(o,i){return Math.max(o,i)})},e.prototype.all=function(n,r){Y(n,"all"),_n("all",r,n.rank);for(var o=Ht(n.shape,r),i=o[0],a=o[1],s=Ye(i,n.dtype),u=de(a),c=this.readSync(s.dataId),l=this.readSync(n.dataId),d=0;d<c.length;++d){for(var f=d*u,h=l[f],m=0;m<u;++m){var p=l[f+m];h=h&&p}c[d]=h}return s},e.prototype.any=function(n,r){Y(n,"any"),_n("any",r,n.rank);for(var o=Ht(n.shape,r),i=o[0],a=o[1],s=Ye(i,n.dtype),u=de(a),c=this.readSync(s.dataId),l=this.readSync(n.dataId),d=0;d<c.length;++d){for(var f=d*u,h=l[f],m=0;m<u;++m){var p=l[f+m];h=h||p}c[d]=h}return s},e.prototype.squaredDifference=function(n,r){return Y([n,r],"squaredDifference"),this.broadcastedBinaryOp(n,r,n.dtype,function(o,i){var a=o-i;return a*a})},e.prototype.ceil=function(n){Y(n,"ceil");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i)o[i]=Math.ceil(r[i]);return this.makeOutput(o,n.shape,"float32")},e.prototype.floor=function(n){Y(n,"floor");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i)o[i]=Math.floor(r[i]);return this.makeOutput(o,n.shape,"float32")},e.prototype.sign=function(n){Y(n,"x");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i)r[i]<0?o[i]=-1:r[i]>0?o[i]=1:o[i]=0;return this.makeOutput(o,n.shape,"float32")},e.prototype.isNaN=function(n){Y(n,"x");for(var r=this.readSync(n.dataId),o=new Uint8Array(r.length),i=0;i<r.length;++i)Number.isNaN(r[i])&&(o[i]=1);return this.makeOutput(o,n.shape,"bool")},e.prototype.isInf=function(n){Y(n,"x");for(var r=this.readSync(n.dataId),o=new Uint8Array(r.length),i=0;i<r.length;++i)Math.abs(r[i])===1/0&&(o[i]=1);return this.makeOutput(o,n.shape,"bool")},e.prototype.isFinite=function(n){Y(n,"x");for(var r=this.readSync(n.dataId),o=new Uint8Array(r.length),i=0;i<r.length;++i)Number.isFinite(r[i])&&(o[i]=1);return this.makeOutput(o,n.shape,"bool")},e.prototype.round=function(n){Y(n,"round");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i){var a=Math.floor(r[i]);r[i]-a<.5?o[i]=Math.floor(r[i]):r[i]-a>.5?o[i]=Math.ceil(r[i]):o[i]=a%2==0?a:a+1}return this.makeOutput(o,n.shape,"float32")},e.prototype.exp=function(n){Y(n,"exp");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i)o[i]=Math.exp(r[i]);return this.makeOutput(o,n.shape,"float32")},e.prototype.expm1=function(n){Y(n,"expm1");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i)o[i]=Math.expm1(r[i]);return this.makeOutput(o,n.shape,"float32")},e.prototype.log=function(n){Y(n,"log");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i){var a=r[i];o[i]=Math.log(a)}return this.makeOutput(o,n.shape,"float32")},e.prototype.log1p=function(n){Y(n,"log1p");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i){var a=r[i];o[i]=Math.log1p(a)}return this.makeOutput(o,n.shape,"float32")},e.prototype.sqrt=function(n){Y(n,"sqrt");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i){var a=r[i];o[i]=Math.sqrt(a)}return this.makeOutput(o,n.shape,"float32")},e.prototype.rsqrt=function(n){Y(n,"rsqrt");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i){var a=r[i];o[i]=1/Math.sqrt(a)}return this.makeOutput(o,n.shape,"float32")},e.prototype.reciprocal=function(n){Y(n,"reciprocal");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i)o[i]=1/r[i];return this.makeOutput(o,n.shape,"float32")},e.prototype.linear=function(n){return n},e.prototype.relu=function(n){Y(n,"relu");for(var r=Ye(n.shape,n.dtype),o=this.readSync(r.dataId),i=this.readSync(n.dataId),a=0;a<i.length;++a)o[a]=Math.max(0,i[a]);return r},e.prototype.relu6=function(n){Y(n,"relu");for(var r=Ye(n.shape,n.dtype),o=this.readSync(r.dataId),i=this.readSync(n.dataId),a=0;a<i.length;++a)o[a]=Math.min(Math.max(0,i[a]),6);return r},e.prototype.prelu=function(n,r){return Y([n,r],"prelu"),this.broadcastedBinaryOp(n,r,n.dtype,function(o,i){return o<0?i*o:o})},e.prototype.elu=function(n){Y(n,"elu");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i){var a=o[i];r[i]=a>=0?a:Math.exp(a)-1}return this.makeOutput(r,n.shape,"float32")},e.prototype.eluDer=function(n,r){Y([n,r],"eluDer");for(var o=new Float32Array(r.size),i=this.readSync(r.dataId),a=this.readSync(n.dataId),s=0;s<i.length;++s){var u=i[s];o[s]=u>=1?a[s]:a[s]*(u+1)}return this.makeOutput(o,r.shape,"float32")},e.prototype.selu=function(n){Y(n,"selu");for(var r=r0,o=o0,i=new Float32Array(n.size),a=this.readSync(n.dataId),s=0;s<a.length;++s){var u=a[s];i[s]=u>=0?o*u:r*(Math.exp(u)-1)}return this.makeOutput(i,n.shape,"float32")},e.prototype.clip=function(n,r,o){Y(n,"clip");for(var i=new Float32Array(n.size),a=this.readSync(n.dataId),s=0;s<a.length;++s){var u=a[s];i[s]=u>o?o:u<r?r:u}return this.makeOutput(i,n.shape,"float32")},e.prototype.abs=function(n){for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.abs(o[i]);return this.makeOutput(r,n.shape,"float32")},e.prototype.complexAbs=function(n){for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<n.size;++i){var a=o[2*i],s=o[2*i+1];r[i]=Math.hypot(a,s)}return this.makeOutput(r,n.shape,"float32")},e.prototype.int=function(n){Y(n,"int");for(var r=new Int32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=o[i];return this.makeOutput(r,n.shape,"int32")},e.prototype.sigmoid=function(n){Y(n,"sigmoid");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=1/(1+Math.exp(-o[i]));return this.makeOutput(r,n.shape,"float32")},e.prototype.softplus=function(n){Y(n,"softplus");for(var r=Math.log(11920928955078125e-23)+2,o=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a){var s=i[a]>-r,u=i[a]<r,c=Math.exp(i[a]),l=void 0;l=u?c:s?i[a]:Math.log(1+c),o[a]=l}return this.makeOutput(o,n.shape,"float32")},e.prototype.sin=function(n){Y(n,"sin");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.sin(o[i]);return this.makeOutput(r,n.shape,"float32")},e.prototype.cos=function(n){Y(n,"cos");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.cos(o[i]);return this.makeOutput(r,n.shape,"float32")},e.prototype.tan=function(n){Y(n,"tan");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.tan(o[i]);return this.makeOutput(r,n.shape,"float32")},e.prototype.asin=function(n){Y(n,"asin");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.asin(o[i]);return this.makeOutput(r,n.shape,"float32")},e.prototype.acos=function(n){Y(n,"acos");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.acos(o[i]);return this.makeOutput(r,n.shape,"float32")},e.prototype.atan=function(n){Y(n,"atan");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.atan(o[i]);return this.makeOutput(r,n.shape,"float32")},e.prototype.atan2=function(n,r){return Y([n,r],"atan2"),this.broadcastedBinaryOp(n,r,n.dtype,function(o,i){return Math.atan2(o,i)})},e.prototype.sinh=function(n){Y(n,"sinh");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.sinh(o[i]);return this.makeOutput(r,n.shape,"float32")},e.prototype.cosh=function(n){Y(n,"cosh");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.cosh(o[i]);return this.makeOutput(r,n.shape,"float32")},e.prototype.tanh=function(n){Y(n,"tanh");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=DU(o[i]);return this.makeOutput(r,n.shape,"float32")},e.prototype.asinh=function(n){Y(n,"asinh");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.asinh(o[i]);return this.makeOutput(r,n.shape,"float32")},e.prototype.acosh=function(n){Y(n,"acosh");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.acosh(o[i]);return this.makeOutput(r,n.shape,"float32")},e.prototype.atanh=function(n){Y(n,"atanh");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.atanh(o[i]);return this.makeOutput(r,n.shape,"float32")},e.prototype.erf=function(n){Y(n,"erf");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i){var a=Math.sign(o[i]),s=Math.abs(o[i]),u=1/(1+.3275911*s);r[i]=a*(1-((((1.061405429*u-1.453152027)*u+1.421413741)*u-.284496736)*u+.254829592)*u*Math.exp(-s*s))}return this.makeOutput(r,n.shape,"float32")},e.prototype.step=function(n,r){r===void 0&&(r=0),Y(n,"step");for(var o=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a){var s=i[a];isNaN(s)?o[a]=NaN:o[a]=s>0?1:r}return this.makeOutput(o,n.shape,"float32")},e.prototype.fusedConv2d=function(n){var r=n.input,o=n.filter,i=n.convInfo,a=n.bias,s=n.activation,u=n.preluActivationWeights,c=this.conv2d(r,o,i);return a&&(c=this.add(c,a)),s&&(c=om(this,c,s,u)),c},e.prototype.conv2d=function(n,r,o){Y([n,r],"conv2d");for(var i=o.filterHeight,a=o.filterWidth,s=o.dilationHeight,u=o.dilationWidth,c=o.padInfo.left,l=o.padInfo.top,d=o.dataFormat==="channelsLast",f=Ce(o.outShape,n.dtype),h=n.strides[0],m=d?n.strides[1]:n.strides[2],p=d?n.strides[2]:1,g=d?1:n.strides[1],v=f.strides[0],y=d?f.strides[1]:f.strides[2],x=d?f.strides[2]:1,b=d?1:f.strides[1],E=this.readSync(n.dataId),_=this.readSync(r.dataId),S=f.values,k=0;k<o.batchSize;++k)for(var R=k*h,I=k*v,D=0;D<o.outHeight;++D)for(var A=I+D*y,W=D*o.strideHeight-l,F=0;F<i;F++){var $=W+F*s;if(!($<0||$>=o.inHeight))for(var j=F*r.strides[0],U=R+$*m,M=0;M<o.outWidth;++M)for(var P=A+M*x,B=M*o.strideWidth-c,V=0;V<a;V++){var K=B+V*u;if(!(K<0||K>=o.inWidth))for(var Q=U+K*p,te=j+V*r.strides[1],ae=0;ae<o.inChannels;++ae){for(var X=E[Q+ae*g],J=0;J<o.outChannels;++J)S[P+J*b]+=X*_[te+J];te+=o.outChannels}}}return f.toTensor()},e.prototype.conv3d=function(n,r,o){for(var i=o.filterDepth,a=o.filterHeight,s=o.filterWidth,u=o.dilationDepth,c=o.dilationHeight,l=o.dilationWidth,d=o.padInfo.front,f=o.padInfo.left,h=o.padInfo.top,m=Ce(o.outShape,n.dtype),p=this.readSync(n.dataId),g=this.readSync(r.dataId),v=m.values,y=0;y<o.batchSize;++y)for(var x=y*n.strides[0],b=y*m.strides[0],E=0;E<o.outDepth;++E)for(var _=b+E*m.strides[1],S=E*o.strideDepth-d,k=0;k<i;k++){var R=S+k*u;if(!(R<0||R>=o.inDepth))for(var I=k*r.strides[0],D=x+R*n.strides[1],A=0;A<o.outHeight;++A)for(var W=_+A*m.strides[2],F=A*o.strideHeight-h,$=0;$<a;$++){var j=F+$*c;if(!(j<0||j>=o.inHeight))for(var U=I+$*r.strides[1],M=D+j*n.strides[2],P=0;P<o.outWidth;++P)for(var B=W+P*o.outChannels,V=P*o.strideWidth-f,K=0;K<s;K++){var Q=V+K*l;if(!(Q<0||Q>=o.inWidth))for(var te=U+K*r.strides[2],ae=M+Q*o.inChannels,X=te,J=0;J<o.inChannels;++J){for(var ie=p[ae+J],oe=0;oe<o.outChannels;++oe)v[B+oe]+=ie*g[X+oe];X+=o.outChannels}}}}return m.toTensor()},e.prototype.conv2dDerInput=function(n,r,o){Y([n,r],"conv2dDerInput");for(var i=Ce(o.inShape,"float32"),a=i.values,s=this.readSync(n.dataId),u=this.readSync(r.dataId),c=r.strides,l=c[0],d=c[1],f=c[2],h=o.batchSize,m=o.filterHeight,p=o.filterWidth,g=o.inChannels,v=o.inHeight,y=o.inWidth,x=o.outChannels,b=o.outHeight,E=o.outWidth,_=o.strideHeight,S=o.strideWidth,k=o.dataFormat,R=m-1-o.padInfo.top,I=p-1-o.padInfo.left,D=k==="channelsLast",A=i.strides[0],W=D?i.strides[1]:i.strides[2],F=D?i.strides[2]:1,$=D?1:i.strides[1],j=n.strides[0],U=D?n.strides[1]:n.strides[2],M=D?n.strides[2]:1,P=D?1:n.strides[1],B=0;B<h;++B)for(var V=0;V<g;++V)for(var K=0;K<v;++K)for(var Q=K-R,te=Math.max(0,Math.ceil(Q/_)),ae=Math.min(b,(m+Q)/_),X=0;X<y;++X){for(var J=X-I,ie=Math.max(0,Math.ceil(J/S)),oe=Math.min(E,(p+J)/S),me=0,ee=te;ee<ae;++ee)for(var ye=ee*_-Q,ge=ie;ge<oe;++ge)for(var Ne=j*B+U*ee+M*ge,Me=l*(m-1-ye)+d*(p-1-(ge*S-J))+f*V,Oe=0;Oe<x;++Oe)me+=s[Ne+P*Oe]*u[Me+Oe];a[A*B+W*K+F*X+$*V]=me}return i.toTensor()},e.prototype.conv3dDerInput=function(n,r,o){for(var i=Ce(o.inShape,"float32"),a=i.values,s=i.strides,u=s[0],c=s[1],l=s[2],d=s[3],f=this.readSync(n.dataId),h=n.strides,m=h[0],p=h[1],g=h[2],v=h[3],y=this.readSync(r.dataId),x=r.strides,b=x[0],E=x[1],_=x[2],S=x[3],k=o.batchSize,R=o.filterDepth,I=o.filterHeight,D=o.filterWidth,A=o.inChannels,W=o.inDepth,F=o.inHeight,$=o.inWidth,j=o.outChannels,U=o.outDepth,M=o.outHeight,P=o.outWidth,B=o.strideDepth,V=o.strideHeight,K=o.strideWidth,Q=R-1-o.padInfo.front,te=I-1-o.padInfo.top,ae=D-1-o.padInfo.left,X=0;X<k;++X)for(var J=0;J<A;++J)for(var ie=0;ie<W;++ie)for(var oe=ie-Q,me=Math.max(0,Math.ceil(oe/B)),ee=Math.min(U,(R+oe)/B),ye=0;ye<F;++ye)for(var ge=ye-te,Ne=Math.max(0,Math.ceil(ge/V)),Me=Math.min(M,(I+ge)/V),Oe=0;Oe<$;++Oe){for(var Mt=Oe-ae,mt=Math.max(0,Math.ceil(Mt/K)),et=Math.min(P,(D+Mt)/K),Qn=0,vt=me;vt<ee;++vt)for(var Zt=vt*B-oe,St=Ne;St<Me;++St)for(var Er=St*V-ge,cn=mt;cn<et;++cn)for(var We=m*X+p*vt+g*St+v*cn,kt=b*(R-1-Zt)+E*(I-1-Er)+_*(D-1-(cn*K-Mt))+S*J,It=0;It<j;++It)Qn+=f[We+It]*y[kt+It];a[u*X+c*ie+l*ye+d*Oe+J]=Qn}return i.toTensor()},e.prototype.conv2dDerFilter=function(n,r,o){Y([n,r],"conv2dDerFilter");for(var i=o.strideHeight,a=o.strideWidth,s=o.filterHeight,u=o.filterWidth,c=o.dataFormat==="channelsLast",l=Ce(o.filterShape,"float32"),d=o.padInfo.left,f=o.padInfo.top,h=this.bufferSync(n),m=this.bufferSync(r),p=0;p<s;++p)for(var g=Math.max(0,Math.ceil((f-p)/i)),v=Math.min(o.outHeight,(o.inHeight+f-p)/i),y=0;y<u;++y)for(var x=Math.max(0,Math.ceil((d-y)/a)),b=Math.min(o.outWidth,(o.inWidth+d-y)/a),E=0;E<o.inChannels;++E)for(var _=0;_<o.outChannels;++_){for(var S=0,k=0;k<o.batchSize;++k)for(var R=g;R<v;++R)for(var I=p+R*i-f,D=x;D<b;++D){var A=y+D*a-d;S+=c?h.get(k,I,A,E)*m.get(k,R,D,_):h.get(k,E,I,A)*m.get(k,_,R,D)}l.set(S,p,y,E,_)}return l.toTensor()},e.prototype.conv3dDerFilter=function(n,r,o){for(var i=o.strideDepth,a=o.strideHeight,s=o.strideWidth,u=o.filterDepth,c=o.filterHeight,l=o.filterWidth,d=Ce(o.filterShape,"float32"),f=d.values,h=d.strides,m=h[0],p=h[1],g=h[2],v=h[3],y=this.readSync(r.dataId),x=r.strides,b=x[0],E=x[1],_=x[2],S=x[3],k=this.readSync(n.dataId),R=n.strides,I=R[0],D=R[1],A=R[2],W=R[3],F=o.padInfo.front,$=o.padInfo.left,j=o.padInfo.top,U=0;U<u;++U)for(var M=Math.max(0,Math.ceil((F-U)/i)),P=Math.min(o.outDepth,(o.inDepth+F-U)/i),B=U*m,V=0;V<c;++V)for(var K=Math.max(0,Math.ceil((j-V)/a)),Q=Math.min(o.outHeight,(o.inHeight+j-V)/a),te=V*p+B,ae=0;ae<l;++ae)for(var X=Math.max(0,Math.ceil(($-ae)/s)),J=Math.min(o.outWidth,(o.inWidth+$-ae)/s),ie=ae*g+te,oe=0;oe<o.inChannels;++oe)for(var me=oe*v+ie,ee=0;ee<o.outChannels;++ee){for(var ye=0,ge=0;ge<o.batchSize;++ge)for(var Ne=ge*I,Me=ge*b,Oe=M;Oe<P;++Oe)for(var Mt=(U+Oe*i-F)*D+Ne,mt=Oe*E+Me,et=K;et<Q;++et)for(var Qn=(V+et*a-j)*A+Mt,vt=et*_+mt,Zt=X;Zt<J;++Zt){var St=Zt*S+vt;ye+=k[(ae+Zt*s-$)*W+Qn+oe]*y[St+ee]}f[me+ee]=ye}return d.toTensor()},e.prototype.fusedDepthwiseConv2D=function(n){var r=n.input,o=n.filter,i=n.convInfo,a=n.bias,s=n.activation,u=n.preluActivationWeights,c=this.depthwiseConv2D(r,o,i);return a&&(c=this.add(c,a)),s&&(c=om(this,c,s,u)),c},e.prototype.depthwiseConv2D=function(n,r,o){Y([n,r],"depthwiseConv2D");for(var i=o.filterHeight,a=o.filterWidth,s=o.dilationHeight,u=o.dilationWidth,c=o.padInfo.left,l=o.padInfo.top,d=o.outChannels/o.inChannels,f=Ce(o.outShape,n.dtype),h=this.readSync(n.dataId),m=this.readSync(r.dataId),p=f.values,g=0;g<o.batchSize;++g)for(var v=g*n.strides[0],y=g*f.strides[0],x=0;x<o.outHeight;++x)for(var b=y+x*f.strides[1],E=x*o.strideHeight-c,_=0;_<i;++_){var S=E+_*s;if(!(S<0||S>=o.inHeight))for(var k=_*r.strides[0],R=v+S*n.strides[1],I=0;I<o.outWidth;++I)for(var D=b+I*f.strides[2],A=I*o.strideWidth-l,W=0;W<a;++W){var F=A+W*u;if(!(F<0||F>=o.inWidth))for(var $=k+W*r.strides[1],j=R+F*o.inChannels,U=D,M=$,P=0;P<o.inChannels;++P){for(var B=h[j+P],V=0;V<d;++V)p[U+V]+=B*m[M+V];U+=d,M+=d}}}return f.toTensor()},e.prototype.depthwiseConv2DDerInput=function(n,r,o){Y([n,r],"depthwiseConv2DDerInput");for(var i=Ce(o.inShape,"float32"),a=i.values,s=i.strides,u=s[0],c=s[1],l=s[2],d=this.readSync(n.dataId),f=n.strides,h=f[0],m=f[1],p=f[2],g=this.readSync(r.dataId),v=r.strides,y=v[0],x=v[1],b=v[2],E=o.batchSize,_=o.filterHeight,S=o.filterWidth,k=o.inChannels,R=o.inHeight,I=o.inWidth,D=o.outChannels,A=o.outHeight,W=o.outWidth,F=o.strideHeight,$=o.strideWidth,j=_-1-o.padInfo.top,U=S-1-o.padInfo.left,M=D/k,P=0;P<E;++P)for(var B=0;B<k;++B)for(var V=0;V<R;++V)for(var K=V-j,Q=Math.max(0,Math.ceil(K/F)),te=Math.min(A,(_+K)/F),ae=0;ae<I;++ae){for(var X=ae-U,J=Math.max(0,Math.ceil(X/$)),ie=Math.min(W,(S+X)/$),oe=0,me=Q;me<te;++me)for(var ee=me*F-K,ye=J;ye<ie;++ye)for(var ge=h*P+m*me+p*ye,Ne=y*(_-1-ee)+x*(S-1-(ye*$-X))+b*B,Me=0;Me<M;++Me)oe+=d[ge+(B*M+Me)]*g[Ne+Me];a[u*P+c*V+l*ae+B]=oe}return i.toTensor()},e.prototype.depthwiseConv2DDerFilter=function(n,r,o){Y([n,r],"depthwiseConv2DDerFilter");for(var i=o.strideHeight,a=o.strideWidth,s=o.filterHeight,u=o.filterWidth,c=Ce(o.filterShape,"float32"),l=o.padInfo.left,d=o.padInfo.top,f=o.outChannels/o.inChannels,h=this.bufferSync(n),m=this.bufferSync(r),p=0;p<s;++p)for(var g=Math.max(0,Math.ceil((d-p)/i)),v=Math.min(o.outHeight,(o.inHeight+d-p)/i),y=0;y<u;++y)for(var x=Math.max(0,Math.ceil((l-y)/a)),b=Math.min(o.outWidth,(o.inWidth+l-y)/a),E=0;E<o.outChannels;++E){for(var _=Math.trunc(E/f),S=E%f,k=0,R=0;R<o.batchSize;++R)for(var I=g;I<v;++I)for(var D=p+I*i-d,A=x;A<b;++A){var W=y+A*a-l;k+=h.get(R,D,W,_)*m.get(R,I,A,E)}c.set(k,p,y,_,S)}return c.toTensor()},e.prototype.tile=function(n,r){return Y(n,"tile"),oR(this.bufferSync(n),r)},e.prototype.pad=function(n,r,o){Y(n,"pad");var i=r.map(function(f,h){return f[0]+n.shape[h]+f[1]}),a=r.map(function(f){return f[0]}),s=this.bufferSync(n),u=Ce(i,n.dtype);o!==0&&u.values.fill(o);for(var c=0;c<n.size;c++){var l=s.indexToLoc(c),d=l.map(function(f,h){return f+a[h]});u.set.apply(u,[s.get.apply(s,l)].concat(d))}return u.toTensor()},e.prototype.transpose=function(n,r){Y(n,"transpose");for(var o=new Array(n.rank),i=0;i<o.length;i++)o[i]=n.shape[r[i]];var a=this.readSync(n.dataId),s=Ce(o,n.dtype),u=this.bufferSync(n);for(i=0;i<n.size;++i){for(var c=u.indexToLoc(i),l=new Array(c.length),d=0;d<l.length;d++)l[d]=c[r[d]];var f=s.locToIndex(l);s.values[f]=a[i]}return s.toTensor()},e.prototype.gather=function(n,r,o){Y([n,r],"gather");var i=n.shape.slice(),a=this.readSync(r.dataId);i[o]=a.length;for(var s=Ce(i,n.dtype),u=this.bufferSync(n),c=0;c<s.size;++c){var l=s.indexToLoc(c),d=l.slice();d[o]=a[l[o]];var f=u.locToIndex(d);s.values[c]=u.values[f]}return s.toTensor()},e.prototype.batchToSpaceND=function(n,r,o){Y([n],"batchToSpaceND");var i=r.reduce(function(d,f){return d*f}),a=Cf(n.shape,r,i),s=_f(a.length,r.length),u=Sf(n.shape,r,i),c=HI(o,r.length),l=GI(u,o,r.length);return n.reshape(a).transpose(s).reshape(u).slice(c,l)},e.prototype.spaceToBatchND=function(n,r,o){Y([n],"spaceToBatchND");var i=r.reduce(function(f,h){return f*h}),a=[[0,0]];a.push.apply(a,o);for(var s=1+r.length;s<n.shape.length;++s)a.push([0,0]);var u=n.pad(a),c=Cf(u.shape,r,i,!1),l=_f(c.length,r.length,!1),d=Sf(u.shape,r,i,!1);return u.reshape(c).transpose(l).reshape(d)},e.prototype.pool=function(n,r,o){Y(n,"pool");for(var i=r.strideHeight,a=r.strideWidth,s=r.dilationHeight,u=r.dilationWidth,c=r.effectiveFilterHeight,l=r.effectiveFilterWidth,d=r.padInfo.top,f=r.padInfo.left,h=o==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,m=this.readSync(n.dataId),p=Ce(r.outShape,n.dtype),g=p.values,v=r.outShape[1]*r.outShape[2]*r.outShape[3],y=r.outShape[2]*r.outShape[3],x=r.outShape[3],b=0;b<r.batchSize;++b)for(var E=b*v,_=b*n.strides[0],S=0;S<r.inChannels;++S)for(var k=0;k<r.outHeight;++k)for(var R=k*i-d,I=Math.max(0,R),D=Math.min(r.inHeight,c+R),A=E+k*y,W=0;W<r.outWidth;++W){for(var F=W*a-f,$=Math.max(0,F),j=Math.min(r.inWidth,l+F),U=h,M=0,P=0,B=I;B<D;B+=s){for(var V=_+B*n.strides[1],K=$;K<j;K+=u){var Q=m[V+K*n.strides[2]+S];o==="max"&&Q>U?U=Q:o==="avg"&&(M+=Q,P++)}if(isNaN(U))break}g[A+W*x+S]=o==="avg"?M/P:U}return p.toTensor()},e.prototype.maxPool=function(n,r){return this.pool(n,r,"max")},e.prototype.maxPoolPositions=function(n,r){for(var o=Ce(r.outShape,"int32"),i=r.strideHeight,a=r.strideWidth,s=r.dilationHeight,u=r.dilationWidth,c=r.effectiveFilterHeight,l=r.effectiveFilterWidth,d=r.padInfo.top,f=r.padInfo.left,h=this.bufferSync(n),m=0;m<r.batchSize;++m)for(var p=0;p<r.inChannels;++p)for(var g=0;g<r.outHeight;++g){for(var v=g*i-d,y=v;y<0;)y+=s;for(var x=Math.min(r.inHeight,c+v),b=0;b<r.outWidth;++b){for(var E=b*a-f,_=E;_<0;)_+=u;for(var S=Math.min(r.inWidth,l+E),k=Number.NEGATIVE_INFINITY,R=-1,I=y;I<x;I+=s)for(var D=I-v,A=_;A<S;A+=u){var W=A-E,F=h.get(m,I,A,p);F>k&&(k=F,R=D*l+W)}o.set(R,m,g,b,p)}}return o.toTensor()},e.prototype.maxPoolBackprop=function(n,r,o,i){Y([r,o],"maxPoolBackprop");for(var a=this.maxPoolPositions(r,i),s=i.strideHeight,u=i.strideWidth,c=i.dilationHeight,l=i.dilationWidth,d=i.effectiveFilterHeight,f=i.effectiveFilterWidth,h=f-1-i.padInfo.left,m=d-1-i.padInfo.top,p=Ce(r.shape,"float32"),g=this.bufferSync(a),v=this.bufferSync(n),y=0;y<i.batchSize;++y)for(var x=0;x<i.inChannels;++x)for(var b=0;b<i.inHeight;++b)for(var E=0;E<i.inWidth;++E){for(var _=b-m,S=E-h,k=0,R=0;R<d;R+=c){var I=(_+R)/s;if(!(I<0||I>=i.outHeight||Math.floor(I)!==I))for(var D=0;D<f;D+=l){var A=(S+D)/u;if(!(A<0||A>=i.outWidth||Math.floor(A)!==A)){var W=d*f-1-g.get(y,I,A,x)===R*f+D?1:0;W!==0&&(k+=v.get(y,I,A,x)*W)}}}p.set(k,y,b,E,x)}return p.toTensor()},e.prototype.avgPoolBackprop=function(n,r,o){Y([n,r],"avgPoolBackprop");for(var i=o.strideHeight,a=o.strideWidth,s=o.filterHeight,u=o.filterWidth,c=o.dilationHeight,l=o.dilationWidth,d=o.effectiveFilterHeight,f=o.effectiveFilterWidth,h=f-1-o.padInfo.left,m=d-1-o.padInfo.top,p=Ce(r.shape,"float32"),g=1/(s*u),v=this.bufferSync(n),y=0;y<o.batchSize;++y)for(var x=0;x<o.inChannels;++x)for(var b=0;b<o.inHeight;++b)for(var E=0;E<o.inWidth;++E){for(var _=b-m,S=E-h,k=0,R=0;R<d;R+=c){var I=(_+R)/i;if(!(I<0||I>=o.outHeight||Math.floor(I)!==I))for(var D=0;D<f;D+=l){var A=(S+D)/a;A<0||A>=o.outWidth||Math.floor(A)!==A||(k+=v.get(y,I,A,x))}}p.set(k*g,y,b,E,x)}return p.toTensor()},e.prototype.pool3d=function(n,r,o){Y(n,"pool3d");for(var i=r.strideDepth,a=r.strideHeight,s=r.strideWidth,u=r.dilationDepth,c=r.dilationHeight,l=r.dilationWidth,d=r.effectiveFilterDepth,f=r.effectiveFilterHeight,h=r.effectiveFilterWidth,m=r.padInfo.front,p=r.padInfo.top,g=r.padInfo.left,v=o==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,y=this.readSync(n.dataId),x=Ce(r.outShape,n.dtype),b=x.values,E=r.outShape[1]*r.outShape[2]*r.outShape[3]*r.outShape[4],_=r.outShape[2]*r.outShape[3]*r.outShape[4],S=r.outShape[3]*r.outShape[4],k=r.outShape[4],R=0;R<r.batchSize;++R)for(var I=R*E,D=R*n.strides[0],A=0;A<r.inChannels;++A)for(var W=0;W<r.outDepth;++W){for(var F=W*i-m,$=F;$<0;)$+=u;for(var j=Math.min(r.inDepth,d+F),U=I+W*_,M=0;M<r.outHeight;++M){for(var P=M*a-p,B=P;B<0;)B+=c;for(var V=Math.min(r.inHeight,f+P),K=U+M*S,Q=0;Q<r.outWidth;++Q){for(var te=Q*s-g,ae=te;ae<0;)ae+=l;for(var X=Math.min(r.inWidth,h+te),J=K+Q*k,ie=v,oe=0,me=0,ee=$;ee<j;ee+=u){for(var ye=D+ee*n.strides[1],ge=B;ge<V;ge+=c){for(var Ne=ye+ge*n.strides[2],Me=ae;Me<X;Me+=l){var Oe=y[Ne+Me*n.strides[3]+A];if(o==="max"&&Oe>ie?ie=Oe:o==="avg"&&(oe+=Oe,me++),isNaN(ie))break}if(isNaN(ie))break}if(isNaN(ie))break}b[J+A]=o==="avg"?oe/me:ie}}}return x.toTensor()},e.prototype.avgPool3d=function(n,r){return Y(n,"avgPool3d"),this.pool3d(n,r,"avg").toFloat()},e.prototype.avgPool3dBackprop=function(n,r,o){Y([n,r],"avgPool3dBackprop");for(var i=o.strideDepth,a=o.strideHeight,s=o.strideWidth,u=o.filterDepth,c=o.filterHeight,l=o.filterWidth,d=o.dilationDepth,f=o.dilationHeight,h=o.dilationWidth,m=o.effectiveFilterDepth,p=o.effectiveFilterHeight,g=o.effectiveFilterWidth,v=m-1-o.padInfo.front,y=g-1-o.padInfo.left,x=p-1-o.padInfo.top,b=Ce(r.shape,"float32"),E=1/(u*c*l),_=this.bufferSync(n),S=0;S<o.batchSize;++S)for(var k=0;k<o.inChannels;++k)for(var R=0;R<o.inDepth;++R)for(var I=0;I<o.inHeight;++I)for(var D=0;D<o.inWidth;++D){for(var A=R-v,W=I-x,F=D-y,$=0,j=0;j<m;j+=d){var U=(A+j)/i;if(!(U<0||U>=o.outDepth||Math.floor(U)!==U))for(var M=0;M<p;M+=f){var P=(W+M)/a;if(!(P<0||P>=o.outHeight||Math.floor(P)!==P))for(var B=0;B<g;B+=h){var V=(F+B)/s;V<0||V>=o.outWidth||Math.floor(V)!==V||($+=_.get(S,U,P,V,k))}}}b.set($*E,S,R,I,D,k)}return b.toTensor()},e.prototype.maxPool3d=function(n,r){return Y(n,"maxPool3d"),this.pool3d(n,r,"max").toFloat()},e.prototype.maxPool3dPositions=function(n,r){for(var o=Ce(r.outShape,"int32"),i=r.strideDepth,a=r.strideHeight,s=r.strideWidth,u=r.dilationDepth,c=r.dilationHeight,l=r.dilationWidth,d=r.effectiveFilterDepth,f=r.effectiveFilterHeight,h=r.effectiveFilterWidth,m=r.padInfo.front,p=r.padInfo.top,g=r.padInfo.left,v=this.bufferSync(n),y=0;y<r.batchSize;++y)for(var x=0;x<r.inChannels;++x)for(var b=0;b<r.outDepth;++b){for(var E=b*i-m,_=E;_<0;)_+=u;for(var S=Math.min(r.inDepth,d+E),k=0;k<r.outHeight;++k){for(var R=k*a-p,I=R;I<0;)I+=c;for(var D=Math.min(r.inHeight,f+R),A=0;A<r.outWidth;++A){for(var W=A*s-g,F=W;F<0;)F+=l;for(var $=Math.min(r.inWidth,h+W),j=Number.NEGATIVE_INFINITY,U=-1,M=_;M<S;M+=u)for(var P=M-E,B=I;B<D;B+=c)for(var V=B-R,K=F;K<$;K+=l){var Q=K-W,te=v.get(y,M,B,K,x);te>=j&&(j=te,U=P*f*h+V*f+Q)}o.set(U,y,b,k,A,x)}}}return o.toTensor()},e.prototype.maxPool3dBackprop=function(n,r,o,i){Y([r,o],"maxPool3dBackprop");for(var a=this.maxPool3dPositions(r,i),s=i.strideDepth,u=i.strideHeight,c=i.strideWidth,l=i.dilationDepth,d=i.dilationHeight,f=i.dilationWidth,h=i.effectiveFilterDepth,m=i.effectiveFilterHeight,p=i.effectiveFilterWidth,g=h-1-i.padInfo.front,v=p-1-i.padInfo.left,y=m-1-i.padInfo.top,x=Ce(r.shape,"float32"),b=this.bufferSync(a),E=this.bufferSync(n),_=0;_<i.batchSize;++_)for(var S=0;S<i.inChannels;++S)for(var k=0;k<i.inDepth;++k)for(var R=0;R<i.inHeight;++R)for(var I=0;I<i.inWidth;++I){for(var D=k-g,A=R-y,W=I-v,F=0,$=0;$<h;$+=l){var j=(D+$)/s;if(!(j<0||j>=i.outDepth||Math.floor(j)!==j))for(var U=0;U<m;U+=d){var M=(A+U)/u;if(!(M<0||M>=i.outHeight||Math.floor(M)!==M))for(var P=0;P<p;P+=f){var B=(W+P)/c;if(!(B<0||B>=i.outWidth||Math.floor(B)!==B)){var V=h*m*p-1-b.get(_,j,M,B,S)===$*m*p+U*p+P?1:0;V!==0&&(F+=E.get(_,j,M,B,S)*V)}}}}x.set(F,_,k,R,I,S)}return x.toTensor()},e.prototype.cast=function(n,r){return eR(n,r,this)},e.prototype.reshape=function(n,r){return Xv(n,r)},e.prototype.avgPool=function(n,r){return Y(n,"avgPool"),this.pool(n,r,"avg").toFloat()},e.prototype.resizeBilinear=function(n,r,o,i){Y(n,"resizeBilinear");for(var a=n.shape,s=a[0],u=a[1],c=a[2],l=a[3],d=this.readSync(n.dataId),f=new Float32Array(de([s,r,o,l])),h=[i&&r>1?u-1:u,i&&o>1?c-1:c],m=[i&&r>1?r-1:r,i&&o>1?o-1:o],p=0,g=h[0]/m[0],v=h[1]/m[1],y=0;y<s;y++)for(var x=0;x<r;x++)for(var b=g*x,E=Math.floor(b),_=b-E,S=Math.min(u-1,Math.ceil(b)),k=y*n.strides[0]+E*n.strides[1],R=y*n.strides[0]+S*n.strides[1],I=0;I<o;I++)for(var D=v*I,A=Math.floor(D),W=D-A,F=Math.min(c-1,Math.ceil(D)),$=k+A*n.strides[2],j=R+A*n.strides[2],U=k+F*n.strides[2],M=R+F*n.strides[2],P=0;P<l;P++){var B=d[$+P],V=d[j+P],K=B+(d[U+P]-B)*W,Q=K+(V+(d[M+P]-V)*W-K)*_;f[p++]=Q}return Bt(f,[s,r,o,l])},e.prototype.resizeBilinearBackprop=function(n,r,o){Y([n,r],"resizeBilinearBackprop");for(var i=r.shape,a=i[0],s=i[1],u=i[2],c=i[3],l=n.shape,d=l[1],f=l[2],h=new Float32Array(a*s*u*c),m=[o&&d>1?s-1:s,o&&f>1?u-1:u],p=[o&&d>1?d-1:d,o&&f>1?f-1:f],g=m[0]/p[0],v=m[1]/p[1],y=this.readSync(n.dataId),x=0,b=0;b<a;b++)for(var E=b*r.strides[0],_=0;_<d;_++)for(var S=_*g,k=Math.floor(S),R=Math.min(Math.ceil(S),s-1),I=E+k*r.strides[1],D=E+R*r.strides[1],A=S-k,W=1-A,F=0;F<f;F++)for(var $=F*v,j=Math.floor($),U=Math.min(Math.ceil($),u-1),M=$-j,P=1-M,B=I+j*r.strides[2],V=I+U*r.strides[2],K=D+j*r.strides[2],Q=D+U*r.strides[2],te=W*P,ae=W*M,X=A*P,J=A*M,ie=0;ie<c;ie++){var oe=y[x++];h[B+ie]+=oe*te,h[V+ie]+=oe*ae,h[K+ie]+=oe*X,h[Q+ie]+=oe*J}return fn(h,[a,u,s,c],r.dtype)},e.prototype.resizeNearestNeighbor=function(n,r,o,i){Y(n,"resizeNearestNeighbor");for(var a=n.shape,s=a[0],u=a[1],c=a[2],l=a[3],d=this.readSync(n.dataId),f=new Float32Array(s*r*o*l),h=[i&&r>1?u-1:u,i&&o>1?c-1:c],m=[i&&r>1?r-1:r,i&&o>1?o-1:o],p=h[0]/m[0],g=h[1]/m[1],v=0,y=0;y<s;y++)for(var x=y*n.strides[0],b=0;b<r;b++)for(var E=p*b,_=x+Math.min(u-1,i?Math.round(E):Math.floor(E))*n.strides[1],S=0;S<o;S++)for(var k=g*S,R=_+Math.min(c-1,i?Math.round(k):Math.floor(k))*n.strides[2],I=0;I<l;I++){var D=d[R+I];f[v++]=D}return Bt(f,[s,r,o,l],n.dtype)},e.prototype.resizeNearestNeighborBackprop=function(n,r,o){Y([n,r],"resizeNearestNeighborBackprop");for(var i=r.shape,a=i[0],s=i[1],u=i[2],c=i[3],l=n.shape,d=l[1],f=l[2],h=new Float32Array(a*s*u*c),m=this.readSync(n.dataId),p=[o&&d>1?s-1:s,o&&f>1?u-1:u],g=[o&&d>1?d-1:d,o&&f>1?f-1:f],v=p[0]/g[0],y=p[1]/g[1],x=1/v,b=1/y,E=2*Math.ceil(x)+2,_=2*Math.ceil(b)+2,S=0;S<a;S++)for(var k=S*r.strides[0],R=0;R<s;R++)for(var I=k+R*r.strides[1],D=Math.floor(R*x),A=Math.floor(D-E/2),W=0;W<u;W++)for(var F=I+W*r.strides[2],$=Math.floor(W*b),j=Math.floor($-_/2),U=0;U<c;U++){for(var M=0,P=0;P<E;P++){var B=P+A;if(!(B<0||B>=d)){var V=k+B*n.strides[1],K=B*v;if(R===Math.min(s-1,o?Math.round(K):Math.floor(K)))for(var Q=0;Q<_;Q++){var te=Q+j;if(!(te<0||te>=f)){var ae=V+te*n.strides[2],X=te*y;W===Math.min(u-1,o?Math.round(X):Math.floor(X))&&(M+=m[ae+U])}}}}h[F+U]=M}return fn(h,r.shape,r.dtype)},e.prototype.batchNormalization=function(n,r,o,i,a,s){Y([n,r,o,a,s],"batchNorm");for(var u=this.readSync(n.dataId),c=this.readSync(r.dataId),l=this.readSync(o.dataId),d=a?this.readSync(a.dataId):new Float32Array([1]),f=s?this.readSync(s.dataId):new Float32Array([0]),h=new Float32Array(u.length),m=f.length,p=d.length,g=l.length,v=c.length,y=0,x=0,b=0,E=0,_=0;_<u.length;++_)h[_]=f[y++]+(u[_]-c[x++])*d[b++]/Math.sqrt(l[E++]+i),y>=m&&(y=0),x>=v&&(x=0),b>=p&&(b=0),E>=g&&(E=0);return fn(h,n.shape)},e.prototype.localResponseNormalization4D=function(n,r,o,i,a){Y(n,"localResponseNormalization4D");var s=n.shape[3],u=s-1,c=this.readSync(n.dataId),l=n.size,d=new Float32Array(l);function f(g){for(var v=g%s,y=g-v+Math.max(0,v-r),x=g-v+Math.min(v+r,u),b=0;y<=x;y++){var E=c[y];b+=E*E}return b}for(var h=0;h<l;h++){var m=f(h),p=c[h]*Math.pow(o+i*m,-a);d[h]=p}return fn(d,n.shape)},e.prototype.LRNGrad=function(n,r,o,i,a,s,u){Y(n,"LRNGrad");for(var c=n.shape[3],l=this.readSync(n.dataId),d=this.readSync(r.dataId),f=this.readSync(o.dataId),h=new Float32Array(n.size),m=n.size,p=0;p<m;p++){for(var g=p%c,v=p-g+Math.max(0,g-i),y=p-g+Math.min(c,g+i+1),x=0,b=v;b<y;b++)x+=Math.pow(d[b],2);for(x=s*x+a,b=v;b<y;b++){var E=-2*s*u*d[b]*f[p]/x;p===b&&(E+=Math.pow(x,-u)),E*=l[p],h[b]+=E}}return fn(h,n.shape)},e.prototype.multinomial=function(n,r,o,i){Y(n,"multinomial");for(var a=r?n:No(n),s=a.shape[0],u=a.shape[1],c=Ye([s,o],"int32"),l=this.readSync(c.dataId),d=this.readSync(a.dataId),f=0;f<s;++f){var h=f*u,m=new Float32Array(u-1);m[0]=d[h];for(var p=1;p<m.length;++p)m[p]=m[p-1]+d[h+p];for(var g=Sh(i.toString()),v=f*o,y=0;y<o;++y){var x=g();l[v+y]=m.length;for(var b=0;b<m.length;b++)if(x<m[b]){l[v+y]=b;break}}}return c},e.prototype.oneHot=function(n,r,o,i){Y(n,"oneHot");var a=new Float32Array(n.size*r);a.fill(i);for(var s=this.readSync(n.dataId),u=0;u<n.size;++u)s[u]>=0&&s[u]<r&&(a[u*r+s[u]]=o);return bi(a,[n.size,r],"int32")},e.prototype.nonMaxSuppression=function(n,r,o,i,a){return Y(n,"nonMaxSuppression"),Zy(this.readSync(n.dataId),this.readSync(r.dataId),o,i,a)},e.prototype.fft=function(n){return this.fftBatch(n,!1)},e.prototype.ifft=function(n){return this.fftBatch(n,!0)},e.prototype.fftBatch=function(n,r){for(var o=n.shape[0],i=n.shape[1],a=Ce(n.shape,"float32"),s=Ce(n.shape,"float32"),u=$n(n).as2D(o,i),c=Or(n).as2D(o,i),l=0;l<o;l++)for(var d=u.slice([l,0],[1,i]),f=c.slice([l,0],[1,i]),h=Ft(d,f),m=this.readSync(this.fftImpl(h,r).dataId),p=0;p<i;p++){var g=ib(m,p);a.values[l*i+p]=g.real,s.values[l*i+p]=g.imag}return Ft(a.toTensor(),s.toTensor()).as2D(o,i)},e.prototype.fftImpl=function(n,r){var o=n.as1D(),i=o.size;if(this.isExponentOf2(i)){var a=this.fftRadix2(o,i,r).as2D(n.shape[0],n.shape[1]);return r&&(a=Ft($n(a).div(re(i)),Or(a).div(re(i)))),a}var s=this.readSync(n.dataId),u=function(c){for(var l=new Float32Array(c.length/2),d=new Float32Array(c.length/2),f=0;f<c.length;f+=2)l[f/2]=c[f],d[f/2]=c[f+1];return{real:l,imag:d}}(this.fourierTransformByMatmul(s,i,r));return Ft(u.real,u.imag).as2D(n.shape[0],n.shape[1])},e.prototype.isExponentOf2=function(n){return(n&n-1)==0},e.prototype.fftRadix2=function(n,r,o){if(r===1)return n;var i=this.readSync(n.dataId),a=r/2,s=function(v){for(var y=Math.ceil(v.length/4),x=new Float32Array(y),b=new Float32Array(y),E=0;E<v.length;E+=4)x[Math.floor(E/4)]=v[E],b[Math.floor(E/4)]=v[E+1];return{real:x,imag:b}}(i),u=Ft(s.real,s.imag).as1D(),c=function(v){for(var y=Math.floor(v.length/4),x=new Float32Array(y),b=new Float32Array(y),E=2;E<v.length;E+=4)x[Math.floor(E/4)]=v[E],b[Math.floor(E/4)]=v[E+1];return{real:x,imag:b}}(i),l=Ft(c.real,c.imag).as1D();u=this.fftRadix2(u,a,o),l=this.fftRadix2(l,a,o);var d=function(v,y){for(var x=new Float32Array(v/2),b=new Float32Array(v/2),E=0;E<Math.ceil(v/2);E++){var _=(y?2:-2)*Math.PI*(E/v);x[E]=Math.cos(_),b[E]=Math.sin(_)}return{real:x,imag:b}}(r,o),f=Ft(d.real,d.imag).mul(l),h=u.add(f),m=u.sub(f),p=$n(h).concat($n(m)),g=Or(h).concat(Or(m));return Ft(p,g).as1D()},e.prototype.fourierTransformByMatmul=function(n,r,o){for(var i=new Float32Array(2*r),a=0;a<r;a++){for(var s=0,u=0,c=0;c<r;c++){var l=f$(a*c,r,o),d=ib(n,c);s+=d.real*l.real-d.imag*l.imag,u+=d.real*l.imag+d.imag*l.real}o&&(s/=r,u/=r),d$(i,s,u,a)}return i},e.prototype.depthToSpace=function(n,r,o){N(o==="NHWC",function(){return"Only NHWC dataFormat supported on CPU for depthToSpace. Got "+o}),N(r>1,function(){return"blockSize should be > 1 for depthToSpace, but was: "+r});for(var i=n.shape[0],a=n.shape[1],s=n.shape[2],u=n.shape[3],c=a*r,l=s*r,d=u/(r*r),f=this.readSync(n.dataId),h=new Float32Array(i*c*l*d),m=0,p=0;p<i;++p)for(var g=0;g<c;++g)for(var v=Math.floor(g/r),y=g%r,x=0;x<l;++x)for(var b=Math.floor(x/r),E=(y*r+x%r)*d,_=0;_<d;++_){var S=_+E+u*(b+s*(v+a*p));h[m++]=f[S]}return fn(h,[i,c,l,d])},e.prototype.broadcastedBinaryOp=function(n,r,o,i){var a=Pe(n.shape,r.shape),s=Ce(a,o),u=this.readSync(n.dataId),c=this.readSync(r.dataId),l=ui(n.shape,a),d=ui(r.shape,a),f=s.values;if(l.length+d.length===0)for(var h=0;h<f.length;++h)f[h]=i(u[h%u.length],c[h%c.length]);else{var m=this.bufferSync(n),p=this.bufferSync(r),g=function(v){var y=s.indexToLoc(v),x=y.slice(-n.rank);l.forEach(function(S){return x[S]=0});var b=m.locToIndex(x),E=y.slice(-r.rank);d.forEach(function(S){return E[S]=0});var _=p.locToIndex(E);f[v]=i(u[b],c[_])};for(h=0;h<f.length;++h)g(h)}return s.toTensor()},e.prototype.broadcastedBinaryComplexOp=function(n,r,o){var i=Pe(n.shape,r.shape),a=Ce(i,"float32"),s=Ce(i,"float32"),u=this.readSync(n.dataId),c=this.readSync(r.dataId),l=ui(n.shape,i),d=ui(r.shape,i),f=a.values,h=s.values;if(l.length+d.length===0)for(var m=0;m<f.length;m++){var p=m%u.length,g=m%c.length,v=o(u[2*p],u[2*p+1],c[2*g],c[2*g+1]);f[m]=v.real,h[m]=v.imag}else{var y=this.bufferSync(this.data.get(n.dataId).complexTensors.real),x=this.bufferSync(this.data.get(r.dataId).complexTensors.real),b=function(E){var _=a.indexToLoc(E),S=_.slice(-n.rank);l.forEach(function(A){return S[A]=0});var k=y.locToIndex(S),R=_.slice(-r.rank);d.forEach(function(A){return R[A]=0});var I=x.locToIndex(R),D=o(u[2*k],u[2*k+1],c[2*I],c[2*I+1]);f[E]=D.real,h[E]=D.imag};for(m=0;m<f.length;m++)b(m)}return this.complex(a.toTensor(),s.toTensor())},e.prototype.split=function(n,r,o){return rR(n,r,o)},e.prototype.dispose=function(){},e.prototype.floatPrecision=function(){return 32},e.prototype.epsilon=function(){return 1e-7},e.prototype.cropAndResize=function(n,r,o,i,a,s){for(var u=n.shape,c=u[0],l=u[1],d=u[2],f=u[3],h=r.shape[0],m=i[0],p=i[1],g=Ce([h,m,p,f],"float32"),v=this.readSync(r.dataId),y=this.readSync(o.dataId),x=this.readSync(n.dataId),b=n.strides,E=g.strides,_=0;_<h;_++){var S=4*_,k=v[S],R=v[S+1],I=v[S+2],D=v[S+3],A=y[_];if(!(A>=c))for(var W=m>1?(I-k)*(l-1)/(m-1):0,F=p>1?(D-R)*(d-1)/(p-1):0,$=0;$<m;$++){var j=m>1?k*(l-1)+$*W:.5*(k+I)*(l-1);if(j<0||j>l-1)for(var U=0;U<p;U++)for(var M=0;M<f;M++){var P=M+U*E[2]+$*E[1]+_*E[0];g.values[P]=s}else if(a==="bilinear"){var B=Math.floor(j),V=Math.ceil(j),K=j-B;for(U=0;U<p;U++)if((ee=p>1?R*(d-1)+U*F:.5*(R+D)*(d-1))<0||ee>d-1)for(M=0;M<f;M++)P=M+U*E[2]+$*E[1]+_*E[0],g.values[P]=s;else{var Q=Math.floor(ee),te=Math.ceil(ee),ae=ee-Q;for(M=0;M<f;M++){var X=x[P=M+Q*b[2]+B*b[1]+A*b[0]],J=x[P=M+te*b[2]+B*b[1]+A*b[0]],ie=x[P=M+Q*b[2]+V*b[1]+A*b[0]],oe=X+(J-X)*ae,me=ie+(x[P=M+te*b[2]+V*b[1]+A*b[0]]-ie)*ae;P=M+U*E[2]+$*E[1]+_*E[0],g.values[P]=oe+(me-oe)*K}}}else for(U=0;U<p;++U){var ee;if((ee=p>1?R*(d-1)+U*F:.5*(R+D)*(d-1))<0||ee>d-1)for(M=0;M<f;M++)P=M+U*E[2]+$*E[1]+_*E[0],g.values[P]=s;else{var ye=Math.round(ee),ge=Math.round(j);for(M=0;M<f;M++){var Ne=M+ye*b[2]+ge*b[1]+A*b[0],Me=M+U*E[2]+$*E[1]+_*E[0];g.values[Me]=x[Ne]}}}}}return g.toTensor()},e.prototype.sparseToDense=function(n,r,o,i){var a=kf(0,n,o),s=a.sliceRank,u=a.numUpdates,c=a.sliceSize,l=a.strides,d=a.outputSize;return this.scatter(n,r,o,d,c,u,s,l,i,!1)},e.prototype.gatherND=function(n,r){var o=r.shape,i=o[o.length-1],a=KI(n,r),s=a[0],u=a[1],c=a[2],l=a[3];if(u===0)return Bt([],s,n.dtype);for(var d=new Ic([u,c],n.dtype),f=this.readSync(r.dataId),h=this.readSync(n.dataId),m=0;m<u;m++){for(var p=[],g=0,v=0;v<i;v++){var y=f[m*i+v];g+=y*l[v],p.push(y)}if(g<0||g>=n.size/c)throw new Error("Invalid indices: "+p+" does not index into "+n.shape);for(var x=0;x<c;x++)d.values[m*c+x]=h[g*c+x]}return d.toTensor().reshape(s)},e.prototype.scatterND=function(n,r,o){var i=kf(0,n,o),a=i.sliceRank,s=i.numUpdates,u=i.sliceSize,c=i.strides,l=i.outputSize,d=re(0);return this.scatter(n,r,o,l,u,s,a,c,d,!0)},e.prototype.fill=function(n,r,o){var i=vf(o=o||nl(r),de(n));return i.fill(r),L.makeTensor(i,n,o,this)},e.prototype.onesLike=function(n){if(n.dtype==="string")throw new Error("onesLike is not supported for string tensors");return this.fill(n.shape,1,n.dtype)},e.prototype.zerosLike=function(n){var r=vf(n.dtype,de(n.shape));return this.makeOutput(r,n.shape,n.dtype)},e.prototype.linspace=function(n,r,o){return tR(n,r,o)},e.prototype.scatter=function(n,r,o,i,a,s,u,c,l,d){var f=[i/a,a],h=this.readSync(n.dataId),m=this.readSync(r.dataId);if(i===0)return Bt([],o,r.dtype);var p=new Ic(f,r.dtype);p.values.fill(this.readSync(l.dataId)[0]);for(var g=0;g<s;g++){for(var v=[],y=0,x=0;x<u;x++){var b=h[g*u+x];v.push(b),y+=b*c[x]}if(y<0||y>=i/a)throw new Error("Invalid indices: "+v+" does not index into "+o);for(var E=0;E<a;E++)d?p.values[y*a+E]+=m[g*a+E]:p.values[y*a+E]=r.rank===0?m[0]:m[g*a+E]}return p.toTensor().reshape(o)},e}(JI);L.registerBackend("cpu",function(){return new P7},1);for(var im=0,Ib=[{kernelName:"NonMaxSuppressionV5",backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,o=e,i=o.boxes,a=o.scores,s=r,u=s.maxOutputSize,c=s.iouThreshold,l=s.scoreThreshold,d=s.softNmsSigma,f=n;Y(i,"NonMaxSuppressionWithScore");var h=e0(f.data.get(i.dataId).values,f.data.get(a.dataId).values,u,c,l,d);return[h.selectedIndices,h.selectedScores]}},{kernelName:"Square",backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=e.x,o=n;Y(r,"square");for(var i=o.data.get(r.dataId).values,a=new Float32Array(i.length),s=0;s<i.length;++s){var u=i[s];a[s]=u*u}return{dataId:o.write(a,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},{kernelName:Nc,backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=e,o=r.a,i=r.b,a=n;Y([o,i],Nc);var s=a.data.get(o.dataId).values,u=a.data.get(i.dataId).values,c=function(f,h,m,p,g,v){var y=Pe(f,h),x=y.length,b=Vr(y),E=kc(g,de(y)),_=f.length,S=h.length,k=Vr(f),R=Vr(h),I=ui(f,y),D=ui(h,y);if(I.length+D.length===0)for(var A=0;A<E.length;++A)E[A]=v(m[A%m.length],p[A%p.length]);else{var W=function(F){var $=$U(F,x,b),j=$.slice(-_);I.forEach(function(B){return j[B]=0});var U=Yw(j,_,k),M=$.slice(-S);D.forEach(function(B){return M[B]=0});var P=Yw(M,S,R);E[F]=v(m[U],p[P])};for(A=0;A<E.length;++A)W(A)}return[E,y]}(o.shape,i.shape,s,u,o.dtype,function(f,h){var m=f-h;return m*m}),l=c[0],d=c[1];return{dataId:a.write(l,d,o.dtype),shape:d,dtype:o.dtype}}}];im<Ib.length;im++)kI(Ib[im]);var Wa,D7=function(t){this.variableNames=["A"];var e=qt(),n=t[0],r=t[1];this.outputShape=t,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+r+".0, "+n+`.0);

        vec4 values = `+e.texture2D+`(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `},M7=function(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var e=qt(),n=t[0],r=t[1];this.outputShape=t,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(`+r+".0, "+n+`.0);
            vec4 values = `+e.texture2D+`(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        `+e.output+` = result;
      }
    `};for(var am=0,Rb=[{kernelName:"FromPixels",backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,o=e.pixels,i=r.numChannels,a=typeof HTMLVideoElement<"u"&&o instanceof HTMLVideoElement,s=typeof HTMLImageElement<"u"&&o instanceof HTMLImageElement,u=a?[o.videoWidth,o.videoHeight]:[o.width,o.height],c=u[0],l=u[1],d=[l,c],f=[l,c,i];(s||a)&&(Wa==null&&(Wa=document.createElement("canvas").getContext("2d")),Wa.canvas.width=c,Wa.canvas.height=l,Wa.drawImage(o,0,0,c,l),o=Wa.canvas);var h=n.makeTensorInfo(d,"int32");n.texData.get(h.dataId).usage=Rn.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(h.dataId),o);var m=G().getBool("WEBGL_PACK")?new M7(f):new D7(f),p=n.runWebGLProgram(m,[h],"int32");return n.disposeData(h.dataId),p}},{kernelName:"NonMaxSuppressionV5",backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs;wf("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var o=e,i=o.boxes,a=o.scores,s=r,u=s.maxOutputSize,c=s.iouThreshold,l=s.scoreThreshold,d=s.softNmsSigma,f=n,h=e0(f.readSync(i.dataId),f.readSync(a.dataId),u,c,l,d);return[h.selectedIndices,h.selectedScores]}},{kernelName:"Square",backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=e.x,o=n,i=new Re(r.shape,"return x * x;");return o.runWebGLProgram(i,[r],r.dtype)}},{kernelName:Nc,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=e,o=r.a,i=r.b,a=n,s=G().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new oo("return (a - b) * (a - b);",o.shape,i.shape):new st("return (a - b) * (a - b);",o.shape,i.shape);return a.compileAndRun(s,[o,i])}}];am<Rb.length;am++)kI(Rb[am]);for(var sm=0,Tb=[{kernelName:"Square",gradFunc:function(t,e){var n=e[0];return{x:function(){return t.mul(n.toFloat().mul(2))}}}},{kernelName:Nc,gradFunc:function(t,e){var n=e[0],r=e[1],o=re(2);return{a:function(){return Yt(t,Yt(o,Ct(n,r)))},b:function(){return Yt(t,Yt(o,Ct(r,n)))}}}}];sm<Tb.length;sm++)AU(Tb[sm]);var O7=function(){function t(){}return t.prototype.fetch=function(e,n){return fetch(e,n)},t.prototype.now=function(){return performance.now()},t.prototype.encode=function(e,n){if(n!=="utf-8"&&n!=="utf8")throw new Error("Browser's encoder only supports utf-8, but got "+n);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)},t.prototype.decode=function(e,n){return new TextDecoder(n).decode(e)},t}();G().get("IS_BROWSER")&&G().setPlatform("browser",new O7);var um,F7=function(){return require("node-fetch")},L7=function(){function t(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}return t.prototype.fetch=function(e,n){return G().global.fetch!=null?G().global.fetch(e,n):(um==null&&(um=F7()),um(e,n))},t.prototype.now=function(){var e=process.hrtime();return 1e3*e[0]+e[1]/1e6},t.prototype.encode=function(e,n){if(n!=="utf-8"&&n!=="utf8")throw new Error("Node built-in encoder only supports utf-8, but got "+n);return this.textEncoder.encode(e)},t.prototype.decode=function(e,n){return e.length===0?"":new this.util.TextDecoder(n).decode(e)},t}();G().get("IS_NODE")&&G().setPlatform("node",new L7);var Jv={float32:4,int32:4,uint16:2,uint8:1,bool:1},Df=4;function XR(t,e){for(var n={},r=0,o=function(s){var u=s.name,c=s.dtype,l=s.shape,d=de(l),f=void 0;if("quantization"in s){var h=s.quantization;if(h.dtype!=="uint8"&&h.dtype!=="uint16")throw new Error("Weight "+s.name+" has unknown quantization dtype "+h.dtype+". Supported quantization dtypes are: 'uint8' and 'uint16'.");var m=Jv[h.dtype],p=t.slice(r,r+d*m),g=h.dtype==="uint8"?new Uint8Array(p):new Uint16Array(p);if(c==="float32")f=Float32Array.from(g,function(_){return _*h.scale+h.min});else{if(c!=="int32")throw new Error("Unsupported dtype in weight '"+u+"': "+c);f=Int32Array.from(g,function(_){return Math.round(_*h.scale+h.min)})}r+=d*m}else if(c==="string"){var v=de(s.shape);f=[];for(var y=0;y<v;y++){var x=new Uint32Array(t.slice(r,r+Df))[0];r+=Df;var b=new Uint8Array(t.slice(r,r+x));f.push(b),r+=x}}else{var E=Jv[c];if(p=t.slice(r,r+d*E),c==="float32")f=new Float32Array(p);else if(c==="int32")f=new Int32Array(p);else{if(c!=="bool")throw new Error("Unsupported dtype in weight '"+u+"': "+c);f=new Uint8Array(p)}r+=d*E}n[u]=Bt(f,l,c)},i=0,a=e;i<a.length;i++)o(a[i]);return n}function B7(t){if(t===null)throw new Error("Invalid input value: "+JSON.stringify(t));var e=0,n=[];t.forEach(function(i){if(e+=i.byteLength,n.push(i.byteLength===i.buffer.byteLength?i:new i.constructor(i)),!(i instanceof Float32Array||i instanceof Int32Array||i instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: "+i.constructor.name)});var r=new Uint8Array(e),o=0;return n.forEach(function(i){r.set(new Uint8Array(i.buffer),o),o+=i.byteLength}),r.buffer}var Zv=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function Nb(t){return Zv?Buffer.byteLength(t):new Blob([t]).size}function x0(t){var e=0;t.forEach(function(o){e+=o.byteLength});var n=new Uint8Array(e),r=0;return t.forEach(function(o){n.set(new Uint8Array(o),r),r+=o.byteLength}),n.buffer}function Ab(t){for(t=t.trim();t.endsWith("/");)t=t.slice(0,t.length-1);var e=t.split("/");return e[e.length-1]}function cl(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:t.modelTopology==null?0:Nb(JSON.stringify(t.modelTopology)),weightSpecsBytes:t.weightSpecs==null?0:Nb(JSON.stringify(t.weightSpecs)),weightDataBytes:t.weightData==null?0:t.weightData.byteLength}}var Tn=function(){function t(){this.saveRouters=[],this.loadRouters=[]}return t.getInstance=function(){return t.instance==null&&(t.instance=new t),t.instance},t.registerSaveRouter=function(e){t.getInstance().saveRouters.push(e)},t.registerLoadRouter=function(e){t.getInstance().loadRouters.push(e)},t.getSaveHandlers=function(e){return t.getHandlers(e,"save")},t.getLoadHandlers=function(e,n){return t.getHandlers(e,"load",n)},t.getHandlers=function(e,n,r){var o=[];return(n==="load"?t.getInstance().loadRouters:t.getInstance().saveRouters).forEach(function(i){var a=i(e,r);a!==null&&o.push(a)}),o},t}(),Cs="://",Ei=function(){function t(){this.managers={}}return t.getInstance=function(){return t.instance==null&&(t.instance=new t),t.instance},t.registerManager=function(e,n){N(e!=null,function(){return"scheme must not be undefined or null."}),e.endsWith(Cs)&&(e=e.slice(0,e.indexOf(Cs))),N(e.length>0,function(){return"scheme must not be an empty string."});var r=t.getInstance();N(r.managers[e]==null,function(){return"A model store manager is already registered for scheme '"+e+"'."}),r.managers[e]=n},t.getManager=function(e){var n=this.getInstance().managers[e];if(n==null)throw new Error("Cannot find model manager for scheme '"+e+"'");return n},t.getSchemes=function(){return Object.keys(this.getInstance().managers)},t}();function _d(t){if(t.indexOf(Cs)===-1)throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+Ei.getSchemes().join(","));return{scheme:t.split(Cs)[0],path:t.split(Cs)[1]}}function Pb(t,e,n){return n===void 0&&(n=!1),ce(this,void 0,void 0,function(){var r,o,i,a,s,u,c,l,d;return le(this,function(f){switch(f.label){case 0:return N(t!==e,function(){return"Old path and new path are the same: '"+t+"'"}),N((r=Tn.getLoadHandlers(t)).length>0,function(){return"Copying failed because no load handler is found for source URL "+t+"."}),N(r.length<2,function(){return"Copying failed because more than one ("+r.length+") load handlers for source URL "+t+"."}),o=r[0],N((i=Tn.getSaveHandlers(e)).length>0,function(){return"Copying failed because no save handler is found for destination URL "+e+"."}),N(i.length<2,function(){return"Copying failed because more than one ("+r.length+") save handlers for destination URL "+e+"."}),a=i[0],s=_d(t).scheme,u=_d(t).path,c=s===_d(t).scheme,[4,o.load()];case 1:return l=f.sent(),n&&c?[4,Ei.getManager(s).removeModel(u)]:[3,3];case 2:f.sent(),f.label=3;case 3:return[4,a.save(l)];case 4:return d=f.sent(),!n||c?[3,6]:[4,Ei.getManager(s).removeModel(u)];case 5:f.sent(),f.label=6;case 6:return[2,d.modelArtifactsInfo]}})})}var ea="models_store",ci="model_info_store";function YR(){if(!G().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");var t=window||self,e=t.indexedDB||t.mozIndexedDB||t.webkitIndexedDB||t.msIndexedDB||t.shimIndexedDB;if(e==null)throw new Error("The current browser does not appear to support IndexedDB.");return e}function eg(t){var e=t.result;e.createObjectStore(ea,{keyPath:"modelPath"}),e.createObjectStore(ci,{keyPath:"modelPath"})}var _s=function(){function t(e){if(this.indexedDB=YR(),e==null||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}return t.prototype.save=function(e){return ce(this,void 0,void 0,function(){return le(this,function(n){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return[2,this.databaseAction(this.modelPath,e)]})})},t.prototype.load=function(){return ce(this,void 0,void 0,function(){return le(this,function(e){return[2,this.databaseAction(this.modelPath)]})})},t.prototype.databaseAction=function(e,n){var r=this;return new Promise(function(o,i){var a=r.indexedDB.open("tensorflowjs",1);a.onupgradeneeded=function(){return eg(a)},a.onsuccess=function(){var s=a.result;if(n==null){var u=s.transaction(ea,"readonly"),c=u.objectStore(ea).get(r.modelPath);c.onsuccess=function(){if(c.result==null)return s.close(),i(new Error("Cannot find model with path '"+r.modelPath+"' in IndexedDB."));o(c.result.modelArtifacts)},c.onerror=function(p){return s.close(),i(c.error)},u.oncomplete=function(){return s.close()}}else{var l,d=cl(n),f=s.transaction(ci,"readwrite"),h=f.objectStore(ci),m=h.put({modelPath:r.modelPath,modelArtifactsInfo:d});m.onsuccess=function(){var p=(l=s.transaction(ea,"readwrite")).objectStore(ea).put({modelPath:r.modelPath,modelArtifacts:n,modelArtifactsInfo:d});p.onsuccess=function(){return o({modelArtifactsInfo:d})},p.onerror=function(g){var v=(h=f.objectStore(ci)).delete(r.modelPath);v.onsuccess=function(){return s.close(),i(p.error)},v.onerror=function(y){return s.close(),i(p.error)}}},m.onerror=function(p){return s.close(),i(m.error)},f.oncomplete=function(){l==null?s.close():l.oncomplete=function(){return s.close()}}}},a.onerror=function(s){return i(a.error)}})},t.URL_SCHEME="indexeddb://",t}(),Db=function(t){return G().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(_s.URL_SCHEME)?(e=t.slice(_s.URL_SCHEME.length),new _s(e)):null;var e};Tn.registerSaveRouter(Db),Tn.registerLoadRouter(Db);var j7=function(){function t(){this.indexedDB=YR()}return t.prototype.listModels=function(){return ce(this,void 0,void 0,function(){var e=this;return le(this,function(n){return[2,new Promise(function(r,o){var i=e.indexedDB.open("tensorflowjs",1);i.onupgradeneeded=function(){return eg(i)},i.onsuccess=function(){var a=i.result,s=a.transaction(ci,"readonly"),u=s.objectStore(ci).getAll();u.onsuccess=function(){for(var c={},l=0,d=u.result;l<d.length;l++){var f=d[l];c[f.modelPath]=f.modelArtifactsInfo}r(c)},u.onerror=function(c){return a.close(),o(u.error)},s.oncomplete=function(){return a.close()}},i.onerror=function(a){return o(i.error)}})]})})},t.prototype.removeModel=function(e){return ce(this,void 0,void 0,function(){var n=this;return le(this,function(r){var o;return e=(o=e).startsWith(_s.URL_SCHEME)?o.slice(_s.URL_SCHEME.length):o,[2,new Promise(function(i,a){var s=n.indexedDB.open("tensorflowjs",1);s.onupgradeneeded=function(){return eg(s)},s.onsuccess=function(){var u,c=s.result,l=c.transaction(ci,"readwrite"),d=l.objectStore(ci),f=d.get(e);f.onsuccess=function(){if(f.result==null)return c.close(),a(new Error("Cannot find model with path '"+e+"' in IndexedDB."));var h=d.delete(e),m=function(){var p=(u=c.transaction(ea,"readwrite")).objectStore(ea).delete(e);p.onsuccess=function(){return i(f.result.modelArtifactsInfo)},p.onerror=function(g){return a(f.error)}};h.onsuccess=m,h.onerror=function(p){return m(),c.close(),a(f.error)}},f.onerror=function(h){return c.close(),a(f.error)},l.oncomplete=function(){u==null?c.close():u.oncomplete=function(){return c.close()}}},s.onerror=function(u){return a(s.error)}})]})})},t}();if(G().getBool("IS_BROWSER"))try{Ei.registerManager(_s.URL_SCHEME,new j7)}catch{}var co="/",Ka="tensorflowjs_models",QR="info",U7="model_topology",W7="weight_specs",$7="weight_data",z7="model_metadata";function JR(t){return{info:[Ka,t,QR].join(co),topology:[Ka,t,U7].join(co),weightSpecs:[Ka,t,W7].join(co),weightData:[Ka,t,$7].join(co),modelMetadata:[Ka,t,z7].join(co)}}function V7(t){var e=t.split(co);if(e.length<3)throw new Error("Invalid key format: "+t);return e.slice(1,e.length-1).join(co)}var Ss=function(){function t(e){if(!G().getBool("IS_BROWSER")||typeof window>"u"||window.localStorage===void 0)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,e==null||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=JR(this.modelPath)}return t.prototype.save=function(e){return ce(this,void 0,void 0,function(){var n,r,o;return le(this,function(i){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");n=JSON.stringify(e.modelTopology),r=JSON.stringify(e.weightSpecs),o=cl(e);try{return this.LS.setItem(this.keys.info,JSON.stringify(o)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,function(a){if(Zv)return Buffer.from(a).toString("base64");for(var s=new Uint8Array(a),u="",c=0,l=s.length;c<l;c++)u+=String.fromCharCode(s[c]);return btoa(u)}(e.weightData)),this.LS.setItem(this.keys.modelMetadata,JSON.stringify({format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,userDefinedMetadata:e.userDefinedMetadata})),[2,{modelArtifactsInfo:o}]}catch{throw this.LS.removeItem(this.keys.info),this.LS.removeItem(this.keys.topology),this.LS.removeItem(this.keys.weightSpecs),this.LS.removeItem(this.keys.weightData),this.LS.removeItem(this.keys.modelMetadata),new Error("Failed to save model '"+this.modelPath+"' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes="+o.modelTopologyBytes+", weightSpecsBytes="+o.weightSpecsBytes+", weightDataBytes="+o.weightDataBytes+".")}return[2]})})},t.prototype.load=function(){return ce(this,void 0,void 0,function(){var e,n,r,o,i,a,s;return le(this,function(u){if((e=JSON.parse(this.LS.getItem(this.keys.info)))==null)throw new Error("In local storage, there is no model with name '"+this.modelPath+"'");if(e.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");if(n={},(r=JSON.parse(this.LS.getItem(this.keys.topology)))==null)throw new Error("In local storage, the topology of model '"+this.modelPath+"' is missing.");if(n.modelTopology=r,(o=JSON.parse(this.LS.getItem(this.keys.weightSpecs)))==null)throw new Error("In local storage, the weight specs of model '"+this.modelPath+"' are missing.");if(n.weightSpecs=o,(i=this.LS.getItem(this.keys.modelMetadata))!=null&&(a=JSON.parse(i),n.format=a.format,n.generatedBy=a.generatedBy,n.convertedBy=a.convertedBy,n.userDefinedMetadata=a.userDefinedMetadata),(s=this.LS.getItem(this.keys.weightData))==null)throw new Error("In local storage, the binary weight values of model '"+this.modelPath+"' are missing.");return n.weightData=function(c){if(Zv){var l=Buffer.from(c,"base64");return l.buffer.slice(l.byteOffset,l.byteOffset+l.byteLength)}for(var d=atob(c),f=new Uint8Array(d.length),h=0;h<d.length;++h)f.set([d.charCodeAt(h)],h);return f.buffer}(s),[2,n]})})},t.URL_SCHEME="localstorage://",t}(),Mb=function(t){return G().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(Ss.URL_SCHEME)?(e=t.slice(Ss.URL_SCHEME.length),new Ss(e)):null;var e};Tn.registerSaveRouter(Mb),Tn.registerLoadRouter(Mb);var H7=function(){function t(){N(G().getBool("IS_BROWSER"),function(){return"Current environment is not a web browser"}),N(typeof window>"u"||window.localStorage!==void 0,function(){return"Current browser does not appear to support localStorage"}),this.LS=window.localStorage}return t.prototype.listModels=function(){return ce(this,void 0,void 0,function(){var e,n,r,o,i,a;return le(this,function(s){for(e={},n=Ka+co,r=co+QR,o=0;o<this.LS.length;++o)(i=this.LS.key(o)).startsWith(n)&&i.endsWith(r)&&(a=V7(i),e[a]=JSON.parse(this.LS.getItem(i)));return[2,e]})})},t.prototype.removeModel=function(e){return ce(this,void 0,void 0,function(){var n,r;return le(this,function(o){var i;if(e=(i=e).startsWith(Ss.URL_SCHEME)?i.slice(Ss.URL_SCHEME.length):i,n=JR(e),this.LS.getItem(n.info)==null)throw new Error("Cannot find model at path '"+e+"'");return r=JSON.parse(this.LS.getItem(n.info)),this.LS.removeItem(n.info),this.LS.removeItem(n.topology),this.LS.removeItem(n.weightSpecs),this.LS.removeItem(n.weightData),[2,r]})})},t}();if(G().getBool("IS_BROWSER"))try{Ei.registerManager(Ss.URL_SCHEME,new H7)}catch{}var G7="model",K7=".json",q7=".weights.bin";function Ob(t){return new Promise(function(e){return setTimeout(e)}).then(t)}var cm=function(){function t(e){if(!G().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");e.startsWith(t.URL_SCHEME)&&(e=e.slice(t.URL_SCHEME.length)),e!=null&&e.length!==0||(e=G7),this.modelTopologyFileName=e+K7,this.weightDataFileName=e+q7}return t.prototype.save=function(e){return ce(this,void 0,void 0,function(){var n,r,o,i,a,s;return le(this,function(u){switch(u.label){case 0:if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");if(n=window.URL.createObjectURL(new Blob([e.weightData],{type:"application/octet-stream"})),!(e.modelTopology instanceof ArrayBuffer))return[3,1];throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");case 1:return r=[{paths:["./"+this.weightDataFileName],weights:e.weightSpecs}],o={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,weightsManifest:r},i=window.URL.createObjectURL(new Blob([JSON.stringify(o)],{type:"application/json"})),(a=this.jsonAnchor==null?document.createElement("a"):this.jsonAnchor).download=this.modelTopologyFileName,a.href=i,[4,Ob(function(){return a.dispatchEvent(new MouseEvent("click"))})];case 2:return u.sent(),e.weightData==null?[3,4]:((s=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor).download=this.weightDataFileName,s.href=n,[4,Ob(function(){return s.dispatchEvent(new MouseEvent("click"))})]);case 3:u.sent(),u.label=4;case 4:return[2,{modelArtifactsInfo:cl(e)}]}})})},t.URL_SCHEME="downloads://",t}(),X7=function(){function t(e){if(e==null||e.length<1)throw new Error("When calling browserFiles, at least 1 file is required, but received "+e);this.files=e}return t.prototype.load=function(){return ce(this,void 0,void 0,function(){var e,n,r=this;return le(this,function(o){return e=this.files[0],n=this.files.slice(1),[2,new Promise(function(i,a){var s=new FileReader;s.onload=function(u){var c=JSON.parse(u.target.result),l=c.modelTopology;if(l!=null){n.length===0&&i({modelTopology:l});var d=c.weightsManifest;if(d!=null){var f;try{f=r.checkManifestAndWeightFiles(d,n)}catch(g){return void a(g)}var h=[],m=[],p=[];d.forEach(function(g){g.paths.forEach(function(v){m.push(v),p.push(null)}),h.push.apply(h,g.weights)}),d.forEach(function(g){g.paths.forEach(function(v){var y=new FileReader;y.onload=function(x){var b=x.target.result,E=m.indexOf(v);p[E]=b,p.indexOf(null)===-1&&i({modelTopology:l,weightSpecs:h,weightData:x0(p),format:c.format,generatedBy:c.generatedBy,convertedBy:c.convertedBy,userDefinedMetadata:c.userDefinedMetadata})},y.onerror=function(x){return a("Failed to weights data from file of path '"+v+"'.")},y.readAsArrayBuffer(f[v])})})}else a(new Error("weightManifest field is missing from file "+e.name))}else a(new Error("modelTopology field is missing from file "+e.name))},s.onerror=function(u){return a("Failed to read model topology and weights manifest JSON from file '"+e.name+"'. BrowserFiles supports loading Keras-style tf.Model artifacts only.")},s.readAsText(e)})]})})},t.prototype.checkManifestAndWeightFiles=function(e,n){for(var r=[],o=n.map(function(u){return Ab(u.name)}),i={},a=0,s=e;a<s.length;a++)s[a].paths.forEach(function(u){var c=Ab(u);if(r.indexOf(c)!==-1)throw new Error("Duplicate file basename found in weights manifest: '"+c+"'");if(r.push(c),o.indexOf(c)===-1)throw new Error("Weight file with basename '"+c+"' is not provided.");i[u]=n[o.indexOf(c)]});if(r.length!==n.length)throw new Error("Mismatch in the number of files in weights manifest ("+r.length+") and the number of weight files provided ("+n.length+").");return i},t}();function Fb(t,e,n,r){(function(i){N(i!=null&&Array.isArray(i)&&i.length>0,function(){return"promises must be a none empty array"})})(t),function(i,a){N(i>=0&&i<=1,function(){return"Progress fraction must be in range [0, 1], but got startFraction "+i}),N(a>=0&&a<=1,function(){return"Progress fraction must be in range [0, 1], but got endFraction "+a}),N(a>=i,function(){return"startFraction must be no more than endFraction, but got startFraction "+i+" and endFraction "+a})}(n=n??0,r=r??1);var o=0;return Promise.all(t.map(function(i){return i.then(function(a){var s=n+ ++o/t.length*(r-n);return e(s),a}),i}))}function ZR(t,e){return ce(this,void 0,void 0,function(){var n,r,o,i,a,s,u,c,l;return le(this,function(d){switch(d.label){case 0:return e==null&&(e={}),n=e.fetchFunc==null?G().platform.fetch:e.fetchFunc,r=t.map(function(f){return n(f,e.requestInit,{isBinary:!0})}),o=0,i=.5,e.onProgress!=null?[3,2]:[4,Promise.all(r)];case 1:return a=d.sent(),[3,4];case 2:return[4,Fb(r,e.onProgress,o,i)];case 3:a=d.sent(),d.label=4;case 4:return s=a.map(function(f){return f.arrayBuffer()}),u=.5,c=1,e.onProgress!=null?[3,6]:[4,Promise.all(s)];case 5:return l=d.sent(),[3,8];case 6:return[4,Fb(s,e.onProgress,u,c)];case 7:l=d.sent(),d.label=8;case 8:return[2,l]}})})}function Lb(t){var e=this;return function(n,r,o){return r===void 0&&(r=""),ce(e,void 0,void 0,function(){var i,a,s,u,c,l,d,f,h,m;return le(this,function(p){switch(p.label){case 0:if(i=n.map(function(){return!1}),a={},s=o!=null?o.map(function(){return!1}):[],u=[],n.forEach(function(g,v){var y=0;g.weights.forEach(function(x){var b="quantization"in x?x.quantization.dtype:x.dtype,E=Jv[b]*de(x.shape),_=function(){i[v]=!0,a[v]==null&&(a[v]=[]),a[v].push({manifestEntry:x,groupOffset:y,sizeBytes:E})};o!=null?o.forEach(function(S,k){S===x.name&&(_(),s[k]=!0)}):_(),u.push(x.name),y+=E})}),!s.every(function(g){return g}))throw c=o.filter(function(g,v){return!s[v]}),new Error("Could not find weights in manifest with names: "+c.join(", ")+`. 
Manifest JSON has weights with names: `+u.join(", ")+".");return l=i.reduce(function(g,v,y){return v&&g.push(y),g},[]),d=[],l.forEach(function(g){n[g].paths.forEach(function(v){var y=r+(r.endsWith("/")?"":"/")+v;d.push(y)})}),[4,t(d)];case 1:return f=p.sent(),h={},m=0,l.forEach(function(g){for(var v=n[g].paths.length,y=0,x=0;x<v;x++)y+=f[m+x].byteLength;for(var b=new ArrayBuffer(y),E=new Uint8Array(b),_=0,S=0;S<v;S++){var k=new Uint8Array(f[m+S]);E.set(k,_),_+=k.byteLength}a[g].forEach(function(R){var I=XR(b.slice(R.groupOffset,R.groupOffset+R.sizeBytes),[R.manifestEntry]);for(var D in I)h[D]=I[D]}),m+=v}),[2,h]}})})}}Tn.registerSaveRouter(function(t){return G().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(cm.URL_SCHEME)?function(e){return e===void 0&&(e="model"),new cm(e)}(t.slice(cm.URL_SCHEME.length)):null});var eT=function(){function t(e,n){if(this.DEFAULT_METHOD="POST",n==null&&(n={}),this.weightPathPrefix=n.weightPathPrefix,this.onProgress=n.onProgress,n.fetchFunc!=null?(N(typeof n.fetchFunc=="function",function(){return"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"}),this.fetch=n.fetchFunc):this.fetch=G().platform.fetch,N(e!=null&&e.length>0,function(){return"URL path for http must not be null, undefined or empty."}),Array.isArray(e)&&N(e.length===2,function(){return"URL paths for http must have a length of 2, (actual length is "+e.length+")."}),this.path=e,n.requestInit!=null&&n.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=n.requestInit||{}}return t.prototype.save=function(e){return ce(this,void 0,void 0,function(){var n,r,o,i;return le(this,function(a){switch(a.label){case 0:if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");return(n=Object.assign({method:this.DEFAULT_METHOD},this.requestInit)).body=new FormData,r=[{paths:["./model.weights.bin"],weights:e.weightSpecs}],o={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,userDefinedMetadata:e.userDefinedMetadata,weightsManifest:r},n.body.append("model.json",new Blob([JSON.stringify(o)],{type:"application/json"}),"model.json"),e.weightData!=null&&n.body.append("model.weights.bin",new Blob([e.weightData],{type:"application/octet-stream"}),"model.weights.bin"),[4,this.fetch(this.path,n)];case 1:if((i=a.sent()).ok)return[2,{modelArtifactsInfo:cl(e),responses:[i]}];throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+i.status+".")}})})},t.prototype.load=function(){return ce(this,void 0,void 0,function(){var e,n,r,o,i,a,s,u,c,l,d,f;return le(this,function(h){switch(h.label){case 0:return[4,this.fetch(this.path,this.requestInit)];case 1:if(!(e=h.sent()).ok)throw new Error("Request to "+this.path+" failed with status code "+e.status+". Please verify this URL points to the model JSON of the model to load.");h.label=2;case 2:return h.trys.push([2,4,,5]),[4,e.json()];case 3:return n=h.sent(),[3,5];case 4:throw h.sent(),r="Failed to parse model JSON of response from "+this.path+".",this.path.endsWith(".pb")?r+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":r+=" Please make sure the server is serving valid JSON for this request.",new Error(r);case 5:if(o=n.modelTopology,i=n.weightsManifest,a=n.generatedBy,s=n.convertedBy,u=n.format,c=n.userDefinedMetadata,o==null&&i==null)throw new Error("The JSON from HTTP path "+this.path+" contains neither model topology or manifest for weights.");return i==null?[3,7]:[4,this.loadWeights(i)];case 6:f=h.sent(),l=f[0],d=f[1],h.label=7;case 7:return[2,{modelTopology:o,weightSpecs:l,weightData:d,userDefinedMetadata:c,generatedBy:a,convertedBy:s,format:u}]}})})},t.prototype.loadWeights=function(e){return ce(this,void 0,void 0,function(){var n,r,o,i,a,s,u,c,l,d,f;return le(this,function(h){switch(h.label){case 0:for(n=Array.isArray(this.path)?this.path[1]:this.path,r=function(m){var p=m.lastIndexOf("/"),g=m.lastIndexOf("?"),v=m.substring(0,p),y=g>p?m.substring(g):"";return[v+"/",y]}(n),o=r[0],i=r[1],a=this.weightPathPrefix||o,s=[],u=0,c=e;u<c.length;u++)l=c[u],s.push.apply(s,l.weights);return d=[],e.forEach(function(m){m.paths.forEach(function(p){d.push(a+p+i)})}),[4,ZR(d,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress})];case 1:return f=h.sent(),[2,[s,x0(f)]]}})})},t.URL_SCHEME_REGEX=/^https?:\/\//,t}();function tg(t){return t.match(eT.URL_SCHEME_REGEX)!=null}var Bb=function(t,e){return typeof fetch>"u"?null:(Array.isArray(t)?t.every(function(n){return tg(n)}):tg(t))?ng(t,{onProgress:e}):null};function ng(t,e){return new eT(t,e)}Tn.registerSaveRouter(Bb),Tn.registerLoadRouter(Bb);var lm=function(){function t(e){this.modelArtifacts=e}return t.prototype.load=function(){return ce(this,void 0,void 0,function(){return le(this,function(e){return[2,this.modelArtifacts]})})},t}(),Y7=function(){function t(e){this.saveHandler=e}return t.prototype.save=function(e){return ce(this,void 0,void 0,function(){return le(this,function(n){return[2,this.saveHandler(e)]})})},t}(),tT=Object.freeze({browserFiles:function(t){return new X7(t)},browserHTTPRequest:function(t,e){return ng(t,e)},concatenateArrayBuffers:x0,decodeWeights:XR,encodeWeights:function(t,e){return ce(this,void 0,void 0,function(){var n,r,o,i,a,s=this;return le(this,function(u){switch(u.label){case 0:for(n=[],r=[],o=Array.isArray(t)?t.map(function(c){return c.name}):Object.keys(t),i=function(c){var l=o[c],d=Array.isArray(t)?t[c].tensor:t[l];if(d.dtype!=="float32"&&d.dtype!=="int32"&&d.dtype!=="bool"&&d.dtype!=="string")throw new Error("Unsupported dtype in weight '"+l+"': "+d.dtype);var f={name:l,shape:d.shape,dtype:d.dtype};if(d.dtype==="string"){var h=new Promise(function(m){return ce(s,void 0,void 0,function(){var p,g,v,y,x,b,E;return le(this,function(_){switch(_.label){case 0:return[4,d.bytes()];case 1:for(p=_.sent(),g=p.reduce(function(S,k){return S+k.length},0)+Df*p.length,v=new Uint8Array(g),y=0,x=0;x<p.length;x++)b=p[x],E=new Uint8Array(new Uint32Array([b.length]).buffer),v.set(E,y),y+=Df,v.set(b,y),y+=b.length;return m(v),[2]}})})});r.push(h)}else r.push(d.data());e!=null&&(f.group=e),n.push(f)},a=0;a<o.length;++a)i(a);return[4,Promise.all(r)];case 1:return[2,{data:B7(u.sent()),specs:n}]}})})},fromMemory:function(t,e,n,r){return arguments.length===1?t.modelTopology!=null||t.weightSpecs!=null?new lm(t):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new lm({modelTopology:t})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new lm({modelTopology:t,weightSpecs:e,weightData:n,trainingConfig:r}))},getLoadHandlers:function(t,e){return Tn.getLoadHandlers(t,e)},getModelArtifactsInfoForJSON:cl,getSaveHandlers:function(t){return Tn.getSaveHandlers(t)},http:ng,isHTTPScheme:tg,loadWeights:function(t,e,n,r){return e===void 0&&(e=""),ce(this,void 0,void 0,function(){return le(this,function(o){return[2,Lb(function(i){return ZR(i,{requestInit:r})})(t,e,n)]})})},registerLoadRouter:function(t){return Tn.registerLoadRouter(t)},registerSaveRouter:function(t){return Tn.registerSaveRouter(t)},weightsLoaderFactory:Lb,withSaveHandler:function(t){return new Y7(t)},copyModel:function(t,e){return ce(this,void 0,void 0,function(){return le(this,function(n){return[2,Pb(t,e,!1)]})})},listModels:function(){return ce(this,void 0,void 0,function(){var t,e,n,r,o,i,a;return le(this,function(s){switch(s.label){case 0:t=Ei.getSchemes(),e={},n=0,r=t,s.label=1;case 1:return n<r.length?(o=r[n],[4,Ei.getManager(o).listModels()]):[3,4];case 2:for(a in i=s.sent())e[o+Cs+a]=i[a];s.label=3;case 3:return n++,[3,1];case 4:return[2,e]}})})},moveModel:function(t,e){return ce(this,void 0,void 0,function(){return le(this,function(n){return[2,Pb(t,e,!0)]})})},removeModel:function(t){return ce(this,void 0,void 0,function(){var e;return le(this,function(n){return e=_d(t),[2,Ei.getManager(e.scheme).removeModel(e.path)]})})}}),$a;O({confusionMatrix_:function(t,e,n){var r=T(t,"labels","confusionMatrix"),o=T(e,"predictions","confusionMatrix");N(n==null||n>0&&Number.isInteger(n),function(){return"If provided, numClasses must be a positive integer, but got "+n}),N(r.rank===1,function(){return"Expected the rank of labels to be 1, but got "+r.rank}),N(o.rank===1,function(){return"Expected the rank of predictions to be 1, but got "+o.rank}),N(r.shape[0]===o.shape[0],function(){return"Mismatch in the number of examples: "+r.shape[0]+" vs. "+o.shape[0]+". Labels and predictions should have the same number of elements."}),N(n>0&&Number.isInteger(n),function(){return"numClasses is required to be a positive integer, but got "+n});var i=Kv(r.asType("int32"),n),a=Kv(o.asType("int32"),n);return i.transpose().matMul(a).asType("int32")}});var Q7=O({fromPixels_:function(t,e){if(e===void 0&&(e=3),e>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(t==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var n=!1,r=!1,o=!1,i=!1,a=!1;if(t.data instanceof Uint8Array)n=!0;else if(typeof ImageData<"u"&&t instanceof ImageData)r=!0;else if(typeof HTMLVideoElement<"u"&&t instanceof HTMLVideoElement)o=!0;else if(typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement)i=!0;else{if(t.getContext==null)throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was "+t.constructor.name);a=!0}if(o&&o&&t.readyState<2)throw new Error("The video element has not loaded data yet. Please wait for `loadeddata` event on the <video> element.");if(SI("FromPixels",L.backendName)!=null)return L.runKernel("FromPixels",{pixels:t},{numChannels:e});var s,u,c=o?[t.videoWidth,t.videoHeight]:[t.width,t.height],l=c[0],d=c[1];if(a?s=t.getContext("2d").getImageData(0,0,l,d).data:r||n?s=t.data:(i||o)&&($a==null&&($a=document.createElement("canvas").getContext("2d")),$a.canvas.width=l,$a.canvas.height=d,$a.drawImage(t,0,0,l,d),s=$a.getImageData(0,0,l,d).data),e===4)u=new Int32Array(s);else{var f=l*d;u=new Int32Array(f*e);for(var h=0;h<f;h++)for(var m=0;m<e;++m)u[h*e+m]=s[4*h+m]}return qy(u,[d,l,e],"int32")}}),w0=Object.freeze({toPixels:function(t,e){return ce(this,void 0,void 0,function(){var n,r,o,i,a,s,u,c,l,d,f,h,m,p,g,v,y,x,b,E,_,S,k;return le(this,function(R){switch(R.label){case 0:if(n=T(t,"img","toPixels"),t instanceof nt||(n=n.toInt()),n.rank!==2&&n.rank!==3)throw new Error("toPixels only supports rank 2 or 3 tensors, got rank "+n.rank+".");if(r=n.shape.slice(0,2),o=r[0],i=r[1],(a=n.rank===2?1:n.shape[2])>4||a===2)throw new Error("toPixels only supports depth of size 1, 3 or 4 but got "+a);return[4,n.data()];case 1:return s=R.sent(),u=n.min(),c=n.max(),[4,Promise.all([u.data(),c.data()])];case 2:if(l=R.sent(),d=l[0],f=l[1],h=d[0],m=f[0],u.dispose(),c.dispose(),n.dtype==="float32"){if(h<0||m>1)throw new Error("Tensor values for a float32 Tensor must be in the range [0 - 1] but got range ["+h+" - "+m+"].")}else{if(n.dtype!=="int32")throw new Error("Unsupported type for toPixels: "+n.dtype+". Please use float32 or int32 tensors.");if(h<0||m>255)throw new Error("Tensor values for a int32 Tensor must be in the range [0 - 255] but got range ["+h+" - "+m+"].")}for(p=n.dtype==="float32"?255:1,g=new Uint8ClampedArray(i*o*4),v=0;v<o*i;++v)y=void 0,x=void 0,b=void 0,E=void 0,a===1?(y=s[v]*p,x=s[v]*p,b=s[v]*p,E=255):a===3?(y=s[3*v]*p,x=s[3*v+1]*p,b=s[3*v+2]*p,E=255):a===4&&(y=s[4*v]*p,x=s[4*v+1]*p,b=s[4*v+2]*p,E=s[4*v+3]*p),g[(_=4*v)+0]=Math.round(y),g[_+1]=Math.round(x),g[_+2]=Math.round(b),g[_+3]=Math.round(E);return e!=null&&(e.width=i,e.height=o,S=e.getContext("2d"),k=new ImageData(g,i,o),S.putImageData(k,0,0)),n!==t&&n.dispose(),[2,g]}})})},fromPixels:Q7}),J7=function(){function t(){}return t.prototype.getClassName=function(){return this.constructor.className},t.fromConfig=function(e,n){return new e(n)},t}(),Z7=function(){function t(){this.classNameMap={}}return t.getMap=function(){return t.instance==null&&(t.instance=new t),t.instance},t.register=function(e){t.getMap().classNameMap[e.className]=[e,e.fromConfig]},t}();function Aa(t){N(t.className!=null,function(){return"Class being registered does not have the static className property defined."}),N(typeof t.className=="string",function(){return"className is required to be a string, but got type "+typeof t.className}),N(t.className.length>0,function(){return"Class being registered has an empty-string as its className, which is disallowed."}),Z7.register(t)}var Pa=function(t){function e(){return t!==null&&t.apply(this,arguments)||this}return wr(e,t),e.prototype.minimize=function(n,r,o){r===void 0&&(r=!1);var i=this.computeGradients(n,o),a=i.value,s=i.grads;if(o!=null){var u=o.map(function(c){return{name:c.name,tensor:s[c.name]}});this.applyGradients(u)}else this.applyGradients(s);return xn(s),r?a:(a.dispose(),null)},Object.defineProperty(e.prototype,"iterations",{get:function(){return this.iterations_==null&&(this.iterations_=0),this.iterations_},enumerable:!0,configurable:!0}),e.prototype.incrementIterations=function(){this.iterations_=this.iterations+1},e.prototype.computeGradients=function(n,r){return c$(n,r)},e.prototype.dispose=function(){this.iterations_!=null&&xn(this.iterations_)},e.prototype.saveIterations=function(){return ce(this,void 0,void 0,function(){return le(this,function(n){return this.iterations_==null&&(this.iterations_=0),[2,{name:"iter",tensor:re(this.iterations_,"int32")}]})})},e.prototype.getWeights=function(){return ce(this,void 0,void 0,function(){return le(this,function(n){throw new Error("getWeights() is not implemented for this optimizer yet.")})})},e.prototype.setWeights=function(n){return ce(this,void 0,void 0,function(){return le(this,function(r){throw new Error("setWeights() is not implemented for this optimizer class "+this.getClassName())})})},e.prototype.extractIterations=function(n){return ce(this,void 0,void 0,function(){var r;return le(this,function(o){switch(o.label){case 0:return r=this,[4,n[0].tensor.data()];case 1:return r.iterations_=o.sent()[0],[2,n.slice(1)]}})})},e}(J7);Object.defineProperty(Pa,Symbol.hasInstance,{value:function(t){return t.minimize!=null&&t.computeGradients!=null&&t.applyGradients!=null}});var eG=function(t){function e(n,r,o){o===void 0&&(o=null);var i=t.call(this)||this;return i.learningRate=n,i.rho=r,i.epsilon=o,i.accumulatedGrads=[],i.accumulatedUpdates=[],o==null&&(i.epsilon=L.backend.epsilon()),i}return wr(e,t),e.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(o){return o.name}):Object.keys(n)).forEach(function(o,i){var a=L.registeredVariables[o];r.accumulatedGrads[i]==null&&(r.accumulatedGrads[i]={originalName:o+"/accum_grad",variable:se(function(){return Fe(a).variable(!1)})}),r.accumulatedUpdates[i]==null&&(r.accumulatedUpdates[i]={originalName:o+"/accum_var",variable:se(function(){return Fe(a).variable(!1)})});var s=Array.isArray(n)?n[i].tensor:n[o];if(s!=null){var u=r.accumulatedGrads[i].variable,c=r.accumulatedUpdates[i].variable;se(function(){var l=u.mul(r.rho).add(s.square().mul(1-r.rho)),d=c.add(r.epsilon).sqrt().div(u.add(r.epsilon).sqrt()).mul(s),f=c.mul(r.rho).add(d.square().mul(1-r.rho));u.assign(l),c.assign(f);var h=d.mul(-r.learningRate).add(a);a.assign(h)})}}),this.incrementIterations()},e.prototype.dispose=function(){this.accumulatedUpdates!=null&&(xn(this.accumulatedGrads.map(function(n){return n.variable})),xn(this.accumulatedUpdates.map(function(n){return n.variable})))},e.prototype.getWeights=function(){return ce(this,void 0,void 0,function(){var n;return le(this,function(r){switch(r.label){case 0:return n=this.accumulatedGrads.concat(this.accumulatedUpdates),[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(n.map(function(o){return{name:o.originalName,tensor:o.variable}}))]}})})},e.prototype.setWeights=function(n){return ce(this,void 0,void 0,function(){var r;return le(this,function(o){switch(o.label){case 0:return[4,this.extractIterations(n)];case 1:return n=o.sent(),r=n.length/2,this.accumulatedGrads=n.slice(0,r).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),this.accumulatedUpdates=n.slice(r,2*r).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),[2]}})})},e.prototype.getConfig=function(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}},e.fromConfig=function(n,r){return new n(r.learningRate,r.rho,r.epsilon)},e.className="Adadelta",e}(Pa);Aa(eG);var tG=function(t){function e(n,r){r===void 0&&(r=.1);var o=t.call(this)||this;return o.learningRate=n,o.initialAccumulatorValue=r,o.accumulatedGrads=[],o}return wr(e,t),e.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(o){return o.name}):Object.keys(n)).forEach(function(o,i){var a=L.registeredVariables[o];r.accumulatedGrads[i]==null&&(r.accumulatedGrads[i]={originalName:o+"/accumulator",variable:se(function(){return Hr(a.shape,r.initialAccumulatorValue).variable(!1)})});var s=Array.isArray(n)?n[i].tensor:n[o];if(s!=null){var u=r.accumulatedGrads[i].variable;se(function(){var c=u.add(s.square());u.assign(c);var l=s.div(c.add(L.backend.epsilon()).sqrt()).mul(-r.learningRate).add(a);a.assign(l)})}}),this.incrementIterations()},e.prototype.dispose=function(){this.accumulatedGrads!=null&&xn(this.accumulatedGrads.map(function(n){return n.variable}))},e.prototype.getWeights=function(){return ce(this,void 0,void 0,function(){return le(this,function(n){switch(n.label){case 0:return[4,this.saveIterations()];case 1:return[2,[n.sent()].concat(this.accumulatedGrads.map(function(r){return{name:r.originalName,tensor:r.variable}}))]}})})},e.prototype.setWeights=function(n){return ce(this,void 0,void 0,function(){return le(this,function(r){switch(r.label){case 0:return[4,this.extractIterations(n)];case 1:return n=r.sent(),this.accumulatedGrads=n.map(function(o){return{originalName:o.name,variable:o.tensor.variable(!1)}}),[2]}})})},e.prototype.getConfig=function(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}},e.fromConfig=function(n,r){return new n(r.learningRate,r.initialAccumulatorValue)},e.className="Adagrad",e}(Pa);Aa(tG);var nG=function(t){function e(n,r,o,i){i===void 0&&(i=null);var a=t.call(this)||this;return a.learningRate=n,a.beta1=r,a.beta2=o,a.epsilon=i,a.accumulatedFirstMoment=[],a.accumulatedSecondMoment=[],se(function(){a.accBeta1=re(r).variable(),a.accBeta2=re(o).variable()}),i==null&&(a.epsilon=L.backend.epsilon()),a}return wr(e,t),e.prototype.applyGradients=function(n){var r=this,o=Array.isArray(n)?n.map(function(i){return i.name}):Object.keys(n);se(function(){var i=Ct(1,r.accBeta1),a=Ct(1,r.accBeta2);o.forEach(function(s,u){var c=L.registeredVariables[s];r.accumulatedFirstMoment[u]==null&&(r.accumulatedFirstMoment[u]={originalName:s+"/m",variable:se(function(){return Fe(c).variable(!1)})}),r.accumulatedSecondMoment[u]==null&&(r.accumulatedSecondMoment[u]={originalName:s+"/v",variable:se(function(){return Fe(c).variable(!1)})});var l=Array.isArray(n)?n[u].tensor:n[s];if(l!=null){var d=r.accumulatedFirstMoment[u].variable,f=r.accumulatedSecondMoment[u].variable,h=d.mul(r.beta1).add(l.mul(1-r.beta1)),m=f.mul(r.beta2).add(l.square().mul(1-r.beta2)),p=h.div(i),g=m.div(a);d.assign(h),f.assign(m);var v=p.div(g.sqrt().add(r.epsilon)).mul(-r.learningRate).add(c);c.assign(v)}}),r.accBeta1.assign(r.accBeta1.mul(r.beta1)),r.accBeta2.assign(r.accBeta2.mul(r.beta2))}),this.incrementIterations()},e.prototype.dispose=function(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&xn(this.accumulatedFirstMoment.map(function(n){return n.variable})),this.accumulatedSecondMoment!=null&&xn(this.accumulatedSecondMoment.map(function(n){return n.variable}))},e.prototype.getWeights=function(){return ce(this,void 0,void 0,function(){var n;return le(this,function(r){switch(r.label){case 0:return n=this.accumulatedFirstMoment.concat(this.accumulatedSecondMoment),[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(n.map(function(o){return{name:o.originalName,tensor:o.variable}}))]}})})},e.prototype.setWeights=function(n){return ce(this,void 0,void 0,function(){var r,o=this;return le(this,function(i){switch(i.label){case 0:return[4,this.extractIterations(n)];case 1:return n=i.sent(),se(function(){o.accBeta1.assign(Af(o.beta1,o.iterations_+1)),o.accBeta2.assign(Af(o.beta2,o.iterations_+1))}),r=n.length/2,this.accumulatedFirstMoment=n.slice(0,r).map(function(a){return{originalName:a.name,variable:a.tensor.variable(!1)}}),this.accumulatedSecondMoment=n.slice(r,2*r).map(function(a){return{originalName:a.name,variable:a.tensor.variable(!1)}}),[2]}})})},e.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}},e.fromConfig=function(n,r){return new n(r.learningRate,r.beta1,r.beta2,r.epsilon)},e.className="Adam",e}(Pa);Aa(nG);var rG=function(t){function e(n,r,o,i,a){i===void 0&&(i=null),a===void 0&&(a=0);var s=t.call(this)||this;return s.learningRate=n,s.beta1=r,s.beta2=o,s.epsilon=i,s.decay=a,s.accumulatedFirstMoment=[],s.accumulatedWeightedInfNorm=[],se(function(){s.iteration=re(0).variable(),s.accBeta1=re(r).variable()}),i==null&&(s.epsilon=L.backend.epsilon()),s}return wr(e,t),e.prototype.applyGradients=function(n){var r=this,o=Array.isArray(n)?n.map(function(i){return i.name}):Object.keys(n);se(function(){var i=Ct(1,r.accBeta1),a=cr(-r.learningRate,r.iteration.mul(r.decay).add(1));o.forEach(function(s,u){var c=L.registeredVariables[s];r.accumulatedFirstMoment[u]==null&&(r.accumulatedFirstMoment[u]={originalName:s+"/m",variable:Fe(c).variable(!1)}),r.accumulatedWeightedInfNorm[u]==null&&(r.accumulatedWeightedInfNorm[u]={originalName:s+"/v",variable:Fe(c).variable(!1)});var l=Array.isArray(n)?n[u].tensor:n[s];if(l!=null){var d=r.accumulatedFirstMoment[u].variable,f=r.accumulatedWeightedInfNorm[u].variable,h=d.mul(r.beta1).add(l.mul(1-r.beta1)),m=f.mul(r.beta2),p=l.abs(),g=m.maximum(p);d.assign(h),f.assign(g);var v=a.div(i).mul(h.div(g.add(r.epsilon))).add(c);c.assign(v)}}),r.iteration.assign(r.iteration.add(1)),r.accBeta1.assign(r.accBeta1.mul(r.beta1))}),this.incrementIterations()},e.prototype.dispose=function(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&xn(this.accumulatedFirstMoment.map(function(n){return n.variable})),this.accumulatedWeightedInfNorm!=null&&xn(this.accumulatedWeightedInfNorm.map(function(n){return n.variable}))},e.prototype.getWeights=function(){return ce(this,void 0,void 0,function(){return le(this,function(n){throw new Error("getWeights() is not implemented for Adamax yet.")})})},e.prototype.setWeights=function(n){return ce(this,void 0,void 0,function(){return le(this,function(r){throw new Error("setWeights() is not implemented for Adamax yet.")})})},e.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}},e.fromConfig=function(n,r){return new n(r.learningRate,r.beta1,r.beta2,r.epsilon,r.decay)},e.className="Adamax",e}(Pa);Aa(rG);var nT=function(t){function e(n){var r=t.call(this)||this;return r.learningRate=n,r.setLearningRate(n),r}return wr(e,t),e.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(o){return o.name}):Object.keys(n)).forEach(function(o,i){var a=Array.isArray(n)?n[i].tensor:n[o];if(a!=null){var s=L.registeredVariables[o];se(function(){var u=r.c.mul(a).add(s);s.assign(u)})}}),this.incrementIterations()},e.prototype.setLearningRate=function(n){this.learningRate=n,this.c!=null&&this.c.dispose(),this.c=CW(re(-n))},e.prototype.dispose=function(){this.c.dispose()},e.prototype.getWeights=function(){return ce(this,void 0,void 0,function(){return le(this,function(n){switch(n.label){case 0:return[4,this.saveIterations()];case 1:return[2,[n.sent()]]}})})},e.prototype.setWeights=function(n){return ce(this,void 0,void 0,function(){return le(this,function(r){switch(r.label){case 0:return[4,this.extractIterations(n)];case 1:if((n=r.sent()).length!==0)throw new Error("SGD optimizer does not have settable weights.");return[2]}})})},e.prototype.getConfig=function(){return{learningRate:this.learningRate}},e.fromConfig=function(n,r){return new n(r.learningRate)},e.className="SGD",e}(Pa);Aa(nT);var oG=function(t){function e(n,r,o){o===void 0&&(o=!1);var i=t.call(this,n)||this;return i.learningRate=n,i.momentum=r,i.useNesterov=o,i.accumulations=[],i.m=re(i.momentum),i}return wr(e,t),e.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(o){return o.name}):Object.keys(n)).forEach(function(o,i){var a=L.registeredVariables[o];r.accumulations[i]==null&&(r.accumulations[i]={originalName:o+"/momentum",variable:se(function(){return Fe(a).variable(!1)})});var s=r.accumulations[i].variable,u=Array.isArray(n)?n[i].tensor:n[o];u!=null&&se(function(){var c,l=r.m.mul(s).add(u);c=r.useNesterov?r.c.mul(u.add(l.mul(r.m))).add(a):r.c.mul(l).add(a),s.assign(l),a.assign(c)})}),this.incrementIterations()},e.prototype.dispose=function(){this.m.dispose(),this.accumulations!=null&&xn(this.accumulations.map(function(n){return n.variable}))},e.prototype.setMomentum=function(n){this.momentum=n},e.prototype.getWeights=function(){return ce(this,void 0,void 0,function(){return le(this,function(n){switch(n.label){case 0:return[4,this.saveIterations()];case 1:return[2,[n.sent()].concat(this.accumulations.map(function(r){return{name:r.originalName,tensor:r.variable}}))]}})})},e.prototype.setWeights=function(n){return ce(this,void 0,void 0,function(){return le(this,function(r){switch(r.label){case 0:return[4,this.extractIterations(n)];case 1:return n=r.sent(),this.accumulations=n.map(function(o){return{originalName:o.name,variable:o.tensor.variable(!1)}}),[2]}})})},e.prototype.getConfig=function(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}},e.fromConfig=function(n,r){return new n(r.learningRate,r.momentum,r.useNesterov)},e.className="Momentum",e}(nT);Aa(oG);var iG=function(t){function e(n,r,o,i,a){r===void 0&&(r=.9),o===void 0&&(o=0),i===void 0&&(i=null),a===void 0&&(a=!1);var s=t.call(this)||this;if(s.learningRate=n,s.decay=r,s.momentum=o,s.epsilon=i,s.accumulatedMeanSquares=[],s.accumulatedMoments=[],s.accumulatedMeanGrads=[],s.centered=a,i==null&&(s.epsilon=L.backend.epsilon()),n==null)throw new Error("learningRate for RMSPropOptimizer must be defined.");return s}return wr(e,t),e.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(o){return o.name}):Object.keys(n)).forEach(function(o,i){var a=L.registeredVariables[o];r.accumulatedMeanSquares[i]==null&&(r.accumulatedMeanSquares[i]={originalName:o+"/rms",variable:se(function(){return Fe(a).variable(!1)})}),r.accumulatedMoments[i]==null&&(r.accumulatedMoments[i]={originalName:o+"/momentum",variable:se(function(){return Fe(a).variable(!1)})}),r.accumulatedMeanGrads[i]==null&&r.centered&&(r.accumulatedMeanGrads[i]={originalName:o+"/mg",variable:se(function(){return Fe(a).variable(!1)})});var s=Array.isArray(n)?n[i].tensor:n[o];if(s!=null){var u=r.accumulatedMeanSquares[i].variable,c=r.accumulatedMoments[i].variable;se(function(){var l=u.mul(r.decay).add(s.square().mul(1-r.decay));if(r.centered){var d=r.accumulatedMeanGrads[i].variable,f=d.mul(r.decay).add(s.mul(1-r.decay)),h=c.mul(r.momentum).add(s.mul(r.learningRate).div(l.sub(f.square().add(r.epsilon)).sqrt()));u.assign(l),d.assign(f),c.assign(h);var m=a.sub(h);a.assign(m)}else{var p=u.mul(r.decay).add(s.square().mul(1-r.decay));h=c.mul(r.momentum).add(s.mul(r.learningRate).div(p.add(r.epsilon).sqrt())),u.assign(p),c.assign(h),m=a.sub(h),a.assign(m)}})}}),this.incrementIterations()},e.prototype.dispose=function(){this.accumulatedMeanSquares!=null&&xn(this.accumulatedMeanSquares.map(function(n){return n.variable})),this.accumulatedMeanGrads!=null&&this.centered&&xn(this.accumulatedMeanGrads.map(function(n){return n.variable})),this.accumulatedMoments!=null&&xn(this.accumulatedMoments.map(function(n){return n.variable}))},e.prototype.getWeights=function(){return ce(this,void 0,void 0,function(){var n;return le(this,function(r){switch(r.label){case 0:return n=this.accumulatedMeanSquares.concat(this.accumulatedMoments),this.centered&&n.push.apply(n,this.accumulatedMeanGrads),[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(n.map(function(o){return{name:o.originalName,tensor:o.variable}}))]}})})},e.prototype.setWeights=function(n){return ce(this,void 0,void 0,function(){var r;return le(this,function(o){switch(o.label){case 0:return[4,this.extractIterations(n)];case 1:return n=o.sent(),r=this.centered?n.length/3:n.length/2,this.accumulatedMeanSquares=n.slice(0,r).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),this.accumulatedMoments=n.slice(r,2*r).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),this.centered&&(this.accumulatedMeanGrads=n.slice(2*r,3*r).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}})),[2]}})})},e.prototype.getConfig=function(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}},e.fromConfig=function(n,r){return new n(r.learningRate,r.decay,r.momentum,r.epsilon,r.centered)},e.className="RMSProp",e}(Pa);Aa(iG);nt.prototype.squaredDifference=function(t){return gR(this,t)},H=A7;/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var rg=function(t,e){return rg=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)r.hasOwnProperty(o)&&(n[o]=r[o])},rg(t,e)};function Ee(t,e){rg(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var Kt=function(){return Kt=Object.assign||function(e){for(var n,r=1,o=arguments.length;r<o;r++){n=arguments[r];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Kt.apply(this,arguments)};function he(t,e,n,r){function o(i){return i instanceof n?i:new n(function(a){a(i)})}return new(n||(n=Promise))(function(i,a){function s(l){try{c(r.next(l))}catch(d){a(d)}}function u(l){try{c(r.throw(l))}catch(d){a(d)}}function c(l){l.done?i(l.value):o(l.value).then(s,u)}c((r=r.apply(t,[])).next())})}function pe(t,e){var n={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},r,o,i,a;return a={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function s(c){return function(l){return u([c,l])}}function u(c){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,o&&(i=c[0]&2?o.return:c[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,c[1])).done)return i;switch(o=0,i&&(c=[c[0]&2,i.value]),c[0]){case 0:case 1:i=c;break;case 4:return n.label++,{value:c[1],done:!1};case 5:n.label++,o=c[1],c=[0];continue;case 7:c=n.ops.pop(),n.trys.pop();continue;default:if(i=n.trys,!(i=i.length>0&&i[i.length-1])&&(c[0]===6||c[0]===2)){n=0;continue}if(c[0]===3&&(!i||c[1]>i[0]&&c[1]<i[3])){n.label=c[1];break}if(c[0]===6&&n.label<i[1]){n.label=i[1],i=c;break}if(i&&n.label<i[2]){n.label=i[2],n.ops.push(c);break}i[2]&&n.ops.pop(),n.trys.pop();continue}c=e.call(t,n)}catch(l){c=[6,l],o=0}finally{r=i=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}function qu(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),o=0,e=0;e<n;e++)for(var i=arguments[e],a=0,s=i.length;a<s;a++,o++)r[o]=i[a];return r}var ks=function(){function t(e,n){if(!ca(e)||!ca(n))throw new Error("Dimensions.constructor - expected width and height to be valid numbers, instead have "+JSON.stringify({width:e,height:n}));this._width=e,this._height=n}return Object.defineProperty(t.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),t.prototype.reverse=function(){return new t(1/this.width,1/this.height)},t}();function Dh(t,e){return t instanceof nt&&t.shape.length===e}function aG(t){return Dh(t,2)}function Mh(t){return Dh(t,3)}function Ci(t){return Dh(t,4)}function sG(t){return t%1!==0}function jb(t){return t%2===0}function uG(t,e){e===void 0&&(e=2);var n=Math.pow(10,e);return Math.floor(t*n)/n}function Ub(t){return t&&t.width&&t.height}function cG(t,e){var n=t.width,r=t.height,o=e/Math.max(r,n);return new ks(Math.round(n*o),Math.round(r*o))}function b0(t){return t.reduce(function(e,n){return e.add(n)},new je(0,0)).div(new je(t.length,t.length))}function Ac(t,e,n){return Array(t).fill(0).map(function(r,o){return e+o*n})}function ca(t){return!!t&&t!==1/0&&t!==-1/0&&!isNaN(t)||t===0}function Wb(t){return ca(t)&&0<=t&&t<=1}var je=function(){function t(e,n){this._x=e,this._y=n}return Object.defineProperty(t.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),t.prototype.add=function(e){return new t(this.x+e.x,this.y+e.y)},t.prototype.sub=function(e){return new t(this.x-e.x,this.y-e.y)},t.prototype.mul=function(e){return new t(this.x*e.x,this.y*e.y)},t.prototype.div=function(e){return new t(this.x/e.x,this.y/e.y)},t.prototype.abs=function(){return new t(Math.abs(this.x),Math.abs(this.y))},t.prototype.magnitude=function(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))},t.prototype.floor=function(){return new t(Math.floor(this.x),Math.floor(this.y))},t}(),Ti=function(){function t(e,n){n===void 0&&(n=!0);var r=e||{},o=[r.left,r.top,r.right,r.bottom].every(ca),i=[r.x,r.y,r.width,r.height].every(ca);if(!i&&!o)throw new Error("Box.constructor - expected box to be IBoundingBox | IRect, instead have "+JSON.stringify(r));var a=i?[r.x,r.y,r.width,r.height]:[r.left,r.top,r.right-r.left,r.bottom-r.top],s=a[0],u=a[1],c=a[2],l=a[3];t.assertIsValidBox({x:s,y:u,width:c,height:l},"Box.constructor",n),this._x=s,this._y=u,this._width=c,this._height=l}return t.isRect=function(e){return!!e&&[e.x,e.y,e.width,e.height].every(ca)},t.assertIsValidBox=function(e,n,r){if(r===void 0&&(r=!1),!t.isRect(e))throw new Error(n+" - invalid box: "+JSON.stringify(e)+", expected object with properties x, y, width, height");if(!r&&(e.width<0||e.height<0))throw new Error(n+" - width ("+e.width+") and height ("+e.height+") must be positive numbers")},Object.defineProperty(t.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"top",{get:function(){return this.y},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"area",{get:function(){return this.width*this.height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"topLeft",{get:function(){return new je(this.left,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"topRight",{get:function(){return new je(this.right,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bottomLeft",{get:function(){return new je(this.left,this.bottom)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bottomRight",{get:function(){return new je(this.right,this.bottom)},enumerable:!0,configurable:!0}),t.prototype.round=function(){var e=[this.x,this.y,this.width,this.height].map(function(a){return Math.round(a)}),n=e[0],r=e[1],o=e[2],i=e[3];return new t({x:n,y:r,width:o,height:i})},t.prototype.floor=function(){var e=[this.x,this.y,this.width,this.height].map(function(a){return Math.floor(a)}),n=e[0],r=e[1],o=e[2],i=e[3];return new t({x:n,y:r,width:o,height:i})},t.prototype.toSquare=function(){var e=this,n=e.x,r=e.y,o=e.width,i=e.height,a=Math.abs(o-i);return o<i&&(n-=a/2,o+=a),i<o&&(r-=a/2,i+=a),new t({x:n,y:r,width:o,height:i})},t.prototype.rescale=function(e){var n=Ub(e)?e.width:e,r=Ub(e)?e.height:e;return new t({x:this.x*n,y:this.y*r,width:this.width*n,height:this.height*r})},t.prototype.pad=function(e,n){var r=[this.x-e/2,this.y-n/2,this.width+e,this.height+n],o=r[0],i=r[1],a=r[2],s=r[3];return new t({x:o,y:i,width:a,height:s})},t.prototype.clipAtImageBorders=function(e,n){var r=this,o=r.x,i=r.y,a=r.right,s=r.bottom,u=Math.max(o,0),c=Math.max(i,0),l=a-u,d=s-c,f=Math.min(l,e-u),h=Math.min(d,n-c);return new t({x:u,y:c,width:f,height:h}).floor()},t.prototype.shift=function(e,n){var r=this,o=r.width,i=r.height,a=this.x+e,s=this.y+n;return new t({x:a,y:s,width:o,height:i})},t.prototype.padAtBorders=function(e,n){var r=this.width+1,o=this.height+1,i=1,a=1,s=r,u=o,c=this.left,l=this.top,d=this.right,f=this.bottom;return d>n&&(s=-d+n+r,d=n),f>e&&(u=-f+e+o,f=e),c<1&&(u=2-c,c=1),l<1&&(u=2-l,l=1),{dy:a,edy:u,dx:i,edx:s,y:l,ey:f,x:c,ex:d,w:r,h:o}},t.prototype.calibrate=function(e){return new t({left:this.left+e.left*this.width,top:this.top+e.top*this.height,right:this.right+e.right*this.width,bottom:this.bottom+e.bottom*this.height}).toSquare().round()},t}(),Oh=function(t){Ee(e,t);function e(n,r,o,i,a){return a===void 0&&(a=!1),t.call(this,{left:n,top:r,right:o,bottom:i},a)||this}return e}(Ti),rT=function(){function t(e,n,r,o,i){this._imageDims=new ks(i.width,i.height),this._score=e,this._classScore=n,this._className=r,this._box=new Ti(o).rescale(this._imageDims)}return Object.defineProperty(t.prototype,"score",{get:function(){return this._score},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"classScore",{get:function(){return this._classScore},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"className",{get:function(){return this._className},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"box",{get:function(){return this._box},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imageDims",{get:function(){return this._imageDims},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imageWidth",{get:function(){return this.imageDims.width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imageHeight",{get:function(){return this.imageDims.height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"relativeBox",{get:function(){return new Ti(this._box).rescale(this.imageDims.reverse())},enumerable:!0,configurable:!0}),t.prototype.forSize=function(e,n){return new t(this.score,this.classScore,this.className,this.relativeBox,{width:e,height:n})},t}(),Zr=function(t){Ee(e,t);function e(n,r,o){return t.call(this,n,n,"",r,o)||this}return e.prototype.forSize=function(n,r){var o=t.prototype.forSize.call(this,n,r),i=o.score,a=o.relativeBox,s=o.imageDims;return new e(i,a,s)},e}(rT);function lG(t,e,n){n===void 0&&(n=!0);var r=Math.max(0,Math.min(t.right,e.right)-Math.max(t.left,e.left)),o=Math.max(0,Math.min(t.bottom,e.bottom)-Math.max(t.top,e.top)),i=r*o;return n?i/(t.area+e.area-i):i/Math.min(t.area,e.area)}function dG(t){var e=t.map(function(s){return s.x}),n=t.map(function(s){return s.y}),r=e.reduce(function(s,u){return u<s?u:s},1/0),o=n.reduce(function(s,u){return u<s?u:s},1/0),i=e.reduce(function(s,u){return s<u?u:s},0),a=n.reduce(function(s,u){return s<u?u:s},0);return new Oh(r,o,i,a)}function Pc(t,e,n,r){r===void 0&&(r=!0);for(var o=e.map(function(s,u){return{score:s,boxIndex:u}}).sort(function(s,u){return s.score-u.score}).map(function(s){return s.boxIndex}),i=[],a=function(){var s=o.pop();i.push(s);for(var u=o,c=[],l=0;l<u.length;l++){var d=u[l],f=t[s],h=t[d];c.push(lG(f,h,r))}o=o.filter(function(m,p){return c[p]<=n})};o.length>0;)a();return i}function ll(t,e){return se(function(){var n=e[0],r=e[1],o=e[2],i=Hr(qu(t.shape.slice(0,3),[1]),n),a=Hr(qu(t.shape.slice(0,3),[1]),r),s=Hr(qu(t.shape.slice(0,3),[1]),o),u=wt([i,a,s],3);return Ct(t,u)})}function fG(t,e){return e===void 0&&(e=!1),se(function(){var n=t.shape.slice(1),r=n[0],o=n[1];if(r===o)return t;var i=Math.abs(r-o),a=Math.round(i*(e?.5:1)),s=r>o?2:1,u=function(h){var m=t.shape.slice();return m[s]=h,Hr(m,0)},c=u(a),l=i-c.shape[s],d=e&&l?u(l):null,f=[d,t,c].filter(function(h){return!!h}).map(function(h){return h.toFloat()});return wt(f,s)})}function dm(t){return 1/(1+Math.exp(-t))}var E0=function(t){Ee(e,t);function e(n,r,o,i,a){return a===void 0&&(a=!1),t.call(this,{x:n,y:r,width:o,height:i},a)||this}return e}(Ti),hG=.5,pG=.43,mG=.45,Mf=function(){function t(e,n,r){r===void 0&&(r=new je(0,0));var o=n.width,i=n.height;this._imgDims=new ks(o,i),this._shift=r,this._positions=e.map(function(a){return a.mul(new je(o,i)).add(r)})}return Object.defineProperty(t.prototype,"shift",{get:function(){return new je(this._shift.x,this._shift.y)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imageWidth",{get:function(){return this._imgDims.width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imageHeight",{get:function(){return this._imgDims.height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"positions",{get:function(){return this._positions},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"relativePositions",{get:function(){var e=this;return this._positions.map(function(n){return n.sub(e._shift).div(new je(e.imageWidth,e.imageHeight))})},enumerable:!0,configurable:!0}),t.prototype.forSize=function(e,n){return new this.constructor(this.relativePositions,{width:e,height:n})},t.prototype.shiftBy=function(e,n){return new this.constructor(this.relativePositions,this._imgDims,new je(e,n))},t.prototype.shiftByPoint=function(e){return this.shiftBy(e.x,e.y)},t.prototype.align=function(e,n){if(n===void 0&&(n={}),e){var r=e instanceof Zr?e.box.floor():new Ti(e);return this.shiftBy(r.x,r.y).align(null,n)}var o=Object.assign({},{useDlibAlignment:!1,minBoxPadding:.2},n),i=o.useDlibAlignment,a=o.minBoxPadding;return i?this.alignDlib():this.alignMinBbox(a)},t.prototype.alignDlib=function(){var e=this.getRefPointsForAlignment(),n=e[0],r=e[1],o=e[2],i=function(d){return o.sub(d).magnitude()},a=(i(n)+i(r))/2,s=Math.floor(a/mG),u=b0(e),c=Math.floor(Math.max(0,u.x-hG*s)),l=Math.floor(Math.max(0,u.y-pG*s));return new E0(c,l,Math.min(s,this.imageWidth+c),Math.min(s,this.imageHeight+l))},t.prototype.alignMinBbox=function(e){var n=dG(this.positions);return n.pad(n.width*e,n.height*e)},t.prototype.getRefPointsForAlignment=function(){throw new Error("getRefPointsForAlignment not implemented by base class")},t}(),vG=function(t){Ee(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.getRefPointsForAlignment=function(){var n=this.positions;return[n[0],n[1],b0([n[3],n[4]])]},e}(Mf),gG=function(t){Ee(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.getJawOutline=function(){return this.positions.slice(0,17)},e.prototype.getLeftEyeBrow=function(){return this.positions.slice(17,22)},e.prototype.getRightEyeBrow=function(){return this.positions.slice(22,27)},e.prototype.getNose=function(){return this.positions.slice(27,36)},e.prototype.getLeftEye=function(){return this.positions.slice(36,42)},e.prototype.getRightEye=function(){return this.positions.slice(42,48)},e.prototype.getMouth=function(){return this.positions.slice(48,68)},e.prototype.getRefPointsForAlignment=function(){return[this.getLeftEye(),this.getRightEye(),this.getMouth()].map(b0)},e}(Mf),$b=function(){function t(e,n){this._label=e,this._distance=n}return Object.defineProperty(t.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"distance",{get:function(){return this._distance},enumerable:!0,configurable:!0}),t.prototype.toString=function(e){return e===void 0&&(e=!0),""+this.label+(e?" ("+uG(this.distance)+")":"")},t}(),zb=function(t){Ee(e,t);function e(n,r){var o=t.call(this,n)||this;return o._label=r,o}return e.assertIsValidLabeledBox=function(n,r){if(Ti.assertIsValidBox(n,r),!ca(n.label))throw new Error(r+" - expected property label ("+n.label+") to be a number")},Object.defineProperty(e.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),e}(Ti),Ql=function(){function t(e,n){if(typeof e!="string")throw new Error("LabeledFaceDescriptors - constructor expected label to be a string");if(!Array.isArray(n)||n.some(function(r){return!(r instanceof Float32Array)}))throw new Error("LabeledFaceDescriptors - constructor expected descriptors to be an array of Float32Array");this._label=e,this._descriptors=n}return Object.defineProperty(t.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"descriptors",{get:function(){return this._descriptors},enumerable:!0,configurable:!0}),t.prototype.toJSON=function(){return{label:this.label,descriptors:this.descriptors.map(function(e){return Array.from(e)})}},t.fromJSON=function(e){var n=e.descriptors.map(function(r){return new Float32Array(r)});return new t(e.label,n)},t}();(function(t){Ee(e,t);function e(n,r,o,i){var a=t.call(this,n,r)||this;return a._score=o,a._classScore=i,a}return e.assertIsValidPredictedBox=function(n,r){if(zb.assertIsValidLabeledBox(n,r),!Wb(n.score)||!Wb(n.classScore))throw new Error(r+" - expected properties score ("+n.score+") and ("+n.classScore+") to be a number between [0, 1]")},Object.defineProperty(e.prototype,"score",{get:function(){return this._score},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"classScore",{get:function(){return this._classScore},enumerable:!0,configurable:!0}),e})(zb);function yG(t){return t.detection instanceof Zr}function C0(t,e){var n={detection:e};return Object.assign({},t,n)}function oT(){var t=window.fetch||function(){throw new Error("fetch - missing fetch implementation for browser environment")},e=function(){throw new Error("readFile - filesystem not available for browser environment")};return{Canvas:HTMLCanvasElement,CanvasRenderingContext2D,Image:HTMLImageElement,ImageData,Video:HTMLVideoElement,createCanvasElement:function(){return document.createElement("canvas")},createImageElement:function(){return document.createElement("img")},fetch:t,readFile:e}}function iT(t){var e="";if(!t)try{t=require("fs")}catch(r){e=r.toString()}var n=t?function(r){return new Promise(function(o,i){t.readFile(r,function(a,s){return a?i(a):o(s)})})}:function(){throw new Error("readFile - failed to require fs in nodejs environment with error: "+e)};return{readFile:n}}function aT(){var t=global.Canvas||global.HTMLCanvasElement,e=global.Image||global.HTMLImageElement,n=function(){if(t)return new t;throw new Error("createCanvasElement - missing Canvas implementation for nodejs environment")},r=function(){if(e)return new e;throw new Error("createImageElement - missing Image implementation for nodejs environment")},o=global.fetch||function(){throw new Error("fetch - missing fetch implementation for nodejs environment")},i=iT();return Kt({Canvas:t||function(){function a(){}return a}(),CanvasRenderingContext2D:global.CanvasRenderingContext2D||function(){function a(){}return a}(),Image:e||function(){function a(){}return a}(),ImageData:global.ImageData||function(){function a(){}return a}(),Video:global.HTMLVideoElement||function(){function a(){}return a}(),createCanvasElement:n,createImageElement:r,fetch:o},i)}function sT(){return typeof window=="object"&&typeof document<"u"&&typeof HTMLImageElement<"u"&&typeof HTMLCanvasElement<"u"&&typeof HTMLVideoElement<"u"&&typeof ImageData<"u"&&typeof CanvasRenderingContext2D<"u"}function uT(){return typeof global=="object"&&typeof require=="function"&&typeof mN<"u"&&typeof process<"u"&&!!process.version}var gt;function xG(){if(!gt)throw new Error("getEnv - environment is not defined, check isNodejs() and isBrowser()");return gt}function og(t){gt=t}function _0(){sT()&&og(oT()),uT()&&og(aT())}function wG(t){if(gt||_0(),!gt)throw new Error("monkeyPatch - environment is not defined, check isNodejs() and isBrowser()");var e=t.Canvas,n=e===void 0?gt.Canvas:e,r=t.Image,o=r===void 0?gt.Image:r;gt.Canvas=n,gt.Image=o,gt.createCanvasElement=t.createCanvasElement||function(){return new n},gt.createImageElement=t.createImageElement||function(){return new o},gt.ImageData=t.ImageData||gt.ImageData,gt.Video=t.Video||gt.Video,gt.fetch=t.fetch||gt.fetch,gt.readFile=t.readFile||gt.readFile}var Jt={getEnv:xG,setEnv:og,initialize:_0,createBrowserEnv:oT,createFileSystem:iT,createNodejsEnv:aT,monkeyPatch:wG,isBrowser:sT,isNodejs:uT};_0();function cT(t){return!Jt.isNodejs()&&typeof t=="string"?document.getElementById(t):t}function wa(t){var e=Jt.getEnv(),n=e.Canvas,r=e.CanvasRenderingContext2D;if(t instanceof r)return t;var o=cT(t);if(!(o instanceof n))throw new Error("resolveContext2d - expected canvas to be of instance of Canvas");var i=o.getContext("2d");if(!i)throw new Error("resolveContext2d - canvas 2d context is null");return i}var Vb;(function(t){t.TOP_LEFT="TOP_LEFT",t.TOP_RIGHT="TOP_RIGHT",t.BOTTOM_LEFT="BOTTOM_LEFT",t.BOTTOM_RIGHT="BOTTOM_RIGHT"})(Vb||(Vb={}));function lT(t){var e=Jt.getEnv(),n=e.Image,r=e.Video;return t instanceof n&&t.complete||t instanceof r&&t.readyState>=3}function bG(t){return new Promise(function(e,n){if(t instanceof Jt.getEnv().Canvas||lT(t))return e();function r(i){i.currentTarget&&(i.currentTarget.removeEventListener("load",r),i.currentTarget.removeEventListener("error",o),e(i))}function o(i){i.currentTarget&&(i.currentTarget.removeEventListener("load",r),i.currentTarget.removeEventListener("error",o),n(i))}t.addEventListener("load",r),t.addEventListener("error",o)})}function dT(t){var e=Jt.getEnv(),n=e.Image,r=e.Video;return t instanceof n?new ks(t.naturalWidth,t.naturalHeight):t instanceof r?new ks(t.videoWidth,t.videoHeight):new ks(t.width,t.height)}function Fh(t){var e=t.width,n=t.height,r=Jt.getEnv().createCanvasElement,o=r();return o.width=e,o.height=n,o}function S0(t,e){var n=Jt.getEnv().ImageData;if(!(t instanceof n)&&!lT(t))throw new Error("createCanvasFromMedia - media has not finished loading yet");var r=dT(t),o=r.width,i=r.height,a=Fh({width:o,height:i});return t instanceof n?wa(a).putImageData(t,0,0):wa(a).drawImage(t,0,0,o,i),a}function EG(t,e){return he(this,void 0,void 0,function(){var n,r,o,i,a,s;return pe(this,function(u){switch(u.label){case 0:return n=Jt.getEnv().createCanvasElement(),r=t.shape.slice(Ci(t)?1:0),o=r[0],i=r[1],a=r[2],s=se(function(){return t.as3D(o,i,a).toInt()}),[4,w0.toPixels(s,n)];case 1:return u.sent(),s.dispose(),[2,n]}})})}function Hb(t){var e=Jt.getEnv(),n=e.Image,r=e.Canvas,o=e.Video;return t instanceof n||t instanceof r||t instanceof o}function CG(t,e,n){n===void 0&&(n=!1);var r=Jt.getEnv(),o=r.Image,i=r.Canvas;if(!(t instanceof o||t instanceof i))throw new Error("imageToSquare - expected arg0 to be HTMLImageElement | HTMLCanvasElement");var a=dT(t),s=e/Math.max(a.height,a.width),u=s*a.width,c=s*a.height,l=Fh({width:e,height:e}),d=t instanceof i?t:S0(t),f=Math.abs(u-c)/2,h=n&&u<c?f:0,m=n&&c<u?f:0;return wa(l).drawImage(d,h,m,u,c),l}var Of=function(){function t(e,n){var r=this;if(n===void 0&&(n=!1),this._imageTensors=[],this._canvases=[],this._treatAsBatchInput=!1,this._inputDimensions=[],!Array.isArray(e))throw new Error("NetInput.constructor - expected inputs to be an Array of TResolvedNetInput or to be instanceof tf.Tensor4D, instead have "+e);this._treatAsBatchInput=n,this._batchSize=e.length,e.forEach(function(o,i){if(Mh(o)){r._imageTensors[i]=o,r._inputDimensions[i]=o.shape;return}if(Ci(o)){var a=o.shape[0];if(a!==1)throw new Error("NetInput - tf.Tensor4D with batchSize "+a+" passed, but not supported in input array");r._imageTensors[i]=o,r._inputDimensions[i]=o.shape.slice(1);return}var s=o instanceof Jt.getEnv().Canvas?o:S0(o);r._canvases[i]=s,r._inputDimensions[i]=[s.height,s.width,3]})}return Object.defineProperty(t.prototype,"imageTensors",{get:function(){return this._imageTensors},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"canvases",{get:function(){return this._canvases},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isBatchInput",{get:function(){return this.batchSize>1||this._treatAsBatchInput},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"batchSize",{get:function(){return this._batchSize},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"inputDimensions",{get:function(){return this._inputDimensions},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"inputSize",{get:function(){return this._inputSize},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"reshapedInputDimensions",{get:function(){var e=this;return Ac(this.batchSize,0,1).map(function(n,r){return e.getReshapedInputDimensions(r)})},enumerable:!0,configurable:!0}),t.prototype.getInput=function(e){return this.canvases[e]||this.imageTensors[e]},t.prototype.getInputDimensions=function(e){return this._inputDimensions[e]},t.prototype.getInputHeight=function(e){return this._inputDimensions[e][0]},t.prototype.getInputWidth=function(e){return this._inputDimensions[e][1]},t.prototype.getReshapedInputDimensions=function(e){if(typeof this.inputSize!="number")throw new Error("getReshapedInputDimensions - inputSize not set, toBatchTensor has not been called yet");var n=this.getInputWidth(e),r=this.getInputHeight(e);return cG({width:n,height:r},this.inputSize)},t.prototype.toBatchTensor=function(e,n){var r=this;return n===void 0&&(n=!0),this._inputSize=e,se(function(){var o=Ac(r.batchSize,0,1).map(function(a){var s=r.getInput(a);if(s instanceof nt){var u=Ci(s)?s:s.expandDims();return u=fG(u,n),(u.shape[1]!==e||u.shape[2]!==e)&&(u=p0.resizeBilinear(u,[e,e])),u.as3D(e,e,3)}if(s instanceof Jt.getEnv().Canvas)return w0.fromPixels(CG(s,e,n));throw new Error("toBatchTensor - at batchIdx "+a+", expected input to be instanceof tf.Tensor or instanceof HTMLCanvasElement, instead have "+s)}),i=Mn(o.map(function(a){return a.toFloat()})).as4D(r.batchSize,e,e,3);return i})},t}();function Dt(t){return he(this,void 0,void 0,function(){var e,n,r;return pe(this,function(o){switch(o.label){case 0:if(t instanceof Of)return[2,t];if(e=Array.isArray(t)?t:[t],!e.length)throw new Error("toNetInput - empty array passed as input");return n=function(i){return Array.isArray(t)?" at input index "+i+":":""},r=e.map(cT),r.forEach(function(i,a){if(!Hb(i)&&!Mh(i)&&!Ci(i))throw typeof e[a]=="string"?new Error("toNetInput -"+n(a)+" string passed, but could not resolve HTMLElement for element id "+e[a]):new Error("toNetInput -"+n(a)+" expected media to be of type HTMLImageElement | HTMLVideoElement | HTMLCanvasElement | tf.Tensor3D, or to be an element id");if(Ci(i)){var s=i.shape[0];if(s!==1)throw new Error("toNetInput -"+n(a)+" tf.Tensor4D with batchSize "+s+" passed, but not supported in input array")}}),[4,Promise.all(r.map(function(i){return Hb(i)&&bG(i)}))];case 1:return o.sent(),[2,new Of(r,Array.isArray(t))]}})})}function k0(t,e){return he(this,void 0,void 0,function(){var n,r,o,i,a,s,u;return pe(this,function(c){switch(c.label){case 0:return n=Jt.getEnv().Canvas,r=t,t instanceof n?[3,5]:[4,Dt(t)];case 1:if(o=c.sent(),o.batchSize>1)throw new Error("extractFaces - batchSize > 1 not supported");return i=o.getInput(0),i instanceof n?(a=i,[3,4]):[3,2];case 2:return[4,EG(i)];case 3:a=c.sent(),c.label=4;case 4:r=a,c.label=5;case 5:return s=wa(r),u=e.map(function(l){return l instanceof Zr?l.forSize(r.width,r.height).box.floor():l}).map(function(l){return l.clipAtImageBorders(r.width,r.height)}),[2,u.map(function(l){var d=l.x,f=l.y,h=l.width,m=l.height,p=Fh({width:h,height:m});return wa(p).putImageData(s.getImageData(d,f,h,m),0,0),p})]}})})}function I0(t,e){return he(this,void 0,void 0,function(){return pe(this,function(n){if(!Mh(t)&&!Ci(t))throw new Error("extractFaceTensors - expected image tensor to be 3D or 4D");if(Ci(t)&&t.shape[0]>1)throw new Error("extractFaceTensors - batchSize > 1 not supported");return[2,se(function(){var r=t.shape.slice(Ci(t)?1:0),o=r[0],i=r[1],a=r[2],s=e.map(function(c){return c instanceof Zr?c.forSize(i,o).box:c}).map(function(c){return c.clipAtImageBorders(i,o)}),u=s.map(function(c){var l=c.x,d=c.y,f=c.width,h=c.height;return BR(t.as3D(o,i,a),[d,l,0],[h,f,a])});return u})]})})}function _G(t,e){return he(this,void 0,void 0,function(){var n,r;return pe(this,function(o){switch(o.label){case 0:return n=Jt.getEnv().fetch,[4,n(t,e)];case 1:if(r=o.sent(),!(r.status<400))throw new Error("failed to fetch: ("+r.status+") "+r.statusText+", from url: "+r.url);return[2,r]}})})}function SG(t){return he(this,void 0,void 0,function(){return pe(this,function(e){switch(e.label){case 0:return[4,_G(t)];case 1:return[2,e.sent().json()]}})})}function fT(t,e){var n=e+"-weights_manifest.json";if(!t)return{modelBaseUri:"",manifestUri:n};if(t==="/")return{modelBaseUri:"/",manifestUri:"/"+n};var r=t.startsWith("http://")?"http://":t.startsWith("https://")?"https://":"";t=t.replace(r,"");var o=t.split("/").filter(function(s){return s}),i=t.endsWith(".json")?o[o.length-1]:n,a=r+(t.endsWith(".json")?o.slice(0,o.length-1):o).join("/");return a=t.startsWith("/")?"/"+a:a,{modelBaseUri:a,manifestUri:a==="/"?"/"+i:a+"/"+i}}function kG(t,e){return he(this,void 0,void 0,function(){var n,r,o,i;return pe(this,function(a){switch(a.label){case 0:return n=fT(t,e),r=n.manifestUri,o=n.modelBaseUri,[4,SG(r)];case 1:return i=a.sent(),[2,tT.loadWeights(i,o)]}})})}var Po=function(){function t(e){this._name=e,this._params=void 0,this._paramMappings=[]}return Object.defineProperty(t.prototype,"params",{get:function(){return this._params},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"paramMappings",{get:function(){return this._paramMappings},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isLoaded",{get:function(){return!!this.params},enumerable:!0,configurable:!0}),t.prototype.getParamFromPath=function(e){var n=this.traversePropertyPath(e),r=n.obj,o=n.objProp;return r[o]},t.prototype.reassignParamFromPath=function(e,n){var r=this.traversePropertyPath(e),o=r.obj,i=r.objProp;o[i].dispose(),o[i]=n},t.prototype.getParamList=function(){var e=this;return this._paramMappings.map(function(n){var r=n.paramPath;return{path:r,tensor:e.getParamFromPath(r)}})},t.prototype.getTrainableParams=function(){return this.getParamList().filter(function(e){return e.tensor instanceof Qs})},t.prototype.getFrozenParams=function(){return this.getParamList().filter(function(e){return!(e.tensor instanceof Qs)})},t.prototype.variable=function(){var e=this;this.getFrozenParams().forEach(function(n){var r=n.path,o=n.tensor;e.reassignParamFromPath(r,o.variable())})},t.prototype.freeze=function(){var e=this;this.getTrainableParams().forEach(function(n){var r=n.path,o=n.tensor,i=Bt(o.dataSync());o.dispose(),e.reassignParamFromPath(r,i)})},t.prototype.dispose=function(e){e===void 0&&(e=!0),this.getParamList().forEach(function(n){if(e&&n.tensor.isDisposed)throw new Error("param tensor has already been disposed for path "+n.path);n.tensor.dispose()}),this._params=void 0},t.prototype.serializeParams=function(){return new Float32Array(this.getParamList().map(function(e){var n=e.tensor;return Array.from(n.dataSync())}).reduce(function(e,n){return e.concat(n)}))},t.prototype.load=function(e){return he(this,void 0,void 0,function(){return pe(this,function(n){switch(n.label){case 0:return e instanceof Float32Array?(this.extractWeights(e),[2]):[4,this.loadFromUri(e)];case 1:return n.sent(),[2]}})})},t.prototype.loadFromUri=function(e){return he(this,void 0,void 0,function(){var n;return pe(this,function(r){switch(r.label){case 0:if(e&&typeof e!="string")throw new Error(this._name+".loadFromUri - expected model uri");return[4,kG(e,this.getDefaultModelName())];case 1:return n=r.sent(),this.loadFromWeightMap(n),[2]}})})},t.prototype.loadFromDisk=function(e){return he(this,void 0,void 0,function(){var n,r,o,i,a,s,u,c,l,d;return pe(this,function(f){switch(f.label){case 0:if(e&&typeof e!="string")throw new Error(this._name+".loadFromDisk - expected model file path");return n=Jt.getEnv().readFile,r=fT(e,this.getDefaultModelName()),o=r.manifestUri,i=r.modelBaseUri,a=function(h){return Promise.all(h.map(function(m){return n(m).then(function(p){return p.buffer})}))},s=tT.weightsLoaderFactory(a),l=(c=JSON).parse,[4,n(o)];case 1:return u=l.apply(c,[f.sent().toString()]),[4,s(u,i)];case 2:return d=f.sent(),this.loadFromWeightMap(d),[2]}})})},t.prototype.loadFromWeightMap=function(e){var n=this.extractParamsFromWeigthMap(e),r=n.paramMappings,o=n.params;this._paramMappings=r,this._params=o},t.prototype.extractWeights=function(e){var n=this.extractParams(e),r=n.paramMappings,o=n.params;this._paramMappings=r,this._params=o},t.prototype.traversePropertyPath=function(e){if(!this.params)throw new Error("traversePropertyPath - model has no loaded params");var n=e.split("/").reduce(function(i,a){if(!i.nextObj.hasOwnProperty(a))throw new Error("traversePropertyPath - object does not have property "+a+", for path "+e);return{obj:i.nextObj,objProp:a,nextObj:i.nextObj[a]}},{nextObj:this.params}),r=n.obj,o=n.objProp;if(!r||!o||!(r[o]instanceof nt))throw new Error("traversePropertyPath - parameter is not a tensor, for path "+e);return{obj:r,objProp:o}},t}();function Nn(t,e,n){return se(function(){var r=c0(t,e.depthwise_filter,e.pointwise_filter,n,"same");return r=Te(r,e.bias),r})}function fm(t,e,n){return n===void 0&&(n=!1),se(function(){var r=rt(n?Te(Yn(t,e.conv0.filters,[2,2],"same"),e.conv0.bias):Nn(t,e.conv0,[2,2])),o=Nn(r,e.conv1,[1,1]),i=rt(Te(r,o)),a=Nn(i,e.conv2,[1,1]);return rt(Te(r,Te(o,a)))})}function Jl(t,e,n,r){return n===void 0&&(n=!1),r===void 0&&(r=!0),se(function(){var o=rt(n?Te(Yn(t,e.conv0.filters,r?[2,2]:[1,1],"same"),e.conv0.bias):Nn(t,e.conv0,r?[2,2]:[1,1])),i=Nn(o,e.conv1,[1,1]),a=rt(Te(o,i)),s=Nn(a,e.conv2,[1,1]),u=rt(Te(o,Te(i,s))),c=Nn(u,e.conv3,[1,1]);return rt(Te(o,Te(i,Te(s,c))))})}function mr(t,e,n,r){return n===void 0&&(n="same"),r===void 0&&(r=!1),se(function(){var o=Te(Yn(t,e.filters,[1,1],n),e.bias);return r?rt(o):o})}function Do(t,e){Object.keys(t).forEach(function(n){e.some(function(r){return r.originalPath===n})||t[n].dispose()})}function Lh(t,e){return function(n,r,o,i){var a=fn(t(n*r*o*o),[o,o,n,r]),s=ht(t(r));return e.push({paramPath:i+"/filters"},{paramPath:i+"/bias"}),{filters:a,bias:s}}}function R0(t,e){return function(n,r,o){var i=bi(t(n*r),[n,r]),a=ht(t(r));return e.push({paramPath:o+"/weights"},{paramPath:o+"/bias"}),{weights:i,bias:a}}}var hT=function(){function t(e,n,r){this.depthwise_filter=e,this.pointwise_filter=n,this.bias=r}return t}();function T0(t,e){return function(n,r,o){var i=fn(t(9*n),[3,3,n,1]),a=fn(t(n*r),[1,1,n,r]),s=ht(t(r));return e.push({paramPath:o+"/depthwise_filter"},{paramPath:o+"/pointwise_filter"},{paramPath:o+"/bias"}),new hT(i,a,s)}}function N0(t){return function(e){var n=t(e+"/depthwise_filter",4),r=t(e+"/pointwise_filter",4),o=t(e+"/bias",1);return new hT(n,r,o)}}function Bi(t,e){return function(n,r,o){var i=t[n];if(!Dh(i,r))throw new Error("expected weightMap["+n+"] to be a Tensor"+r+"D, instead have "+i);return e.push({originalPath:n,paramPath:o||n}),i}}function Mo(t){var e=t;function n(o){var i=e.slice(0,o);return e=e.slice(o),i}function r(){return e}return{extractWeights:n,getRemainingWeights:r}}function pT(t,e){var n=Lh(t,e),r=T0(t,e);function o(a,s,u,c){c===void 0&&(c=!1);var l=c?n(a,s,3,u+"/conv0"):r(a,s,u+"/conv0"),d=r(s,s,u+"/conv1"),f=r(s,s,u+"/conv2");return{conv0:l,conv1:d,conv2:f}}function i(a,s,u,c){c===void 0&&(c=!1);var l=o(a,s,u,c),d=l.conv0,f=l.conv1,h=l.conv2,m=r(s,s,u+"/conv3");return{conv0:d,conv1:f,conv2:h,conv3:m}}return{extractDenseBlock3Params:o,extractDenseBlock4Params:i}}function IG(t){var e=[],n=Mo(t),r=n.extractWeights,o=n.getRemainingWeights,i=pT(r,e).extractDenseBlock4Params,a=i(3,32,"dense0",!0),s=i(32,64,"dense1"),u=i(64,128,"dense2"),c=i(128,256,"dense3");if(o().length!==0)throw new Error("weights remaing after extract: "+o().length);return{paramMappings:e,params:{dense0:a,dense1:s,dense2:u,dense3:c}}}function mT(t){return function(e){var n=t(e+"/filters",4),r=t(e+"/bias",1);return{filters:n,bias:r}}}function vT(t,e){var n=Bi(t,e),r=mT(n),o=N0(n);function i(s,u){u===void 0&&(u=!1);var c=u?r(s+"/conv0"):o(s+"/conv0"),l=o(s+"/conv1"),d=o(s+"/conv2");return{conv0:c,conv1:l,conv2:d}}function a(s,u){u===void 0&&(u=!1);var c=u?r(s+"/conv0"):o(s+"/conv0"),l=o(s+"/conv1"),d=o(s+"/conv2"),f=o(s+"/conv3");return{conv0:c,conv1:l,conv2:d,conv3:f}}return{extractDenseBlock3Params:i,extractDenseBlock4Params:a}}function RG(t){var e=[],n=vT(t,e).extractDenseBlock4Params,r={dense0:n("dense0",!0),dense1:n("dense1"),dense2:n("dense2"),dense3:n("dense3")};return Do(t,e),{params:r,paramMappings:e}}var gT=function(t){Ee(e,t);function e(){return t.call(this,"FaceFeatureExtractor")||this}return e.prototype.forwardInput=function(n){var r=this.params;if(!r)throw new Error("FaceFeatureExtractor - load model before inference");return se(function(){var o=n.toBatchTensor(112,!0),i=[122.782,117.001,104.298],a=ll(o,i).div(re(255)),s=Jl(a,r.dense0,!0);return s=Jl(s,r.dense1),s=Jl(s,r.dense2),s=Jl(s,r.dense3),s=ul(s,[7,7],[2,2],"valid"),s})},e.prototype.forward=function(n){return he(this,void 0,void 0,function(){var r;return pe(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,Dt(n)];case 1:return[2,r.apply(this,[o.sent()])]}})})},e.prototype.getDefaultModelName=function(){return"face_feature_extractor_model"},e.prototype.extractParamsFromWeigthMap=function(n){return RG(n)},e.prototype.extractParams=function(n){return IG(n)},e}(Po);function Lr(t,e){return se(function(){return Te(Nh(t,e.weights),e.bias)})}function TG(t,e,n){var r=[],o=Mo(t),i=o.extractWeights,a=o.getRemainingWeights,s=R0(i,r),u=s(e,n,"fc");if(a().length!==0)throw new Error("weights remaing after extract: "+a().length);return{paramMappings:r,params:{fc:u}}}function NG(t){var e=[],n=Bi(t,e);function r(i){var a=n(i+"/weights",2),s=n(i+"/bias",1);return{weights:a,bias:s}}var o={fc:r("fc")};return Do(t,e),{params:o,paramMappings:e}}function yT(t){var e={},n={};return Object.keys(t).forEach(function(r){var o=r.startsWith("fc")?n:e;o[r]=t[r]}),{featureExtractorMap:e,classifierMap:n}}var xT=function(t){Ee(e,t);function e(n,r){var o=t.call(this,n)||this;return o._faceFeatureExtractor=r,o}return Object.defineProperty(e.prototype,"faceFeatureExtractor",{get:function(){return this._faceFeatureExtractor},enumerable:!0,configurable:!0}),e.prototype.runNet=function(n){var r=this,o=this.params;if(!o)throw new Error(this._name+" - load model before inference");return se(function(){var i=n instanceof Of?r.faceFeatureExtractor.forwardInput(n):n;return Lr(i.as2D(i.shape[0],-1),o.fc)})},e.prototype.dispose=function(n){n===void 0&&(n=!0),this.faceFeatureExtractor.dispose(n),t.prototype.dispose.call(this,n)},e.prototype.loadClassifierParams=function(n){var r=this.extractClassifierParams(n),o=r.params,i=r.paramMappings;this._params=o,this._paramMappings=i},e.prototype.extractClassifierParams=function(n){return TG(n,this.getClassifierChannelsIn(),this.getClassifierChannelsOut())},e.prototype.extractParamsFromWeigthMap=function(n){var r=yT(n),o=r.featureExtractorMap,i=r.classifierMap;return this.faceFeatureExtractor.loadFromWeightMap(o),NG(i)},e.prototype.extractParams=function(n){var r=this.getClassifierChannelsIn(),o=this.getClassifierChannelsOut(),i=o*r+o,a=n.slice(0,n.length-i),s=n.slice(n.length-i);return this.faceFeatureExtractor.extractWeights(a),this.extractClassifierParams(s)},e}(Po),Gb=["neutral","happy","sad","angry","fearful","disgusted","surprised"],AG=function(){function t(e){var n=this;if(e.length!==7)throw new Error("FaceExpressions.constructor - expected probabilities.length to be 7, have: "+e.length);Gb.forEach(function(r,o){n[r]=e[o]})}return t.prototype.asSortedArray=function(){var e=this;return Gb.map(function(n){return{expression:n,probability:e[n]}}).sort(function(n,r){return r.probability-n.probability})},t}(),PG=function(t){Ee(e,t);function e(n){return n===void 0&&(n=new gT),t.call(this,"FaceExpressionNet",n)||this}return e.prototype.forwardInput=function(n){var r=this;return se(function(){return No(r.runNet(n))})},e.prototype.forward=function(n){return he(this,void 0,void 0,function(){var r;return pe(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,Dt(n)];case 1:return[2,r.apply(this,[o.sent()])]}})})},e.prototype.predictExpressions=function(n){return he(this,void 0,void 0,function(){var r,o,i,a,s=this;return pe(this,function(u){switch(u.label){case 0:return[4,Dt(n)];case 1:return r=u.sent(),[4,this.forwardInput(r)];case 2:return o=u.sent(),[4,Promise.all(bt(o).map(function(c){return he(s,void 0,void 0,function(){var l;return pe(this,function(d){switch(d.label){case 0:return[4,c.data()];case 1:return l=d.sent(),c.dispose(),[2,l]}})})}))];case 3:return i=u.sent(),o.dispose(),a=i.map(function(c){return new AG(c)}),[2,r.isBatchInput?a:a[0]]}})})},e.prototype.getDefaultModelName=function(){return"face_expression_model"},e.prototype.getClassifierChannelsIn=function(){return 256},e.prototype.getClassifierChannelsOut=function(){return 7},e}(xT);function wT(t,e){var n={expressions:e};return Object.assign({},t,n)}function DG(t){return yG(t)&&t.landmarks instanceof Mf&&t.unshiftedLandmarks instanceof Mf&&t.alignedRect instanceof Zr}function A0(t,e){var n=t.detection.box,r=e.shiftBy(n.x,n.y),o=r.align(),i=t.detection.imageDims,a=new Zr(t.detection.score,o.rescale(i.reverse()),i),s={landmarks:r,unshiftedLandmarks:e,alignedRect:a};return Object.assign({},t,s)}function MG(t,e){var n=Lh(t,e),r=T0(t,e);function o(a,s,u){var c=r(a,s,u+"/separable_conv0"),l=r(s,s,u+"/separable_conv1"),d=n(a,s,1,u+"/expansion_conv");return{separable_conv0:c,separable_conv1:l,expansion_conv:d}}function i(a,s){var u=r(a,a,s+"/separable_conv0"),c=r(a,a,s+"/separable_conv1"),l=r(a,a,s+"/separable_conv2");return{separable_conv0:u,separable_conv1:c,separable_conv2:l}}return{extractConvParams:n,extractSeparableConvParams:r,extractReductionBlockParams:o,extractMainBlockParams:i}}function OG(t,e){var n=[],r=Mo(t),o=r.extractWeights,i=r.getRemainingWeights,a=MG(o,n),s=a.extractConvParams,u=a.extractSeparableConvParams,c=a.extractReductionBlockParams,l=a.extractMainBlockParams,d=s(3,32,3,"entry_flow/conv_in"),f=c(32,64,"entry_flow/reduction_block_0"),h=c(64,128,"entry_flow/reduction_block_1"),m={conv_in:d,reduction_block_0:f,reduction_block_1:h},p={};Ac(e,0,1).forEach(function(x){p["main_block_"+x]=l(128,"middle_flow/main_block_"+x)});var g=c(128,256,"exit_flow/reduction_block"),v=u(256,512,"exit_flow/separable_conv"),y={reduction_block:g,separable_conv:v};if(i().length!==0)throw new Error("weights remaing after extract: "+i().length);return{paramMappings:n,params:{entry_flow:m,middle_flow:p,exit_flow:y}}}function FG(t,e){var n=Bi(t,e),r=mT(n),o=N0(n);function i(s){var u=o(s+"/separable_conv0"),c=o(s+"/separable_conv1"),l=r(s+"/expansion_conv");return{separable_conv0:u,separable_conv1:c,expansion_conv:l}}function a(s){var u=o(s+"/separable_conv0"),c=o(s+"/separable_conv1"),l=o(s+"/separable_conv2");return{separable_conv0:u,separable_conv1:c,separable_conv2:l}}return{extractConvParams:r,extractSeparableConvParams:o,extractReductionBlockParams:i,extractMainBlockParams:a}}function LG(t,e){var n=[],r=FG(t,n),o=r.extractConvParams,i=r.extractSeparableConvParams,a=r.extractReductionBlockParams,s=r.extractMainBlockParams,u=o("entry_flow/conv_in"),c=a("entry_flow/reduction_block_0"),l=a("entry_flow/reduction_block_1"),d={conv_in:u,reduction_block_0:c,reduction_block_1:l},f={};Ac(e,0,1).forEach(function(g){f["main_block_"+g]=s("middle_flow/main_block_"+g)});var h=a("exit_flow/reduction_block"),m=i("exit_flow/separable_conv"),p={reduction_block:h,separable_conv:m};return Do(t,n),{params:{entry_flow:d,middle_flow:f,exit_flow:p},paramMappings:n}}function bT(t,e,n){return Te(Yn(t,e.filters,n,"same"),e.bias)}function hm(t,e,n){n===void 0&&(n=!0);var r=n?rt(t):t;return r=Nn(r,e.separable_conv0,[1,1]),r=Nn(rt(r),e.separable_conv1,[1,1]),r=Rt(r,[3,3],[2,2],"same"),r=Te(r,bT(t,e.expansion_conv,[2,2])),r}function BG(t,e){var n=Nn(rt(t),e.separable_conv0,[1,1]);return n=Nn(rt(n),e.separable_conv1,[1,1]),n=Nn(rt(n),e.separable_conv2,[1,1]),n=Te(n,t),n}var jG=function(t){Ee(e,t);function e(n){var r=t.call(this,"TinyXception")||this;return r._numMainBlocks=n,r}return e.prototype.forwardInput=function(n){var r=this,o=this.params;if(!o)throw new Error("TinyXception - load model before inference");return se(function(){var i=n.toBatchTensor(112,!0),a=[122.782,117.001,104.298],s=ll(i,a).div(re(256)),u=rt(bT(s,o.entry_flow.conv_in,[2,2]));return u=hm(u,o.entry_flow.reduction_block_0,!1),u=hm(u,o.entry_flow.reduction_block_1),Ac(r._numMainBlocks,0,1).forEach(function(c){u=BG(u,o.middle_flow["main_block_"+c])}),u=hm(u,o.exit_flow.reduction_block),u=rt(Nn(u,o.exit_flow.separable_conv,[1,1])),u})},e.prototype.forward=function(n){return he(this,void 0,void 0,function(){var r;return pe(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,Dt(n)];case 1:return[2,r.apply(this,[o.sent()])]}})})},e.prototype.getDefaultModelName=function(){return"tiny_xception_model"},e.prototype.extractParamsFromWeigthMap=function(n){return LG(n,this._numMainBlocks)},e.prototype.extractParams=function(n){return OG(n,this._numMainBlocks)},e}(Po);function UG(t){var e=[],n=Mo(t),r=n.extractWeights,o=n.getRemainingWeights,i=R0(r,e),a=i(512,1,"fc/age"),s=i(512,2,"fc/gender");if(o().length!==0)throw new Error("weights remaing after extract: "+o().length);return{paramMappings:e,params:{fc:{age:a,gender:s}}}}function WG(t){var e=[],n=Bi(t,e);function r(i){var a=n(i+"/weights",2),s=n(i+"/bias",1);return{weights:a,bias:s}}var o={fc:{age:r("fc/age"),gender:r("fc/gender")}};return Do(t,e),{params:o,paramMappings:e}}var Ff;(function(t){t.FEMALE="female",t.MALE="male"})(Ff||(Ff={}));var $G=function(t){Ee(e,t);function e(n){n===void 0&&(n=new jG(2));var r=t.call(this,"AgeGenderNet")||this;return r._faceFeatureExtractor=n,r}return Object.defineProperty(e.prototype,"faceFeatureExtractor",{get:function(){return this._faceFeatureExtractor},enumerable:!0,configurable:!0}),e.prototype.runNet=function(n){var r=this,o=this.params;if(!o)throw new Error(this._name+" - load model before inference");return se(function(){var i=n instanceof Of?r.faceFeatureExtractor.forwardInput(n):n,a=ul(i,[7,7],[2,2],"valid").as2D(i.shape[0],-1),s=Lr(a,o.fc.age).as1D(),u=Lr(a,o.fc.gender);return{age:s,gender:u}})},e.prototype.forwardInput=function(n){var r=this;return se(function(){var o=r.runNet(n),i=o.age,a=o.gender;return{age:i,gender:No(a)}})},e.prototype.forward=function(n){return he(this,void 0,void 0,function(){var r;return pe(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,Dt(n)];case 1:return[2,r.apply(this,[o.sent()])]}})})},e.prototype.predictAgeAndGender=function(n){return he(this,void 0,void 0,function(){var r,o,i,a,s,u,c=this;return pe(this,function(l){switch(l.label){case 0:return[4,Dt(n)];case 1:return r=l.sent(),[4,this.forwardInput(r)];case 2:return o=l.sent(),i=bt(o.age),a=bt(o.gender),s=i.map(function(d,f){return{ageTensor:d,genderTensor:a[f]}}),[4,Promise.all(s.map(function(d){var f=d.ageTensor,h=d.genderTensor;return he(c,void 0,void 0,function(){var m,p,g,v,y;return pe(this,function(x){switch(x.label){case 0:return[4,f.data()];case 1:return m=x.sent()[0],[4,h.data()];case 2:return p=x.sent()[0],g=p>.5,v=g?Ff.MALE:Ff.FEMALE,y=g?p:1-p,f.dispose(),h.dispose(),[2,{age:m,gender:v,genderProbability:y}]}})})}))];case 3:return u=l.sent(),o.age.dispose(),o.gender.dispose(),[2,r.isBatchInput?u:u[0]]}})})},e.prototype.getDefaultModelName=function(){return"age_gender_model"},e.prototype.dispose=function(n){n===void 0&&(n=!0),this.faceFeatureExtractor.dispose(n),t.prototype.dispose.call(this,n)},e.prototype.loadClassifierParams=function(n){var r=this.extractClassifierParams(n),o=r.params,i=r.paramMappings;this._params=o,this._paramMappings=i},e.prototype.extractClassifierParams=function(n){return UG(n)},e.prototype.extractParamsFromWeigthMap=function(n){var r=yT(n),o=r.featureExtractorMap,i=r.classifierMap;return this.faceFeatureExtractor.loadFromWeightMap(o),WG(i)},e.prototype.extractParams=function(n){var r=1539,o=n.slice(0,n.length-r),i=n.slice(n.length-r);return this.faceFeatureExtractor.extractWeights(o),this.extractClassifierParams(i)},e}(Po),ET=function(t){Ee(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.postProcess=function(n,r,o){var i=o.map(function(s){var u=s.width,c=s.height,l=r/Math.max(c,u);return{width:u*l,height:c*l}}),a=i.length;return se(function(){var s=function(f,h){return Mn([Hr([68],f),Hr([68],h)],1).as2D(1,136).as1D()},u=function(f,h){var m=i[f],p=m.width,g=m.height;return h(p,g)?Math.abs(p-g)/2:0},c=function(f){return u(f,function(h,m){return h<m})},l=function(f){return u(f,function(h,m){return m<h})},d=n.mul(Hr([a,136],r)).sub(Mn(Array.from(Array(a),function(f,h){return s(c(h),l(h))}))).div(Mn(Array.from(Array(a),function(f,h){return s(i[h].width,i[h].height)})));return d})},e.prototype.forwardInput=function(n){var r=this;return se(function(){var o=r.runNet(n);return r.postProcess(o,n.inputSize,n.inputDimensions.map(function(i){var a=i[0],s=i[1];return{height:a,width:s}}))})},e.prototype.forward=function(n){return he(this,void 0,void 0,function(){var r;return pe(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,Dt(n)];case 1:return[2,r.apply(this,[o.sent()])]}})})},e.prototype.detectLandmarks=function(n){return he(this,void 0,void 0,function(){var r,o,i,a=this;return pe(this,function(s){switch(s.label){case 0:return[4,Dt(n)];case 1:return r=s.sent(),o=se(function(){return bt(a.forwardInput(r))}),[4,Promise.all(o.map(function(u,c){return he(a,void 0,void 0,function(){var l,d,f,h,m;return pe(this,function(p){switch(p.label){case 0:return f=(d=Array).from,[4,u.data()];case 1:return l=f.apply(d,[p.sent()]),h=l.filter(function(g,v){return jb(v)}),m=l.filter(function(g,v){return!jb(v)}),[2,new gG(Array(68).fill(0).map(function(g,v){return new je(h[v],m[v])}),{height:r.getInputHeight(c),width:r.getInputWidth(c)})]}})})}))];case 2:return i=s.sent(),o.forEach(function(u){return u.dispose()}),[2,r.isBatchInput?i:i[0]]}})})},e.prototype.getClassifierChannelsOut=function(){return 136},e}(xT),CT=function(t){Ee(e,t);function e(n){return n===void 0&&(n=new gT),t.call(this,"FaceLandmark68Net",n)||this}return e.prototype.getDefaultModelName=function(){return"face_landmark_68_model"},e.prototype.getClassifierChannelsIn=function(){return 256},e}(ET);function zG(t){var e=[],n=vT(t,e).extractDenseBlock3Params,r={dense0:n("dense0",!0),dense1:n("dense1"),dense2:n("dense2")};return Do(t,e),{params:r,paramMappings:e}}function VG(t){var e=[],n=Mo(t),r=n.extractWeights,o=n.getRemainingWeights,i=pT(r,e).extractDenseBlock3Params,a=i(3,32,"dense0",!0),s=i(32,64,"dense1"),u=i(64,128,"dense2");if(o().length!==0)throw new Error("weights remaing after extract: "+o().length);return{paramMappings:e,params:{dense0:a,dense1:s,dense2:u}}}var HG=function(t){Ee(e,t);function e(){return t.call(this,"TinyFaceFeatureExtractor")||this}return e.prototype.forwardInput=function(n){var r=this.params;if(!r)throw new Error("TinyFaceFeatureExtractor - load model before inference");return se(function(){var o=n.toBatchTensor(112,!0),i=[122.782,117.001,104.298],a=ll(o,i).div(re(255)),s=fm(a,r.dense0,!0);return s=fm(s,r.dense1),s=fm(s,r.dense2),s=ul(s,[14,14],[2,2],"valid"),s})},e.prototype.forward=function(n){return he(this,void 0,void 0,function(){var r;return pe(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,Dt(n)];case 1:return[2,r.apply(this,[o.sent()])]}})})},e.prototype.getDefaultModelName=function(){return"face_feature_extractor_tiny_model"},e.prototype.extractParamsFromWeigthMap=function(n){return zG(n)},e.prototype.extractParams=function(n){return VG(n)},e}(Po),GG=function(t){Ee(e,t);function e(n){return n===void 0&&(n=new HG),t.call(this,"FaceLandmark68TinyNet",n)||this}return e.prototype.getDefaultModelName=function(){return"face_landmark_68_tiny_model"},e.prototype.getClassifierChannelsIn=function(){return 128},e}(ET);(function(t){Ee(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e})(CT);function KG(t,e){return Te(Yt(t,e.weights),e.biases)}function P0(t,e,n,r,o){o===void 0&&(o="same");var i=e.conv,a=i.filters,s=i.bias,u=Yn(t,a,n,o);return u=Te(u,s),u=KG(u,e.scale),r?rt(u):u}function qG(t,e){return P0(t,e,[1,1],!0)}function _T(t,e){return P0(t,e,[1,1],!1)}function ST(t,e){return P0(t,e,[2,2],!0,"valid")}function XG(t,e){function n(s,u,c){var l=t(s),d=l.length/(u*c*c);if(sG(d))throw new Error("depth has to be an integer: "+d+", weights.length: "+l.length+", numFilters: "+u+", filterSize: "+c);return se(function(){return Ri(fn(l,[u,d,c,c]),[2,3,1,0])})}function r(s,u,c,l){var d=n(s,u,c),f=ht(t(u));return e.push({paramPath:l+"/filters"},{paramPath:l+"/bias"}),{filters:d,bias:f}}function o(s,u){var c=ht(t(s)),l=ht(t(s));return e.push({paramPath:u+"/weights"},{paramPath:u+"/biases"}),{weights:c,biases:l}}function i(s,u,c,l){var d=r(s,u,c,l+"/conv"),f=o(u,l+"/scale");return{conv:d,scale:f}}function a(s,u,c,l,d){d===void 0&&(d=!1);var f=i((d?.5:1)*s,u,c,l+"/conv1"),h=i(s,u,c,l+"/conv2");return{conv1:f,conv2:h}}return{extractConvLayerParams:i,extractResidualLayerParams:a}}function YG(t){var e=Mo(t),n=e.extractWeights,r=e.getRemainingWeights,o=[],i=XG(n,o),a=i.extractConvLayerParams,s=i.extractResidualLayerParams,u=a(4704,32,7,"conv32_down"),c=s(9216,32,3,"conv32_1"),l=s(9216,32,3,"conv32_2"),d=s(9216,32,3,"conv32_3"),f=s(36864,64,3,"conv64_down",!0),h=s(36864,64,3,"conv64_1"),m=s(36864,64,3,"conv64_2"),p=s(36864,64,3,"conv64_3"),g=s(147456,128,3,"conv128_down",!0),v=s(147456,128,3,"conv128_1"),y=s(147456,128,3,"conv128_2"),x=s(589824,256,3,"conv256_down",!0),b=s(589824,256,3,"conv256_1"),E=s(589824,256,3,"conv256_2"),_=s(589824,256,3,"conv256_down_out"),S=se(function(){return Ri(bi(n(256*128),[128,256]),[1,0])});if(o.push({paramPath:"fc"}),r().length!==0)throw new Error("weights remaing after extract: "+r().length);var k={conv32_down:u,conv32_1:c,conv32_2:l,conv32_3:d,conv64_down:f,conv64_1:h,conv64_2:m,conv64_3:p,conv128_down:g,conv128_1:v,conv128_2:y,conv256_down:x,conv256_1:b,conv256_2:E,conv256_down_out:_,fc:S};return{params:k,paramMappings:o}}function QG(t,e){var n=Bi(t,e);function r(a){var s=n(a+"/scale/weights",1),u=n(a+"/scale/biases",1);return{weights:s,biases:u}}function o(a){var s=n(a+"/conv/filters",4),u=n(a+"/conv/bias",1),c=r(a);return{conv:{filters:s,bias:u},scale:c}}function i(a){return{conv1:o(a+"/conv1"),conv2:o(a+"/conv2")}}return{extractConvLayerParams:o,extractResidualLayerParams:i}}function JG(t){var e=[],n=QG(t,e),r=n.extractConvLayerParams,o=n.extractResidualLayerParams,i=r("conv32_down"),a=o("conv32_1"),s=o("conv32_2"),u=o("conv32_3"),c=o("conv64_down"),l=o("conv64_1"),d=o("conv64_2"),f=o("conv64_3"),h=o("conv128_down"),m=o("conv128_1"),p=o("conv128_2"),g=o("conv256_down"),v=o("conv256_1"),y=o("conv256_2"),x=o("conv256_down_out"),b=t.fc;if(e.push({originalPath:"fc",paramPath:"fc"}),!aG(b))throw new Error("expected weightMap[fc] to be a Tensor2D, instead have "+b);var E={conv32_down:i,conv32_1:a,conv32_2:s,conv32_3:u,conv64_down:c,conv64_1:l,conv64_2:d,conv64_3:f,conv128_down:h,conv128_1:m,conv128_2:p,conv256_down:g,conv256_1:v,conv256_2:y,conv256_down_out:x,fc:b};return Do(t,e),{params:E,paramMappings:e}}function Sr(t,e){var n=qG(t,e.conv1);return n=_T(n,e.conv2),n=Te(n,t),n=rt(n),n}function Zl(t,e){var n=ST(t,e.conv1);n=_T(n,e.conv2);var r=ul(t,2,2,"valid"),o=Ye(r.shape),i=r.shape[3]!==n.shape[3],a=r.shape[1]!==n.shape[1]||r.shape[2]!==n.shape[2];if(a){var s=qu(n.shape);s[1]=1;var u=Ye(s);n=wt([n,u],1);var c=qu(n.shape);c[2]=1;var l=Ye(c);n=wt([n,l],2)}return r=i?wt([r,o],3):r,n=Te(r,n),n=rt(n),n}var ZG=function(t){Ee(e,t);function e(){return t.call(this,"FaceRecognitionNet")||this}return e.prototype.forwardInput=function(n){var r=this.params;if(!r)throw new Error("FaceRecognitionNet - load model before inference");return se(function(){var o=n.toBatchTensor(150,!0).toFloat(),i=[122.782,117.001,104.298],a=ll(o,i).div(re(256)),s=ST(a,r.conv32_down);s=Rt(s,3,2,"valid"),s=Sr(s,r.conv32_1),s=Sr(s,r.conv32_2),s=Sr(s,r.conv32_3),s=Zl(s,r.conv64_down),s=Sr(s,r.conv64_1),s=Sr(s,r.conv64_2),s=Sr(s,r.conv64_3),s=Zl(s,r.conv128_down),s=Sr(s,r.conv128_1),s=Sr(s,r.conv128_2),s=Zl(s,r.conv256_down),s=Sr(s,r.conv256_1),s=Sr(s,r.conv256_2),s=Zl(s,r.conv256_down_out);var u=s.mean([1,2]),c=Nh(u,r.fc);return c})},e.prototype.forward=function(n){return he(this,void 0,void 0,function(){var r;return pe(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,Dt(n)];case 1:return[2,r.apply(this,[o.sent()])]}})})},e.prototype.computeFaceDescriptor=function(n){return he(this,void 0,void 0,function(){var r,o,i,a=this;return pe(this,function(s){switch(s.label){case 0:return[4,Dt(n)];case 1:return r=s.sent(),o=se(function(){return bt(a.forwardInput(r))}),[4,Promise.all(o.map(function(u){return u.data()}))];case 2:return i=s.sent(),o.forEach(function(u){return u.dispose()}),[2,r.isBatchInput?i:i[0]]}})})},e.prototype.getDefaultModelName=function(){return"face_recognition_model"},e.prototype.extractParamsFromWeigthMap=function(n){return JG(n)},e.prototype.extractParams=function(n){return YG(n)},e}(Po);function kT(t,e){var n={descriptor:e};return Object.assign({},t,n)}function IT(t,e){var n={age:e};return Object.assign({},t,n)}function RT(t,e,n){var r={gender:e,genderProbability:n};return Object.assign({},t,r)}var TT=function(){function t(e){var n=e===void 0?{}:e,r=n.minFaceSize,o=n.scaleFactor,i=n.maxNumScales,a=n.scoreThresholds,s=n.scaleSteps;if(this._name="MtcnnOptions",this._minFaceSize=r||20,this._scaleFactor=o||.709,this._maxNumScales=i||10,this._scoreThresholds=a||[.6,.7,.7],this._scaleSteps=s,typeof this._minFaceSize!="number"||this._minFaceSize<0)throw new Error(this._name+" - expected minFaceSize to be a number > 0");if(typeof this._scaleFactor!="number"||this._scaleFactor<=0||this._scaleFactor>=1)throw new Error(this._name+" - expected scaleFactor to be a number between 0 and 1");if(typeof this._maxNumScales!="number"||this._maxNumScales<0)throw new Error(this._name+" - expected maxNumScales to be a number > 0");if(!Array.isArray(this._scoreThresholds)||this._scoreThresholds.length!==3||this._scoreThresholds.some(function(u){return typeof u!="number"}))throw new Error(this._name+" - expected scoreThresholds to be an array of numbers of length 3");if(this._scaleSteps&&(!Array.isArray(this._scaleSteps)||this._scaleSteps.some(function(u){return typeof u!="number"})))throw new Error(this._name+" - expected scaleSteps to be an array of numbers")}return Object.defineProperty(t.prototype,"minFaceSize",{get:function(){return this._minFaceSize},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scaleFactor",{get:function(){return this._scaleFactor},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxNumScales",{get:function(){return this._maxNumScales},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scoreThresholds",{get:function(){return this._scoreThresholds},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scaleSteps",{get:function(){return this._scaleSteps},enumerable:!0,configurable:!0}),t}();function e9(t,e){function n(u,c){var l=fn(t(9*u),[3,3,u,1]),d=ht(t(u)),f=ht(t(u)),h=ht(t(u)),m=ht(t(u));return e.push({paramPath:c+"/filters"},{paramPath:c+"/batch_norm_scale"},{paramPath:c+"/batch_norm_offset"},{paramPath:c+"/batch_norm_mean"},{paramPath:c+"/batch_norm_variance"}),{filters:l,batch_norm_scale:d,batch_norm_offset:f,batch_norm_mean:h,batch_norm_variance:m}}function r(u,c,l,d,f){var h=fn(t(u*c*l*l),[l,l,u,c]),m=ht(t(c));return e.push({paramPath:d+"/filters"},{paramPath:d+"/"+(f?"batch_norm_offset":"bias")}),{filters:h,bias:m}}function o(u,c,l,d){var f=r(u,c,l,d,!0),h=f.filters,m=f.bias;return{filters:h,batch_norm_offset:m}}function i(u,c,l){var d=n(u,l+"/depthwise_conv"),f=o(u,c,1,l+"/pointwise_conv");return{depthwise_conv:d,pointwise_conv:f}}function a(){var u=o(3,32,3,"mobilenetv1/conv_0"),c=i(32,64,"mobilenetv1/conv_1"),l=i(64,128,"mobilenetv1/conv_2"),d=i(128,128,"mobilenetv1/conv_3"),f=i(128,256,"mobilenetv1/conv_4"),h=i(256,256,"mobilenetv1/conv_5"),m=i(256,512,"mobilenetv1/conv_6"),p=i(512,512,"mobilenetv1/conv_7"),g=i(512,512,"mobilenetv1/conv_8"),v=i(512,512,"mobilenetv1/conv_9"),y=i(512,512,"mobilenetv1/conv_10"),x=i(512,512,"mobilenetv1/conv_11"),b=i(512,1024,"mobilenetv1/conv_12"),E=i(1024,1024,"mobilenetv1/conv_13");return{conv_0:u,conv_1:c,conv_2:l,conv_3:d,conv_4:f,conv_5:h,conv_6:m,conv_7:p,conv_8:g,conv_9:v,conv_10:y,conv_11:x,conv_12:b,conv_13:E}}function s(){var u=o(1024,256,1,"prediction_layer/conv_0"),c=o(256,512,3,"prediction_layer/conv_1"),l=o(512,128,1,"prediction_layer/conv_2"),d=o(128,256,3,"prediction_layer/conv_3"),f=o(256,128,1,"prediction_layer/conv_4"),h=o(128,256,3,"prediction_layer/conv_5"),m=o(256,64,1,"prediction_layer/conv_6"),p=o(64,128,3,"prediction_layer/conv_7"),g=r(512,12,1,"prediction_layer/box_predictor_0/box_encoding_predictor"),v=r(512,9,1,"prediction_layer/box_predictor_0/class_predictor"),y=r(1024,24,1,"prediction_layer/box_predictor_1/box_encoding_predictor"),x=r(1024,18,1,"prediction_layer/box_predictor_1/class_predictor"),b=r(512,24,1,"prediction_layer/box_predictor_2/box_encoding_predictor"),E=r(512,18,1,"prediction_layer/box_predictor_2/class_predictor"),_=r(256,24,1,"prediction_layer/box_predictor_3/box_encoding_predictor"),S=r(256,18,1,"prediction_layer/box_predictor_3/class_predictor"),k=r(256,24,1,"prediction_layer/box_predictor_4/box_encoding_predictor"),R=r(256,18,1,"prediction_layer/box_predictor_4/class_predictor"),I=r(128,24,1,"prediction_layer/box_predictor_5/box_encoding_predictor"),D=r(128,18,1,"prediction_layer/box_predictor_5/class_predictor"),A={box_encoding_predictor:g,class_predictor:v},W={box_encoding_predictor:y,class_predictor:x},F={box_encoding_predictor:b,class_predictor:E},$={box_encoding_predictor:_,class_predictor:S},j={box_encoding_predictor:k,class_predictor:R},U={box_encoding_predictor:I,class_predictor:D};return{conv_0:u,conv_1:c,conv_2:l,conv_3:d,conv_4:f,conv_5:h,conv_6:m,conv_7:p,box_predictor_0:A,box_predictor_1:W,box_predictor_2:F,box_predictor_3:$,box_predictor_4:j,box_predictor_5:U}}return{extractMobilenetV1Params:a,extractPredictionLayerParams:s}}function t9(t){var e=[],n=Mo(t),r=n.extractWeights,o=n.getRemainingWeights,i=e9(r,e),a=i.extractMobilenetV1Params,s=i.extractPredictionLayerParams,u=a(),c=s(),l=qy(r(5118*4),[1,5118,4]),d={extra_dim:l};if(e.push({paramPath:"output_layer/extra_dim"}),o().length!==0)throw new Error("weights remaing after extract: "+o().length);return{params:{mobilenetv1:u,prediction_layer:c,output_layer:d},paramMappings:e}}function n9(t,e){var n=Bi(t,e);function r(c,l,d){var f=n(c+"/Conv2d_"+l+"_pointwise/weights",4,d+"/filters"),h=n(c+"/Conv2d_"+l+"_pointwise/convolution_bn_offset",1,d+"/batch_norm_offset");return{filters:f,batch_norm_offset:h}}function o(c){var l="mobilenetv1/conv_"+c,d="MobilenetV1/Conv2d_"+c+"_depthwise",f=l+"/depthwise_conv",h=l+"/pointwise_conv",m=n(d+"/depthwise_weights",4,f+"/filters"),p=n(d+"/BatchNorm/gamma",1,f+"/batch_norm_scale"),g=n(d+"/BatchNorm/beta",1,f+"/batch_norm_offset"),v=n(d+"/BatchNorm/moving_mean",1,f+"/batch_norm_mean"),y=n(d+"/BatchNorm/moving_variance",1,f+"/batch_norm_variance");return{depthwise_conv:{filters:m,batch_norm_scale:p,batch_norm_offset:g,batch_norm_mean:v,batch_norm_variance:y},pointwise_conv:r("MobilenetV1",c,h)}}function i(){return{conv_0:r("MobilenetV1",0,"mobilenetv1/conv_0"),conv_1:o(1),conv_2:o(2),conv_3:o(3),conv_4:o(4),conv_5:o(5),conv_6:o(6),conv_7:o(7),conv_8:o(8),conv_9:o(9),conv_10:o(10),conv_11:o(11),conv_12:o(12),conv_13:o(13)}}function a(c,l){var d=n(c+"/weights",4,l+"/filters"),f=n(c+"/biases",1,l+"/bias");return{filters:d,bias:f}}function s(c){var l=a("Prediction/BoxPredictor_"+c+"/BoxEncodingPredictor","prediction_layer/box_predictor_"+c+"/box_encoding_predictor"),d=a("Prediction/BoxPredictor_"+c+"/ClassPredictor","prediction_layer/box_predictor_"+c+"/class_predictor");return{box_encoding_predictor:l,class_predictor:d}}function u(){return{conv_0:r("Prediction",0,"prediction_layer/conv_0"),conv_1:r("Prediction",1,"prediction_layer/conv_1"),conv_2:r("Prediction",2,"prediction_layer/conv_2"),conv_3:r("Prediction",3,"prediction_layer/conv_3"),conv_4:r("Prediction",4,"prediction_layer/conv_4"),conv_5:r("Prediction",5,"prediction_layer/conv_5"),conv_6:r("Prediction",6,"prediction_layer/conv_6"),conv_7:r("Prediction",7,"prediction_layer/conv_7"),box_predictor_0:s(0),box_predictor_1:s(1),box_predictor_2:s(2),box_predictor_3:s(3),box_predictor_4:s(4),box_predictor_5:s(5)}}return{extractMobilenetV1Params:i,extractPredictionLayerParams:u}}function r9(t){var e=[],n=n9(t,e),r=n.extractMobilenetV1Params,o=n.extractPredictionLayerParams,i=t["Output/extra_dim"];if(e.push({originalPath:"Output/extra_dim",paramPath:"output_layer/extra_dim"}),!Mh(i))throw new Error("expected weightMap['Output/extra_dim'] to be a Tensor3D, instead have "+i);var a={mobilenetv1:r(),prediction_layer:o(),output_layer:{extra_dim:i}};return Do(t,e),{params:a,paramMappings:e}}function Ir(t,e,n){return se(function(){var r=Yn(t,e.filters,n,"same");return r=Te(r,e.batch_norm_offset),i0(r,0,6)})}var o9=.0010000000474974513;function i9(t,e,n){return se(function(){var r=Th(t,e.filters,n,"same");return r=CR(r,e.batch_norm_mean,e.batch_norm_variance,e.batch_norm_offset,e.batch_norm_scale,o9),i0(r,0,6)})}function a9(t){return[2,4,6,12].some(function(e){return e===t})?[2,2]:[1,1]}function s9(t,e){return se(function(){var n=null,r=Ir(t,e.conv_0,[2,2]),o=[e.conv_1,e.conv_2,e.conv_3,e.conv_4,e.conv_5,e.conv_6,e.conv_7,e.conv_8,e.conv_9,e.conv_10,e.conv_11,e.conv_12,e.conv_13];if(o.forEach(function(i,a){var s=a+1,u=a9(s);r=i9(r,i.depthwise_conv,u),r=Ir(r,i.pointwise_conv,[1,1]),s===11&&(n=r)}),n===null)throw new Error("mobileNetV1 - output of conv layer 11 is null");return{out:r,conv11:n}})}function u9(t,e,n,r,o){var i=t.shape[0],a=Math.min(n,i),s=e.map(function(l,d){return{score:l,boxIndex:d}}).filter(function(l){return l.score>o}).sort(function(l,d){return d.score-l.score}),u=function(l){return l<=r?1:0},c=[];return s.forEach(function(l){if(!(c.length>=a)){for(var d=l.score,f=c.length-1;f>=0;--f){var h=c9(t,l.boxIndex,c[f]);if(h!==0&&(l.score*=u(h),l.score<=o))break}d===l.score&&c.push(l.boxIndex)}}),c}function c9(t,e,n){var r=t.arraySync(),o=Math.min(r[e][0],r[e][2]),i=Math.min(r[e][1],r[e][3]),a=Math.max(r[e][0],r[e][2]),s=Math.max(r[e][1],r[e][3]),u=Math.min(r[n][0],r[n][2]),c=Math.min(r[n][1],r[n][3]),l=Math.max(r[n][0],r[n][2]),d=Math.max(r[n][1],r[n][3]),f=(a-o)*(s-i),h=(l-u)*(d-c);if(f<=0||h<=0)return 0;var m=Math.max(o,u),p=Math.max(i,c),g=Math.min(a,l),v=Math.min(s,d),y=Math.max(g-m,0)*Math.max(v-p,0);return y/(f+h-y)}function l9(t){var e=bt(Ri(t,[1,0])),n=[Ct(e[2],e[0]),Ct(e[3],e[1])],r=[Te(e[0],cr(n[0],re(2))),Te(e[1],cr(n[1],re(2)))];return{sizes:n,centers:r}}function d9(t,e){var n=l9(t),r=n.sizes,o=n.centers,i=bt(Ri(e,[1,0])),a=cr(Yt(Qv(cr(i[2],re(5))),r[0]),re(2)),s=Te(Yt(cr(i[0],re(10)),r[0]),o[0]),u=cr(Yt(Qv(cr(i[3],re(5))),r[1]),re(2)),c=Te(Yt(cr(i[1],re(10)),r[1]),o[1]);return Ri(Mn([Ct(s,a),Ct(c,u),Te(s,a),Te(c,u)]),[1,0])}function f9(t,e,n){return se(function(){var r=t.shape[0],o=d9(fr(bs(n.extra_dim,[r,1,1]),[-1,4]),fr(t,[-1,4]));o=fr(o,[r,o.shape[0]/r,4]);var i=xR(Kr(e,[0,0,1],[-1,-1,-1])),a=Kr(i,[0,0,0],[-1,-1,1]);a=fr(a,[r,a.shape[1]]);var s=bt(o),u=bt(a);return{boxes:s,scores:u}})}function za(t,e){return se(function(){var n=t.shape[0],r=fr(mr(t,e.box_encoding_predictor),[n,-1,1,4]),o=fr(mr(t,e.class_predictor),[n,-1,3]);return{boxPredictionEncoding:r,classPrediction:o}})}function h9(t,e,n){return se(function(){var r=Ir(t,n.conv_0,[1,1]),o=Ir(r,n.conv_1,[2,2]),i=Ir(o,n.conv_2,[1,1]),a=Ir(i,n.conv_3,[2,2]),s=Ir(a,n.conv_4,[1,1]),u=Ir(s,n.conv_5,[2,2]),c=Ir(u,n.conv_6,[1,1]),l=Ir(c,n.conv_7,[2,2]),d=za(e,n.box_predictor_0),f=za(t,n.box_predictor_1),h=za(o,n.box_predictor_2),m=za(a,n.box_predictor_3),p=za(u,n.box_predictor_4),g=za(l,n.box_predictor_5),v=wt([d.boxPredictionEncoding,f.boxPredictionEncoding,h.boxPredictionEncoding,m.boxPredictionEncoding,p.boxPredictionEncoding,g.boxPredictionEncoding],1),y=wt([d.classPrediction,f.classPrediction,h.classPrediction,m.classPrediction,p.classPrediction,g.classPrediction],1);return{boxPredictions:v,classPredictions:y}})}var Bh=function(){function t(e){var n=e===void 0?{}:e,r=n.minConfidence,o=n.maxResults;if(this._name="SsdMobilenetv1Options",this._minConfidence=r||.5,this._maxResults=o||100,typeof this._minConfidence!="number"||this._minConfidence<=0||this._minConfidence>=1)throw new Error(this._name+" - expected minConfidence to be a number between 0 and 1");if(typeof this._maxResults!="number")throw new Error(this._name+" - expected maxResults to be a number")}return Object.defineProperty(t.prototype,"minConfidence",{get:function(){return this._minConfidence},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxResults",{get:function(){return this._maxResults},enumerable:!0,configurable:!0}),t}(),NT=function(t){Ee(e,t);function e(){return t.call(this,"SsdMobilenetv1")||this}return e.prototype.forwardInput=function(n){var r=this.params;if(!r)throw new Error("SsdMobilenetv1 - load model before inference");return se(function(){var o=n.toBatchTensor(512,!1).toFloat(),i=Ct(Yt(o,re(.007843137718737125)),re(1)),a=s9(i,r.mobilenetv1),s=h9(a.out,a.conv11,r.prediction_layer),u=s.boxPredictions,c=s.classPredictions;return f9(u,c,r.output_layer)})},e.prototype.forward=function(n){return he(this,void 0,void 0,function(){var r;return pe(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,Dt(n)];case 1:return[2,r.apply(this,[o.sent()])]}})})},e.prototype.locateFaces=function(n,r){return r===void 0&&(r={}),he(this,void 0,void 0,function(){var o,i,a,s,u,c,l,d,f,h,m,p,g,v,y,x,b,E,_,S,k;return pe(this,function(R){switch(R.label){case 0:return o=new Bh(r),i=o.maxResults,a=o.minConfidence,[4,Dt(n)];case 1:for(s=R.sent(),u=this.forwardInput(s),c=u.boxes,l=u.scores,d=c[0],f=l[0],h=1;h<c.length;h++)c[h].dispose(),l[h].dispose();return g=(p=Array).from,[4,f.data()];case 2:return m=g.apply(p,[R.sent()]),v=.5,y=u9(d,m,i,v,a),x=s.getReshapedInputDimensions(0),b=s.inputSize,E=b/x.width,_=b/x.height,S=d.arraySync(),k=y.map(function(I){var D=[Math.max(0,S[I][0]),Math.min(1,S[I][2])].map(function(U){return U*_}),A=D[0],W=D[1],F=[Math.max(0,S[I][1]),Math.min(1,S[I][3])].map(function(U){return U*E}),$=F[0],j=F[1];return new Zr(m[I],new E0($,A,j-$,W-A),{height:s.getInputHeight(0),width:s.getInputWidth(0)})}),d.dispose(),f.dispose(),[2,k]}})})},e.prototype.getDefaultModelName=function(){return"ssd_mobilenetv1_model"},e.prototype.extractParamsFromWeigthMap=function(n){return r9(n)},e.prototype.extractParams=function(n){return t9(n)},e}(Po);(function(t){Ee(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e})(NT);var p9=.4,m9=[new je(.738768,.874946),new je(2.42204,2.65704),new je(4.30971,7.04493),new je(10.246,4.59428),new je(12.6868,11.8741)],v9=[new je(1.603231,2.094468),new je(6.041143,7.080126),new je(2.882459,3.518061),new je(4.266906,5.178857),new je(9.041765,10.66308)],g9=[117.001,114.697,97.404],y9="tiny_yolov2_model",x9="tiny_yolov2_separable_conv_model",ed=function(t){return typeof t=="number"};function w9(t){if(!t)throw new Error("invalid config: "+t);if(typeof t.withSeparableConvs!="boolean")throw new Error("config.withSeparableConvs has to be a boolean, have: "+t.withSeparableConvs);if(!ed(t.iouThreshold)||t.iouThreshold<0||t.iouThreshold>1)throw new Error("config.iouThreshold has to be a number between [0, 1], have: "+t.iouThreshold);if(!Array.isArray(t.classes)||!t.classes.length||!t.classes.every(function(e){return typeof e=="string"}))throw new Error("config.classes has to be an array class names: string[], have: "+JSON.stringify(t.classes));if(!Array.isArray(t.anchors)||!t.anchors.length||!t.anchors.map(function(e){return e||{}}).every(function(e){return ed(e.x)&&ed(e.y)}))throw new Error("config.anchors has to be an array of { x: number, y: number }, have: "+JSON.stringify(t.anchors));if(t.meanRgb&&(!Array.isArray(t.meanRgb)||t.meanRgb.length!==3||!t.meanRgb.every(ed)))throw new Error("config.meanRgb has to be an array of shape [number, number, number], have: "+JSON.stringify(t.meanRgb))}function D0(t){return se(function(){var e=Yt(t,re(.10000000149011612));return Te(rt(Ct(t,e)),e)})}function $o(t,e){return se(function(){var n=Ta(t,[[0,0],[1,1],[1,1],[0,0]]);return n=Yn(n,e.conv.filters,[1,1],"valid"),n=Ct(n,e.bn.sub),n=Yt(n,e.bn.truediv),n=Te(n,e.conv.bias),D0(n)})}function zo(t,e){return se(function(){var n=Ta(t,[[0,0],[1,1],[1,1],[0,0]]);return n=c0(n,e.depthwise_filter,e.pointwise_filter,[1,1],"valid"),n=Te(n,e.bias),D0(n)})}function b9(t,e){var n=Lh(t,e);function r(a,s){var u=ht(t(a)),c=ht(t(a));return e.push({paramPath:s+"/sub"},{paramPath:s+"/truediv"}),{sub:u,truediv:c}}function o(a,s,u){var c=n(a,s,3,u+"/conv"),l=r(s,u+"/bn");return{conv:c,bn:l}}var i=T0(t,e);return{extractConvParams:n,extractConvWithBatchNormParams:o,extractSeparableConvParams:i}}function E9(t,e,n,r){var o=Mo(t),i=o.extractWeights,a=o.getRemainingWeights,s=[],u=b9(i,s),c=u.extractConvParams,l=u.extractConvWithBatchNormParams,d=u.extractSeparableConvParams,f;if(e.withSeparableConvs){var h=r[0],m=r[1],p=r[2],g=r[3],v=r[4],y=r[5],x=r[6],b=r[7],E=r[8],_=e.isFirstLayerConv2d?c(h,m,3,"conv0"):d(h,m,"conv0"),S=d(m,p,"conv1"),k=d(p,g,"conv2"),R=d(g,v,"conv3"),I=d(v,y,"conv4"),D=d(y,x,"conv5"),A=b?d(x,b,"conv6"):void 0,W=E?d(b,E,"conv7"):void 0,F=c(E||b||x,5*n,1,"conv8");f={conv0:_,conv1:S,conv2:k,conv3:R,conv4:I,conv5:D,conv6:A,conv7:W,conv8:F}}else{var h=r[0],m=r[1],p=r[2],g=r[3],v=r[4],y=r[5],x=r[6],b=r[7],E=r[8],_=l(h,m,"conv0"),S=l(m,p,"conv1"),k=l(p,g,"conv2"),R=l(g,v,"conv3"),I=l(v,y,"conv4"),D=l(y,x,"conv5"),A=l(x,b,"conv6"),W=l(b,E,"conv7"),F=c(E,5*n,1,"conv8");f={conv0:_,conv1:S,conv2:k,conv3:R,conv4:I,conv5:D,conv6:A,conv7:W,conv8:F}}if(a().length!==0)throw new Error("weights remaing after extract: "+a().length);return{params:f,paramMappings:s}}function C9(t,e){var n=Bi(t,e);function r(s){var u=n(s+"/sub",1),c=n(s+"/truediv",1);return{sub:u,truediv:c}}function o(s){var u=n(s+"/filters",4),c=n(s+"/bias",1);return{filters:u,bias:c}}function i(s){var u=o(s+"/conv"),c=r(s+"/bn");return{conv:u,bn:c}}var a=N0(n);return{extractConvParams:o,extractConvWithBatchNormParams:i,extractSeparableConvParams:a}}function _9(t,e){var n=[],r=C9(t,n),o=r.extractConvParams,i=r.extractConvWithBatchNormParams,a=r.extractSeparableConvParams,s;if(e.withSeparableConvs){var u=e.filterSizes&&e.filterSizes.length||9;s={conv0:e.isFirstLayerConv2d?o("conv0"):a("conv0"),conv1:a("conv1"),conv2:a("conv2"),conv3:a("conv3"),conv4:a("conv4"),conv5:a("conv5"),conv6:u>7?a("conv6"):void 0,conv7:u>8?a("conv7"):void 0,conv8:o("conv8")}}else s={conv0:i("conv0"),conv1:i("conv1"),conv2:i("conv2"),conv3:i("conv3"),conv4:i("conv4"),conv5:i("conv5"),conv6:i("conv6"),conv7:i("conv7"),conv8:o("conv8")};return Do(t,n),{params:s,paramMappings:n}}var Kb;(function(t){t[t.XS=224]="XS",t[t.SM=320]="SM",t[t.MD=416]="MD",t[t.LG=608]="LG"})(Kb||(Kb={}));var M0=function(){function t(e){var n=e===void 0?{}:e,r=n.inputSize,o=n.scoreThreshold;if(this._name="TinyYolov2Options",this._inputSize=r||416,this._scoreThreshold=o||.5,typeof this._inputSize!="number"||this._inputSize%32!==0)throw new Error(this._name+" - expected inputSize to be a number divisible by 32");if(typeof this._scoreThreshold!="number"||this._scoreThreshold<=0||this._scoreThreshold>=1)throw new Error(this._name+" - expected scoreThreshold to be a number between 0 and 1")}return Object.defineProperty(t.prototype,"inputSize",{get:function(){return this._inputSize},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scoreThreshold",{get:function(){return this._scoreThreshold},enumerable:!0,configurable:!0}),t}(),AT=function(t){Ee(e,t);function e(n){var r=t.call(this,"TinyYolov2")||this;return w9(n),r._config=n,r}return Object.defineProperty(e.prototype,"config",{get:function(){return this._config},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"withClassScores",{get:function(){return this.config.withClassScores||this.config.classes.length>1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"boxEncodingSize",{get:function(){return 5+(this.withClassScores?this.config.classes.length:0)},enumerable:!0,configurable:!0}),e.prototype.runTinyYolov2=function(n,r){var o=$o(n,r.conv0);return o=Rt(o,[2,2],[2,2],"same"),o=$o(o,r.conv1),o=Rt(o,[2,2],[2,2],"same"),o=$o(o,r.conv2),o=Rt(o,[2,2],[2,2],"same"),o=$o(o,r.conv3),o=Rt(o,[2,2],[2,2],"same"),o=$o(o,r.conv4),o=Rt(o,[2,2],[2,2],"same"),o=$o(o,r.conv5),o=Rt(o,[2,2],[1,1],"same"),o=$o(o,r.conv6),o=$o(o,r.conv7),mr(o,r.conv8,"valid",!1)},e.prototype.runMobilenet=function(n,r){var o=this.config.isFirstLayerConv2d?D0(mr(n,r.conv0,"valid",!1)):zo(n,r.conv0);return o=Rt(o,[2,2],[2,2],"same"),o=zo(o,r.conv1),o=Rt(o,[2,2],[2,2],"same"),o=zo(o,r.conv2),o=Rt(o,[2,2],[2,2],"same"),o=zo(o,r.conv3),o=Rt(o,[2,2],[2,2],"same"),o=zo(o,r.conv4),o=Rt(o,[2,2],[2,2],"same"),o=zo(o,r.conv5),o=Rt(o,[2,2],[1,1],"same"),o=r.conv6?zo(o,r.conv6):o,o=r.conv7?zo(o,r.conv7):o,mr(o,r.conv8,"valid",!1)},e.prototype.forwardInput=function(n,r){var o=this,i=this.params;if(!i)throw new Error("TinyYolov2 - load model before inference");return se(function(){var a=n.toBatchTensor(r,!1).toFloat();return a=o.config.meanRgb?ll(a,o.config.meanRgb):a,a=a.div(re(256)),o.config.withSeparableConvs?o.runMobilenet(a,i):o.runTinyYolov2(a,i)})},e.prototype.forward=function(n,r){return he(this,void 0,void 0,function(){var o;return pe(this,function(i){switch(i.label){case 0:return o=this.forwardInput,[4,Dt(n)];case 1:return[4,o.apply(this,[i.sent(),r])];case 2:return[2,i.sent()]}})})},e.prototype.detect=function(n,r){return r===void 0&&(r={}),he(this,void 0,void 0,function(){var o,i,a,s,u,c,l,d,f,h,m,p,g,v,y=this;return pe(this,function(x){switch(x.label){case 0:return o=new M0(r),i=o.inputSize,a=o.scoreThreshold,[4,Dt(n)];case 1:return s=x.sent(),[4,this.forwardInput(s,i)];case 2:return u=x.sent(),c=se(function(){return bt(u)[0].expandDims()}),l={width:s.getInputWidth(0),height:s.getInputHeight(0)},[4,this.extractBoxes(c,s.getReshapedInputDimensions(0),a)];case 3:return d=x.sent(),u.dispose(),c.dispose(),f=d.map(function(b){return b.box}),h=d.map(function(b){return b.score}),m=d.map(function(b){return b.classScore}),p=d.map(function(b){return y.config.classes[b.label]}),g=Pc(f.map(function(b){return b.rescale(i)}),h,this.config.iouThreshold,!0),v=g.map(function(b){return new rT(h[b],m[b],p[b],f[b],l)}),[2,v]}})})},e.prototype.getDefaultModelName=function(){return""},e.prototype.extractParamsFromWeigthMap=function(n){return _9(n,this.config)},e.prototype.extractParams=function(n){var r=this.config.filterSizes||e.DEFAULT_FILTER_SIZES,o=r?r.length:void 0;if(o!==7&&o!==8&&o!==9)throw new Error("TinyYolov2 - expected 7 | 8 | 9 convolutional filters, but found "+o+" filterSizes in config");return E9(n,this.config,this.boxEncodingSize,r)},e.prototype.extractBoxes=function(n,r,o){return he(this,void 0,void 0,function(){var i,a,s,u,c,l,d,f,h,m,p,g,v,y,x,b,E,_,S,k,R,I,D,A,W,F,$,j,U,M=this;return pe(this,function(P){switch(P.label){case 0:return i=r.width,a=r.height,s=Math.max(i,a),u=s/i,c=s/a,l=n.shape[1],d=this.config.anchors.length,f=se(function(){var B=n.reshape([l,l,d,M.boxEncodingSize]),V=B.slice([0,0,0,0],[l,l,d,4]),K=B.slice([0,0,0,4],[l,l,d,1]),Q=M.withClassScores?No(B.slice([0,0,0,5],[l,l,d,M.config.classes.length]),3):re(0);return[V,K,Q]}),h=f[0],m=f[1],p=f[2],g=[],[4,m.array()];case 1:return v=P.sent(),[4,h.array()];case 2:y=P.sent(),x=0,P.label=3;case 3:if(!(x<l))return[3,12];b=0,P.label=4;case 4:if(!(b<l))return[3,11];E=0,P.label=5;case 5:return E<d?(_=dm(v[x][b][E][0]),!o||_>o?(S=(b+dm(y[x][b][E][0]))/l*u,k=(x+dm(y[x][b][E][1]))/l*c,R=Math.exp(y[x][b][E][2])*this.config.anchors[E].x/l*u,I=Math.exp(y[x][b][E][3])*this.config.anchors[E].y/l*c,D=S-R/2,A=k-I/2,W={row:x,col:b,anchor:E},this.withClassScores?[4,this.extractPredictedClass(p,W)]:[3,7]):[3,9]):[3,10];case 6:return U=P.sent(),[3,8];case 7:U={classScore:1,label:0},P.label=8;case 8:F=U,$=F.classScore,j=F.label,g.push(Kt({box:new Oh(D,A,D+R,A+I),score:_,classScore:_*$,label:j},W)),P.label=9;case 9:return E++,[3,5];case 10:return b++,[3,4];case 11:return x++,[3,3];case 12:return h.dispose(),m.dispose(),p.dispose(),[2,g]}})})},e.prototype.extractPredictedClass=function(n,r){return he(this,void 0,void 0,function(){var o,i,a,s;return pe(this,function(u){switch(u.label){case 0:return o=r.row,i=r.col,a=r.anchor,[4,n.array()];case 1:return s=u.sent(),[2,Array(this.config.classes.length).fill(0).map(function(c,l){return s[o][i][a][l]}).map(function(c,l){return{classScore:c,label:l}}).reduce(function(c,l){return c.classScore>l.classScore?c:l})]}})})},e.DEFAULT_FILTER_SIZES=[3,16,32,64,128,256,512,1024,1024],e}(Po),S9=function(t){Ee(e,t);function e(n){n===void 0&&(n=!0);var r=this,o=Object.assign({},{withSeparableConvs:n,iouThreshold:p9,classes:["face"]},n?{anchors:v9,meanRgb:g9}:{anchors:m9,withClassScores:!0});return r=t.call(this,o)||this,r}return Object.defineProperty(e.prototype,"withSeparableConvs",{get:function(){return this.config.withSeparableConvs},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"anchors",{get:function(){return this.config.anchors},enumerable:!0,configurable:!0}),e.prototype.locateFaces=function(n,r){return he(this,void 0,void 0,function(){var o;return pe(this,function(i){switch(i.label){case 0:return[4,this.detect(n,r)];case 1:return o=i.sent(),[2,o.map(function(a){return new Zr(a.score,a.relativeBox,{width:a.imageWidth,height:a.imageHeight})})]}})})},e.prototype.getDefaultModelName=function(){return this.withSeparableConvs?x9:y9},e.prototype.extractParamsFromWeigthMap=function(n){return t.prototype.extractParamsFromWeigthMap.call(this,n)},e}(AT),PT=function(t){Ee(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n._name="TinyFaceDetectorOptions",n}return e}(M0),dl=function(){function t(){}return t.prototype.then=function(e){return he(this,void 0,void 0,function(){var n;return pe(this,function(r){switch(r.label){case 0:return n=e,[4,this.run()];case 1:return[2,n.apply(void 0,[r.sent()])]}})})},t.prototype.run=function(){return he(this,void 0,void 0,function(){return pe(this,function(e){throw new Error("ComposableTask - run is not implemented")})})},t}();function jh(t,e,n,r,o){return o===void 0&&(o=function(i){var a=i.alignedRect;return a}),he(this,void 0,void 0,function(){var i,a,s,u,c;return pe(this,function(l){switch(l.label){case 0:return i=t.map(function(d){return DG(d)?o(d):d.detection}),s=r,s?[3,5]:e instanceof nt?[4,I0(e,i)]:[3,2];case 1:return u=l.sent(),[3,4];case 2:return[4,k0(e,i)];case 3:u=l.sent(),l.label=4;case 4:s=u,l.label=5;case 5:return a=s,[4,n(a)];case 6:return c=l.sent(),a.forEach(function(d){return d instanceof nt&&d.dispose()}),[2,c]}})})}function O0(t,e,n,r,o){return he(this,void 0,void 0,function(){var i=this;return pe(this,function(a){return[2,jh([t],e,function(s){return he(i,void 0,void 0,function(){return pe(this,function(u){return[2,n(s[0])]})})},r,o)]})})}function k9(t){return se(function(){return Mn(bt(t,3).reverse(),3)})}var td=2,Lf=12;function I9(t,e){var n=Lh(t,e),r=R0(t,e);function o(c,l){var d=ht(t(c));return e.push({paramPath:l}),d}function i(c,l,d){d===void 0&&(d=!1);var f=n(c[0],c[1],3,l+"/conv1"),h=o(c[1],l+"/prelu1_alpha"),m=n(c[1],c[2],3,l+"/conv2"),p=o(c[2],l+"/prelu2_alpha"),g=n(c[2],c[3],d?2:3,l+"/conv3"),v=o(c[3],l+"/prelu3_alpha");return{conv1:f,prelu1_alpha:h,conv2:m,prelu2_alpha:p,conv3:g,prelu3_alpha:v}}function a(){var c=i([3,10,16,32],"pnet"),l=n(32,2,1,"pnet/conv4_1"),d=n(32,4,1,"pnet/conv4_2");return Kt(Kt({},c),{conv4_1:l,conv4_2:d})}function s(){var c=i([3,28,48,64],"rnet",!0),l=r(576,128,"rnet/fc1"),d=o(128,"rnet/prelu4_alpha"),f=r(128,2,"rnet/fc2_1"),h=r(128,4,"rnet/fc2_2");return Kt(Kt({},c),{fc1:l,prelu4_alpha:d,fc2_1:f,fc2_2:h})}function u(){var c=i([3,32,64,64],"onet"),l=n(64,128,2,"onet/conv4"),d=o(128,"onet/prelu4_alpha"),f=r(1152,256,"onet/fc1"),h=o(256,"onet/prelu5_alpha"),m=r(256,2,"onet/fc2_1"),p=r(256,4,"onet/fc2_2"),g=r(256,10,"onet/fc2_3");return Kt(Kt({},c),{conv4:l,prelu4_alpha:d,fc1:f,prelu5_alpha:h,fc2_1:m,fc2_2:p,fc2_3:g})}return{extractPNetParams:a,extractRNetParams:s,extractONetParams:u}}function R9(t){var e=Mo(t),n=e.extractWeights,r=e.getRemainingWeights,o=[],i=I9(n,o),a=i.extractPNetParams,s=i.extractRNetParams,u=i.extractONetParams,c=a(),l=s(),d=u();if(r().length!==0)throw new Error("weights remaing after extract: "+r().length);return{params:{pnet:c,rnet:l,onet:d},paramMappings:o}}function T9(t,e){var n=Bi(t,e);function r(l){var d=n(l+"/weights",4,l+"/filters"),f=n(l+"/bias",1);return{filters:d,bias:f}}function o(l){var d=n(l+"/weights",2),f=n(l+"/bias",1);return{weights:d,bias:f}}function i(l){return n(l,1)}function a(l){var d=r(l+"/conv1"),f=i(l+"/prelu1_alpha"),h=r(l+"/conv2"),m=i(l+"/prelu2_alpha"),p=r(l+"/conv3"),g=i(l+"/prelu3_alpha");return{conv1:d,prelu1_alpha:f,conv2:h,prelu2_alpha:m,conv3:p,prelu3_alpha:g}}function s(){var l=a("pnet"),d=r("pnet/conv4_1"),f=r("pnet/conv4_2");return Kt(Kt({},l),{conv4_1:d,conv4_2:f})}function u(){var l=a("rnet"),d=o("rnet/fc1"),f=i("rnet/prelu4_alpha"),h=o("rnet/fc2_1"),m=o("rnet/fc2_2");return Kt(Kt({},l),{fc1:d,prelu4_alpha:f,fc2_1:h,fc2_2:m})}function c(){var l=a("onet"),d=r("onet/conv4"),f=i("onet/prelu4_alpha"),h=o("onet/fc1"),m=i("onet/prelu5_alpha"),p=o("onet/fc2_1"),g=o("onet/fc2_2"),v=o("onet/fc2_3");return Kt(Kt({},l),{conv4:d,prelu4_alpha:f,fc1:h,prelu5_alpha:m,fc2_1:p,fc2_2:g,fc2_3:v})}return{extractPNetParams:s,extractRNetParams:u,extractONetParams:c}}function N9(t){var e=[],n=T9(t,e),r=n.extractPNetParams,o=n.extractRNetParams,i=n.extractONetParams,a=r(),s=o(),u=i();return Do(t,e),{params:{pnet:a,rnet:s,onet:u},paramMappings:e}}function ig(t,e){var n=e[0],r=e[1];return{height:Math.floor(n*t),width:Math.floor(r*t)}}function A9(t,e,n){for(var r=n[0],o=n[1],i=Lf/t,a=[],s=Math.min(r,o)*i,u=0;s>=12;)a.push(i*Math.pow(e,u)),s=s*e,u+=1;return a}var F0=function(t){Ee(e,t);function e(n,r,o,i){return t.call(this,{left:n,top:r,right:o,bottom:i},!0)||this}return e}(Ti);function DT(t){return se(function(){return Yt(Ct(t,re(127.5)),re(.0078125))})}function Is(t,e){return se(function(){return Te(rt(t),Yt(e,Nf(rt(Nf(t)))))})}function L0(t,e,n){return n===void 0&&(n=!1),se(function(){var r=mr(t,e.conv1,"valid");return r=Is(r,e.prelu1_alpha),r=Rt(r,n?[2,2]:[3,3],[2,2],"same"),r=mr(r,e.conv2,"valid"),r=Is(r,e.prelu2_alpha),r=n?r:Rt(r,[3,3],[2,2],"valid"),r=mr(r,e.conv3,"valid"),r=Is(r,e.prelu3_alpha),r})}function P9(t,e){return se(function(){var n=L0(t,e,!0),r=mr(n,e.conv4_1,"valid"),o=Wn(Ah(r,3),3),i=No(Ct(r,o),3),a=mr(n,e.conv4_2,"valid");return{prob:i,regions:a}})}function D9(t,e){return se(function(){var n=ig(e,t.shape.slice(1)),r=n.height,o=n.width,i=p0.resizeBilinear(t,[r,o]),a=DT(i);return Ri(a,[0,2,1,3])})}function M9(t,e,n,r){for(var o=[],i=t.arraySync(),a=0;a<t.shape[0];a++)for(var s=0;s<t.shape[1];s++)i[a][s]>=r&&o.push(new je(s,a));var u=o.map(function(c){var l=new Oh(Math.round((c.y*td+1)/n),Math.round((c.x*td+1)/n),Math.round((c.y*td+Lf)/n),Math.round((c.x*td+Lf)/n)),d=i[c.y][c.x],f=e.arraySync(),h=new F0(f[c.y][c.x][0],f[c.y][c.x][1],f[c.y][c.x][2],f[c.y][c.x][3]);return{cell:l,score:d,region:h}});return u}function O9(t,e,n,r,o){o.stage1=[];var i=e.map(function(f){return se(function(){var h={scale:f},m=D9(t,f),p=Date.now(),g=P9(m,r),v=g.prob,y=g.regions;h.pnet=Date.now()-p;var x=bt(bt(v,3)[1])[0],b=bt(y)[0];return{scoresTensor:x,regionsTensor:b,scale:f,statsForScale:h}})}),a=i.map(function(f){var h=f.scoresTensor,m=f.regionsTensor,p=f.scale,g=f.statsForScale,v=M9(h,m,p,n);if(h.dispose(),m.dispose(),!v.length)return o.stage1.push(g),[];var y=Date.now(),x=Pc(v.map(function(b){return b.cell}),v.map(function(b){return b.score}),.5);return g.nms=Date.now()-y,g.numBoxes=x.length,o.stage1.push(g),x.map(function(b){return v[b]})}),s=a.reduce(function(f,h){return f.concat(h)},[]),u=[],c=[];if(s.length>0){var l=Date.now(),d=Pc(s.map(function(f){return f.cell}),s.map(function(f){return f.score}),.7);o.stage1_nms=Date.now()-l,c=d.map(function(f){return s[f].score}),u=d.map(function(f){return s[f]}).map(function(f){var h=f.cell,m=f.region;return new Oh(h.left+m.left*h.width,h.top+m.top*h.height,h.right+m.right*h.width,h.bottom+m.bottom*h.height).toSquare().round()})}return{boxes:u,scores:c}}function MT(t,e,n){var r=n.width,o=n.height;return he(this,void 0,void 0,function(){var i,a,s,u=this;return pe(this,function(c){switch(c.label){case 0:return i=wa(t),[4,Promise.all(e.map(function(l){return he(u,void 0,void 0,function(){var d,f,h,m,p,g,v,y;return pe(this,function(x){return d=l.padAtBorders(t.height,t.width),f=d.y,h=d.ey,m=d.x,p=d.ex,g=m-1,v=f-1,y=i.getImageData(g,v,p-g,h-v),[2,Jt.isNodejs()?S0(y):createImageBitmap(y)]})})}))];case 1:return a=c.sent(),s=[],a.forEach(function(l){var d=Fh({width:r,height:o}),f=wa(d);f.drawImage(l,0,0,r,o);for(var h=f.getImageData(0,0,r,o).data,m=[],p=0;p<h.length;p+=4)m.push(h[p+2]),m.push(h[p+1]),m.push(h[p]);s.push(m)}),[2,s.map(function(l){var d=se(function(){var f=Ri(fn(l,[1,r,o,3]),[0,2,1,3]).toFloat();return DT(f)});return d})]}})})}function F9(t,e){return se(function(){var n=L0(t,e),r=fr(n,[n.shape[0],e.fc1.weights.shape[0]]),o=Lr(r,e.fc1),i=Is(o,e.prelu4_alpha),a=Lr(i,e.fc2_1),s=Wn(Ah(a,1),1),u=No(Ct(a,s),1),c=Lr(i,e.fc2_2),l=bt(u,1)[1];return{scores:l,regions:c}})}function L9(t,e,n,r,o){return he(this,void 0,void 0,function(){var i,a,s,u,c,l,d,f,h,m,p,g,v,y;return pe(this,function(x){switch(x.label){case 0:return i=Date.now(),[4,MT(t,e,{width:24,height:24})];case 1:return a=x.sent(),o.stage2_extractImagePatches=Date.now()-i,i=Date.now(),s=a.map(function(b){var E=F9(b,r);return b.dispose(),E}),o.stage2_rnet=Date.now()-i,u=s.length>1?wt(s.map(function(b){return b.scores})):s[0].scores,d=(l=Array).from,[4,u.data()];case 2:return c=d.apply(l,[x.sent()]),u.dispose(),f=c.map(function(b,E){return{score:b,idx:E}}).filter(function(b){return b.score>n}).map(function(b){var E=b.idx;return E}),h=f.map(function(b){return e[b]}),m=f.map(function(b){return c[b]}),p=[],g=[],h.length>0&&(i=Date.now(),v=Pc(h,m,.7),o.stage2_nms=Date.now()-i,y=v.map(function(b){var E=s[f[b]].regions.arraySync();return new F0(E[0][0],E[0][1],E[0][2],E[0][3])}),g=v.map(function(b){return m[b]}),p=v.map(function(b,E){return h[b].calibrate(y[E])})),s.forEach(function(b){b.regions.dispose(),b.scores.dispose()}),[2,{boxes:p,scores:g}]}})})}function B9(t,e){return se(function(){var n=L0(t,e);n=Rt(n,[2,2],[2,2],"same"),n=mr(n,e.conv4,"valid"),n=Is(n,e.prelu4_alpha);var r=fr(n,[n.shape[0],e.fc1.weights.shape[0]]),o=Lr(r,e.fc1),i=Is(o,e.prelu5_alpha),a=Lr(i,e.fc2_1),s=Wn(Ah(a,1),1),u=No(Ct(a,s),1),c=Lr(i,e.fc2_2),l=Lr(i,e.fc2_3),d=bt(u,1)[1];return{scores:d,regions:c,points:l}})}function j9(t,e,n,r,o){return he(this,void 0,void 0,function(){var i,a,s,u,c,l,d,f,h,m,p,g,v,y,x;return pe(this,function(b){switch(b.label){case 0:return i=Date.now(),[4,MT(t,e,{width:48,height:48})];case 1:return a=b.sent(),o.stage3_extractImagePatches=Date.now()-i,i=Date.now(),s=a.map(function(E){var _=B9(E,r);return E.dispose(),_}),o.stage3_onet=Date.now()-i,u=s.length>1?wt(s.map(function(E){return E.scores})):s[0].scores,d=(l=Array).from,[4,u.data()];case 2:return c=d.apply(l,[b.sent()]),u.dispose(),f=c.map(function(E,_){return{score:E,idx:_}}).filter(function(E){return E.score>n}).map(function(E){var _=E.idx;return _}),h=f.map(function(E){var _=s[E].regions.arraySync();return new F0(_[0][0],_[0][1],_[0][2],_[0][3])}),m=f.map(function(E,_){return e[E].calibrate(h[_])}),p=f.map(function(E){return c[E]}),g=[],v=[],y=[],m.length>0&&(i=Date.now(),x=Pc(m,p,.7,!1),o.stage3_nms=Date.now()-i,g=x.map(function(E){return m[E]}),v=x.map(function(E){return p[E]}),y=x.map(function(E,_){return Array(5).fill(0).map(function(S,k){var R=s[E].points.arraySync();return new je(R[0][k]*(g[_].width+1)+g[_].left,R[0][k+5]*(g[_].height+1)+g[_].top)})})),s.forEach(function(E){E.regions.dispose(),E.scores.dispose(),E.points.dispose()}),[2,{boxes:g,scores:v,points:y}]}})})}var U9=function(t){Ee(e,t);function e(){return t.call(this,"Mtcnn")||this}return e.prototype.load=function(n){return he(this,void 0,void 0,function(){return pe(this,function(r){return console.warn("mtcnn is deprecated and will be removed soon"),[2,t.prototype.load.call(this,n)]})})},e.prototype.loadFromDisk=function(n){return he(this,void 0,void 0,function(){return pe(this,function(r){return console.warn("mtcnn is deprecated and will be removed soon"),[2,t.prototype.loadFromDisk.call(this,n)]})})},e.prototype.forwardInput=function(n,r){return r===void 0&&(r={}),he(this,void 0,void 0,function(){var o,i,a,s,u,c,l,d,f,h,m,p,g,v,y,x,b,E,_,S,k;return pe(this,function(R){switch(R.label){case 0:if(o=this.params,!o)throw new Error("Mtcnn - load model before inference");if(i=n.canvases[0],!i)throw new Error("Mtcnn - inputCanvas is not defined, note that passing tensors into Mtcnn.forwardInput is not supported yet.");return a={},s=Date.now(),u=se(function(){return k9(Wn(w0.fromPixels(i)).toFloat())}),c=function(I){return u.dispose(),a.total=Date.now()-s,I},l=u.shape.slice(1),d=l[0],f=l[1],h=new TT(r),m=h.minFaceSize,p=h.scaleFactor,g=h.maxNumScales,v=h.scoreThresholds,y=h.scaleSteps,x=(y||A9(m,p,[d,f])).filter(function(I){var D=ig(I,[d,f]);return Math.min(D.width,D.height)>Lf}).slice(0,g),a.scales=x,a.pyramid=x.map(function(I){return ig(I,[d,f])}),b=Date.now(),[4,O9(u,x,v[0],o.pnet,a)];case 1:return E=R.sent(),a.total_stage1=Date.now()-b,E.boxes.length?(a.stage2_numInputBoxes=E.boxes.length,b=Date.now(),[4,L9(i,E.boxes,v[1],o.rnet,a)]):[2,c({results:[],stats:a})];case 2:return _=R.sent(),a.total_stage2=Date.now()-b,_.boxes.length?(a.stage3_numInputBoxes=_.boxes.length,b=Date.now(),[4,j9(i,_.boxes,v[2],o.onet,a)]):[2,c({results:[],stats:a})];case 3:return S=R.sent(),a.total_stage3=Date.now()-b,k=S.boxes.map(function(I,D){return A0(C0({},new Zr(S.scores[D],new E0(I.left/f,I.top/d,I.width/f,I.height/d),{height:d,width:f})),new vG(S.points[D].map(function(A){return A.sub(new je(I.left,I.top)).div(new je(I.width,I.height))}),{width:I.width,height:I.height}))}),[2,c({results:k,stats:a})]}})})},e.prototype.forward=function(n,r){return r===void 0&&(r={}),he(this,void 0,void 0,function(){var o;return pe(this,function(i){switch(i.label){case 0:return o=this.forwardInput,[4,Dt(n)];case 1:return[4,o.apply(this,[i.sent(),r])];case 2:return[2,i.sent().results]}})})},e.prototype.forwardWithStats=function(n,r){return r===void 0&&(r={}),he(this,void 0,void 0,function(){var o;return pe(this,function(i){switch(i.label){case 0:return o=this.forwardInput,[4,Dt(n)];case 1:return[2,o.apply(this,[i.sent(),r])]}})})},e.prototype.getDefaultModelName=function(){return"mtcnn_model"},e.prototype.extractParamsFromWeigthMap=function(n){return N9(n)},e.prototype.extractParams=function(n){return R9(n)},e}(Po),W9=.4,$9=[new je(1.603231,2.094468),new je(6.041143,7.080126),new je(2.882459,3.518061),new je(4.266906,5.178857),new je(9.041765,10.66308)],z9=[117.001,114.697,97.404],V9=function(t){Ee(e,t);function e(){var n=this,r={withSeparableConvs:!0,iouThreshold:W9,classes:["face"],anchors:$9,meanRgb:z9,isFirstLayerConv2d:!0,filterSizes:[3,16,32,64,128,256,512]};return n=t.call(this,r)||this,n}return Object.defineProperty(e.prototype,"anchors",{get:function(){return this.config.anchors},enumerable:!0,configurable:!0}),e.prototype.locateFaces=function(n,r){return he(this,void 0,void 0,function(){var o;return pe(this,function(i){switch(i.label){case 0:return[4,this.detect(n,r)];case 1:return o=i.sent(),[2,o.map(function(a){return new Zr(a.score,a.relativeBox,{width:a.imageWidth,height:a.imageHeight})})]}})})},e.prototype.getDefaultModelName=function(){return"tiny_face_detector_model"},e.prototype.extractParamsFromWeigthMap=function(n){return t.prototype.extractParamsFromWeigthMap.call(this,n)},e}(AT),An={ssdMobilenetv1:new NT,tinyFaceDetector:new V9,tinyYolov2:new S9,mtcnn:new U9,faceLandmark68Net:new CT,faceLandmark68TinyNet:new GG,faceRecognitionNet:new ZG,faceExpressionNet:new PG,ageGenderNet:new $G},OT=function(t){Ee(e,t);function e(n,r,o){var i=t.call(this)||this;return i.parentTask=n,i.input=r,i.extractedFaces=o,i}return e}(dl),B0=function(t){Ee(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.run=function(){return he(this,void 0,void 0,function(){var n,r,o=this;return pe(this,function(i){switch(i.label){case 0:return[4,this.parentTask];case 1:return n=i.sent(),[4,jh(n,this.input,function(a){return he(o,void 0,void 0,function(){return pe(this,function(s){switch(s.label){case 0:return[4,Promise.all(a.map(function(u){return An.faceExpressionNet.predictExpressions(u)}))];case 1:return[2,s.sent()]}})})},this.extractedFaces)];case 2:return r=i.sent(),[2,n.map(function(a,s){return wT(a,r[s])})]}})})},e.prototype.withAgeAndGender=function(){return new $0(this,this.input)},e}(OT),j0=function(t){Ee(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.run=function(){return he(this,void 0,void 0,function(){var n,r;return pe(this,function(o){switch(o.label){case 0:return[4,this.parentTask];case 1:return n=o.sent(),n?[4,O0(n,this.input,function(i){return An.faceExpressionNet.predictExpressions(i)},this.extractedFaces)]:[2];case 2:return r=o.sent(),[2,wT(n,r)]}})})},e.prototype.withAgeAndGender=function(){return new z0(this,this.input)},e}(OT),U0=function(t){Ee(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.withAgeAndGender=function(){return new V0(this,this.input)},e.prototype.withFaceDescriptors=function(){return new G0(this,this.input)},e}(B0),W0=function(t){Ee(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.withAgeAndGender=function(){return new H0(this,this.input)},e.prototype.withFaceDescriptor=function(){return new K0(this,this.input)},e}(j0),FT=function(t){Ee(e,t);function e(n,r,o){var i=t.call(this)||this;return i.parentTask=n,i.input=r,i.extractedFaces=o,i}return e}(dl),$0=function(t){Ee(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.run=function(){return he(this,void 0,void 0,function(){var n,r,o=this;return pe(this,function(i){switch(i.label){case 0:return[4,this.parentTask];case 1:return n=i.sent(),[4,jh(n,this.input,function(a){return he(o,void 0,void 0,function(){return pe(this,function(s){switch(s.label){case 0:return[4,Promise.all(a.map(function(u){return An.ageGenderNet.predictAgeAndGender(u)}))];case 1:return[2,s.sent()]}})})},this.extractedFaces)];case 2:return r=i.sent(),[2,n.map(function(a,s){var u=r[s],c=u.age,l=u.gender,d=u.genderProbability;return IT(RT(a,l,d),c)})]}})})},e.prototype.withFaceExpressions=function(){return new B0(this,this.input)},e}(FT),z0=function(t){Ee(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.run=function(){return he(this,void 0,void 0,function(){var n,r,o,i,a;return pe(this,function(s){switch(s.label){case 0:return[4,this.parentTask];case 1:return n=s.sent(),n?[4,O0(n,this.input,function(u){return An.ageGenderNet.predictAgeAndGender(u)},this.extractedFaces)]:[2];case 2:return r=s.sent(),o=r.age,i=r.gender,a=r.genderProbability,[2,IT(RT(n,i,a),o)]}})})},e.prototype.withFaceExpressions=function(){return new j0(this,this.input)},e}(FT),V0=function(t){Ee(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.withFaceExpressions=function(){return new U0(this,this.input)},e.prototype.withFaceDescriptors=function(){return new G0(this,this.input)},e}($0),H0=function(t){Ee(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.withFaceExpressions=function(){return new W0(this,this.input)},e.prototype.withFaceDescriptor=function(){return new K0(this,this.input)},e}(z0),LT=function(t){Ee(e,t);function e(n,r){var o=t.call(this)||this;return o.parentTask=n,o.input=r,o}return e}(dl),G0=function(t){Ee(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.run=function(){return he(this,void 0,void 0,function(){var n,r;return pe(this,function(o){switch(o.label){case 0:return[4,this.parentTask];case 1:return n=o.sent(),[4,jh(n,this.input,function(i){return Promise.all(i.map(function(a){return An.faceRecognitionNet.computeFaceDescriptor(a)}))},null,function(i){return i.landmarks.align(null,{useDlibAlignment:!0})})];case 2:return r=o.sent(),[2,r.map(function(i,a){return kT(n[a],i)})]}})})},e.prototype.withFaceExpressions=function(){return new U0(this,this.input)},e.prototype.withAgeAndGender=function(){return new V0(this,this.input)},e}(LT),K0=function(t){Ee(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.run=function(){return he(this,void 0,void 0,function(){var n,r;return pe(this,function(o){switch(o.label){case 0:return[4,this.parentTask];case 1:return n=o.sent(),n?[4,O0(n,this.input,function(i){return An.faceRecognitionNet.computeFaceDescriptor(i)},null,function(i){return i.landmarks.align(null,{useDlibAlignment:!0})})]:[2];case 2:return r=o.sent(),[2,kT(n,r)]}})})},e.prototype.withFaceExpressions=function(){return new W0(this,this.input)},e.prototype.withAgeAndGender=function(){return new H0(this,this.input)},e}(LT),BT=function(t){Ee(e,t);function e(n,r,o){var i=t.call(this)||this;return i.parentTask=n,i.input=r,i.useTinyLandmarkNet=o,i}return Object.defineProperty(e.prototype,"landmarkNet",{get:function(){return this.useTinyLandmarkNet?An.faceLandmark68TinyNet:An.faceLandmark68Net},enumerable:!0,configurable:!0}),e}(dl),H9=function(t){Ee(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.run=function(){return he(this,void 0,void 0,function(){var n,r,o,i,a,s=this;return pe(this,function(u){switch(u.label){case 0:return[4,this.parentTask];case 1:return n=u.sent(),r=n.map(function(c){return c.detection}),this.input instanceof nt?[4,I0(this.input,r)]:[3,3];case 2:return i=u.sent(),[3,5];case 3:return[4,k0(this.input,r)];case 4:i=u.sent(),u.label=5;case 5:return o=i,[4,Promise.all(o.map(function(c){return s.landmarkNet.detectLandmarks(c)}))];case 6:return a=u.sent(),o.forEach(function(c){return c instanceof nt&&c.dispose()}),[2,n.map(function(c,l){return A0(c,a[l])})]}})})},e.prototype.withFaceExpressions=function(){return new U0(this,this.input)},e.prototype.withAgeAndGender=function(){return new V0(this,this.input)},e.prototype.withFaceDescriptors=function(){return new G0(this,this.input)},e}(BT),G9=function(t){Ee(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.run=function(){return he(this,void 0,void 0,function(){var n,r,o,i,a;return pe(this,function(s){switch(s.label){case 0:return[4,this.parentTask];case 1:return n=s.sent(),n?(r=n.detection,this.input instanceof nt?[4,I0(this.input,[r])]:[3,3]):[2];case 2:return i=s.sent(),[3,5];case 3:return[4,k0(this.input,[r])];case 4:i=s.sent(),s.label=5;case 5:return o=i,[4,this.landmarkNet.detectLandmarks(o[0])];case 6:return a=s.sent(),o.forEach(function(u){return u instanceof nt&&u.dispose()}),[2,A0(n,a)]}})})},e.prototype.withFaceExpressions=function(){return new W0(this,this.input)},e.prototype.withAgeAndGender=function(){return new H0(this,this.input)},e.prototype.withFaceDescriptor=function(){return new K0(this,this.input)},e}(BT),jT=function(t){Ee(e,t);function e(n,r){r===void 0&&(r=new Bh);var o=t.call(this)||this;return o.input=n,o.options=r,o}return e}(dl),UT=function(t){Ee(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.run=function(){return he(this,void 0,void 0,function(){var n,r,o,i;return pe(this,function(a){switch(a.label){case 0:return n=this,r=n.input,o=n.options,o instanceof TT?[4,An.mtcnn.forward(r,o)]:[3,2];case 1:return[2,a.sent().map(function(s){return s.detection})];case 2:if(i=o instanceof PT?function(s){return An.tinyFaceDetector.locateFaces(s,o)}:o instanceof Bh?function(s){return An.ssdMobilenetv1.locateFaces(s,o)}:o instanceof M0?function(s){return An.tinyYolov2.locateFaces(s,o)}:null,!i)throw new Error("detectFaces - expected options to be instance of TinyFaceDetectorOptions | SsdMobilenetv1Options | MtcnnOptions | TinyYolov2Options");return[2,i(r)]}})})},e.prototype.runAndExtendWithFaceDetections=function(){var n=this;return new Promise(function(r){return he(n,void 0,void 0,function(){var o;return pe(this,function(i){switch(i.label){case 0:return[4,this.run()];case 1:return o=i.sent(),[2,r(o.map(function(a){return C0({},a)}))]}})})})},e.prototype.withFaceLandmarks=function(n){return n===void 0&&(n=!1),new H9(this.runAndExtendWithFaceDetections(),this.input,n)},e.prototype.withFaceExpressions=function(){return new B0(this.runAndExtendWithFaceDetections(),this.input)},e.prototype.withAgeAndGender=function(){return new $0(this.runAndExtendWithFaceDetections(),this.input)},e}(jT);(function(t){Ee(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.run=function(){return he(this,void 0,void 0,function(){var n,r;return pe(this,function(o){switch(o.label){case 0:return[4,new UT(this.input,this.options)];case 1:return n=o.sent(),r=n[0],n.forEach(function(i){i.score>r.score&&(r=i)}),[2,r]}})})},e.prototype.runAndExtendWithFaceDetection=function(){var n=this;return new Promise(function(r){return he(n,void 0,void 0,function(){var o;return pe(this,function(i){switch(i.label){case 0:return[4,this.run()];case 1:return o=i.sent(),[2,r(o?C0({},o):void 0)]}})})})},e.prototype.withFaceLandmarks=function(n){return n===void 0&&(n=!1),new G9(this.runAndExtendWithFaceDetection(),this.input,n)},e.prototype.withFaceExpressions=function(){return new j0(this.runAndExtendWithFaceDetection(),this.input)},e.prototype.withAgeAndGender=function(){return new z0(this.runAndExtendWithFaceDetection(),this.input)},e})(jT);function K9(t,e){return e===void 0&&(e=new Bh),new UT(t,e)}function q9(t,e){if(t.length!==e.length)throw new Error("euclideanDistance: arr1.length !== arr2.length");var n=Array.from(t),r=Array.from(e);return Math.sqrt(n.map(function(o,i){return o-r[i]}).reduce(function(o,i){return o+Math.pow(i,2)},0))}(function(){function t(e,n){n===void 0&&(n=.6),this._distanceThreshold=n;var r=Array.isArray(e)?e:[e];if(!r.length)throw new Error("FaceRecognizer.constructor - expected atleast one input");var o=1,i=function(){return"person "+o++};this._labeledDescriptors=r.map(function(a){if(a instanceof Ql)return a;if(a instanceof Float32Array)return new Ql(i(),[a]);if(a.descriptor&&a.descriptor instanceof Float32Array)return new Ql(i(),[a.descriptor]);throw new Error("FaceRecognizer.constructor - expected inputs to be of type LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array | Array<LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array>")})}return Object.defineProperty(t.prototype,"labeledDescriptors",{get:function(){return this._labeledDescriptors},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"distanceThreshold",{get:function(){return this._distanceThreshold},enumerable:!0,configurable:!0}),t.prototype.computeMeanDistance=function(e,n){return n.map(function(r){return q9(r,e)}).reduce(function(r,o){return r+o},0)/(n.length||1)},t.prototype.matchDescriptor=function(e){var n=this;return this.labeledDescriptors.map(function(r){var o=r.descriptors,i=r.label;return new $b(i,n.computeMeanDistance(e,o))}).reduce(function(r,o){return r.distance<o.distance?r:o})},t.prototype.findBestMatch=function(e){var n=this.matchDescriptor(e);return n.distance<this.distanceThreshold?n:new $b("unknown",n.distance)},t.prototype.toJSON=function(){return{distanceThreshold:this.distanceThreshold,labeledDescriptors:this.labeledDescriptors.map(function(e){return e.toJSON()})}},t.fromJSON=function(e){var n=e.labeledDescriptors.map(function(r){return Ql.fromJSON(r)});return new t(n,e.distanceThreshold)},t})();const X9=(t=!0)=>{const e=C.useRef(null),n=C.useRef(null),[r,o]=C.useState({hasFace:!1,detections:0}),[i,a]=C.useState(!0),[s,u]=C.useState(!1),[c,l]=C.useState(!1),d=C.useRef(null),f=C.useRef(null);return C.useEffect(()=>{if(!t){a(!1);return}(async()=>{try{console.log(" Loading face-api.js models..."),await An.tinyFaceDetector.loadFromUri("/models"),console.log(" Face detection models loaded successfully!"),l(!0),a(!1)}catch(m){console.error(" Failed to load face detection models:",m);const p=m instanceof Error?m.message:String(m);o(g=>({...g,error:`Model loading failed: ${p}`})),a(!1)}})()},[t]),C.useEffect(()=>{if(!t||!e.current)return;const h=e.current;return console.log(" Requesting camera access..."),navigator.mediaDevices.getUserMedia({video:{width:{ideal:640},height:{ideal:480},facingMode:"user"}}).then(m=>{console.log(" Camera access granted:",m.getVideoTracks()[0].label),f.current=m,h.srcObject=m,h.onloadedmetadata=()=>{console.log(" Video metadata loaded"),h.play().then(()=>{console.log(" Video playing successfully"),u(!0)}).catch(p=>{console.error(" Video play error:",p),o(g=>({...g,error:"Video playback failed"}))})}}).catch(m=>{console.error(" Camera access error:",m.name,m.message),o(p=>({...p,error:m.name==="NotAllowedError"?"Camera access denied":m.name==="NotFoundError"?"No camera found":"Camera unavailable"}))}),()=>{f.current&&(console.log(" Stopping camera stream"),f.current.getTracks().forEach(m=>m.stop()),f.current=null)}},[t]),C.useEffect(()=>{if(!t||!c||!s||!e.current){console.log(" Waiting for:",{enabled:t,modelsLoaded:c,cameraReady:s,hasVideo:!!e.current});return}const h=e.current;console.log(" Starting face detection loop with face-api.js");const m=async()=>{try{if(h.readyState===h.HAVE_ENOUGH_DATA){const p=await K9(h,new PT({inputSize:224,scoreThreshold:.5}));o({hasFace:p.length>0,detections:p.length})}}catch(p){const g=p instanceof Error?p.message:String(p);console.error(" Face detection error:",g),o(v=>({...v,error:"Detection error"}))}};return d.current=window.setInterval(m,100),()=>{d.current&&(clearInterval(d.current),d.current=null)}},[t,c,s]),{videoRef:e,canvasRef:n,result:r,isLoading:i}},Y9=({onResult:t,onEnd:e,language:n="th-TH",continuous:r=!1}={})=>{const[o,i]=C.useState(!1),[a,s]=C.useState(""),[u,c]=C.useState(null),l=C.useRef(null),d=C.useRef(null),f=C.useRef([]),h=C.useRef(!1),m=C.useRef(t),p=C.useRef(e);C.useEffect(()=>{m.current=t,p.current=e},[t,e]);const g=C.useCallback(async b=>{try{console.log("[Whisper] Sending audio to backend...",b.size,"bytes");const E=new FormData;E.append("audio",b,"recording.webm");const _=await fetch("/api/speech-to-text",{method:"POST",body:E});if(!_.ok)throw new Error(`HTTP ${_.status}`);const S=await _.json();if(S.success&&S.text)console.log("[Whisper] Transcription:",S.text),s(S.text),m.current&&m.current(S.text);else throw new Error(S.error||"No transcription returned")}catch(E){console.error("[Whisper] Error:",E),c("")}finally{i(!1),p.current&&p.current()}},[]),v=C.useCallback(async()=>{try{console.log("[Whisper] Starting recording...");const b=await navigator.mediaDevices.getUserMedia({audio:!0}),E=new MediaRecorder(b,{mimeType:"audio/webm;codecs=opus"});f.current=[],E.ondataavailable=_=>{_.data.size>0&&f.current.push(_.data)},E.onstop=async()=>{if(console.log("[Whisper] Recording stopped, processing..."),b.getTracks().forEach(_=>_.stop()),f.current.length>0){const _=new Blob(f.current,{type:"audio/webm"});await g(_)}},E.start(),d.current=E,i(!0),s(""),c(null),console.log("[Whisper] Recording started")}catch(b){console.error("[Whisper] Failed to start recording:",b),c(""),i(!1)}},[g]);C.useEffect(()=>{const b=window.SpeechRecognition||window.webkitSpeechRecognition;if(b&&!h.current){const E=new b;E.continuous=r,E.interimResults=!0,E.lang=n,E.onstart=()=>{console.log("[SpeechRecognition] Started"),i(!0),c(null)},E.onresult=_=>{let S="",k="";for(let I=_.resultIndex;I<_.results.length;++I)_.results[I].isFinal?S+=_.results[I][0].transcript:k+=_.results[I][0].transcript;const R=S||k;console.log("[SpeechRecognition] Result:",{finalTranscript:S,interimTranscript:k}),s(R),m.current&&S&&(console.log("[SpeechRecognition] Calling onResult with:",S),m.current(S))},E.onerror=_=>{console.error("[SpeechRecognition] Error:",_.error),_.error==="network"||_.error==="service-not-allowed"?(console.log("[SpeechRecognition] Network error - switching to Whisper fallback"),h.current=!0,v()):_.error==="not-allowed"?(c(""),i(!1)):_.error!=="aborted"&&c(`: ${_.error}`)},E.onend=()=>{console.log("[SpeechRecognition] Ended"),!h.current&&(i(!1),p.current&&p.current())},l.current=E}else b||(console.warn("[SpeechRecognition] Not supported, will use Whisper fallback"),h.current=!0);return()=>{l.current&&l.current.abort()}},[n,r,v]);const y=C.useCallback(()=>{if(c(null),h.current){v();return}if(l.current&&!o)try{s(""),l.current.start()}catch(b){console.error("[SpeechRecognition] Failed to start:",b),h.current=!0,v()}else l.current||v()},[o,v]),x=C.useCallback(()=>{l.current&&o&&!h.current&&l.current.stop(),d.current&&d.current.state==="recording"&&(console.log("[Whisper] Stopping recording..."),d.current.stop())},[o]);return{isListening:o,transcript:a,error:u,startListening:y,stopListening:x,isUsingWhisper:h.current,hasSupport:!!(window.SpeechRecognition||window.webkitSpeechRecognition)||!0}};let pm=null,mm=!1;const qb=()=>{if(!pm){const t=window.AudioContext||window.webkitAudioContext;t&&(pm=new t)}return pm},Q9=()=>{const[t,e]=C.useState(!1),[n,r]=C.useState(null),o=C.useRef([]),i=C.useRef(new Map),a=C.useRef(!1),s=C.useRef(null),u=C.useRef(null),c=C.useCallback(()=>{const v=qb();if(v&&v.state==="suspended")v.resume().then(()=>{mm=!0,console.log("AudioContext resumed/unlocked")}).catch(y=>console.error("Failed to resume AudioContext",y));else if(v&&!mm){const y=v.createBuffer(1,1,22050),x=v.createBufferSource();x.buffer=y,x.connect(v.destination),x.start(0),mm=!0,console.log("AudioContext forced unlocked")}},[]),l=async(v,y)=>{if(i.current.has(v)){const E=i.current.get(v);return i.current.delete(v),E}let x=0;const b=3;for(;x<b;)try{const E=await fetch("/api/tts",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:v,voice:"shimmer",speed:1.25}),signal:y});if(!E.ok)throw new Error(`TTS API error: ${E.status}`);const _=await E.json();if(!_.success||!_.audio)throw new Error(_.error||"No audio returned");const S=window.atob(_.audio),k=S.length,R=new Uint8Array(k);for(let I=0;I<k;I++)R[I]=S.charCodeAt(I);return R.buffer}catch(E){if(y!=null&&y.aborted||(x++,x>=b))throw E;await new Promise(_=>setTimeout(_,500*x))}throw new Error("Failed to fetch TTS")},d=C.useCallback(()=>{if(o.current.length>0){const v=o.current[0];i.current.has(v)||l(v).then(y=>{i.current.set(v,y)}).catch(y=>console.warn("Prefetch failed",y))}},[]),f=async v=>{const y=qb();if(!y)throw new Error("AudioContext not supported");y.state==="suspended"&&await y.resume();const x=await y.decodeAudioData(v.slice(0));return new Promise((b,E)=>{const _=y.createBufferSource();_.buffer=x,_.connect(y.destination),_.onended=()=>{s.current=null,b()},s.current=_,_.start(0)})},h=C.useCallback(async()=>{if(o.current.length===0||a.current){o.current.length===0&&e(!1);return}a.current=!0,e(!0);const v=o.current.shift();r(v),d();try{u.current=new AbortController;const y=await l(v,u.current.signal);u.current.signal.aborted||await f(y)}catch(y){y.name==="AbortError"?console.log(" TTS playback cancelled"):console.error("TTS error:",y)}finally{a.current=!1,s.current=null,u.current=null,h()}},[d]),m=C.useCallback((v,y=!1)=>{if(c(),y){if(o.current=[],r(null),s.current){try{s.current.stop(),s.current.disconnect()}catch{}s.current=null}u.current&&u.current.abort(),a.current=!1}o.current.push(v),a.current||h()},[h,c]),p=C.useCallback(()=>{if(o.current=[],a.current=!1,r(null),s.current){try{s.current.stop(),s.current.disconnect()}catch{}s.current=null}u.current&&u.current.abort(),e(!1)},[]),g=typeof window<"u"&&!!(window.AudioContext||window.webkitAudioContext);return{speak:m,cancel:p,isSpeaking:t,currentSentence:n,hasSupport:g}},WT=({isOpen:t,onClose:e})=>{const{isListening:n,transcript:r,startListening:o,stopListening:i,hasSupport:a}=Y9({language:"th-TH",continuous:!1,onResult:j=>D(j)}),{speak:s,cancel:u,isSpeaking:c,currentSentence:l,hasSupport:d}=Q9(),{videoRef:f,result:h}=X9(t),[m,p]=C.useState("idle"),[g,v]=C.useState(0),[y,x]=C.useState(!1),[b,E]=C.useState(!1),[_,S]=C.useState(""),k=C.useRef(!1),R=C.useRef(null),I=C.useRef(!1);C.useEffect(()=>{if(!t){x(!1),E(!1),p("idle"),u(),i(),R.current&&clearTimeout(R.current);return}!n&&!c&&!I.current&&(console.log("[VoiceAI] Auto-starting listening (Immediate)..."),o())},[t,o,u,i]),C.useEffect(()=>{t&&(h.hasFace&&!y?(x(!0),k.current||(E(!0),k.current=!0,s(" "),R.current=window.setTimeout(()=>{E(!1)},5e3))):!h.hasFace&&y&&x(!1))},[t,h.hasFace,y,s]);const D=async j=>{if(!(!j.trim()||I.current)){console.log("User said:",j),p("processing"),I.current=!0,i();try{await W(j)}catch(U){console.error("Error processing query:",U),s("  "),p("idle")}finally{I.current=!1}}},A=()=>{u(),i(),S(""),p("idle"),e()},W=async j=>{S("");try{const U=await fetch("/api/messages/stream",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:j,user_id:"voice-user",request_id:crypto.randomUUID()})});if(!U.body)throw new Error("No response body");const M=U.body.getReader(),P=new TextDecoder;let B="",V="";for(;;){const{done:K,value:Q}=await M.read();if(K)break;const te=P.decode(Q,{stream:!0});B+=te;const ae=B.split(`

`);B=ae.pop()||"";for(const X of ae)if(X.startsWith("data: ")){const J=X.slice(6);try{const ie=JSON.parse(J);if(ie.type==="text"||ie.type==="chunk"){const oe=ie.text||ie.chunk||"";S(ee=>ee+oe),V+=oe;let me=-1;if(!c&&V.length>20){const ee=V.match(/[, ]/);ee&&ee.index!==void 0&&ee.index>10&&(me=ee.index+1)}if(me===-1&&V.length>50){const ee=V.match(/[.!?\n]+(?=\s|$)/);ee&&ee.index!==void 0&&(me=ee.index+ee[0].length)}if(me===-1&&V.length>120){const ee=V.lastIndexOf(" ");ee>50&&(me=ee+1)}if(me!==-1){const ee=V.slice(0,me),ye=V.slice(me);ee.trim()&&(c||p("speaking"),s(ee)),V=ye}else V.length>250&&(c||p("speaking"),s(V),V="")}else ie.type==="error"&&console.error("Stream error:",ie.message)}catch(ie){console.warn("Error parsing stream line:",ie)}}}V.trim()&&s(V)}catch(U){console.error("Fetch error:",U),s(" ")}finally{c||p("idle")}};if(C.useEffect(()=>{n?p("listening"):c?p("speaking"):I.current||p("idle")},[n,c]),C.useEffect(()=>{if(!t||m==="idle"){v(5);return}const j=setInterval(()=>{const U=m==="listening"?50:m==="speaking"?70:20,M=m==="processing"?10:40;v(U+Math.random()*M)},100);return()=>clearInterval(j)},[t,m]),!t)return null;const F=200+g*.5,$=20+g*.3;return w.jsxs("div",{className:"fixed inset-0 z-50 bg-gradient-to-br from-slate-950 via-blue-950 to-slate-950 flex flex-col overflow-hidden",children:[w.jsx("video",{ref:f,className:"hidden",autoPlay:!0,playsInline:!0,muted:!0}),w.jsx("div",{className:"absolute top-6 right-6 z-10",children:w.jsx(Ae,{variant:"ghost",size:"icon",onClick:A,className:"text-white/70 hover:text-white hover:bg-white/10 rounded-full w-12 h-12",children:w.jsx(pc,{className:"w-6 h-6"})})}),w.jsxs("div",{className:"pt-16 text-center animate-in slide-in-from-top duration-500",children:[w.jsxs("div",{className:"flex items-center justify-center gap-2 mb-2",children:[w.jsx(zs,{className:"w-5 h-5 text-cyan-400"}),w.jsx("span",{className:"text-cyan-400 text-sm font-medium tracking-widest uppercase",children:"NongPlatoo Voice AI"}),w.jsx(zs,{className:"w-5 h-5 text-cyan-400"})]}),w.jsx("p",{className:"text-white/60 text-sm",children:""}),!a&&w.jsx("p",{className:"text-red-400 text-xs mt-2",children:"Browser doesn't support Speech Recognition"})]}),w.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center relative",children:[(r||_||l)&&w.jsx("div",{className:"absolute top-1/4 w-full max-w-2xl px-8 text-center z-20 pointer-events-none",children:w.jsx("p",{className:`text-2xl font-light transition-all duration-300 ${m==="listening"?"text-white opacity-100 scale-105":"text-white/50 scale-100"}`,children:m==="listening"?r:m==="speaking"?l||"...":""})}),w.jsx("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[...Array(20)].map((j,U)=>w.jsx("div",{className:"absolute w-1 h-1 bg-cyan-400/30 rounded-full animate-pulse",style:{left:`${Math.random()*100}%`,top:`${Math.random()*100}%`,animationDelay:`${Math.random()*2}s`,animationDuration:`${2+Math.random()*2}s`}},U))}),w.jsxs("div",{className:"relative",children:[w.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 rounded-full opacity-20",style:{width:F+100,height:F+100,background:`radial-gradient(circle, ${m==="listening"?"rgba(255, 100, 100, 0.3)":"rgba(34, 211, 238, 0.3)"} 0%, transparent 70%)`}}),w.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 rounded-full border border-cyan-400/30 w-[300px] h-[300px] animate-[spin_8s_linear_infinite]"}),w.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 rounded-full border border-blue-400/20 w-[260px] h-[260px] animate-[spin_6s_linear_infinite_reverse]"}),w.jsxs("div",{className:"relative rounded-full flex items-center justify-center transition-all duration-300 transform",style:{width:F,height:F,background:m==="listening"?"radial-gradient(circle, rgba(220, 38, 38, 0.8) 0%, rgba(69, 10, 10, 0.95) 100%)":"radial-gradient(circle, rgba(30, 58, 138, 0.9) 0%, rgba(15, 23, 42, 0.95) 100%)",boxShadow:`0 0 ${$}px ${m==="listening"?"rgba(220, 38, 38, 0.5)":"rgba(34, 211, 238, 0.5)"}`},children:[w.jsx("div",{className:"absolute rounded-full w-[70%] h-[70%] bg-white/10 animate-pulse"}),m==="listening"?w.jsx(Yd,{className:"w-16 h-16 text-white animate-pulse"}):m==="speaking"?w.jsx(lM,{className:"w-16 h-16 text-cyan-400 animate-bounce"}):w.jsx(oM,{className:"w-16 h-16 text-white/50"})]})]})]}),w.jsxs("div",{className:"pb-16 text-center animate-in slide-in-from-bottom duration-500",children:[w.jsxs("div",{className:"mb-8 h-8",children:[m==="listening"&&w.jsx("span",{className:"text-cyan-400 animate-pulse",children:"Listening..."}),m==="processing"&&w.jsx("span",{className:"text-yellow-400 animate-pulse",children:"Thinking..."}),m==="speaking"&&w.jsx("span",{className:"text-green-400 animate-pulse",children:"Speaking..."})]}),w.jsx("div",{className:"flex justify-center gap-4",children:w.jsxs("div",{className:"flex gap-4",children:[!n&&m!=="processing"&&m!=="speaking"&&w.jsxs(Ae,{variant:"outline",size:"lg",onClick:o,className:"rounded-full px-8 py-6 text-lg border-cyan-500 text-cyan-500 bg-cyan-500/10 hover:bg-cyan-500/20 hover:scale-105 transition-all duration-300",children:[w.jsx(Yd,{className:"w-5 h-5 mr-2"}),""]}),w.jsxs(Ae,{variant:"default",size:"lg",onClick:A,className:"rounded-full px-8 py-6 text-lg bg-red-600 hover:bg-red-700 text-white border-0 shadow-lg transition-all duration-300",children:[w.jsx(pc,{className:"w-5 h-5 mr-2"}),""]})]})}),w.jsx("p",{className:"text-white/30 text-xs mt-4",children:"Powered by OpenAI & NongPlatoo AI"})]})]})},eu=()=>{var g;const[t,e]=C.useState(!1),[n,r]=C.useState(!1),[o,i]=C.useState(!1),a=_a(),s=Vc(),{toast:u}=ry(),{user:c,initializing:l,signOutUser:d}=EI();C.useEffect(()=>{const v=()=>{e(window.scrollY>20)};return window.addEventListener("scroll",v),()=>window.removeEventListener("scroll",v)},[]);const f=[{to:"/",label:"",labelEn:"Home",icon:nM},{to:"/places",label:"",labelEn:"Places",icon:ma},{to:"/chat",label:" NongPlatoo",labelEn:"Chat",icon:Xd}],h=a.pathname==="/",m=`?redirect=${encodeURIComponent(a.pathname)}`,p=async()=>{try{await d(),u({title:"",description:""}),a.pathname==="/auth"&&s("/")}catch{u({variant:"destructive",title:"",description:""})}};return w.jsxs("nav",{className:be("fixed top-0 left-0 right-0 z-50 transition-all duration-300",t||!h?"bg-card/95 backdrop-blur-md shadow-soft":"bg-transparent"),children:[w.jsx("div",{className:"container mx-auto px-4",children:w.jsxs("div",{className:"flex items-center justify-between h-16",children:[w.jsxs(hn,{to:"/",className:"flex items-center gap-2",children:[w.jsx("img",{src:IU,alt:"NongPlatoo Logo",className:"w-10 h-10 rounded-xl object-cover"}),w.jsx("span",{className:be("font-display font-semibold text-lg hidden sm:block transition-colors",t||!h?"text-foreground":"text-primary-foreground"),children:"NongPlatoo.Ai"})]}),w.jsxs("div",{className:"hidden md:flex items-center gap-1",children:[f.map(v=>w.jsx(hn,{to:v.to,children:w.jsxs(Ae,{variant:"ghost",className:be("gap-2 transition-colors",a.pathname===v.to?t||!h?"bg-primary/10 text-primary":"bg-primary-foreground/20 text-primary-foreground":t||!h?"text-foreground hover:text-primary hover:bg-primary/5":"text-primary-foreground/80 hover:text-primary-foreground hover:bg-primary-foreground/10"),children:[w.jsx(v.icon,{className:"w-4 h-4"}),w.jsx("span",{className:"font-thai",children:v.label})]})},v.to)),!l&&(c?w.jsxs(ej,{children:[w.jsx(tj,{asChild:!0,children:w.jsxs(Ae,{variant:"outline",className:"ml-2 pl-2 pr-3 gap-3 border-primary/30 text-foreground hover:text-primary hover:border-primary/60",children:[w.jsx(kk,{className:"h-8 w-8 bg-primary/15 text-primary",children:w.jsx(Ik,{children:(c.displayName||c.email||"NP").slice(0,2).toUpperCase()})}),w.jsxs("div",{className:"text-left leading-tight hidden lg:block",children:[w.jsx("p",{className:"text-xs text-muted-foreground",children:""}),w.jsx("p",{className:"font-medium",children:c.displayName||((g=c.email)==null?void 0:g.split("@")[0])||""})]})]})}),w.jsxs(fk,{align:"end",className:"w-48",children:[w.jsx(hk,{children:""}),w.jsxs(Iv,{onClick:()=>s(`/auth${m}`),className:"cursor-pointer",children:[w.jsx(XC,{className:"w-4 h-4 mr-2"}),""]}),w.jsx(pk,{}),w.jsxs(Iv,{onClick:p,className:"cursor-pointer text-destructive",children:[w.jsx(Ex,{className:"w-4 h-4 mr-2"}),""]})]})]}):w.jsx(hn,{to:`/auth${m}`,children:w.jsxs(Ae,{className:"ml-2 gap-2 bg-gradient-river text-primary-foreground shadow-soft hover:opacity-90",children:[w.jsx(bx,{className:"w-4 h-4"}),w.jsx("span",{className:"font-thai",children:""})]})}))]}),w.jsx(Ae,{variant:"ghost",size:"icon",className:be("md:hidden",t||!h?"text-foreground":"text-primary-foreground"),onClick:()=>r(!n),children:n?w.jsx(pc,{}):w.jsx(rM,{})})]})}),n&&w.jsx("div",{className:"md:hidden bg-card/95 backdrop-blur-md border-t border-border animate-fade-in",children:w.jsxs("div",{className:"container mx-auto px-4 py-4 space-y-2",children:[f.map(v=>w.jsx(hn,{to:v.to,onClick:()=>r(!1),children:w.jsxs(Ae,{variant:"ghost",className:be("w-full justify-start gap-3",a.pathname===v.to?"bg-primary/10 text-primary":"text-foreground"),children:[w.jsx(v.icon,{className:"w-5 h-5"}),w.jsx("span",{className:"font-thai",children:v.label}),w.jsxs("span",{className:"text-muted-foreground text-sm",children:["(",v.labelEn,")"]})]})},v.to)),!l&&w.jsx("div",{className:"pt-2 flex gap-2",children:c?w.jsxs(Ae,{variant:"outline",className:"w-full justify-center gap-2",onClick:()=>{p(),r(!1)},children:[w.jsx(Ex,{className:"w-4 h-4"}),""]}):w.jsx(hn,{to:`/auth${m}`,className:"w-full",onClick:()=>r(!1),children:w.jsxs(Ae,{className:"w-full justify-center gap-2 bg-gradient-river text-primary-foreground",children:[w.jsx(bx,{className:"w-4 h-4"}),""]})})})]})}),w.jsx(WT,{isOpen:o,onClose:()=>i(!1)})]})},J9=({title:t,titleTh:e,description:n,image:r,category:o,className:i})=>w.jsx(hn,{to:`/places?category=${o}`,className:be("group block card-hover",i),children:w.jsxs("div",{className:"relative overflow-hidden rounded-2xl bg-card shadow-card",children:[w.jsx("div",{className:"aspect-square overflow-hidden",children:w.jsx("img",{src:r,alt:t,className:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-110"})}),w.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-foreground/80 via-foreground/20 to-transparent"}),w.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-5",children:[w.jsx("h3",{className:"font-display text-xl font-semibold text-primary-foreground mb-1",children:e}),w.jsx("p",{className:"text-primary-foreground/80 text-sm mb-2",children:t}),w.jsx("p",{className:"text-primary-foreground/60 text-xs line-clamp-2",children:n})]}),w.jsx("div",{className:"absolute inset-0 bg-primary/20 opacity-0 group-hover:opacity-100 transition-opacity duration-300"})]})}),Z9="/assets/%E0%B8%9B%E0%B8%81%E0%B9%80%E0%B8%A7%E0%B9%87%E0%B8%9A-C5HZZB4x.jpg",eK="/assets/%E0%B8%81%E0%B8%A3%E0%B8%A3%E0%B8%A1%E0%B8%AA%E0%B9%88%E0%B8%87%E0%B9%80%E0%B8%AA%E0%B8%A3%E0%B8%B4%E0%B8%A1%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%9B%E0%B8%81%E0%B8%84%E0%B8%A3%E0%B8%AD%E0%B8%87%E0%B8%97%E0%B9%89%E0%B8%AD%E0%B8%87%E0%B8%96%E0%B8%B7%E0%B9%88%E0%B8%99-wrB8VJhP.png",tK="/assets/%E0%B8%81%E0%B8%A3%E0%B8%B0%E0%B8%97%E0%B8%A3%E0%B8%A7%E0%B8%87%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%97%E0%B9%88%E0%B8%AD%E0%B8%87%E0%B9%80%E0%B8%97%E0%B8%B5%E0%B9%88%E0%B8%A2%E0%B8%A7%E0%B9%81%E0%B8%A5%E0%B8%B0%E0%B8%81%E0%B8%B5%E0%B8%AC%E0%B8%B2-H0zXdO5R.png",nK="/assets/%E0%B8%9B%E0%B8%A3%E0%B8%B0%E0%B8%8A%E0%B8%B2%E0%B8%AA%E0%B8%B1%E0%B8%A1%E0%B8%9E%E0%B8%B1%E0%B8%99%E0%B8%98%E0%B9%8C%E0%B8%88%E0%B8%B1%E0%B8%87%E0%B8%AB%E0%B8%A7%E0%B8%B1%E0%B8%94%E0%B8%AA%E0%B8%A1%E0%B8%B8%E0%B8%97%E0%B8%A3%E0%B8%AA%E0%B8%87%E0%B8%84%E0%B8%A3%E0%B8%B2%E0%B8%A1-CMknLaoe.png",rK="/assets/%E0%B8%AA%E0%B8%B3%E0%B8%99%E0%B8%B1%E0%B8%81%E0%B8%87%E0%B8%B2%E0%B8%99%E0%B8%AA%E0%B8%96%E0%B8%B4%E0%B8%95%E0%B8%B4%E0%B9%81%E0%B8%AB%E0%B9%88%E0%B8%87%E0%B8%8A%E0%B8%B2%E0%B8%95%E0%B8%B4%20%E0%B8%88%E0%B8%B1%E0%B8%87%E0%B8%AB%E0%B8%A7%E0%B8%B1%E0%B8%94%E0%B8%AA%E0%B8%A1%E0%B8%B8%E0%B8%97%E0%B8%A3%E0%B8%AA%E0%B8%87%E0%B8%84%E0%B8%A3%E0%B8%B2%E0%B8%A1-BbpBZhgn.jpg",oK="/assets/%E0%B8%AD%E0%B8%87%E0%B8%84%E0%B9%8C%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%9A%E0%B8%A3%E0%B8%B4%E0%B8%AB%E0%B8%B2%E0%B8%99%E0%B8%AA%E0%B9%88%E0%B8%A7%E0%B8%99%E0%B8%88%E0%B8%B1%E0%B8%87%E0%B8%AB%E0%B8%A7%E0%B8%B1%E0%B8%94-DZbxWvxP.png",iK=()=>{const t=[{id:"tourism",name:"MOTS",label:"",image:tK},{id:"pr",name:"PR Samut",label:`
`,image:nK},{id:"pao",name:"PAO",label:`
`,image:oK},{id:"local",name:"DLA",label:`
`,image:eK},{id:"nso",name:"NSO",label:`
`,image:rK}];return w.jsx("section",{className:"py-16 bg-muted/30 border-b border-border/50",children:w.jsxs("div",{className:"container mx-auto px-4",children:[w.jsxs("div",{className:"text-center mb-10",children:[w.jsx("p",{className:"text-sm font-medium text-muted-foreground mb-2",children:"Logos"}),w.jsx("h3",{className:"text-2xl font-bold text-foreground",children:""})]}),w.jsx("div",{className:"flex flex-wrap justify-center gap-6 md:gap-8",children:t.map(e=>w.jsxs("div",{className:"w-48 h-48 bg-card rounded-2xl flex flex-col items-center justify-center p-6 shadow-sm hover:shadow-lg transition-all duration-300 group border border-border/50",children:[w.jsx("div",{className:"w-24 h-24 flex items-center justify-center mb-4 group-hover:scale-110 transition-transform duration-300",children:w.jsx("img",{src:e.image,alt:e.label,className:"w-full h-full object-contain"})}),w.jsx("p",{className:"text-sm text-center text-muted-foreground font-medium leading-tight min-h-[2.5rem] flex items-center justify-center whitespace-pre-line",children:e.label})]},e.id))})]})})},aK=()=>{const t=[{title:"Floating Markets",titleTh:"",description:" ",image:"https://paimayang.com/wp-content/uploads/2020/02/82_20190826014648_1-840x560.jpg",category:"market"},{title:"Temples & Culture",titleTh:"",description:" ",image:"https://t1.blockdit.com/photos/2023/03/64053c674d188033c3a4bb5a_800x0xcover_Xv4jzo41.jpg",category:"temple"},{title:"Homestays & Gardens",titleTh:"",description:" ",image:"https://www.saitiew.com/upload/2024/11/3zkr3nr94bba.jpg",category:"homestay"}];return w.jsxs("div",{className:"min-h-screen bg-background",children:[w.jsx(eu,{}),w.jsxs("section",{className:"relative min-h-screen flex items-center justify-center overflow-hidden",children:[w.jsxs("div",{className:"absolute inset-0",children:[w.jsx("img",{src:Z9,alt:"Amphawa Floating Market",className:"w-full h-full object-cover"}),w.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-primary/40 via-primary/50 to-primary/70"})]}),w.jsxs("div",{className:"relative z-10 container mx-auto px-4 text-center",children:[w.jsxs("div",{className:"max-w-3xl mx-auto animate-fade-in",children:[w.jsxs("h1",{className:"font-display text-4xl md:text-6xl lg:text-6xl font-bold text-primary-foreground mb-4 leading-tight",children:[w.jsx("span",{className:"block mb-3",children:""}),w.jsx("span",{className:"block text-golden",children:""}),w.jsx("span",{className:"block text-golden",children:""})]}),w.jsx("p",{className:"text-xl md:text-2xl text-primary-foreground/90 mb-4 font-display"}),w.jsx("p",{className:"text-lg text-primary-foreground/80 mb-8 max-w-xl mx-auto",children:'Nong Pla Too" Intelligent Travel Publicity with AI'}),w.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[w.jsx(hn,{to:"/places",children:w.jsxs(Ae,{variant:"hero",size:"xl",className:"w-full sm:w-auto",children:[w.jsx(ma,{className:"w-5 h-5"}),"",w.jsx(vx,{className:"w-5 h-5"})]})}),w.jsx(hn,{to:"/chat",children:w.jsxs(Ae,{variant:"heroOutline",size:"xl",className:"w-full sm:w-auto",children:[w.jsx(Xd,{className:"w-5 h-5"}),"Chat with NongPlatoo"]})})]})]}),w.jsx("div",{className:"absolute bottom-8 left-1/2 -translate-x-1/2 animate-float",children:w.jsx("div",{className:"w-6 h-10 rounded-full border-2 border-primary-foreground/50 flex justify-center pt-2",children:w.jsx("div",{className:"w-1.5 h-3 bg-primary-foreground/70 rounded-full animate-pulse"})})})]})]}),w.jsx(iK,{}),w.jsx("section",{className:"py-20 bg-gradient-sky",children:w.jsxs("div",{className:"container mx-auto px-4",children:[w.jsxs("div",{className:"text-center mb-12 animate-slide-up",children:[w.jsx("h2",{className:"font-display text-3xl md:text-4xl font-bold text-foreground mb-3",children:""}),w.jsx("p",{className:"text-lg text-muted-foreground",children:"Featured Categories  Discover what awaits you"})]}),w.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 max-w-5xl mx-auto",children:t.map((e,n)=>w.jsx(J9,{...e,className:`animate-slide-up animation-delay-${(n+1)*100}`},e.category))})]})}),w.jsx("section",{className:"py-20 bg-card",children:w.jsx("div",{className:"container mx-auto px-4",children:w.jsx("div",{className:"max-w-4xl mx-auto bg-gradient-river rounded-3xl p-8 md:p-12 shadow-elevated",children:w.jsxs("div",{className:"text-center",children:[w.jsx("div",{className:"w-16 h-16 bg-primary-foreground/20 rounded-2xl flex items-center justify-center mx-auto mb-6",children:w.jsx(Xd,{className:"w-8 h-8 text-primary-foreground"})}),w.jsx("h2",{className:"font-display text-2xl md:text-3xl font-bold text-primary-foreground mb-4",children:" NongPlatoo.Ai"}),w.jsx("p",{className:"text-primary-foreground/80 text-lg mb-8 max-w-xl mx-auto",children:" - "}),w.jsx(hn,{to:"/chat",children:w.jsxs(Ae,{variant:"heroOutline",size:"lg",className:"bg-primary-foreground text-primary hover:bg-primary-foreground/90",children:["Start Chatting",w.jsx(vx,{className:"w-5 h-5"})]})})]})})})}),w.jsx("footer",{className:"py-8 bg-muted border-t border-border",children:w.jsx("div",{className:"container mx-auto px-4 text-center",children:w.jsx("p",{className:"text-muted-foreground text-sm",children:" 2025   ."})})})]})},sK=ih("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function tu({className:t,variant:e,...n}){return w.jsx("div",{className:be(sK({variant:e}),t),...n})}const $T=C.forwardRef(({className:t,...e},n)=>w.jsx("div",{ref:n,className:be("rounded-lg border bg-card text-card-foreground shadow-sm",t),...e}));$T.displayName="Card";const zT=C.forwardRef(({className:t,...e},n)=>w.jsx("div",{ref:n,className:be("flex flex-col space-y-1.5 p-6",t),...e}));zT.displayName="CardHeader";const VT=C.forwardRef(({className:t,...e},n)=>w.jsx("h3",{ref:n,className:be("text-2xl font-semibold leading-none tracking-tight",t),...e}));VT.displayName="CardTitle";const uK=C.forwardRef(({className:t,...e},n)=>w.jsx("p",{ref:n,className:be("text-sm text-muted-foreground",t),...e}));uK.displayName="CardDescription";const HT=C.forwardRef(({className:t,...e},n)=>w.jsx("div",{ref:n,className:be("p-6 pt-0",t),...e}));HT.displayName="CardContent";const cK=C.forwardRef(({className:t,...e},n)=>w.jsx("div",{ref:n,className:be("flex items-center p-6 pt-0",t),...e}));cK.displayName="CardFooter";const so=C.forwardRef(({className:t,type:e,...n},r)=>w.jsx("input",{type:e,className:be("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:r,...n}));so.displayName="Input";var lK="Label",GT=C.forwardRef((t,e)=>w.jsx(Ue.label,{...t,ref:e,onMouseDown:n=>{var o;n.target.closest("button, input, select, textarea")||((o=t.onMouseDown)==null||o.call(t,n),!n.defaultPrevented&&n.detail>1&&n.preventDefault())}}));GT.displayName=lK;var KT=GT;const dK=ih("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),qi=C.forwardRef(({className:t,...e},n)=>w.jsx(KT,{ref:n,className:be(dK(),t),...e}));qi.displayName=KT.displayName;var Uh="Tabs",[fK,YK]=ko(Uh,[mh]),qT=mh(),[hK,q0]=fK(Uh),XT=C.forwardRef((t,e)=>{const{__scopeTabs:n,value:r,onValueChange:o,defaultValue:i,orientation:a="horizontal",dir:s,activationMode:u="automatic",...c}=t,l=ky(s),[d,f]=nh({prop:r,onChange:o,defaultProp:i??"",caller:Uh});return w.jsx(hK,{scope:n,baseId:Qd(),value:d,onValueChange:f,orientation:a,dir:l,activationMode:u,children:w.jsx(Ue.div,{dir:l,"data-orientation":a,...c,ref:e})})});XT.displayName=Uh;var YT="TabsList",QT=C.forwardRef((t,e)=>{const{__scopeTabs:n,loop:r=!0,...o}=t,i=q0(YT,n),a=qT(n);return w.jsx(cS,{asChild:!0,...a,orientation:i.orientation,dir:i.dir,loop:r,children:w.jsx(Ue.div,{role:"tablist","aria-orientation":i.orientation,...o,ref:e})})});QT.displayName=YT;var JT="TabsTrigger",ZT=C.forwardRef((t,e)=>{const{__scopeTabs:n,value:r,disabled:o=!1,...i}=t,a=q0(JT,n),s=qT(n),u=nN(a.baseId,r),c=rN(a.baseId,r),l=r===a.value;return w.jsx(lS,{asChild:!0,...s,focusable:!o,active:l,children:w.jsx(Ue.button,{type:"button",role:"tab","aria-selected":l,"aria-controls":c,"data-state":l?"active":"inactive","data-disabled":o?"":void 0,disabled:o,id:u,...i,ref:e,onMouseDown:ve(t.onMouseDown,d=>{!o&&d.button===0&&d.ctrlKey===!1?a.onValueChange(r):d.preventDefault()}),onKeyDown:ve(t.onKeyDown,d=>{[" ","Enter"].includes(d.key)&&a.onValueChange(r)}),onFocus:ve(t.onFocus,()=>{const d=a.activationMode!=="manual";!l&&!o&&d&&a.onValueChange(r)})})})});ZT.displayName=JT;var eN="TabsContent",tN=C.forwardRef((t,e)=>{const{__scopeTabs:n,value:r,forceMount:o,children:i,...a}=t,s=q0(eN,n),u=nN(s.baseId,r),c=rN(s.baseId,r),l=r===s.value,d=C.useRef(l);return C.useEffect(()=>{const f=requestAnimationFrame(()=>d.current=!1);return()=>cancelAnimationFrame(f)},[]),w.jsx(Di,{present:o||l,children:({present:f})=>w.jsx(Ue.div,{"data-state":l?"active":"inactive","data-orientation":s.orientation,role:"tabpanel","aria-labelledby":u,hidden:!f,id:c,tabIndex:0,...a,ref:e,style:{...t.style,animationDuration:d.current?"0s":void 0},children:f&&i})})});tN.displayName=eN;function nN(t,e){return`${t}-trigger-${e}`}function rN(t,e){return`${t}-content-${e}`}var pK=XT,oN=QT,iN=ZT,aN=tN;const mK=pK,sN=C.forwardRef(({className:t,...e},n)=>w.jsx(oN,{ref:n,className:be("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",t),...e}));sN.displayName=oN.displayName;const ag=C.forwardRef(({className:t,...e},n)=>w.jsx(iN,{ref:n,className:be("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",t),...e}));ag.displayName=iN.displayName;const sg=C.forwardRef(({className:t,...e},n)=>w.jsx(aN,{ref:n,className:be("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...e}));sg.displayName=aN.displayName;const vK=()=>{const{toast:t}=ry(),e=Vc(),[n]=Sy(),r=C.useMemo(()=>n.get("redirect")||"/",[n]),{user:o,initializing:i,authLoading:a,authError:s,signIn:u,signUp:c,resetAuthError:l}=EI(),[d,f]=C.useState("login"),[h,m]=C.useState(null),[p,g]=C.useState({email:"",password:"",confirmPassword:"",displayName:""});C.useEffect(()=>{o&&!i&&e(r,{replace:!0})},[o,i,e,r]);const v=async x=>{if(x.preventDefault(),m(null),l(),!p.email||!p.password){m("");return}if(d==="register"&&p.password!==p.confirmPassword){m("");return}try{d==="login"?(await u(p.email,p.password),t({title:"",description:" "})):(await c({email:p.email,password:p.password,displayName:p.displayName.trim()||void 0}),t({title:"",description:" NongPlatoo.Ai "})),e(r,{replace:!0})}catch{}},y=[{title:" Firebase Auth",description:"  MFA ",icon:kx},{title:" ",description:"",icon:wx},{title:"",description:" ",icon:zs}];return w.jsxs("div",{className:"min-h-screen bg-gradient-sky relative overflow-hidden",children:[w.jsxs("div",{className:"absolute inset-0 pointer-events-none",children:[w.jsx("div",{className:"absolute -top-20 -left-20 w-72 h-72 bg-primary/20 rounded-full blur-3xl"}),w.jsx("div",{className:"absolute -bottom-20 -right-12 w-80 h-80 bg-secondary/20 rounded-full blur-3xl"}),w.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-white/40 via-white/30 to-white/10 dark:from-background"})]}),w.jsx(eu,{}),w.jsx("div",{className:"container relative mx-auto px-4 pt-28 pb-16",children:w.jsxs("div",{className:"grid lg:grid-cols-2 gap-10 items-start",children:[w.jsxs("div",{className:"space-y-6",children:[w.jsx(tu,{className:"bg-primary/15 text-primary border border-primary/20",children:""}),w.jsxs("div",{className:"space-y-4",children:[w.jsxs("p",{className:"text-sm uppercase tracking-[0.3em] text-primary font-semibold flex items-center gap-2",children:[w.jsx(zs,{className:"w-4 h-4"})," Firebase Login"]}),w.jsx("h1",{className:"text-3xl sm:text-4xl font-bold leading-tight",children:" NongPlatoo.Ai"}),w.jsx("p",{className:"text-muted-foreground text-lg leading-relaxed",children:"  Firebase "})]}),w.jsx("div",{className:"grid sm:grid-cols-2 gap-4",children:y.map(x=>w.jsxs("div",{className:"glass p-4 rounded-2xl border border-border/80 shadow-soft flex gap-3",children:[w.jsx("div",{className:"h-10 w-10 rounded-xl bg-primary/10 text-primary flex items-center justify-center",children:w.jsx(x.icon,{className:"w-5 h-5"})}),w.jsxs("div",{className:"space-y-1",children:[w.jsx("h3",{className:"font-semibold",children:x.title}),w.jsx("p",{className:"text-sm text-muted-foreground",children:x.description})]})]},x.title))}),w.jsxs("div",{className:"flex items-center gap-3 text-sm text-muted-foreground",children:[w.jsx(GC,{className:"w-4 h-4 text-accent"}),""]})]}),w.jsxs($T,{className:"glass shadow-elevated border border-primary/10 relative overflow-hidden",children:[w.jsx("div",{className:"absolute inset-x-0 top-0 h-1 bg-gradient-to-r from-primary via-secondary to-accent"}),w.jsx(zT,{className:"pb-4",children:w.jsxs(VT,{className:"flex items-center gap-3",children:[w.jsx("div",{className:"h-12 w-12 rounded-2xl bg-primary/10 text-primary flex items-center justify-center",children:w.jsx(wx,{className:"w-6 h-6"})}),w.jsxs("div",{children:[w.jsx("p",{className:"text-sm text-muted-foreground",children:""}),w.jsx("span",{className:"text-xl font-semibold",children:"NongPlatoo Account"})]})]})}),w.jsxs(HT,{className:"space-y-6",children:[w.jsxs(mK,{value:d,onValueChange:x=>f(x),children:[w.jsxs(sN,{className:"grid grid-cols-2 w-full",children:[w.jsx(ag,{value:"login",children:""}),w.jsx(ag,{value:"register",children:""})]}),w.jsx(sg,{value:"login",className:"mt-6",children:w.jsxs("form",{className:"space-y-5",onSubmit:v,children:[w.jsxs("div",{className:"space-y-2",children:[w.jsxs(qi,{htmlFor:"email",className:"flex items-center gap-2",children:[w.jsx(Cx,{className:"w-4 h-4"})," "]}),w.jsx(so,{id:"email",type:"email",placeholder:"you@example.com",value:p.email,onChange:x=>g({...p,email:x.target.value}),required:!0})]}),w.jsxs("div",{className:"space-y-2",children:[w.jsxs(qi,{htmlFor:"password",className:"flex items-center gap-2",children:[w.jsx(yx,{className:"w-4 h-4"})," "]}),w.jsx(so,{id:"password",type:"password",placeholder:"********",value:p.password,onChange:x=>g({...p,password:x.target.value}),required:!0})]}),(h||s)&&w.jsx("div",{className:"text-destructive bg-destructive/10 border border-destructive/30 rounded-lg px-3 py-2 text-sm",children:h||s}),w.jsx(Ae,{type:"submit",className:"w-full h-11 bg-gradient-river text-primary-foreground",disabled:a,children:a?w.jsxs(w.Fragment,{children:[w.jsx(xx,{className:"w-4 h-4 mr-2 animate-spin"}),"..."]}):""})]})}),w.jsx(sg,{value:"register",className:"mt-6",children:w.jsxs("form",{className:"space-y-5",onSubmit:v,children:[w.jsxs("div",{className:"space-y-2",children:[w.jsxs(qi,{htmlFor:"displayName",className:"flex items-center gap-2",children:[w.jsx(cM,{className:"w-4 h-4"})," "]}),w.jsx(so,{id:"displayName",placeholder:"",value:p.displayName,onChange:x=>g({...p,displayName:x.target.value})})]}),w.jsxs("div",{className:"space-y-2",children:[w.jsxs(qi,{htmlFor:"register-email",className:"flex items-center gap-2",children:[w.jsx(Cx,{className:"w-4 h-4"})," "]}),w.jsx(so,{id:"register-email",type:"email",placeholder:"you@example.com",value:p.email,onChange:x=>g({...p,email:x.target.value}),required:!0})]}),w.jsxs("div",{className:"grid sm:grid-cols-2 gap-4",children:[w.jsxs("div",{className:"space-y-2",children:[w.jsxs(qi,{htmlFor:"register-password",className:"flex items-center gap-2",children:[w.jsx(yx,{className:"w-4 h-4"})," "]}),w.jsx(so,{id:"register-password",type:"password",placeholder:" 6 ",value:p.password,onChange:x=>g({...p,password:x.target.value}),required:!0})]}),w.jsxs("div",{className:"space-y-2",children:[w.jsxs(qi,{htmlFor:"confirm-password",className:"flex items-center gap-2",children:[w.jsx(kx,{className:"w-4 h-4"})," "]}),w.jsx(so,{id:"confirm-password",type:"password",placeholder:"",value:p.confirmPassword,onChange:x=>g({...p,confirmPassword:x.target.value}),required:!0})]})]}),(h||s)&&w.jsx("div",{className:"text-destructive bg-destructive/10 border border-destructive/30 rounded-lg px-3 py-2 text-sm",children:h||s}),w.jsx(Ae,{type:"submit",className:"w-full h-11 bg-gradient-river text-primary-foreground",disabled:a,children:a?w.jsxs(w.Fragment,{children:[w.jsx(xx,{className:"w-4 h-4 mr-2 animate-spin"}),"..."]}):""})]})})]}),w.jsxs("div",{className:"text-sm text-muted-foreground text-center",children:[""," ",w.jsx(hn,{to:"/",className:"text-primary hover:underline",children:""})," ",""," ",w.jsx(hn,{to:"/",className:"text-primary hover:underline",children:""})]})]})]})]})})]})},uN="place_views",cN=()=>{try{const t=localStorage.getItem(uN);return t?JSON.parse(t):{}}catch(t){return console.error("Error reading views from localStorage:",t),{}}},lN=t=>cN()[t]||0,gK=t=>{try{const e=cN(),r=(e[t]||0)+1;return e[t]=r,localStorage.setItem(uN,JSON.stringify(e)),r}catch(e){return console.error("Error incrementing views:",e),lN(t)}},yK=t=>t>=1e6?`${(t/1e6).toFixed(1)}M`:t>=1e3?`${(t/1e3).toFixed(1)}K`:t.toString(),xK=({id:t,name:e,nameTh:n,location:r,image:o,rating:i,tags:a,isOpen:s=!0,className:u})=>{const[c,l]=C.useState(0);C.useEffect(()=>{l(lN(t))},[t]);const d=()=>{const f=gK(t);l(f)};return w.jsx(hn,{to:`/places/${t}`,onClick:d,className:be("group block card-hover",u),children:w.jsxs("div",{className:"bg-card rounded-2xl overflow-hidden shadow-card",children:[w.jsxs("div",{className:"relative aspect-[4/3] overflow-hidden",children:[w.jsx("img",{src:o,alt:n,className:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-105"}),w.jsx("div",{className:"absolute top-3 left-3",children:w.jsxs(tu,{variant:s?"default":"secondary",className:be("flex items-center gap-1",s?"bg-accent text-accent-foreground":"bg-muted text-muted-foreground"),children:[w.jsx(hc,{className:"w-3 h-3"}),s?"":""]})}),w.jsxs("div",{className:"absolute top-3 right-3 flex flex-col gap-2",children:[w.jsxs("div",{className:"flex items-center gap-1 bg-card/90 backdrop-blur-sm px-2 py-1 rounded-full",children:[w.jsx(qC,{className:"w-3.5 h-3.5 fill-golden text-golden"}),w.jsx("span",{className:"text-sm font-medium text-foreground",children:i.toFixed(1)})]}),w.jsxs("div",{className:"flex items-center gap-1 bg-card/90 backdrop-blur-sm px-2 py-1 rounded-full",children:[w.jsx(eM,{className:"w-3.5 h-3.5 text-primary"}),w.jsx("span",{className:"text-xs font-medium text-foreground",children:yK(c)})]})]})]}),w.jsxs("div",{className:"p-4",children:[w.jsx("h3",{className:"font-display text-lg font-semibold text-foreground mb-1 line-clamp-1 group-hover:text-primary transition-colors",children:n}),w.jsx("p",{className:"text-muted-foreground text-sm mb-2",children:e}),w.jsxs("div",{className:"flex items-center gap-1 text-muted-foreground text-sm mb-3",children:[w.jsx(ma,{className:"w-4 h-4 text-secondary"}),w.jsx("span",{className:"line-clamp-1",children:r})]}),w.jsx("div",{className:"flex flex-wrap gap-1.5",children:a.slice(0,3).map(f=>w.jsx(tu,{variant:"outline",className:"text-xs border-border text-muted-foreground",children:f},f))})]})]})})},X0=[{id:"1",name:"Amphawa Floating Market",nameTh:"",description:"The famous floating market where you can enjoy fresh seafood and local snacks from boats along the canal. Best visited in the evening for the magical firefly boat tours.",descriptionTh:" .",location:"Amphawa, Samut Songkhram",district:"amphawa",category:"market",image:"https://lh3.googleusercontent.com/gps-cs-s/AG0ilSyXKuL_MwFh65YglyMBCuKbkad-RoGiGp9rq5fYmkKy_4e4YreVx2orjwR6cQhL2X23HGOqPIgaT1Ong0nNe8Lp60Re9i7611FP1j1qwwrLrAfFyIl7mTeE_8JvEj5uPazBLy1gJ364Ng9W=s1024",rating:4.7,tags:[""],openTime:"09:00",closeTime:"18:00",isOpen:!0,googleMapsUrl:"https://maps.google.com/?q=Amphawa+Floating+Market",address:"Amphawa Sub-district, Amphawa District, Samut Songkhram 75110",addressTh:"   75110"},{id:"2",name:"Wat Bang Kung",nameTh:"",description:"An ancient temple enshrined within the roots of a massive banyan tree. Also known as the Church in the Tree, it's a mystical and serene place.",descriptionTh:".",location:"Bang Khonthi, Samut Songkhram",district:"bang-khonthi",category:"temple",image:"https://lh3.googleusercontent.com/gps-cs-s/AG0ilSwtz9nw17SvBPqD_5v1gma9tYikz-_VoHO_7j3O1DsCvFHvTL4hXAToAc9p9Pj8zkDpu0_UYHZHmQGHnXd6B889HilNRr2gE0zhAbNPXAxNujRgWcx9vZ1bt3a08XGofo66_xqvhg=s1024",rating:4.8,tags:["","",""],openTime:"09:00",closeTime:"18:00",isOpen:!0,googleMapsUrl:"https://maps.google.com/?q=Wat+Bang+Kung",address:"Bang Kung Sub-district, Bang Khonthi District, Samut Songkhram 75120",addressTh:"   75120"},{id:"3",name:"Maeklong Railway Market",nameTh:"",description:"Witness the incredible sight of vendors quickly clearing their stalls as the train passes through this unique market built on the railway tracks.",descriptionTh:".",location:"Mueang, Samut Songkhram",district:"mueang",category:"market",image:"https://umbrella-perfect.com/wp-content/uploads/2021/02/%E0%B8%9B%E0%B8%A3%E0%B8%B0%E0%B8%A7%E0%B8%B1%E0%B8%95%E0%B8%B4%E0%B8%84%E0%B8%A7%E0%B8%B2%E0%B8%A1%E0%B9%80%E0%B8%9B%E0%B9%87%E0%B8%99%E0%B8%A1%E0%B8%B2%E0%B8%82%E0%B8%AD%E0%B8%87%E0%B8%95%E0%B8%A5%E0%B8%B2%E0%B8%94%E0%B8%A3%E0%B9%88%E0%B8%A1%E0%B8%AB%E0%B8%B8%E0%B8%9A.jpg",rating:4.6,tags:["","",""],openTime:"06:00",closeTime:"18:00",isOpen:!0,googleMapsUrl:"https://maps.google.com/?q=Maeklong+Railway+Market",address:"Mae Klong Sub-district, Mueang District, Samut Songkhram 75000",addressTh:"   75000"},{id:"4",name:"Baan Rak Amphawa",nameTh:"",description:"A charming riverside homestay offering authentic Thai hospitality. Wake up to the gentle sounds of the river and enjoy homemade breakfast.",descriptionTh:" ",location:"Amphawa, Samut Songkhram",district:"amphawa",category:"homestay",image:"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQBEDoWOCGL2pGknXKGIDciMMpSheTRGgATjw&s",rating:4.9,tags:["","",""],openTime:"00:00",closeTime:"23:59",isOpen:!0,googleMapsUrl:"https://maps.google.com/?q=Baan+Rak+Amphawa",address:"Amphawa Sub-district, Amphawa District, Samut Songkhram 75110",addressTh:"   75110"},{id:"5",name:"Caf Kantary",nameTh:" ",description:"A beautiful riverside caf with stunning views of the Mae Klong river. Perfect for enjoying coffee while watching traditional boats pass by.",descriptionTh:" ",location:"Amphawa, Samut Songkhram",district:"amphawa",category:"cafe",image:"https://chillpainai.com/src/wewakeup/scoop/images/91e3f6e28fb58b74b0e8820ec1d513c588488830.jpg",rating:4.5,tags:["","",""],openTime:"08:00",closeTime:"20:00",isOpen:!0,googleMapsUrl:"https://maps.google.com/?q=Cafe+Kantary+Amphawa",address:"Amphawa Sub-district, Amphawa District, Samut Songkhram 75110",addressTh:"   75110"},{id:"6",name:"Don Hoi Lot",nameTh:"",description:"A unique sandbar formation home to the razor clam. Visit during low tide to walk on the exposed sandbar and see these fascinating creatures.",descriptionTh:" ",location:"Bang Tabun, Samut Songkhram",district:"bang-khonthi",category:"photo-spot",image:"https://cms.dmpcdn.com/travel/2020/06/16/76365890-afa1-11ea-b79d-0ddf2d8ccf90_original.jpg",rating:4.3,tags:["","",""],openTime:"06:00",closeTime:"18:00",isOpen:!0,googleMapsUrl:"https://maps.google.com/?q=Don+Hoi+Lot",address:"Bang Tabun Sub-district, Bang Khonthi District, Samut Songkhram 75120",addressTh:"   75120"}],dN=t=>X0.find(e=>e.id===t),wK=(t,e,n)=>X0.filter(r=>{if(t&&r.district!==t||e&&r.category!==e)return!1;if(n){const o=n.toLowerCase();return r.name.toLowerCase().includes(o)||r.nameTh.includes(n)||r.tags.some(i=>i.includes(n))}return!0}),bK=(t={})=>{const[e,n]=Sy(),[r,o]=C.useState(""),[i,a]=C.useState(t.initialDistrict||e.get("district")||""),[s,u]=C.useState(t.initialCategory||e.get("category")||""),c=(m,p)=>{const g=new URLSearchParams;m&&g.set("district",m),p&&g.set("category",p),n(g)},l=m=>{const p=i===m?"":m;a(p),c(p,s)},d=m=>{const p=s===m?"":m;u(p),c(i,p)},f=()=>{a(""),u(""),o(""),n(new URLSearchParams)},h=C.useMemo(()=>!!(i||s||r),[i,s,r]);return{search:r,selectedDistrict:i,selectedCategory:s,setSearch:o,handleDistrictChange:l,handleCategoryChange:d,clearFilters:f,hasActiveFilters:h}},EK=[{value:"amphawa",label:"",labelEn:"Amphawa"},{value:"mueang",label:"",labelEn:"Mueang"},{value:"bang-khonthi",label:"",labelEn:"Bang Khonthi"}],CK=[{value:"market",label:"",labelEn:"Market"},{value:"temple",label:"",labelEn:"Temple"},{value:"cafe",label:"",labelEn:"Caf"},{value:"homestay",label:"",labelEn:"Homestay"},{value:"photo-spot",label:"",labelEn:"Photo Spot"}],nd={position:"fixed top-20 left-4 z-50 pointer-events-none",text:{main:"DEV",sub:"In Progress"},icon:""},_K=()=>{const[t,e]=C.useState(!1),{search:n,selectedDistrict:r,selectedCategory:o,setSearch:i,handleDistrictChange:a,handleCategoryChange:s,clearFilters:u,hasActiveFilters:c}=bK(),l=C.useMemo(()=>wK(r||void 0,o||void 0,n||void 0),[r,o,n]);return w.jsxs("div",{className:"min-h-screen bg-background",children:[w.jsx(eu,{}),w.jsx("div",{className:nd.position,children:w.jsxs("div",{className:"bg-amber-400 dark:bg-amber-600 text-amber-900 dark:text-amber-50 px-4 py-2 rounded-lg shadow-lg border-2 border-amber-500 dark:border-amber-400 rotate-12 font-bold text-sm flex items-center gap-2",children:[w.jsx("span",{className:"text-lg",children:nd.icon}),w.jsxs("div",{children:[w.jsx("div",{children:nd.text.main}),w.jsx("div",{className:"text-xs",children:nd.text.sub})]})]})}),w.jsx("header",{className:"pt-24 pb-8 bg-gradient-sky",children:w.jsxs("div",{className:"container mx-auto px-4",children:[w.jsx("h1",{className:"font-display text-3xl md:text-4xl font-bold text-foreground mb-2",children:""}),w.jsxs("p",{className:"text-muted-foreground text-lg",children:["Explore Places  ",X0.length," destinations to discover"]})]})}),w.jsx("div",{className:"sticky top-16 z-40 bg-card/95 backdrop-blur-md border-b border-border py-4",children:w.jsxs("div",{className:"container mx-auto px-4",children:[w.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[w.jsxs("div",{className:"relative flex-1",children:[w.jsx(Sx,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-muted-foreground"}),w.jsx(so,{placeholder:"... (Search places)",value:n,onChange:d=>i(d.target.value),className:"pl-10 h-12 bg-background"})]}),w.jsxs(Ae,{variant:"outline",className:"md:hidden h-12",onClick:()=>e(!t),children:[w.jsx(tM,{className:"w-5 h-5 mr-2"}),"Filters",c&&w.jsx(tu,{className:"ml-2 bg-primary text-primary-foreground",children:"Active"})]}),c&&w.jsxs(Ae,{variant:"ghost",onClick:u,className:"hidden md:flex h-12",children:[w.jsx(pc,{className:"w-4 h-4 mr-2"}),"Clear"]})]}),w.jsxs("div",{className:`mt-4 space-y-4 ${t?"block":"hidden md:block"}`,children:[w.jsxs("div",{children:[w.jsx("p",{className:"text-sm font-medium text-muted-foreground mb-2",children:" (District)"}),w.jsx("div",{className:"flex flex-wrap gap-2",children:EK.map(d=>w.jsxs(Ae,{variant:r===d.value?"default":"outline",size:"sm",onClick:()=>a(d.value),className:"rounded-full",children:[d.label,w.jsxs("span",{className:"text-xs opacity-70 ml-1",children:["(",d.labelEn,")"]})]},d.value))})]}),w.jsxs("div",{children:[w.jsx("p",{className:"text-sm font-medium text-muted-foreground mb-2",children:" (Category)"}),w.jsx("div",{className:"flex flex-wrap gap-2",children:CK.map(d=>w.jsxs(Ae,{variant:o===d.value?"sky":"outline",size:"sm",onClick:()=>s(d.value),className:"rounded-full",children:[d.label,w.jsxs("span",{className:"text-xs opacity-70 ml-1",children:["(",d.labelEn,")"]})]},d.value))})]})]})]})}),w.jsx("main",{className:"py-8",children:w.jsxs("div",{className:"container mx-auto px-4",children:[w.jsxs("p",{className:"text-muted-foreground mb-6",children:[" ",l.length,"  (Found ",l.length," ","places)"]}),l.length>0?w.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:l.map((d,f)=>w.jsx(xK,{id:d.id,name:d.name,nameTh:d.nameTh,location:d.location,image:d.image,rating:d.rating,tags:d.tags,isOpen:d.isOpen,className:`animate-slide-up animation-delay-${f%3*100}`},d.id))}):w.jsxs("div",{className:"text-center py-20",children:[w.jsx("div",{className:"w-16 h-16 bg-muted rounded-full flex items-center justify-center mx-auto mb-4",children:w.jsx(Sx,{className:"w-8 h-8 text-muted-foreground"})}),w.jsx("h3",{className:"font-display text-xl font-semibold text-foreground mb-2",children:""}),w.jsx("p",{className:"text-muted-foreground",children:"No places found. Try adjusting your filters."}),w.jsx(Ae,{variant:"outline",onClick:u,className:"mt-4",children:"Clear Filters"})]})]})})]})},SK=()=>{const{id:t}=fF(),e=Vc(),[n,r]=C.useState(!1),o=dN(t||"");return o?w.jsxs("div",{className:"min-h-screen bg-background",children:[w.jsx(eu,{}),w.jsxs("div",{className:"relative h-[50vh] min-h-[400px]",children:[w.jsx("img",{src:o.image,alt:o.nameTh,className:"w-full h-full object-cover"}),w.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-background via-background/20 to-transparent"}),w.jsx(Ae,{variant:"ghost",size:"icon",onClick:()=>e(-1),className:"absolute top-20 left-4 bg-card/80 backdrop-blur-sm hover:bg-card",children:w.jsx(GD,{className:"w-5 h-5"})}),w.jsx("div",{className:"absolute top-20 right-4",children:w.jsxs("div",{className:"flex items-center gap-1 bg-card/90 backdrop-blur-sm px-3 py-1.5 rounded-full shadow-soft",children:[w.jsx(qC,{className:"w-4 h-4 fill-golden text-golden"}),w.jsx("span",{className:"font-medium text-foreground",children:o.rating.toFixed(1)})]})})]}),w.jsxs("main",{className:"container mx-auto px-4 -mt-20 relative z-10 pb-12",children:[w.jsxs("div",{className:"bg-card rounded-2xl shadow-elevated p-6 md:p-8",children:[w.jsxs("div",{className:"mb-6",children:[w.jsxs("div",{className:"flex items-start justify-between gap-4 mb-3",children:[w.jsxs("div",{children:[w.jsx("h1",{className:"font-display text-2xl md:text-3xl font-bold text-foreground mb-1",children:o.nameTh}),w.jsx("p",{className:"text-muted-foreground text-lg",children:o.name})]}),w.jsxs(tu,{variant:o.isOpen?"default":"secondary",className:o.isOpen?"bg-accent text-accent-foreground":"bg-muted text-muted-foreground",children:[w.jsx(hc,{className:"w-3 h-3 mr-1"}),o.isOpen?"":""]})]}),w.jsx("div",{className:"flex flex-wrap gap-2",children:o.tags.map(i=>w.jsx(tu,{variant:"outline",className:"border-border text-muted-foreground",children:i},i))})]}),w.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[w.jsxs("div",{className:"space-y-2",children:[w.jsxs("h3",{className:"font-medium text-foreground flex items-center gap-2",children:[w.jsx(ma,{className:"w-4 h-4 text-secondary"})," (Address)"]}),w.jsx("p",{className:"text-muted-foreground text-sm",children:o.addressTh}),w.jsx("p",{className:"text-muted-foreground text-sm",children:o.address})]}),w.jsxs("div",{className:"space-y-2",children:[w.jsxs("h3",{className:"font-medium text-foreground flex items-center gap-2",children:[w.jsx(hc,{className:"w-4 h-4 text-secondary"}),"- (Hours)"]}),w.jsxs("p",{className:"text-muted-foreground",children:[o.openTime," - ",o.closeTime]})]})]}),w.jsx("a",{href:o.googleMapsUrl,target:"_blank",rel:"noopener noreferrer",children:w.jsxs(Ae,{variant:"outline",className:"w-full md:w-auto mb-6",children:[w.jsx(ma,{className:"w-4 h-4"}),"Open in Google Maps",w.jsx(ZD,{className:"w-4 h-4"})]})}),w.jsxs("div",{className:"border-t border-border pt-6",children:[w.jsx("h3",{className:"font-medium text-foreground mb-3",children:" (Description)"}),w.jsxs("div",{className:`text-muted-foreground leading-relaxed ${!n&&"line-clamp-3"}`,children:[w.jsx("p",{className:"mb-3",children:o.descriptionTh}),w.jsx("p",{children:o.description})]}),w.jsx(Ae,{variant:"ghost",size:"sm",onClick:()=>r(!n),className:"mt-2 text-primary",children:n?w.jsxs(w.Fragment,{children:[w.jsx(YD,{className:"w-4 h-4"}),"Show Less"]}):w.jsxs(w.Fragment,{children:[w.jsx(qD,{className:"w-4 h-4"}),"Read More"]})})]})]}),w.jsx("div",{className:"mt-6 bg-gradient-river rounded-2xl p-6 shadow-elevated",children:w.jsxs("div",{className:"flex flex-col md:flex-row items-center gap-4 text-center md:text-left",children:[w.jsx("div",{className:"w-12 h-12 bg-primary-foreground/20 rounded-xl flex items-center justify-center flex-shrink-0",children:w.jsx(Xd,{className:"w-6 h-6 text-primary-foreground"})}),w.jsxs("div",{className:"flex-1",children:[w.jsx("h3",{className:"font-display text-lg font-semibold text-primary-foreground mb-1",children:" AI "}),w.jsx("p",{className:"text-primary-foreground/80 text-sm",children:"Get tips, recommendations, and plan your visit with our AI assistant"})]}),w.jsx(hn,{to:`/chat?place=${o.id}`,children:w.jsx(Ae,{variant:"heroOutline",className:"bg-primary-foreground text-primary hover:bg-primary-foreground/90",children:"Ask AI Guide"})})]})})]})]}):w.jsxs("div",{className:"min-h-screen bg-background",children:[w.jsx(eu,{}),w.jsxs("div",{className:"pt-24 container mx-auto px-4 text-center",children:[w.jsx("h1",{className:"font-display text-2xl font-bold text-foreground mb-4",children:""}),w.jsx("p",{className:"text-muted-foreground mb-8",children:"Place not found"}),w.jsx(hn,{to:"/places",children:w.jsx(Ae,{children:"Back to Places"})})]})]})},kK="/assets/logochat%E0%B8%99%E0%B9%89%E0%B8%AD%E0%B8%87%E0%B8%9B%E0%B8%A5%E0%B8%B2%E0%B8%97%E0%B8%B9-DvqOaGyL.png",Xb="/assets/hero-floating-market-C9FyTcU2.jpg",fN=()=>{var e;const t="https://nongplatoo.online".trim();return t||(typeof window<"u"&&((e=window.location)!=null&&e.origin)?window.location.origin:"")},Y0=fN(),hN=t=>{if(!t)return"";if(typeof t=="string")return t;const e=t.district||"",n=t.province||"";return[e,n].filter(Boolean).join(", ")},pN=t=>{if(t)return Array.isArray(t)?t.join(", "):t},IK=({place:t,fallback:e})=>{const[n,r]=C.useState(!1),o=t.place_name||t.name||"",i=t.short_description||t.description||"",a=t.category||pN(t.type),s=hN(t.location)||t.address,c=(m=>{if(!m)return[];if(Array.isArray(m))return m.filter(p=>p&&String(p).trim()).map(p=>String(p).trim());if(typeof m=="string"){const p=m.trim();if(p.startsWith("["))try{const g=JSON.parse(p);if(Array.isArray(g))return g.filter(v=>v&&String(v).trim()).map(v=>String(v).trim())}catch(g){console.warn("Failed to parse images JSON:",g)}return p?[p]:[]}return[]})(t.images),l=c.length>0?c[0]:null,f=!l||n?e:(m=>m?m.startsWith("https://lh3.googleusercontent.com")?`${Y0}/api/image-proxy?url=${encodeURIComponent(m)}`:m:e)(l),h=()=>{console.warn(`Failed to load image: ${l}, using fallback`),r(!0)};return w.jsx("div",{className:"rounded-xl border border-border bg-muted/40 p-3",children:w.jsxs("div",{className:"flex items-start gap-3",children:[w.jsx("img",{src:f,alt:o,className:"w-16 h-16 rounded-lg object-cover flex-shrink-0",loading:"lazy",onError:h}),w.jsxs("div",{className:"space-y-1",children:[w.jsx("p",{className:"font-semibold text-foreground leading-tight",children:o}),a&&w.jsx("p",{className:"text-xs text-muted-foreground",children:a}),w.jsx("p",{className:"text-sm text-foreground/80 leading-relaxed line-clamp-3",children:i}),s&&w.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[w.jsx(ma,{className:"w-3.5 h-3.5"}),w.jsx("span",{children:s})]}),t.opening_hours&&w.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[w.jsx(hc,{className:"w-3.5 h-3.5"}),w.jsx("span",{children:t.opening_hours})]}),t.contact&&w.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[w.jsx(KC,{className:"w-3.5 h-3.5"}),w.jsx("span",{children:t.contact})]})]})]})})},RK=({place:t,fallback:e})=>{const[n,r]=C.useState(!1),o=t.place_name||t.name||"",i=t.short_description||t.description||"",a=t.category||pN(t.type),s=hN(t.location)||t.address,c=(m=>{if(!m)return[];if(Array.isArray(m))return m.filter(p=>p&&String(p).trim()).map(p=>String(p).trim());if(typeof m=="string"){const p=m.trim();if(p.startsWith("["))try{const g=JSON.parse(p);if(Array.isArray(g))return g.filter(v=>v&&String(v).trim()).map(v=>String(v).trim())}catch(g){console.warn("Failed to parse images JSON:",g)}return p?[p]:[]}return[]})(t.images),l=c.length>0?c[0]:null,f=!l||n?e:(m=>m?m.startsWith("https://lh3.googleusercontent.com")?`${Y0}/api/image-proxy?url=${encodeURIComponent(m)}`:m:e)(l),h=()=>{console.warn(`Failed to load image: ${l}, using fallback`),r(!0)};return w.jsxs("div",{className:"rounded-2xl border border-border bg-card overflow-hidden shadow-lg",children:[w.jsx("div",{className:"relative aspect-video overflow-hidden bg-muted",children:w.jsx("img",{src:f,alt:o,className:"w-full h-full object-cover",loading:"lazy",onError:h})}),w.jsxs("div",{className:"p-4 space-y-3",children:[a&&w.jsx("p",{className:"text-sm font-medium text-primary",children:a}),w.jsx("h3",{className:"text-xl font-bold text-foreground",children:o}),w.jsx("p",{className:"text-sm text-foreground/80 leading-relaxed",children:i}),w.jsxs("div",{className:"space-y-2 pt-2",children:[s&&w.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[w.jsx(ma,{className:"w-4 h-4 flex-shrink-0"}),w.jsx("span",{children:s})]}),t.opening_hours&&w.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[w.jsx(hc,{className:"w-4 h-4 flex-shrink-0"}),w.jsx("span",{children:t.opening_hours})]}),t.contact&&w.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[w.jsx(KC,{className:"w-4 h-4 flex-shrink-0"}),w.jsx("span",{children:t.contact})]})]})]})]})},TK=({places:t})=>{if(!t.length)return null;const e=t[0],n=t.slice(1);return w.jsxs("div",{className:"mt-4 space-y-4",children:[w.jsx(RK,{place:e,fallback:Xb}),n.length>0&&w.jsxs("div",{children:[w.jsx("p",{className:"text-sm font-semibold text-muted-foreground mb-2",children:" "}),w.jsx("div",{className:"space-y-2",children:n.map((r,o)=>w.jsx(IK,{place:r,fallback:Xb},r.id||`${r.place_name||r.name||"place"}-${o}`))})]})]})},NK=({message:t,isUser:e,timestamp:n,structuredData:r=[],meta:o,messageId:i,chatLogId:a,userMessage:s})=>{const[u,c]=C.useState(null),[l,d]=C.useState(!1),f=async h=>{const m=a||i;if(!(!m||l)){d(!0);try{(await fetch(`${Y0}/api/feedback`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({chat_log_id:m,type:h,comment:""})})).ok&&c(h)}catch(p){console.error("Failed to submit feedback:",p)}finally{d(!1)}}};return w.jsxs("div",{className:be("flex gap-3 animate-slide-up",e?"flex-row-reverse":"flex-row"),children:[w.jsx("div",{className:be("flex-shrink-0 w-9 h-9 rounded-full flex items-center justify-center overflow-hidden",e?"bg-primary text-primary-foreground":"bg-secondary text-secondary-foreground"),children:e?w.jsx(XC,{className:"w-5 h-5"}):w.jsx("img",{src:kK,alt:"NongPlatoo",className:"w-full h-full object-cover"})}),w.jsxs("div",{className:be("max-w-[80%] rounded-2xl px-4 py-3",e?"bg-primary text-primary-foreground rounded-br-sm":"bg-card shadow-soft border border-border rounded-bl-sm"),children:[w.jsx("p",{className:be("text-sm leading-relaxed whitespace-pre-wrap",e?"text-primary-foreground":"text-foreground"),children:t}),r.length>0&&w.jsx(TK,{places:r}),!e&&(a||i)&&w.jsxs("div",{className:"flex items-center gap-2 mt-3 pt-2 border-t border-border",children:[w.jsxs(Ae,{variant:"ghost",size:"sm",className:be("h-7 px-2 text-xs",u==="like"&&"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400"),onClick:()=>f("like"),disabled:l||u!==null,children:[w.jsx(sM,{className:"w-3.5 h-3.5 mr-1"}),"Helpful"]}),w.jsxs(Ae,{variant:"ghost",size:"sm",className:be("h-7 px-2 text-xs",u==="dislike"&&"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400"),onClick:()=>f("dislike"),disabled:l||u!==null,children:[w.jsx(aM,{className:"w-3.5 h-3.5 mr-1"}),"Not helpful"]})]}),(n||(o==null?void 0:o.source))&&w.jsxs("p",{className:be("text-xs mt-1.5 flex items-center gap-2",e?"text-primary-foreground/60":"text-muted-foreground"),children:[n,(o==null?void 0:o.source)&&w.jsx("span",{className:"rounded-full bg-muted px-2 py-0.5 text-[11px] border border-border",children:o.source})]})]})]})},Wh=()=>{const t=navigator.userAgent.toLowerCase(),e=/iphone|ipad|ipod/.test(t),n=/ipad/.test(t),r=/android/.test(t),o=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),i=/chrome|chromium|crios/.test(t),a=/firefox/.test(t),s=/edg/.test(t),u=!!(window.SpeechRecognition||window.webkitSpeechRecognition),c=!!window.MediaRecorder,l=!!(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia),d=!!(window.AudioContext||window.webkitAudioContext),f=!!(window.WebGL2RenderingContext||window.WebGLRenderingContext),h=u&&!n&&!o,m=f&&l&&!n,p=h&&l,g=AK(),v=e&&g<14.5;return{chat:!0,tts:d,speechRecognition:u,mediaRecorder:c,camera:l,webgl:f,isIOS:e,isIPad:n,isAndroid:r,isSafari:o,isChrome:i,isFirefox:a,isEdge:s,canUseVoiceAI:p,canUseSpeechRecognition:h,canUseFaceDetection:m,recommendTTSGesture:v}},AK=()=>{const t=navigator.userAgent.match(/OS (\d+)_(\d+)?/);return t?parseInt(t[1],10):0},PK=()=>{const t=Wh(),e=[];return e.push(" Text Chat"),e.push(" AI Responses"),t.tts?e.push(" Text-to-Speech (Audio)"):e.push(" Text-to-Speech (Audio not supported)"),t.canUseSpeechRecognition?e.push(" Speech Recognition"):t.isIPad?e.push(" Speech Recognition (Not supported on iPad)"):t.isSafari?e.push(" Speech Recognition (Not supported on Safari)"):e.push(" Speech Recognition (Not supported)"),t.camera?e.push(" Camera Access"):e.push(" Camera Access"),t.canUseFaceDetection?e.push(" Face Detection"):t.isIPad?e.push(" Face Detection (Slow on iPad)"):t.camera?e.push(" Face Detection (Not supported)"):e.push(" Face Detection (No camera)"),t.canUseVoiceAI?e.push(" Voice AI Interface"):e.push(" Voice AI Interface (Not supported)"),e},DK=()=>{const t=Wh(),e=[];return t.isIPad&&(e.push(" You're using iPad - some features may be limited"),e.push(" Speech Recognition is not available on iPad"),e.push(" Voice AI features may not work well")),t.isSafari&&!t.isIPad&&e.push(" Speech Recognition support is experimental in Safari"),t.isFirefox&&e.push(" Speech Recognition not available in Firefox"),t.recommendTTSGesture&&e.push(" Please tap the screen to enable audio playback"),t.isIPad&&t.webgl&&e.push(" Face Detection may be slow on iPad"),e},MK=({onClose:t,showOnceOnly:e=!0,minimized:n=!1})=>{const[r,o]=C.useState(null),[i,a]=C.useState(!n),[s,u]=C.useState(n);if(C.useEffect(()=>{const f=Wh();o(f),f.isChrome&&!f.isAndroid&&!f.isIPad&&f.canUseVoiceAI&&f.tts&&a(!1)},[]),!r||!i)return!i&&!n?null:s&&!i?w.jsx("div",{className:"fixed bottom-4 right-4 z-40",children:w.jsxs("button",{onClick:()=>a(!0),className:"bg-gray-100 text-gray-600 px-2 py-1 rounded-md shadow-sm hover:bg-gray-200 hover:text-gray-700 flex items-center gap-1.5 text-xs border border-gray-300 transition-colors",title:"View device compatibility info",children:[w.jsx(gx,{className:"w-3 h-3"}),w.jsx("span",{className:"hidden sm:inline",children:"Device"})]})}):null;const c=DK(),l=PK(),d=c.length>0;return w.jsx("div",{className:"fixed bottom-4 right-4 z-50 max-w-md",children:w.jsxs("div",{className:`rounded-lg shadow-xl border ${d?"bg-amber-50 border-amber-200":"bg-blue-50 border-blue-200"} p-4`,children:[w.jsxs("div",{className:"flex items-start justify-between mb-3",children:[w.jsxs("div",{className:"flex items-center gap-2",children:[d?w.jsx(uM,{className:"w-5 h-5 text-amber-600 flex-shrink-0"}):w.jsx(gx,{className:"w-5 h-5 text-blue-600 flex-shrink-0"}),w.jsx("h3",{className:`font-semibold ${d?"text-amber-900":"text-blue-900"}`,children:d?"Feature Limitations":"Device Compatibility"})]}),w.jsx("button",{onClick:()=>{a(!1),t==null||t()},className:"text-gray-400 hover:text-gray-600",children:""})]}),d&&w.jsx("div",{className:"mb-4 space-y-2",children:c.map((f,h)=>w.jsxs("div",{className:"text-sm text-amber-800 flex items-start gap-2",children:[w.jsx("span",{className:"flex-shrink-0 mt-0.5",children:""}),w.jsx("span",{children:f})]},h))}),w.jsxs("div",{children:[w.jsx("h4",{className:`font-medium text-sm mb-2 ${d?"text-amber-900":"text-blue-900"}`,children:"Available Features:"}),w.jsx("div",{className:"space-y-1 text-sm",children:l.map((f,h)=>w.jsxs("div",{className:`flex items-center gap-2 ${f.startsWith("")?"text-green-700":f.startsWith("")?"text-red-700":"text-amber-700"}`,children:[f.startsWith("")&&w.jsx(GC,{className:"w-4 h-4 flex-shrink-0"}),f.startsWith("")&&w.jsx(QD,{className:"w-4 h-4 flex-shrink-0"}),f.startsWith("")&&w.jsx(Nu,{className:"w-4 h-4 flex-shrink-0"}),w.jsx("span",{children:f})]},h))})]}),r.isIPad&&w.jsxs("div",{className:"mt-4 pt-4 border-t border-amber-200",children:[w.jsx("h4",{className:"font-medium text-sm text-amber-900 mb-2",children:"iPad Tips:"}),w.jsxs("ul",{className:"text-xs text-amber-800 space-y-1 list-disc list-inside",children:[w.jsx("li",{children:"Text chat works perfectly "}),w.jsx("li",{children:"AI responses work perfectly "}),w.jsx("li",{children:"For audio: tap the play button to unlock sound first"}),w.jsx("li",{children:"Speech input is not available on iPad Safari"}),w.jsx("li",{children:"Voice AI features won't work due to no speech input"})]})]}),!n&&w.jsx("button",{onClick:()=>{u(!0),a(!1)},className:"mt-3 w-full text-xs text-gray-600 hover:text-gray-700 py-1 border-t border-amber-200 pt-2",children:"Minimize"})]})})},Yb=fN(),OK=["",""," "],FK=()=>{const[t]=Sy(),e=t.get("place"),n=e?dN(e):null,[r,o]=C.useState([{id:"welcome",content:n?`! I see you're interested in ${n.nameTh} (${n.name}). I'd be happy to help you learn more about this place or plan your visit. What would you like to know?`:"!      ",isUser:!1,timestamp:new Date().toLocaleTimeString("th-TH",{hour:"2-digit",minute:"2-digit"})}]),[i,a]=C.useState(""),[s,u]=C.useState(!1),[c,l]=C.useState(null),[d,f]=C.useState(!1),[h,m]=C.useState(""),[p,g]=C.useState(!1),[v,y]=C.useState(!1),[x,b]=C.useState(null),[E,_]=C.useState(!1),[S,k]=C.useState(null),[R,I]=C.useState(!1),D=C.useRef(null),A=C.useRef(""),W=C.useRef(null),F=C.useRef(null),$=C.useRef(null),j=()=>{var X;(X=F.current)==null||X.scrollIntoView({behavior:"smooth"})};C.useEffect(()=>{j()},[r]),C.useEffect(()=>{if(typeof window>"u")return;const X=Wh();k(X);const J=window,ie=J.SpeechRecognition||J.webkitSpeechRecognition;return g(!!ie&&X.canUseSpeechRecognition),X.recommendTTSGesture&&I(!0),()=>{var oe,me;(oe=D.current)==null||oe.abort(),(me=$.current)==null||me.close(),x&&x.pause()}},[x]);const U=()=>new Date().toLocaleTimeString("th-TH",{hour:"2-digit",minute:"2-digit"}),M=(X,J)=>({id:`${Date.now()}-assistant`,content:X.text,structuredData:X.structured_data,isUser:!1,timestamp:X.createdAt||new Date().toLocaleTimeString("th-TH",{hour:"2-digit",minute:"2-digit"}),meta:{source:X.source,intent:X.intent},userMessage:J}),P=()=>{x&&(x.pause(),b(null),y(!1)),"speechSynthesis"in window&&window.speechSynthesis.cancel()},B=async X=>{const J=X||i;if(!J.trim())return;const ie={id:Date.now().toString(),content:J,isUser:!0,timestamp:U()};o(me=>[...me,ie]),a(""),u(!0),l(null);const oe=new AbortController;W.current=oe;try{const me=await fetch(`${Yb}/api/messages`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:J,user_id:"web"}),signal:oe.signal});if(!me.ok){const ye=await me.text();throw new Error(ye||"Unable to reach AI service")}const ee=await me.json();ee!=null&&ee.assistant?o(ye=>[...ye,M(ee.assistant,J)]):o(ye=>[...ye,{id:`${Date.now()}-fallback`,content:"  ",isUser:!1,timestamp:U()}])}catch(me){console.error(me),me.name==="AbortError"?l(""):l(" AI  "),o(ee=>[...ee,{id:`${Date.now()}-error`,content:me.name==="AbortError"?"":"  AI  ",isUser:!1,timestamp:U()}])}finally{u(!1),W.current=null}},V=async X=>{var ye;const J=X||i;if(!J.trim())return;const ie={id:Date.now().toString(),content:J,isUser:!0,timestamp:U()};a("");const oe=`${Date.now()}-assistant`,me={id:oe,content:"",isUser:!1,timestamp:U(),isStreaming:!0};o(ge=>[...ge,ie,me]),u(!0),l(null);const ee=new AbortController;W.current=ee;try{const ge=await fetch(`${Yb}/api/messages/stream`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:J,user_id:"web"}),signal:ee.signal});if(!ge.ok){o(vt=>vt.filter(Zt=>Zt.id!==oe)),await B(J);return}const Ne=(ye=ge.body)==null?void 0:ye.getReader(),Me=new TextDecoder;let Oe="",Mt=[],mt="",et=Date.now();const Qn=50;if(Ne)for(;;){const{done:vt,value:Zt}=await Ne.read();if(vt)break;const Er=Me.decode(Zt).split(`
`);for(const cn of Er)if(cn.startsWith("data: "))try{const We=JSON.parse(cn.slice(6));if(We.type==="intent")mt=We.intent_type;else if(We.type==="structured_data")Mt=We.data;else if(We.type==="text"){Oe+=We.text;const kt=Date.now();(kt-et>Qn||We.text.includes(" "))&&(et=kt,o(It=>It.map(eo=>eo.id===oe?{...eo,content:Oe}:eo)))}else if(We.type==="done")o(kt=>kt.map(It=>It.id===oe?{...It,content:Oe,structuredData:Mt,meta:{intent_type:mt,source:"streaming"},isStreaming:!1,chatLogId:We.chat_log_id}:It));else if(We.type==="error")throw new Error(We.message)}catch(We){console.warn("Failed to parse SSE data:",We)}}}catch(ge){console.error(ge),ge.name==="AbortError"?l(""):l(" AI  "),o(Ne=>Ne.filter(Me=>Me.id!==oe)),o(Ne=>[...Ne,{id:`${Date.now()}-error`,content:"  ",isUser:!1,timestamp:U()}])}finally{u(!1),W.current=null}},K=X=>{X.key==="Enter"&&!X.shiftKey&&(X.preventDefault(),V())},Q=()=>{var X;(X=D.current)==null||X.stop()},te=()=>{var X,J;(X=W.current)==null||X.abort(),W.current=null,(J=$.current)==null||J.close(),$.current=null,u(!1)},ae=async()=>{var me;if(typeof window>"u")return;if(!S||!S.canUseSpeechRecognition){S!=null&&S.isIPad?l(" Speech recognition is not available on iPad. Please use text input instead."):S!=null&&S.isSafari?l(" Speech recognition is not supported in Safari. Try Chrome or Edge."):l("This browser doesn't support speech recognition. Try Chrome or Edge.");return}const X=window,J=X.SpeechRecognition||X.webkitSpeechRecognition;if(!J){l("Speech recognition not available. Please use text input.");return}(me=D.current)==null||me.abort();const ie=new J;ie.lang="th-TH",ie.interimResults=!0,ie.continuous=!1,ie.maxAlternatives=1,D.current=ie;let oe="";A.current="",m(""),f(!0),l(null),ie.onresult=ee=>{var Ne;let ye="";for(let Me=ee.resultIndex;Me<ee.results.length;Me++){const Oe=((Ne=ee.results[Me][0])==null?void 0:Ne.transcript)||"";ee.results[Me].isFinal?oe+=Oe:ye+=Oe}const ge=`${oe} ${ye}`.trim();A.current=ge,m(ge)},ie.onerror=ee=>{console.error("Voice recognition error",ee.error),f(!1),ee.error==="network"?l("Network error. Please check your connection and try again."):ee.error==="no-speech"?l("No sound detected. Please speak clearly and try again."):ee.error==="not-allowed"?l(" Microphone permission denied. Check Settings > Safari > Microphone."):l("Microphone error. Please try again or use text input.")},ie.onend=()=>{f(!1);const ee=(A.current||oe).trim();ee?B(ee):l("No speech detected. Please try again.")},ie.start()};return w.jsxs("div",{className:"min-h-screen bg-background flex flex-col",children:[w.jsx(eu,{}),d&&w.jsx("div",{className:"fixed inset-0 z-40 bg-background/60 backdrop-blur-sm flex items-end md:items-center justify-center px-4 pb-10",children:w.jsxs("div",{className:"w-full max-w-lg bg-gradient-to-br from-primary via-primary/80 to-primary-foreground text-primary-foreground rounded-3xl p-6 shadow-2xl border border-primary/40",children:[w.jsxs("div",{className:"flex items-center justify-between gap-3",children:[w.jsxs("div",{className:"flex items-center gap-4",children:[w.jsxs("div",{className:"relative",children:[w.jsx("div",{className:"absolute inset-0 rounded-2xl bg-primary-foreground/20 animate-ping"}),w.jsx("div",{className:"relative w-12 h-12 rounded-2xl bg-primary-foreground/30 flex items-center justify-center",children:w.jsx(zs,{className:"w-6 h-6"})})]}),w.jsxs("div",{children:[w.jsx("p",{className:"text-xs uppercase tracking-[0.2em] text-primary-foreground/70",children:"NongPlaToo Voice"}),w.jsx("p",{className:"text-lg font-semibold",children:"..."}),w.jsx("p",{className:"text-sm text-primary-foreground/80",children:""})]})]}),w.jsxs(Ae,{size:"sm",variant:"secondary",onClick:Q,className:"bg-primary-foreground text-primary hover:bg-primary-foreground/90",children:[w.jsx(Ix,{className:"w-4 h-4"}),""]})]}),w.jsxs("div",{className:"mt-5 bg-white/10 border border-white/20 rounded-2xl p-4 min-h-[92px]",children:[w.jsx("p",{className:"text-sm text-primary-foreground/80",children:h||"..."}),w.jsxs("div",{className:"mt-4 flex items-center gap-1",children:[w.jsx("span",{className:"w-1.5 h-6 bg-white/40 rounded-full animate-[pulse_1s_ease-in-out_infinite]"}),w.jsx("span",{className:"w-1.5 h-9 bg-white/60 rounded-full animate-[pulse_1.2s_ease-in-out_infinite]"}),w.jsx("span",{className:"w-1.5 h-4 bg-white/30 rounded-full animate-[pulse_0.9s_ease-in-out_infinite]"}),w.jsx("span",{className:"w-1.5 h-7 bg-white/50 rounded-full animate-[pulse_1.1s_ease-in-out_infinite]"})]})]})]})}),w.jsx("main",{className:"flex-1 overflow-y-auto pt-16",children:w.jsxs("div",{className:"container mx-auto px-4 py-6 max-w-3xl",children:[c&&w.jsxs("div",{className:"mb-4 inline-flex items-center gap-2 text-sm text-red-500 bg-red-50 border border-red-200 rounded-xl px-3 py-2",children:[w.jsx(Nu,{className:"w-4 h-4"}),w.jsx("span",{children:c})]}),w.jsxs("div",{className:"space-y-4",children:[r.map(X=>w.jsx(NK,{message:X.content,isUser:X.isUser,timestamp:X.timestamp,structuredData:X.structuredData,meta:X.meta,messageId:X.id,chatLogId:X.chatLogId,userMessage:X.userMessage},X.id)),s&&w.jsxs("div",{className:"flex gap-3 animate-slide-up",children:[w.jsx("div",{className:"w-9 h-9 bg-secondary rounded-full flex items-center justify-center",children:w.jsx(zs,{className:"w-5 h-5 text-secondary-foreground animate-pulse"})}),w.jsx("div",{className:"bg-card shadow-soft border border-border rounded-2xl rounded-bl-sm px-4 py-3 min-w-[200px]",children:w.jsxs("div",{className:"space-y-2",children:[w.jsx("div",{className:"h-3 bg-muted rounded w-3/4 skeleton-pulse"}),w.jsx("div",{className:"h-3 bg-muted rounded w-full skeleton-pulse animation-delay-100"}),w.jsx("div",{className:"h-3 bg-muted rounded w-5/6 skeleton-pulse animation-delay-200"})]})})]}),w.jsx("div",{ref:F})]})]})}),r.length<=2&&w.jsx("div",{className:"border-t border-border bg-muted/50",children:w.jsxs("div",{className:"container mx-auto px-4 py-3 max-w-3xl",children:[w.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:":"}),w.jsx("div",{className:"flex flex-wrap gap-2",children:OK.map(X=>w.jsx(Ae,{variant:"outline",size:"sm",className:"rounded-full text-xs",onClick:()=>V(X),children:X},X))})]})}),w.jsx("div",{className:"border-t border-border bg-card sticky bottom-0",children:w.jsxs("div",{className:"container mx-auto px-4 py-4 max-w-3xl",children:[w.jsxs("div",{className:"flex gap-3 items-center",children:[S&&w.jsxs(w.Fragment,{children:[S.canUseSpeechRecognition?w.jsx(Ae,{type:"button",variant:d?"destructive":"secondary",size:"icon",onClick:d?Q:ae,disabled:s,className:d?"animate-pulse shadow-elevated":"",title:"Speak your question",children:w.jsx(Yd,{className:"w-5 h-5"})}):w.jsx(Ae,{type:"button",variant:"secondary",size:"icon",disabled:!0,className:"opacity-50 cursor-not-allowed",title:S.isIPad?"Speech not supported on iPad":S.isSafari?"Speech not supported in Safari":"Speech not supported in this browser",children:w.jsx(Yd,{className:"w-5 h-5"})}),S.canUseVoiceAI?w.jsx(Ae,{type:"button",variant:"outline",size:"icon",onClick:()=>_(!0),disabled:s,className:"border-cyan-500/50 text-cyan-600 hover:bg-cyan-500/10 hover:text-cyan-500",title:"Voice AI Assistant",children:w.jsx(_x,{className:"w-5 h-5"})}):w.jsx(Ae,{type:"button",variant:"outline",size:"icon",disabled:!0,className:"opacity-50 cursor-not-allowed border-gray-300",title:S.isIPad?"Voice AI not supported on iPad":"Voice AI requires microphone access",children:w.jsx(_x,{className:"w-5 h-5"})})]}),w.jsx(so,{value:i,onChange:X=>a(X.target.value),onKeyDown:K,placeholder:"... (Type a message)",className:"flex-1 h-12 bg-background rounded-xl",disabled:s}),v&&w.jsx(Ae,{type:"button",onClick:P,variant:"outline",size:"icon",className:"h-12 w-12 rounded-xl",children:w.jsx(dM,{className:"w-5 h-5"})}),s?w.jsxs(Ae,{type:"button",onClick:te,variant:"destructive",className:"h-12 px-4 rounded-xl",children:[w.jsx(Ix,{className:"w-5 h-5"}),""]}):w.jsx(Ae,{onClick:()=>V(),disabled:!i.trim(),className:"h-12 w-12 rounded-xl",children:w.jsx(iM,{className:"w-5 h-5"})})]}),S&&w.jsxs(w.Fragment,{children:[R&&!S.isAndroid&&w.jsxs("p",{className:"mt-2 text-xs text-amber-700 bg-amber-50 px-3 py-2 rounded inline-flex items-center gap-1 border border-amber-200",children:[w.jsx(Nu,{className:"w-3 h-3"})," Tap to enable audio playback on first message"]}),S.isIPad&&!S.canUseSpeechRecognition&&w.jsxs("p",{className:"mt-2 text-xs text-blue-700 bg-blue-50 px-3 py-2 rounded inline-flex items-center gap-1 border border-blue-200",children:[w.jsx(Nu,{className:"w-3 h-3"})," iPad: Text chat & AI work great! Speech input not available on this device."]}),!p&&!S.isIPad&&w.jsxs("p",{className:"mt-2 text-xs text-muted-foreground inline-flex items-center gap-1",children:[w.jsx(Nu,{className:"w-3 h-3"}),"Speech not available in this browser. Try Chrome, Edge, or Safari."]})]})]})}),w.jsx(WT,{isOpen:E,onClose:()=>_(!1)}),w.jsx(MK,{minimized:!0})]})},LK=()=>{const t=_a();return C.useEffect(()=>{console.error("404 Error: User attempted to access non-existent route:",t.pathname)},[t.pathname]),w.jsx("div",{className:"flex min-h-screen items-center justify-center bg-muted",children:w.jsxs("div",{className:"text-center",children:[w.jsx("h1",{className:"mb-4 text-4xl font-bold",children:"404"}),w.jsx("p",{className:"mb-4 text-xl text-muted-foreground",children:"Oops! Page not found"}),w.jsx("a",{href:"/",className:"text-primary underline hover:text-primary/90",children:"Return to Home"})]})})},BK=new O4,jK=()=>w.jsx(L4,{client:BK,children:w.jsx(d4,{children:w.jsxs(kU,{children:[w.jsx(KM,{}),w.jsx(S3,{}),w.jsx(OF,{children:w.jsxs(IF,{children:[w.jsx(Vi,{path:"/",element:w.jsx(aK,{})}),w.jsx(Vi,{path:"/auth",element:w.jsx(vK,{})}),w.jsx(Vi,{path:"/places",element:w.jsx(_K,{})}),w.jsx(Vi,{path:"/places/:id",element:w.jsx(SK,{})}),w.jsx(Vi,{path:"/chat",element:w.jsx(FK,{})}),w.jsx(Vi,{path:"*",element:w.jsx(LK,{})})]})})]})})});xC(document.getElementById("root")).render(w.jsx(jK,{}))});export default UK();
